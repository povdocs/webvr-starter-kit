{"version":3,"sources":["webpack:///vr.js","webpack:///webpack/bootstrap 46cd3bd8cb2399238d75","webpack:///./src/entry.js","webpack:///./bower_components/nosleep/NoSleep.js","webpack:///./~/ismobilejs/isMobile.js","webpack:///./src/css/style.css?21aa","webpack:///./src/css/style.css","webpack:///./~/css-loader/lib/css-base.js","webpack:///./~/style-loader/addStyles.js","webpack:///./src/vr.js","webpack:///./src/materials.js","webpack:///./~/three/three.js","webpack:///./~/lodash.foreach/index.js","webpack:///./~/lodash._arrayeach/index.js","webpack:///./~/lodash._baseeach/index.js","webpack:///./~/lodash.keys/index.js","webpack:///./~/lodash._getnative/index.js","webpack:///./~/lodash.isarguments/index.js","webpack:///./~/lodash.isarray/index.js","webpack:///./~/lodash._bindcallback/index.js","webpack:///./~/lodash.assign/index.js","webpack:///./~/lodash._baseassign/index.js","webpack:///./~/lodash._basecopy/index.js","webpack:///./~/lodash._createassigner/index.js","webpack:///./~/lodash._isiterateecall/index.js","webpack:///./~/lodash.restparam/index.js","webpack:///./src/utils/urlregex.js","webpack:///./src/images ^\\.\\/.*$","webpack:///./src/images/asphalt.jpg","webpack:///./src/images/brick-tiles.jpg","webpack:///./src/images/bricks-normal.jpg","webpack:///./src/images/bricks-specular.jpg","webpack:///./src/images/bricks.jpg","webpack:///./src/images/checkerboard.png","webpack:///./src/images/grass.jpg","webpack:///./src/images/metal-floor.jpg","webpack:///./src/images/metal.jpg","webpack:///./src/images/stone.jpg","webpack:///./src/images/tiles.jpg","webpack:///./src/images/weathered-wood.jpg","webpack:///./src/images/wood.jpg","webpack:///./src/vr-object.js","webpack:///./~/event-emitter/index.js","webpack:///./~/d/index.js","webpack:///./~/es5-ext/object/assign/index.js","webpack:///./~/es5-ext/object/assign/is-implemented.js","webpack:///./~/es5-ext/object/assign/shim.js","webpack:///./~/es5-ext/object/keys/index.js","webpack:///./~/es5-ext/object/keys/is-implemented.js","webpack:///./~/es5-ext/object/keys/shim.js","webpack:///./~/es5-ext/object/valid-value.js","webpack:///./~/es5-ext/object/normalize-options.js","webpack:///./~/es5-ext/object/is-callable.js","webpack:///./~/es5-ext/string/#/contains/index.js","webpack:///./~/es5-ext/string/#/contains/is-implemented.js","webpack:///./~/es5-ext/string/#/contains/shim.js","webpack:///./~/es5-ext/object/valid-callable.js","webpack:///./src/objects/empty.js","webpack:///./bower_components/DeviceOrientationControls/index.js","webpack:///./bower_components/OrbitControls/index.js","webpack:///./bower_components/AugmentedConsole/index.js","webpack:///./src/lib/VRStereoEffect.js","webpack:///./src/lib/VRControls.js","webpack:///./src/objects ^\\.\\/.*$","webpack:///./src/objects/box.js","webpack:///./src/objects/cylinder.js","webpack:///./src/objects/floor.js","webpack:///./src/objects/grid.js","webpack:///./src/objects/image.js","webpack:///./src/objects/panorama.js","webpack:///./src/objects/sky.js","webpack:///./bower_components/SkyShader/index.js","webpack:///./src/objects/sound.js","webpack:///./src/lib/ThreeAudio.js","webpack:///./src/objects/sphere.js","webpack:///./src/objects/text.js","webpack:///./src/objects/torus.js","webpack:///./src/objects/video.js","webpack:///./bower_components/open-iconic/svg/fullscreen-enter.svg","webpack:///./bower_components/open-iconic/svg/fullscreen-exit.svg","webpack:///./bower_components/open-iconic/svg/eye.svg","webpack:///./bower_components/open-iconic/svg/compass.svg"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","initRequirements","VR","initUI","svgButton","source","svg","span","document","createElement","innerHTML","firstChild","setAttribute","container","appendChild","toggleOrientation","orientationEnabled","disableOrientation","enableOrientation","deviceChange","controlMode","vrButton","classList","remove","orientationButton","enableFullscreen","disableFullscreen","element","noSleep","NoSleep","fullScreenElement","body","fullscreenEnabled","webkitFullscreenEnabled","mozFullScreenEnabled","msFullscreenEnabled","requestFullscreen","webkitRequestFullscreen","mozRequestFullScreen","msRequestFullscreen","head","addEventListener","bind","exitFullscreen","on","isFullscreen","style","display","vrMode","enable","disable","className","requestVR","window","evt","keyCode","charCodeAt","zeroSensor","resize","initialize","init","isMobile","any","THREE","start","root","addSourceToVideo","type","dataURI","src","ua","Android","test","navigator","userAgent","iOS","media","WebM","MP4","this","noSleepTimer","noSleepVideo","prototype","duration","setInterval","location","setTimeout","stop","play","clearInterval","pause","__WEBPACK_AMD_DEFINE_FACTORY__","__WEBPACK_AMD_DEFINE_ARRAY__","__WEBPACK_AMD_DEFINE_RESULT__","global","apple_phone","apple_ipod","apple_tablet","android_phone","android_tablet","amazon_phone","amazon_tablet","windows_phone","windows_tablet","other_blackberry","other_blackberry_10","other_opera","other_chrome","other_firefox","seven_inch","RegExp","match","regex","IsMobileClass","tmp","split","apple","phone","ipod","tablet","device","amazon","android","windows","other","blackberry","blackberry10","opera","firefox","chrome","instantiate","IM","Class","apply","undefined","content","locals","push","list","toString","result","i","length","item","join","mediaQuery","alreadyImportedModules","addStylesToDom","styles","options","domStyle","stylesInDom","refs","j","parts","addStyle","listToStyles","newStyles","css","sourceMap","part","insertStyleElement","styleElement","getHeadElement","lastStyleElementInsertedAtTop","styleElementsInsertedAtTop","insertAt","nextSibling","insertBefore","Error","removeStyleElement","parentNode","removeChild","idx","indexOf","splice","createStyleElement","createLinkElement","linkElement","rel","obj","update","singleton","styleIndex","singletonCounter","singletonElement","applyToSingletonTag","URL","createObjectURL","revokeObjectURL","Blob","btoa","updateLink","href","applyToTag","newObj","index","styleSheet","cssText","replaceText","cssNode","createTextNode","childNodes","unescape","encodeURIComponent","JSON","stringify","blob","oldSrc","memoize","fn","memo","arguments","isOldIE","toLowerCase","getElementsByTagName","newList","mayRemove","textStore","replacement","filter","Boolean","fullscreenElement","mozFullScreenElement","webkitFullscreenElement","msFullscreenElement","fullScreenError","vrEffect","exit","pruneObject","object","raycastable","vrObjects","VRObject","findObject","children","forEach","raycast","intersect","intersects","parent","vrObject","prune","raycaster","ray","origin","setFromMatrixPosition","camera","matrixWorld","direction","set","unproject","sub","normalize","intersectObjects","scene","Mesh","target","emit","render","now","Date","delta","Math","min","lastTick","vrControls","animationCallbacks","cb","updateMatrixWorld","renderLoop","going","requestAnimationFrame","visibilityChange","hidden","mozHidden","msHidden","webkitHidden","audioListener","volume","width","height","innerWidth","innerHeight","aspect","updateProjectionMatrix","renderer","setSize","initShake","lastX","lastY","lastZ","lastTime","threshold","time","diff","dist","current","accelerationIncludingGravity","deltaX","deltaY","deltaZ","abs","x","y","z","sqrt","vibrate","orientationPossible","initScene","attachCanvas","domElement","WebGLRenderer","antialias","event","console","log","Scene","bodyWrapper","name","moveTo","cameraWrapper","PerspectiveCamera","NEAR","FAR","add","AudioListener","VRControls","freeze","VRStereoEffect","near","far","screen","mouseControls","enabled","reset","lockOrientation","mozLockOrientation","orientation","lock","exitVR","position","rotation","mode","hmd","OrbitControls","target0","copy","dLight","DirectionalLight","castShadow","shadowCameraVisible","shadowMapWidth","shadowMapHeight","shadowCameraLeft","shadowCameraRight","shadowCameraTop","shadowCameraBottom","shadowCameraFar","shadowCameraNear","shadowDarkness","AmbientLight","canvas","Raycaster","ImageUtils","crossOrigin","eventEmitter","materials","nop","mozCancelFullScreen","webkitExitFullscreen","msExitFullscreen","objectMethods","animate","callback","end","requestFullScreen","times","n","method","key","creator","hasOwnProperty","Object","defineProperty","get","imageTexture","mapping","imageLoaded","scale","ctx","image","naturalWidth","naturalHeight","max","floor","getContext","drawImage","texture","needsUpdate","parse","isDataUri","dataUri","exec","urlRegex","images","hostname","port","Texture","material","threeTexture","textures","opts","Material","materialTypes","MeshLambertMaterial","map","assign","ambient","color","emissive","specularMap","normalMap","alphaMap","envMap","lightMap","val","assetPath","lambert","basic","MeshBasicMaterial","phong","MeshPhongMaterial","normal","MeshNormalMaterial","depth","MeshDepthMaterial","textureFiles","asphalt","repeat","brick-tiles","bricks","checkerboard","grass","metal-floor","shininess","metal","shading","SmoothShading","stone","tiles","weathered-wood","wood","url","scripts","currentScript","getAttribute","replace","standard","library","props","textureFactory","file","imagePath","Vector2","wrapS","wrapT","RepeatWrapping","materialDef","self","REVISION","cancelAnimationFrame","vendors","currTime","timeToCall","clearTimeout","performance","Number","EPSILON","pow","sign","Function","MOUSE","LEFT","MIDDLE","RIGHT","CullFaceNone","CullFaceBack","CullFaceFront","CullFaceFrontBack","FrontFaceDirectionCW","FrontFaceDirectionCCW","BasicShadowMap","PCFShadowMap","PCFSoftShadowMap","FrontSide","BackSide","DoubleSide","FlatShading","NoColors","FaceColors","VertexColors","NoBlending","NormalBlending","AdditiveBlending","SubtractiveBlending","MultiplyBlending","CustomBlending","AddEquation","SubtractEquation","ReverseSubtractEquation","MinEquation","MaxEquation","ZeroFactor","OneFactor","SrcColorFactor","OneMinusSrcColorFactor","SrcAlphaFactor","OneMinusSrcAlphaFactor","DstAlphaFactor","OneMinusDstAlphaFactor","DstColorFactor","OneMinusDstColorFactor","SrcAlphaSaturateFactor","NeverDepth","AlwaysDepth","LessDepth","LessEqualDepth","EqualDepth","GreaterEqualDepth","GreaterDepth","NotEqualDepth","MultiplyOperation","MixOperation","AddOperation","UVMapping","CubeReflectionMapping","CubeRefractionMapping","EquirectangularReflectionMapping","EquirectangularRefractionMapping","SphericalReflectionMapping","ClampToEdgeWrapping","MirroredRepeatWrapping","NearestFilter","NearestMipMapNearestFilter","NearestMipMapLinearFilter","LinearFilter","LinearMipMapNearestFilter","LinearMipMapLinearFilter","UnsignedByteType","ByteType","ShortType","UnsignedShortType","IntType","UnsignedIntType","FloatType","HalfFloatType","UnsignedShort4444Type","UnsignedShort5551Type","UnsignedShort565Type","AlphaFormat","RGBFormat","RGBAFormat","LuminanceFormat","LuminanceAlphaFormat","RGBEFormat","RGB_S3TC_DXT1_Format","RGBA_S3TC_DXT1_Format","RGBA_S3TC_DXT3_Format","RGBA_S3TC_DXT5_Format","RGB_PVRTC_4BPPV1_Format","RGB_PVRTC_2BPPV1_Format","RGBA_PVRTC_4BPPV1_Format","RGBA_PVRTC_2BPPV1_Format","LoopOnce","LoopRepeat","LoopPingPong","Projector","error","projectVector","vector","warn","project","unprojectVector","pickingRay","CanvasRenderer","clear","setClearColor","Color","fromArray","constructor","r","g","b","value","setHex","setStyle","hex","setRGB","setHSL","hue2rgb","q","t","h","s","l","euclideanModulo","clamp","handleAlpha","string","parseFloat","components","parseInt","size","charAt","ColorKeywords","clone","copyGammaToLinear","gammaFactor","copyLinearToGamma","safeInverse","convertGammaToLinear","convertLinearToGamma","getHex","getHexString","slice","getHSL","optionalTarget","hue","saturation","hsl","lightness","getStyle","offsetHSL","addColors","color1","color2","addScalar","multiply","multiplyScalar","lerp","alpha","equals","array","offset","toArray","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","Quaternion","w","_x","_y","_z","_w",{"end":{"file":"vr.js","comments_before":[],"nlb":false,"endpos":67199,"endcol":7,"endline":2517,"pos":67198,"col":6,"line":2517,"value":"x","type":"name","_comments_dumped":true},"start":{"file":"vr.js","comments_before":[],"nlb":false,"endpos":67199,"endcol":7,"endline":2517,"pos":67198,"col":6,"line":2517,"value":"x","type":"name","_comments_dumped":true},"name":"x"},"onChangeCallback","quaternion","setFromEuler","euler","Euler","c1","cos","c2","c3","s1","sin","s2","s3","order","setFromAxisAngle","axis","angle","halfAngle","setFromRotationMatrix","te","elements","m11","m12","m13","m21","m22","m23","m31","m32","m33","trace","setFromUnitVectors","v1","EPS","vFrom","vTo","Vector3","dot","crossVectors","inverse","conjugate","v","lengthSq","multiplyQuaternions","a","qax","qay","qaz","qaw","qbx","qby","qbz","qbw","multiplyVector3","applyQuaternion","slerp","qb","cosHalfTheta","halfTheta","acos","sinHalfTheta","ratioA","ratioB","onChange","qa","qm","setX","setY","setComponent","getComponent","addVectors","addScaledVector","subVectors","subScalar","scalar","isFinite","divide","divideScalar","clampScalar","minVal","maxVal","clampLength","ceil","round","roundToZero","negate","lengthManhattan","distanceTo","distanceToSquared","dx","dy","setLength","lerpVectors","v2","fromAttribute","attribute","itemSize","rotateAround","center","setZ","multiplyVectors","applyEuler","applyAxisAngle","applyMatrix3","e","applyMatrix4","applyProjection","d","qx","qy","qz","qw","ix","iy","iz","iw","matrix","Matrix4","multiplyMatrices","projectionMatrix","getInverse","transformDirection","cross","ax","ay","az","bx","by","bz","projectOnVector","projectOnPlane","planeNormal","reflect","angleTo","theta","dz","setEulerFromRotationMatrix","setEulerFromQuaternion","getPositionFromMatrix","getScaleFromMatrix","setFromMatrixScale","getColumnFromMatrix","setFromMatrixColumn","sx","sy","sz","me","Vector4","setW","setAxisAngleFromQuaternion","setAxisAngleFromRotationMatrix","epsilon","epsilon2","PI","xx","yy","zz","xy","xz","yz","_order","DefaultOrder","RotationOrders","asin","atan2","setFromQuaternion","makeRotationFromQuaternion","setFromVector3","reorder","newOrder","toVector3","optionalResult","Line3","line","distanceSq","distance","at","closestPointToPointParameter","startP","startEnd","point","clampToLine","startEnd2","startEnd_startP","closestPointToPoint","Box2","Infinity","setFromPoints","points","makeEmpty","il","expandByPoint","setFromCenterAndSize","halfSize","box","empty","expandByVector","expandByScalar","containsPoint","containsBox","getParameter","isIntersectionBox","clampPoint","distanceToPoint","clampedPoint","union","translate","Box3","setFromObject","scope","traverse","node","geometry","Geometry","vertices","BufferGeometry","attributes","positions","getBoundingSphere","Sphere","radius","Matrix3","Float32Array","n11","n12","n13","n21","n22","n23","n31","n32","n33","identity","multiplyVector3Array","applyToVector3Array","applyToBuffer","buffer","getX","getY","getZ","setXYZ","determinant","f","throwOnInvertible","det","msg","transpose","flattenToArrayOffset","getNormalMatrix","transposeIntoArray","n14","n24","n34","n41","n42","n43","n44","extractPosition","copyPosition","extractBasis","xAxis","yAxis","zAxis","makeBasis","extractRotation","scaleX","scaleY","scaleZ","makeRotationFromEuler","ae","af","be","bf","ce","cf","de","df","ac","ad","bc","bd","setRotationFromQuaternion","x2","y2","z2","wx","wy","wz","lookAt","eye","up","a11","a12","a13","a14","a21","a22","a23","a24","a31","a32","a33","a34","a41","a42","a43","a44","b11","b12","b13","b14","b21","b22","b23","b24","b31","b32","b33","b34","b41","b42","b43","b44","multiplyToArray","multiplyVector4","rotateAxis","crossVector","getPosition","setPosition","rotateX","rotateY","rotateZ","rotateByAxis","getMaxScaleOnAxis","scaleXSq","scaleYSq","scaleZSq","makeTranslation","makeRotationX","makeRotationY","makeRotationZ","makeRotationAxis","tx","ty","makeScale","compose","decompose","invSX","invSY","invSZ","makeFrustum","left","right","bottom","top","makePerspective","fov","ymax","degToRad","ymin","xmin","xmax","makeOrthographic","Ray","recast","directionDistance","distanceSqToPoint","distanceSqToSegment","segCenter","segDir","v0","optionalPointOnRay","optionalPointOnSegment","s0","sqrDist","extDet","segExtent","a01","b0","b1","invDet","isIntersectionSphere","sphere","intersectSphere","tca","d2","radius2","thc","t0","t1","isIntersectionPlane","plane","distToPoint","denominator","distanceToPlane","constant","intersectPlane","intersectBox","tmin","tmax","tymin","tymax","tzmin","tzmax","invdirx","invdiry","invdirz","intersectTriangle","edge1","edge2","backfaceCulling","DdN","DdQxE2","DdE1xQ","QdN","matrix4","optionalCenter","maxRadiusSq","intersectsSphere","radiusSum","deltaLengthSq","getBoundingBox","Frustum","p0","p1","p2","p3","p4","p5","planes","Plane","frustum","setFromMatrix","me0","me1","me2","me3","me4","me5","me6","me7","me8","me9","me10","me11","me12","me13","me14","me15","setComponents","intersectsObject","boundingSphere","computeBoundingSphere","negRadius","intersectsBox","d1","setFromNormalAndCoplanarPoint","setFromCoplanarPoints","inverseNormalLength","distanceToSphere","projectPoint","orthoPoint","perpendicularMagnitude","isIntersectionLine","startSign","endSign","intersectLine","coplanarPoint","m1","optionalNormalMatrix","normalMatrix","newNormal","newCoplanarPoint","generateUUID","chars","uuid","Array","rnd","random","mapLinear","a1","a2","b2","smoothstep","smootherstep","random16","randInt","low","high","randFloat","randFloatSpread","range","degreeToRadiansFactor","degrees","radToDeg","radianToDegreesFactor","radians","isPowerOfTwo","nearestPowerOfTwo","LN2","nextPowerOfTwo","Spline","interpolate","t2","t3","intPoint","weight","w2","w3","pa","pb","pc","pd","v3","initFromArray","getPoint","k","getControlPointsArray","coords","getLength","nSubDivisions","nSamples","oldIntPoint","oldPosition","tmpVec","chunkLengths","totalLength","chunks","total","reparametrizeByArcLength","samplingCoef","indexCurrent","indexNext","realDistance","sampling","newpoints","sl","Triangle","resultLengthSq","barycoordFromPoint","dot00","dot01","dot02","dot11","dot12","denom","invDenom","u","setFromPointsAndIndices","i0","i1","i2","triangle","area","midpoint","Channels","mask","channel","toggle","Clock","autoStart","startTime","oldTime","elapsedTime","running","getElapsedTime","getDelta","newTime","EventDispatcher","hasEventListener","removeEventListener","dispatchEvent","listener","_listeners","listeners","listenerArray","descSort","intersectObject","recursive","visible","params","Line","LOD","Points","Sprite","defineProperties","PointCloud","linePrecision","setFromCamera","OrthographicCamera","sort","objects","isArray","Object3D","onRotationChange","onQuaternionChange","Object3DIdCount","channels","DefaultUp","enumerable","modelViewMatrix","rotationAutoUpdate","matrixAutoUpdate","DefaultMatrixAutoUpdate","matrixWorldNeedsUpdate","receiveShadow","frustumCulled","renderOrder","userData","eulerOrder","useQuaternion","renderDepth","applyMatrix","setRotationFromAxisAngle","setRotationFromEuler","setRotationFromMatrix","rotateOnAxis","q1","translateOnAxis","translateX","translateY","translateZ","localToWorld","worldToLocal","getChildByName","getObjectByName","getObjectById","getObjectByProperty","child","getWorldPosition","getWorldQuaternion","getWorldRotation","getWorldScale","getWorldDirection","traverseVisible","traverseAncestors","updateMatrix","force","toJSON","meta","extractFromCache","cache","values","data","metadata","isRootObject","output","geometries","version","generator","Face3","materialIndex","vertexNormals","vertexColors","Face4","BufferAttribute","dynamic","updateRange","count","setDynamic","copyAt","index1","index2","copyArray","copyColorsArray","colors","copyIndicesArray","indices","copyVector2sArray","vectors","copyVector3sArray","copyVector4sArray","getW","setXY","setXYZW","Int8Attribute","Int8Array","Uint8Attribute","Uint8Array","Uint8ClampedAttribute","Uint8ClampedArray","Int16Attribute","Int16Array","Uint16Attribute","Uint16Array","Int32Attribute","Int32Array","Uint32Attribute","Uint32Array","Float32Attribute","Float64Attribute","Float64Array","DynamicBufferAttribute","InstancedBufferAttribute","meshPerAttribute","create","InterleavedBuffer","stride","InstancedInterleavedBuffer","InterleavedBufferAttribute","interleavedBuffer","GeometryIdCount","faces","faceVertexUvs","morphTargets","morphNormals","skinWeights","skinIndices","lineDistances","boundingBox","verticesNeedUpdate","elementsNeedUpdate","uvsNeedUpdate","normalsNeedUpdate","colorsNeedUpdate","lineDistancesNeedUpdate","groupsNeedUpdate","vertex","face","jl","computeBoundingBox","fromBufferGeometry","addFace","normals","tempNormals","uvs","tempUVs","uvs2","tempUVs2","uv","uv2","groups","group","computeFaceNormals","ab","fl","vA","vB","vC","computeVertexNormals","areaWeighted","vl","computeMorphNormals","__originalFaceNormal","__originalVertexNormals","tmpGeo","faceNormals","faceNormal","dstNormalsFace","dstNormalsVertex","computeTangents","computeLineDistances","merge","materialIndexOffset","vertexOffset","vertices1","vertices2","faces1","faces2","uvs1","vertexCopy","faceCopy","faceVertexNormals","faceVertexColors","uvCopy","mergeMesh","mesh","mergeVertices","verticesMap","unique","changes","precisionPoints","precision","faceIndicesToRemove","dupIndex","sortFacesByMaterialIndex","materialIndexSort","_id","newUvs1","newUvs2","setBit","getNormalIndex","hash","normalsHash","getColorIndex","colorsHash","getUvIndex","uvsHash","parameters","hasMaterial","hasFaceUv","hasFaceVertexUv","hasFaceNormal","hasFaceVertexNormal","hasFaceColor","hasFaceVertexColor","faceType","uvsCopy","kl","dispose","DirectGeometry","computeGroups","fromGeometry","hasFaceVertexUv2","morphTargetsLength","morphTargetsPosition","morphNormalsLength","morphTargetsNormal","hasSkinIndices","hasSkinWeights","vertexUvs","morphTarget","morphNormal","morphAttributes","drawRange","addIndex","setIndex","getIndex","addAttribute","removeAttribute","drawcalls","offsets","addDrawCall","indexOffset","addGroup","clearDrawCalls","clearGroups","setDrawRange","updateFromObject","direct","__directGeometry","lineDistance","fromDirectGeometry","TypeArray","bb","isNaN","pA","pB","pC","normalizeNormals","computeOffsets","attribute1","attributeArray1","attribute2","attributeArray2","attributeSize","MaxIndex","InstancedBufferGeometry","maxInstancedCount","instances","AnimationAction","clip","timeScale","loop","localRoot","loopCount","actionTime","clipTime","propertyBindings","setLocalRoot","updateTime","clipDeltaTime","previousClipTime","previousLoopCount","mixer","action","newClipTime","loopDelta","syncWith","warpToDuration","clipResults","getAt","getTimeScaleAt","getWeightAt","AnimationClip","tracks","track","keys","trim","optimize","results","CreateFromMorphTargetSequence","morphTargetSequence","fps","numMorphTargets","KeyframeTrack","keyComparer","NumberKeyframeTrack","findByName","clipArray","CreateClipsFromMorphTargetSequences","animationToMorphTargets","pattern","animationMorphTargets","clips","json","parseAnimation","animation","bones","nodeName","convertTrack","trackName","animationKeys","propertyName","trackType","animationKeyToValueFunc","animationKey","clipName","hierarchyTracks","hierarchy","morphTargetNames","morphTargetName","boneName","positionTrack","VectorKeyframeTrack","pos","quaternionTrack","QuaternionKeyframeTrack","rot","scaleTrack","scl","AnimationMixer","actions","propertyBindingMap","addAction","propertyBindingKey","propertyBinding","PropertyBinding","referenceCount","removeAllActions","properyBindingKey","unbind","removeAction","findActionByName","optionalFadeInDuration","fadeOut","fadeIn","warp","startTimeScale","endTimeScale","crossFade","fadeOutAction","fadeInAction","startEndRatio","endStartRatio","deltaTime","mixerDeltaTime","actionTimeScale","actionDeltaTime","actionResults","accumulate","AnimationUtils","getEqualsFunc","exemplarValue","typeName","interTrack","lerpFunc","getLerpFunc","lerp_object","slerp_object","lerp_number","lerp_boolean","lerp_boolean_immediate","lerp_string","lerp_string_immediate","lastIndex","validate","setResult","prevKey","constantToNext","currentKey","lerpValues","shift","timeOffset","endTime","firstKeysToRemove","lastKeysToRemove","currKey","newKeys","nextKey","compareValues","key0","key1","GetTrackTypeForTypeName","BooleanKeyframeTrack","StringKeyframeTrack","rootNode","originalValue","parseResults","parseTrackName","directoryName","objectName","objectIndex","propertyIndex","findNode","cumulativeValue","cumulativeWeight","isBound","lerpAlpha","lerpValue","setValue","getValue","equalsValue","triggerDirty","targetObject","skeleton","nodeProperty","remainingWeight","valueChanged","re","matches","searchSkeleton","bone","searchNodeSubtree","childNode","subTreeNode","value0","value1","clonedKeys","elementCount","valueType","jsonKey","quat","Camera","matrixWorldInverse","CubeCamera","cubeResolution","cameraPX","cameraNX","cameraPY","cameraNY","cameraPZ","cameraNZ","renderTarget","WebGLRenderTargetCube","format","magFilter","minFilter","updateCubeMap","generateMipmaps","activeCubeFace","setRenderTarget","zoom","cx","cy","setLens","focalLength","frameHeight","atan","setViewOffset","fullWidth","fullHeight","Light","onlyShadow","shadowCameraFov","shadow","shadowBias","bias","darkness","mapSize","groundColor","intensity","decay","exponent","LightShadow","HemisphereLight","skyColor","PointLight","SpotLight","Cache","files","Loader","onLoadStart","onLoadProgress","onLoadComplete","extractUrlBase","pop","initMaterials","texturePath","createMaterial","textureLoader","materialLoader","loadTexture","path","wrap","anisotropy","fullPath","loader","Handlers","load","setCrossOrigin","TextureLoader","MaterialLoader","blending","specular","mapDiffuseRepeat","mapDiffuseOffset","mapDiffuseWrap","mapDiffuseAnisotropy","mapLightRepeat","mapLightOffset","mapLightWrap","mapLightAnisotropy","aoMap","mapAORepeat","mapAOOffset","mapAOWrap","mapAOAnisotropy","bumpMap","mapBumpRepeat","mapBumpOffset","mapBumpWrap","mapBumpAnisotropy","bumpScale","mapNormalRepeat","mapNormalOffset","mapNormalWrap","mapNormalAnisotropy","normalScale","mapSpecularRepeat","mapSpecularOffset","mapSpecularWrap","mapSpecularAnisotropy","mapAlphaRepeat","mapAlphaOffset","mapAlphaWrap","mapAlphaAnisotropy","side","opacity","transparent","setTextures","handlers","XHRLoader","manager","DefaultLoadingManager","onLoad","onProgress","onError","cached","request","XMLHttpRequest","open","response","itemEnd","itemError","responseType","withCredentials","send","itemStart","setResponseType","setWithCredentials","ImageLoader","JSONLoader","statusDomElement","_statusDomElement","text","setTexturePath","parseModel","isBitSet","fi","zLength","colorIndex","normalIndex","uvIndex","isQuad","faceA","faceB","uvLayer","nUvLayers","parseSkin","influencesPerVertex","parseMorphing","dstVertices","srcVertices","morphColors","parseAnimations","outputAnimations","animations","concat","morphAnimationClips","LoadingManager","isLoading","itemsLoaded","itemsTotal","onStart","BufferGeometryLoader","typedArray","getTexture","uniforms","vertexShader","fragmentShader","alphaTest","depthTest","depthWrite","wireframe","wireframeLinewidth","sizeAttenuation","displacementMap","displacementScale","displacementBias","combine","reflectivity","lightMapIntensity","aoMapIntensity","ObjectLoader","substring","lastIndexOf","parseGeometries","parseImages","parseTextures","parseMaterials","parseObject","geometryLoader","bufferGeometryLoader","widthSegments","heightSegments","BoxGeometry","depthSegments","CircleBufferGeometry","segments","thetaStart","thetaLength","CircleGeometry","CylinderGeometry","radiusTop","radiusBottom","radialSegments","openEnded","SphereGeometry","phiStart","phiLength","SphereBufferGeometry","DodecahedronGeometry","detail","IcosahedronGeometry","OctahedronGeometry","TetrahedronGeometry","RingGeometry","innerRadius","outerRadius","thetaSegments","phiSegments","TorusGeometry","tube","tubularSegments","arc","TorusKnotGeometry","heightScale","loadImage","parseConstant","getGeometry","getMaterial","Group","levels","level","addLevel","CubeTextureLoader","urls","CubeTexture","DataTextureLoader","BinaryTextureLoader","_parser","DataTexture","texData","mipmaps","mipmapCount","CompressedTextureLoader","CompressedTexture","texDatas","isCubemap","MaterialIdCount","blendSrc","blendDst","blendEquation","blendSrcAlpha","blendDstAlpha","blendEquationAlpha","depthFunc","colorWrite","polygonOffset","polygonOffsetFactor","polygonOffsetUnits","overdraw","_needsUpdate","setValues","newValue","currentValue","wrapAround","boolean","wrapRGB","LineBasicMaterial","linewidth","linecap","linejoin","fog","LineDashedMaterial","dashSize","gapSize","refractionRatio","wireframeLinecap","wireframeLinejoin","skinning","emissiveMap","MultiMaterial","MeshFaceMaterial","PointsMaterial","PointCloudMaterial","ParticleBasicMaterial","ParticleSystemMaterial","ShaderMaterial","defines","lights","derivatives","defaultAttributeValues","index0AttributeName","UniformsUtils","RawShaderMaterial","SpriteMaterial","TextureIdCount","sourceFile","DEFAULT_IMAGE","DEFAULT_MAPPING","premultiplyAlpha","flipY","unpackAlignment","onUpdate","getDataURL","toDataURL","transformUv","CanvasTexture","VideoTexture","video","readyState","HAVE_ENOUGH_DATA","inverseMatrix","testPoint","rayPointDistanceSq","localThresholdSq","intersectPoint","distanceToRay","localThreshold","ParticleSystem","LineSegments","precisionSq","vStart","vEnd","interSegment","interRay","step","distSq","faceIndex","nbVertices","LineStrip","LinePieces","updateMorphTargets","morphTargetBase","morphTargetInfluences","morphTargetDictionary","ml","getMorphTargetIndexByName","uvIntersection","uv1","uv3","barycoord","checkIntersection","intersectionPointWorld","checkBufferGeometryIntersection","intersection","intersectionPoint","uvA","uvB","uvC","tempA","tempB","tempC","fvA","fvB","fvC","isFaceMaterial","faceMaterial","morphInfluences","tl","influence","targets","uvs_f","Bone","skin","Skeleton","boneInverses","useVertexTexture","identityMatrix","boneTextureWidth","boneTextureHeight","boneMatrices","boneTexture","calculateInverses","bl","pose","offsetMatrix","SkinnedMesh","bindMode","bindMatrix","bindMatrixInverse","gbone","rotq","normalizeSkinWeights","sw","getObjectForDistance","matrixPosition","guessSizeSq","Particle","LensFlare","lensFlares","positionScreen","customUpdateCallback","updateLensFlares","flare","vecX","vecY","wantedRotation","overrideMaterial","autoUpdate","Fog","FogExp2","density","ShaderChunk","merged","uniforms_src","uniforms_dst","parameter_src","UniformsLib","common","diffuse","offsetRepeat","flipEnvMap","aomap","lightmap","emissivemap","bumpmap","normalmap","displacementmap","fogDensity","fogNear","fogFar","fogColor","ambientLightColor","directionalLightDirection","directionalLightColor","hemisphereLightDirection","hemisphereLightSkyColor","hemisphereLightGroundColor","pointLightColor","pointLightPosition","pointLightDistance","pointLightDecay","spotLightColor","spotLightPosition","spotLightDirection","spotLightDistance","spotLightAngleCos","spotLightExponent","spotLightDecay","psColor","shadowmap","shadowMap","shadowMapSize","shadowMatrix","ShaderLib","dashed","totalSize","mNear","mFar","cube","tCube","tFlip","equirect","tEquirect","depthRGBA","distanceRGBA","lightPos","glClearColor","_premultipliedAlpha","_gl","clearColor","setDefaultGLState","state","viewport","_viewportX","_viewportY","_viewportWidth","_viewportHeight","_clearColor","_clearAlpha","resetGLState","_currentProgram","_currentCamera","_currentGeometryProgram","_currentMaterialId","_lightsNeedUpdate","onContextLost","preventDefault","properties","onTextureDispose","deallocateTexture","_infoMemory","onRenderTargetDispose","deallocateRenderTarget","onMaterialDispose","deallocateMaterial","textureProperties","__image__webglTextureCube","deleteTexture","__webglInit","__webglTexture","renderTargetProperties","deleteFramebuffer","__webglFramebuffer","deleteRenderbuffer","__webglRenderbuffer","releaseMaterialProgramReference","programInfo","program","programCache","releaseProgram","setupVertexAttributes","startIndex","extension","extensions","initAttributes","geometryAttributes","programAttributes","getAttributes","materialDefaultAttributeValues","programAttribute","geometryAttribute","getAttributeBuffer","enableAttributeAndDivisor","enableAttribute","bindBuffer","ARRAY_BUFFER","vertexAttribPointer","FLOAT","BYTES_PER_ELEMENT","vertexAttrib2fv","vertexAttrib3fv","vertexAttrib4fv","vertexAttrib1fv","disableUnusedAttributes","numericalSort","painterSortStable","reversePainterSortStable","pushRenderItem","transparentObjects","transparentObjectsLastIndex","opaqueObjects","opaqueObjectsLastIndex","renderItem","_vector3","projectObject","sprites","ImmediateRenderObject","_this","sortObjects","_projScreenMatrix","_frustum","groupMaterial","renderObjects","renderList","setMaterial","setProgram","renderBufferImmediate","renderBufferDirect","initMaterial","materialProperties","getParameters","code","getProgramCode","programChange","shaderID","shader","__webglShader","acquireProgram","numSupportedMorphTargets","maxMorphTargets","numSupportedMorphNormals","maxMorphNormals","uniformsList","uniformLocations","getUniforms","setMaterialFaces","setBlending","setDepthFunc","setDepthTest","setDepthWrite","setColorWrite","setPolygonOffset","CULL_FACE","setFlipSided","_usedTextureUnits","refreshProgram","refreshMaterial","refreshLights","p_uniforms","m_uniforms","useProgram","uniformMatrix4fv","capabilities","logarithmicDepthBuffer","uniform1f","logDepthBufFC","cameraPosition","uniform3f","viewMatrix","floatVertexTextures","textureUnit","getTextureUnit","uniform1i","setTexture","boneGlobalMatrices","refreshUniformsFog","setupLights","refreshUniformsLights","_lights","markUniformsLightsNeedsUpdate","refreshUniformsCommon","refreshUniformsLine","refreshUniformsDash","refreshUniformsParticle","refreshUniformsPhong","_shadowPass","refreshUniformsShadow","loadUniformsGeneric","loadUniformsMatrices","modelMatrix","uvScaleMap","WebGLRenderTarget","_canvas","directional","distances","decays","spot","directions","anglesCos","exponents","hemi","skyColors","groundColors","light","uniformMatrix3fv","maxTextures","uniform","uniform2f","uniform4f","uniform1iv","uniform3iv","uniform1fv","uniform2fv","uniform3fv","uniform4fv","_array","i3","i4","setCubeTexture","setCubeTextureDynamic","setColorLinear","ll","zlights","dirColors","dirPositions","pointColors","pointPositions","pointDistances","pointDecays","spotColors","spotPositions","spotDistances","spotDirections","spotAnglesCos","spotExponents","spotDecays","hemiSkyColors","hemiGroundColors","hemiPositions","dirLength","pointLength","spotLength","hemiLength","dirCount","pointCount","spotCount","hemiCount","dirOffset","pointOffset","spotOffset","hemiOffset","_direction","setTextureParameters","textureType","isImagePowerOfTwo","texParameteri","TEXTURE_WRAP_S","paramThreeToGL","TEXTURE_WRAP_T","TEXTURE_MAG_FILTER","TEXTURE_MIN_FILTER","CLAMP_TO_EDGE","filterFallback","__currentAnisotropy","texParameterf","TEXTURE_MAX_ANISOTROPY_EXT","getMaxAnisotropy","uploadTexture","slot","createTexture","activeTexture","TEXTURE0","bindTexture","TEXTURE_2D","pixelStorei","UNPACK_FLIP_Y_WEBGL","UNPACK_PREMULTIPLY_ALPHA_WEBGL","UNPACK_ALIGNMENT","clampToMaxSize","maxTextureSize","textureNeedsPowerOfTwo","makePowerOfTwo","glFormat","glType","mipmap","texImage2D","getCompressedTextureFormats","compressedTexImage2D","generateMipmap","__version","maxSize","context","HTMLImageElement","HTMLCanvasElement","TEXTURE_CUBE_MAP","isCompressed","isDataTexture","cubeImage","autoScaleCubemaps","maxCubemapSize","TEXTURE_CUBE_MAP_POSITIVE_X","setupFrameBuffer","framebuffer","textureTarget","bindFramebuffer","FRAMEBUFFER","framebufferTexture2D","COLOR_ATTACHMENT0","setupRenderBuffer","renderbuffer","bindRenderbuffer","RENDERBUFFER","depthBuffer","stencilBuffer","renderbufferStorage","DEPTH_COMPONENT16","framebufferRenderbuffer","DEPTH_ATTACHMENT","DEPTH_STENCIL","DEPTH_STENCIL_ATTACHMENT","RGBA4","updateRenderTargetMipmap","NEAREST","LINEAR","REPEAT","MIRRORED_REPEAT","NEAREST_MIPMAP_NEAREST","NEAREST_MIPMAP_LINEAR","LINEAR_MIPMAP_NEAREST","LINEAR_MIPMAP_LINEAR","UNSIGNED_BYTE","UNSIGNED_SHORT_4_4_4_4","UNSIGNED_SHORT_5_5_5_1","UNSIGNED_SHORT_5_6_5","BYTE","SHORT","UNSIGNED_SHORT","INT","UNSIGNED_INT","HALF_FLOAT_OES","ALPHA","RGB","RGBA","LUMINANCE","LUMINANCE_ALPHA","FUNC_ADD","FUNC_SUBTRACT","FUNC_REVERSE_SUBTRACT","ZERO","ONE","SRC_COLOR","ONE_MINUS_SRC_COLOR","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","DST_ALPHA","ONE_MINUS_DST_ALPHA","DST_COLOR","ONE_MINUS_DST_COLOR","SRC_ALPHA_SATURATE","COMPRESSED_RGB_S3TC_DXT1_EXT","COMPRESSED_RGBA_S3TC_DXT1_EXT","COMPRESSED_RGBA_S3TC_DXT3_EXT","COMPRESSED_RGBA_S3TC_DXT5_EXT","COMPRESSED_RGB_PVRTC_4BPPV1_IMG","COMPRESSED_RGB_PVRTC_2BPPV1_IMG","COMPRESSED_RGBA_PVRTC_4BPPV1_IMG","COMPRESSED_RGBA_PVRTC_2BPPV1_IMG","MIN_EXT","MAX_EXT","_context","_width","_height","pixelRatio","_alpha","_depth","_stencil","stencil","_antialias","premultipliedAlpha","_preserveDrawingBuffer","preserveDrawingBuffer","autoClear","autoClearColor","autoClearDepth","autoClearStencil","gammaInput","gammaOutput","_currentFramebuffer","_currentWidth","_currentHeight","_infoRender","calls","info","memory","programs","WebGLExtensions","WebGLCapabilities","WebGLState","WebGLProperties","WebGLObjects","WebGLPrograms","bufferRenderer","WebGLBufferRenderer","indexedBufferRenderer","WebGLIndexedBufferRenderer","WebGLShadowMap","spritePlugin","SpritePlugin","lensFlarePlugin","LensFlarePlugin","getContextAttributes","forceContextLoss","loseContext","MAX_TEXTURE_MAX_ANISOTROPY_EXT","getPrecision","getPixelRatio","setPixelRatio","getSize","updateStyle","setViewport","getViewport","dimensions","setScissor","scissor","enableScissorTest","setScissorTest","getClearColor","getClearAlpha","setClearAlpha","bits","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT","clearDepth","clearStencil","clearTarget","buffers","hasPositions","createBuffer","hasNormals","hasUvs","hasColors","bufferData","positionArray","DYNAMIC_DRAW","normalArray","nx","ny","nz","uvArray","colorArray","drawArrays","TRIANGLES","updateBuffers","geometryProgram","activeInfluences","getWireframeAttribute","ELEMENT_ARRAY_BUFFER","dataStart","dataCount","rangeStart","rangeCount","groupStart","groupCount","drawStart","drawEnd","drawCount","setLineWidth","setMode","LINES","renderInstances","lineWidth","LINE_STRIP","POINTS","forceClear","isTargetPowerOfTwo","setFaceCulling","cullFace","frontFaceDirection","frontFace","CW","CCW","BACK","FRONT","FRONT_AND_BACK","complete","isCube","createFramebuffer","createRenderbuffer","shareDepthFrom","vx","vy","readRenderTargetPixels","restore","IMPLEMENTATION_COLOR_READ_FORMAT","IMPLEMENTATION_COLOR_READ_TYPE","checkFramebufferStatus","FRAMEBUFFER_COMPLETE","readPixels","supportsFloatTextures","supportsHalfFloatTextures","supportsStandardDerivatives","supportsCompressedTextureS3TC","supportsCompressedTexturePVRTC","supportsBlendMinMax","supportsVertexTextures","vertexTextures","supportsInstancedArrays","addPrePlugin","addPostPlugin","updateShadowMap","shadowMapEnabled","shadowMapType","shadowMapCullFace","shadowMapDebug","debug","drawArraysInstancedANGLE","drawElements","drawElementsInstancedANGLE","gl","getExtension","getMaxPrecision","getShaderPrecisionFormat","VERTEX_SHADER","HIGH_FLOAT","FRAGMENT_SHADER","MEDIUM_FLOAT","MAX_TEXTURE_IMAGE_UNITS","maxVertexTextures","MAX_VERTEX_TEXTURE_IMAGE_UNITS","MAX_TEXTURE_SIZE","MAX_CUBE_MAP_TEXTURE_SIZE","maxAttributes","MAX_VERTEX_ATTRIBS","maxVertexUniforms","MAX_VERTEX_UNIFORM_VECTORS","maxVaryings","MAX_VARYING_VECTORS","maxFragmentUniforms","MAX_FRAGMENT_UNIFORM_VECTORS","floatFragmentTextures","_maxPrecision","WebGLGeometries","onGeometryDispose","buffergeometry","_bufferGeometry","deleteAttributes","property","deleteAttribute","__webglBuffer","deleteBuffer","removeAttributeBuffer","updateAttribute","bufferType","attributeProperties","updateBuffer","usage","STATIC_DRAW","bufferSubData","subarray","edges","checkEdge","WebGLProgram","generateDefines","fetchUniformLocations","identifiers","getProgramParameter","ACTIVE_UNIFORMS","getActiveUniform","getUniformLocation","suffixPos","substr","fetchAttributeLocations","ACTIVE_ATTRIBUTES","getActiveAttrib","getAttribLocation","filterEmptyLine","programIdCount","shadowMapTypeDefine","envMapTypeDefine","envMapModeDefine","envMapBlendingDefine","prefixVertex","prefixFragment","gammaFactorDefine","customDefines","createProgram","maxDirLights","maxPointLights","maxSpotLights","maxHemiLights","maxShadows","maxBones","flatShading","doubleSided","flipSided","pointLightShadows","useFog","fogExp","vertexGlsl","fragmentGlsl","glVertexShader","WebGLShader","glFragmentShader","attachShader","bindAttribLocation","linkProgram","programLog","getProgramInfoLog","vertexLog","getShaderInfoLog","fragmentLog","runnable","haveDiagnostics","LINK_STATUS","getError","VALIDATE_STATUS","diagnostics","prefix","deleteShader","cachedUniforms","cachedAttributes","destroy","deleteProgram","usedTimes","allocateBones","nVertexUniforms","nVertexMatrices","allocateLights","dirLights","pointLights","spotLights","hemiLights","allocateShadows","shaderIDs","parameterNames","maxLightCount","allocatedShadows","envMapMode","parameterName","pl","addLineNumbers","lines","createShader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","_renderer","_objects","getDepthMaterial","isPointLight","lightPositionWorld","newMaterial","materialVariants","_depthMaterials","customMaterial","customDepthMaterial","_distanceMaterials","customDistanceMaterial","useMorphing","useSkinning","variantIndex","_MorphingFlag","_SkinningFlag","_renderList","_state","_lookTarget","_lightPositionWorld","_NumberOfMaterialVariants","cubeDirections","cubeUps","cube2DViewPorts","_vector4","depthShader","depthUniforms","distanceShader","distanceUniforms","depthMaterial","distanceMaterial","faceCount","BLEND","shadowCamera","vpWidth","vpHeight","shadowFilter","pars","vpDimensions","clearAlpha","newAttributes","enabledAttributes","attributeDivisors","compressedTextureFormats","currentBlending","currentBlendEquation","currentBlendSrc","currentBlendDst","currentBlendEquationAlpha","currentBlendSrcAlpha","currentBlendDstAlpha","currentDepthFunc","currentDepthWrite","currentColorWrite","currentFlipSided","currentLineWidth","currentPolygonOffsetFactor","currentPolygonOffsetUnits","currentTextureSlot","currentBoundTextures","DEPTH_TEST","LEQUAL","blendFunc","enableVertexAttribArray","vertexAttribDivisorANGLE","disableVertexAttribArray","formats","COMPRESSED_TEXTURE_FORMATS","blendEquationSeparate","blendFuncSeparate","NEVER","ALWAYS","LESS","EQUAL","GEQUAL","GREATER","NOTEQUAL","depthMask","colorMask","factor","units","POLYGON_OFFSET_FILL","scissorTest","SCISSOR_TEST","webglSlot","webglType","webglTexture","boundTexture","flares","vertexBuffer","elementBuffer","tempTexture","occlusionTexture","hasVertexTexture","renderType","occlusionMap","screenPosition","viewportWidth","viewportHeight","tempPosition","invAspect","halfViewportWidth","halfViewportHeight","screenPositionPixels","TEXTURE1","copyTexImage2D","sprite","uvOffset","uvScale","fogType","fillStyle","fillRect","spritePosition","spriteRotation","spriteScale","oldFogType","sceneFogType","CurveUtils","tangentQuadraticBezier","tangentCubicBezier","tangentSpline","h00","h10","h01","h11","GeometryUtils","geometry1","geometry2","loadTextureCube","loadCompressedTexture","loadCompressedTextureCube","SceneUtils","createMultiMaterialObject","detach","attach","ShapeUtils","contour","triangulate","snip","verts","px","py","aX","aY","bX","bY","cX","cY","apx","apy","bpx","bpy","cpx","cpy","cCROSSap","bCROSScp","aCROSSbp","vertIndices","nv","triangulateShape","holes","point_in_segment_2D_colin","inSegPt1","inSegPt2","inOtherPt","intersect_segments_2D","inSeg1Pt1","inSeg1Pt2","inSeg2Pt1","inSeg2Pt2","inExcludeAdjacentSegs","seg1dx","seg1dy","seg2dx","seg2dy","seg1seg2dx","seg1seg2dy","limit","perpSeg1","perpSeg2","factorSeg1","seg1Pt","seg2Pt","seg1min","seg1max","seg1minVal","seg1maxVal","seg2min","seg2max","seg2minVal","seg2maxVal","isPointInsideAngle","inVertex","inLegFromPt","inLegToPt","legFromPtX","legFromPtY","legToPtX","legToPtY","otherPtX","otherPtY","from2toAngle","from2otherAngle","other2toAngle","removeHoles","isCutLineInsideAngles","inShapeIdx","inHoleIdx","lastShapeIdx","shape","prevShapeIdx","nextShapeIdx","insideAngle","hole","lastHoleIdx","prevHoleIdx","nextHoleIdx","intersectsShapeEdge","inShapePt","inHolePt","sIdx","nextIdx","intersectsHoleEdge","ihIdx","chkHole","hIdx","indepHoles","holeIndex","shapeIndex","shapePt","holePt","holeIdx","cutKey","tmpShape1","tmpShape2","tmpHole1","tmpHole2","failedCuts","hl","minShapeIndex","counter","h2","allPointsMap","allpoints","shapeWithoutHoles","triangles","isClockWise","pts","b2p0","b2p1","b2p2","b3","b3p0","b3p1","b3p2","b3p3","Audio","createBufferSource","onended","onEnded","gain","createGain","connect","destination","panner","createPanner","autoplay","playbackRate","isPlaying","onload","decodeAudioData","currentTime","disconnect","setFilter","getFilter","setPlaybackRate","getPlaybackRate","setLoop","getLoop","setRefDistance","refDistance","getRefDistance","setRolloffFactor","rolloffFactor","getRolloffFactor","setVolume","getVolume","AudioContext","webkitAudioContext","setOrientation","Curve","getPointAt","getUtoTmapping","getPoints","divisions","getSpacedPoints","lengths","getLengths","cacheArcLengths","last","sum","updateArcLengths","targetArcLength","arcLengths","comparison","lengthBefore","lengthAfter","segmentLength","segmentFraction","getTangent","pt1","pt2","vec","getTangentAt","Utils","getPointFunc","CurvePath","curves","autoClose","curve","closePath","startPoint","endPoint","LineCurve","curveLengths","getCurveLengths","lens","cacheLengths","sums","createPointsGeometry","createGeometry","createSpacedPointsGeometry","Path","fromPoints","lineTo","args","lastargs","x0","y0","quadraticCurveTo","aCPx","aCPy","QuadraticBezierCurve","bezierCurveTo","aCP1x","aCP1y","aCP2x","aCP2y","CubicBezierCurve","splineThru","npts","SplineCurve","aRadius","aStartAngle","aEndAngle","aClockwise","absarc","absellipse","ellipse","xRadius","yRadius","aRotation","EllipseCurve","lastPoint","closedPath","cpx2","cpy2","cpx1","cpy1","cpx0","cpy0","laste","spts","spline","deltaAngle","tdivisions","toShapes","isCCW","noHoles","extractSubpaths","inActions","subPaths","lastPath","toShapesNoHoles","inSubpaths","shapes","tmpPath","tmpShape","Shape","isPointInsidePolygon","inPt","inPolygon","polyLen","inside","edgeLowPt","edgeHighPt","edgeDx","edgeDy","perpEdge","solid","holesFirst","tmpPoints","betterShapeHoles","newShapes","newShapeHoles","mainIdx","ambiguous","toChange","sLen","sho","ho","hole_unassigned","s2Idx","froms","tos","tmpHoles","extrude","ExtrudeGeometry","makeGeometry","ShapeGeometry","getPointsHoles","holesPts","extractAllPoints","extractPoints","tangent","point0","point1","point2","point3","ArcCurve","LineCurve3","QuadraticBezierCurve3","CubicBezierCurve3","SplineCurve3","CatmullRomCurve3","CubicPoly","pz","x1","c0","initNonuniformCatmullRom","x3","dt0","dt1","dt2","initCatmullRom","tension","calc","ClosedSplineCurve3","buildPlane","udir","vdir","gridX","gridY","width_half","height_half","gridX1","gridY1","segment_width","segment_height","uva","uvb","uvc","uvd","depth_half","CubeGeometry","ii","segment","heightHalf","verticesRow","uvsRow","na","nb","tanTheta","v4","n1","n2","n3","n4","uv4","EdgesGeometry","thresholdAngle","sortFunction","thresholdDot","edge","vert1","vert2","face1","face2","addShapeList","addShape","scalePt2","pt","getBevelVec","inPrev","inNext","v_trans_x","v_trans_y","shrink_by","v_prev_x","v_prev_y","v_next_x","v_next_y","v_prev_lensq","collinear0","v_prev_len","v_next_len","ptPrevShift_x","ptPrevShift_y","ptNextShift_x","ptNextShift_y","sf","v_trans_lensq","direction_eq","buildLidFaces","bevelEnabled","layer","vlen","flen","f3","steps","bevelSegments","buildSideFaces","layeroffset","sidewalls","ahole","slen1","slen2","f4","shapesOffset","uvgen","generateTopUV","wallContour","stepIndex","stepsLength","contourIndex1","contourIndex2","generateSideWallUV","extrudePts","splineTube","binormal","position2","amount","bevelThickness","bevelSize","curveSegments","extrudePath","extrudeByPath","UVGenerator","WorldUVGenerator","frames","TubeGeometry","FrenetFrames","shapePoints","reverse","bs","vert","contourMovements","oneHoleMovements","holesMovements","verticesMovements","binormals","indexA","indexB","indexC","indexD","LatheGeometry","inversePointLength","inverseSegments","phi","np","base","u0","u1","PlaneGeometry","PlaneBufferGeometry","offset2","o","radiusStep","thetaSegment","thetaEnd","vertexCount","getPos","in_q","in_p","cu","su","quOverP","cs","tz","grid","tang","bitan","ip","jp","closed","taper","NoTaper","numpoints","pos2","tangents","SinusoidalTaper","initialNormal3","smallest","MAX_VALUE","mat","PolyhedronGeometry","prepare","that","azimuth","inclination","make","centroid","azi","correctUV","subdivide","cols","aj","bj","rows","ParametricGeometry","func","slices","stacks","sliceCount","WireframeGeometry","numEdges","ol","drawcall","numTris","AxisHelper","ArrowHelper","lineGeometry","coneGeometry","dir","headLength","headWidth","cone","setDirection","setColor","BoxHelper","BoundingBoxHelper","CameraHelper","addLine","addPoint","pointMap","hexFrustum","hexCone","hexUp","hexTarget","hexCross","setPoint","DirectionalLightHelper","lightPlane","targetLine","EdgesHelper","FaceNormalsHelper","nNormals","objGeometry","GridHelper","setColors","colorCenterLine","colorGrid","HemisphereLightHelper","sphereSize","lightSphere","PointLightHelper","SkeletonHelper","getBoneList","boneList","matrixWorldInv","boneMatrix","SpotLightHelper","vector2","coneLength","coneWidth","VertexNormalsHelper","objPos","objNorm","WireframeHelper","renderCallback","MorphBlendMesh","animationsMap","animationsList","numFrames","startFrame","endFrame","createAnimation","setAnimationWeight","lastFrame","currentFrame","active","directionBackwards","mirroredLoop","autoCreateAnimations","firstAnimation","frameRanges","morph","setAnimationDirectionForward","setAnimationDirectionBackward","setAnimationFPS","setAnimationDuration","setAnimationTime","getAnimationTime","getAnimationDuration","playAnimation","stopAnimation","frameTime","keyframe","mix","createForEach","arrayFunc","eachFunc","collection","iteratee","thisArg","bindCallback","arrayEach","baseEach","baseForOwn","baseFor","baseProperty","createBaseEach","fromRight","isLength","iterable","toObject","createBaseFor","keysFunc","MAX_SAFE_INTEGER","isObject","isArrayLike","isIndex","reIsUint","shimKeys","keysIn","propsLength","allowIndexes","isArguments","Ctor","isProto","skipIndexes","getNative","objectProto","nativeKeys","isObjectLike","isNative","isFunction","objToString","funcTag","reIsNative","fnToString","reIsHostCtor","propertyIsEnumerable","arrayTag","nativeIsArray","argCount","accumulator","assignWith","customizer","baseAssign","createAssigner","baseCopy","assigner","restParam","sources","guard","isIterateeCall","TypeError","FUNC_ERROR_TEXT","nativeMax","rest","otherArgs","webpackContext","req","webpackContextResolve","./asphalt.jpg","./brick-tiles.jpg","./bricks-normal.jpg","./bricks-specular.jpg","./bricks.jpg","./checkerboard.png","./grass.jpg","./metal-floor.jpg","./metal.jpg","./stone.jpg","./tiles.jpg","./weathered-wood.jpg","./wood.jpg","resolve","scratchVector1","scratchVector2","cameraViewProjectionMatrix","isNear","wasNear","NEAR_DISTANCE","allObjects","prop","WeakMap","hide","show","moveX","moveY","moveUp","moveDown","moveZ","setScale","once","off","methods","descriptors","callable","descriptor","configurable","writable","__ee__","__eeOnceListener__","candidate","normalizeOpts","isCallable","contains","dscr","desc","gs","foo","bar","trzy","dest","process","String","str","searchString","DeviceOrientationControls","deviceOrientation","screenOrientation","onDeviceOrientationChangeEvent","onScreenOrientationChangeEvent","setObjectQuaternion","zee","q0","beta","gamma","orient","getAutoRotationAngle","autoRotateSpeed","getZoomScale","zoomSpeed","onMouseDown","button","mouseButtons","ORBIT","noRotate","STATE","ROTATE","rotateStart","clientX","clientY","ZOOM","noZoom","DOLLY","dollyStart","PAN","noPan","panStart","NONE","onMouseMove","onMouseUp","startEvent","rotateEnd","rotateDelta","rotateLeft","clientWidth","rotateSpeed","rotateUp","clientHeight","dollyEnd","dollyDelta","dollyIn","dollyOut","panEnd","panDelta","pan","endEvent","onMouseWheel","stopPropagation","wheelDelta","onKeyDown","noKeys","UP","keyPanSpeed","BOTTOM","touchstart","touches","TOUCH_ROTATE","pageX","pageY","TOUCH_DOLLY","TOUCH_PAN","touchmove","touchend","minDistance","maxDistance","autoRotate","minPolarAngle","maxPolarAngle","minAzimuthAngle","maxAzimuthAngle","panOffset","phiDelta","thetaDelta","lastPosition","lastQuaternion","position0","quatInverse","changeEvent","panLeft","panUp","targetDistance","dollyScale","getPolarAngle","getAzimuthalAngle","addSupportedType","supportedTypes","_oldConsole","Ray origin","Ray direction","special","table","perspectiveMatrixFromVRFieldOfView","zNear","zFar","outMat","out","upTan","upDegrees","RADIANS","downTan","downDegrees","leftTan","leftDegrees","rightTan","rightDegrees","xScale","yScale","hmdDevice","hmdWidth","hmdHeight","offsetWidth","offsetHeight","updateProjection","fovLeft","fovRight","leftEyeParams","rightEyeParams","leftEyeRect","rightEyeRect","leftEyeViewport","rightEyeViewport","getEyeParameters","renderRect","currentFieldOfView","setFieldOfView","eyeOffsetLeft","eyeTranslation","eyeOffsetRight","leftRenderRect","rightRenderRect","getRecommendedEyeRenderRect","getCurrentEyeFieldOfView","getRecommendedEyeFieldOfView","getEyeTranslation","cameraLeft","cameraRight","gotVRDevices","devices","HMDVRDevice","hardwareUnitId","deviceName","setTimewarp","fullScreenParam","vrDisplay","poll","pollTimeout","scan","onFullscreenChange","vrPreview","separation","getVRDevices","then","mozGetVRDevices","leftScene","rightScene","drawingBufferWidth","stereo","PositionSensorVRDevice","sensorDevice","resetSensor","deviceOrientationChange","deviceControls","vrState","zeroAngle","vrBrowser","getState","hasOrientation","hasPosition","./box","./box.js","./cylinder","./cylinder.js","./empty","./empty.js","./floor","./floor.js","./grid","./grid.js","./image","./image.js","./panorama","./panorama.js","./sky","./sky.js","./sound","./sound.js","./sphere","./sphere.js","./text","./text.js","./torus","./torus.js","./video","./video.js","cylinder","radiusSegments","tex","TAU","HALF_PI","mod","sinTheta","cosTheta","sinPhi","cosPhi","altitude","sunPosition","exp","Sky","setOptions","param","setAltitude","setAzimuth","luminance","turbidity","reileigh","mieCoefficient","mieDirectionalG","skyShader","skyUniforms","skyMat","skyGeo","skyMesh","started","input","HTMLAudioElement","canPlayType","onerror","linearRampToValueAtTime","fontSizeRegex","newLineRegex","spaceRegex","log2","word","spaceWidth","measureText","totalWidth","wordsWidth","words","letter","inherit","fontSize","padding","lineHeight","measure","getComputedStyle","resolution","wrapped","font","reduce","previous","textAlign","textBaseline","space","fillText","textWidth","textHeight","wordWidth","extRegex","num","loadedMetadata","newAspectRatio","vid","videoWidth","videoHeight","aspectRatio","playing","setSource","ext","host","vol","muted","MediaError","MEDIA_ERR_DECODE","touchStart"],"mappings":"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","file":"vr.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t(function () {\n\t\t'use strict';\n\t\n\t\t//global-ish declarations\n\t\tvar VR,\n\t\t\tNoSleep = __webpack_require__(1).NoSleep,\n\t\t\tisMobile = __webpack_require__(2);\n\t\n\t\tfunction initRequirements() {\n\t\t\t//load styles\n\t\t\t__webpack_require__(3);\n\t\n\t\t\tVR = __webpack_require__(7);\n\t\t}\n\t\n\t\tfunction initUI() {\n\t\t\tvar container,\n\t\t\t\tenableFullscreen,\n\t\t\t\tdisableFullscreen,\n\t\t\t\tvrButton,\n\t\t\t\torientationButton,\n\t\t\t\telement,\n\t\n\t\t\t\tnoSleep = new NoSleep(),\n\t\n\t\t\t\tfullScreenElement = document.body,\n\t\n\t\t\t\tfullscreenEnabled = document.fullscreenEnabled ||\n\t\t\t\t\tdocument.webkitFullscreenEnabled ||\n\t\t\t\t\tdocument.mozFullScreenEnabled ||\n\t\t\t\t\tdocument.msFullscreenEnabled,\n\t\n\t\t\t\trequestFullscreen = fullScreenElement.webkitRequestFullscreen ||\n\t\t\t\t\tfullScreenElement.mozRequestFullScreen ||\n\t\t\t\t\tfullScreenElement.msRequestFullscreen;\n\t\n\t\t\tfunction svgButton(source, id) {\n\t\t\t\tvar span = document.createElement('span'),\n\t\t\t\t\tsvg;\n\t\n\t\t\t\tspan.innerHTML = source;\n\t\t\t\tspan.id = id;\n\t\n\t\t\t\tsvg = span.firstChild;\n\t\t\t\tsvg.setAttribute('width', 18);\n\t\t\t\tsvg.setAttribute('height', 18);\n\t\n\t\t\t\tcontainer.appendChild(span);\n\t\n\t\t\t\treturn span;\n\t\t\t}\n\t\n\t\t\tfunction toggleOrientation() {\n\t\t\t\tif (VR.orientationEnabled()) {\n\t\t\t\t\tVR.disableOrientation();\n\t\t\t\t} else {\n\t\t\t\t\tVR.enableOrientation();\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tfunction deviceChange() {\n\t\t\t\tif (VR.controlMode()) {\n\t\t\t\t\tvrButton.classList.remove('unsupported');\n\t\t\t\t\torientationButton.classList.remove('unsupported');\n\t\t\t\t}\n\t\n\t\t\t\t//todo: enable this\n\t\t\t\t//info.innerHTML = hmd && hmd.deviceName ? 'HMD: ' + hmd.deviceName : '';\n\t\t\t\t//info.className = hmd && hmd.deviceId !== 'debug-0' ? 'has-hmd' : '';\n\t\t\t}\n\t\n\t\t\t//set up meta viewport tag for mobile devices\n\t\t\telement = document.createElement('meta');\n\t\t\telement.setAttribute('name', 'viewport');\n\t\t\telement.setAttribute('content', 'width=device-width, initial-scale=1, user-scalable=no');\n\t\t\tdocument.head.appendChild(element);\n\t\n\t\t\tcontainer = document.createElement('div');\n\t\t\tcontainer.id = 'buttons';\n\t\t\tdocument.body.appendChild(container);\n\t\n\t\t\t//todo: use icons instead of text\n\t\t\tif (requestFullscreen && fullscreenEnabled) {\n\t\t\t\tenableFullscreen = svgButton(__webpack_require__(76), 'fs-enable');\n\t\t\t\tenableFullscreen.setAttribute('title', 'Enable Full Screen');\n\t\t\t\tenableFullscreen.addEventListener('click', requestFullscreen.bind(fullScreenElement), false);\n\t\n\t\t\t\tdisableFullscreen = svgButton(__webpack_require__(77), 'fs-disable');\n\t\t\t\tdisableFullscreen.setAttribute('title', 'Exit Full Screen');\n\t\t\t\tdisableFullscreen.addEventListener('click', VR.exitFullscreen, false);\n\t\t\t}\n\t\n\t\t\tVR.on('fullscreenchange', function () {\n\t\t\t\tif (VR.isFullscreen()) {\n\t\t\t\t\tdisableFullscreen.style.display = 'inline-block';\n\t\t\t\t\tenableFullscreen.style.display = 'none';\n\t\t\t\t} else {\n\t\t\t\t\tdisableFullscreen.style.display = '';\n\t\t\t\t\tenableFullscreen.style.display = '';\n\t\t\t\t}\n\t\n\t\t\t\t//disable sleep on mobile devices in VR mode\n\t\t\t\tif (VR.vrMode()) {\n\t\t\t\t\tnoSleep.enable();\n\t\t\t\t} else {\n\t\t\t\t\tnoSleep.disable();\n\t\t\t\t}\n\t\t\t});\n\t\n\t\t\tvrButton = svgButton(__webpack_require__(78), 'vr');\n\t\t\tvrButton.setAttribute('title', 'Toggle Virtual Reality');\n\t\t\tvrButton.className = 'unsupported';\n\t\t\tvrButton.addEventListener('click', VR.requestVR, false);\n\t\n\t\t\torientationButton = svgButton(__webpack_require__(79), 'orientation-button');\n\t\t\torientationButton.setAttribute('title', 'Toggle Orientation');\n\t\t\torientationButton.className = 'unsupported';\n\t\t\torientationButton.addEventListener('click', toggleOrientation, false);\n\t\n\t\t\t//report on HMD\n\t\t\tVR.on('devicechange', deviceChange);\n\t\t\tdeviceChange();\n\t\n\t\t\t//keyboard shortcuts for making life a little easier\n\t\t\twindow.addEventListener('keydown', function (evt) {\n\t\t\t\tif (evt.keyCode === 'Z'.charCodeAt(0)) {\n\t\t\t\t\tVR.zeroSensor();\n\t\t\t\t} else if (evt.keyCode === 'O'.charCodeAt(0)) {\n\t\t\t\t\tVR.enableOrientation();\n\t\t\t\t} else if (evt.keyCode === 13) {\n\t\t\t\t\tVR.requestVR();\n\t\t\t\t}\n\t\t\t}, false);\n\t\n\t\t\tVR.resize();\n\t\t}\n\t\n\t\tfunction initialize() {\n\t\t\tinitRequirements();\n\t\n\t\t\t//todo: set up button/info elements\n\t\n\t\t\tVR.init();\n\t\n\t\t\tif (document.body) {\n\t\t\t\tinitUI();\n\t\t\t} else {\n\t\t\t\twindow.addEventListener('load', initUI, false);\n\t\t\t}\n\t\n\t\t\twindow.addEventListener('resize', VR.resize, false);\n\t\n\t\t\tif (!isMobile.any) {\n\t\t\t\tVR.disableOrientation();\n\t\t\t}\n\t\n\t\t\t/*\n\t\t\texport global things\n\t\t\t*/\n\t\t\twindow.VR = VR;\n\t\t\twindow.THREE = VR.THREE;\n\t\t}\n\t\n\t\tinitialize();\n\t\tVR.start();\n\t}());\n\n\n/***/ },\n/* 1 */\n/***/ function(module, exports) {\n\n\t/**\n\t * NoSleep.js v0.5.0 - git.io/vfn01\n\t * Rich Tibbett\n\t * MIT license\n\t **/\n\t(function(root) {\n\t  // UA matching\n\t  var ua = {\n\t    Android: /Android/ig.test(navigator.userAgent),\n\t    iOS: /AppleWebKit/.test(navigator.userAgent) && /Mobile\\/\\w+/.test(navigator.userAgent)\n\t  };\n\t\n\t  var media = {\n\t    WebM: \"data:video/webm;base64,GkXfo0AgQoaBAUL3gQFC8oEEQvOBCEKCQAR3ZWJtQoeBAkKFgQIYU4BnQI0VSalmQCgq17FAAw9CQE2AQAZ3aGFtbXlXQUAGd2hhbW15RIlACECPQAAAAAAAFlSua0AxrkAu14EBY8WBAZyBACK1nEADdW5khkAFVl9WUDglhohAA1ZQOIOBAeBABrCBCLqBCB9DtnVAIueBAKNAHIEAAIAwAQCdASoIAAgAAUAmJaQAA3AA/vz0AAA=\",\n\t    MP4: \"data:video/mp4;base64,AAAAHGZ0eXBpc29tAAACAGlzb21pc28ybXA0MQAAAAhmcmVlAAAAG21kYXQAAAGzABAHAAABthADAowdbb9/AAAC6W1vb3YAAABsbXZoZAAAAAB8JbCAfCWwgAAAA+gAAAAAAAEAAAEAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAIVdHJhawAAAFx0a2hkAAAAD3wlsIB8JbCAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAIAAAACAAAAAABsW1kaWEAAAAgbWRoZAAAAAB8JbCAfCWwgAAAA+gAAAAAVcQAAAAAAC1oZGxyAAAAAAAAAAB2aWRlAAAAAAAAAAAAAAAAVmlkZW9IYW5kbGVyAAAAAVxtaW5mAAAAFHZtaGQAAAABAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAAEcc3RibAAAALhzdHNkAAAAAAAAAAEAAACobXA0dgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAIAAgASAAAAEgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABj//wAAAFJlc2RzAAAAAANEAAEABDwgEQAAAAADDUAAAAAABS0AAAGwAQAAAbWJEwAAAQAAAAEgAMSNiB9FAEQBFGMAAAGyTGF2YzUyLjg3LjQGAQIAAAAYc3R0cwAAAAAAAAABAAAAAQAAAAAAAAAcc3RzYwAAAAAAAAABAAAAAQAAAAEAAAABAAAAFHN0c3oAAAAAAAAAEwAAAAEAAAAUc3RjbwAAAAAAAAABAAAALAAAAGB1ZHRhAAAAWG1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAAK2lsc3QAAAAjqXRvbwAAABtkYXRhAAAAAQAAAABMYXZmNTIuNzguMw==\"\n\t  };\n\t\n\t  function addSourceToVideo(element, type, dataURI) {\n\t    var source = document.createElement('source');\n\t    source.src = dataURI;\n\t    source.type = \"video/\" + type;\n\t    element.appendChild(source);\n\t  }\n\t\n\t  // NoSleep instance constructor\n\t  var NoSleep = function() {\n\t    if (ua.iOS) {\n\t      this.noSleepTimer = null;\n\t    } else if (ua.Android) {\n\t      // Set up no sleep video element\n\t      this.noSleepVideo = document.createElement('video');\n\t      this.noSleepVideo.setAttribute(\"loop\", \"\");\n\t\n\t      // Append nosleep video sources\n\t      addSourceToVideo(this.noSleepVideo, \"webm\", media.WebM);\n\t      addSourceToVideo(this.noSleepVideo, \"mp4\", media.MP4);\n\t    }\n\t\n\t    return this;\n\t  };\n\t\n\t  // Enable NoSleep instance\n\t  NoSleep.prototype.enable = function(duration) {\n\t    if (ua.iOS) {\n\t      this.disable();\n\t      this.noSleepTimer = window.setInterval(function() {\n\t        window.location = window.location;\n\t        window.setTimeout(window.stop, 0);\n\t      }, duration || 15000);\n\t    } else if (ua.Android) {\n\t      this.noSleepVideo.play();\n\t    }\n\t  };\n\t\n\t  // Disable NoSleep instance\n\t  NoSleep.prototype.disable = function() {\n\t    if (ua.iOS) {\n\t      if (this.noSleepTimer) {\n\t        window.clearInterval(this.noSleepTimer);\n\t        this.noSleepTimer = null;\n\t      }\n\t    } else if (ua.Android) {\n\t      this.noSleepVideo.pause();\n\t    }\n\t  };\n\t\n\t  // Append NoSleep API to root object\n\t  root.NoSleep = NoSleep;\n\t})(this);\n\n\n/***/ },\n/* 2 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/**\n\t * isMobile.js v0.3.9\n\t *\n\t * A simple library to detect Apple phones and tablets,\n\t * Android phones and tablets, other mobile devices (like blackberry, mini-opera and windows phone),\n\t * and any kind of seven inch device, via user agent sniffing.\n\t *\n\t * @author: Kai Mallea (kmallea@gmail.com)\n\t *\n\t * @license: http://creativecommons.org/publicdomain/zero/1.0/\n\t */\n\t(function (global) {\n\t\n\t    var apple_phone         = /iPhone/i,\n\t        apple_ipod          = /iPod/i,\n\t        apple_tablet        = /iPad/i,\n\t        android_phone       = /(?=.*\\bAndroid\\b)(?=.*\\bMobile\\b)/i, // Match 'Android' AND 'Mobile'\n\t        android_tablet      = /Android/i,\n\t        amazon_phone        = /(?=.*\\bAndroid\\b)(?=.*\\bSD4930UR\\b)/i,\n\t        amazon_tablet       = /(?=.*\\bAndroid\\b)(?=.*\\b(?:KFOT|KFTT|KFJWI|KFJWA|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|KFARWI|KFASWI|KFSAWI|KFSAWA)\\b)/i,\n\t        windows_phone       = /IEMobile/i,\n\t        windows_tablet      = /(?=.*\\bWindows\\b)(?=.*\\bARM\\b)/i, // Match 'Windows' AND 'ARM'\n\t        other_blackberry    = /BlackBerry/i,\n\t        other_blackberry_10 = /BB10/i,\n\t        other_opera         = /Opera Mini/i,\n\t        other_chrome        = /(CriOS|Chrome)(?=.*\\bMobile\\b)/i,\n\t        other_firefox       = /(?=.*\\bFirefox\\b)(?=.*\\bMobile\\b)/i, // Match 'Firefox' AND 'Mobile'\n\t        seven_inch = new RegExp(\n\t            '(?:' +         // Non-capturing group\n\t\n\t            'Nexus 7' +     // Nexus 7\n\t\n\t            '|' +           // OR\n\t\n\t            'BNTV250' +     // B&N Nook Tablet 7 inch\n\t\n\t            '|' +           // OR\n\t\n\t            'Kindle Fire' + // Kindle Fire\n\t\n\t            '|' +           // OR\n\t\n\t            'Silk' +        // Kindle Fire, Silk Accelerated\n\t\n\t            '|' +           // OR\n\t\n\t            'GT-P1000' +    // Galaxy Tab 7 inch\n\t\n\t            ')',            // End non-capturing group\n\t\n\t            'i');           // Case-insensitive matching\n\t\n\t    var match = function(regex, userAgent) {\n\t        return regex.test(userAgent);\n\t    };\n\t\n\t    var IsMobileClass = function(userAgent) {\n\t        var ua = userAgent || navigator.userAgent;\n\t        // Facebook mobile app's integrated browser adds a bunch of strings that\n\t        // match everything. Strip it out if it exists.\n\t        var tmp = ua.split('[FBAN');\n\t        if (typeof tmp[1] !== 'undefined') {\n\t            ua = tmp[0];\n\t        }\n\t\n\t        this.apple = {\n\t            phone:  match(apple_phone, ua),\n\t            ipod:   match(apple_ipod, ua),\n\t            tablet: !match(apple_phone, ua) && match(apple_tablet, ua),\n\t            device: match(apple_phone, ua) || match(apple_ipod, ua) || match(apple_tablet, ua)\n\t        };\n\t        this.amazon = {\n\t            phone:  match(amazon_phone, ua),\n\t            tablet: !match(amazon_phone, ua) && match(amazon_tablet, ua),\n\t            device: match(amazon_phone, ua) || match(amazon_tablet, ua)\n\t        };\n\t        this.android = {\n\t            phone:  match(amazon_phone, ua) || match(android_phone, ua),\n\t            tablet: !match(amazon_phone, ua) && !match(android_phone, ua) && (match(amazon_tablet, ua) || match(android_tablet, ua)),\n\t            device: match(amazon_phone, ua) || match(amazon_tablet, ua) || match(android_phone, ua) || match(android_tablet, ua)\n\t        };\n\t        this.windows = {\n\t            phone:  match(windows_phone, ua),\n\t            tablet: match(windows_tablet, ua),\n\t            device: match(windows_phone, ua) || match(windows_tablet, ua)\n\t        };\n\t        this.other = {\n\t            blackberry:   match(other_blackberry, ua),\n\t            blackberry10: match(other_blackberry_10, ua),\n\t            opera:        match(other_opera, ua),\n\t            firefox:      match(other_firefox, ua),\n\t            chrome:       match(other_chrome, ua),\n\t            device:       match(other_blackberry, ua) || match(other_blackberry_10, ua) || match(other_opera, ua) || match(other_firefox, ua) || match(other_chrome, ua)\n\t        };\n\t        this.seven_inch = match(seven_inch, ua);\n\t        this.any = this.apple.device || this.android.device || this.windows.device || this.other.device || this.seven_inch;\n\t        // excludes 'other' devices and ipods, targeting touchscreen phones\n\t        this.phone = this.apple.phone || this.android.phone || this.windows.phone;\n\t        // excludes 7 inch devices, classifying as phone or tablet is left to the user\n\t        this.tablet = this.apple.tablet || this.android.tablet || this.windows.tablet;\n\t\n\t        if (typeof window === 'undefined') {\n\t            return this;\n\t        }\n\t    };\n\t\n\t    var instantiate = function() {\n\t        var IM = new IsMobileClass();\n\t        IM.Class = IsMobileClass;\n\t        return IM;\n\t    };\n\t\n\t    if (typeof module != 'undefined' && module.exports && typeof window === 'undefined') {\n\t        //node\n\t        module.exports = IsMobileClass;\n\t    } else if (typeof module != 'undefined' && module.exports && typeof window !== 'undefined') {\n\t        //browserify\n\t        module.exports = instantiate();\n\t    } else if (true) {\n\t        //AMD\n\t        !(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_FACTORY__ = (global.isMobile = instantiate()), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\t    } else {\n\t        global.isMobile = instantiate();\n\t    }\n\t\n\t})(this);\n\n\n/***/ },\n/* 3 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t// style-loader: Adds some css to the DOM by adding a <style> tag\n\t\n\t// load the styles\n\tvar content = __webpack_require__(4);\n\tif(typeof content === 'string') content = [[module.id, content, '']];\n\t// add the styles to the DOM\n\tvar update = __webpack_require__(6)(content, {});\n\tif(content.locals) module.exports = content.locals;\n\t// Hot Module Replacement\n\tif(false) {\n\t\t// When the styles change, update the <style> tags\n\t\tif(!content.locals) {\n\t\t\tmodule.hot.accept(\"!!./../../node_modules/css-loader/index.js!./style.css\", function() {\n\t\t\t\tvar newContent = require(\"!!./../../node_modules/css-loader/index.js!./style.css\");\n\t\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\t\tupdate(newContent);\n\t\t\t});\n\t\t}\n\t\t// When the module is disposed, remove the <style> tags\n\t\tmodule.hot.dispose(function() { update(); });\n\t}\n\n/***/ },\n/* 4 */\n/***/ function(module, exports, __webpack_require__) {\n\n\texports = module.exports = __webpack_require__(5)();\n\t// imports\n\t\n\t\n\t// module\n\texports.push([module.id, \"body{font-family:Helvetica Neue,Helvetica,Arial,sans-serif;color:#eee;overflow:hidden;background:#282828;height:100%;width:100%;margin:0;padding:0}canvas{width:100%!important;height:100%!important;top:0;left:0}#buttons{position:absolute;bottom:0;left:0;padding:12px;margin:8px;border-radius:8px;background-color:hsla(0,0%,50%,.6)}#buttons>*{margin:0 10px;display:inline-block;width:18px;height:18px;cursor:pointer}#buttons>:first-child{margin-left:0}#buttons>.unsupported,#fs-disable{display:none}\", \"\"]);\n\t\n\t// exports\n\n\n/***/ },\n/* 5 */\n/***/ function(module, exports) {\n\n\t/*\r\n\t\tMIT License http://www.opensource.org/licenses/mit-license.php\r\n\t\tAuthor Tobias Koppers @sokra\r\n\t*/\r\n\t// css base code, injected by the css-loader\r\n\tmodule.exports = function() {\r\n\t\tvar list = [];\r\n\t\r\n\t\t// return the list of modules as css string\r\n\t\tlist.toString = function toString() {\r\n\t\t\tvar result = [];\r\n\t\t\tfor(var i = 0; i < this.length; i++) {\r\n\t\t\t\tvar item = this[i];\r\n\t\t\t\tif(item[2]) {\r\n\t\t\t\t\tresult.push(\"@media \" + item[2] + \"{\" + item[1] + \"}\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresult.push(item[1]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn result.join(\"\");\r\n\t\t};\r\n\t\r\n\t\t// import a list of modules into the list\r\n\t\tlist.i = function(modules, mediaQuery) {\r\n\t\t\tif(typeof modules === \"string\")\r\n\t\t\t\tmodules = [[null, modules, \"\"]];\r\n\t\t\tvar alreadyImportedModules = {};\r\n\t\t\tfor(var i = 0; i < this.length; i++) {\r\n\t\t\t\tvar id = this[i][0];\r\n\t\t\t\tif(typeof id === \"number\")\r\n\t\t\t\t\talreadyImportedModules[id] = true;\r\n\t\t\t}\r\n\t\t\tfor(i = 0; i < modules.length; i++) {\r\n\t\t\t\tvar item = modules[i];\r\n\t\t\t\t// skip already imported module\r\n\t\t\t\t// this implementation is not 100% perfect for weird media query combinations\r\n\t\t\t\t//  when a module is imported multiple times with different media queries.\r\n\t\t\t\t//  I hope this will never occur (Hey this way we have smaller bundles)\r\n\t\t\t\tif(typeof item[0] !== \"number\" || !alreadyImportedModules[item[0]]) {\r\n\t\t\t\t\tif(mediaQuery && !item[2]) {\r\n\t\t\t\t\t\titem[2] = mediaQuery;\r\n\t\t\t\t\t} else if(mediaQuery) {\r\n\t\t\t\t\t\titem[2] = \"(\" + item[2] + \") and (\" + mediaQuery + \")\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlist.push(item);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t\treturn list;\r\n\t};\r\n\n\n/***/ },\n/* 6 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/*\r\n\t\tMIT License http://www.opensource.org/licenses/mit-license.php\r\n\t\tAuthor Tobias Koppers @sokra\r\n\t*/\r\n\tvar stylesInDom = {},\r\n\t\tmemoize = function(fn) {\r\n\t\t\tvar memo;\r\n\t\t\treturn function () {\r\n\t\t\t\tif (typeof memo === \"undefined\") memo = fn.apply(this, arguments);\r\n\t\t\t\treturn memo;\r\n\t\t\t};\r\n\t\t},\r\n\t\tisOldIE = memoize(function() {\r\n\t\t\treturn /msie [6-9]\\b/.test(window.navigator.userAgent.toLowerCase());\r\n\t\t}),\r\n\t\tgetHeadElement = memoize(function () {\r\n\t\t\treturn document.head || document.getElementsByTagName(\"head\")[0];\r\n\t\t}),\r\n\t\tsingletonElement = null,\r\n\t\tsingletonCounter = 0,\r\n\t\tstyleElementsInsertedAtTop = [];\r\n\t\r\n\tmodule.exports = function(list, options) {\r\n\t\tif(false) {\r\n\t\t\tif(typeof document !== \"object\") throw new Error(\"The style-loader cannot be used in a non-browser environment\");\r\n\t\t}\r\n\t\r\n\t\toptions = options || {};\r\n\t\t// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\r\n\t\t// tags it will allow on a page\r\n\t\tif (typeof options.singleton === \"undefined\") options.singleton = isOldIE();\r\n\t\r\n\t\t// By default, add <style> tags to the bottom of <head>.\r\n\t\tif (typeof options.insertAt === \"undefined\") options.insertAt = \"bottom\";\r\n\t\r\n\t\tvar styles = listToStyles(list);\r\n\t\taddStylesToDom(styles, options);\r\n\t\r\n\t\treturn function update(newList) {\r\n\t\t\tvar mayRemove = [];\r\n\t\t\tfor(var i = 0; i < styles.length; i++) {\r\n\t\t\t\tvar item = styles[i];\r\n\t\t\t\tvar domStyle = stylesInDom[item.id];\r\n\t\t\t\tdomStyle.refs--;\r\n\t\t\t\tmayRemove.push(domStyle);\r\n\t\t\t}\r\n\t\t\tif(newList) {\r\n\t\t\t\tvar newStyles = listToStyles(newList);\r\n\t\t\t\taddStylesToDom(newStyles, options);\r\n\t\t\t}\r\n\t\t\tfor(var i = 0; i < mayRemove.length; i++) {\r\n\t\t\t\tvar domStyle = mayRemove[i];\r\n\t\t\t\tif(domStyle.refs === 0) {\r\n\t\t\t\t\tfor(var j = 0; j < domStyle.parts.length; j++)\r\n\t\t\t\t\t\tdomStyle.parts[j]();\r\n\t\t\t\t\tdelete stylesInDom[domStyle.id];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\t\r\n\tfunction addStylesToDom(styles, options) {\r\n\t\tfor(var i = 0; i < styles.length; i++) {\r\n\t\t\tvar item = styles[i];\r\n\t\t\tvar domStyle = stylesInDom[item.id];\r\n\t\t\tif(domStyle) {\r\n\t\t\t\tdomStyle.refs++;\r\n\t\t\t\tfor(var j = 0; j < domStyle.parts.length; j++) {\r\n\t\t\t\t\tdomStyle.parts[j](item.parts[j]);\r\n\t\t\t\t}\r\n\t\t\t\tfor(; j < item.parts.length; j++) {\r\n\t\t\t\t\tdomStyle.parts.push(addStyle(item.parts[j], options));\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tvar parts = [];\r\n\t\t\t\tfor(var j = 0; j < item.parts.length; j++) {\r\n\t\t\t\t\tparts.push(addStyle(item.parts[j], options));\r\n\t\t\t\t}\r\n\t\t\t\tstylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction listToStyles(list) {\r\n\t\tvar styles = [];\r\n\t\tvar newStyles = {};\r\n\t\tfor(var i = 0; i < list.length; i++) {\r\n\t\t\tvar item = list[i];\r\n\t\t\tvar id = item[0];\r\n\t\t\tvar css = item[1];\r\n\t\t\tvar media = item[2];\r\n\t\t\tvar sourceMap = item[3];\r\n\t\t\tvar part = {css: css, media: media, sourceMap: sourceMap};\r\n\t\t\tif(!newStyles[id])\r\n\t\t\t\tstyles.push(newStyles[id] = {id: id, parts: [part]});\r\n\t\t\telse\r\n\t\t\t\tnewStyles[id].parts.push(part);\r\n\t\t}\r\n\t\treturn styles;\r\n\t}\r\n\t\r\n\tfunction insertStyleElement(options, styleElement) {\r\n\t\tvar head = getHeadElement();\r\n\t\tvar lastStyleElementInsertedAtTop = styleElementsInsertedAtTop[styleElementsInsertedAtTop.length - 1];\r\n\t\tif (options.insertAt === \"top\") {\r\n\t\t\tif(!lastStyleElementInsertedAtTop) {\r\n\t\t\t\thead.insertBefore(styleElement, head.firstChild);\r\n\t\t\t} else if(lastStyleElementInsertedAtTop.nextSibling) {\r\n\t\t\t\thead.insertBefore(styleElement, lastStyleElementInsertedAtTop.nextSibling);\r\n\t\t\t} else {\r\n\t\t\t\thead.appendChild(styleElement);\r\n\t\t\t}\r\n\t\t\tstyleElementsInsertedAtTop.push(styleElement);\r\n\t\t} else if (options.insertAt === \"bottom\") {\r\n\t\t\thead.appendChild(styleElement);\r\n\t\t} else {\r\n\t\t\tthrow new Error(\"Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.\");\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction removeStyleElement(styleElement) {\r\n\t\tstyleElement.parentNode.removeChild(styleElement);\r\n\t\tvar idx = styleElementsInsertedAtTop.indexOf(styleElement);\r\n\t\tif(idx >= 0) {\r\n\t\t\tstyleElementsInsertedAtTop.splice(idx, 1);\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction createStyleElement(options) {\r\n\t\tvar styleElement = document.createElement(\"style\");\r\n\t\tstyleElement.type = \"text/css\";\r\n\t\tinsertStyleElement(options, styleElement);\r\n\t\treturn styleElement;\r\n\t}\r\n\t\r\n\tfunction createLinkElement(options) {\r\n\t\tvar linkElement = document.createElement(\"link\");\r\n\t\tlinkElement.rel = \"stylesheet\";\r\n\t\tinsertStyleElement(options, linkElement);\r\n\t\treturn linkElement;\r\n\t}\r\n\t\r\n\tfunction addStyle(obj, options) {\r\n\t\tvar styleElement, update, remove;\r\n\t\r\n\t\tif (options.singleton) {\r\n\t\t\tvar styleIndex = singletonCounter++;\r\n\t\t\tstyleElement = singletonElement || (singletonElement = createStyleElement(options));\r\n\t\t\tupdate = applyToSingletonTag.bind(null, styleElement, styleIndex, false);\r\n\t\t\tremove = applyToSingletonTag.bind(null, styleElement, styleIndex, true);\r\n\t\t} else if(obj.sourceMap &&\r\n\t\t\ttypeof URL === \"function\" &&\r\n\t\t\ttypeof URL.createObjectURL === \"function\" &&\r\n\t\t\ttypeof URL.revokeObjectURL === \"function\" &&\r\n\t\t\ttypeof Blob === \"function\" &&\r\n\t\t\ttypeof btoa === \"function\") {\r\n\t\t\tstyleElement = createLinkElement(options);\r\n\t\t\tupdate = updateLink.bind(null, styleElement);\r\n\t\t\tremove = function() {\r\n\t\t\t\tremoveStyleElement(styleElement);\r\n\t\t\t\tif(styleElement.href)\r\n\t\t\t\t\tURL.revokeObjectURL(styleElement.href);\r\n\t\t\t};\r\n\t\t} else {\r\n\t\t\tstyleElement = createStyleElement(options);\r\n\t\t\tupdate = applyToTag.bind(null, styleElement);\r\n\t\t\tremove = function() {\r\n\t\t\t\tremoveStyleElement(styleElement);\r\n\t\t\t};\r\n\t\t}\r\n\t\r\n\t\tupdate(obj);\r\n\t\r\n\t\treturn function updateStyle(newObj) {\r\n\t\t\tif(newObj) {\r\n\t\t\t\tif(newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap)\r\n\t\t\t\t\treturn;\r\n\t\t\t\tupdate(obj = newObj);\r\n\t\t\t} else {\r\n\t\t\t\tremove();\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\t\r\n\tvar replaceText = (function () {\r\n\t\tvar textStore = [];\r\n\t\r\n\t\treturn function (index, replacement) {\r\n\t\t\ttextStore[index] = replacement;\r\n\t\t\treturn textStore.filter(Boolean).join('\\n');\r\n\t\t};\r\n\t})();\r\n\t\r\n\tfunction applyToSingletonTag(styleElement, index, remove, obj) {\r\n\t\tvar css = remove ? \"\" : obj.css;\r\n\t\r\n\t\tif (styleElement.styleSheet) {\r\n\t\t\tstyleElement.styleSheet.cssText = replaceText(index, css);\r\n\t\t} else {\r\n\t\t\tvar cssNode = document.createTextNode(css);\r\n\t\t\tvar childNodes = styleElement.childNodes;\r\n\t\t\tif (childNodes[index]) styleElement.removeChild(childNodes[index]);\r\n\t\t\tif (childNodes.length) {\r\n\t\t\t\tstyleElement.insertBefore(cssNode, childNodes[index]);\r\n\t\t\t} else {\r\n\t\t\t\tstyleElement.appendChild(cssNode);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction applyToTag(styleElement, obj) {\r\n\t\tvar css = obj.css;\r\n\t\tvar media = obj.media;\r\n\t\tvar sourceMap = obj.sourceMap;\r\n\t\r\n\t\tif(media) {\r\n\t\t\tstyleElement.setAttribute(\"media\", media)\r\n\t\t}\r\n\t\r\n\t\tif(styleElement.styleSheet) {\r\n\t\t\tstyleElement.styleSheet.cssText = css;\r\n\t\t} else {\r\n\t\t\twhile(styleElement.firstChild) {\r\n\t\t\t\tstyleElement.removeChild(styleElement.firstChild);\r\n\t\t\t}\r\n\t\t\tstyleElement.appendChild(document.createTextNode(css));\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction updateLink(linkElement, obj) {\r\n\t\tvar css = obj.css;\r\n\t\tvar media = obj.media;\r\n\t\tvar sourceMap = obj.sourceMap;\r\n\t\r\n\t\tif(sourceMap) {\r\n\t\t\t// http://stackoverflow.com/a/26603875\r\n\t\t\tcss += \"\\n/*# sourceMappingURL=data:application/json;base64,\" + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + \" */\";\r\n\t\t}\r\n\t\r\n\t\tvar blob = new Blob([css], { type: \"text/css\" });\r\n\t\r\n\t\tvar oldSrc = linkElement.href;\r\n\t\r\n\t\tlinkElement.href = URL.createObjectURL(blob);\r\n\t\r\n\t\tif(oldSrc)\r\n\t\t\tURL.revokeObjectURL(oldSrc);\r\n\t}\r\n\n\n/***/ },\n/* 7 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t(function () {\n\t\t'use strict';\n\t\n\t\t//constants\n\t\tvar NEAR = 0.1,\n\t\t\tFAR = 1000000,\n\t\n\t\t//global-ish declarations\n\t\t\tTHREE,\n\t\t\teventEmitter,\n\t\t\tmaterials = __webpack_require__(8),\n\t\t\tnop = function () {},\n\t\t\trequestFullscreen = nop,\n\t\t\texitFullscreen = (\n\t\t\t\tdocument.exitFullscreen ||\n\t\t\t\tdocument.mozCancelFullScreen ||\n\t\t\t\tdocument.webkitExitFullscreen ||\n\t\t\t\tdocument.msExitFullscreen ||\n\t\t\t\tnop\n\t\t\t).bind(document),\n\t\n\t\t//scene assets\n\t\t\tcamera,\n\t\t\tscene,\n\t\t\tbody,\n\t\t\trenderer,\n\t\t\taudioListener,\n\t\t\tvrControls,\n\t\t\tvrEffect,\n\t\t\tmouseControls,\n\t\t\traycaster,\n\t\t\ttarget,\n\t\n\t\t\tbodyWrapper,\n\t\t\tcameraWrapper,\n\t\n\t\t\tfloor,\n\t\n\t\t//state\n\t\t\tgoing = false,\n\t\t\tvrMode = false,\n\t\t\torientationEnabled,\n\t\t\torientationPossible = false,\n\t\n\t\t//exported object\n\t\t\tVR,\n\t\n\t\t\tVRObject = __webpack_require__(39),\n\t\t\tobjectMethods = [\n\t\t\t\t'box',\n\t\t\t\t'cylinder',\n\t\t\t\t'torus',\n\t\t\t\t'sphere',\n\t\t\t\t'empty',\n\t\t\t\t'sound',\n\t\t\t\t'floor',\n\t\t\t\t'sky',\n\t\t\t\t'panorama',\n\t\t\t\t'image',\n\t\t\t\t'video',\n\t\t\t\t'text',\n\t\t\t\t'grid'\n\t\t\t],\n\t\n\t\t\t//todo: use a weak map or set instead\n\t\t\tvrObjects = [],\n\t\t\traycastable = [],\n\t\n\t\t\tlastTick = 0,\n\t\t\tanimationCallbacks = [];\n\t\n\t\tfunction isFullscreen() {\n\t\t\treturn !!(document.fullscreenElement ||\n\t\t\t\tdocument.mozFullScreenElement ||\n\t\t\t\tdocument.webkitFullscreenElement ||\n\t\t\t\tdocument.msFullscreenElement);\n\t\t}\n\t\n\t\tfunction fullScreenError() {\n\t\t\tvrMode = false;\n\t\t\tif (vrEffect) {\n\t\t\t\tvrEffect.exit();\n\t\t\t}\n\t\t}\n\t\n\t\tfunction pruneObject(object) {\n\t\t\tvar i = raycastable.indexOf(object);\n\t\t\tif (i >= 0) {\n\t\t\t\traycastable.splice(i, 1);\n\t\t\t}\n\t\n\t\t\ti = vrObjects.indexOf(VRObject.findObject(object));\n\t\t\tif (i >= 0) {\n\t\t\t\tvrObjects.splice(i, 1);\n\t\t\t}\n\t\n\t\t\tobject.children.forEach(pruneObject);\n\t\t}\n\t\n\t\tfunction raycast() {\n\t\t\tvar i,\n\t\t\t\tintersect,\n\t\t\t\tobject,\n\t\t\t\tintersects,\n\t\t\t\tparent,\n\t\t\t\tprune = [],\n\t\t\t\tvrObject;\n\t\n\t\t\traycaster.ray.origin.setFromMatrixPosition(camera.matrixWorld); // world position\n\t\t\traycaster.ray.direction.set(0, 0, 0.5).unproject(camera).sub(raycaster.ray.origin).normalize();\n\t\n\t\t\tintersects = raycaster.intersectObjects(raycastable, true);\n\t\t\tfor (i = 0; i < intersects.length; i++) {\n\t\t\t\tintersect = intersects[i];\n\t\n\t\t\t\t// if object has been removed from scene, remove it from raycastable\n\t\t\t\tparent = intersect.object;\n\t\t\t\twhile (parent && parent !== scene) {\n\t\t\t\t\tif (!parent.parent) {\n\t\t\t\t\t\tprune.push(parent);\n\t\t\t\t\t}\n\t\t\t\t\tparent = parent.parent;\n\t\t\t\t}\n\t\n\t\t\t\tif (parent && intersect.object instanceof THREE.Mesh) {\n\t\t\t\t\tobject = intersect.object;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tprune.forEach(pruneObject);\n\t\n\t\t\tif (target !== object) {\n\t\t\t\tif (target) {\n\t\t\t\t\tvrObject = VRObject.findObject(target);\n\t\t\t\t\tvrObject.emit('lookaway');\n\t\t\t\t\tVR.emit('lookaway', vrObject);\n\t\t\t\t}\n\t\t\t\ttarget = object;\n\t\t\t\tif (target) {\n\t\t\t\t\tvrObject = VRObject.findObject(target);\n\t\t\t\t\twhile (!vrObject && target.parent) {\n\t\t\t\t\t\ttarget = target.parent;\n\t\t\t\t\t\tvrObject = VRObject.findObject(target);\n\t\t\t\t\t}\n\t\t\t\t\tif (vrObject) {\n\t\t\t\t\t\tvrObject.emit('lookat', intersect);\n\t\t\t\t\t\tVR.emit('lookat', vrObject, intersect);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\n\t\tfunction render() {\n\t\t\tvar now = Date.now() / 1000,\n\t\t\t\tdelta = Math.min(1, now - lastTick);\n\t\n\t\t\tvrControls.update();\n\t\n\t\t\tanimationCallbacks.forEach(function (cb) {\n\t\t\t\tcb(delta, now);\n\t\t\t});\n\t\n\t\t\tscene.updateMatrixWorld();\n\t\n\t\t\tvrObjects.forEach(function (object) {\n\t\t\t\tobject.update(now);\n\t\t\t});\n\t\n\t\t\traycast();\n\t\n\t\t\tvrEffect.render(scene, camera);\n\t\n\t\t\tlastTick = now;\n\t\t}\n\t\n\t\tfunction renderLoop() {\n\t\t\tif (going) {\n\t\t\t\trender();\n\t\t\t\trequestAnimationFrame(renderLoop);\n\t\t\t}\n\t\t}\n\t\n\t\tfunction stop() {\n\t\t\tgoing = false;\n\t\t}\n\t\n\t\tfunction start() {\n\t\t\tif (!going) {\n\t\t\t\tgoing = true;\n\t\t\t\trenderLoop();\n\t\t\t}\n\t\t}\n\t\n\t\t/*\n\t\tMute any sounds when this browser tab is in the background or minimized.\n\t\t*/\n\t\tfunction visibilityChange() {\n\t\t\tif (document.hidden || document.mozHidden || document.msHidden || document.webkitHidden) {\n\t\t\t\taudioListener.volume(0);\n\t\t\t} else {\n\t\t\t\taudioListener.volume(1);\n\t\t\t}\n\t\t}\n\t\n\t\tfunction resize(width, height) {\n\t\t\twidth = typeof width === 'number' && width || window.innerWidth;\n\t\t\theight = typeof height === 'number' && height || window.innerHeight;\n\t\n\t\t\tcamera.aspect = width / height;\n\t\t\tcamera.updateProjectionMatrix();\n\t\t\trenderer.setSize(width, height);\n\t\t}\n\t\n\t\tfunction initShake() {\n\t\t\tvar lastTime = 0,\n\t\t\t\tlastX,\n\t\t\t\tlastY,\n\t\t\t\tlastZ,\n\t\t\t\tthreshold = 15;\n\t\n\t\t\twindow.addEventListener('devicemotion', function (evt) {\n\t\t\t\tvar current = evt.accelerationIncludingGravity,\n\t\t\t\t\ttime,\n\t\t\t\t\tdiff,\n\t\t\t\t\tdeltaX = 0,\n\t\t\t\t\tdeltaY = 0,\n\t\t\t\t\tdeltaZ = 0,\n\t\t\t\t\tdist;\n\t\n\t\t\t\tif (lastX !== undefined) {\n\t\t\t\t\tdeltaX = Math.abs(lastX - current.x);\n\t\t\t\t\tdeltaY = Math.abs(lastY - current.y);\n\t\t\t\t\tdeltaZ = Math.abs(lastZ - current.z);\n\t\n\t\t\t\t\t// if (deltaX > threshold &&\n\t\t\t\t\t// \t\t(deltaY > threshold || deltaZ > threshold)\n\t\t\t\t\t// \t) {\n\t\t\t\t\tdist = Math.sqrt(deltaX * deltaX + deltaY * deltaY + deltaZ * deltaZ);\n\t\t\t\t\tif (dist > threshold) {\n\t\n\t\t\t\t\t\ttime = Date.now();\n\t\t\t\t\t\tdiff = time - lastTime;\n\t\t\t\t\t\tif (diff > 1000) {\n\t\t\t\t\t\t\tif (navigator.vibrate) {\n\t\t\t\t\t\t\t\tnavigator.vibrate(100);\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\tlastTime = Date.now();\n\t\n\t\t\t\t\t\t\tVR.emit('shake');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\tlastX = current.x;\n\t\t\t\tlastY = current.y;\n\t\t\t\tlastZ = current.z;\n\t\n\t\t\t\torientationPossible = true;\n\t\t\t}, false);\n\t\t}\n\t\n\t\tfunction initScene() {\n\t\t\tfunction attachCanvas() {\n\t\t\t\tdocument.body.insertBefore(renderer.domElement, document.body.firstChild || null);\n\t\t\t\tresize();\n\t\t\t}\n\t\n\t\t\tif (renderer) {\n\t\t\t\treturn;\n\t\t\t}\n\t\n\t\t\t//create renderer and place in document\n\t\t\trenderer = new THREE.WebGLRenderer({ antialias: true });\n\t\t\trenderer.domElement.addEventListener('webglcontextlost', function contextLost(event) {\n\t\t\t\tconsole.log('lost context', event);\n\t\t\t});\n\t\t\t// renderer.shadowMapEnabled = true;\n\t\t\t// renderer.shadowMapSoft = true;\n\t\n\t\t\t//need a scene to put all our objects in\n\t\t\tscene = new THREE.Scene();\n\t\n\t\t\tbodyWrapper = new VRObject(scene, __webpack_require__(55), null, {\n\t\t\t\tname: 'body'\n\t\t\t}).moveTo(0, 1.5, 4);\n\t\t\tbody = bodyWrapper.object;\n\t\n\t\t\tcameraWrapper = new VRObject(body, function (parent) {\n\t\t\t\t//need a camera with which to look at stuff\n\t\t\t\tcamera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, NEAR, FAR);\n\t\t\t\tparent.add(camera);\n\t\n\t\t\t\treturn camera;\n\t\t\t})\n\t\t\t// set camera position so that OrbitControls works properly.\n\t\t\t\t.moveTo(0, 0.0001, 0.0001);\n\t\n\t\t\taudioListener = new THREE.AudioListener();\n\t\t\taudioListener.name = 'audio-listener';\n\t\t\tcamera.add(audioListener);\n\t\n\t\t\t//VRControls point the camera wherever we're looking\n\t\t\tvrControls = new THREE.VRControls(camera);\n\t\t\tvrControls.freeze = !orientationEnabled;\n\t\n\t\t\t//render left and right eye\n\t\t\tvrEffect = new THREE.VRStereoEffect(renderer);\n\t\t\tvrEffect.near = NEAR;\n\t\t\tvrEffect.far = FAR;\n\t\t\tvrEffect.addEventListener('fullscreenchange', function (evt) {\n\t\t\t\tvar screen;\n\t\t\t\tif (isFullscreen()) {\n\t\t\t\t\tif (vrMode) {\n\t\t\t\t\t\t//no mouse control\n\t\t\t\t\t\tmouseControls.enabled = false;\n\t\n\t\t\t\t\t\tvrControls.freeze = false;\n\t\t\t\t\t\tvrControls.reset();\n\t\n\t\t\t\t\t\tscreen = window.screen;\n\t\t\t\t\t\tif (screen.lockOrientation) {\n\t\t\t\t\t\t\tscreen.lockOrientation('landscape-primary');\n\t\t\t\t\t\t} else if (screen.mozLockOrientation) {\n\t\t\t\t\t\t\tscreen.mozLockOrientation('landscape-primary');\n\t\t\t\t\t\t} else if (screen.orientation && screen.orientation.lock) {\n\t\t\t\t\t\t\tscreen.orientation.lock('landscape-primary');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tVR.exitVR();\n\t\t\t\t}\n\t\n\t\t\t\tcamera.position.set(0, 0.0001, 0.0001);\n\t\t\t\tcamera.rotation.set(0, 0, 0);\n\t\n\t\t\t\tVR.emit('fullscreenchange', evt);\n\t\t\t});\n\t\n\t\t\t//report on HMD\n\t\t\tvrControls.addEventListener('devicechange', function () {\n\t\t\t\torientationPossible = true;\n\t\t\t\tif (orientationEnabled === undefined) {\n\t\t\t\t\torientationEnabled = vrControls.mode() === 'deviceorientation';\n\t\t\t\t}\n\t\n\t\t\t\tvrControls.freeze = !orientationEnabled && !vrMode;\n\t\n\t\t\t\tVR.emit('devicechange', vrControls.mode(), vrEffect.hmd());\n\t\t\t});\n\t\n\t\t\t//mouse control in case got no orientation device\n\t\t\tmouseControls = new THREE.OrbitControls(camera, renderer.domElement);\n\t\t\tmouseControls.target0.set(0, 0.0001, 0.000);\n\t\t\tmouseControls.target.copy(mouseControls.target0);\n\t\t\tmouseControls.update();\n\t\n\t\t\t//todo: remove any default lights once other lights are added\n\t\t\tvar dLight = new THREE.DirectionalLight(0xffffff, 0.8);\n\t\t\tdLight.name = 'directional-light';\n\t\t\tdLight.position.set(20, 100, 100);\n\t\n\t\t\tdLight.castShadow = true;\n\t\t\tdLight.shadowCameraVisible = true;\n\t\n\t\t\tdLight.shadowMapWidth = 2048;\n\t\t\tdLight.shadowMapHeight = 2048;\n\t\n\t\t\tdLight.shadowCameraLeft = -10;\n\t\t\tdLight.shadowCameraRight = 10;\n\t\t\tdLight.shadowCameraTop = 10;\n\t\t\tdLight.shadowCameraBottom = -10;\n\t\n\t\t\tdLight.shadowCameraFar = 150;\n\t\t\tdLight.shadowCameraNear = 100;\n\t\t\tdLight.shadowDarkness = 1;\n\t\n\t\t\tscene.add(dLight);\n\t\n\t\t\tscene.add(new THREE.AmbientLight(0x444444));\n\t\n\t\t\tif (VR) {\n\t\t\t\tVR.camera = cameraWrapper;\n\t\t\t\tVR.body = bodyWrapper;\n\t\t\t\tVR.scene = scene;\n\t\t\t\tVR.canvas = renderer.domElement;\n\t\t\t\tVR.renderer = renderer;\n\t\t\t\tVR.zeroSensor = vrControls.zeroSensor;\n\t\t\t}\n\t\n\t\t\traycaster = new THREE.Raycaster();\n\t\n\t\t\tif (document.body) {\n\t\t\t\tattachCanvas();\n\t\t\t} else {\n\t\t\t\twindow.addEventListener('load', attachCanvas, false);\n\t\t\t}\n\t\n\t\t\tVR.canvas.addEventListener('mozfullscreenerror', fullScreenError, false);\n\t\t\tVR.canvas.addEventListener('webkitfullscreenerror', fullScreenError, false);\n\t\t\tVR.canvas.addEventListener('fullscreenerror', fullScreenError, false);\n\t\t}\n\t\n\t\tfunction initRequirements() {\n\t\t\t//load external requirements\n\t\t\tTHREE = __webpack_require__(9);\n\t\t\t__webpack_require__(56);\n\t\t\t__webpack_require__(57);\n\t\n\t\t\t//if (typeof __DEV__ !== 'undefined' && __DEV__) {\n\t\t\t\t__webpack_require__(58);\n\t\t\t//}\n\t\n\t\t\tTHREE.ImageUtils.crossOrigin = '';\n\t\n\t\t\teventEmitter = __webpack_require__(40);\n\t\n\t\t\t//my VR stuff. todo: move these to a separate repo or two for easy packaging\n\t\t\t__webpack_require__(59);\n\t\t\t__webpack_require__(60);\n\t\t}\n\t\n\t\tfunction initialize() {\n\t\t\t//todo: set up button/info elements\n\t\n\t\t\tinitScene();\n\t\n\t\t\tinitShake();\n\t\n\t\t\tresize();\n\t\n\t\t\tdocument.addEventListener('visibilitychange', visibilityChange);\n\t\t\tdocument.addEventListener('mozvisibilitychange', visibilityChange);\n\t\t\tdocument.addEventListener('msvisibilitychange', visibilityChange);\n\t\t\tdocument.addEventListener('webkitvisibilitychange', visibilityChange);\n\t\t}\n\t\n\t\tinitRequirements();\n\t\n\t\tmodule.exports = VR = {\n\t\t\tinit: initialize,\n\t\t\trender: render,\n\t\t\tstart: start,\n\t\t\tstop: stop,\n\t\t\tresize: resize,\n\t\n\t\t\tTHREE: THREE,\n\t\n\t\t\tmaterials: materials,\n\t\n\t\t\tanimate: function (callback) {\n\t\t\t\tvar i;\n\t\t\t\tif (typeof callback === 'function') {\n\t\t\t\t\ti = animationCallbacks.indexOf(callback);\n\t\t\t\t\tif (i < 0) {\n\t\t\t\t\t\tanimationCallbacks.push(callback);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\n\t\t\tend: function (callback) {\n\t\t\t\tvar i;\n\t\n\t\t\t\tif (!callback) {\n\t\t\t\t\tanimationCallbacks.length = 0;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\n\t\t\t\tif (typeof callback === 'function') {\n\t\t\t\t\ti = animationCallbacks.indexOf(callback);\n\t\t\t\t\tif (i >= 0) {\n\t\t\t\t\t\tanimationCallbacks.splice(i, 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\n\t\t\trequestVR: function () {\n\t\t\t\t//todo: check if it's possible\n\t\t\t\tif (vrMode || !vrEffect) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\n\t\t\t\tvrMode = true;\n\t\n\t\t\t\t//full screen and render two eyes\n\t\t\t\t//always full screen\n\t\t\t\tvrEffect.requestFullScreen();\n\t\t\t},\n\t\n\t\t\texitVR: function () {\n\t\t\t\tvrMode = false;\n\t\t\t\tif (isFullscreen()) {\n\t\t\t\t\texitFullscreen();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\n\t\t\t\tmouseControls.enabled = true;\n\t\t\t\tvrControls.freeze = !orientationEnabled;\n\t\t\t\tcamera.rotation.set(0, 0, 0);\n\t\t\t},\n\t\n\t\t\tvrMode: function () {\n\t\t\t\treturn vrMode && isFullscreen();\n\t\t\t},\n\t\n\t\t\torientationEnabled: function () {\n\t\t\t\treturn !!orientationEnabled;\n\t\t\t},\n\t\t\tenableOrientation: function () {\n\t\t\t\torientationEnabled = true;\n\t\t\t\tif (!vrMode) {\n\t\t\t\t\tvrControls.freeze = false;\n\t\t\t\t}\n\t\t\t},\n\t\t\tdisableOrientation: function () {\n\t\t\t\torientationEnabled = false;\n\t\t\t\tcamera.rotation.set(0, 0, 0);\n\t\t\t\tvrControls.freeze = !vrMode;\n\t\t\t},\n\t\n\t\t\tisFullscreen: isFullscreen,\n\t\t\trequestFullscreen: requestFullscreen,\n\t\t\texitFullscreen: function () {\n\t\t\t\tif (isFullscreen()) {\n\t\t\t\t\texitFullscreen();\n\t\t\t\t}\n\t\t\t},\n\t\n\t\t\tcontrolMode: function () {\n\t\t\t\treturn vrControls && vrControls.mode();\n\t\t\t},\n\t\n\t\t\tzeroSensor: nop,\n\t\n\t\t\tvibrate: navigator.vibrate ? navigator.vibrate.bind(navigator) : nop,\n\t\n\t\t\t// Utility\n\t\t\ttimes: function (n, callback) {\n\t\t\t\tvar i;\n\t\n\t\t\t\tfor (i = 0; i < n; i++) {\n\t\t\t\t\tcallback(i);\n\t\t\t\t}\n\t\t\t},\n\t\n\t\t\tcamera: cameraWrapper,\n\t\t\tbody: bodyWrapper,\n\t\t\tscene: scene,\n\t\t\trenderer: renderer || null,\n\t\t\tcanvas: renderer && renderer.domElement || null\n\t\t};\n\t\n\t\tobjectMethods.forEach(function (method) {\n\t\t\tvar creator = __webpack_require__(61)(\"./\" + method),\n\t\t\t\tkey;\n\t\n\t\t\tVR[method] = function (options) {\n\t\t\t\tvar obj = new VRObject(scene, creator, body, options);\n\t\t\t\tvrObjects.push(obj);\n\t\t\t\tif (obj.raycastable) {\n\t\t\t\t\traycastable.push(obj.object);\n\t\t\t\t}\n\t\t\t\treturn obj;\n\t\t\t};\n\t\n\t\t\tVRObject.prototype[method] = function (options) {\n\t\t\t\tvar obj = new VRObject(this.object, creator, body, options);\n\t\t\t\tvrObjects.push(obj);\n\t\t\t\tif (obj.raycastable) {\n\t\t\t\t\traycastable.push(obj.object);\n\t\t\t\t}\n\t\t\t\treturn obj;\n\t\t\t};\n\t\n\t\t\tfor (key in creator) {\n\t\t\t\tif (creator.hasOwnProperty(key) && typeof creator[key] === 'function') {\n\t\t\t\t\tVR[method][key] = creator[key];\n\t\t\t\t\tVRObject.prototype[method][key] = creator[key];\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\n\t\teventEmitter(VR);\n\t\n\t\tObject.defineProperty(VR, 'target', {\n\t\t\tget: function () {\n\t\t\t\treturn target;\n\t\t\t}\n\t\t});\n\t}());\n\n\n/***/ },\n/* 8 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = (function () {\n\t\t'use strict';\n\t\n\t\tvar THREE = __webpack_require__(9),\n\t\t\tforEach = __webpack_require__(10),\n\t\t\tassign = __webpack_require__(18),\n\t\n\t\t\tiOS = navigator.userAgent.match(/(iPad|iPhone|iPod)/g),\n\t\n\t\t\t// https://gist.github.com/dperini/729294\n\t\t\t//urlRegex = /^(?:(?:https?|ftp):\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))(?::\\d{2,5})?(?:\\/\\S*)?$/i,\n\t\t\turlRegex = __webpack_require__(24),\n\t\n\t\t\tdataUri = /^data:image\\/(?:png|jpe?g|gif);/,\n\t\t\tassetPath = (\"http://pov-tc.pbs.org/pov/flv/2015/webvr-starter-kit/\"),\n\t\n\t\t\timages = {},\n\t\n\t\t\tmaterialTypes = {\n\t\t\t\tlambert: THREE.MeshLambertMaterial,\n\t\t\t\tbasic: THREE.MeshBasicMaterial,\n\t\t\t\tphong: THREE.MeshPhongMaterial,\n\t\t\t\tnormal: THREE.MeshNormalMaterial,\n\t\t\t\tdepth: THREE.MeshDepthMaterial\n\t\t\t},\n\t\t\ttextureFiles = {\n\t\t\t\t'asphalt': {\n\t\t\t\t\trepeat: 12\n\t\t\t\t},\n\t\t\t\t'brick-tiles': {\n\t\t\t\t\trepeat: 2\n\t\t\t\t},\n\t\t\t\t'bricks': {\n\t\t\t\t\ttype: 'phong',\n\t\t\t\t\trepeat: 4,\n\t\t\t\t\tnormalMap: 'bricks-normal.jpg',\n\t\t\t\t\tspecularMap: 'bricks-specular.jpg'\n\t\t\t\t},\n\t\t\t\t'checkerboard': {\n\t\t\t\t\trepeat: 10,\n\t\t\t\t\tmap: 'checkerboard.png'\n\t\t\t\t},\n\t\t\t\t'grass': {\n\t\t\t\t\trepeat: 12\n\t\t\t\t},\n\t\t\t\t'metal-floor': {\n\t\t\t\t\ttype: 'phong',\n\t\t\t\t\tshininess: 100,\n\t\n\t\t\t\t\trepeat: 2\n\t\t\t\t},\n\t\t\t\t'metal': {\n\t\t\t\t\ttype: 'phong',\n\t\t\t\t\tshininess: 100,\n\t\t\t\t\tshading: THREE.SmoothShading,\n\t\n\t\t\t\t\trepeat: 2\n\t\t\t\t},\n\t\t\t\t'stone': {\n\t\t\t\t\trepeat: 8\n\t\t\t\t},\n\t\t\t\t'tiles': {\n\t\t\t\t\trepeat: 4\n\t\t\t\t},\n\t\t\t\t'weathered-wood': {\n\t\t\t\t\trepeat: 8\n\t\t\t\t},\n\t\t\t\t'wood': {\n\t\t\t\t\trepeat: 4\n\t\t\t\t}\n\t\t\t},\n\t\t\ttextures = {},\n\t\t\tmaterials;\n\t\n\t\tfunction imageTexture(src, mapping, callback) {\n\t\t\tvar image,\n\t\t\t\tparse,\n\t\t\t\ttexture,\n\t\t\t\tisDataUri;\n\t\n\t\t\tfunction imageLoaded() {\n\t\t\t\tvar scale,\n\t\t\t\t\tcanvas,\n\t\t\t\t\tctx,\n\t\t\t\t\tsmallImage;\n\t\n\t\t\t\t/*\n\t\t\t\tiOS doesn't know how to handle large images. Even though the MAX_TEXTURE_SIZE\n\t\t\t\tmay be 4096, it still breaks on images that large. So we scale them down.\n\t\t\t\t*/\n\t\t\t\tif (iOS && (image.naturalWidth > 2048 || image.naturalHeight > 2048)) {\n\t\t\t\t\tscale = 2048 / Math.max( image.naturalWidth, image.naturalHeight );\n\t\n\t\t\t\t\tcanvas = document.createElement('canvas');\n\t\t\t\t\tcanvas.width = Math.floor(image.naturalWidth * scale);\n\t\t\t\t\tcanvas.height = Math.floor(image.naturalHeight * scale);\n\t\n\t\t\t\t\tctx = canvas.getContext('2d');\n\t\t\t\t\tctx.drawImage(image, 0, 0, image.naturalWidth, image.naturalHeight, 0, 0, canvas.width, canvas.height);\n\t\n\t\t\t\t\timage = canvas;\n\t\t\t\t}\n\t\n\t\t\t\ttexture.image = image;\n\t\t\t\ttexture.needsUpdate = true;\n\t\t\t\tif (typeof callback === 'function') {\n\t\t\t\t\tsetTimeout(callback.bind(null, texture, image), 1);\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tparse = dataUri.exec(src);\n\t\t\tisDataUri = !!parse;\n\t\t\tif (!parse) {\n\t\t\t\tparse = urlRegex.exec(src);\n\t\t\t}\n\t\n\t\t\t// if (!parse) {\n\t\t\t// \tconsole.error('Invalid image URL: ' + src);\n\t\t\t// \treturn;\n\t\t\t// }\n\t\n\t\t\tif (images[src]) {\n\t\t\t\timage = images[src];\n\t\t\t} else {\n\t\t\t\timage = document.createElement('img');\n\t\t\t\tif (parse && (parse[1] && parse[1] !== window.location.hostname || parse[2] && parse[2] !== window.location.port)) {\n\t\t\t\t\timage.crossOrigin = 'anonymous';\n\t\t\t\t}\n\t\t\t\timage.src = src;\n\t\t\t\timages[src] = image;\n\t\t\t}\n\t\n\t\t\ttexture = new THREE.Texture(undefined, mapping);\n\t\n\t\t\tif (image.naturalWidth || isDataUri) {\n\t\t\t\tsetTimeout(imageLoaded, 1);\n\t\t\t} else {\n\t\t\t\timage.addEventListener('load', imageLoaded);\n\t\t\t}\n\t\n\t\t\treturn texture;\n\t\t}\n\t\n\t\tfunction material(options) {\n\t\t\tvar opts,\n\t\t\t\tMaterial = materialTypes[options.type] || THREE.MeshLambertMaterial;\n\t\n\t\t\tfunction threeTexture(fn) {\n\t\t\t\tif (typeof fn === 'string') {\n\t\t\t\t\tif (urlRegex.test(fn) || dataUri.test(fn)) {\n\t\t\t\t\t\treturn imageTexture(fn);\n\t\t\t\t\t}\n\t\n\t\t\t\t\tfn = textures[fn];\n\t\t\t\t}\n\t\t\t\tif (typeof fn === 'function') {\n\t\t\t\t\treturn fn(options);\n\t\t\t\t}\n\t\n\t\t\t\treturn fn;\n\t\t\t}\n\t\n\t\t\tif (typeof options === 'string') {\n\t\t\t\toptions = {\n\t\t\t\t\tmap: options\n\t\t\t\t};\n\t\t\t}\n\t\n\t\t\topts = assign({}, options);\n\t\t\tforEach({\n\t\t\t\tambient: options.ambient || options.color,\n\t\t\t\temissive: options.emissive || options.color,\n\t\t\t\tmap: threeTexture(options.map),\n\t\t\t\tspecularMap: threeTexture(options.specularMap),\n\t\t\t\tnormalMap: threeTexture(options.normalMap),\n\t\t\t\talphaMap: threeTexture(options.alphaMap),\n\t\t\t\tenvMap: threeTexture(options.envMap),\n\t\t\t\tlightMap: threeTexture(options.lightMap)\n\t\t\t}, function (val, key) {\n\t\t\t\tif (val !== undefined) {\n\t\t\t\t\topts[key] = val;\n\t\t\t\t}\n\t\t\t});\n\t\n\t\t\tdelete opts.type;\n\t\n\t\t\treturn new Material(opts);\n\t\t}\n\t\n\t\t//figure out if script is loaded relative so we know where to find the images\n\t\tassetPath = (function () {\n\t\t\tvar url,\n\t\t\t\tscripts;\n\t\n\t\t\tif (document.currentScript) {\n\t\t\t\turl = document.currentScript.getAttribute('src');\n\t\t\t} else {\n\t\t\t\tscripts = document.getElementsByTagName('script');\n\t\t\t\turl = scripts[scripts.length - 1].getAttribute('src');\n\t\t\t}\n\t\n\t\t\tif (!urlRegex.test(url)) {\n\t\t\t\treturn url.replace(/[a-z\\-\\.]+\\.js$/i, '');\n\t\t\t}\n\t\n\t\t\treturn (\"http://pov-tc.pbs.org/pov/flv/2015/webvr-starter-kit/\");\n\t\t}());\n\t\n\t\tmaterials = {\n\t\t\tstandard: function () {\n\t\t\t\treturn new THREE.MeshLambertMaterial();\n\t\t\t},\n\t\t\ttextures: textures,\n\t\t\timageTexture: imageTexture,\n\t\t\tmaterial: material,\n\t\t\tlibrary: ['standard']\n\t\t};\n\t\n\t\tforEach(textureFiles, function (props, key) {\n\t\t\tfunction textureFactory(file, options) {\n\t\t\t\tfunction imagePath(url) {\n\t\t\t\t\tif ((/^[a-z0-9\\/\\-]+\\.(png|jpg)$/i).test(url)) {\n\t\t\t\t\t\treturn assetPath + url;\n\t\t\t\t\t}\n\t\n\t\t\t\t\treturn url;\n\t\t\t\t}\n\t\n\t\t\t\toptions = options || {};\n\t\n\t\t\t\treturn function (opts) {\n\t\t\t\t\tvar texture = imageTexture(imagePath(__webpack_require__(25)(\"./\" + file)));\n\t\n\t\t\t\t\topts = assign({}, options, opts);\n\t\n\t\t\t\t\tif (opts.repeat) {\n\t\t\t\t\t\tif (opts.repeat > 0) {\n\t\t\t\t\t\t\ttexture.repeat.set(opts.repeat, opts.repeat);\n\t\t\t\t\t\t} else if (opts.repeat instanceof THREE.Vector2) {\n\t\t\t\t\t\t\ttexture.repeat.copy(opts.repeat);\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttexture.wrapS = texture.wrapT = THREE.RepeatWrapping;\n\t\t\t\t\t}\n\t\t\t\t\treturn texture;\n\t\t\t\t};\n\t\t\t}\n\t\n\t\t\tvar map = textureFactory(props.map || key + '.jpg', props),\n\t\t\t\tmaterialDef;\n\t\n\t\t\tmaterialDef = assign({}, props, {\n\t\t\t\tmap: map\n\t\t\t});\n\t\t\ttextures[key] = map;\n\t\n\t\t\tif (props.normalMap) {\n\t\t\t\tmaterialDef.normalMap = textures[key + '-normal'] = textureFactory(props.normalMap, props);\n\t\t\t}\n\t\n\t\t\tif (props.specularMap) {\n\t\t\t\tmaterialDef.specularMap = textures[key + '-specular'] = textureFactory(props.specularMap, props);\n\t\t\t}\n\t\n\t\t\tmaterials.library.push(key);\n\t\t\tmaterials[key] = function (options) {\n\t\t\t\tvar opts = assign({}, materialDef, options);\n\t\n\t\t\t\treturn material(opts);\n\t\t\t};\n\t\t});\n\t\n\t\treturn materials;\n\t\n\t\t//var parse = urlRegex.exec('https://lh5.googleusercontent.com:80/-SNO8rWDqbUM/U085rfOBRuI/AAAAAAAAEdM/nWEWCtNceZ0/w955-h382-no/PANO_20130225_131211.jpg');\n\t}());\n\n/***/ },\n/* 9 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_RESULT__;var self = self || {};// File:src/Three.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tvar THREE = { REVISION: '73' };\r\n\t\r\n\t//\r\n\t\r\n\tif ( true ) {\r\n\t\r\n\t\t\t!(__WEBPACK_AMD_DEFINE_FACTORY__ = (THREE), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.call(exports, __webpack_require__, exports, module)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\r\n\t\r\n\t} else if ( 'undefined' !== typeof exports && 'undefined' !== typeof module ) {\r\n\t\r\n\t\t\tmodule.exports = THREE;\r\n\t\r\n\t}\r\n\t\r\n\t\r\n\t// polyfills\r\n\t\r\n\tif ( self.requestAnimationFrame === undefined || self.cancelAnimationFrame === undefined ) {\r\n\t\r\n\t\t// Missing in Android stock browser.\r\n\t\r\n\t\t( function () {\r\n\t\r\n\t\t\tvar lastTime = 0;\r\n\t\t\tvar vendors = [ 'ms', 'moz', 'webkit', 'o' ];\r\n\t\r\n\t\t\tfor ( var x = 0; x < vendors.length && ! self.requestAnimationFrame; ++ x ) {\r\n\t\r\n\t\t\t\tself.requestAnimationFrame = self[ vendors[ x ] + 'RequestAnimationFrame' ];\r\n\t\t\t\tself.cancelAnimationFrame = self[ vendors[ x ] + 'CancelAnimationFrame' ] || self[ vendors[ x ] + 'CancelRequestAnimationFrame' ];\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( self.requestAnimationFrame === undefined && self.setTimeout !== undefined ) {\r\n\t\r\n\t\t\t\tself.requestAnimationFrame = function ( callback ) {\r\n\t\r\n\t\t\t\t\tvar currTime = Date.now(), timeToCall = Math.max( 0, 16 - ( currTime - lastTime ) );\r\n\t\t\t\t\tvar id = self.setTimeout( function () {\r\n\t\r\n\t\t\t\t\t\tcallback( currTime + timeToCall );\r\n\t\r\n\t\t\t\t\t}, timeToCall );\r\n\t\t\t\t\tlastTime = currTime + timeToCall;\r\n\t\t\t\t\treturn id;\r\n\t\r\n\t\t\t\t};\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( self.cancelAnimationFrame === undefined && self.clearTimeout !== undefined ) {\r\n\t\r\n\t\t\t\tself.cancelAnimationFrame = function ( id ) {\r\n\t\r\n\t\t\t\t\tself.clearTimeout( id );\r\n\t\r\n\t\t\t\t};\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t} )();\r\n\t\r\n\t}\r\n\t\r\n\t//\r\n\t\r\n\tif ( self.performance === undefined ) {\r\n\t\r\n\t\tself.performance = {};\r\n\t\r\n\t}\r\n\t\r\n\tif ( self.performance.now === undefined ) {\r\n\t\r\n\t\t( function () {\r\n\t\r\n\t\t\tvar start = Date.now();\r\n\t\r\n\t\t\tself.performance.now = function () {\r\n\t\r\n\t\t\t\treturn Date.now() - start;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t} )();\r\n\t\r\n\t}\r\n\t\r\n\t//\r\n\t\r\n\tif ( Number.EPSILON === undefined ) {\r\n\t\r\n\t\tNumber.EPSILON = Math.pow( 2, -52 );\r\n\t\r\n\t}\r\n\t\r\n\t//\r\n\t\r\n\tif ( Math.sign === undefined ) {\r\n\t\r\n\t\t// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/sign\r\n\t\r\n\t\tMath.sign = function ( x ) {\r\n\t\r\n\t\t\treturn ( x < 0 ) ? - 1 : ( x > 0 ) ? 1 : + x;\r\n\t\r\n\t\t};\r\n\t\r\n\t}\r\n\t\r\n\tif ( Function.prototype.name === undefined && Object.defineProperty !== undefined ) {\r\n\t\r\n\t\t// Missing in IE9-11.\r\n\t\t// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/name\r\n\t\r\n\t\tObject.defineProperty( Function.prototype, 'name', {\r\n\t\r\n\t\t\tget: function () {\r\n\t\r\n\t\t\t\treturn this.toString().match( /^\\s*function\\s*(\\S*)\\s*\\(/ )[ 1 ];\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t} );\r\n\t\r\n\t}\r\n\t\r\n\t// https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent.button\r\n\t\r\n\tTHREE.MOUSE = { LEFT: 0, MIDDLE: 1, RIGHT: 2 };\r\n\t\r\n\t// GL STATE CONSTANTS\r\n\t\r\n\tTHREE.CullFaceNone = 0;\r\n\tTHREE.CullFaceBack = 1;\r\n\tTHREE.CullFaceFront = 2;\r\n\tTHREE.CullFaceFrontBack = 3;\r\n\t\r\n\tTHREE.FrontFaceDirectionCW = 0;\r\n\tTHREE.FrontFaceDirectionCCW = 1;\r\n\t\r\n\t// SHADOWING TYPES\r\n\t\r\n\tTHREE.BasicShadowMap = 0;\r\n\tTHREE.PCFShadowMap = 1;\r\n\tTHREE.PCFSoftShadowMap = 2;\r\n\t\r\n\t// MATERIAL CONSTANTS\r\n\t\r\n\t// side\r\n\t\r\n\tTHREE.FrontSide = 0;\r\n\tTHREE.BackSide = 1;\r\n\tTHREE.DoubleSide = 2;\r\n\t\r\n\t// shading\r\n\t\r\n\tTHREE.FlatShading = 1;\r\n\tTHREE.SmoothShading = 2;\r\n\t\r\n\t// colors\r\n\t\r\n\tTHREE.NoColors = 0;\r\n\tTHREE.FaceColors = 1;\r\n\tTHREE.VertexColors = 2;\r\n\t\r\n\t// blending modes\r\n\t\r\n\tTHREE.NoBlending = 0;\r\n\tTHREE.NormalBlending = 1;\r\n\tTHREE.AdditiveBlending = 2;\r\n\tTHREE.SubtractiveBlending = 3;\r\n\tTHREE.MultiplyBlending = 4;\r\n\tTHREE.CustomBlending = 5;\r\n\t\r\n\t// custom blending equations\r\n\t// (numbers start from 100 not to clash with other\r\n\t// mappings to OpenGL constants defined in Texture.js)\r\n\t\r\n\tTHREE.AddEquation = 100;\r\n\tTHREE.SubtractEquation = 101;\r\n\tTHREE.ReverseSubtractEquation = 102;\r\n\tTHREE.MinEquation = 103;\r\n\tTHREE.MaxEquation = 104;\r\n\t\r\n\t// custom blending destination factors\r\n\t\r\n\tTHREE.ZeroFactor = 200;\r\n\tTHREE.OneFactor = 201;\r\n\tTHREE.SrcColorFactor = 202;\r\n\tTHREE.OneMinusSrcColorFactor = 203;\r\n\tTHREE.SrcAlphaFactor = 204;\r\n\tTHREE.OneMinusSrcAlphaFactor = 205;\r\n\tTHREE.DstAlphaFactor = 206;\r\n\tTHREE.OneMinusDstAlphaFactor = 207;\r\n\t\r\n\t// custom blending source factors\r\n\t\r\n\t//THREE.ZeroFactor = 200;\r\n\t//THREE.OneFactor = 201;\r\n\t//THREE.SrcAlphaFactor = 204;\r\n\t//THREE.OneMinusSrcAlphaFactor = 205;\r\n\t//THREE.DstAlphaFactor = 206;\r\n\t//THREE.OneMinusDstAlphaFactor = 207;\r\n\tTHREE.DstColorFactor = 208;\r\n\tTHREE.OneMinusDstColorFactor = 209;\r\n\tTHREE.SrcAlphaSaturateFactor = 210;\r\n\t\r\n\t// depth modes\r\n\t\r\n\tTHREE.NeverDepth = 0;\r\n\tTHREE.AlwaysDepth = 1;\r\n\tTHREE.LessDepth = 2;\r\n\tTHREE.LessEqualDepth = 3;\r\n\tTHREE.EqualDepth = 4;\r\n\tTHREE.GreaterEqualDepth = 5;\r\n\tTHREE.GreaterDepth = 6;\r\n\tTHREE.NotEqualDepth = 7;\r\n\t\r\n\t\r\n\t// TEXTURE CONSTANTS\r\n\t\r\n\tTHREE.MultiplyOperation = 0;\r\n\tTHREE.MixOperation = 1;\r\n\tTHREE.AddOperation = 2;\r\n\t\r\n\t// Mapping modes\r\n\t\r\n\tTHREE.UVMapping = 300;\r\n\t\r\n\tTHREE.CubeReflectionMapping = 301;\r\n\tTHREE.CubeRefractionMapping = 302;\r\n\t\r\n\tTHREE.EquirectangularReflectionMapping = 303;\r\n\tTHREE.EquirectangularRefractionMapping = 304;\r\n\t\r\n\tTHREE.SphericalReflectionMapping = 305;\r\n\t\r\n\t// Wrapping modes\r\n\t\r\n\tTHREE.RepeatWrapping = 1000;\r\n\tTHREE.ClampToEdgeWrapping = 1001;\r\n\tTHREE.MirroredRepeatWrapping = 1002;\r\n\t\r\n\t// Filters\r\n\t\r\n\tTHREE.NearestFilter = 1003;\r\n\tTHREE.NearestMipMapNearestFilter = 1004;\r\n\tTHREE.NearestMipMapLinearFilter = 1005;\r\n\tTHREE.LinearFilter = 1006;\r\n\tTHREE.LinearMipMapNearestFilter = 1007;\r\n\tTHREE.LinearMipMapLinearFilter = 1008;\r\n\t\r\n\t// Data types\r\n\t\r\n\tTHREE.UnsignedByteType = 1009;\r\n\tTHREE.ByteType = 1010;\r\n\tTHREE.ShortType = 1011;\r\n\tTHREE.UnsignedShortType = 1012;\r\n\tTHREE.IntType = 1013;\r\n\tTHREE.UnsignedIntType = 1014;\r\n\tTHREE.FloatType = 1015;\r\n\tTHREE.HalfFloatType = 1025;\r\n\t\r\n\t// Pixel types\r\n\t\r\n\t//THREE.UnsignedByteType = 1009;\r\n\tTHREE.UnsignedShort4444Type = 1016;\r\n\tTHREE.UnsignedShort5551Type = 1017;\r\n\tTHREE.UnsignedShort565Type = 1018;\r\n\t\r\n\t// Pixel formats\r\n\t\r\n\tTHREE.AlphaFormat = 1019;\r\n\tTHREE.RGBFormat = 1020;\r\n\tTHREE.RGBAFormat = 1021;\r\n\tTHREE.LuminanceFormat = 1022;\r\n\tTHREE.LuminanceAlphaFormat = 1023;\r\n\t// THREE.RGBEFormat handled as THREE.RGBAFormat in shaders\r\n\tTHREE.RGBEFormat = THREE.RGBAFormat; //1024;\r\n\t\r\n\t// DDS / ST3C Compressed texture formats\r\n\t\r\n\tTHREE.RGB_S3TC_DXT1_Format = 2001;\r\n\tTHREE.RGBA_S3TC_DXT1_Format = 2002;\r\n\tTHREE.RGBA_S3TC_DXT3_Format = 2003;\r\n\tTHREE.RGBA_S3TC_DXT5_Format = 2004;\r\n\t\r\n\t\r\n\t// PVRTC compressed texture formats\r\n\t\r\n\tTHREE.RGB_PVRTC_4BPPV1_Format = 2100;\r\n\tTHREE.RGB_PVRTC_2BPPV1_Format = 2101;\r\n\tTHREE.RGBA_PVRTC_4BPPV1_Format = 2102;\r\n\tTHREE.RGBA_PVRTC_2BPPV1_Format = 2103;\r\n\t\r\n\t// Loop styles for AnimationAction\r\n\t\r\n\tTHREE.LoopOnce = 2200;\r\n\tTHREE.LoopRepeat = 2201;\r\n\tTHREE.LoopPingPong = 2202;\r\n\t\r\n\t// DEPRECATED\r\n\t\r\n\tTHREE.Projector = function () {\r\n\t\r\n\t\tconsole.error( 'THREE.Projector has been moved to /examples/js/renderers/Projector.js.' );\r\n\t\r\n\t\tthis.projectVector = function ( vector, camera ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.Projector: .projectVector() is now vector.project().' );\r\n\t\t\tvector.project( camera );\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.unprojectVector = function ( vector, camera ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.Projector: .unprojectVector() is now vector.unproject().' );\r\n\t\t\tvector.unproject( camera );\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.pickingRay = function ( vector, camera ) {\r\n\t\r\n\t\t\tconsole.error( 'THREE.Projector: .pickingRay() is now raycaster.setFromCamera().' );\r\n\t\r\n\t\t};\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.CanvasRenderer = function () {\r\n\t\r\n\t\tconsole.error( 'THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js' );\r\n\t\r\n\t\tthis.domElement = document.createElement( 'canvas' );\r\n\t\tthis.clear = function () {};\r\n\t\tthis.render = function () {};\r\n\t\tthis.setClearColor = function () {};\r\n\t\tthis.setSize = function () {};\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/math/Color.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.Color = function ( color ) {\r\n\t\r\n\t\tif ( arguments.length === 3 ) {\r\n\t\r\n\t\t\treturn this.fromArray( arguments );\r\n\t\r\n\t\t}\r\n\t\r\n\t\treturn this.set( color );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Color.prototype = {\r\n\t\r\n\t\tconstructor: THREE.Color,\r\n\t\r\n\t\tr: 1, g: 1, b: 1,\r\n\t\r\n\t\tset: function ( value ) {\r\n\t\r\n\t\t\tif ( value instanceof THREE.Color ) {\r\n\t\r\n\t\t\t\tthis.copy( value );\r\n\t\r\n\t\t\t} else if ( typeof value === 'number' ) {\r\n\t\r\n\t\t\t\tthis.setHex( value );\r\n\t\r\n\t\t\t} else if ( typeof value === 'string' ) {\r\n\t\r\n\t\t\t\tthis.setStyle( value );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetHex: function ( hex ) {\r\n\t\r\n\t\t\thex = Math.floor( hex );\r\n\t\r\n\t\t\tthis.r = ( hex >> 16 & 255 ) / 255;\r\n\t\t\tthis.g = ( hex >> 8 & 255 ) / 255;\r\n\t\t\tthis.b = ( hex & 255 ) / 255;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetRGB: function ( r, g, b ) {\r\n\t\r\n\t\t\tthis.r = r;\r\n\t\t\tthis.g = g;\r\n\t\t\tthis.b = b;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetHSL: function () {\r\n\t\r\n\t\t\tfunction hue2rgb( p, q, t ) {\r\n\t\r\n\t\t\t\tif ( t < 0 ) t += 1;\r\n\t\t\t\tif ( t > 1 ) t -= 1;\r\n\t\t\t\tif ( t < 1 / 6 ) return p + ( q - p ) * 6 * t;\r\n\t\t\t\tif ( t < 1 / 2 ) return q;\r\n\t\t\t\tif ( t < 2 / 3 ) return p + ( q - p ) * 6 * ( 2 / 3 - t );\r\n\t\t\t\treturn p;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn function ( h, s, l ) {\r\n\t\r\n\t\t\t\t// h,s,l ranges are in 0.0 - 1.0\r\n\t\t\t\th = THREE.Math.euclideanModulo( h, 1 );\r\n\t\t\t\ts = THREE.Math.clamp( s, 0, 1 );\r\n\t\t\t\tl = THREE.Math.clamp( l, 0, 1 );\r\n\t\r\n\t\t\t\tif ( s === 0 ) {\r\n\t\r\n\t\t\t\t\tthis.r = this.g = this.b = l;\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tvar p = l <= 0.5 ? l * ( 1 + s ) : l + s - ( l * s );\r\n\t\t\t\t\tvar q = ( 2 * l ) - p;\r\n\t\r\n\t\t\t\t\tthis.r = hue2rgb( q, p, h + 1 / 3 );\r\n\t\t\t\t\tthis.g = hue2rgb( q, p, h );\r\n\t\t\t\t\tthis.b = hue2rgb( q, p, h - 1 / 3 );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\treturn this;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tsetStyle: function ( style ) {\r\n\t\r\n\t\t\tfunction handleAlpha( string ) {\r\n\t\r\n\t\t\t\tif ( string === undefined ) return;\r\n\t\r\n\t\t\t\tif ( parseFloat( string ) < 1 ) {\r\n\t\r\n\t\t\t\t\tconsole.warn( 'THREE.Color: Alpha component of ' + style + ' will be ignored.' );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\r\n\t\t\tvar m;\r\n\t\r\n\t\t\tif ( m = /^((?:rgb|hsl)a?)\\(\\s*([^\\)]*)\\)/.exec( style ) ) {\r\n\t\r\n\t\t\t\t// rgb / hsl\r\n\t\r\n\t\t\t\tvar color;\r\n\t\t\t\tvar name = m[ 1 ];\r\n\t\t\t\tvar components = m[ 2 ];\r\n\t\r\n\t\t\t\tswitch ( name ) {\r\n\t\r\n\t\t\t\t\tcase 'rgb':\r\n\t\t\t\t\tcase 'rgba':\r\n\t\r\n\t\t\t\t\t\tif ( color = /^(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*(,\\s*([0-9]*\\.?[0-9]+)\\s*)?$/.exec( components ) ) {\r\n\t\r\n\t\t\t\t\t\t\t// rgb(255,0,0) rgba(255,0,0,0.5)\r\n\t\t\t\t\t\t\tthis.r = Math.min( 255, parseInt( color[ 1 ], 10 ) ) / 255;\r\n\t\t\t\t\t\t\tthis.g = Math.min( 255, parseInt( color[ 2 ], 10 ) ) / 255;\r\n\t\t\t\t\t\t\tthis.b = Math.min( 255, parseInt( color[ 3 ], 10 ) ) / 255;\r\n\t\r\n\t\t\t\t\t\t\thandleAlpha( color[ 5 ] );\r\n\t\r\n\t\t\t\t\t\t\treturn this;\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\tif ( color = /^(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*(,\\s*([0-9]*\\.?[0-9]+)\\s*)?$/.exec( components ) ) {\r\n\t\r\n\t\t\t\t\t\t\t// rgb(100%,0%,0%) rgba(100%,0%,0%,0.5)\r\n\t\t\t\t\t\t\tthis.r = Math.min( 100, parseInt( color[ 1 ], 10 ) ) / 100;\r\n\t\t\t\t\t\t\tthis.g = Math.min( 100, parseInt( color[ 2 ], 10 ) ) / 100;\r\n\t\t\t\t\t\t\tthis.b = Math.min( 100, parseInt( color[ 3 ], 10 ) ) / 100;\r\n\t\r\n\t\t\t\t\t\t\thandleAlpha( color[ 5 ] );\r\n\t\r\n\t\t\t\t\t\t\treturn this;\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase 'hsl':\r\n\t\t\t\t\tcase 'hsla':\r\n\t\r\n\t\t\t\t\t\tif ( color = /^([0-9]*\\.?[0-9]+)\\s*,\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*(,\\s*([0-9]*\\.?[0-9]+)\\s*)?$/.exec( components ) ) {\r\n\t\r\n\t\t\t\t\t\t\t// hsl(120,50%,50%) hsla(120,50%,50%,0.5)\r\n\t\t\t\t\t\t\tvar h = parseFloat( color[ 1 ] ) / 360;\r\n\t\t\t\t\t\t\tvar s = parseInt( color[ 2 ], 10 ) / 100;\r\n\t\t\t\t\t\t\tvar l = parseInt( color[ 3 ], 10 ) / 100;\r\n\t\r\n\t\t\t\t\t\t\thandleAlpha( color[ 5 ] );\r\n\t\r\n\t\t\t\t\t\t\treturn this.setHSL( h, s, l );\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t} else if ( m = /^\\#([A-Fa-f0-9]+)$/.exec( style ) ) {\r\n\t\r\n\t\t\t\t// hex color\r\n\t\r\n\t\t\t\tvar hex = m[ 1 ];\r\n\t\t\t\tvar size = hex.length;\r\n\t\r\n\t\t\t\tif ( size === 3 ) {\r\n\t\r\n\t\t\t\t\t// #ff0\r\n\t\t\t\t\tthis.r = parseInt( hex.charAt( 0 ) + hex.charAt( 0 ), 16 ) / 255;\r\n\t\t\t\t\tthis.g = parseInt( hex.charAt( 1 ) + hex.charAt( 1 ), 16 ) / 255;\r\n\t\t\t\t\tthis.b = parseInt( hex.charAt( 2 ) + hex.charAt( 2 ), 16 ) / 255;\r\n\t\r\n\t\t\t\t\treturn this;\r\n\t\r\n\t\t\t\t} else if ( size === 6 ) {\r\n\t\r\n\t\t\t\t\t// #ff0000\r\n\t\t\t\t\tthis.r = parseInt( hex.charAt( 0 ) + hex.charAt( 1 ), 16 ) / 255;\r\n\t\t\t\t\tthis.g = parseInt( hex.charAt( 2 ) + hex.charAt( 3 ), 16 ) / 255;\r\n\t\t\t\t\tthis.b = parseInt( hex.charAt( 4 ) + hex.charAt( 5 ), 16 ) / 255;\r\n\t\r\n\t\t\t\t\treturn this;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( style && style.length > 0 ) {\r\n\t\r\n\t\t\t\t// color keywords\r\n\t\t\t\tvar hex = THREE.ColorKeywords[ style ];\r\n\t\r\n\t\t\t\tif ( hex !== undefined ) {\r\n\t\r\n\t\t\t\t\t// red\r\n\t\t\t\t\tthis.setHex( hex );\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t// unknown color\r\n\t\t\t\t\tconsole.warn( 'THREE.Color: Unknown color ' + style );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tclone: function () {\r\n\t\r\n\t\t\treturn new this.constructor( this.r, this.g, this.b );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcopy: function ( color ) {\r\n\t\r\n\t\t\tthis.r = color.r;\r\n\t\t\tthis.g = color.g;\r\n\t\t\tthis.b = color.b;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcopyGammaToLinear: function ( color, gammaFactor ) {\r\n\t\r\n\t\t\tif ( gammaFactor === undefined ) gammaFactor = 2.0;\r\n\t\r\n\t\t\tthis.r = Math.pow( color.r, gammaFactor );\r\n\t\t\tthis.g = Math.pow( color.g, gammaFactor );\r\n\t\t\tthis.b = Math.pow( color.b, gammaFactor );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcopyLinearToGamma: function ( color, gammaFactor ) {\r\n\t\r\n\t\t\tif ( gammaFactor === undefined ) gammaFactor = 2.0;\r\n\t\r\n\t\t\tvar safeInverse = ( gammaFactor > 0 ) ? ( 1.0 / gammaFactor ) : 1.0;\r\n\t\r\n\t\t\tthis.r = Math.pow( color.r, safeInverse );\r\n\t\t\tthis.g = Math.pow( color.g, safeInverse );\r\n\t\t\tthis.b = Math.pow( color.b, safeInverse );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tconvertGammaToLinear: function () {\r\n\t\r\n\t\t\tvar r = this.r, g = this.g, b = this.b;\r\n\t\r\n\t\t\tthis.r = r * r;\r\n\t\t\tthis.g = g * g;\r\n\t\t\tthis.b = b * b;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tconvertLinearToGamma: function () {\r\n\t\r\n\t\t\tthis.r = Math.sqrt( this.r );\r\n\t\t\tthis.g = Math.sqrt( this.g );\r\n\t\t\tthis.b = Math.sqrt( this.b );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tgetHex: function () {\r\n\t\r\n\t\t\treturn ( this.r * 255 ) << 16 ^ ( this.g * 255 ) << 8 ^ ( this.b * 255 ) << 0;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tgetHexString: function () {\r\n\t\r\n\t\t\treturn ( '000000' + this.getHex().toString( 16 ) ).slice( - 6 );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tgetHSL: function ( optionalTarget ) {\r\n\t\r\n\t\t\t// h,s,l ranges are in 0.0 - 1.0\r\n\t\r\n\t\t\tvar hsl = optionalTarget || { h: 0, s: 0, l: 0 };\r\n\t\r\n\t\t\tvar r = this.r, g = this.g, b = this.b;\r\n\t\r\n\t\t\tvar max = Math.max( r, g, b );\r\n\t\t\tvar min = Math.min( r, g, b );\r\n\t\r\n\t\t\tvar hue, saturation;\r\n\t\t\tvar lightness = ( min + max ) / 2.0;\r\n\t\r\n\t\t\tif ( min === max ) {\r\n\t\r\n\t\t\t\thue = 0;\r\n\t\t\t\tsaturation = 0;\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\tvar delta = max - min;\r\n\t\r\n\t\t\t\tsaturation = lightness <= 0.5 ? delta / ( max + min ) : delta / ( 2 - max - min );\r\n\t\r\n\t\t\t\tswitch ( max ) {\r\n\t\r\n\t\t\t\t\tcase r: hue = ( g - b ) / delta + ( g < b ? 6 : 0 ); break;\r\n\t\t\t\t\tcase g: hue = ( b - r ) / delta + 2; break;\r\n\t\t\t\t\tcase b: hue = ( r - g ) / delta + 4; break;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\thue /= 6;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\thsl.h = hue;\r\n\t\t\thsl.s = saturation;\r\n\t\t\thsl.l = lightness;\r\n\t\r\n\t\t\treturn hsl;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tgetStyle: function () {\r\n\t\r\n\t\t\treturn 'rgb(' + ( ( this.r * 255 ) | 0 ) + ',' + ( ( this.g * 255 ) | 0 ) + ',' + ( ( this.b * 255 ) | 0 ) + ')';\r\n\t\r\n\t\t},\r\n\t\r\n\t\toffsetHSL: function ( h, s, l ) {\r\n\t\r\n\t\t\tvar hsl = this.getHSL();\r\n\t\r\n\t\t\thsl.h += h; hsl.s += s; hsl.l += l;\r\n\t\r\n\t\t\tthis.setHSL( hsl.h, hsl.s, hsl.l );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tadd: function ( color ) {\r\n\t\r\n\t\t\tthis.r += color.r;\r\n\t\t\tthis.g += color.g;\r\n\t\t\tthis.b += color.b;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\taddColors: function ( color1, color2 ) {\r\n\t\r\n\t\t\tthis.r = color1.r + color2.r;\r\n\t\t\tthis.g = color1.g + color2.g;\r\n\t\t\tthis.b = color1.b + color2.b;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\taddScalar: function ( s ) {\r\n\t\r\n\t\t\tthis.r += s;\r\n\t\t\tthis.g += s;\r\n\t\t\tthis.b += s;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tmultiply: function ( color ) {\r\n\t\r\n\t\t\tthis.r *= color.r;\r\n\t\t\tthis.g *= color.g;\r\n\t\t\tthis.b *= color.b;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tmultiplyScalar: function ( s ) {\r\n\t\r\n\t\t\tthis.r *= s;\r\n\t\t\tthis.g *= s;\r\n\t\t\tthis.b *= s;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tlerp: function ( color, alpha ) {\r\n\t\r\n\t\t\tthis.r += ( color.r - this.r ) * alpha;\r\n\t\t\tthis.g += ( color.g - this.g ) * alpha;\r\n\t\t\tthis.b += ( color.b - this.b ) * alpha;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tequals: function ( c ) {\r\n\t\r\n\t\t\treturn ( c.r === this.r ) && ( c.g === this.g ) && ( c.b === this.b );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tfromArray: function ( array, offset ) {\r\n\t\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\t\r\n\t\t\tthis.r = array[ offset ];\r\n\t\t\tthis.g = array[ offset + 1 ];\r\n\t\t\tthis.b = array[ offset + 2 ];\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\ttoArray: function ( array, offset ) {\r\n\t\r\n\t\t\tif ( array === undefined ) array = [];\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\t\r\n\t\t\tarray[ offset ] = this.r;\r\n\t\t\tarray[ offset + 1 ] = this.g;\r\n\t\t\tarray[ offset + 2 ] = this.b;\r\n\t\r\n\t\t\treturn array;\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.ColorKeywords = { 'aliceblue': 0xF0F8FF, 'antiquewhite': 0xFAEBD7, 'aqua': 0x00FFFF, 'aquamarine': 0x7FFFD4, 'azure': 0xF0FFFF,\r\n\t'beige': 0xF5F5DC, 'bisque': 0xFFE4C4, 'black': 0x000000, 'blanchedalmond': 0xFFEBCD, 'blue': 0x0000FF, 'blueviolet': 0x8A2BE2,\r\n\t'brown': 0xA52A2A, 'burlywood': 0xDEB887, 'cadetblue': 0x5F9EA0, 'chartreuse': 0x7FFF00, 'chocolate': 0xD2691E, 'coral': 0xFF7F50,\r\n\t'cornflowerblue': 0x6495ED, 'cornsilk': 0xFFF8DC, 'crimson': 0xDC143C, 'cyan': 0x00FFFF, 'darkblue': 0x00008B, 'darkcyan': 0x008B8B,\r\n\t'darkgoldenrod': 0xB8860B, 'darkgray': 0xA9A9A9, 'darkgreen': 0x006400, 'darkgrey': 0xA9A9A9, 'darkkhaki': 0xBDB76B, 'darkmagenta': 0x8B008B,\r\n\t'darkolivegreen': 0x556B2F, 'darkorange': 0xFF8C00, 'darkorchid': 0x9932CC, 'darkred': 0x8B0000, 'darksalmon': 0xE9967A, 'darkseagreen': 0x8FBC8F,\r\n\t'darkslateblue': 0x483D8B, 'darkslategray': 0x2F4F4F, 'darkslategrey': 0x2F4F4F, 'darkturquoise': 0x00CED1, 'darkviolet': 0x9400D3,\r\n\t'deeppink': 0xFF1493, 'deepskyblue': 0x00BFFF, 'dimgray': 0x696969, 'dimgrey': 0x696969, 'dodgerblue': 0x1E90FF, 'firebrick': 0xB22222,\r\n\t'floralwhite': 0xFFFAF0, 'forestgreen': 0x228B22, 'fuchsia': 0xFF00FF, 'gainsboro': 0xDCDCDC, 'ghostwhite': 0xF8F8FF, 'gold': 0xFFD700,\r\n\t'goldenrod': 0xDAA520, 'gray': 0x808080, 'green': 0x008000, 'greenyellow': 0xADFF2F, 'grey': 0x808080, 'honeydew': 0xF0FFF0, 'hotpink': 0xFF69B4,\r\n\t'indianred': 0xCD5C5C, 'indigo': 0x4B0082, 'ivory': 0xFFFFF0, 'khaki': 0xF0E68C, 'lavender': 0xE6E6FA, 'lavenderblush': 0xFFF0F5, 'lawngreen': 0x7CFC00,\r\n\t'lemonchiffon': 0xFFFACD, 'lightblue': 0xADD8E6, 'lightcoral': 0xF08080, 'lightcyan': 0xE0FFFF, 'lightgoldenrodyellow': 0xFAFAD2, 'lightgray': 0xD3D3D3,\r\n\t'lightgreen': 0x90EE90, 'lightgrey': 0xD3D3D3, 'lightpink': 0xFFB6C1, 'lightsalmon': 0xFFA07A, 'lightseagreen': 0x20B2AA, 'lightskyblue': 0x87CEFA,\r\n\t'lightslategray': 0x778899, 'lightslategrey': 0x778899, 'lightsteelblue': 0xB0C4DE, 'lightyellow': 0xFFFFE0, 'lime': 0x00FF00, 'limegreen': 0x32CD32,\r\n\t'linen': 0xFAF0E6, 'magenta': 0xFF00FF, 'maroon': 0x800000, 'mediumaquamarine': 0x66CDAA, 'mediumblue': 0x0000CD, 'mediumorchid': 0xBA55D3,\r\n\t'mediumpurple': 0x9370DB, 'mediumseagreen': 0x3CB371, 'mediumslateblue': 0x7B68EE, 'mediumspringgreen': 0x00FA9A, 'mediumturquoise': 0x48D1CC,\r\n\t'mediumvioletred': 0xC71585, 'midnightblue': 0x191970, 'mintcream': 0xF5FFFA, 'mistyrose': 0xFFE4E1, 'moccasin': 0xFFE4B5, 'navajowhite': 0xFFDEAD,\r\n\t'navy': 0x000080, 'oldlace': 0xFDF5E6, 'olive': 0x808000, 'olivedrab': 0x6B8E23, 'orange': 0xFFA500, 'orangered': 0xFF4500, 'orchid': 0xDA70D6,\r\n\t'palegoldenrod': 0xEEE8AA, 'palegreen': 0x98FB98, 'paleturquoise': 0xAFEEEE, 'palevioletred': 0xDB7093, 'papayawhip': 0xFFEFD5, 'peachpuff': 0xFFDAB9,\r\n\t'peru': 0xCD853F, 'pink': 0xFFC0CB, 'plum': 0xDDA0DD, 'powderblue': 0xB0E0E6, 'purple': 0x800080, 'red': 0xFF0000, 'rosybrown': 0xBC8F8F,\r\n\t'royalblue': 0x4169E1, 'saddlebrown': 0x8B4513, 'salmon': 0xFA8072, 'sandybrown': 0xF4A460, 'seagreen': 0x2E8B57, 'seashell': 0xFFF5EE,\r\n\t'sienna': 0xA0522D, 'silver': 0xC0C0C0, 'skyblue': 0x87CEEB, 'slateblue': 0x6A5ACD, 'slategray': 0x708090, 'slategrey': 0x708090, 'snow': 0xFFFAFA,\r\n\t'springgreen': 0x00FF7F, 'steelblue': 0x4682B4, 'tan': 0xD2B48C, 'teal': 0x008080, 'thistle': 0xD8BFD8, 'tomato': 0xFF6347, 'turquoise': 0x40E0D0,\r\n\t'violet': 0xEE82EE, 'wheat': 0xF5DEB3, 'white': 0xFFFFFF, 'whitesmoke': 0xF5F5F5, 'yellow': 0xFFFF00, 'yellowgreen': 0x9ACD32 };\r\n\t\r\n\t// File:src/math/Quaternion.js\r\n\t\r\n\t/**\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t * @author bhouston / http://clara.io\r\n\t */\r\n\t\r\n\tTHREE.Quaternion = function ( x, y, z, w ) {\r\n\t\r\n\t\tthis._x = x || 0;\r\n\t\tthis._y = y || 0;\r\n\t\tthis._z = z || 0;\r\n\t\tthis._w = ( w !== undefined ) ? w : 1;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Quaternion.prototype = {\r\n\t\r\n\t\tconstructor: THREE.Quaternion,\r\n\t\r\n\t\tget x () {\r\n\t\r\n\t\t\treturn this._x;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tset x ( value ) {\r\n\t\r\n\t\t\tthis._x = value;\r\n\t\t\tthis.onChangeCallback();\r\n\t\r\n\t\t},\r\n\t\r\n\t\tget y () {\r\n\t\r\n\t\t\treturn this._y;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tset y ( value ) {\r\n\t\r\n\t\t\tthis._y = value;\r\n\t\t\tthis.onChangeCallback();\r\n\t\r\n\t\t},\r\n\t\r\n\t\tget z () {\r\n\t\r\n\t\t\treturn this._z;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tset z ( value ) {\r\n\t\r\n\t\t\tthis._z = value;\r\n\t\t\tthis.onChangeCallback();\r\n\t\r\n\t\t},\r\n\t\r\n\t\tget w () {\r\n\t\r\n\t\t\treturn this._w;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tset w ( value ) {\r\n\t\r\n\t\t\tthis._w = value;\r\n\t\t\tthis.onChangeCallback();\r\n\t\r\n\t\t},\r\n\t\r\n\t\tset: function ( x, y, z, w ) {\r\n\t\r\n\t\t\tthis._x = x;\r\n\t\t\tthis._y = y;\r\n\t\t\tthis._z = z;\r\n\t\t\tthis._w = w;\r\n\t\r\n\t\t\tthis.onChangeCallback();\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tclone: function () {\r\n\t\r\n\t\t\treturn new this.constructor( this._x, this._y, this._z, this._w );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcopy: function ( quaternion ) {\r\n\t\r\n\t\t\tthis._x = quaternion.x;\r\n\t\t\tthis._y = quaternion.y;\r\n\t\t\tthis._z = quaternion.z;\r\n\t\t\tthis._w = quaternion.w;\r\n\t\r\n\t\t\tthis.onChangeCallback();\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetFromEuler: function ( euler, update ) {\r\n\t\r\n\t\t\tif ( euler instanceof THREE.Euler === false ) {\r\n\t\r\n\t\t\t\tthrow new Error( 'THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.' );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// http://www.mathworks.com/matlabcentral/fileexchange/\r\n\t\t\t// \t20696-function-to-convert-between-dcm-euler-angles-quaternions-and-euler-vectors/\r\n\t\t\t//\tcontent/SpinCalc.m\r\n\t\r\n\t\t\tvar c1 = Math.cos( euler._x / 2 );\r\n\t\t\tvar c2 = Math.cos( euler._y / 2 );\r\n\t\t\tvar c3 = Math.cos( euler._z / 2 );\r\n\t\t\tvar s1 = Math.sin( euler._x / 2 );\r\n\t\t\tvar s2 = Math.sin( euler._y / 2 );\r\n\t\t\tvar s3 = Math.sin( euler._z / 2 );\r\n\t\r\n\t\t\tvar order = euler.order;\r\n\t\r\n\t\t\tif ( order === 'XYZ' ) {\r\n\t\r\n\t\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\r\n\t\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\r\n\t\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\r\n\t\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\r\n\t\r\n\t\t\t} else if ( order === 'YXZ' ) {\r\n\t\r\n\t\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\r\n\t\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\r\n\t\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\r\n\t\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\r\n\t\r\n\t\t\t} else if ( order === 'ZXY' ) {\r\n\t\r\n\t\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\r\n\t\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\r\n\t\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\r\n\t\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\r\n\t\r\n\t\t\t} else if ( order === 'ZYX' ) {\r\n\t\r\n\t\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\r\n\t\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\r\n\t\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\r\n\t\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\r\n\t\r\n\t\t\t} else if ( order === 'YZX' ) {\r\n\t\r\n\t\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\r\n\t\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\r\n\t\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\r\n\t\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\r\n\t\r\n\t\t\t} else if ( order === 'XZY' ) {\r\n\t\r\n\t\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\r\n\t\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\r\n\t\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\r\n\t\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( update !== false ) this.onChangeCallback();\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetFromAxisAngle: function ( axis, angle ) {\r\n\t\r\n\t\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/angleToQuaternion/index.htm\r\n\t\r\n\t\t\t// assumes axis is normalized\r\n\t\r\n\t\t\tvar halfAngle = angle / 2, s = Math.sin( halfAngle );\r\n\t\r\n\t\t\tthis._x = axis.x * s;\r\n\t\t\tthis._y = axis.y * s;\r\n\t\t\tthis._z = axis.z * s;\r\n\t\t\tthis._w = Math.cos( halfAngle );\r\n\t\r\n\t\t\tthis.onChangeCallback();\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetFromRotationMatrix: function ( m ) {\r\n\t\r\n\t\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToQuaternion/index.htm\r\n\t\r\n\t\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\t\r\n\t\t\tvar te = m.elements,\r\n\t\r\n\t\t\t\tm11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ],\r\n\t\t\t\tm21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ],\r\n\t\t\t\tm31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ],\r\n\t\r\n\t\t\t\ttrace = m11 + m22 + m33,\r\n\t\t\t\ts;\r\n\t\r\n\t\t\tif ( trace > 0 ) {\r\n\t\r\n\t\t\t\ts = 0.5 / Math.sqrt( trace + 1.0 );\r\n\t\r\n\t\t\t\tthis._w = 0.25 / s;\r\n\t\t\t\tthis._x = ( m32 - m23 ) * s;\r\n\t\t\t\tthis._y = ( m13 - m31 ) * s;\r\n\t\t\t\tthis._z = ( m21 - m12 ) * s;\r\n\t\r\n\t\t\t} else if ( m11 > m22 && m11 > m33 ) {\r\n\t\r\n\t\t\t\ts = 2.0 * Math.sqrt( 1.0 + m11 - m22 - m33 );\r\n\t\r\n\t\t\t\tthis._w = ( m32 - m23 ) / s;\r\n\t\t\t\tthis._x = 0.25 * s;\r\n\t\t\t\tthis._y = ( m12 + m21 ) / s;\r\n\t\t\t\tthis._z = ( m13 + m31 ) / s;\r\n\t\r\n\t\t\t} else if ( m22 > m33 ) {\r\n\t\r\n\t\t\t\ts = 2.0 * Math.sqrt( 1.0 + m22 - m11 - m33 );\r\n\t\r\n\t\t\t\tthis._w = ( m13 - m31 ) / s;\r\n\t\t\t\tthis._x = ( m12 + m21 ) / s;\r\n\t\t\t\tthis._y = 0.25 * s;\r\n\t\t\t\tthis._z = ( m23 + m32 ) / s;\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\ts = 2.0 * Math.sqrt( 1.0 + m33 - m11 - m22 );\r\n\t\r\n\t\t\t\tthis._w = ( m21 - m12 ) / s;\r\n\t\t\t\tthis._x = ( m13 + m31 ) / s;\r\n\t\t\t\tthis._y = ( m23 + m32 ) / s;\r\n\t\t\t\tthis._z = 0.25 * s;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tthis.onChangeCallback();\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetFromUnitVectors: function () {\r\n\t\r\n\t\t\t// http://lolengine.net/blog/2014/02/24/quaternion-from-two-vectors-final\r\n\t\r\n\t\t\t// assumes direction vectors vFrom and vTo are normalized\r\n\t\r\n\t\t\tvar v1, r;\r\n\t\r\n\t\t\tvar EPS = 0.000001;\r\n\t\r\n\t\t\treturn function ( vFrom, vTo ) {\r\n\t\r\n\t\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\t\r\n\t\t\t\tr = vFrom.dot( vTo ) + 1;\r\n\t\r\n\t\t\t\tif ( r < EPS ) {\r\n\t\r\n\t\t\t\t\tr = 0;\r\n\t\r\n\t\t\t\t\tif ( Math.abs( vFrom.x ) > Math.abs( vFrom.z ) ) {\r\n\t\r\n\t\t\t\t\t\tv1.set( - vFrom.y, vFrom.x, 0 );\r\n\t\r\n\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\tv1.set( 0, - vFrom.z, vFrom.y );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tv1.crossVectors( vFrom, vTo );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tthis._x = v1.x;\r\n\t\t\t\tthis._y = v1.y;\r\n\t\t\t\tthis._z = v1.z;\r\n\t\t\t\tthis._w = r;\r\n\t\r\n\t\t\t\tthis.normalize();\r\n\t\r\n\t\t\t\treturn this;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tinverse: function () {\r\n\t\r\n\t\t\tthis.conjugate().normalize();\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tconjugate: function () {\r\n\t\r\n\t\t\tthis._x *= - 1;\r\n\t\t\tthis._y *= - 1;\r\n\t\t\tthis._z *= - 1;\r\n\t\r\n\t\t\tthis.onChangeCallback();\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tdot: function ( v ) {\r\n\t\r\n\t\t\treturn this._x * v._x + this._y * v._y + this._z * v._z + this._w * v._w;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tlengthSq: function () {\r\n\t\r\n\t\t\treturn this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tlength: function () {\r\n\t\r\n\t\t\treturn Math.sqrt( this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tnormalize: function () {\r\n\t\r\n\t\t\tvar l = this.length();\r\n\t\r\n\t\t\tif ( l === 0 ) {\r\n\t\r\n\t\t\t\tthis._x = 0;\r\n\t\t\t\tthis._y = 0;\r\n\t\t\t\tthis._z = 0;\r\n\t\t\t\tthis._w = 1;\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\tl = 1 / l;\r\n\t\r\n\t\t\t\tthis._x = this._x * l;\r\n\t\t\t\tthis._y = this._y * l;\r\n\t\t\t\tthis._z = this._z * l;\r\n\t\t\t\tthis._w = this._w * l;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tthis.onChangeCallback();\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tmultiply: function ( q, p ) {\r\n\t\r\n\t\t\tif ( p !== undefined ) {\r\n\t\r\n\t\t\t\tconsole.warn( 'THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead.' );\r\n\t\t\t\treturn this.multiplyQuaternions( q, p );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn this.multiplyQuaternions( this, q );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tmultiplyQuaternions: function ( a, b ) {\r\n\t\r\n\t\t\t// from http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/code/index.htm\r\n\t\r\n\t\t\tvar qax = a._x, qay = a._y, qaz = a._z, qaw = a._w;\r\n\t\t\tvar qbx = b._x, qby = b._y, qbz = b._z, qbw = b._w;\r\n\t\r\n\t\t\tthis._x = qax * qbw + qaw * qbx + qay * qbz - qaz * qby;\r\n\t\t\tthis._y = qay * qbw + qaw * qby + qaz * qbx - qax * qbz;\r\n\t\t\tthis._z = qaz * qbw + qaw * qbz + qax * qby - qay * qbx;\r\n\t\t\tthis._w = qaw * qbw - qax * qbx - qay * qby - qaz * qbz;\r\n\t\r\n\t\t\tthis.onChangeCallback();\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tmultiplyVector3: function ( vector ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.' );\r\n\t\t\treturn vector.applyQuaternion( this );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tslerp: function ( qb, t ) {\r\n\t\r\n\t\t\tif ( t === 0 ) return this;\r\n\t\t\tif ( t === 1 ) return this.copy( qb );\r\n\t\r\n\t\t\tvar x = this._x, y = this._y, z = this._z, w = this._w;\r\n\t\r\n\t\t\t// http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/slerp/\r\n\t\r\n\t\t\tvar cosHalfTheta = w * qb._w + x * qb._x + y * qb._y + z * qb._z;\r\n\t\r\n\t\t\tif ( cosHalfTheta < 0 ) {\r\n\t\r\n\t\t\t\tthis._w = - qb._w;\r\n\t\t\t\tthis._x = - qb._x;\r\n\t\t\t\tthis._y = - qb._y;\r\n\t\t\t\tthis._z = - qb._z;\r\n\t\r\n\t\t\t\tcosHalfTheta = - cosHalfTheta;\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\tthis.copy( qb );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( cosHalfTheta >= 1.0 ) {\r\n\t\r\n\t\t\t\tthis._w = w;\r\n\t\t\t\tthis._x = x;\r\n\t\t\t\tthis._y = y;\r\n\t\t\t\tthis._z = z;\r\n\t\r\n\t\t\t\treturn this;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar halfTheta = Math.acos( cosHalfTheta );\r\n\t\t\tvar sinHalfTheta = Math.sqrt( 1.0 - cosHalfTheta * cosHalfTheta );\r\n\t\r\n\t\t\tif ( Math.abs( sinHalfTheta ) < 0.001 ) {\r\n\t\r\n\t\t\t\tthis._w = 0.5 * ( w + this._w );\r\n\t\t\t\tthis._x = 0.5 * ( x + this._x );\r\n\t\t\t\tthis._y = 0.5 * ( y + this._y );\r\n\t\t\t\tthis._z = 0.5 * ( z + this._z );\r\n\t\r\n\t\t\t\treturn this;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar ratioA = Math.sin( ( 1 - t ) * halfTheta ) / sinHalfTheta,\r\n\t\t\tratioB = Math.sin( t * halfTheta ) / sinHalfTheta;\r\n\t\r\n\t\t\tthis._w = ( w * ratioA + this._w * ratioB );\r\n\t\t\tthis._x = ( x * ratioA + this._x * ratioB );\r\n\t\t\tthis._y = ( y * ratioA + this._y * ratioB );\r\n\t\t\tthis._z = ( z * ratioA + this._z * ratioB );\r\n\t\r\n\t\t\tthis.onChangeCallback();\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tequals: function ( quaternion ) {\r\n\t\r\n\t\t\treturn ( quaternion._x === this._x ) && ( quaternion._y === this._y ) && ( quaternion._z === this._z ) && ( quaternion._w === this._w );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tfromArray: function ( array, offset ) {\r\n\t\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\t\r\n\t\t\tthis._x = array[ offset ];\r\n\t\t\tthis._y = array[ offset + 1 ];\r\n\t\t\tthis._z = array[ offset + 2 ];\r\n\t\t\tthis._w = array[ offset + 3 ];\r\n\t\r\n\t\t\tthis.onChangeCallback();\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\ttoArray: function ( array, offset ) {\r\n\t\r\n\t\t\tif ( array === undefined ) array = [];\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\t\r\n\t\t\tarray[ offset ] = this._x;\r\n\t\t\tarray[ offset + 1 ] = this._y;\r\n\t\t\tarray[ offset + 2 ] = this._z;\r\n\t\t\tarray[ offset + 3 ] = this._w;\r\n\t\r\n\t\t\treturn array;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tonChange: function ( callback ) {\r\n\t\r\n\t\t\tthis.onChangeCallback = callback;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tonChangeCallback: function () {}\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Quaternion.slerp = function ( qa, qb, qm, t ) {\r\n\t\r\n\t\treturn qm.copy( qa ).slerp( qb, t );\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/math/Vector2.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author philogb / http://blog.thejit.org/\r\n\t * @author egraether / http://egraether.com/\r\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\r\n\t */\r\n\t\r\n\tTHREE.Vector2 = function ( x, y ) {\r\n\t\r\n\t\tthis.x = x || 0;\r\n\t\tthis.y = y || 0;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Vector2.prototype = {\r\n\t\r\n\t\tconstructor: THREE.Vector2,\r\n\t\r\n\t\tget width() { return this.x },\r\n\t\tset width( value ) { this.x = value },\r\n\t\r\n\t\tget height() { return this.y },\r\n\t\tset height( value ) { this.y = value },\r\n\t\r\n\t\t//\r\n\t\r\n\t\tset: function ( x, y ) {\r\n\t\r\n\t\t\tthis.x = x;\r\n\t\t\tthis.y = y;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetX: function ( x ) {\r\n\t\r\n\t\t\tthis.x = x;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetY: function ( y ) {\r\n\t\r\n\t\t\tthis.y = y;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetComponent: function ( index, value ) {\r\n\t\r\n\t\t\tswitch ( index ) {\r\n\t\r\n\t\t\t\tcase 0: this.x = value; break;\r\n\t\t\t\tcase 1: this.y = value; break;\r\n\t\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t},\r\n\t\r\n\t\tgetComponent: function ( index ) {\r\n\t\r\n\t\t\tswitch ( index ) {\r\n\t\r\n\t\t\t\tcase 0: return this.x;\r\n\t\t\t\tcase 1: return this.y;\r\n\t\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t},\r\n\t\r\n\t\tclone: function () {\r\n\t\r\n\t\t\treturn new this.constructor( this.x, this.y );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcopy: function ( v ) {\r\n\t\r\n\t\t\tthis.x = v.x;\r\n\t\t\tthis.y = v.y;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tadd: function ( v, w ) {\r\n\t\r\n\t\t\tif ( w !== undefined ) {\r\n\t\r\n\t\t\t\tconsole.warn( 'THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead.' );\r\n\t\t\t\treturn this.addVectors( v, w );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tthis.x += v.x;\r\n\t\t\tthis.y += v.y;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\taddScalar: function ( s ) {\r\n\t\r\n\t\t\tthis.x += s;\r\n\t\t\tthis.y += s;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\taddVectors: function ( a, b ) {\r\n\t\r\n\t\t\tthis.x = a.x + b.x;\r\n\t\t\tthis.y = a.y + b.y;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\taddScaledVector: function ( v, s ) {\r\n\t\r\n\t\t\tthis.x += v.x * s;\r\n\t\t\tthis.y += v.y * s;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsub: function ( v, w ) {\r\n\t\r\n\t\t\tif ( w !== undefined ) {\r\n\t\r\n\t\t\t\tconsole.warn( 'THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.' );\r\n\t\t\t\treturn this.subVectors( v, w );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tthis.x -= v.x;\r\n\t\t\tthis.y -= v.y;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsubScalar: function ( s ) {\r\n\t\r\n\t\t\tthis.x -= s;\r\n\t\t\tthis.y -= s;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsubVectors: function ( a, b ) {\r\n\t\r\n\t\t\tthis.x = a.x - b.x;\r\n\t\t\tthis.y = a.y - b.y;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tmultiply: function ( v ) {\r\n\t\r\n\t\t\tthis.x *= v.x;\r\n\t\t\tthis.y *= v.y;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tmultiplyScalar: function ( scalar ) {\r\n\t\r\n\t\t\tif ( isFinite( scalar ) ) {\r\n\t\t\t\tthis.x *= scalar;\r\n\t\t\t\tthis.y *= scalar;\r\n\t\t\t} else {\r\n\t\t\t\tthis.x = 0;\r\n\t\t\t\tthis.y = 0;\r\n\t\t\t}\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tdivide: function ( v ) {\r\n\t\r\n\t\t\tthis.x /= v.x;\r\n\t\t\tthis.y /= v.y;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tdivideScalar: function ( scalar ) {\r\n\t\r\n\t\t\treturn this.multiplyScalar( 1 / scalar );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tmin: function ( v ) {\r\n\t\r\n\t\t\tthis.x = Math.min( this.x, v.x );\r\n\t\t\tthis.y = Math.min( this.y, v.y );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tmax: function ( v ) {\r\n\t\r\n\t\t\tthis.x = Math.max( this.x, v.x );\r\n\t\t\tthis.y = Math.max( this.y, v.y );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tclamp: function ( min, max ) {\r\n\t\r\n\t\t\t// This function assumes min < max, if this assumption isn't true it will not operate correctly\r\n\t\r\n\t\t\tthis.x = Math.max( min.x, Math.min( max.x, this.x ) );\r\n\t\t\tthis.y = Math.max( min.y, Math.min( max.y, this.y ) );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tclampScalar: function () {\r\n\t\r\n\t\t\tvar min, max;\r\n\t\r\n\t\t\treturn function clampScalar( minVal, maxVal ) {\r\n\t\r\n\t\t\t\tif ( min === undefined ) {\r\n\t\r\n\t\t\t\t\tmin = new THREE.Vector2();\r\n\t\t\t\t\tmax = new THREE.Vector2();\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tmin.set( minVal, minVal );\r\n\t\t\t\tmax.set( maxVal, maxVal );\r\n\t\r\n\t\t\t\treturn this.clamp( min, max );\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tclampLength: function ( min, max ) {\r\n\t\r\n\t\t\tvar length = this.length();\r\n\t\r\n\t\t\tthis.multiplyScalar( Math.max( min, Math.min( max, length ) ) / length );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tfloor: function () {\r\n\t\r\n\t\t\tthis.x = Math.floor( this.x );\r\n\t\t\tthis.y = Math.floor( this.y );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tceil: function () {\r\n\t\r\n\t\t\tthis.x = Math.ceil( this.x );\r\n\t\t\tthis.y = Math.ceil( this.y );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tround: function () {\r\n\t\r\n\t\t\tthis.x = Math.round( this.x );\r\n\t\t\tthis.y = Math.round( this.y );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\troundToZero: function () {\r\n\t\r\n\t\t\tthis.x = ( this.x < 0 ) ? Math.ceil( this.x ) : Math.floor( this.x );\r\n\t\t\tthis.y = ( this.y < 0 ) ? Math.ceil( this.y ) : Math.floor( this.y );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tnegate: function () {\r\n\t\r\n\t\t\tthis.x = - this.x;\r\n\t\t\tthis.y = - this.y;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tdot: function ( v ) {\r\n\t\r\n\t\t\treturn this.x * v.x + this.y * v.y;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tlengthSq: function () {\r\n\t\r\n\t\t\treturn this.x * this.x + this.y * this.y;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tlength: function () {\r\n\t\r\n\t\t\treturn Math.sqrt( this.x * this.x + this.y * this.y );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tlengthManhattan: function() {\r\n\t\r\n\t\t\treturn Math.abs( this.x ) + Math.abs( this.y );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tnormalize: function () {\r\n\t\r\n\t\t\treturn this.divideScalar( this.length() );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tdistanceTo: function ( v ) {\r\n\t\r\n\t\t\treturn Math.sqrt( this.distanceToSquared( v ) );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tdistanceToSquared: function ( v ) {\r\n\t\r\n\t\t\tvar dx = this.x - v.x, dy = this.y - v.y;\r\n\t\t\treturn dx * dx + dy * dy;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetLength: function ( length ) {\r\n\t\r\n\t\t\treturn this.multiplyScalar( length / this.length() );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tlerp: function ( v, alpha ) {\r\n\t\r\n\t\t\tthis.x += ( v.x - this.x ) * alpha;\r\n\t\t\tthis.y += ( v.y - this.y ) * alpha;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tlerpVectors: function ( v1, v2, alpha ) {\r\n\t\r\n\t\t\tthis.subVectors( v2, v1 ).multiplyScalar( alpha ).add( v1 );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tequals: function ( v ) {\r\n\t\r\n\t\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tfromArray: function ( array, offset ) {\r\n\t\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\t\r\n\t\t\tthis.x = array[ offset ];\r\n\t\t\tthis.y = array[ offset + 1 ];\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\ttoArray: function ( array, offset ) {\r\n\t\r\n\t\t\tif ( array === undefined ) array = [];\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\t\r\n\t\t\tarray[ offset ] = this.x;\r\n\t\t\tarray[ offset + 1 ] = this.y;\r\n\t\r\n\t\t\treturn array;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tfromAttribute: function ( attribute, index, offset ) {\r\n\t\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\t\r\n\t\t\tindex = index * attribute.itemSize + offset;\r\n\t\r\n\t\t\tthis.x = attribute.array[ index ];\r\n\t\t\tthis.y = attribute.array[ index + 1 ];\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\trotateAround: function ( center, angle ) {\r\n\t\r\n\t\t\tvar c = Math.cos( angle ), s = Math.sin( angle );\r\n\t\r\n\t\t\tvar x = this.x - center.x;\r\n\t\t\tvar y = this.y - center.y;\r\n\t\r\n\t\t\tthis.x = x * c - y * s + center.x;\r\n\t\t\tthis.y = x * s + y * c + center.y;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/math/Vector3.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author *kile / http://kile.stravaganza.org/\r\n\t * @author philogb / http://blog.thejit.org/\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author egraether / http://egraether.com/\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t */\r\n\t\r\n\tTHREE.Vector3 = function ( x, y, z ) {\r\n\t\r\n\t\tthis.x = x || 0;\r\n\t\tthis.y = y || 0;\r\n\t\tthis.z = z || 0;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Vector3.prototype = {\r\n\t\r\n\t\tconstructor: THREE.Vector3,\r\n\t\r\n\t\tset: function ( x, y, z ) {\r\n\t\r\n\t\t\tthis.x = x;\r\n\t\t\tthis.y = y;\r\n\t\t\tthis.z = z;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetX: function ( x ) {\r\n\t\r\n\t\t\tthis.x = x;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetY: function ( y ) {\r\n\t\r\n\t\t\tthis.y = y;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetZ: function ( z ) {\r\n\t\r\n\t\t\tthis.z = z;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetComponent: function ( index, value ) {\r\n\t\r\n\t\t\tswitch ( index ) {\r\n\t\r\n\t\t\t\tcase 0: this.x = value; break;\r\n\t\t\t\tcase 1: this.y = value; break;\r\n\t\t\t\tcase 2: this.z = value; break;\r\n\t\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t},\r\n\t\r\n\t\tgetComponent: function ( index ) {\r\n\t\r\n\t\t\tswitch ( index ) {\r\n\t\r\n\t\t\t\tcase 0: return this.x;\r\n\t\t\t\tcase 1: return this.y;\r\n\t\t\t\tcase 2: return this.z;\r\n\t\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t},\r\n\t\r\n\t\tclone: function () {\r\n\t\r\n\t\t\treturn new this.constructor( this.x, this.y, this.z );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcopy: function ( v ) {\r\n\t\r\n\t\t\tthis.x = v.x;\r\n\t\t\tthis.y = v.y;\r\n\t\t\tthis.z = v.z;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tadd: function ( v, w ) {\r\n\t\r\n\t\t\tif ( w !== undefined ) {\r\n\t\r\n\t\t\t\tconsole.warn( 'THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead.' );\r\n\t\t\t\treturn this.addVectors( v, w );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tthis.x += v.x;\r\n\t\t\tthis.y += v.y;\r\n\t\t\tthis.z += v.z;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\taddScalar: function ( s ) {\r\n\t\r\n\t\t\tthis.x += s;\r\n\t\t\tthis.y += s;\r\n\t\t\tthis.z += s;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\taddVectors: function ( a, b ) {\r\n\t\r\n\t\t\tthis.x = a.x + b.x;\r\n\t\t\tthis.y = a.y + b.y;\r\n\t\t\tthis.z = a.z + b.z;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\taddScaledVector: function ( v, s ) {\r\n\t\r\n\t\t\tthis.x += v.x * s;\r\n\t\t\tthis.y += v.y * s;\r\n\t\t\tthis.z += v.z * s;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsub: function ( v, w ) {\r\n\t\r\n\t\t\tif ( w !== undefined ) {\r\n\t\r\n\t\t\t\tconsole.warn( 'THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.' );\r\n\t\t\t\treturn this.subVectors( v, w );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tthis.x -= v.x;\r\n\t\t\tthis.y -= v.y;\r\n\t\t\tthis.z -= v.z;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsubScalar: function ( s ) {\r\n\t\r\n\t\t\tthis.x -= s;\r\n\t\t\tthis.y -= s;\r\n\t\t\tthis.z -= s;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsubVectors: function ( a, b ) {\r\n\t\r\n\t\t\tthis.x = a.x - b.x;\r\n\t\t\tthis.y = a.y - b.y;\r\n\t\t\tthis.z = a.z - b.z;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tmultiply: function ( v, w ) {\r\n\t\r\n\t\t\tif ( w !== undefined ) {\r\n\t\r\n\t\t\t\tconsole.warn( 'THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead.' );\r\n\t\t\t\treturn this.multiplyVectors( v, w );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tthis.x *= v.x;\r\n\t\t\tthis.y *= v.y;\r\n\t\t\tthis.z *= v.z;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tmultiplyScalar: function ( scalar ) {\r\n\t\r\n\t\t\tif ( isFinite( scalar ) ) {\r\n\t\t\t\tthis.x *= scalar;\r\n\t\t\t\tthis.y *= scalar;\r\n\t\t\t\tthis.z *= scalar;\r\n\t\t\t} else {\r\n\t\t\t\tthis.x = 0;\r\n\t\t\t\tthis.y = 0;\r\n\t\t\t\tthis.z = 0;\r\n\t\t\t}\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tmultiplyVectors: function ( a, b ) {\r\n\t\r\n\t\t\tthis.x = a.x * b.x;\r\n\t\t\tthis.y = a.y * b.y;\r\n\t\t\tthis.z = a.z * b.z;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tapplyEuler: function () {\r\n\t\r\n\t\t\tvar quaternion;\r\n\t\r\n\t\t\treturn function applyEuler( euler ) {\r\n\t\r\n\t\t\t\tif ( euler instanceof THREE.Euler === false ) {\r\n\t\r\n\t\t\t\t\tconsole.error( 'THREE.Vector3: .applyEuler() now expects a Euler rotation rather than a Vector3 and order.' );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( quaternion === undefined ) quaternion = new THREE.Quaternion();\r\n\t\r\n\t\t\t\tthis.applyQuaternion( quaternion.setFromEuler( euler ) );\r\n\t\r\n\t\t\t\treturn this;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tapplyAxisAngle: function () {\r\n\t\r\n\t\t\tvar quaternion;\r\n\t\r\n\t\t\treturn function applyAxisAngle( axis, angle ) {\r\n\t\r\n\t\t\t\tif ( quaternion === undefined ) quaternion = new THREE.Quaternion();\r\n\t\r\n\t\t\t\tthis.applyQuaternion( quaternion.setFromAxisAngle( axis, angle ) );\r\n\t\r\n\t\t\t\treturn this;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tapplyMatrix3: function ( m ) {\r\n\t\r\n\t\t\tvar x = this.x;\r\n\t\t\tvar y = this.y;\r\n\t\t\tvar z = this.z;\r\n\t\r\n\t\t\tvar e = m.elements;\r\n\t\r\n\t\t\tthis.x = e[ 0 ] * x + e[ 3 ] * y + e[ 6 ] * z;\r\n\t\t\tthis.y = e[ 1 ] * x + e[ 4 ] * y + e[ 7 ] * z;\r\n\t\t\tthis.z = e[ 2 ] * x + e[ 5 ] * y + e[ 8 ] * z;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tapplyMatrix4: function ( m ) {\r\n\t\r\n\t\t\t// input: THREE.Matrix4 affine matrix\r\n\t\r\n\t\t\tvar x = this.x, y = this.y, z = this.z;\r\n\t\r\n\t\t\tvar e = m.elements;\r\n\t\r\n\t\t\tthis.x = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ]  * z + e[ 12 ];\r\n\t\t\tthis.y = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ]  * z + e[ 13 ];\r\n\t\t\tthis.z = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z + e[ 14 ];\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tapplyProjection: function ( m ) {\r\n\t\r\n\t\t\t// input: THREE.Matrix4 projection matrix\r\n\t\r\n\t\t\tvar x = this.x, y = this.y, z = this.z;\r\n\t\r\n\t\t\tvar e = m.elements;\r\n\t\t\tvar d = 1 / ( e[ 3 ] * x + e[ 7 ] * y + e[ 11 ] * z + e[ 15 ] ); // perspective divide\r\n\t\r\n\t\t\tthis.x = ( e[ 0 ] * x + e[ 4 ] * y + e[ 8 ]  * z + e[ 12 ] ) * d;\r\n\t\t\tthis.y = ( e[ 1 ] * x + e[ 5 ] * y + e[ 9 ]  * z + e[ 13 ] ) * d;\r\n\t\t\tthis.z = ( e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z + e[ 14 ] ) * d;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tapplyQuaternion: function ( q ) {\r\n\t\r\n\t\t\tvar x = this.x;\r\n\t\t\tvar y = this.y;\r\n\t\t\tvar z = this.z;\r\n\t\r\n\t\t\tvar qx = q.x;\r\n\t\t\tvar qy = q.y;\r\n\t\t\tvar qz = q.z;\r\n\t\t\tvar qw = q.w;\r\n\t\r\n\t\t\t// calculate quat * vector\r\n\t\r\n\t\t\tvar ix =  qw * x + qy * z - qz * y;\r\n\t\t\tvar iy =  qw * y + qz * x - qx * z;\r\n\t\t\tvar iz =  qw * z + qx * y - qy * x;\r\n\t\t\tvar iw = - qx * x - qy * y - qz * z;\r\n\t\r\n\t\t\t// calculate result * inverse quat\r\n\t\r\n\t\t\tthis.x = ix * qw + iw * - qx + iy * - qz - iz * - qy;\r\n\t\t\tthis.y = iy * qw + iw * - qy + iz * - qx - ix * - qz;\r\n\t\t\tthis.z = iz * qw + iw * - qz + ix * - qy - iy * - qx;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tproject: function () {\r\n\t\r\n\t\t\tvar matrix;\r\n\t\r\n\t\t\treturn function project( camera ) {\r\n\t\r\n\t\t\t\tif ( matrix === undefined ) matrix = new THREE.Matrix4();\r\n\t\r\n\t\t\t\tmatrix.multiplyMatrices( camera.projectionMatrix, matrix.getInverse( camera.matrixWorld ) );\r\n\t\t\t\treturn this.applyProjection( matrix );\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tunproject: function () {\r\n\t\r\n\t\t\tvar matrix;\r\n\t\r\n\t\t\treturn function unproject( camera ) {\r\n\t\r\n\t\t\t\tif ( matrix === undefined ) matrix = new THREE.Matrix4();\r\n\t\r\n\t\t\t\tmatrix.multiplyMatrices( camera.matrixWorld, matrix.getInverse( camera.projectionMatrix ) );\r\n\t\t\t\treturn this.applyProjection( matrix );\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\ttransformDirection: function ( m ) {\r\n\t\r\n\t\t\t// input: THREE.Matrix4 affine matrix\r\n\t\t\t// vector interpreted as a direction\r\n\t\r\n\t\t\tvar x = this.x, y = this.y, z = this.z;\r\n\t\r\n\t\t\tvar e = m.elements;\r\n\t\r\n\t\t\tthis.x = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ]  * z;\r\n\t\t\tthis.y = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ]  * z;\r\n\t\t\tthis.z = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z;\r\n\t\r\n\t\t\tthis.normalize();\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tdivide: function ( v ) {\r\n\t\r\n\t\t\tthis.x /= v.x;\r\n\t\t\tthis.y /= v.y;\r\n\t\t\tthis.z /= v.z;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tdivideScalar: function ( scalar ) {\r\n\t\r\n\t\t\treturn this.multiplyScalar( 1 / scalar );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tmin: function ( v ) {\r\n\t\r\n\t\t\tthis.x = Math.min( this.x, v.x );\r\n\t\t\tthis.y = Math.min( this.y, v.y );\r\n\t\t\tthis.z = Math.min( this.z, v.z );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tmax: function ( v ) {\r\n\t\r\n\t\t\tthis.x = Math.max( this.x, v.x );\r\n\t\t\tthis.y = Math.max( this.y, v.y );\r\n\t\t\tthis.z = Math.max( this.z, v.z );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tclamp: function ( min, max ) {\r\n\t\r\n\t\t\t// This function assumes min < max, if this assumption isn't true it will not operate correctly\r\n\t\r\n\t\t\tthis.x = Math.max( min.x, Math.min( max.x, this.x ) );\r\n\t\t\tthis.y = Math.max( min.y, Math.min( max.y, this.y ) );\r\n\t\t\tthis.z = Math.max( min.z, Math.min( max.z, this.z ) );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tclampScalar: function () {\r\n\t\r\n\t\t\tvar min, max;\r\n\t\r\n\t\t\treturn function clampScalar( minVal, maxVal ) {\r\n\t\r\n\t\t\t\tif ( min === undefined ) {\r\n\t\r\n\t\t\t\t\tmin = new THREE.Vector3();\r\n\t\t\t\t\tmax = new THREE.Vector3();\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tmin.set( minVal, minVal, minVal );\r\n\t\t\t\tmax.set( maxVal, maxVal, maxVal );\r\n\t\r\n\t\t\t\treturn this.clamp( min, max );\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tclampLength: function ( min, max ) {\r\n\t\r\n\t\t\tvar length = this.length();\r\n\t\r\n\t\t\tthis.multiplyScalar( Math.max( min, Math.min( max, length ) ) / length );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tfloor: function () {\r\n\t\r\n\t\t\tthis.x = Math.floor( this.x );\r\n\t\t\tthis.y = Math.floor( this.y );\r\n\t\t\tthis.z = Math.floor( this.z );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tceil: function () {\r\n\t\r\n\t\t\tthis.x = Math.ceil( this.x );\r\n\t\t\tthis.y = Math.ceil( this.y );\r\n\t\t\tthis.z = Math.ceil( this.z );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tround: function () {\r\n\t\r\n\t\t\tthis.x = Math.round( this.x );\r\n\t\t\tthis.y = Math.round( this.y );\r\n\t\t\tthis.z = Math.round( this.z );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\troundToZero: function () {\r\n\t\r\n\t\t\tthis.x = ( this.x < 0 ) ? Math.ceil( this.x ) : Math.floor( this.x );\r\n\t\t\tthis.y = ( this.y < 0 ) ? Math.ceil( this.y ) : Math.floor( this.y );\r\n\t\t\tthis.z = ( this.z < 0 ) ? Math.ceil( this.z ) : Math.floor( this.z );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tnegate: function () {\r\n\t\r\n\t\t\tthis.x = - this.x;\r\n\t\t\tthis.y = - this.y;\r\n\t\t\tthis.z = - this.z;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tdot: function ( v ) {\r\n\t\r\n\t\t\treturn this.x * v.x + this.y * v.y + this.z * v.z;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tlengthSq: function () {\r\n\t\r\n\t\t\treturn this.x * this.x + this.y * this.y + this.z * this.z;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tlength: function () {\r\n\t\r\n\t\t\treturn Math.sqrt( this.x * this.x + this.y * this.y + this.z * this.z );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tlengthManhattan: function () {\r\n\t\r\n\t\t\treturn Math.abs( this.x ) + Math.abs( this.y ) + Math.abs( this.z );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tnormalize: function () {\r\n\t\r\n\t\t\treturn this.divideScalar( this.length() );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetLength: function ( length ) {\r\n\t\r\n\t\t\treturn this.multiplyScalar( length / this.length() );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tlerp: function ( v, alpha ) {\r\n\t\r\n\t\t\tthis.x += ( v.x - this.x ) * alpha;\r\n\t\t\tthis.y += ( v.y - this.y ) * alpha;\r\n\t\t\tthis.z += ( v.z - this.z ) * alpha;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tlerpVectors: function ( v1, v2, alpha ) {\r\n\t\r\n\t\t\tthis.subVectors( v2, v1 ).multiplyScalar( alpha ).add( v1 );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcross: function ( v, w ) {\r\n\t\r\n\t\t\tif ( w !== undefined ) {\r\n\t\r\n\t\t\t\tconsole.warn( 'THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead.' );\r\n\t\t\t\treturn this.crossVectors( v, w );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar x = this.x, y = this.y, z = this.z;\r\n\t\r\n\t\t\tthis.x = y * v.z - z * v.y;\r\n\t\t\tthis.y = z * v.x - x * v.z;\r\n\t\t\tthis.z = x * v.y - y * v.x;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcrossVectors: function ( a, b ) {\r\n\t\r\n\t\t\tvar ax = a.x, ay = a.y, az = a.z;\r\n\t\t\tvar bx = b.x, by = b.y, bz = b.z;\r\n\t\r\n\t\t\tthis.x = ay * bz - az * by;\r\n\t\t\tthis.y = az * bx - ax * bz;\r\n\t\t\tthis.z = ax * by - ay * bx;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tprojectOnVector: function () {\r\n\t\r\n\t\t\tvar v1, dot;\r\n\t\r\n\t\t\treturn function projectOnVector( vector ) {\r\n\t\r\n\t\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\t\r\n\t\t\t\tv1.copy( vector ).normalize();\r\n\t\r\n\t\t\t\tdot = this.dot( v1 );\r\n\t\r\n\t\t\t\treturn this.copy( v1 ).multiplyScalar( dot );\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tprojectOnPlane: function () {\r\n\t\r\n\t\t\tvar v1;\r\n\t\r\n\t\t\treturn function projectOnPlane( planeNormal ) {\r\n\t\r\n\t\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\t\r\n\t\t\t\tv1.copy( this ).projectOnVector( planeNormal );\r\n\t\r\n\t\t\t\treturn this.sub( v1 );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\treflect: function () {\r\n\t\r\n\t\t\t// reflect incident vector off plane orthogonal to normal\r\n\t\t\t// normal is assumed to have unit length\r\n\t\r\n\t\t\tvar v1;\r\n\t\r\n\t\t\treturn function reflect( normal ) {\r\n\t\r\n\t\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\t\r\n\t\t\t\treturn this.sub( v1.copy( normal ).multiplyScalar( 2 * this.dot( normal ) ) );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tangleTo: function ( v ) {\r\n\t\r\n\t\t\tvar theta = this.dot( v ) / ( this.length() * v.length() );\r\n\t\r\n\t\t\t// clamp, to handle numerical problems\r\n\t\r\n\t\t\treturn Math.acos( THREE.Math.clamp( theta, - 1, 1 ) );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tdistanceTo: function ( v ) {\r\n\t\r\n\t\t\treturn Math.sqrt( this.distanceToSquared( v ) );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tdistanceToSquared: function ( v ) {\r\n\t\r\n\t\t\tvar dx = this.x - v.x;\r\n\t\t\tvar dy = this.y - v.y;\r\n\t\t\tvar dz = this.z - v.z;\r\n\t\r\n\t\t\treturn dx * dx + dy * dy + dz * dz;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetEulerFromRotationMatrix: function ( m, order ) {\r\n\t\r\n\t\t\tconsole.error( 'THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.' );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetEulerFromQuaternion: function ( q, order ) {\r\n\t\r\n\t\t\tconsole.error( 'THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.' );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tgetPositionFromMatrix: function ( m ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition().' );\r\n\t\r\n\t\t\treturn this.setFromMatrixPosition( m );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tgetScaleFromMatrix: function ( m ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale().' );\r\n\t\r\n\t\t\treturn this.setFromMatrixScale( m );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tgetColumnFromMatrix: function ( index, matrix ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn().' );\r\n\t\r\n\t\t\treturn this.setFromMatrixColumn( index, matrix );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetFromMatrixPosition: function ( m ) {\r\n\t\r\n\t\t\tthis.x = m.elements[ 12 ];\r\n\t\t\tthis.y = m.elements[ 13 ];\r\n\t\t\tthis.z = m.elements[ 14 ];\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetFromMatrixScale: function ( m ) {\r\n\t\r\n\t\t\tvar sx = this.set( m.elements[ 0 ], m.elements[ 1 ], m.elements[ 2 ] ).length();\r\n\t\t\tvar sy = this.set( m.elements[ 4 ], m.elements[ 5 ], m.elements[ 6 ] ).length();\r\n\t\t\tvar sz = this.set( m.elements[ 8 ], m.elements[ 9 ], m.elements[ 10 ] ).length();\r\n\t\r\n\t\t\tthis.x = sx;\r\n\t\t\tthis.y = sy;\r\n\t\t\tthis.z = sz;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetFromMatrixColumn: function ( index, matrix ) {\r\n\t\r\n\t\t\tvar offset = index * 4;\r\n\t\r\n\t\t\tvar me = matrix.elements;\r\n\t\r\n\t\t\tthis.x = me[ offset ];\r\n\t\t\tthis.y = me[ offset + 1 ];\r\n\t\t\tthis.z = me[ offset + 2 ];\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tequals: function ( v ) {\r\n\t\r\n\t\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) && ( v.z === this.z ) );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tfromArray: function ( array, offset ) {\r\n\t\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\t\r\n\t\t\tthis.x = array[ offset ];\r\n\t\t\tthis.y = array[ offset + 1 ];\r\n\t\t\tthis.z = array[ offset + 2 ];\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\ttoArray: function ( array, offset ) {\r\n\t\r\n\t\t\tif ( array === undefined ) array = [];\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\t\r\n\t\t\tarray[ offset ] = this.x;\r\n\t\t\tarray[ offset + 1 ] = this.y;\r\n\t\t\tarray[ offset + 2 ] = this.z;\r\n\t\r\n\t\t\treturn array;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tfromAttribute: function ( attribute, index, offset ) {\r\n\t\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\t\r\n\t\t\tindex = index * attribute.itemSize + offset;\r\n\t\r\n\t\t\tthis.x = attribute.array[ index ];\r\n\t\t\tthis.y = attribute.array[ index + 1 ];\r\n\t\t\tthis.z = attribute.array[ index + 2 ];\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/math/Vector4.js\r\n\t\r\n\t/**\r\n\t * @author supereggbert / http://www.paulbrunt.co.uk/\r\n\t * @author philogb / http://blog.thejit.org/\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author egraether / http://egraether.com/\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t */\r\n\t\r\n\tTHREE.Vector4 = function ( x, y, z, w ) {\r\n\t\r\n\t\tthis.x = x || 0;\r\n\t\tthis.y = y || 0;\r\n\t\tthis.z = z || 0;\r\n\t\tthis.w = ( w !== undefined ) ? w : 1;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Vector4.prototype = {\r\n\t\r\n\t\tconstructor: THREE.Vector4,\r\n\t\r\n\t\tset: function ( x, y, z, w ) {\r\n\t\r\n\t\t\tthis.x = x;\r\n\t\t\tthis.y = y;\r\n\t\t\tthis.z = z;\r\n\t\t\tthis.w = w;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetX: function ( x ) {\r\n\t\r\n\t\t\tthis.x = x;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetY: function ( y ) {\r\n\t\r\n\t\t\tthis.y = y;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetZ: function ( z ) {\r\n\t\r\n\t\t\tthis.z = z;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetW: function ( w ) {\r\n\t\r\n\t\t\tthis.w = w;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetComponent: function ( index, value ) {\r\n\t\r\n\t\t\tswitch ( index ) {\r\n\t\r\n\t\t\t\tcase 0: this.x = value; break;\r\n\t\t\t\tcase 1: this.y = value; break;\r\n\t\t\t\tcase 2: this.z = value; break;\r\n\t\t\t\tcase 3: this.w = value; break;\r\n\t\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t},\r\n\t\r\n\t\tgetComponent: function ( index ) {\r\n\t\r\n\t\t\tswitch ( index ) {\r\n\t\r\n\t\t\t\tcase 0: return this.x;\r\n\t\t\t\tcase 1: return this.y;\r\n\t\t\t\tcase 2: return this.z;\r\n\t\t\t\tcase 3: return this.w;\r\n\t\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t},\r\n\t\r\n\t\tclone: function () {\r\n\t\r\n\t\t\treturn new this.constructor( this.x, this.y, this.z, this.w );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcopy: function ( v ) {\r\n\t\r\n\t\t\tthis.x = v.x;\r\n\t\t\tthis.y = v.y;\r\n\t\t\tthis.z = v.z;\r\n\t\t\tthis.w = ( v.w !== undefined ) ? v.w : 1;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tadd: function ( v, w ) {\r\n\t\r\n\t\t\tif ( w !== undefined ) {\r\n\t\r\n\t\t\t\tconsole.warn( 'THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead.' );\r\n\t\t\t\treturn this.addVectors( v, w );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tthis.x += v.x;\r\n\t\t\tthis.y += v.y;\r\n\t\t\tthis.z += v.z;\r\n\t\t\tthis.w += v.w;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\taddScalar: function ( s ) {\r\n\t\r\n\t\t\tthis.x += s;\r\n\t\t\tthis.y += s;\r\n\t\t\tthis.z += s;\r\n\t\t\tthis.w += s;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\taddVectors: function ( a, b ) {\r\n\t\r\n\t\t\tthis.x = a.x + b.x;\r\n\t\t\tthis.y = a.y + b.y;\r\n\t\t\tthis.z = a.z + b.z;\r\n\t\t\tthis.w = a.w + b.w;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\taddScaledVector: function ( v, s ) {\r\n\t\r\n\t\t\tthis.x += v.x * s;\r\n\t\t\tthis.y += v.y * s;\r\n\t\t\tthis.z += v.z * s;\r\n\t\t\tthis.w += v.w * s;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsub: function ( v, w ) {\r\n\t\r\n\t\t\tif ( w !== undefined ) {\r\n\t\r\n\t\t\t\tconsole.warn( 'THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.' );\r\n\t\t\t\treturn this.subVectors( v, w );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tthis.x -= v.x;\r\n\t\t\tthis.y -= v.y;\r\n\t\t\tthis.z -= v.z;\r\n\t\t\tthis.w -= v.w;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsubScalar: function ( s ) {\r\n\t\r\n\t\t\tthis.x -= s;\r\n\t\t\tthis.y -= s;\r\n\t\t\tthis.z -= s;\r\n\t\t\tthis.w -= s;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsubVectors: function ( a, b ) {\r\n\t\r\n\t\t\tthis.x = a.x - b.x;\r\n\t\t\tthis.y = a.y - b.y;\r\n\t\t\tthis.z = a.z - b.z;\r\n\t\t\tthis.w = a.w - b.w;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tmultiplyScalar: function ( scalar ) {\r\n\t\r\n\t\t\tif ( isFinite( scalar ) ) {\r\n\t\t\t\tthis.x *= scalar;\r\n\t\t\t\tthis.y *= scalar;\r\n\t\t\t\tthis.z *= scalar;\r\n\t\t\t\tthis.w *= scalar;\r\n\t\t\t} else {\r\n\t\t\t\tthis.x = 0;\r\n\t\t\t\tthis.y = 0;\r\n\t\t\t\tthis.z = 0;\r\n\t\t\t\tthis.w = 0;\r\n\t\t\t}\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tapplyMatrix4: function ( m ) {\r\n\t\r\n\t\t\tvar x = this.x;\r\n\t\t\tvar y = this.y;\r\n\t\t\tvar z = this.z;\r\n\t\t\tvar w = this.w;\r\n\t\r\n\t\t\tvar e = m.elements;\r\n\t\r\n\t\t\tthis.x = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ] * z + e[ 12 ] * w;\r\n\t\t\tthis.y = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ] * z + e[ 13 ] * w;\r\n\t\t\tthis.z = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z + e[ 14 ] * w;\r\n\t\t\tthis.w = e[ 3 ] * x + e[ 7 ] * y + e[ 11 ] * z + e[ 15 ] * w;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tdivideScalar: function ( scalar ) {\r\n\t\r\n\t\t\treturn this.multiplyScalar( 1 / scalar );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetAxisAngleFromQuaternion: function ( q ) {\r\n\t\r\n\t\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/quaternionToAngle/index.htm\r\n\t\r\n\t\t\t// q is assumed to be normalized\r\n\t\r\n\t\t\tthis.w = 2 * Math.acos( q.w );\r\n\t\r\n\t\t\tvar s = Math.sqrt( 1 - q.w * q.w );\r\n\t\r\n\t\t\tif ( s < 0.0001 ) {\r\n\t\r\n\t\t\t\t this.x = 1;\r\n\t\t\t\t this.y = 0;\r\n\t\t\t\t this.z = 0;\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\t this.x = q.x / s;\r\n\t\t\t\t this.y = q.y / s;\r\n\t\t\t\t this.z = q.z / s;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetAxisAngleFromRotationMatrix: function ( m ) {\r\n\t\r\n\t\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToAngle/index.htm\r\n\t\r\n\t\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\t\r\n\t\t\tvar angle, x, y, z,\t\t// variables for result\r\n\t\t\t\tepsilon = 0.01,\t\t// margin to allow for rounding errors\r\n\t\t\t\tepsilon2 = 0.1,\t\t// margin to distinguish between 0 and 180 degrees\r\n\t\r\n\t\t\t\tte = m.elements,\r\n\t\r\n\t\t\t\tm11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ],\r\n\t\t\t\tm21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ],\r\n\t\t\t\tm31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ];\r\n\t\r\n\t\t\tif ( ( Math.abs( m12 - m21 ) < epsilon )\r\n\t\t\t   && ( Math.abs( m13 - m31 ) < epsilon )\r\n\t\t\t   && ( Math.abs( m23 - m32 ) < epsilon ) ) {\r\n\t\r\n\t\t\t\t// singularity found\r\n\t\t\t\t// first check for identity matrix which must have +1 for all terms\r\n\t\t\t\t// in leading diagonal and zero in other terms\r\n\t\r\n\t\t\t\tif ( ( Math.abs( m12 + m21 ) < epsilon2 )\r\n\t\t\t\t   && ( Math.abs( m13 + m31 ) < epsilon2 )\r\n\t\t\t\t   && ( Math.abs( m23 + m32 ) < epsilon2 )\r\n\t\t\t\t   && ( Math.abs( m11 + m22 + m33 - 3 ) < epsilon2 ) ) {\r\n\t\r\n\t\t\t\t\t// this singularity is identity matrix so angle = 0\r\n\t\r\n\t\t\t\t\tthis.set( 1, 0, 0, 0 );\r\n\t\r\n\t\t\t\t\treturn this; // zero angle, arbitrary axis\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\t// otherwise this singularity is angle = 180\r\n\t\r\n\t\t\t\tangle = Math.PI;\r\n\t\r\n\t\t\t\tvar xx = ( m11 + 1 ) / 2;\r\n\t\t\t\tvar yy = ( m22 + 1 ) / 2;\r\n\t\t\t\tvar zz = ( m33 + 1 ) / 2;\r\n\t\t\t\tvar xy = ( m12 + m21 ) / 4;\r\n\t\t\t\tvar xz = ( m13 + m31 ) / 4;\r\n\t\t\t\tvar yz = ( m23 + m32 ) / 4;\r\n\t\r\n\t\t\t\tif ( ( xx > yy ) && ( xx > zz ) ) {\r\n\t\r\n\t\t\t\t\t// m11 is the largest diagonal term\r\n\t\r\n\t\t\t\t\tif ( xx < epsilon ) {\r\n\t\r\n\t\t\t\t\t\tx = 0;\r\n\t\t\t\t\t\ty = 0.707106781;\r\n\t\t\t\t\t\tz = 0.707106781;\r\n\t\r\n\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\tx = Math.sqrt( xx );\r\n\t\t\t\t\t\ty = xy / x;\r\n\t\t\t\t\t\tz = xz / x;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t} else if ( yy > zz ) {\r\n\t\r\n\t\t\t\t\t// m22 is the largest diagonal term\r\n\t\r\n\t\t\t\t\tif ( yy < epsilon ) {\r\n\t\r\n\t\t\t\t\t\tx = 0.707106781;\r\n\t\t\t\t\t\ty = 0;\r\n\t\t\t\t\t\tz = 0.707106781;\r\n\t\r\n\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\ty = Math.sqrt( yy );\r\n\t\t\t\t\t\tx = xy / y;\r\n\t\t\t\t\t\tz = yz / y;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t// m33 is the largest diagonal term so base result on this\r\n\t\r\n\t\t\t\t\tif ( zz < epsilon ) {\r\n\t\r\n\t\t\t\t\t\tx = 0.707106781;\r\n\t\t\t\t\t\ty = 0.707106781;\r\n\t\t\t\t\t\tz = 0;\r\n\t\r\n\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\tz = Math.sqrt( zz );\r\n\t\t\t\t\t\tx = xz / z;\r\n\t\t\t\t\t\ty = yz / z;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tthis.set( x, y, z, angle );\r\n\t\r\n\t\t\t\treturn this; // return 180 deg rotation\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// as we have reached here there are no singularities so we can handle normally\r\n\t\r\n\t\t\tvar s = Math.sqrt( ( m32 - m23 ) * ( m32 - m23 )\r\n\t\t\t\t\t\t\t  + ( m13 - m31 ) * ( m13 - m31 )\r\n\t\t\t\t\t\t\t  + ( m21 - m12 ) * ( m21 - m12 ) ); // used to normalize\r\n\t\r\n\t\t\tif ( Math.abs( s ) < 0.001 ) s = 1;\r\n\t\r\n\t\t\t// prevent divide by zero, should not happen if matrix is orthogonal and should be\r\n\t\t\t// caught by singularity test above, but I've left it in just in case\r\n\t\r\n\t\t\tthis.x = ( m32 - m23 ) / s;\r\n\t\t\tthis.y = ( m13 - m31 ) / s;\r\n\t\t\tthis.z = ( m21 - m12 ) / s;\r\n\t\t\tthis.w = Math.acos( ( m11 + m22 + m33 - 1 ) / 2 );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tmin: function ( v ) {\r\n\t\r\n\t\t\tthis.x = Math.min( this.x, v.x );\r\n\t\t\tthis.y = Math.min( this.y, v.y );\r\n\t\t\tthis.z = Math.min( this.z, v.z );\r\n\t\t\tthis.w = Math.min( this.w, v.w );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tmax: function ( v ) {\r\n\t\r\n\t\t\tthis.x = Math.max( this.x, v.x );\r\n\t\t\tthis.y = Math.max( this.y, v.y );\r\n\t\t\tthis.z = Math.max( this.z, v.z );\r\n\t\t\tthis.w = Math.max( this.w, v.w );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tclamp: function ( min, max ) {\r\n\t\r\n\t\t\t// This function assumes min < max, if this assumption isn't true it will not operate correctly\r\n\t\r\n\t\t\tthis.x = Math.max( min.x, Math.min( max.x, this.x ) );\r\n\t\t\tthis.y = Math.max( min.y, Math.min( max.y, this.y ) );\r\n\t\t\tthis.z = Math.max( min.z, Math.min( max.z, this.z ) );\r\n\t\t\tthis.w = Math.max( min.w, Math.min( max.w, this.w ) );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tclampScalar: function () {\r\n\t\r\n\t\t\tvar min, max;\r\n\t\r\n\t\t\treturn function clampScalar( minVal, maxVal ) {\r\n\t\r\n\t\t\t\tif ( min === undefined ) {\r\n\t\r\n\t\t\t\t\tmin = new THREE.Vector4();\r\n\t\t\t\t\tmax = new THREE.Vector4();\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tmin.set( minVal, minVal, minVal, minVal );\r\n\t\t\t\tmax.set( maxVal, maxVal, maxVal, maxVal );\r\n\t\r\n\t\t\t\treturn this.clamp( min, max );\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tfloor: function () {\r\n\t\r\n\t\t\tthis.x = Math.floor( this.x );\r\n\t\t\tthis.y = Math.floor( this.y );\r\n\t\t\tthis.z = Math.floor( this.z );\r\n\t\t\tthis.w = Math.floor( this.w );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tceil: function () {\r\n\t\r\n\t\t\tthis.x = Math.ceil( this.x );\r\n\t\t\tthis.y = Math.ceil( this.y );\r\n\t\t\tthis.z = Math.ceil( this.z );\r\n\t\t\tthis.w = Math.ceil( this.w );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tround: function () {\r\n\t\r\n\t\t\tthis.x = Math.round( this.x );\r\n\t\t\tthis.y = Math.round( this.y );\r\n\t\t\tthis.z = Math.round( this.z );\r\n\t\t\tthis.w = Math.round( this.w );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\troundToZero: function () {\r\n\t\r\n\t\t\tthis.x = ( this.x < 0 ) ? Math.ceil( this.x ) : Math.floor( this.x );\r\n\t\t\tthis.y = ( this.y < 0 ) ? Math.ceil( this.y ) : Math.floor( this.y );\r\n\t\t\tthis.z = ( this.z < 0 ) ? Math.ceil( this.z ) : Math.floor( this.z );\r\n\t\t\tthis.w = ( this.w < 0 ) ? Math.ceil( this.w ) : Math.floor( this.w );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tnegate: function () {\r\n\t\r\n\t\t\tthis.x = - this.x;\r\n\t\t\tthis.y = - this.y;\r\n\t\t\tthis.z = - this.z;\r\n\t\t\tthis.w = - this.w;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tdot: function ( v ) {\r\n\t\r\n\t\t\treturn this.x * v.x + this.y * v.y + this.z * v.z + this.w * v.w;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tlengthSq: function () {\r\n\t\r\n\t\t\treturn this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tlength: function () {\r\n\t\r\n\t\t\treturn Math.sqrt( this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tlengthManhattan: function () {\r\n\t\r\n\t\t\treturn Math.abs( this.x ) + Math.abs( this.y ) + Math.abs( this.z ) + Math.abs( this.w );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tnormalize: function () {\r\n\t\r\n\t\t\treturn this.divideScalar( this.length() );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetLength: function ( length ) {\r\n\t\r\n\t\t\treturn this.multiplyScalar( length / this.length() );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tlerp: function ( v, alpha ) {\r\n\t\r\n\t\t\tthis.x += ( v.x - this.x ) * alpha;\r\n\t\t\tthis.y += ( v.y - this.y ) * alpha;\r\n\t\t\tthis.z += ( v.z - this.z ) * alpha;\r\n\t\t\tthis.w += ( v.w - this.w ) * alpha;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tlerpVectors: function ( v1, v2, alpha ) {\r\n\t\r\n\t\t\tthis.subVectors( v2, v1 ).multiplyScalar( alpha ).add( v1 );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tequals: function ( v ) {\r\n\t\r\n\t\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) && ( v.z === this.z ) && ( v.w === this.w ) );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tfromArray: function ( array, offset ) {\r\n\t\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\t\r\n\t\t\tthis.x = array[ offset ];\r\n\t\t\tthis.y = array[ offset + 1 ];\r\n\t\t\tthis.z = array[ offset + 2 ];\r\n\t\t\tthis.w = array[ offset + 3 ];\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\ttoArray: function ( array, offset ) {\r\n\t\r\n\t\t\tif ( array === undefined ) array = [];\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\t\r\n\t\t\tarray[ offset ] = this.x;\r\n\t\t\tarray[ offset + 1 ] = this.y;\r\n\t\t\tarray[ offset + 2 ] = this.z;\r\n\t\t\tarray[ offset + 3 ] = this.w;\r\n\t\r\n\t\t\treturn array;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tfromAttribute: function ( attribute, index, offset ) {\r\n\t\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\t\r\n\t\t\tindex = index * attribute.itemSize + offset;\r\n\t\r\n\t\t\tthis.x = attribute.array[ index ];\r\n\t\t\tthis.y = attribute.array[ index + 1 ];\r\n\t\t\tthis.z = attribute.array[ index + 2 ];\r\n\t\t\tthis.w = attribute.array[ index + 3 ];\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/math/Euler.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t * @author bhouston / http://clara.io\r\n\t */\r\n\t\r\n\tTHREE.Euler = function ( x, y, z, order ) {\r\n\t\r\n\t\tthis._x = x || 0;\r\n\t\tthis._y = y || 0;\r\n\t\tthis._z = z || 0;\r\n\t\tthis._order = order || THREE.Euler.DefaultOrder;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Euler.RotationOrders = [ 'XYZ', 'YZX', 'ZXY', 'XZY', 'YXZ', 'ZYX' ];\r\n\t\r\n\tTHREE.Euler.DefaultOrder = 'XYZ';\r\n\t\r\n\tTHREE.Euler.prototype = {\r\n\t\r\n\t\tconstructor: THREE.Euler,\r\n\t\r\n\t\tget x () {\r\n\t\r\n\t\t\treturn this._x;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tset x ( value ) {\r\n\t\r\n\t\t\tthis._x = value;\r\n\t\t\tthis.onChangeCallback();\r\n\t\r\n\t\t},\r\n\t\r\n\t\tget y () {\r\n\t\r\n\t\t\treturn this._y;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tset y ( value ) {\r\n\t\r\n\t\t\tthis._y = value;\r\n\t\t\tthis.onChangeCallback();\r\n\t\r\n\t\t},\r\n\t\r\n\t\tget z () {\r\n\t\r\n\t\t\treturn this._z;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tset z ( value ) {\r\n\t\r\n\t\t\tthis._z = value;\r\n\t\t\tthis.onChangeCallback();\r\n\t\r\n\t\t},\r\n\t\r\n\t\tget order () {\r\n\t\r\n\t\t\treturn this._order;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tset order ( value ) {\r\n\t\r\n\t\t\tthis._order = value;\r\n\t\t\tthis.onChangeCallback();\r\n\t\r\n\t\t},\r\n\t\r\n\t\tset: function ( x, y, z, order ) {\r\n\t\r\n\t\t\tthis._x = x;\r\n\t\t\tthis._y = y;\r\n\t\t\tthis._z = z;\r\n\t\t\tthis._order = order || this._order;\r\n\t\r\n\t\t\tthis.onChangeCallback();\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tclone: function () {\r\n\t\r\n\t\t\treturn new this.constructor( this._x, this._y, this._z, this._order);\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcopy: function ( euler ) {\r\n\t\r\n\t\t\tthis._x = euler._x;\r\n\t\t\tthis._y = euler._y;\r\n\t\t\tthis._z = euler._z;\r\n\t\t\tthis._order = euler._order;\r\n\t\r\n\t\t\tthis.onChangeCallback();\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetFromRotationMatrix: function ( m, order, update ) {\r\n\t\r\n\t\t\tvar clamp = THREE.Math.clamp;\r\n\t\r\n\t\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\t\r\n\t\t\tvar te = m.elements;\r\n\t\t\tvar m11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ];\r\n\t\t\tvar m21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ];\r\n\t\t\tvar m31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ];\r\n\t\r\n\t\t\torder = order || this._order;\r\n\t\r\n\t\t\tif ( order === 'XYZ' ) {\r\n\t\r\n\t\t\t\tthis._y = Math.asin( clamp( m13, - 1, 1 ) );\r\n\t\r\n\t\t\t\tif ( Math.abs( m13 ) < 0.99999 ) {\r\n\t\r\n\t\t\t\t\tthis._x = Math.atan2( - m23, m33 );\r\n\t\t\t\t\tthis._z = Math.atan2( - m12, m11 );\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tthis._x = Math.atan2( m32, m22 );\r\n\t\t\t\t\tthis._z = 0;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t} else if ( order === 'YXZ' ) {\r\n\t\r\n\t\t\t\tthis._x = Math.asin( - clamp( m23, - 1, 1 ) );\r\n\t\r\n\t\t\t\tif ( Math.abs( m23 ) < 0.99999 ) {\r\n\t\r\n\t\t\t\t\tthis._y = Math.atan2( m13, m33 );\r\n\t\t\t\t\tthis._z = Math.atan2( m21, m22 );\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tthis._y = Math.atan2( - m31, m11 );\r\n\t\t\t\t\tthis._z = 0;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t} else if ( order === 'ZXY' ) {\r\n\t\r\n\t\t\t\tthis._x = Math.asin( clamp( m32, - 1, 1 ) );\r\n\t\r\n\t\t\t\tif ( Math.abs( m32 ) < 0.99999 ) {\r\n\t\r\n\t\t\t\t\tthis._y = Math.atan2( - m31, m33 );\r\n\t\t\t\t\tthis._z = Math.atan2( - m12, m22 );\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tthis._y = 0;\r\n\t\t\t\t\tthis._z = Math.atan2( m21, m11 );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t} else if ( order === 'ZYX' ) {\r\n\t\r\n\t\t\t\tthis._y = Math.asin( - clamp( m31, - 1, 1 ) );\r\n\t\r\n\t\t\t\tif ( Math.abs( m31 ) < 0.99999 ) {\r\n\t\r\n\t\t\t\t\tthis._x = Math.atan2( m32, m33 );\r\n\t\t\t\t\tthis._z = Math.atan2( m21, m11 );\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tthis._x = 0;\r\n\t\t\t\t\tthis._z = Math.atan2( - m12, m22 );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t} else if ( order === 'YZX' ) {\r\n\t\r\n\t\t\t\tthis._z = Math.asin( clamp( m21, - 1, 1 ) );\r\n\t\r\n\t\t\t\tif ( Math.abs( m21 ) < 0.99999 ) {\r\n\t\r\n\t\t\t\t\tthis._x = Math.atan2( - m23, m22 );\r\n\t\t\t\t\tthis._y = Math.atan2( - m31, m11 );\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tthis._x = 0;\r\n\t\t\t\t\tthis._y = Math.atan2( m13, m33 );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t} else if ( order === 'XZY' ) {\r\n\t\r\n\t\t\t\tthis._z = Math.asin( - clamp( m12, - 1, 1 ) );\r\n\t\r\n\t\t\t\tif ( Math.abs( m12 ) < 0.99999 ) {\r\n\t\r\n\t\t\t\t\tthis._x = Math.atan2( m32, m22 );\r\n\t\t\t\t\tthis._y = Math.atan2( m13, m11 );\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tthis._x = Math.atan2( - m23, m33 );\r\n\t\t\t\t\tthis._y = 0;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\tconsole.warn( 'THREE.Euler: .setFromRotationMatrix() given unsupported order: ' + order )\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tthis._order = order;\r\n\t\r\n\t\t\tif ( update !== false ) this.onChangeCallback();\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetFromQuaternion: function () {\r\n\t\r\n\t\t\tvar matrix;\r\n\t\r\n\t\t\treturn function ( q, order, update ) {\r\n\t\r\n\t\t\t\tif ( matrix === undefined ) matrix = new THREE.Matrix4();\r\n\t\t\t\tmatrix.makeRotationFromQuaternion( q );\r\n\t\t\t\tthis.setFromRotationMatrix( matrix, order, update );\r\n\t\r\n\t\t\t\treturn this;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tsetFromVector3: function ( v, order ) {\r\n\t\r\n\t\t\treturn this.set( v.x, v.y, v.z, order || this._order );\r\n\t\r\n\t\t},\r\n\t\r\n\t\treorder: function () {\r\n\t\r\n\t\t\t// WARNING: this discards revolution information -bhouston\r\n\t\r\n\t\t\tvar q = new THREE.Quaternion();\r\n\t\r\n\t\t\treturn function ( newOrder ) {\r\n\t\r\n\t\t\t\tq.setFromEuler( this );\r\n\t\t\t\tthis.setFromQuaternion( q, newOrder );\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tequals: function ( euler ) {\r\n\t\r\n\t\t\treturn ( euler._x === this._x ) && ( euler._y === this._y ) && ( euler._z === this._z ) && ( euler._order === this._order );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tfromArray: function ( array ) {\r\n\t\r\n\t\t\tthis._x = array[ 0 ];\r\n\t\t\tthis._y = array[ 1 ];\r\n\t\t\tthis._z = array[ 2 ];\r\n\t\t\tif ( array[ 3 ] !== undefined ) this._order = array[ 3 ];\r\n\t\r\n\t\t\tthis.onChangeCallback();\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\ttoArray: function ( array, offset ) {\r\n\t\r\n\t\t\tif ( array === undefined ) array = [];\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\t\r\n\t\t\tarray[ offset ] = this._x;\r\n\t\t\tarray[ offset + 1 ] = this._y;\r\n\t\t\tarray[ offset + 2 ] = this._z;\r\n\t\t\tarray[ offset + 3 ] = this._order;\r\n\t\r\n\t\t\treturn array;\r\n\t\r\n\t\t},\r\n\t\r\n\t\ttoVector3: function ( optionalResult ) {\r\n\t\r\n\t\t\tif ( optionalResult ) {\r\n\t\r\n\t\t\t\treturn optionalResult.set( this._x, this._y, this._z );\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\treturn new THREE.Vector3( this._x, this._y, this._z );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t},\r\n\t\r\n\t\tonChange: function ( callback ) {\r\n\t\r\n\t\t\tthis.onChangeCallback = callback;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tonChangeCallback: function () {}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/math/Line3.js\r\n\t\r\n\t/**\r\n\t * @author bhouston / http://clara.io\r\n\t */\r\n\t\r\n\tTHREE.Line3 = function ( start, end ) {\r\n\t\r\n\t\tthis.start = ( start !== undefined ) ? start : new THREE.Vector3();\r\n\t\tthis.end = ( end !== undefined ) ? end : new THREE.Vector3();\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Line3.prototype = {\r\n\t\r\n\t\tconstructor: THREE.Line3,\r\n\t\r\n\t\tset: function ( start, end ) {\r\n\t\r\n\t\t\tthis.start.copy( start );\r\n\t\t\tthis.end.copy( end );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tclone: function () {\r\n\t\r\n\t\t\treturn new this.constructor().copy( this );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcopy: function ( line ) {\r\n\t\r\n\t\t\tthis.start.copy( line.start );\r\n\t\t\tthis.end.copy( line.end );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcenter: function ( optionalTarget ) {\r\n\t\r\n\t\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\t\treturn result.addVectors( this.start, this.end ).multiplyScalar( 0.5 );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tdelta: function ( optionalTarget ) {\r\n\t\r\n\t\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\t\treturn result.subVectors( this.end, this.start );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tdistanceSq: function () {\r\n\t\r\n\t\t\treturn this.start.distanceToSquared( this.end );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tdistance: function () {\r\n\t\r\n\t\t\treturn this.start.distanceTo( this.end );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tat: function ( t, optionalTarget ) {\r\n\t\r\n\t\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\r\n\t\t\treturn this.delta( result ).multiplyScalar( t ).add( this.start );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tclosestPointToPointParameter: function () {\r\n\t\r\n\t\t\tvar startP = new THREE.Vector3();\r\n\t\t\tvar startEnd = new THREE.Vector3();\r\n\t\r\n\t\t\treturn function ( point, clampToLine ) {\r\n\t\r\n\t\t\t\tstartP.subVectors( point, this.start );\r\n\t\t\t\tstartEnd.subVectors( this.end, this.start );\r\n\t\r\n\t\t\t\tvar startEnd2 = startEnd.dot( startEnd );\r\n\t\t\t\tvar startEnd_startP = startEnd.dot( startP );\r\n\t\r\n\t\t\t\tvar t = startEnd_startP / startEnd2;\r\n\t\r\n\t\t\t\tif ( clampToLine ) {\r\n\t\r\n\t\t\t\t\tt = THREE.Math.clamp( t, 0, 1 );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\treturn t;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tclosestPointToPoint: function ( point, clampToLine, optionalTarget ) {\r\n\t\r\n\t\t\tvar t = this.closestPointToPointParameter( point, clampToLine );\r\n\t\r\n\t\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\r\n\t\t\treturn this.delta( result ).multiplyScalar( t ).add( this.start );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tapplyMatrix4: function ( matrix ) {\r\n\t\r\n\t\t\tthis.start.applyMatrix4( matrix );\r\n\t\t\tthis.end.applyMatrix4( matrix );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tequals: function ( line ) {\r\n\t\r\n\t\t\treturn line.start.equals( this.start ) && line.end.equals( this.end );\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/math/Box2.js\r\n\t\r\n\t/**\r\n\t * @author bhouston / http://clara.io\r\n\t */\r\n\t\r\n\tTHREE.Box2 = function ( min, max ) {\r\n\t\r\n\t\tthis.min = ( min !== undefined ) ? min : new THREE.Vector2( Infinity, Infinity );\r\n\t\tthis.max = ( max !== undefined ) ? max : new THREE.Vector2( - Infinity, - Infinity );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Box2.prototype = {\r\n\t\r\n\t\tconstructor: THREE.Box2,\r\n\t\r\n\t\tset: function ( min, max ) {\r\n\t\r\n\t\t\tthis.min.copy( min );\r\n\t\t\tthis.max.copy( max );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetFromPoints: function ( points ) {\r\n\t\r\n\t\t\tthis.makeEmpty();\r\n\t\r\n\t\t\tfor ( var i = 0, il = points.length; i < il; i ++ ) {\r\n\t\r\n\t\t\t\tthis.expandByPoint( points[ i ] )\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetFromCenterAndSize: function () {\r\n\t\r\n\t\t\tvar v1 = new THREE.Vector2();\r\n\t\r\n\t\t\treturn function ( center, size ) {\r\n\t\r\n\t\t\t\tvar halfSize = v1.copy( size ).multiplyScalar( 0.5 );\r\n\t\t\t\tthis.min.copy( center ).sub( halfSize );\r\n\t\t\t\tthis.max.copy( center ).add( halfSize );\r\n\t\r\n\t\t\t\treturn this;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\t\r\n\t\tclone: function () {\r\n\t\r\n\t\t\treturn new this.constructor().copy( this );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcopy: function ( box ) {\r\n\t\r\n\t\t\tthis.min.copy( box.min );\r\n\t\t\tthis.max.copy( box.max );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tmakeEmpty: function () {\r\n\t\r\n\t\t\tthis.min.x = this.min.y = Infinity;\r\n\t\t\tthis.max.x = this.max.y = - Infinity;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tempty: function () {\r\n\t\r\n\t\t\t// this is a more robust check for empty than ( volume <= 0 ) because volume can get positive with two negative axes\r\n\t\r\n\t\t\treturn ( this.max.x < this.min.x ) || ( this.max.y < this.min.y );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcenter: function ( optionalTarget ) {\r\n\t\r\n\t\t\tvar result = optionalTarget || new THREE.Vector2();\r\n\t\t\treturn result.addVectors( this.min, this.max ).multiplyScalar( 0.5 );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsize: function ( optionalTarget ) {\r\n\t\r\n\t\t\tvar result = optionalTarget || new THREE.Vector2();\r\n\t\t\treturn result.subVectors( this.max, this.min );\r\n\t\r\n\t\t},\r\n\t\r\n\t\texpandByPoint: function ( point ) {\r\n\t\r\n\t\t\tthis.min.min( point );\r\n\t\t\tthis.max.max( point );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\texpandByVector: function ( vector ) {\r\n\t\r\n\t\t\tthis.min.sub( vector );\r\n\t\t\tthis.max.add( vector );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\texpandByScalar: function ( scalar ) {\r\n\t\r\n\t\t\tthis.min.addScalar( - scalar );\r\n\t\t\tthis.max.addScalar( scalar );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcontainsPoint: function ( point ) {\r\n\t\r\n\t\t\tif ( point.x < this.min.x || point.x > this.max.x ||\r\n\t\t\t     point.y < this.min.y || point.y > this.max.y ) {\r\n\t\r\n\t\t\t\treturn false;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn true;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcontainsBox: function ( box ) {\r\n\t\r\n\t\t\tif ( ( this.min.x <= box.min.x ) && ( box.max.x <= this.max.x ) &&\r\n\t\t\t     ( this.min.y <= box.min.y ) && ( box.max.y <= this.max.y ) ) {\r\n\t\r\n\t\t\t\treturn true;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn false;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tgetParameter: function ( point, optionalTarget ) {\r\n\t\r\n\t\t\t// This can potentially have a divide by zero if the box\r\n\t\t\t// has a size dimension of 0.\r\n\t\r\n\t\t\tvar result = optionalTarget || new THREE.Vector2();\r\n\t\r\n\t\t\treturn result.set(\r\n\t\t\t\t( point.x - this.min.x ) / ( this.max.x - this.min.x ),\r\n\t\t\t\t( point.y - this.min.y ) / ( this.max.y - this.min.y )\r\n\t\t\t);\r\n\t\r\n\t\t},\r\n\t\r\n\t\tisIntersectionBox: function ( box ) {\r\n\t\r\n\t\t\t// using 6 splitting planes to rule out intersections.\r\n\t\r\n\t\t\tif ( box.max.x < this.min.x || box.min.x > this.max.x ||\r\n\t\t\t     box.max.y < this.min.y || box.min.y > this.max.y ) {\r\n\t\r\n\t\t\t\treturn false;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn true;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tclampPoint: function ( point, optionalTarget ) {\r\n\t\r\n\t\t\tvar result = optionalTarget || new THREE.Vector2();\r\n\t\t\treturn result.copy( point ).clamp( this.min, this.max );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tdistanceToPoint: function () {\r\n\t\r\n\t\t\tvar v1 = new THREE.Vector2();\r\n\t\r\n\t\t\treturn function ( point ) {\r\n\t\r\n\t\t\t\tvar clampedPoint = v1.copy( point ).clamp( this.min, this.max );\r\n\t\t\t\treturn clampedPoint.sub( point ).length();\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tintersect: function ( box ) {\r\n\t\r\n\t\t\tthis.min.max( box.min );\r\n\t\t\tthis.max.min( box.max );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tunion: function ( box ) {\r\n\t\r\n\t\t\tthis.min.min( box.min );\r\n\t\t\tthis.max.max( box.max );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\ttranslate: function ( offset ) {\r\n\t\r\n\t\t\tthis.min.add( offset );\r\n\t\t\tthis.max.add( offset );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tequals: function ( box ) {\r\n\t\r\n\t\t\treturn box.min.equals( this.min ) && box.max.equals( this.max );\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/math/Box3.js\r\n\t\r\n\t/**\r\n\t * @author bhouston / http://clara.io\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t */\r\n\t\r\n\tTHREE.Box3 = function ( min, max ) {\r\n\t\r\n\t\tthis.min = ( min !== undefined ) ? min : new THREE.Vector3( Infinity, Infinity, Infinity );\r\n\t\tthis.max = ( max !== undefined ) ? max : new THREE.Vector3( - Infinity, - Infinity, - Infinity );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Box3.prototype = {\r\n\t\r\n\t\tconstructor: THREE.Box3,\r\n\t\r\n\t\tset: function ( min, max ) {\r\n\t\r\n\t\t\tthis.min.copy( min );\r\n\t\t\tthis.max.copy( max );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetFromPoints: function ( points ) {\r\n\t\r\n\t\t\tthis.makeEmpty();\r\n\t\r\n\t\t\tfor ( var i = 0, il = points.length; i < il; i ++ ) {\r\n\t\r\n\t\t\t\tthis.expandByPoint( points[ i ] );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetFromCenterAndSize: function () {\r\n\t\r\n\t\t\tvar v1 = new THREE.Vector3();\r\n\t\r\n\t\t\treturn function ( center, size ) {\r\n\t\r\n\t\t\t\tvar halfSize = v1.copy( size ).multiplyScalar( 0.5 );\r\n\t\r\n\t\t\t\tthis.min.copy( center ).sub( halfSize );\r\n\t\t\t\tthis.max.copy( center ).add( halfSize );\r\n\t\r\n\t\t\t\treturn this;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tsetFromObject: function () {\r\n\t\r\n\t\t\t// Computes the world-axis-aligned bounding box of an object (including its children),\r\n\t\t\t// accounting for both the object's, and children's, world transforms\r\n\t\r\n\t\t\tvar v1 = new THREE.Vector3();\r\n\t\r\n\t\t\treturn function ( object ) {\r\n\t\r\n\t\t\t\tvar scope = this;\r\n\t\r\n\t\t\t\tobject.updateMatrixWorld( true );\r\n\t\r\n\t\t\t\tthis.makeEmpty();\r\n\t\r\n\t\t\t\tobject.traverse( function ( node ) {\r\n\t\r\n\t\t\t\t\tvar geometry = node.geometry;\r\n\t\r\n\t\t\t\t\tif ( geometry !== undefined ) {\r\n\t\r\n\t\t\t\t\t\tif ( geometry instanceof THREE.Geometry ) {\r\n\t\r\n\t\t\t\t\t\t\tvar vertices = geometry.vertices;\r\n\t\r\n\t\t\t\t\t\t\tfor ( var i = 0, il = vertices.length; i < il; i ++ ) {\r\n\t\r\n\t\t\t\t\t\t\t\tv1.copy( vertices[ i ] );\r\n\t\r\n\t\t\t\t\t\t\t\tv1.applyMatrix4( node.matrixWorld );\r\n\t\r\n\t\t\t\t\t\t\t\tscope.expandByPoint( v1 );\r\n\t\r\n\t\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t} else if ( geometry instanceof THREE.BufferGeometry && geometry.attributes[ 'position' ] !== undefined ) {\r\n\t\r\n\t\t\t\t\t\t\tvar positions = geometry.attributes[ 'position' ].array;\r\n\t\r\n\t\t\t\t\t\t\tfor ( var i = 0, il = positions.length; i < il; i += 3 ) {\r\n\t\r\n\t\t\t\t\t\t\t\tv1.set( positions[ i ], positions[ i + 1 ], positions[ i + 2 ] );\r\n\t\r\n\t\t\t\t\t\t\t\tv1.applyMatrix4( node.matrixWorld );\r\n\t\r\n\t\t\t\t\t\t\t\tscope.expandByPoint( v1 );\r\n\t\r\n\t\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t} );\r\n\t\r\n\t\t\t\treturn this;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tclone: function () {\r\n\t\r\n\t\t\treturn new this.constructor().copy( this );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcopy: function ( box ) {\r\n\t\r\n\t\t\tthis.min.copy( box.min );\r\n\t\t\tthis.max.copy( box.max );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tmakeEmpty: function () {\r\n\t\r\n\t\t\tthis.min.x = this.min.y = this.min.z = Infinity;\r\n\t\t\tthis.max.x = this.max.y = this.max.z = - Infinity;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tempty: function () {\r\n\t\r\n\t\t\t// this is a more robust check for empty than ( volume <= 0 ) because volume can get positive with two negative axes\r\n\t\r\n\t\t\treturn ( this.max.x < this.min.x ) || ( this.max.y < this.min.y ) || ( this.max.z < this.min.z );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcenter: function ( optionalTarget ) {\r\n\t\r\n\t\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\t\treturn result.addVectors( this.min, this.max ).multiplyScalar( 0.5 );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsize: function ( optionalTarget ) {\r\n\t\r\n\t\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\t\treturn result.subVectors( this.max, this.min );\r\n\t\r\n\t\t},\r\n\t\r\n\t\texpandByPoint: function ( point ) {\r\n\t\r\n\t\t\tthis.min.min( point );\r\n\t\t\tthis.max.max( point );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\texpandByVector: function ( vector ) {\r\n\t\r\n\t\t\tthis.min.sub( vector );\r\n\t\t\tthis.max.add( vector );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\texpandByScalar: function ( scalar ) {\r\n\t\r\n\t\t\tthis.min.addScalar( - scalar );\r\n\t\t\tthis.max.addScalar( scalar );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcontainsPoint: function ( point ) {\r\n\t\r\n\t\t\tif ( point.x < this.min.x || point.x > this.max.x ||\r\n\t\t\t     point.y < this.min.y || point.y > this.max.y ||\r\n\t\t\t     point.z < this.min.z || point.z > this.max.z ) {\r\n\t\r\n\t\t\t\treturn false;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn true;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcontainsBox: function ( box ) {\r\n\t\r\n\t\t\tif ( ( this.min.x <= box.min.x ) && ( box.max.x <= this.max.x ) &&\r\n\t\t\t\t ( this.min.y <= box.min.y ) && ( box.max.y <= this.max.y ) &&\r\n\t\t\t\t ( this.min.z <= box.min.z ) && ( box.max.z <= this.max.z ) ) {\r\n\t\r\n\t\t\t\treturn true;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn false;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tgetParameter: function ( point, optionalTarget ) {\r\n\t\r\n\t\t\t// This can potentially have a divide by zero if the box\r\n\t\t\t// has a size dimension of 0.\r\n\t\r\n\t\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\r\n\t\t\treturn result.set(\r\n\t\t\t\t( point.x - this.min.x ) / ( this.max.x - this.min.x ),\r\n\t\t\t\t( point.y - this.min.y ) / ( this.max.y - this.min.y ),\r\n\t\t\t\t( point.z - this.min.z ) / ( this.max.z - this.min.z )\r\n\t\t\t);\r\n\t\r\n\t\t},\r\n\t\r\n\t\tisIntersectionBox: function ( box ) {\r\n\t\r\n\t\t\t// using 6 splitting planes to rule out intersections.\r\n\t\r\n\t\t\tif ( box.max.x < this.min.x || box.min.x > this.max.x ||\r\n\t\t\t     box.max.y < this.min.y || box.min.y > this.max.y ||\r\n\t\t\t     box.max.z < this.min.z || box.min.z > this.max.z ) {\r\n\t\r\n\t\t\t\treturn false;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn true;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tclampPoint: function ( point, optionalTarget ) {\r\n\t\r\n\t\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\t\treturn result.copy( point ).clamp( this.min, this.max );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tdistanceToPoint: function () {\r\n\t\r\n\t\t\tvar v1 = new THREE.Vector3();\r\n\t\r\n\t\t\treturn function ( point ) {\r\n\t\r\n\t\t\t\tvar clampedPoint = v1.copy( point ).clamp( this.min, this.max );\r\n\t\t\t\treturn clampedPoint.sub( point ).length();\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tgetBoundingSphere: function () {\r\n\t\r\n\t\t\tvar v1 = new THREE.Vector3();\r\n\t\r\n\t\t\treturn function ( optionalTarget ) {\r\n\t\r\n\t\t\t\tvar result = optionalTarget || new THREE.Sphere();\r\n\t\r\n\t\t\t\tresult.center = this.center();\r\n\t\t\t\tresult.radius = this.size( v1 ).length() * 0.5;\r\n\t\r\n\t\t\t\treturn result;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tintersect: function ( box ) {\r\n\t\r\n\t\t\tthis.min.max( box.min );\r\n\t\t\tthis.max.min( box.max );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tunion: function ( box ) {\r\n\t\r\n\t\t\tthis.min.min( box.min );\r\n\t\t\tthis.max.max( box.max );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tapplyMatrix4: function () {\r\n\t\r\n\t\t\tvar points = [\r\n\t\t\t\tnew THREE.Vector3(),\r\n\t\t\t\tnew THREE.Vector3(),\r\n\t\t\t\tnew THREE.Vector3(),\r\n\t\t\t\tnew THREE.Vector3(),\r\n\t\t\t\tnew THREE.Vector3(),\r\n\t\t\t\tnew THREE.Vector3(),\r\n\t\t\t\tnew THREE.Vector3(),\r\n\t\t\t\tnew THREE.Vector3()\r\n\t\t\t];\r\n\t\r\n\t\t\treturn function ( matrix ) {\r\n\t\r\n\t\t\t\t// NOTE: I am using a binary pattern to specify all 2^3 combinations below\r\n\t\t\t\tpoints[ 0 ].set( this.min.x, this.min.y, this.min.z ).applyMatrix4( matrix ); // 000\r\n\t\t\t\tpoints[ 1 ].set( this.min.x, this.min.y, this.max.z ).applyMatrix4( matrix ); // 001\r\n\t\t\t\tpoints[ 2 ].set( this.min.x, this.max.y, this.min.z ).applyMatrix4( matrix ); // 010\r\n\t\t\t\tpoints[ 3 ].set( this.min.x, this.max.y, this.max.z ).applyMatrix4( matrix ); // 011\r\n\t\t\t\tpoints[ 4 ].set( this.max.x, this.min.y, this.min.z ).applyMatrix4( matrix ); // 100\r\n\t\t\t\tpoints[ 5 ].set( this.max.x, this.min.y, this.max.z ).applyMatrix4( matrix ); // 101\r\n\t\t\t\tpoints[ 6 ].set( this.max.x, this.max.y, this.min.z ).applyMatrix4( matrix ); // 110\r\n\t\t\t\tpoints[ 7 ].set( this.max.x, this.max.y, this.max.z ).applyMatrix4( matrix );  // 111\r\n\t\r\n\t\t\t\tthis.makeEmpty();\r\n\t\t\t\tthis.setFromPoints( points );\r\n\t\r\n\t\t\t\treturn this;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\ttranslate: function ( offset ) {\r\n\t\r\n\t\t\tthis.min.add( offset );\r\n\t\t\tthis.max.add( offset );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tequals: function ( box ) {\r\n\t\r\n\t\t\treturn box.min.equals( this.min ) && box.max.equals( this.max );\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/math/Matrix3.js\r\n\t\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t * @author bhouston / http://clara.io\r\n\t */\r\n\t\r\n\tTHREE.Matrix3 = function () {\r\n\t\r\n\t\tthis.elements = new Float32Array( [\r\n\t\r\n\t\t\t1, 0, 0,\r\n\t\t\t0, 1, 0,\r\n\t\t\t0, 0, 1\r\n\t\r\n\t\t] );\r\n\t\r\n\t\tif ( arguments.length > 0 ) {\r\n\t\r\n\t\t\tconsole.error( 'THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.' );\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Matrix3.prototype = {\r\n\t\r\n\t\tconstructor: THREE.Matrix3,\r\n\t\r\n\t\tset: function ( n11, n12, n13, n21, n22, n23, n31, n32, n33 ) {\r\n\t\r\n\t\t\tvar te = this.elements;\r\n\t\r\n\t\t\tte[ 0 ] = n11; te[ 3 ] = n12; te[ 6 ] = n13;\r\n\t\t\tte[ 1 ] = n21; te[ 4 ] = n22; te[ 7 ] = n23;\r\n\t\t\tte[ 2 ] = n31; te[ 5 ] = n32; te[ 8 ] = n33;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tidentity: function () {\r\n\t\r\n\t\t\tthis.set(\r\n\t\r\n\t\t\t\t1, 0, 0,\r\n\t\t\t\t0, 1, 0,\r\n\t\t\t\t0, 0, 1\r\n\t\r\n\t\t\t);\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tclone: function () {\r\n\t\r\n\t\t\treturn new this.constructor().fromArray( this.elements );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcopy: function ( m ) {\r\n\t\r\n\t\t\tvar me = m.elements;\r\n\t\r\n\t\t\tthis.set(\r\n\t\r\n\t\t\t\tme[ 0 ], me[ 3 ], me[ 6 ],\r\n\t\t\t\tme[ 1 ], me[ 4 ], me[ 7 ],\r\n\t\t\t\tme[ 2 ], me[ 5 ], me[ 8 ]\r\n\t\r\n\t\t\t);\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tmultiplyVector3: function ( vector ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.' );\r\n\t\t\treturn vector.applyMatrix3( this );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tmultiplyVector3Array: function ( a ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.' );\r\n\t\t\treturn this.applyToVector3Array( a );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tapplyToVector3Array: function () {\r\n\t\r\n\t\t\tvar v1;\r\n\t\r\n\t\t\treturn function ( array, offset, length ) {\r\n\t\r\n\t\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\t\t\t\tif ( offset === undefined ) offset = 0;\r\n\t\t\t\tif ( length === undefined ) length = array.length;\r\n\t\r\n\t\t\t\tfor ( var i = 0, j = offset; i < length; i += 3, j += 3 ) {\r\n\t\r\n\t\t\t\t\tv1.fromArray( array, j );\r\n\t\t\t\t\tv1.applyMatrix3( this );\r\n\t\t\t\t\tv1.toArray( array, j );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\treturn array;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tapplyToBuffer: function () {\r\n\t\r\n\t\t\tvar v1;\r\n\t\r\n\t\t\treturn function applyToBuffer( buffer, offset, length ) {\r\n\t\r\n\t\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\t\t\t\tif ( offset === undefined ) offset = 0;\r\n\t\t\t\tif ( length === undefined ) length = buffer.length / buffer.itemSize;\r\n\t\r\n\t\t\t\tfor ( var i = 0, j = offset; i < length; i ++, j ++ ) {\r\n\t\r\n\t\t\t\t\tv1.x = buffer.getX( j );\r\n\t\t\t\t\tv1.y = buffer.getY( j );\r\n\t\t\t\t\tv1.z = buffer.getZ( j );\r\n\t\r\n\t\t\t\t\tv1.applyMatrix3( this );\r\n\t\r\n\t\t\t\t\tbuffer.setXYZ( v1.x, v1.y, v1.z );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\treturn buffer;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tmultiplyScalar: function ( s ) {\r\n\t\r\n\t\t\tvar te = this.elements;\r\n\t\r\n\t\t\tte[ 0 ] *= s; te[ 3 ] *= s; te[ 6 ] *= s;\r\n\t\t\tte[ 1 ] *= s; te[ 4 ] *= s; te[ 7 ] *= s;\r\n\t\t\tte[ 2 ] *= s; te[ 5 ] *= s; te[ 8 ] *= s;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tdeterminant: function () {\r\n\t\r\n\t\t\tvar te = this.elements;\r\n\t\r\n\t\t\tvar a = te[ 0 ], b = te[ 1 ], c = te[ 2 ],\r\n\t\t\t\td = te[ 3 ], e = te[ 4 ], f = te[ 5 ],\r\n\t\t\t\tg = te[ 6 ], h = te[ 7 ], i = te[ 8 ];\r\n\t\r\n\t\t\treturn a * e * i - a * f * h - b * d * i + b * f * g + c * d * h - c * e * g;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tgetInverse: function ( matrix, throwOnInvertible ) {\r\n\t\r\n\t\t\t// input: THREE.Matrix4\r\n\t\t\t// ( based on http://code.google.com/p/webgl-mjs/ )\r\n\t\r\n\t\t\tvar me = matrix.elements;\r\n\t\t\tvar te = this.elements;\r\n\t\r\n\t\t\tte[ 0 ] =   me[ 10 ] * me[ 5 ] - me[ 6 ] * me[ 9 ];\r\n\t\t\tte[ 1 ] = - me[ 10 ] * me[ 1 ] + me[ 2 ] * me[ 9 ];\r\n\t\t\tte[ 2 ] =   me[ 6 ] * me[ 1 ] - me[ 2 ] * me[ 5 ];\r\n\t\t\tte[ 3 ] = - me[ 10 ] * me[ 4 ] + me[ 6 ] * me[ 8 ];\r\n\t\t\tte[ 4 ] =   me[ 10 ] * me[ 0 ] - me[ 2 ] * me[ 8 ];\r\n\t\t\tte[ 5 ] = - me[ 6 ] * me[ 0 ] + me[ 2 ] * me[ 4 ];\r\n\t\t\tte[ 6 ] =   me[ 9 ] * me[ 4 ] - me[ 5 ] * me[ 8 ];\r\n\t\t\tte[ 7 ] = - me[ 9 ] * me[ 0 ] + me[ 1 ] * me[ 8 ];\r\n\t\t\tte[ 8 ] =   me[ 5 ] * me[ 0 ] - me[ 1 ] * me[ 4 ];\r\n\t\r\n\t\t\tvar det = me[ 0 ] * te[ 0 ] + me[ 1 ] * te[ 3 ] + me[ 2 ] * te[ 6 ];\r\n\t\r\n\t\t\t// no inverse\r\n\t\r\n\t\t\tif ( det === 0 ) {\r\n\t\r\n\t\t\t\tvar msg = \"Matrix3.getInverse(): can't invert matrix, determinant is 0\";\r\n\t\r\n\t\t\t\tif ( throwOnInvertible || false ) {\r\n\t\r\n\t\t\t\t\tthrow new Error( msg );\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tconsole.warn( msg );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tthis.identity();\r\n\t\r\n\t\t\t\treturn this;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tthis.multiplyScalar( 1.0 / det );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\ttranspose: function () {\r\n\t\r\n\t\t\tvar tmp, m = this.elements;\r\n\t\r\n\t\t\ttmp = m[ 1 ]; m[ 1 ] = m[ 3 ]; m[ 3 ] = tmp;\r\n\t\t\ttmp = m[ 2 ]; m[ 2 ] = m[ 6 ]; m[ 6 ] = tmp;\r\n\t\t\ttmp = m[ 5 ]; m[ 5 ] = m[ 7 ]; m[ 7 ] = tmp;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tflattenToArrayOffset: function ( array, offset ) {\r\n\t\r\n\t\t\tvar te = this.elements;\r\n\t\r\n\t\t\tarray[ offset ] = te[ 0 ];\r\n\t\t\tarray[ offset + 1 ] = te[ 1 ];\r\n\t\t\tarray[ offset + 2 ] = te[ 2 ];\r\n\t\r\n\t\t\tarray[ offset + 3 ] = te[ 3 ];\r\n\t\t\tarray[ offset + 4 ] = te[ 4 ];\r\n\t\t\tarray[ offset + 5 ] = te[ 5 ];\r\n\t\r\n\t\t\tarray[ offset + 6 ] = te[ 6 ];\r\n\t\t\tarray[ offset + 7 ] = te[ 7 ];\r\n\t\t\tarray[ offset + 8 ]  = te[ 8 ];\r\n\t\r\n\t\t\treturn array;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tgetNormalMatrix: function ( m ) {\r\n\t\r\n\t\t\t// input: THREE.Matrix4\r\n\t\r\n\t\t\tthis.getInverse( m ).transpose();\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\ttransposeIntoArray: function ( r ) {\r\n\t\r\n\t\t\tvar m = this.elements;\r\n\t\r\n\t\t\tr[ 0 ] = m[ 0 ];\r\n\t\t\tr[ 1 ] = m[ 3 ];\r\n\t\t\tr[ 2 ] = m[ 6 ];\r\n\t\t\tr[ 3 ] = m[ 1 ];\r\n\t\t\tr[ 4 ] = m[ 4 ];\r\n\t\t\tr[ 5 ] = m[ 7 ];\r\n\t\t\tr[ 6 ] = m[ 2 ];\r\n\t\t\tr[ 7 ] = m[ 5 ];\r\n\t\t\tr[ 8 ] = m[ 8 ];\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tfromArray: function ( array ) {\r\n\t\r\n\t\t\tthis.elements.set( array );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\ttoArray: function () {\r\n\t\r\n\t\t\tvar te = this.elements;\r\n\t\r\n\t\t\treturn [\r\n\t\t\t\tte[ 0 ], te[ 1 ], te[ 2 ],\r\n\t\t\t\tte[ 3 ], te[ 4 ], te[ 5 ],\r\n\t\t\t\tte[ 6 ], te[ 7 ], te[ 8 ]\r\n\t\t\t];\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/math/Matrix4.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author supereggbert / http://www.paulbrunt.co.uk/\r\n\t * @author philogb / http://blog.thejit.org/\r\n\t * @author jordi_ros / http://plattsoft.com\r\n\t * @author D1plo1d / http://github.com/D1plo1d\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author timknip / http://www.floorplanner.com/\r\n\t * @author bhouston / http://clara.io\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t */\r\n\t\r\n\tTHREE.Matrix4 = function () {\r\n\t\r\n\t\tthis.elements = new Float32Array( [\r\n\t\r\n\t\t\t1, 0, 0, 0,\r\n\t\t\t0, 1, 0, 0,\r\n\t\t\t0, 0, 1, 0,\r\n\t\t\t0, 0, 0, 1\r\n\t\r\n\t\t] );\r\n\t\r\n\t\tif ( arguments.length > 0 ) {\r\n\t\r\n\t\t\tconsole.error( 'THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.' );\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Matrix4.prototype = {\r\n\t\r\n\t\tconstructor: THREE.Matrix4,\r\n\t\r\n\t\tset: function ( n11, n12, n13, n14, n21, n22, n23, n24, n31, n32, n33, n34, n41, n42, n43, n44 ) {\r\n\t\r\n\t\t\tvar te = this.elements;\r\n\t\r\n\t\t\tte[ 0 ] = n11; te[ 4 ] = n12; te[ 8 ] = n13; te[ 12 ] = n14;\r\n\t\t\tte[ 1 ] = n21; te[ 5 ] = n22; te[ 9 ] = n23; te[ 13 ] = n24;\r\n\t\t\tte[ 2 ] = n31; te[ 6 ] = n32; te[ 10 ] = n33; te[ 14 ] = n34;\r\n\t\t\tte[ 3 ] = n41; te[ 7 ] = n42; te[ 11 ] = n43; te[ 15 ] = n44;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tidentity: function () {\r\n\t\r\n\t\t\tthis.set(\r\n\t\r\n\t\t\t\t1, 0, 0, 0,\r\n\t\t\t\t0, 1, 0, 0,\r\n\t\t\t\t0, 0, 1, 0,\r\n\t\t\t\t0, 0, 0, 1\r\n\t\r\n\t\t\t);\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tclone: function () {\r\n\t\r\n\t\t\treturn new THREE.Matrix4().fromArray( this.elements );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcopy: function ( m ) {\r\n\t\r\n\t\t\tthis.elements.set( m.elements );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\textractPosition: function ( m ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.Matrix4: .extractPosition() has been renamed to .copyPosition().' );\r\n\t\t\treturn this.copyPosition( m );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcopyPosition: function ( m ) {\r\n\t\r\n\t\t\tvar te = this.elements;\r\n\t\t\tvar me = m.elements;\r\n\t\r\n\t\t\tte[ 12 ] = me[ 12 ];\r\n\t\t\tte[ 13 ] = me[ 13 ];\r\n\t\t\tte[ 14 ] = me[ 14 ];\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\textractBasis: function ( xAxis, yAxis, zAxis ) {\r\n\t\r\n\t\t\tvar te = this.elements;\r\n\t\r\n\t\t\txAxis.set( te[ 0 ], te[ 1 ], te[ 2 ] );\r\n\t\t\tyAxis.set( te[ 4 ], te[ 5 ], te[ 6 ] );\r\n\t\t\tzAxis.set( te[ 8 ], te[ 9 ], te[ 10 ] );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tmakeBasis: function ( xAxis, yAxis, zAxis ) {\r\n\t\r\n\t\t\tthis.set(\r\n\t\t\t\txAxis.x, yAxis.x, zAxis.x, 0,\r\n\t\t\t\txAxis.y, yAxis.y, zAxis.y, 0,\r\n\t\t\t\txAxis.z, yAxis.z, zAxis.z, 0,\r\n\t\t\t\t0,       0,       0,       1\r\n\t\t\t);\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\textractRotation: function () {\r\n\t\r\n\t\t\tvar v1;\r\n\t\r\n\t\t\treturn function ( m ) {\r\n\t\r\n\t\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\t\r\n\t\t\t\tvar te = this.elements;\r\n\t\t\t\tvar me = m.elements;\r\n\t\r\n\t\t\t\tvar scaleX = 1 / v1.set( me[ 0 ], me[ 1 ], me[ 2 ] ).length();\r\n\t\t\t\tvar scaleY = 1 / v1.set( me[ 4 ], me[ 5 ], me[ 6 ] ).length();\r\n\t\t\t\tvar scaleZ = 1 / v1.set( me[ 8 ], me[ 9 ], me[ 10 ] ).length();\r\n\t\r\n\t\t\t\tte[ 0 ] = me[ 0 ] * scaleX;\r\n\t\t\t\tte[ 1 ] = me[ 1 ] * scaleX;\r\n\t\t\t\tte[ 2 ] = me[ 2 ] * scaleX;\r\n\t\r\n\t\t\t\tte[ 4 ] = me[ 4 ] * scaleY;\r\n\t\t\t\tte[ 5 ] = me[ 5 ] * scaleY;\r\n\t\t\t\tte[ 6 ] = me[ 6 ] * scaleY;\r\n\t\r\n\t\t\t\tte[ 8 ] = me[ 8 ] * scaleZ;\r\n\t\t\t\tte[ 9 ] = me[ 9 ] * scaleZ;\r\n\t\t\t\tte[ 10 ] = me[ 10 ] * scaleZ;\r\n\t\r\n\t\t\t\treturn this;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tmakeRotationFromEuler: function ( euler ) {\r\n\t\r\n\t\t\tif ( euler instanceof THREE.Euler === false ) {\r\n\t\r\n\t\t\t\tconsole.error( 'THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.' );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar te = this.elements;\r\n\t\r\n\t\t\tvar x = euler.x, y = euler.y, z = euler.z;\r\n\t\t\tvar a = Math.cos( x ), b = Math.sin( x );\r\n\t\t\tvar c = Math.cos( y ), d = Math.sin( y );\r\n\t\t\tvar e = Math.cos( z ), f = Math.sin( z );\r\n\t\r\n\t\t\tif ( euler.order === 'XYZ' ) {\r\n\t\r\n\t\t\t\tvar ae = a * e, af = a * f, be = b * e, bf = b * f;\r\n\t\r\n\t\t\t\tte[ 0 ] = c * e;\r\n\t\t\t\tte[ 4 ] = - c * f;\r\n\t\t\t\tte[ 8 ] = d;\r\n\t\r\n\t\t\t\tte[ 1 ] = af + be * d;\r\n\t\t\t\tte[ 5 ] = ae - bf * d;\r\n\t\t\t\tte[ 9 ] = - b * c;\r\n\t\r\n\t\t\t\tte[ 2 ] = bf - ae * d;\r\n\t\t\t\tte[ 6 ] = be + af * d;\r\n\t\t\t\tte[ 10 ] = a * c;\r\n\t\r\n\t\t\t} else if ( euler.order === 'YXZ' ) {\r\n\t\r\n\t\t\t\tvar ce = c * e, cf = c * f, de = d * e, df = d * f;\r\n\t\r\n\t\t\t\tte[ 0 ] = ce + df * b;\r\n\t\t\t\tte[ 4 ] = de * b - cf;\r\n\t\t\t\tte[ 8 ] = a * d;\r\n\t\r\n\t\t\t\tte[ 1 ] = a * f;\r\n\t\t\t\tte[ 5 ] = a * e;\r\n\t\t\t\tte[ 9 ] = - b;\r\n\t\r\n\t\t\t\tte[ 2 ] = cf * b - de;\r\n\t\t\t\tte[ 6 ] = df + ce * b;\r\n\t\t\t\tte[ 10 ] = a * c;\r\n\t\r\n\t\t\t} else if ( euler.order === 'ZXY' ) {\r\n\t\r\n\t\t\t\tvar ce = c * e, cf = c * f, de = d * e, df = d * f;\r\n\t\r\n\t\t\t\tte[ 0 ] = ce - df * b;\r\n\t\t\t\tte[ 4 ] = - a * f;\r\n\t\t\t\tte[ 8 ] = de + cf * b;\r\n\t\r\n\t\t\t\tte[ 1 ] = cf + de * b;\r\n\t\t\t\tte[ 5 ] = a * e;\r\n\t\t\t\tte[ 9 ] = df - ce * b;\r\n\t\r\n\t\t\t\tte[ 2 ] = - a * d;\r\n\t\t\t\tte[ 6 ] = b;\r\n\t\t\t\tte[ 10 ] = a * c;\r\n\t\r\n\t\t\t} else if ( euler.order === 'ZYX' ) {\r\n\t\r\n\t\t\t\tvar ae = a * e, af = a * f, be = b * e, bf = b * f;\r\n\t\r\n\t\t\t\tte[ 0 ] = c * e;\r\n\t\t\t\tte[ 4 ] = be * d - af;\r\n\t\t\t\tte[ 8 ] = ae * d + bf;\r\n\t\r\n\t\t\t\tte[ 1 ] = c * f;\r\n\t\t\t\tte[ 5 ] = bf * d + ae;\r\n\t\t\t\tte[ 9 ] = af * d - be;\r\n\t\r\n\t\t\t\tte[ 2 ] = - d;\r\n\t\t\t\tte[ 6 ] = b * c;\r\n\t\t\t\tte[ 10 ] = a * c;\r\n\t\r\n\t\t\t} else if ( euler.order === 'YZX' ) {\r\n\t\r\n\t\t\t\tvar ac = a * c, ad = a * d, bc = b * c, bd = b * d;\r\n\t\r\n\t\t\t\tte[ 0 ] = c * e;\r\n\t\t\t\tte[ 4 ] = bd - ac * f;\r\n\t\t\t\tte[ 8 ] = bc * f + ad;\r\n\t\r\n\t\t\t\tte[ 1 ] = f;\r\n\t\t\t\tte[ 5 ] = a * e;\r\n\t\t\t\tte[ 9 ] = - b * e;\r\n\t\r\n\t\t\t\tte[ 2 ] = - d * e;\r\n\t\t\t\tte[ 6 ] = ad * f + bc;\r\n\t\t\t\tte[ 10 ] = ac - bd * f;\r\n\t\r\n\t\t\t} else if ( euler.order === 'XZY' ) {\r\n\t\r\n\t\t\t\tvar ac = a * c, ad = a * d, bc = b * c, bd = b * d;\r\n\t\r\n\t\t\t\tte[ 0 ] = c * e;\r\n\t\t\t\tte[ 4 ] = - f;\r\n\t\t\t\tte[ 8 ] = d * e;\r\n\t\r\n\t\t\t\tte[ 1 ] = ac * f + bd;\r\n\t\t\t\tte[ 5 ] = a * e;\r\n\t\t\t\tte[ 9 ] = ad * f - bc;\r\n\t\r\n\t\t\t\tte[ 2 ] = bc * f - ad;\r\n\t\t\t\tte[ 6 ] = b * e;\r\n\t\t\t\tte[ 10 ] = bd * f + ac;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// last column\r\n\t\t\tte[ 3 ] = 0;\r\n\t\t\tte[ 7 ] = 0;\r\n\t\t\tte[ 11 ] = 0;\r\n\t\r\n\t\t\t// bottom row\r\n\t\t\tte[ 12 ] = 0;\r\n\t\t\tte[ 13 ] = 0;\r\n\t\t\tte[ 14 ] = 0;\r\n\t\t\tte[ 15 ] = 1;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetRotationFromQuaternion: function ( q ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion().' );\r\n\t\r\n\t\t\treturn this.makeRotationFromQuaternion( q );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tmakeRotationFromQuaternion: function ( q ) {\r\n\t\r\n\t\t\tvar te = this.elements;\r\n\t\r\n\t\t\tvar x = q.x, y = q.y, z = q.z, w = q.w;\r\n\t\t\tvar x2 = x + x, y2 = y + y, z2 = z + z;\r\n\t\t\tvar xx = x * x2, xy = x * y2, xz = x * z2;\r\n\t\t\tvar yy = y * y2, yz = y * z2, zz = z * z2;\r\n\t\t\tvar wx = w * x2, wy = w * y2, wz = w * z2;\r\n\t\r\n\t\t\tte[ 0 ] = 1 - ( yy + zz );\r\n\t\t\tte[ 4 ] = xy - wz;\r\n\t\t\tte[ 8 ] = xz + wy;\r\n\t\r\n\t\t\tte[ 1 ] = xy + wz;\r\n\t\t\tte[ 5 ] = 1 - ( xx + zz );\r\n\t\t\tte[ 9 ] = yz - wx;\r\n\t\r\n\t\t\tte[ 2 ] = xz - wy;\r\n\t\t\tte[ 6 ] = yz + wx;\r\n\t\t\tte[ 10 ] = 1 - ( xx + yy );\r\n\t\r\n\t\t\t// last column\r\n\t\t\tte[ 3 ] = 0;\r\n\t\t\tte[ 7 ] = 0;\r\n\t\t\tte[ 11 ] = 0;\r\n\t\r\n\t\t\t// bottom row\r\n\t\t\tte[ 12 ] = 0;\r\n\t\t\tte[ 13 ] = 0;\r\n\t\t\tte[ 14 ] = 0;\r\n\t\t\tte[ 15 ] = 1;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tlookAt: function () {\r\n\t\r\n\t\t\tvar x, y, z;\r\n\t\r\n\t\t\treturn function ( eye, target, up ) {\r\n\t\r\n\t\t\t\tif ( x === undefined ) x = new THREE.Vector3();\r\n\t\t\t\tif ( y === undefined ) y = new THREE.Vector3();\r\n\t\t\t\tif ( z === undefined ) z = new THREE.Vector3();\r\n\t\r\n\t\t\t\tvar te = this.elements;\r\n\t\r\n\t\t\t\tz.subVectors( eye, target ).normalize();\r\n\t\r\n\t\t\t\tif ( z.lengthSq() === 0 ) {\r\n\t\r\n\t\t\t\t\tz.z = 1;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tx.crossVectors( up, z ).normalize();\r\n\t\r\n\t\t\t\tif ( x.lengthSq() === 0 ) {\r\n\t\r\n\t\t\t\t\tz.x += 0.0001;\r\n\t\t\t\t\tx.crossVectors( up, z ).normalize();\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\ty.crossVectors( z, x );\r\n\t\r\n\t\r\n\t\t\t\tte[ 0 ] = x.x; te[ 4 ] = y.x; te[ 8 ] = z.x;\r\n\t\t\t\tte[ 1 ] = x.y; te[ 5 ] = y.y; te[ 9 ] = z.y;\r\n\t\t\t\tte[ 2 ] = x.z; te[ 6 ] = y.z; te[ 10 ] = z.z;\r\n\t\r\n\t\t\t\treturn this;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tmultiply: function ( m, n ) {\r\n\t\r\n\t\t\tif ( n !== undefined ) {\r\n\t\r\n\t\t\t\tconsole.warn( 'THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead.' );\r\n\t\t\t\treturn this.multiplyMatrices( m, n );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn this.multiplyMatrices( this, m );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tmultiplyMatrices: function ( a, b ) {\r\n\t\r\n\t\t\tvar ae = a.elements;\r\n\t\t\tvar be = b.elements;\r\n\t\t\tvar te = this.elements;\r\n\t\r\n\t\t\tvar a11 = ae[ 0 ], a12 = ae[ 4 ], a13 = ae[ 8 ], a14 = ae[ 12 ];\r\n\t\t\tvar a21 = ae[ 1 ], a22 = ae[ 5 ], a23 = ae[ 9 ], a24 = ae[ 13 ];\r\n\t\t\tvar a31 = ae[ 2 ], a32 = ae[ 6 ], a33 = ae[ 10 ], a34 = ae[ 14 ];\r\n\t\t\tvar a41 = ae[ 3 ], a42 = ae[ 7 ], a43 = ae[ 11 ], a44 = ae[ 15 ];\r\n\t\r\n\t\t\tvar b11 = be[ 0 ], b12 = be[ 4 ], b13 = be[ 8 ], b14 = be[ 12 ];\r\n\t\t\tvar b21 = be[ 1 ], b22 = be[ 5 ], b23 = be[ 9 ], b24 = be[ 13 ];\r\n\t\t\tvar b31 = be[ 2 ], b32 = be[ 6 ], b33 = be[ 10 ], b34 = be[ 14 ];\r\n\t\t\tvar b41 = be[ 3 ], b42 = be[ 7 ], b43 = be[ 11 ], b44 = be[ 15 ];\r\n\t\r\n\t\t\tte[ 0 ] = a11 * b11 + a12 * b21 + a13 * b31 + a14 * b41;\r\n\t\t\tte[ 4 ] = a11 * b12 + a12 * b22 + a13 * b32 + a14 * b42;\r\n\t\t\tte[ 8 ] = a11 * b13 + a12 * b23 + a13 * b33 + a14 * b43;\r\n\t\t\tte[ 12 ] = a11 * b14 + a12 * b24 + a13 * b34 + a14 * b44;\r\n\t\r\n\t\t\tte[ 1 ] = a21 * b11 + a22 * b21 + a23 * b31 + a24 * b41;\r\n\t\t\tte[ 5 ] = a21 * b12 + a22 * b22 + a23 * b32 + a24 * b42;\r\n\t\t\tte[ 9 ] = a21 * b13 + a22 * b23 + a23 * b33 + a24 * b43;\r\n\t\t\tte[ 13 ] = a21 * b14 + a22 * b24 + a23 * b34 + a24 * b44;\r\n\t\r\n\t\t\tte[ 2 ] = a31 * b11 + a32 * b21 + a33 * b31 + a34 * b41;\r\n\t\t\tte[ 6 ] = a31 * b12 + a32 * b22 + a33 * b32 + a34 * b42;\r\n\t\t\tte[ 10 ] = a31 * b13 + a32 * b23 + a33 * b33 + a34 * b43;\r\n\t\t\tte[ 14 ] = a31 * b14 + a32 * b24 + a33 * b34 + a34 * b44;\r\n\t\r\n\t\t\tte[ 3 ] = a41 * b11 + a42 * b21 + a43 * b31 + a44 * b41;\r\n\t\t\tte[ 7 ] = a41 * b12 + a42 * b22 + a43 * b32 + a44 * b42;\r\n\t\t\tte[ 11 ] = a41 * b13 + a42 * b23 + a43 * b33 + a44 * b43;\r\n\t\t\tte[ 15 ] = a41 * b14 + a42 * b24 + a43 * b34 + a44 * b44;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tmultiplyToArray: function ( a, b, r ) {\r\n\t\r\n\t\t\tvar te = this.elements;\r\n\t\r\n\t\t\tthis.multiplyMatrices( a, b );\r\n\t\r\n\t\t\tr[ 0 ] = te[ 0 ]; r[ 1 ] = te[ 1 ]; r[ 2 ] = te[ 2 ]; r[ 3 ] = te[ 3 ];\r\n\t\t\tr[ 4 ] = te[ 4 ]; r[ 5 ] = te[ 5 ]; r[ 6 ] = te[ 6 ]; r[ 7 ] = te[ 7 ];\r\n\t\t\tr[ 8 ]  = te[ 8 ]; r[ 9 ]  = te[ 9 ]; r[ 10 ] = te[ 10 ]; r[ 11 ] = te[ 11 ];\r\n\t\t\tr[ 12 ] = te[ 12 ]; r[ 13 ] = te[ 13 ]; r[ 14 ] = te[ 14 ]; r[ 15 ] = te[ 15 ];\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tmultiplyScalar: function ( s ) {\r\n\t\r\n\t\t\tvar te = this.elements;\r\n\t\r\n\t\t\tte[ 0 ] *= s; te[ 4 ] *= s; te[ 8 ] *= s; te[ 12 ] *= s;\r\n\t\t\tte[ 1 ] *= s; te[ 5 ] *= s; te[ 9 ] *= s; te[ 13 ] *= s;\r\n\t\t\tte[ 2 ] *= s; te[ 6 ] *= s; te[ 10 ] *= s; te[ 14 ] *= s;\r\n\t\t\tte[ 3 ] *= s; te[ 7 ] *= s; te[ 11 ] *= s; te[ 15 ] *= s;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tmultiplyVector3: function ( vector ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead.' );\r\n\t\t\treturn vector.applyProjection( this );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tmultiplyVector4: function ( vector ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.' );\r\n\t\t\treturn vector.applyMatrix4( this );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tmultiplyVector3Array: function ( a ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.' );\r\n\t\t\treturn this.applyToVector3Array( a );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tapplyToVector3Array: function () {\r\n\t\r\n\t\t\tvar v1;\r\n\t\r\n\t\t\treturn function ( array, offset, length ) {\r\n\t\r\n\t\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\t\t\t\tif ( offset === undefined ) offset = 0;\r\n\t\t\t\tif ( length === undefined ) length = array.length;\r\n\t\r\n\t\t\t\tfor ( var i = 0, j = offset; i < length; i += 3, j += 3 ) {\r\n\t\r\n\t\t\t\t\tv1.fromArray( array, j );\r\n\t\t\t\t\tv1.applyMatrix4( this );\r\n\t\t\t\t\tv1.toArray( array, j );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\treturn array;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tapplyToBuffer: function () {\r\n\t\r\n\t\t\tvar v1;\r\n\t\r\n\t\t\treturn function applyToBuffer( buffer, offset, length ) {\r\n\t\r\n\t\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\t\t\t\tif ( offset === undefined ) offset = 0;\r\n\t\t\t\tif ( length === undefined ) length = buffer.length / buffer.itemSize;\r\n\t\r\n\t\t\t\tfor ( var i = 0, j = offset; i < length; i ++, j ++ ) {\r\n\t\r\n\t\t\t\t\tv1.x = buffer.getX( j );\r\n\t\t\t\t\tv1.y = buffer.getY( j );\r\n\t\t\t\t\tv1.z = buffer.getZ( j );\r\n\t\r\n\t\t\t\t\tv1.applyMatrix4( this );\r\n\t\r\n\t\t\t\t\tbuffer.setXYZ( v1.x, v1.y, v1.z );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\treturn buffer;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\trotateAxis: function ( v ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.' );\r\n\t\r\n\t\t\tv.transformDirection( this );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcrossVector: function ( vector ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.' );\r\n\t\t\treturn vector.applyMatrix4( this );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tdeterminant: function () {\r\n\t\r\n\t\t\tvar te = this.elements;\r\n\t\r\n\t\t\tvar n11 = te[ 0 ], n12 = te[ 4 ], n13 = te[ 8 ], n14 = te[ 12 ];\r\n\t\t\tvar n21 = te[ 1 ], n22 = te[ 5 ], n23 = te[ 9 ], n24 = te[ 13 ];\r\n\t\t\tvar n31 = te[ 2 ], n32 = te[ 6 ], n33 = te[ 10 ], n34 = te[ 14 ];\r\n\t\t\tvar n41 = te[ 3 ], n42 = te[ 7 ], n43 = te[ 11 ], n44 = te[ 15 ];\r\n\t\r\n\t\t\t//TODO: make this more efficient\r\n\t\t\t//( based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm )\r\n\t\r\n\t\t\treturn (\r\n\t\t\t\tn41 * (\r\n\t\t\t\t\t+ n14 * n23 * n32\r\n\t\t\t\t\t - n13 * n24 * n32\r\n\t\t\t\t\t - n14 * n22 * n33\r\n\t\t\t\t\t + n12 * n24 * n33\r\n\t\t\t\t\t + n13 * n22 * n34\r\n\t\t\t\t\t - n12 * n23 * n34\r\n\t\t\t\t) +\r\n\t\t\t\tn42 * (\r\n\t\t\t\t\t+ n11 * n23 * n34\r\n\t\t\t\t\t - n11 * n24 * n33\r\n\t\t\t\t\t + n14 * n21 * n33\r\n\t\t\t\t\t - n13 * n21 * n34\r\n\t\t\t\t\t + n13 * n24 * n31\r\n\t\t\t\t\t - n14 * n23 * n31\r\n\t\t\t\t) +\r\n\t\t\t\tn43 * (\r\n\t\t\t\t\t+ n11 * n24 * n32\r\n\t\t\t\t\t - n11 * n22 * n34\r\n\t\t\t\t\t - n14 * n21 * n32\r\n\t\t\t\t\t + n12 * n21 * n34\r\n\t\t\t\t\t + n14 * n22 * n31\r\n\t\t\t\t\t - n12 * n24 * n31\r\n\t\t\t\t) +\r\n\t\t\t\tn44 * (\r\n\t\t\t\t\t- n13 * n22 * n31\r\n\t\t\t\t\t - n11 * n23 * n32\r\n\t\t\t\t\t + n11 * n22 * n33\r\n\t\t\t\t\t + n13 * n21 * n32\r\n\t\t\t\t\t - n12 * n21 * n33\r\n\t\t\t\t\t + n12 * n23 * n31\r\n\t\t\t\t)\r\n\t\r\n\t\t\t);\r\n\t\r\n\t\t},\r\n\t\r\n\t\ttranspose: function () {\r\n\t\r\n\t\t\tvar te = this.elements;\r\n\t\t\tvar tmp;\r\n\t\r\n\t\t\ttmp = te[ 1 ]; te[ 1 ] = te[ 4 ]; te[ 4 ] = tmp;\r\n\t\t\ttmp = te[ 2 ]; te[ 2 ] = te[ 8 ]; te[ 8 ] = tmp;\r\n\t\t\ttmp = te[ 6 ]; te[ 6 ] = te[ 9 ]; te[ 9 ] = tmp;\r\n\t\r\n\t\t\ttmp = te[ 3 ]; te[ 3 ] = te[ 12 ]; te[ 12 ] = tmp;\r\n\t\t\ttmp = te[ 7 ]; te[ 7 ] = te[ 13 ]; te[ 13 ] = tmp;\r\n\t\t\ttmp = te[ 11 ]; te[ 11 ] = te[ 14 ]; te[ 14 ] = tmp;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tflattenToArrayOffset: function ( array, offset ) {\r\n\t\r\n\t\t\tvar te = this.elements;\r\n\t\r\n\t\t\tarray[ offset ] = te[ 0 ];\r\n\t\t\tarray[ offset + 1 ] = te[ 1 ];\r\n\t\t\tarray[ offset + 2 ] = te[ 2 ];\r\n\t\t\tarray[ offset + 3 ] = te[ 3 ];\r\n\t\r\n\t\t\tarray[ offset + 4 ] = te[ 4 ];\r\n\t\t\tarray[ offset + 5 ] = te[ 5 ];\r\n\t\t\tarray[ offset + 6 ] = te[ 6 ];\r\n\t\t\tarray[ offset + 7 ] = te[ 7 ];\r\n\t\r\n\t\t\tarray[ offset + 8 ]  = te[ 8 ];\r\n\t\t\tarray[ offset + 9 ]  = te[ 9 ];\r\n\t\t\tarray[ offset + 10 ] = te[ 10 ];\r\n\t\t\tarray[ offset + 11 ] = te[ 11 ];\r\n\t\r\n\t\t\tarray[ offset + 12 ] = te[ 12 ];\r\n\t\t\tarray[ offset + 13 ] = te[ 13 ];\r\n\t\t\tarray[ offset + 14 ] = te[ 14 ];\r\n\t\t\tarray[ offset + 15 ] = te[ 15 ];\r\n\t\r\n\t\t\treturn array;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tgetPosition: function () {\r\n\t\r\n\t\t\tvar v1;\r\n\t\r\n\t\t\treturn function () {\r\n\t\r\n\t\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\t\t\t\tconsole.warn( 'THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.' );\r\n\t\r\n\t\t\t\tvar te = this.elements;\r\n\t\t\t\treturn v1.set( te[ 12 ], te[ 13 ], te[ 14 ] );\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tsetPosition: function ( v ) {\r\n\t\r\n\t\t\tvar te = this.elements;\r\n\t\r\n\t\t\tte[ 12 ] = v.x;\r\n\t\t\tte[ 13 ] = v.y;\r\n\t\t\tte[ 14 ] = v.z;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tgetInverse: function ( m, throwOnInvertible ) {\r\n\t\r\n\t\t\t// based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm\r\n\t\t\tvar te = this.elements;\r\n\t\t\tvar me = m.elements;\r\n\t\r\n\t\t\tvar n11 = me[ 0 ], n12 = me[ 4 ], n13 = me[ 8 ], n14 = me[ 12 ];\r\n\t\t\tvar n21 = me[ 1 ], n22 = me[ 5 ], n23 = me[ 9 ], n24 = me[ 13 ];\r\n\t\t\tvar n31 = me[ 2 ], n32 = me[ 6 ], n33 = me[ 10 ], n34 = me[ 14 ];\r\n\t\t\tvar n41 = me[ 3 ], n42 = me[ 7 ], n43 = me[ 11 ], n44 = me[ 15 ];\r\n\t\r\n\t\t\tte[ 0 ] = n23 * n34 * n42 - n24 * n33 * n42 + n24 * n32 * n43 - n22 * n34 * n43 - n23 * n32 * n44 + n22 * n33 * n44;\r\n\t\t\tte[ 4 ] = n14 * n33 * n42 - n13 * n34 * n42 - n14 * n32 * n43 + n12 * n34 * n43 + n13 * n32 * n44 - n12 * n33 * n44;\r\n\t\t\tte[ 8 ] = n13 * n24 * n42 - n14 * n23 * n42 + n14 * n22 * n43 - n12 * n24 * n43 - n13 * n22 * n44 + n12 * n23 * n44;\r\n\t\t\tte[ 12 ] = n14 * n23 * n32 - n13 * n24 * n32 - n14 * n22 * n33 + n12 * n24 * n33 + n13 * n22 * n34 - n12 * n23 * n34;\r\n\t\t\tte[ 1 ] = n24 * n33 * n41 - n23 * n34 * n41 - n24 * n31 * n43 + n21 * n34 * n43 + n23 * n31 * n44 - n21 * n33 * n44;\r\n\t\t\tte[ 5 ] = n13 * n34 * n41 - n14 * n33 * n41 + n14 * n31 * n43 - n11 * n34 * n43 - n13 * n31 * n44 + n11 * n33 * n44;\r\n\t\t\tte[ 9 ] = n14 * n23 * n41 - n13 * n24 * n41 - n14 * n21 * n43 + n11 * n24 * n43 + n13 * n21 * n44 - n11 * n23 * n44;\r\n\t\t\tte[ 13 ] = n13 * n24 * n31 - n14 * n23 * n31 + n14 * n21 * n33 - n11 * n24 * n33 - n13 * n21 * n34 + n11 * n23 * n34;\r\n\t\t\tte[ 2 ] = n22 * n34 * n41 - n24 * n32 * n41 + n24 * n31 * n42 - n21 * n34 * n42 - n22 * n31 * n44 + n21 * n32 * n44;\r\n\t\t\tte[ 6 ] = n14 * n32 * n41 - n12 * n34 * n41 - n14 * n31 * n42 + n11 * n34 * n42 + n12 * n31 * n44 - n11 * n32 * n44;\r\n\t\t\tte[ 10 ] = n12 * n24 * n41 - n14 * n22 * n41 + n14 * n21 * n42 - n11 * n24 * n42 - n12 * n21 * n44 + n11 * n22 * n44;\r\n\t\t\tte[ 14 ] = n14 * n22 * n31 - n12 * n24 * n31 - n14 * n21 * n32 + n11 * n24 * n32 + n12 * n21 * n34 - n11 * n22 * n34;\r\n\t\t\tte[ 3 ] = n23 * n32 * n41 - n22 * n33 * n41 - n23 * n31 * n42 + n21 * n33 * n42 + n22 * n31 * n43 - n21 * n32 * n43;\r\n\t\t\tte[ 7 ] = n12 * n33 * n41 - n13 * n32 * n41 + n13 * n31 * n42 - n11 * n33 * n42 - n12 * n31 * n43 + n11 * n32 * n43;\r\n\t\t\tte[ 11 ] = n13 * n22 * n41 - n12 * n23 * n41 - n13 * n21 * n42 + n11 * n23 * n42 + n12 * n21 * n43 - n11 * n22 * n43;\r\n\t\t\tte[ 15 ] = n12 * n23 * n31 - n13 * n22 * n31 + n13 * n21 * n32 - n11 * n23 * n32 - n12 * n21 * n33 + n11 * n22 * n33;\r\n\t\r\n\t\t\tvar det = n11 * te[ 0 ] + n21 * te[ 4 ] + n31 * te[ 8 ] + n41 * te[ 12 ];\r\n\t\r\n\t\t\tif ( det === 0 ) {\r\n\t\r\n\t\t\t\tvar msg = \"THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0\";\r\n\t\r\n\t\t\t\tif ( throwOnInvertible || false ) {\r\n\t\r\n\t\t\t\t\tthrow new Error( msg );\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tconsole.warn( msg );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tthis.identity();\r\n\t\r\n\t\t\t\treturn this;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tthis.multiplyScalar( 1 / det );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\ttranslate: function ( v ) {\r\n\t\r\n\t\t\tconsole.error( 'THREE.Matrix4: .translate() has been removed.' );\r\n\t\r\n\t\t},\r\n\t\r\n\t\trotateX: function ( angle ) {\r\n\t\r\n\t\t\tconsole.error( 'THREE.Matrix4: .rotateX() has been removed.' );\r\n\t\r\n\t\t},\r\n\t\r\n\t\trotateY: function ( angle ) {\r\n\t\r\n\t\t\tconsole.error( 'THREE.Matrix4: .rotateY() has been removed.' );\r\n\t\r\n\t\t},\r\n\t\r\n\t\trotateZ: function ( angle ) {\r\n\t\r\n\t\t\tconsole.error( 'THREE.Matrix4: .rotateZ() has been removed.' );\r\n\t\r\n\t\t},\r\n\t\r\n\t\trotateByAxis: function ( axis, angle ) {\r\n\t\r\n\t\t\tconsole.error( 'THREE.Matrix4: .rotateByAxis() has been removed.' );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tscale: function ( v ) {\r\n\t\r\n\t\t\tvar te = this.elements;\r\n\t\t\tvar x = v.x, y = v.y, z = v.z;\r\n\t\r\n\t\t\tte[ 0 ] *= x; te[ 4 ] *= y; te[ 8 ] *= z;\r\n\t\t\tte[ 1 ] *= x; te[ 5 ] *= y; te[ 9 ] *= z;\r\n\t\t\tte[ 2 ] *= x; te[ 6 ] *= y; te[ 10 ] *= z;\r\n\t\t\tte[ 3 ] *= x; te[ 7 ] *= y; te[ 11 ] *= z;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tgetMaxScaleOnAxis: function () {\r\n\t\r\n\t\t\tvar te = this.elements;\r\n\t\r\n\t\t\tvar scaleXSq = te[ 0 ] * te[ 0 ] + te[ 1 ] * te[ 1 ] + te[ 2 ] * te[ 2 ];\r\n\t\t\tvar scaleYSq = te[ 4 ] * te[ 4 ] + te[ 5 ] * te[ 5 ] + te[ 6 ] * te[ 6 ];\r\n\t\t\tvar scaleZSq = te[ 8 ] * te[ 8 ] + te[ 9 ] * te[ 9 ] + te[ 10 ] * te[ 10 ];\r\n\t\r\n\t\t\treturn Math.sqrt( Math.max( scaleXSq, scaleYSq, scaleZSq ) );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tmakeTranslation: function ( x, y, z ) {\r\n\t\r\n\t\t\tthis.set(\r\n\t\r\n\t\t\t\t1, 0, 0, x,\r\n\t\t\t\t0, 1, 0, y,\r\n\t\t\t\t0, 0, 1, z,\r\n\t\t\t\t0, 0, 0, 1\r\n\t\r\n\t\t\t);\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tmakeRotationX: function ( theta ) {\r\n\t\r\n\t\t\tvar c = Math.cos( theta ), s = Math.sin( theta );\r\n\t\r\n\t\t\tthis.set(\r\n\t\r\n\t\t\t\t1, 0,  0, 0,\r\n\t\t\t\t0, c, - s, 0,\r\n\t\t\t\t0, s,  c, 0,\r\n\t\t\t\t0, 0,  0, 1\r\n\t\r\n\t\t\t);\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tmakeRotationY: function ( theta ) {\r\n\t\r\n\t\t\tvar c = Math.cos( theta ), s = Math.sin( theta );\r\n\t\r\n\t\t\tthis.set(\r\n\t\r\n\t\t\t\t c, 0, s, 0,\r\n\t\t\t\t 0, 1, 0, 0,\r\n\t\t\t\t- s, 0, c, 0,\r\n\t\t\t\t 0, 0, 0, 1\r\n\t\r\n\t\t\t);\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tmakeRotationZ: function ( theta ) {\r\n\t\r\n\t\t\tvar c = Math.cos( theta ), s = Math.sin( theta );\r\n\t\r\n\t\t\tthis.set(\r\n\t\r\n\t\t\t\tc, - s, 0, 0,\r\n\t\t\t\ts,  c, 0, 0,\r\n\t\t\t\t0,  0, 1, 0,\r\n\t\t\t\t0,  0, 0, 1\r\n\t\r\n\t\t\t);\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tmakeRotationAxis: function ( axis, angle ) {\r\n\t\r\n\t\t\t// Based on http://www.gamedev.net/reference/articles/article1199.asp\r\n\t\r\n\t\t\tvar c = Math.cos( angle );\r\n\t\t\tvar s = Math.sin( angle );\r\n\t\t\tvar t = 1 - c;\r\n\t\t\tvar x = axis.x, y = axis.y, z = axis.z;\r\n\t\t\tvar tx = t * x, ty = t * y;\r\n\t\r\n\t\t\tthis.set(\r\n\t\r\n\t\t\t\ttx * x + c, tx * y - s * z, tx * z + s * y, 0,\r\n\t\t\t\ttx * y + s * z, ty * y + c, ty * z - s * x, 0,\r\n\t\t\t\ttx * z - s * y, ty * z + s * x, t * z * z + c, 0,\r\n\t\t\t\t0, 0, 0, 1\r\n\t\r\n\t\t\t);\r\n\t\r\n\t\t\t return this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tmakeScale: function ( x, y, z ) {\r\n\t\r\n\t\t\tthis.set(\r\n\t\r\n\t\t\t\tx, 0, 0, 0,\r\n\t\t\t\t0, y, 0, 0,\r\n\t\t\t\t0, 0, z, 0,\r\n\t\t\t\t0, 0, 0, 1\r\n\t\r\n\t\t\t);\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcompose: function ( position, quaternion, scale ) {\r\n\t\r\n\t\t\tthis.makeRotationFromQuaternion( quaternion );\r\n\t\t\tthis.scale( scale );\r\n\t\t\tthis.setPosition( position );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tdecompose: function () {\r\n\t\r\n\t\t\tvar vector, matrix;\r\n\t\r\n\t\t\treturn function ( position, quaternion, scale ) {\r\n\t\r\n\t\t\t\tif ( vector === undefined ) vector = new THREE.Vector3();\r\n\t\t\t\tif ( matrix === undefined ) matrix = new THREE.Matrix4();\r\n\t\r\n\t\t\t\tvar te = this.elements;\r\n\t\r\n\t\t\t\tvar sx = vector.set( te[ 0 ], te[ 1 ], te[ 2 ] ).length();\r\n\t\t\t\tvar sy = vector.set( te[ 4 ], te[ 5 ], te[ 6 ] ).length();\r\n\t\t\t\tvar sz = vector.set( te[ 8 ], te[ 9 ], te[ 10 ] ).length();\r\n\t\r\n\t\t\t\t// if determine is negative, we need to invert one scale\r\n\t\t\t\tvar det = this.determinant();\r\n\t\t\t\tif ( det < 0 ) {\r\n\t\r\n\t\t\t\t\tsx = - sx;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tposition.x = te[ 12 ];\r\n\t\t\t\tposition.y = te[ 13 ];\r\n\t\t\t\tposition.z = te[ 14 ];\r\n\t\r\n\t\t\t\t// scale the rotation part\r\n\t\r\n\t\t\t\tmatrix.elements.set( this.elements ); // at this point matrix is incomplete so we can't use .copy()\r\n\t\r\n\t\t\t\tvar invSX = 1 / sx;\r\n\t\t\t\tvar invSY = 1 / sy;\r\n\t\t\t\tvar invSZ = 1 / sz;\r\n\t\r\n\t\t\t\tmatrix.elements[ 0 ] *= invSX;\r\n\t\t\t\tmatrix.elements[ 1 ] *= invSX;\r\n\t\t\t\tmatrix.elements[ 2 ] *= invSX;\r\n\t\r\n\t\t\t\tmatrix.elements[ 4 ] *= invSY;\r\n\t\t\t\tmatrix.elements[ 5 ] *= invSY;\r\n\t\t\t\tmatrix.elements[ 6 ] *= invSY;\r\n\t\r\n\t\t\t\tmatrix.elements[ 8 ] *= invSZ;\r\n\t\t\t\tmatrix.elements[ 9 ] *= invSZ;\r\n\t\t\t\tmatrix.elements[ 10 ] *= invSZ;\r\n\t\r\n\t\t\t\tquaternion.setFromRotationMatrix( matrix );\r\n\t\r\n\t\t\t\tscale.x = sx;\r\n\t\t\t\tscale.y = sy;\r\n\t\t\t\tscale.z = sz;\r\n\t\r\n\t\t\t\treturn this;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tmakeFrustum: function ( left, right, bottom, top, near, far ) {\r\n\t\r\n\t\t\tvar te = this.elements;\r\n\t\t\tvar x = 2 * near / ( right - left );\r\n\t\t\tvar y = 2 * near / ( top - bottom );\r\n\t\r\n\t\t\tvar a = ( right + left ) / ( right - left );\r\n\t\t\tvar b = ( top + bottom ) / ( top - bottom );\r\n\t\t\tvar c = - ( far + near ) / ( far - near );\r\n\t\t\tvar d = - 2 * far * near / ( far - near );\r\n\t\r\n\t\t\tte[ 0 ] = x;\tte[ 4 ] = 0;\tte[ 8 ] = a;\tte[ 12 ] = 0;\r\n\t\t\tte[ 1 ] = 0;\tte[ 5 ] = y;\tte[ 9 ] = b;\tte[ 13 ] = 0;\r\n\t\t\tte[ 2 ] = 0;\tte[ 6 ] = 0;\tte[ 10 ] = c;\tte[ 14 ] = d;\r\n\t\t\tte[ 3 ] = 0;\tte[ 7 ] = 0;\tte[ 11 ] = - 1;\tte[ 15 ] = 0;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tmakePerspective: function ( fov, aspect, near, far ) {\r\n\t\r\n\t\t\tvar ymax = near * Math.tan( THREE.Math.degToRad( fov * 0.5 ) );\r\n\t\t\tvar ymin = - ymax;\r\n\t\t\tvar xmin = ymin * aspect;\r\n\t\t\tvar xmax = ymax * aspect;\r\n\t\r\n\t\t\treturn this.makeFrustum( xmin, xmax, ymin, ymax, near, far );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tmakeOrthographic: function ( left, right, top, bottom, near, far ) {\r\n\t\r\n\t\t\tvar te = this.elements;\r\n\t\t\tvar w = right - left;\r\n\t\t\tvar h = top - bottom;\r\n\t\t\tvar p = far - near;\r\n\t\r\n\t\t\tvar x = ( right + left ) / w;\r\n\t\t\tvar y = ( top + bottom ) / h;\r\n\t\t\tvar z = ( far + near ) / p;\r\n\t\r\n\t\t\tte[ 0 ] = 2 / w;\tte[ 4 ] = 0;\tte[ 8 ] = 0;\tte[ 12 ] = - x;\r\n\t\t\tte[ 1 ] = 0;\tte[ 5 ] = 2 / h;\tte[ 9 ] = 0;\tte[ 13 ] = - y;\r\n\t\t\tte[ 2 ] = 0;\tte[ 6 ] = 0;\tte[ 10 ] = - 2 / p;\tte[ 14 ] = - z;\r\n\t\t\tte[ 3 ] = 0;\tte[ 7 ] = 0;\tte[ 11 ] = 0;\tte[ 15 ] = 1;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tequals: function ( matrix ) {\r\n\t\r\n\t\t\tvar te = this.elements;\r\n\t\t\tvar me = matrix.elements;\r\n\t\r\n\t\t\tfor ( var i = 0; i < 16; i ++ ) {\r\n\t\r\n\t\t\t\tif ( te[ i ] !== me[ i ] ) return false;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn true;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tfromArray: function ( array ) {\r\n\t\r\n\t\t\tthis.elements.set( array );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\ttoArray: function () {\r\n\t\r\n\t\t\tvar te = this.elements;\r\n\t\r\n\t\t\treturn [\r\n\t\t\t\tte[ 0 ], te[ 1 ], te[ 2 ], te[ 3 ],\r\n\t\t\t\tte[ 4 ], te[ 5 ], te[ 6 ], te[ 7 ],\r\n\t\t\t\tte[ 8 ], te[ 9 ], te[ 10 ], te[ 11 ],\r\n\t\t\t\tte[ 12 ], te[ 13 ], te[ 14 ], te[ 15 ]\r\n\t\t\t];\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/math/Ray.js\r\n\t\r\n\t/**\r\n\t * @author bhouston / http://clara.io\r\n\t */\r\n\t\r\n\tTHREE.Ray = function ( origin, direction ) {\r\n\t\r\n\t\tthis.origin = ( origin !== undefined ) ? origin : new THREE.Vector3();\r\n\t\tthis.direction = ( direction !== undefined ) ? direction : new THREE.Vector3();\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Ray.prototype = {\r\n\t\r\n\t\tconstructor: THREE.Ray,\r\n\t\r\n\t\tset: function ( origin, direction ) {\r\n\t\r\n\t\t\tthis.origin.copy( origin );\r\n\t\t\tthis.direction.copy( direction );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tclone: function () {\r\n\t\r\n\t\t\treturn new this.constructor().copy( this );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcopy: function ( ray ) {\r\n\t\r\n\t\t\tthis.origin.copy( ray.origin );\r\n\t\t\tthis.direction.copy( ray.direction );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tat: function ( t, optionalTarget ) {\r\n\t\r\n\t\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\r\n\t\t\treturn result.copy( this.direction ).multiplyScalar( t ).add( this.origin );\r\n\t\r\n\t\t},\r\n\t\r\n\t\trecast: function () {\r\n\t\r\n\t\t\tvar v1 = new THREE.Vector3();\r\n\t\r\n\t\t\treturn function ( t ) {\r\n\t\r\n\t\t\t\tthis.origin.copy( this.at( t, v1 ) );\r\n\t\r\n\t\t\t\treturn this;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tclosestPointToPoint: function ( point, optionalTarget ) {\r\n\t\r\n\t\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\t\tresult.subVectors( point, this.origin );\r\n\t\t\tvar directionDistance = result.dot( this.direction );\r\n\t\r\n\t\t\tif ( directionDistance < 0 ) {\r\n\t\r\n\t\t\t\treturn result.copy( this.origin );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn result.copy( this.direction ).multiplyScalar( directionDistance ).add( this.origin );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tdistanceToPoint: function ( point ) {\r\n\t\r\n\t\t\treturn Math.sqrt( this.distanceSqToPoint( point ) );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tdistanceSqToPoint: function () {\r\n\t\r\n\t\t\tvar v1 = new THREE.Vector3();\r\n\t\r\n\t\t\treturn function ( point ) {\r\n\t\r\n\t\t\t\tvar directionDistance = v1.subVectors( point, this.origin ).dot( this.direction );\r\n\t\r\n\t\t\t\t// point behind the ray\r\n\t\r\n\t\t\t\tif ( directionDistance < 0 ) {\r\n\t\r\n\t\t\t\t\treturn this.origin.distanceToSquared( point );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tv1.copy( this.direction ).multiplyScalar( directionDistance ).add( this.origin );\r\n\t\r\n\t\t\t\treturn v1.distanceToSquared( point );\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tdistanceSqToSegment: function () {\r\n\t\r\n\t\t\tvar segCenter = new THREE.Vector3();\r\n\t\t\tvar segDir = new THREE.Vector3();\r\n\t\t\tvar diff = new THREE.Vector3();\r\n\t\r\n\t\t\treturn function ( v0, v1, optionalPointOnRay, optionalPointOnSegment ) {\r\n\t\r\n\t\t\t\t// from http://www.geometrictools.com/LibMathematics/Distance/Wm5DistRay3Segment3.cpp\r\n\t\t\t\t// It returns the min distance between the ray and the segment\r\n\t\t\t\t// defined by v0 and v1\r\n\t\t\t\t// It can also set two optional targets :\r\n\t\t\t\t// - The closest point on the ray\r\n\t\t\t\t// - The closest point on the segment\r\n\t\r\n\t\t\t\tsegCenter.copy( v0 ).add( v1 ).multiplyScalar( 0.5 );\r\n\t\t\t\tsegDir.copy( v1 ).sub( v0 ).normalize();\r\n\t\t\t\tdiff.copy( this.origin ).sub( segCenter );\r\n\t\r\n\t\t\t\tvar segExtent = v0.distanceTo( v1 ) * 0.5;\r\n\t\t\t\tvar a01 = - this.direction.dot( segDir );\r\n\t\t\t\tvar b0 = diff.dot( this.direction );\r\n\t\t\t\tvar b1 = - diff.dot( segDir );\r\n\t\t\t\tvar c = diff.lengthSq();\r\n\t\t\t\tvar det = Math.abs( 1 - a01 * a01 );\r\n\t\t\t\tvar s0, s1, sqrDist, extDet;\r\n\t\r\n\t\t\t\tif ( det > 0 ) {\r\n\t\r\n\t\t\t\t\t// The ray and segment are not parallel.\r\n\t\r\n\t\t\t\t\ts0 = a01 * b1 - b0;\r\n\t\t\t\t\ts1 = a01 * b0 - b1;\r\n\t\t\t\t\textDet = segExtent * det;\r\n\t\r\n\t\t\t\t\tif ( s0 >= 0 ) {\r\n\t\r\n\t\t\t\t\t\tif ( s1 >= - extDet ) {\r\n\t\r\n\t\t\t\t\t\t\tif ( s1 <= extDet ) {\r\n\t\r\n\t\t\t\t\t\t\t\t// region 0\r\n\t\t\t\t\t\t\t\t// Minimum at interior points of ray and segment.\r\n\t\r\n\t\t\t\t\t\t\t\tvar invDet = 1 / det;\r\n\t\t\t\t\t\t\t\ts0 *= invDet;\r\n\t\t\t\t\t\t\t\ts1 *= invDet;\r\n\t\t\t\t\t\t\t\tsqrDist = s0 * ( s0 + a01 * s1 + 2 * b0 ) + s1 * ( a01 * s0 + s1 + 2 * b1 ) + c;\r\n\t\r\n\t\t\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\t\t\t// region 1\r\n\t\r\n\t\t\t\t\t\t\t\ts1 = segExtent;\r\n\t\t\t\t\t\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\r\n\t\t\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\r\n\t\r\n\t\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\t\t// region 5\r\n\t\r\n\t\t\t\t\t\t\ts1 = - segExtent;\r\n\t\t\t\t\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\r\n\t\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\tif ( s1 <= - extDet ) {\r\n\t\r\n\t\t\t\t\t\t\t// region 4\r\n\t\r\n\t\t\t\t\t\t\ts0 = Math.max( 0, - ( - a01 * segExtent + b0 ) );\r\n\t\t\t\t\t\t\ts1 = ( s0 > 0 ) ? - segExtent : Math.min( Math.max( - segExtent, - b1 ), segExtent );\r\n\t\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\r\n\t\r\n\t\t\t\t\t\t} else if ( s1 <= extDet ) {\r\n\t\r\n\t\t\t\t\t\t\t// region 3\r\n\t\r\n\t\t\t\t\t\t\ts0 = 0;\r\n\t\t\t\t\t\t\ts1 = Math.min( Math.max( - segExtent, - b1 ), segExtent );\r\n\t\t\t\t\t\t\tsqrDist = s1 * ( s1 + 2 * b1 ) + c;\r\n\t\r\n\t\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\t\t// region 2\r\n\t\r\n\t\t\t\t\t\t\ts0 = Math.max( 0, - ( a01 * segExtent + b0 ) );\r\n\t\t\t\t\t\t\ts1 = ( s0 > 0 ) ? segExtent : Math.min( Math.max( - segExtent, - b1 ), segExtent );\r\n\t\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t// Ray and segment are parallel.\r\n\t\r\n\t\t\t\t\ts1 = ( a01 > 0 ) ? - segExtent : segExtent;\r\n\t\t\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\r\n\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( optionalPointOnRay ) {\r\n\t\r\n\t\t\t\t\toptionalPointOnRay.copy( this.direction ).multiplyScalar( s0 ).add( this.origin );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( optionalPointOnSegment ) {\r\n\t\r\n\t\t\t\t\toptionalPointOnSegment.copy( segDir ).multiplyScalar( s1 ).add( segCenter );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\treturn sqrDist;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\r\n\t\tisIntersectionSphere: function ( sphere ) {\r\n\t\r\n\t\t\treturn this.distanceToPoint( sphere.center ) <= sphere.radius;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tintersectSphere: function () {\r\n\t\r\n\t\t\t// from http://www.scratchapixel.com/lessons/3d-basic-lessons/lesson-7-intersecting-simple-shapes/ray-sphere-intersection/\r\n\t\r\n\t\t\tvar v1 = new THREE.Vector3();\r\n\t\r\n\t\t\treturn function ( sphere, optionalTarget ) {\r\n\t\r\n\t\t\t\tv1.subVectors( sphere.center, this.origin );\r\n\t\r\n\t\t\t\tvar tca = v1.dot( this.direction );\r\n\t\r\n\t\t\t\tvar d2 = v1.dot( v1 ) - tca * tca;\r\n\t\r\n\t\t\t\tvar radius2 = sphere.radius * sphere.radius;\r\n\t\r\n\t\t\t\tif ( d2 > radius2 ) return null;\r\n\t\r\n\t\t\t\tvar thc = Math.sqrt( radius2 - d2 );\r\n\t\r\n\t\t\t\t// t0 = first intersect point - entrance on front of sphere\r\n\t\t\t\tvar t0 = tca - thc;\r\n\t\r\n\t\t\t\t// t1 = second intersect point - exit point on back of sphere\r\n\t\t\t\tvar t1 = tca + thc;\r\n\t\r\n\t\t\t\t// test to see if both t0 and t1 are behind the ray - if so, return null\r\n\t\t\t\tif ( t0 < 0 && t1 < 0 ) return null;\r\n\t\r\n\t\t\t\t// test to see if t0 is behind the ray:\r\n\t\t\t\t// if it is, the ray is inside the sphere, so return the second exit point scaled by t1,\r\n\t\t\t\t// in order to always return an intersect point that is in front of the ray.\r\n\t\t\t\tif ( t0 < 0 ) return this.at( t1, optionalTarget );\r\n\t\r\n\t\t\t\t// else t0 is in front of the ray, so return the first collision point scaled by t0\r\n\t\t\t\treturn this.at( t0, optionalTarget );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tisIntersectionPlane: function ( plane ) {\r\n\t\r\n\t\t\t// check if the ray lies on the plane first\r\n\t\r\n\t\t\tvar distToPoint = plane.distanceToPoint( this.origin );\r\n\t\r\n\t\t\tif ( distToPoint === 0 ) {\r\n\t\r\n\t\t\t\treturn true;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar denominator = plane.normal.dot( this.direction );\r\n\t\r\n\t\t\tif ( denominator * distToPoint < 0 ) {\r\n\t\r\n\t\t\t\treturn true;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// ray origin is behind the plane (and is pointing behind it)\r\n\t\r\n\t\t\treturn false;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tdistanceToPlane: function ( plane ) {\r\n\t\r\n\t\t\tvar denominator = plane.normal.dot( this.direction );\r\n\t\t\tif ( denominator === 0 ) {\r\n\t\r\n\t\t\t\t// line is coplanar, return origin\r\n\t\t\t\tif ( plane.distanceToPoint( this.origin ) === 0 ) {\r\n\t\r\n\t\t\t\t\treturn 0;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\t// Null is preferable to undefined since undefined means.... it is undefined\r\n\t\r\n\t\t\t\treturn null;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar t = - ( this.origin.dot( plane.normal ) + plane.constant ) / denominator;\r\n\t\r\n\t\t\t// Return if the ray never intersects the plane\r\n\t\r\n\t\t\treturn t >= 0 ? t :  null;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tintersectPlane: function ( plane, optionalTarget ) {\r\n\t\r\n\t\t\tvar t = this.distanceToPlane( plane );\r\n\t\r\n\t\t\tif ( t === null ) {\r\n\t\r\n\t\t\t\treturn null;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn this.at( t, optionalTarget );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tisIntersectionBox: function () {\r\n\t\r\n\t\t\tvar v = new THREE.Vector3();\r\n\t\r\n\t\t\treturn function ( box ) {\r\n\t\r\n\t\t\t\treturn this.intersectBox( box, v ) !== null;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tintersectBox: function ( box, optionalTarget ) {\r\n\t\r\n\t\t\t// http://www.scratchapixel.com/lessons/3d-basic-lessons/lesson-7-intersecting-simple-shapes/ray-box-intersection/\r\n\t\r\n\t\t\tvar tmin, tmax, tymin, tymax, tzmin, tzmax;\r\n\t\r\n\t\t\tvar invdirx = 1 / this.direction.x,\r\n\t\t\t\tinvdiry = 1 / this.direction.y,\r\n\t\t\t\tinvdirz = 1 / this.direction.z;\r\n\t\r\n\t\t\tvar origin = this.origin;\r\n\t\r\n\t\t\tif ( invdirx >= 0 ) {\r\n\t\r\n\t\t\t\ttmin = ( box.min.x - origin.x ) * invdirx;\r\n\t\t\t\ttmax = ( box.max.x - origin.x ) * invdirx;\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\ttmin = ( box.max.x - origin.x ) * invdirx;\r\n\t\t\t\ttmax = ( box.min.x - origin.x ) * invdirx;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( invdiry >= 0 ) {\r\n\t\r\n\t\t\t\ttymin = ( box.min.y - origin.y ) * invdiry;\r\n\t\t\t\ttymax = ( box.max.y - origin.y ) * invdiry;\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\ttymin = ( box.max.y - origin.y ) * invdiry;\r\n\t\t\t\ttymax = ( box.min.y - origin.y ) * invdiry;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( ( tmin > tymax ) || ( tymin > tmax ) ) return null;\r\n\t\r\n\t\t\t// These lines also handle the case where tmin or tmax is NaN\r\n\t\t\t// (result of 0 * Infinity). x !== x returns true if x is NaN\r\n\t\r\n\t\t\tif ( tymin > tmin || tmin !== tmin ) tmin = tymin;\r\n\t\r\n\t\t\tif ( tymax < tmax || tmax !== tmax ) tmax = tymax;\r\n\t\r\n\t\t\tif ( invdirz >= 0 ) {\r\n\t\r\n\t\t\t\ttzmin = ( box.min.z - origin.z ) * invdirz;\r\n\t\t\t\ttzmax = ( box.max.z - origin.z ) * invdirz;\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\ttzmin = ( box.max.z - origin.z ) * invdirz;\r\n\t\t\t\ttzmax = ( box.min.z - origin.z ) * invdirz;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( ( tmin > tzmax ) || ( tzmin > tmax ) ) return null;\r\n\t\r\n\t\t\tif ( tzmin > tmin || tmin !== tmin ) tmin = tzmin;\r\n\t\r\n\t\t\tif ( tzmax < tmax || tmax !== tmax ) tmax = tzmax;\r\n\t\r\n\t\t\t//return point closest to the ray (positive side)\r\n\t\r\n\t\t\tif ( tmax < 0 ) return null;\r\n\t\r\n\t\t\treturn this.at( tmin >= 0 ? tmin : tmax, optionalTarget );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tintersectTriangle: function () {\r\n\t\r\n\t\t\t// Compute the offset origin, edges, and normal.\r\n\t\t\tvar diff = new THREE.Vector3();\r\n\t\t\tvar edge1 = new THREE.Vector3();\r\n\t\t\tvar edge2 = new THREE.Vector3();\r\n\t\t\tvar normal = new THREE.Vector3();\r\n\t\r\n\t\t\treturn function ( a, b, c, backfaceCulling, optionalTarget ) {\r\n\t\r\n\t\t\t\t// from http://www.geometrictools.com/LibMathematics/Intersection/Wm5IntrRay3Triangle3.cpp\r\n\t\r\n\t\t\t\tedge1.subVectors( b, a );\r\n\t\t\t\tedge2.subVectors( c, a );\r\n\t\t\t\tnormal.crossVectors( edge1, edge2 );\r\n\t\r\n\t\t\t\t// Solve Q + t*D = b1*E1 + b2*E2 (Q = kDiff, D = ray direction,\r\n\t\t\t\t// E1 = kEdge1, E2 = kEdge2, N = Cross(E1,E2)) by\r\n\t\t\t\t//   |Dot(D,N)|*b1 = sign(Dot(D,N))*Dot(D,Cross(Q,E2))\r\n\t\t\t\t//   |Dot(D,N)|*b2 = sign(Dot(D,N))*Dot(D,Cross(E1,Q))\r\n\t\t\t\t//   |Dot(D,N)|*t = -sign(Dot(D,N))*Dot(Q,N)\r\n\t\t\t\tvar DdN = this.direction.dot( normal );\r\n\t\t\t\tvar sign;\r\n\t\r\n\t\t\t\tif ( DdN > 0 ) {\r\n\t\r\n\t\t\t\t\tif ( backfaceCulling ) return null;\r\n\t\t\t\t\tsign = 1;\r\n\t\r\n\t\t\t\t} else if ( DdN < 0 ) {\r\n\t\r\n\t\t\t\t\tsign = - 1;\r\n\t\t\t\t\tDdN = - DdN;\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\treturn null;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tdiff.subVectors( this.origin, a );\r\n\t\t\t\tvar DdQxE2 = sign * this.direction.dot( edge2.crossVectors( diff, edge2 ) );\r\n\t\r\n\t\t\t\t// b1 < 0, no intersection\r\n\t\t\t\tif ( DdQxE2 < 0 ) {\r\n\t\r\n\t\t\t\t\treturn null;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tvar DdE1xQ = sign * this.direction.dot( edge1.cross( diff ) );\r\n\t\r\n\t\t\t\t// b2 < 0, no intersection\r\n\t\t\t\tif ( DdE1xQ < 0 ) {\r\n\t\r\n\t\t\t\t\treturn null;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\t// b1+b2 > 1, no intersection\r\n\t\t\t\tif ( DdQxE2 + DdE1xQ > DdN ) {\r\n\t\r\n\t\t\t\t\treturn null;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\t// Line intersects triangle, check if ray does.\r\n\t\t\t\tvar QdN = - sign * diff.dot( normal );\r\n\t\r\n\t\t\t\t// t < 0, no intersection\r\n\t\t\t\tif ( QdN < 0 ) {\r\n\t\r\n\t\t\t\t\treturn null;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\t// Ray intersects triangle.\r\n\t\t\t\treturn this.at( QdN / DdN, optionalTarget );\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tapplyMatrix4: function ( matrix4 ) {\r\n\t\r\n\t\t\tthis.direction.add( this.origin ).applyMatrix4( matrix4 );\r\n\t\t\tthis.origin.applyMatrix4( matrix4 );\r\n\t\t\tthis.direction.sub( this.origin );\r\n\t\t\tthis.direction.normalize();\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tequals: function ( ray ) {\r\n\t\r\n\t\t\treturn ray.origin.equals( this.origin ) && ray.direction.equals( this.direction );\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/math/Sphere.js\r\n\t\r\n\t/**\r\n\t * @author bhouston / http://clara.io\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.Sphere = function ( center, radius ) {\r\n\t\r\n\t\tthis.center = ( center !== undefined ) ? center : new THREE.Vector3();\r\n\t\tthis.radius = ( radius !== undefined ) ? radius : 0;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Sphere.prototype = {\r\n\t\r\n\t\tconstructor: THREE.Sphere,\r\n\t\r\n\t\tset: function ( center, radius ) {\r\n\t\r\n\t\t\tthis.center.copy( center );\r\n\t\t\tthis.radius = radius;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetFromPoints: function () {\r\n\t\r\n\t\t\tvar box = new THREE.Box3();\r\n\t\r\n\t\t\treturn function ( points, optionalCenter ) {\r\n\t\r\n\t\t\t\tvar center = this.center;\r\n\t\r\n\t\t\t\tif ( optionalCenter !== undefined ) {\r\n\t\r\n\t\t\t\t\tcenter.copy( optionalCenter );\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tbox.setFromPoints( points ).center( center );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tvar maxRadiusSq = 0;\r\n\t\r\n\t\t\t\tfor ( var i = 0, il = points.length; i < il; i ++ ) {\r\n\t\r\n\t\t\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( points[ i ] ) );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tthis.radius = Math.sqrt( maxRadiusSq );\r\n\t\r\n\t\t\t\treturn this;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tclone: function () {\r\n\t\r\n\t\t\treturn new this.constructor().copy( this );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcopy: function ( sphere ) {\r\n\t\r\n\t\t\tthis.center.copy( sphere.center );\r\n\t\t\tthis.radius = sphere.radius;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tempty: function () {\r\n\t\r\n\t\t\treturn ( this.radius <= 0 );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcontainsPoint: function ( point ) {\r\n\t\r\n\t\t\treturn ( point.distanceToSquared( this.center ) <= ( this.radius * this.radius ) );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tdistanceToPoint: function ( point ) {\r\n\t\r\n\t\t\treturn ( point.distanceTo( this.center ) - this.radius );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tintersectsSphere: function ( sphere ) {\r\n\t\r\n\t\t\tvar radiusSum = this.radius + sphere.radius;\r\n\t\r\n\t\t\treturn sphere.center.distanceToSquared( this.center ) <= ( radiusSum * radiusSum );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tclampPoint: function ( point, optionalTarget ) {\r\n\t\r\n\t\t\tvar deltaLengthSq = this.center.distanceToSquared( point );\r\n\t\r\n\t\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\t\tresult.copy( point );\r\n\t\r\n\t\t\tif ( deltaLengthSq > ( this.radius * this.radius ) ) {\r\n\t\r\n\t\t\t\tresult.sub( this.center ).normalize();\r\n\t\t\t\tresult.multiplyScalar( this.radius ).add( this.center );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn result;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tgetBoundingBox: function ( optionalTarget ) {\r\n\t\r\n\t\t\tvar box = optionalTarget || new THREE.Box3();\r\n\t\r\n\t\t\tbox.set( this.center, this.center );\r\n\t\t\tbox.expandByScalar( this.radius );\r\n\t\r\n\t\t\treturn box;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tapplyMatrix4: function ( matrix ) {\r\n\t\r\n\t\t\tthis.center.applyMatrix4( matrix );\r\n\t\t\tthis.radius = this.radius * matrix.getMaxScaleOnAxis();\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\ttranslate: function ( offset ) {\r\n\t\r\n\t\t\tthis.center.add( offset );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tequals: function ( sphere ) {\r\n\t\r\n\t\t\treturn sphere.center.equals( this.center ) && ( sphere.radius === this.radius );\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/math/Frustum.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author bhouston / http://clara.io\r\n\t */\r\n\t\r\n\tTHREE.Frustum = function ( p0, p1, p2, p3, p4, p5 ) {\r\n\t\r\n\t\tthis.planes = [\r\n\t\r\n\t\t\t( p0 !== undefined ) ? p0 : new THREE.Plane(),\r\n\t\t\t( p1 !== undefined ) ? p1 : new THREE.Plane(),\r\n\t\t\t( p2 !== undefined ) ? p2 : new THREE.Plane(),\r\n\t\t\t( p3 !== undefined ) ? p3 : new THREE.Plane(),\r\n\t\t\t( p4 !== undefined ) ? p4 : new THREE.Plane(),\r\n\t\t\t( p5 !== undefined ) ? p5 : new THREE.Plane()\r\n\t\r\n\t\t];\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Frustum.prototype = {\r\n\t\r\n\t\tconstructor: THREE.Frustum,\r\n\t\r\n\t\tset: function ( p0, p1, p2, p3, p4, p5 ) {\r\n\t\r\n\t\t\tvar planes = this.planes;\r\n\t\r\n\t\t\tplanes[ 0 ].copy( p0 );\r\n\t\t\tplanes[ 1 ].copy( p1 );\r\n\t\t\tplanes[ 2 ].copy( p2 );\r\n\t\t\tplanes[ 3 ].copy( p3 );\r\n\t\t\tplanes[ 4 ].copy( p4 );\r\n\t\t\tplanes[ 5 ].copy( p5 );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tclone: function () {\r\n\t\r\n\t\t\treturn new this.constructor().copy( this );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcopy: function ( frustum ) {\r\n\t\r\n\t\t\tvar planes = this.planes;\r\n\t\r\n\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\t\r\n\t\t\t\tplanes[ i ].copy( frustum.planes[ i ] );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetFromMatrix: function ( m ) {\r\n\t\r\n\t\t\tvar planes = this.planes;\r\n\t\t\tvar me = m.elements;\r\n\t\t\tvar me0 = me[ 0 ], me1 = me[ 1 ], me2 = me[ 2 ], me3 = me[ 3 ];\r\n\t\t\tvar me4 = me[ 4 ], me5 = me[ 5 ], me6 = me[ 6 ], me7 = me[ 7 ];\r\n\t\t\tvar me8 = me[ 8 ], me9 = me[ 9 ], me10 = me[ 10 ], me11 = me[ 11 ];\r\n\t\t\tvar me12 = me[ 12 ], me13 = me[ 13 ], me14 = me[ 14 ], me15 = me[ 15 ];\r\n\t\r\n\t\t\tplanes[ 0 ].setComponents( me3 - me0, me7 - me4, me11 - me8, me15 - me12 ).normalize();\r\n\t\t\tplanes[ 1 ].setComponents( me3 + me0, me7 + me4, me11 + me8, me15 + me12 ).normalize();\r\n\t\t\tplanes[ 2 ].setComponents( me3 + me1, me7 + me5, me11 + me9, me15 + me13 ).normalize();\r\n\t\t\tplanes[ 3 ].setComponents( me3 - me1, me7 - me5, me11 - me9, me15 - me13 ).normalize();\r\n\t\t\tplanes[ 4 ].setComponents( me3 - me2, me7 - me6, me11 - me10, me15 - me14 ).normalize();\r\n\t\t\tplanes[ 5 ].setComponents( me3 + me2, me7 + me6, me11 + me10, me15 + me14 ).normalize();\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tintersectsObject: function () {\r\n\t\r\n\t\t\tvar sphere = new THREE.Sphere();\r\n\t\r\n\t\t\treturn function ( object ) {\r\n\t\r\n\t\t\t\tvar geometry = object.geometry;\r\n\t\r\n\t\t\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\r\n\t\r\n\t\t\t\tsphere.copy( geometry.boundingSphere );\r\n\t\t\t\tsphere.applyMatrix4( object.matrixWorld );\r\n\t\r\n\t\t\t\treturn this.intersectsSphere( sphere );\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tintersectsSphere: function ( sphere ) {\r\n\t\r\n\t\t\tvar planes = this.planes;\r\n\t\t\tvar center = sphere.center;\r\n\t\t\tvar negRadius = - sphere.radius;\r\n\t\r\n\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\t\r\n\t\t\t\tvar distance = planes[ i ].distanceToPoint( center );\r\n\t\r\n\t\t\t\tif ( distance < negRadius ) {\r\n\t\r\n\t\t\t\t\treturn false;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn true;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tintersectsBox: function () {\r\n\t\r\n\t\t\tvar p1 = new THREE.Vector3(),\r\n\t\t\t\tp2 = new THREE.Vector3();\r\n\t\r\n\t\t\treturn function ( box ) {\r\n\t\r\n\t\t\t\tvar planes = this.planes;\r\n\t\r\n\t\t\t\tfor ( var i = 0; i < 6 ; i ++ ) {\r\n\t\r\n\t\t\t\t\tvar plane = planes[ i ];\r\n\t\r\n\t\t\t\t\tp1.x = plane.normal.x > 0 ? box.min.x : box.max.x;\r\n\t\t\t\t\tp2.x = plane.normal.x > 0 ? box.max.x : box.min.x;\r\n\t\t\t\t\tp1.y = plane.normal.y > 0 ? box.min.y : box.max.y;\r\n\t\t\t\t\tp2.y = plane.normal.y > 0 ? box.max.y : box.min.y;\r\n\t\t\t\t\tp1.z = plane.normal.z > 0 ? box.min.z : box.max.z;\r\n\t\t\t\t\tp2.z = plane.normal.z > 0 ? box.max.z : box.min.z;\r\n\t\r\n\t\t\t\t\tvar d1 = plane.distanceToPoint( p1 );\r\n\t\t\t\t\tvar d2 = plane.distanceToPoint( p2 );\r\n\t\r\n\t\t\t\t\t// if both outside plane, no intersection\r\n\t\r\n\t\t\t\t\tif ( d1 < 0 && d2 < 0 ) {\r\n\t\r\n\t\t\t\t\t\treturn false;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\treturn true;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\r\n\t\tcontainsPoint: function ( point ) {\r\n\t\r\n\t\t\tvar planes = this.planes;\r\n\t\r\n\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\t\r\n\t\t\t\tif ( planes[ i ].distanceToPoint( point ) < 0 ) {\r\n\t\r\n\t\t\t\t\treturn false;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn true;\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/math/Plane.js\r\n\t\r\n\t/**\r\n\t * @author bhouston / http://clara.io\r\n\t */\r\n\t\r\n\tTHREE.Plane = function ( normal, constant ) {\r\n\t\r\n\t\tthis.normal = ( normal !== undefined ) ? normal : new THREE.Vector3( 1, 0, 0 );\r\n\t\tthis.constant = ( constant !== undefined ) ? constant : 0;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Plane.prototype = {\r\n\t\r\n\t\tconstructor: THREE.Plane,\r\n\t\r\n\t\tset: function ( normal, constant ) {\r\n\t\r\n\t\t\tthis.normal.copy( normal );\r\n\t\t\tthis.constant = constant;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetComponents: function ( x, y, z, w ) {\r\n\t\r\n\t\t\tthis.normal.set( x, y, z );\r\n\t\t\tthis.constant = w;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetFromNormalAndCoplanarPoint: function ( normal, point ) {\r\n\t\r\n\t\t\tthis.normal.copy( normal );\r\n\t\t\tthis.constant = - point.dot( this.normal );\t// must be this.normal, not normal, as this.normal is normalized\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetFromCoplanarPoints: function () {\r\n\t\r\n\t\t\tvar v1 = new THREE.Vector3();\r\n\t\t\tvar v2 = new THREE.Vector3();\r\n\t\r\n\t\t\treturn function ( a, b, c ) {\r\n\t\r\n\t\t\t\tvar normal = v1.subVectors( c, b ).cross( v2.subVectors( a, b ) ).normalize();\r\n\t\r\n\t\t\t\t// Q: should an error be thrown if normal is zero (e.g. degenerate plane)?\r\n\t\r\n\t\t\t\tthis.setFromNormalAndCoplanarPoint( normal, a );\r\n\t\r\n\t\t\t\treturn this;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tclone: function () {\r\n\t\r\n\t\t\treturn new this.constructor().copy( this );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcopy: function ( plane ) {\r\n\t\r\n\t\t\tthis.normal.copy( plane.normal );\r\n\t\t\tthis.constant = plane.constant;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tnormalize: function () {\r\n\t\r\n\t\t\t// Note: will lead to a divide by zero if the plane is invalid.\r\n\t\r\n\t\t\tvar inverseNormalLength = 1.0 / this.normal.length();\r\n\t\t\tthis.normal.multiplyScalar( inverseNormalLength );\r\n\t\t\tthis.constant *= inverseNormalLength;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tnegate: function () {\r\n\t\r\n\t\t\tthis.constant *= - 1;\r\n\t\t\tthis.normal.negate();\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tdistanceToPoint: function ( point ) {\r\n\t\r\n\t\t\treturn this.normal.dot( point ) + this.constant;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tdistanceToSphere: function ( sphere ) {\r\n\t\r\n\t\t\treturn this.distanceToPoint( sphere.center ) - sphere.radius;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tprojectPoint: function ( point, optionalTarget ) {\r\n\t\r\n\t\t\treturn this.orthoPoint( point, optionalTarget ).sub( point ).negate();\r\n\t\r\n\t\t},\r\n\t\r\n\t\torthoPoint: function ( point, optionalTarget ) {\r\n\t\r\n\t\t\tvar perpendicularMagnitude = this.distanceToPoint( point );\r\n\t\r\n\t\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\t\treturn result.copy( this.normal ).multiplyScalar( perpendicularMagnitude );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tisIntersectionLine: function ( line ) {\r\n\t\r\n\t\t\t// Note: this tests if a line intersects the plane, not whether it (or its end-points) are coplanar with it.\r\n\t\r\n\t\t\tvar startSign = this.distanceToPoint( line.start );\r\n\t\t\tvar endSign = this.distanceToPoint( line.end );\r\n\t\r\n\t\t\treturn ( startSign < 0 && endSign > 0 ) || ( endSign < 0 && startSign > 0 );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tintersectLine: function () {\r\n\t\r\n\t\t\tvar v1 = new THREE.Vector3();\r\n\t\r\n\t\t\treturn function ( line, optionalTarget ) {\r\n\t\r\n\t\t\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\r\n\t\t\t\tvar direction = line.delta( v1 );\r\n\t\r\n\t\t\t\tvar denominator = this.normal.dot( direction );\r\n\t\r\n\t\t\t\tif ( denominator === 0 ) {\r\n\t\r\n\t\t\t\t\t// line is coplanar, return origin\r\n\t\t\t\t\tif ( this.distanceToPoint( line.start ) === 0 ) {\r\n\t\r\n\t\t\t\t\t\treturn result.copy( line.start );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t// Unsure if this is the correct method to handle this case.\r\n\t\t\t\t\treturn undefined;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tvar t = - ( line.start.dot( this.normal ) + this.constant ) / denominator;\r\n\t\r\n\t\t\t\tif ( t < 0 || t > 1 ) {\r\n\t\r\n\t\t\t\t\treturn undefined;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\treturn result.copy( direction ).multiplyScalar( t ).add( line.start );\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\r\n\t\tcoplanarPoint: function ( optionalTarget ) {\r\n\t\r\n\t\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\t\treturn result.copy( this.normal ).multiplyScalar( - this.constant );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tapplyMatrix4: function () {\r\n\t\r\n\t\t\tvar v1 = new THREE.Vector3();\r\n\t\t\tvar v2 = new THREE.Vector3();\r\n\t\t\tvar m1 = new THREE.Matrix3();\r\n\t\r\n\t\t\treturn function ( matrix, optionalNormalMatrix ) {\r\n\t\r\n\t\t\t\t// compute new normal based on theory here:\r\n\t\t\t\t// http://www.songho.ca/opengl/gl_normaltransform.html\r\n\t\t\t\tvar normalMatrix = optionalNormalMatrix || m1.getNormalMatrix( matrix );\r\n\t\t\t\tvar newNormal = v1.copy( this.normal ).applyMatrix3( normalMatrix );\r\n\t\r\n\t\t\t\tvar newCoplanarPoint = this.coplanarPoint( v2 );\r\n\t\t\t\tnewCoplanarPoint.applyMatrix4( matrix );\r\n\t\r\n\t\t\t\tthis.setFromNormalAndCoplanarPoint( newNormal, newCoplanarPoint );\r\n\t\r\n\t\t\t\treturn this;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\ttranslate: function ( offset ) {\r\n\t\r\n\t\t\tthis.constant = this.constant - offset.dot( this.normal );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tequals: function ( plane ) {\r\n\t\r\n\t\t\treturn plane.normal.equals( this.normal ) && ( plane.constant === this.constant );\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/math/Math.js\r\n\t\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.Math = {\r\n\t\r\n\t\tgenerateUUID: function () {\r\n\t\r\n\t\t\t// http://www.broofa.com/Tools/Math.uuid.htm\r\n\t\r\n\t\t\tvar chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.split( '' );\r\n\t\t\tvar uuid = new Array( 36 );\r\n\t\t\tvar rnd = 0, r;\r\n\t\r\n\t\t\treturn function () {\r\n\t\r\n\t\t\t\tfor ( var i = 0; i < 36; i ++ ) {\r\n\t\r\n\t\t\t\t\tif ( i === 8 || i === 13 || i === 18 || i === 23 ) {\r\n\t\r\n\t\t\t\t\t\tuuid[ i ] = '-';\r\n\t\r\n\t\t\t\t\t} else if ( i === 14 ) {\r\n\t\r\n\t\t\t\t\t\tuuid[ i ] = '4';\r\n\t\r\n\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\tif ( rnd <= 0x02 ) rnd = 0x2000000 + ( Math.random() * 0x1000000 ) | 0;\r\n\t\t\t\t\t\tr = rnd & 0xf;\r\n\t\t\t\t\t\trnd = rnd >> 4;\r\n\t\t\t\t\t\tuuid[ i ] = chars[ ( i === 19 ) ? ( r & 0x3 ) | 0x8 : r ];\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\treturn uuid.join( '' );\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tclamp: function ( value, min, max ) {\r\n\t\r\n\t\t\treturn Math.max( min, Math.min( max, value ) );\r\n\t\r\n\t\t},\r\n\t\r\n\t\t// compute euclidian modulo of m % n\r\n\t\t// https://en.wikipedia.org/wiki/Modulo_operation\r\n\t\r\n\t\teuclideanModulo: function ( n, m ) {\r\n\t\r\n\t\t\treturn ( ( n % m ) + m ) % m;\r\n\t\r\n\t\t},\r\n\t\r\n\t\t// Linear mapping from range <a1, a2> to range <b1, b2>\r\n\t\r\n\t\tmapLinear: function ( x, a1, a2, b1, b2 ) {\r\n\t\r\n\t\t\treturn b1 + ( x - a1 ) * ( b2 - b1 ) / ( a2 - a1 );\r\n\t\r\n\t\t},\r\n\t\r\n\t\t// http://en.wikipedia.org/wiki/Smoothstep\r\n\t\r\n\t\tsmoothstep: function ( x, min, max ) {\r\n\t\r\n\t\t\tif ( x <= min ) return 0;\r\n\t\t\tif ( x >= max ) return 1;\r\n\t\r\n\t\t\tx = ( x - min ) / ( max - min );\r\n\t\r\n\t\t\treturn x * x * ( 3 - 2 * x );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsmootherstep: function ( x, min, max ) {\r\n\t\r\n\t\t\tif ( x <= min ) return 0;\r\n\t\t\tif ( x >= max ) return 1;\r\n\t\r\n\t\t\tx = ( x - min ) / ( max - min );\r\n\t\r\n\t\t\treturn x * x * x * ( x * ( x * 6 - 15 ) + 10 );\r\n\t\r\n\t\t},\r\n\t\r\n\t\t// Random float from <0, 1> with 16 bits of randomness\r\n\t\t// (standard Math.random() creates repetitive patterns when applied over larger space)\r\n\t\r\n\t\trandom16: function () {\r\n\t\r\n\t\t\treturn ( 65280 * Math.random() + 255 * Math.random() ) / 65535;\r\n\t\r\n\t\t},\r\n\t\r\n\t\t// Random integer from <low, high> interval\r\n\t\r\n\t\trandInt: function ( low, high ) {\r\n\t\r\n\t\t\treturn low + Math.floor( Math.random() * ( high - low + 1 ) );\r\n\t\r\n\t\t},\r\n\t\r\n\t\t// Random float from <low, high> interval\r\n\t\r\n\t\trandFloat: function ( low, high ) {\r\n\t\r\n\t\t\treturn low + Math.random() * ( high - low );\r\n\t\r\n\t\t},\r\n\t\r\n\t\t// Random float from <-range/2, range/2> interval\r\n\t\r\n\t\trandFloatSpread: function ( range ) {\r\n\t\r\n\t\t\treturn range * ( 0.5 - Math.random() );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tdegToRad: function () {\r\n\t\r\n\t\t\tvar degreeToRadiansFactor = Math.PI / 180;\r\n\t\r\n\t\t\treturn function ( degrees ) {\r\n\t\r\n\t\t\t\treturn degrees * degreeToRadiansFactor;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tradToDeg: function () {\r\n\t\r\n\t\t\tvar radianToDegreesFactor = 180 / Math.PI;\r\n\t\r\n\t\t\treturn function ( radians ) {\r\n\t\r\n\t\t\t\treturn radians * radianToDegreesFactor;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tisPowerOfTwo: function ( value ) {\r\n\t\r\n\t\t\treturn ( value & ( value - 1 ) ) === 0 && value !== 0;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tnearestPowerOfTwo: function ( value ) {\r\n\t\r\n\t\t\treturn Math.pow( 2, Math.round( Math.log( value ) / Math.LN2 ) );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tnextPowerOfTwo: function ( value ) {\r\n\t\r\n\t\t\tvalue --;\r\n\t\t\tvalue |= value >> 1;\r\n\t\t\tvalue |= value >> 2;\r\n\t\t\tvalue |= value >> 4;\r\n\t\t\tvalue |= value >> 8;\r\n\t\t\tvalue |= value >> 16;\r\n\t\t\tvalue ++;\r\n\t\r\n\t\t\treturn value;\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/math/Spline.js\r\n\t\r\n\t/**\r\n\t * Spline from Tween.js, slightly optimized (and trashed)\r\n\t * http://sole.github.com/tween.js/examples/05_spline.html\r\n\t *\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\t\r\n\tTHREE.Spline = function ( points ) {\r\n\t\r\n\t\tthis.points = points;\r\n\t\r\n\t\tvar c = [], v3 = { x: 0, y: 0, z: 0 },\r\n\t\tpoint, intPoint, weight, w2, w3,\r\n\t\tpa, pb, pc, pd;\r\n\t\r\n\t\tthis.initFromArray = function ( a ) {\r\n\t\r\n\t\t\tthis.points = [];\r\n\t\r\n\t\t\tfor ( var i = 0; i < a.length; i ++ ) {\r\n\t\r\n\t\t\t\tthis.points[ i ] = { x: a[ i ][ 0 ], y: a[ i ][ 1 ], z: a[ i ][ 2 ] };\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.getPoint = function ( k ) {\r\n\t\r\n\t\t\tpoint = ( this.points.length - 1 ) * k;\r\n\t\t\tintPoint = Math.floor( point );\r\n\t\t\tweight = point - intPoint;\r\n\t\r\n\t\t\tc[ 0 ] = intPoint === 0 ? intPoint : intPoint - 1;\r\n\t\t\tc[ 1 ] = intPoint;\r\n\t\t\tc[ 2 ] = intPoint  > this.points.length - 2 ? this.points.length - 1 : intPoint + 1;\r\n\t\t\tc[ 3 ] = intPoint  > this.points.length - 3 ? this.points.length - 1 : intPoint + 2;\r\n\t\r\n\t\t\tpa = this.points[ c[ 0 ] ];\r\n\t\t\tpb = this.points[ c[ 1 ] ];\r\n\t\t\tpc = this.points[ c[ 2 ] ];\r\n\t\t\tpd = this.points[ c[ 3 ] ];\r\n\t\r\n\t\t\tw2 = weight * weight;\r\n\t\t\tw3 = weight * w2;\r\n\t\r\n\t\t\tv3.x = interpolate( pa.x, pb.x, pc.x, pd.x, weight, w2, w3 );\r\n\t\t\tv3.y = interpolate( pa.y, pb.y, pc.y, pd.y, weight, w2, w3 );\r\n\t\t\tv3.z = interpolate( pa.z, pb.z, pc.z, pd.z, weight, w2, w3 );\r\n\t\r\n\t\t\treturn v3;\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.getControlPointsArray = function () {\r\n\t\r\n\t\t\tvar i, p, l = this.points.length,\r\n\t\t\t\tcoords = [];\r\n\t\r\n\t\t\tfor ( i = 0; i < l; i ++ ) {\r\n\t\r\n\t\t\t\tp = this.points[ i ];\r\n\t\t\t\tcoords[ i ] = [ p.x, p.y, p.z ];\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn coords;\r\n\t\r\n\t\t};\r\n\t\r\n\t\t// approximate length by summing linear segments\r\n\t\r\n\t\tthis.getLength = function ( nSubDivisions ) {\r\n\t\r\n\t\t\tvar i, index, nSamples, position,\r\n\t\t\t\tpoint = 0, intPoint = 0, oldIntPoint = 0,\r\n\t\t\t\toldPosition = new THREE.Vector3(),\r\n\t\t\t\ttmpVec = new THREE.Vector3(),\r\n\t\t\t\tchunkLengths = [],\r\n\t\t\t\ttotalLength = 0;\r\n\t\r\n\t\t\t// first point has 0 length\r\n\t\r\n\t\t\tchunkLengths[ 0 ] = 0;\r\n\t\r\n\t\t\tif ( ! nSubDivisions ) nSubDivisions = 100;\r\n\t\r\n\t\t\tnSamples = this.points.length * nSubDivisions;\r\n\t\r\n\t\t\toldPosition.copy( this.points[ 0 ] );\r\n\t\r\n\t\t\tfor ( i = 1; i < nSamples; i ++ ) {\r\n\t\r\n\t\t\t\tindex = i / nSamples;\r\n\t\r\n\t\t\t\tposition = this.getPoint( index );\r\n\t\t\t\ttmpVec.copy( position );\r\n\t\r\n\t\t\t\ttotalLength += tmpVec.distanceTo( oldPosition );\r\n\t\r\n\t\t\t\toldPosition.copy( position );\r\n\t\r\n\t\t\t\tpoint = ( this.points.length - 1 ) * index;\r\n\t\t\t\tintPoint = Math.floor( point );\r\n\t\r\n\t\t\t\tif ( intPoint !== oldIntPoint ) {\r\n\t\r\n\t\t\t\t\tchunkLengths[ intPoint ] = totalLength;\r\n\t\t\t\t\toldIntPoint = intPoint;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// last point ends with total length\r\n\t\r\n\t\t\tchunkLengths[ chunkLengths.length ] = totalLength;\r\n\t\r\n\t\t\treturn { chunks: chunkLengths, total: totalLength };\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.reparametrizeByArcLength = function ( samplingCoef ) {\r\n\t\r\n\t\t\tvar i, j,\r\n\t\t\t\tindex, indexCurrent, indexNext,\r\n\t\t\t\trealDistance,\r\n\t\t\t\tsampling, position,\r\n\t\t\t\tnewpoints = [],\r\n\t\t\t\ttmpVec = new THREE.Vector3(),\r\n\t\t\t\tsl = this.getLength();\r\n\t\r\n\t\t\tnewpoints.push( tmpVec.copy( this.points[ 0 ] ).clone() );\r\n\t\r\n\t\t\tfor ( i = 1; i < this.points.length; i ++ ) {\r\n\t\r\n\t\t\t\t//tmpVec.copy( this.points[ i - 1 ] );\r\n\t\t\t\t//linearDistance = tmpVec.distanceTo( this.points[ i ] );\r\n\t\r\n\t\t\t\trealDistance = sl.chunks[ i ] - sl.chunks[ i - 1 ];\r\n\t\r\n\t\t\t\tsampling = Math.ceil( samplingCoef * realDistance / sl.total );\r\n\t\r\n\t\t\t\tindexCurrent = ( i - 1 ) / ( this.points.length - 1 );\r\n\t\t\t\tindexNext = i / ( this.points.length - 1 );\r\n\t\r\n\t\t\t\tfor ( j = 1; j < sampling - 1; j ++ ) {\r\n\t\r\n\t\t\t\t\tindex = indexCurrent + j * ( 1 / sampling ) * ( indexNext - indexCurrent );\r\n\t\r\n\t\t\t\t\tposition = this.getPoint( index );\r\n\t\t\t\t\tnewpoints.push( tmpVec.copy( position ).clone() );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tnewpoints.push( tmpVec.copy( this.points[ i ] ).clone() );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tthis.points = newpoints;\r\n\t\r\n\t\t};\r\n\t\r\n\t\t// Catmull-Rom\r\n\t\r\n\t\tfunction interpolate( p0, p1, p2, p3, t, t2, t3 ) {\r\n\t\r\n\t\t\tvar v0 = ( p2 - p0 ) * 0.5,\r\n\t\t\t\tv1 = ( p3 - p1 ) * 0.5;\r\n\t\r\n\t\t\treturn ( 2 * ( p1 - p2 ) + v0 + v1 ) * t3 + ( - 3 * ( p1 - p2 ) - 2 * v0 - v1 ) * t2 + v0 * t + p1;\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/math/Triangle.js\r\n\t\r\n\t/**\r\n\t * @author bhouston / http://clara.io\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.Triangle = function ( a, b, c ) {\r\n\t\r\n\t\tthis.a = ( a !== undefined ) ? a : new THREE.Vector3();\r\n\t\tthis.b = ( b !== undefined ) ? b : new THREE.Vector3();\r\n\t\tthis.c = ( c !== undefined ) ? c : new THREE.Vector3();\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Triangle.normal = function () {\r\n\t\r\n\t\tvar v0 = new THREE.Vector3();\r\n\t\r\n\t\treturn function ( a, b, c, optionalTarget ) {\r\n\t\r\n\t\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\r\n\t\t\tresult.subVectors( c, b );\r\n\t\t\tv0.subVectors( a, b );\r\n\t\t\tresult.cross( v0 );\r\n\t\r\n\t\t\tvar resultLengthSq = result.lengthSq();\r\n\t\t\tif ( resultLengthSq > 0 ) {\r\n\t\r\n\t\t\t\treturn result.multiplyScalar( 1 / Math.sqrt( resultLengthSq ) );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn result.set( 0, 0, 0 );\r\n\t\r\n\t\t};\r\n\t\r\n\t}();\r\n\t\r\n\t// static/instance method to calculate barycentric coordinates\r\n\t// based on: http://www.blackpawn.com/texts/pointinpoly/default.html\r\n\tTHREE.Triangle.barycoordFromPoint = function () {\r\n\t\r\n\t\tvar v0 = new THREE.Vector3();\r\n\t\tvar v1 = new THREE.Vector3();\r\n\t\tvar v2 = new THREE.Vector3();\r\n\t\r\n\t\treturn function ( point, a, b, c, optionalTarget ) {\r\n\t\r\n\t\t\tv0.subVectors( c, a );\r\n\t\t\tv1.subVectors( b, a );\r\n\t\t\tv2.subVectors( point, a );\r\n\t\r\n\t\t\tvar dot00 = v0.dot( v0 );\r\n\t\t\tvar dot01 = v0.dot( v1 );\r\n\t\t\tvar dot02 = v0.dot( v2 );\r\n\t\t\tvar dot11 = v1.dot( v1 );\r\n\t\t\tvar dot12 = v1.dot( v2 );\r\n\t\r\n\t\t\tvar denom = ( dot00 * dot11 - dot01 * dot01 );\r\n\t\r\n\t\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\r\n\t\t\t// collinear or singular triangle\r\n\t\t\tif ( denom === 0 ) {\r\n\t\r\n\t\t\t\t// arbitrary location outside of triangle?\r\n\t\t\t\t// not sure if this is the best idea, maybe should be returning undefined\r\n\t\t\t\treturn result.set( - 2, - 1, - 1 );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar invDenom = 1 / denom;\r\n\t\t\tvar u = ( dot11 * dot02 - dot01 * dot12 ) * invDenom;\r\n\t\t\tvar v = ( dot00 * dot12 - dot01 * dot02 ) * invDenom;\r\n\t\r\n\t\t\t// barycentric coordinates must always sum to 1\r\n\t\t\treturn result.set( 1 - u - v, v, u );\r\n\t\r\n\t\t};\r\n\t\r\n\t}();\r\n\t\r\n\tTHREE.Triangle.containsPoint = function () {\r\n\t\r\n\t\tvar v1 = new THREE.Vector3();\r\n\t\r\n\t\treturn function ( point, a, b, c ) {\r\n\t\r\n\t\t\tvar result = THREE.Triangle.barycoordFromPoint( point, a, b, c, v1 );\r\n\t\r\n\t\t\treturn ( result.x >= 0 ) && ( result.y >= 0 ) && ( ( result.x + result.y ) <= 1 );\r\n\t\r\n\t\t};\r\n\t\r\n\t}();\r\n\t\r\n\tTHREE.Triangle.prototype = {\r\n\t\r\n\t\tconstructor: THREE.Triangle,\r\n\t\r\n\t\tset: function ( a, b, c ) {\r\n\t\r\n\t\t\tthis.a.copy( a );\r\n\t\t\tthis.b.copy( b );\r\n\t\t\tthis.c.copy( c );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetFromPointsAndIndices: function ( points, i0, i1, i2 ) {\r\n\t\r\n\t\t\tthis.a.copy( points[ i0 ] );\r\n\t\t\tthis.b.copy( points[ i1 ] );\r\n\t\t\tthis.c.copy( points[ i2 ] );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tclone: function () {\r\n\t\r\n\t\t\treturn new this.constructor().copy( this );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcopy: function ( triangle ) {\r\n\t\r\n\t\t\tthis.a.copy( triangle.a );\r\n\t\t\tthis.b.copy( triangle.b );\r\n\t\t\tthis.c.copy( triangle.c );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tarea: function () {\r\n\t\r\n\t\t\tvar v0 = new THREE.Vector3();\r\n\t\t\tvar v1 = new THREE.Vector3();\r\n\t\r\n\t\t\treturn function () {\r\n\t\r\n\t\t\t\tv0.subVectors( this.c, this.b );\r\n\t\t\t\tv1.subVectors( this.a, this.b );\r\n\t\r\n\t\t\t\treturn v0.cross( v1 ).length() * 0.5;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tmidpoint: function ( optionalTarget ) {\r\n\t\r\n\t\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\t\treturn result.addVectors( this.a, this.b ).add( this.c ).multiplyScalar( 1 / 3 );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tnormal: function ( optionalTarget ) {\r\n\t\r\n\t\t\treturn THREE.Triangle.normal( this.a, this.b, this.c, optionalTarget );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tplane: function ( optionalTarget ) {\r\n\t\r\n\t\t\tvar result = optionalTarget || new THREE.Plane();\r\n\t\r\n\t\t\treturn result.setFromCoplanarPoints( this.a, this.b, this.c );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tbarycoordFromPoint: function ( point, optionalTarget ) {\r\n\t\r\n\t\t\treturn THREE.Triangle.barycoordFromPoint( point, this.a, this.b, this.c, optionalTarget );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcontainsPoint: function ( point ) {\r\n\t\r\n\t\t\treturn THREE.Triangle.containsPoint( point, this.a, this.b, this.c );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tequals: function ( triangle ) {\r\n\t\r\n\t\t\treturn triangle.a.equals( this.a ) && triangle.b.equals( this.b ) && triangle.c.equals( this.c );\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/core/Channels.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.Channels = function () {\r\n\t\r\n\t\tthis.mask = 1;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Channels.prototype = {\r\n\t\r\n\t\tconstructor: THREE.Channels,\r\n\t\r\n\t\tset: function ( channel ) {\r\n\t\r\n\t\t\tthis.mask = 1 << channel;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tenable: function ( channel ) {\r\n\t\r\n\t\t\tthis.mask |= 1 << channel;\r\n\t\r\n\t\t},\r\n\t\r\n\t\ttoggle: function ( channel ) {\r\n\t\r\n\t\t\tthis.mask ^= 1 << channel;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tdisable: function ( channel ) {\r\n\t\r\n\t\t\tthis.mask &= ~ ( 1 << channel );\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/core/Clock.js\r\n\t\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\t\r\n\tTHREE.Clock = function ( autoStart ) {\r\n\t\r\n\t\tthis.autoStart = ( autoStart !== undefined ) ? autoStart : true;\r\n\t\r\n\t\tthis.startTime = 0;\r\n\t\tthis.oldTime = 0;\r\n\t\tthis.elapsedTime = 0;\r\n\t\r\n\t\tthis.running = false;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Clock.prototype = {\r\n\t\r\n\t\tconstructor: THREE.Clock,\r\n\t\r\n\t\tstart: function () {\r\n\t\r\n\t\t\tthis.startTime = self.performance.now();\r\n\t\r\n\t\t\tthis.oldTime = this.startTime;\r\n\t\t\tthis.running = true;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tstop: function () {\r\n\t\r\n\t\t\tthis.getElapsedTime();\r\n\t\t\tthis.running = false;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tgetElapsedTime: function () {\r\n\t\r\n\t\t\tthis.getDelta();\r\n\t\t\treturn this.elapsedTime;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tgetDelta: function () {\r\n\t\r\n\t\t\tvar diff = 0;\r\n\t\r\n\t\t\tif ( this.autoStart && ! this.running ) {\r\n\t\r\n\t\t\t\tthis.start();\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( this.running ) {\r\n\t\r\n\t\t\t\tvar newTime = self.performance.now();\r\n\t\r\n\t\t\t\tdiff = 0.001 * ( newTime - this.oldTime );\r\n\t\t\t\tthis.oldTime = newTime;\r\n\t\r\n\t\t\t\tthis.elapsedTime += diff;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn diff;\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/core/EventDispatcher.js\r\n\t\r\n\t/**\r\n\t * https://github.com/mrdoob/eventdispatcher.js/\r\n\t */\r\n\t\r\n\tTHREE.EventDispatcher = function () {};\r\n\t\r\n\tTHREE.EventDispatcher.prototype = {\r\n\t\r\n\t\tconstructor: THREE.EventDispatcher,\r\n\t\r\n\t\tapply: function ( object ) {\r\n\t\r\n\t\t\tobject.addEventListener = THREE.EventDispatcher.prototype.addEventListener;\r\n\t\t\tobject.hasEventListener = THREE.EventDispatcher.prototype.hasEventListener;\r\n\t\t\tobject.removeEventListener = THREE.EventDispatcher.prototype.removeEventListener;\r\n\t\t\tobject.dispatchEvent = THREE.EventDispatcher.prototype.dispatchEvent;\r\n\t\r\n\t\t},\r\n\t\r\n\t\taddEventListener: function ( type, listener ) {\r\n\t\r\n\t\t\tif ( this._listeners === undefined ) this._listeners = {};\r\n\t\r\n\t\t\tvar listeners = this._listeners;\r\n\t\r\n\t\t\tif ( listeners[ type ] === undefined ) {\r\n\t\r\n\t\t\t\tlisteners[ type ] = [];\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( listeners[ type ].indexOf( listener ) === - 1 ) {\r\n\t\r\n\t\t\t\tlisteners[ type ].push( listener );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t},\r\n\t\r\n\t\thasEventListener: function ( type, listener ) {\r\n\t\r\n\t\t\tif ( this._listeners === undefined ) return false;\r\n\t\r\n\t\t\tvar listeners = this._listeners;\r\n\t\r\n\t\t\tif ( listeners[ type ] !== undefined && listeners[ type ].indexOf( listener ) !== - 1 ) {\r\n\t\r\n\t\t\t\treturn true;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn false;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tremoveEventListener: function ( type, listener ) {\r\n\t\r\n\t\t\tif ( this._listeners === undefined ) return;\r\n\t\r\n\t\t\tvar listeners = this._listeners;\r\n\t\t\tvar listenerArray = listeners[ type ];\r\n\t\r\n\t\t\tif ( listenerArray !== undefined ) {\r\n\t\r\n\t\t\t\tvar index = listenerArray.indexOf( listener );\r\n\t\r\n\t\t\t\tif ( index !== - 1 ) {\r\n\t\r\n\t\t\t\t\tlistenerArray.splice( index, 1 );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t},\r\n\t\r\n\t\tdispatchEvent: function ( event ) {\r\n\t\r\n\t\t\tif ( this._listeners === undefined ) return;\r\n\t\r\n\t\t\tvar listeners = this._listeners;\r\n\t\t\tvar listenerArray = listeners[ event.type ];\r\n\t\r\n\t\t\tif ( listenerArray !== undefined ) {\r\n\t\r\n\t\t\t\tevent.target = this;\r\n\t\r\n\t\t\t\tvar array = [];\r\n\t\t\t\tvar length = listenerArray.length;\r\n\t\r\n\t\t\t\tfor ( var i = 0; i < length; i ++ ) {\r\n\t\r\n\t\t\t\t\tarray[ i ] = listenerArray[ i ];\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tfor ( var i = 0; i < length; i ++ ) {\r\n\t\r\n\t\t\t\t\tarray[ i ].call( this, event );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/core/Raycaster.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author bhouston / http://clara.io/\r\n\t * @author stephomi / http://stephaneginier.com/\r\n\t */\r\n\t\r\n\t( function ( THREE ) {\r\n\t\r\n\t\tTHREE.Raycaster = function ( origin, direction, near, far ) {\r\n\t\r\n\t\t\tthis.ray = new THREE.Ray( origin, direction );\r\n\t\t\t// direction is assumed to be normalized (for accurate distance calculations)\r\n\t\r\n\t\t\tthis.near = near || 0;\r\n\t\t\tthis.far = far || Infinity;\r\n\t\r\n\t\t\tthis.params = {\r\n\t\t\t\tMesh: {},\r\n\t\t\t\tLine: {},\r\n\t\t\t\tLOD: {},\r\n\t\t\t\tPoints: { threshold: 1 },\r\n\t\t\t\tSprite: {}\r\n\t\t\t};\r\n\t\r\n\t\t\tObject.defineProperties( this.params, {\r\n\t\t\t\tPointCloud: {\r\n\t\t\t\t\tget: function () {\r\n\t\t\t\t\t\tconsole.warn( 'THREE.Raycaster: params.PointCloud has been renamed to params.Points.' );\r\n\t\t\t\t\t\treturn this.Points;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\t\r\n\t\t};\r\n\t\r\n\t\tfunction descSort( a, b ) {\r\n\t\r\n\t\t\treturn a.distance - b.distance;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction intersectObject( object, raycaster, intersects, recursive ) {\r\n\t\r\n\t\t\tif ( object.visible === false ) return;\r\n\t\r\n\t\t\tobject.raycast( raycaster, intersects );\r\n\t\r\n\t\t\tif ( recursive === true ) {\r\n\t\r\n\t\t\t\tvar children = object.children;\r\n\t\r\n\t\t\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\t\tintersectObject( children[ i ], raycaster, intersects, true );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\t//\r\n\t\r\n\t\tTHREE.Raycaster.prototype = {\r\n\t\r\n\t\t\tconstructor: THREE.Raycaster,\r\n\t\r\n\t\t\tlinePrecision: 1,\r\n\t\r\n\t\t\tset: function ( origin, direction ) {\r\n\t\r\n\t\t\t\t// direction is assumed to be normalized (for accurate distance calculations)\r\n\t\r\n\t\t\t\tthis.ray.set( origin, direction );\r\n\t\r\n\t\t\t},\r\n\t\r\n\t\t\tsetFromCamera: function ( coords, camera ) {\r\n\t\r\n\t\t\t\tif ( camera instanceof THREE.PerspectiveCamera ) {\r\n\t\r\n\t\t\t\t\tthis.ray.origin.setFromMatrixPosition( camera.matrixWorld );\r\n\t\t\t\t\tthis.ray.direction.set( coords.x, coords.y, 0.5 ).unproject( camera ).sub( this.ray.origin ).normalize();\r\n\t\r\n\t\t\t\t} else if ( camera instanceof THREE.OrthographicCamera ) {\r\n\t\r\n\t\t\t\t\tthis.ray.origin.set( coords.x, coords.y, - 1 ).unproject( camera );\r\n\t\t\t\t\tthis.ray.direction.set( 0, 0, - 1 ).transformDirection( camera.matrixWorld );\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tconsole.error( 'THREE.Raycaster: Unsupported camera type.' );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t},\r\n\t\r\n\t\t\tintersectObject: function ( object, recursive ) {\r\n\t\r\n\t\t\t\tvar intersects = [];\r\n\t\r\n\t\t\t\tintersectObject( object, this, intersects, recursive );\r\n\t\r\n\t\t\t\tintersects.sort( descSort );\r\n\t\r\n\t\t\t\treturn intersects;\r\n\t\r\n\t\t\t},\r\n\t\r\n\t\t\tintersectObjects: function ( objects, recursive ) {\r\n\t\r\n\t\t\t\tvar intersects = [];\r\n\t\r\n\t\t\t\tif ( Array.isArray( objects ) === false ) {\r\n\t\r\n\t\t\t\t\tconsole.warn( 'THREE.Raycaster.intersectObjects: objects is not an Array.' );\r\n\t\t\t\t\treturn intersects;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tfor ( var i = 0, l = objects.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\t\tintersectObject( objects[ i ], this, intersects, recursive );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tintersects.sort( descSort );\r\n\t\r\n\t\t\t\treturn intersects;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t};\r\n\t\r\n\t}( THREE ) );\r\n\t\r\n\t// File:src/core/Object3D.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t * @author elephantatwork / www.elephantatwork.ch\r\n\t */\r\n\t\r\n\tTHREE.Object3D = function () {\r\n\t\r\n\t\tObject.defineProperty( this, 'id', { value: THREE.Object3DIdCount ++ } );\r\n\t\r\n\t\tthis.uuid = THREE.Math.generateUUID();\r\n\t\r\n\t\tthis.name = '';\r\n\t\tthis.type = 'Object3D';\r\n\t\r\n\t\tthis.parent = null;\r\n\t\tthis.channels = new THREE.Channels();\r\n\t\tthis.children = [];\r\n\t\r\n\t\tthis.up = THREE.Object3D.DefaultUp.clone();\r\n\t\r\n\t\tvar position = new THREE.Vector3();\r\n\t\tvar rotation = new THREE.Euler();\r\n\t\tvar quaternion = new THREE.Quaternion();\r\n\t\tvar scale = new THREE.Vector3( 1, 1, 1 );\r\n\t\r\n\t\tfunction onRotationChange() {\r\n\t\r\n\t\t\tquaternion.setFromEuler( rotation, false );\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction onQuaternionChange() {\r\n\t\r\n\t\t\trotation.setFromQuaternion( quaternion, undefined, false );\r\n\t\r\n\t\t}\r\n\t\r\n\t\trotation.onChange( onRotationChange );\r\n\t\tquaternion.onChange( onQuaternionChange );\r\n\t\r\n\t\tObject.defineProperties( this, {\r\n\t\t\tposition: {\r\n\t\t\t\tenumerable: true,\r\n\t\t\t\tvalue: position\r\n\t\t\t},\r\n\t\t\trotation: {\r\n\t\t\t\tenumerable: true,\r\n\t\t\t\tvalue: rotation\r\n\t\t\t},\r\n\t\t\tquaternion: {\r\n\t\t\t\tenumerable: true,\r\n\t\t\t\tvalue: quaternion\r\n\t\t\t},\r\n\t\t\tscale: {\r\n\t\t\t\tenumerable: true,\r\n\t\t\t\tvalue: scale\r\n\t\t\t},\r\n\t\t\tmodelViewMatrix: {\r\n\t\t\t\tvalue: new THREE.Matrix4()\r\n\t\t\t},\r\n\t\t\tnormalMatrix: {\r\n\t\t\t\tvalue: new THREE.Matrix3()\r\n\t\t\t}\r\n\t\t} );\r\n\t\r\n\t\tthis.rotationAutoUpdate = true;\r\n\t\r\n\t\tthis.matrix = new THREE.Matrix4();\r\n\t\tthis.matrixWorld = new THREE.Matrix4();\r\n\t\r\n\t\tthis.matrixAutoUpdate = THREE.Object3D.DefaultMatrixAutoUpdate;\r\n\t\tthis.matrixWorldNeedsUpdate = false;\r\n\t\r\n\t\tthis.visible = true;\r\n\t\r\n\t\tthis.castShadow = false;\r\n\t\tthis.receiveShadow = false;\r\n\t\r\n\t\tthis.frustumCulled = true;\r\n\t\tthis.renderOrder = 0;\r\n\t\r\n\t\tthis.userData = {};\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Object3D.DefaultUp = new THREE.Vector3( 0, 1, 0 );\r\n\tTHREE.Object3D.DefaultMatrixAutoUpdate = true;\r\n\t\r\n\tTHREE.Object3D.prototype = {\r\n\t\r\n\t\tconstructor: THREE.Object3D,\r\n\t\r\n\t\tget eulerOrder () {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.Object3D: .eulerOrder is now .rotation.order.' );\r\n\t\r\n\t\t\treturn this.rotation.order;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tset eulerOrder ( value ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.Object3D: .eulerOrder is now .rotation.order.' );\r\n\t\r\n\t\t\tthis.rotation.order = value;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tget useQuaternion () {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.' );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tset useQuaternion ( value ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.' );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tset renderDepth ( value ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.' );\r\n\t\r\n\t\t},\r\n\t\r\n\t\t//\r\n\t\r\n\t\tapplyMatrix: function ( matrix ) {\r\n\t\r\n\t\t\tthis.matrix.multiplyMatrices( matrix, this.matrix );\r\n\t\r\n\t\t\tthis.matrix.decompose( this.position, this.quaternion, this.scale );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetRotationFromAxisAngle: function ( axis, angle ) {\r\n\t\r\n\t\t\t// assumes axis is normalized\r\n\t\r\n\t\t\tthis.quaternion.setFromAxisAngle( axis, angle );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetRotationFromEuler: function ( euler ) {\r\n\t\r\n\t\t\tthis.quaternion.setFromEuler( euler, true );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetRotationFromMatrix: function ( m ) {\r\n\t\r\n\t\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\t\r\n\t\t\tthis.quaternion.setFromRotationMatrix( m );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetRotationFromQuaternion: function ( q ) {\r\n\t\r\n\t\t\t// assumes q is normalized\r\n\t\r\n\t\t\tthis.quaternion.copy( q );\r\n\t\r\n\t\t},\r\n\t\r\n\t\trotateOnAxis: function () {\r\n\t\r\n\t\t\t// rotate object on axis in object space\r\n\t\t\t// axis is assumed to be normalized\r\n\t\r\n\t\t\tvar q1 = new THREE.Quaternion();\r\n\t\r\n\t\t\treturn function ( axis, angle ) {\r\n\t\r\n\t\t\t\tq1.setFromAxisAngle( axis, angle );\r\n\t\r\n\t\t\t\tthis.quaternion.multiply( q1 );\r\n\t\r\n\t\t\t\treturn this;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\trotateX: function () {\r\n\t\r\n\t\t\tvar v1 = new THREE.Vector3( 1, 0, 0 );\r\n\t\r\n\t\t\treturn function ( angle ) {\r\n\t\r\n\t\t\t\treturn this.rotateOnAxis( v1, angle );\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\trotateY: function () {\r\n\t\r\n\t\t\tvar v1 = new THREE.Vector3( 0, 1, 0 );\r\n\t\r\n\t\t\treturn function ( angle ) {\r\n\t\r\n\t\t\t\treturn this.rotateOnAxis( v1, angle );\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\trotateZ: function () {\r\n\t\r\n\t\t\tvar v1 = new THREE.Vector3( 0, 0, 1 );\r\n\t\r\n\t\t\treturn function ( angle ) {\r\n\t\r\n\t\t\t\treturn this.rotateOnAxis( v1, angle );\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\ttranslateOnAxis: function () {\r\n\t\r\n\t\t\t// translate object by distance along axis in object space\r\n\t\t\t// axis is assumed to be normalized\r\n\t\r\n\t\t\tvar v1 = new THREE.Vector3();\r\n\t\r\n\t\t\treturn function ( axis, distance ) {\r\n\t\r\n\t\t\t\tv1.copy( axis ).applyQuaternion( this.quaternion );\r\n\t\r\n\t\t\t\tthis.position.add( v1.multiplyScalar( distance ) );\r\n\t\r\n\t\t\t\treturn this;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\ttranslate: function ( distance, axis ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead.' );\r\n\t\t\treturn this.translateOnAxis( axis, distance );\r\n\t\r\n\t\t},\r\n\t\r\n\t\ttranslateX: function () {\r\n\t\r\n\t\t\tvar v1 = new THREE.Vector3( 1, 0, 0 );\r\n\t\r\n\t\t\treturn function ( distance ) {\r\n\t\r\n\t\t\t\treturn this.translateOnAxis( v1, distance );\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\ttranslateY: function () {\r\n\t\r\n\t\t\tvar v1 = new THREE.Vector3( 0, 1, 0 );\r\n\t\r\n\t\t\treturn function ( distance ) {\r\n\t\r\n\t\t\t\treturn this.translateOnAxis( v1, distance );\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\ttranslateZ: function () {\r\n\t\r\n\t\t\tvar v1 = new THREE.Vector3( 0, 0, 1 );\r\n\t\r\n\t\t\treturn function ( distance ) {\r\n\t\r\n\t\t\t\treturn this.translateOnAxis( v1, distance );\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tlocalToWorld: function ( vector ) {\r\n\t\r\n\t\t\treturn vector.applyMatrix4( this.matrixWorld );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tworldToLocal: function () {\r\n\t\r\n\t\t\tvar m1 = new THREE.Matrix4();\r\n\t\r\n\t\t\treturn function ( vector ) {\r\n\t\r\n\t\t\t\treturn vector.applyMatrix4( m1.getInverse( this.matrixWorld ) );\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tlookAt: function () {\r\n\t\r\n\t\t\t// This routine does not support objects with rotated and/or translated parent(s)\r\n\t\r\n\t\t\tvar m1 = new THREE.Matrix4();\r\n\t\r\n\t\t\treturn function ( vector ) {\r\n\t\r\n\t\t\t\tm1.lookAt( vector, this.position, this.up );\r\n\t\r\n\t\t\t\tthis.quaternion.setFromRotationMatrix( m1 );\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tadd: function ( object ) {\r\n\t\r\n\t\t\tif ( arguments.length > 1 ) {\r\n\t\r\n\t\t\t\tfor ( var i = 0; i < arguments.length; i ++ ) {\r\n\t\r\n\t\t\t\t\tthis.add( arguments[ i ] );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\treturn this;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( object === this ) {\r\n\t\r\n\t\t\t\tconsole.error( \"THREE.Object3D.add: object can't be added as a child of itself.\", object );\r\n\t\t\t\treturn this;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( object instanceof THREE.Object3D ) {\r\n\t\r\n\t\t\t\tif ( object.parent !== null ) {\r\n\t\r\n\t\t\t\t\tobject.parent.remove( object );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tobject.parent = this;\r\n\t\t\t\tobject.dispatchEvent( { type: 'added' } );\r\n\t\r\n\t\t\t\tthis.children.push( object );\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\tconsole.error( \"THREE.Object3D.add: object not an instance of THREE.Object3D.\", object );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tremove: function ( object ) {\r\n\t\r\n\t\t\tif ( arguments.length > 1 ) {\r\n\t\r\n\t\t\t\tfor ( var i = 0; i < arguments.length; i ++ ) {\r\n\t\r\n\t\t\t\t\tthis.remove( arguments[ i ] );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar index = this.children.indexOf( object );\r\n\t\r\n\t\t\tif ( index !== - 1 ) {\r\n\t\r\n\t\t\t\tobject.parent = null;\r\n\t\r\n\t\t\t\tobject.dispatchEvent( { type: 'removed' } );\r\n\t\r\n\t\t\t\tthis.children.splice( index, 1 );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t},\r\n\t\r\n\t\tgetChildByName: function ( name ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.Object3D: .getChildByName() has been renamed to .getObjectByName().' );\r\n\t\t\treturn this.getObjectByName( name );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tgetObjectById: function ( id ) {\r\n\t\r\n\t\t\treturn this.getObjectByProperty( 'id', id );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tgetObjectByName: function ( name ) {\r\n\t\r\n\t\t\treturn this.getObjectByProperty( 'name', name );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tgetObjectByProperty: function ( name, value ) {\r\n\t\r\n\t\t\tif ( this[ name ] === value ) return this;\r\n\t\r\n\t\t\tfor ( var i = 0, l = this.children.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\tvar child = this.children[ i ];\r\n\t\t\t\tvar object = child.getObjectByProperty( name, value );\r\n\t\r\n\t\t\t\tif ( object !== undefined ) {\r\n\t\r\n\t\t\t\t\treturn object;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn undefined;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tgetWorldPosition: function ( optionalTarget ) {\r\n\t\r\n\t\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\r\n\t\t\tthis.updateMatrixWorld( true );\r\n\t\r\n\t\t\treturn result.setFromMatrixPosition( this.matrixWorld );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tgetWorldQuaternion: function () {\r\n\t\r\n\t\t\tvar position = new THREE.Vector3();\r\n\t\t\tvar scale = new THREE.Vector3();\r\n\t\r\n\t\t\treturn function ( optionalTarget ) {\r\n\t\r\n\t\t\t\tvar result = optionalTarget || new THREE.Quaternion();\r\n\t\r\n\t\t\t\tthis.updateMatrixWorld( true );\r\n\t\r\n\t\t\t\tthis.matrixWorld.decompose( position, result, scale );\r\n\t\r\n\t\t\t\treturn result;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tgetWorldRotation: function () {\r\n\t\r\n\t\t\tvar quaternion = new THREE.Quaternion();\r\n\t\r\n\t\t\treturn function ( optionalTarget ) {\r\n\t\r\n\t\t\t\tvar result = optionalTarget || new THREE.Euler();\r\n\t\r\n\t\t\t\tthis.getWorldQuaternion( quaternion );\r\n\t\r\n\t\t\t\treturn result.setFromQuaternion( quaternion, this.rotation.order, false );\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tgetWorldScale: function () {\r\n\t\r\n\t\t\tvar position = new THREE.Vector3();\r\n\t\t\tvar quaternion = new THREE.Quaternion();\r\n\t\r\n\t\t\treturn function ( optionalTarget ) {\r\n\t\r\n\t\t\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\r\n\t\t\t\tthis.updateMatrixWorld( true );\r\n\t\r\n\t\t\t\tthis.matrixWorld.decompose( position, quaternion, result );\r\n\t\r\n\t\t\t\treturn result;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tgetWorldDirection: function () {\r\n\t\r\n\t\t\tvar quaternion = new THREE.Quaternion();\r\n\t\r\n\t\t\treturn function ( optionalTarget ) {\r\n\t\r\n\t\t\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\r\n\t\t\t\tthis.getWorldQuaternion( quaternion );\r\n\t\r\n\t\t\t\treturn result.set( 0, 0, 1 ).applyQuaternion( quaternion );\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\traycast: function () {},\r\n\t\r\n\t\ttraverse: function ( callback ) {\r\n\t\r\n\t\t\tcallback( this );\r\n\t\r\n\t\t\tvar children = this.children;\r\n\t\r\n\t\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\tchildren[ i ].traverse( callback );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t},\r\n\t\r\n\t\ttraverseVisible: function ( callback ) {\r\n\t\r\n\t\t\tif ( this.visible === false ) return;\r\n\t\r\n\t\t\tcallback( this );\r\n\t\r\n\t\t\tvar children = this.children;\r\n\t\r\n\t\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\tchildren[ i ].traverseVisible( callback );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t},\r\n\t\r\n\t\ttraverseAncestors: function ( callback ) {\r\n\t\r\n\t\t\tvar parent = this.parent;\r\n\t\r\n\t\t\tif ( parent !== null ) {\r\n\t\r\n\t\t\t\tcallback( parent );\r\n\t\r\n\t\t\t\tparent.traverseAncestors( callback );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t},\r\n\t\r\n\t\tupdateMatrix: function () {\r\n\t\r\n\t\t\tthis.matrix.compose( this.position, this.quaternion, this.scale );\r\n\t\r\n\t\t\tthis.matrixWorldNeedsUpdate = true;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tupdateMatrixWorld: function ( force ) {\r\n\t\r\n\t\t\tif ( this.matrixAutoUpdate === true ) this.updateMatrix();\r\n\t\r\n\t\t\tif ( this.matrixWorldNeedsUpdate === true || force === true ) {\r\n\t\r\n\t\t\t\tif ( this.parent === null ) {\r\n\t\r\n\t\t\t\t\tthis.matrixWorld.copy( this.matrix );\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tthis.matrixWorld.multiplyMatrices( this.parent.matrixWorld, this.matrix );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tthis.matrixWorldNeedsUpdate = false;\r\n\t\r\n\t\t\t\tforce = true;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// update children\r\n\t\r\n\t\t\tfor ( var i = 0, l = this.children.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\tthis.children[ i ].updateMatrixWorld( force );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t},\r\n\t\r\n\t\ttoJSON: function ( meta ) {\r\n\t\r\n\t\t\tvar isRootObject = ( meta === undefined );\r\n\t\r\n\t\t\tvar output = {};\r\n\t\r\n\t\t\t// meta is a hash used to collect geometries, materials.\r\n\t\t\t// not providing it implies that this is the root object\r\n\t\t\t// being serialized.\r\n\t\t\tif ( isRootObject ) {\r\n\t\r\n\t\t\t\t// initialize meta obj\r\n\t\t\t\tmeta = {\r\n\t\t\t\t\tgeometries: {},\r\n\t\t\t\t\tmaterials: {},\r\n\t\t\t\t\ttextures: {},\r\n\t\t\t\t\timages: {}\r\n\t\t\t\t};\r\n\t\r\n\t\t\t\toutput.metadata = {\r\n\t\t\t\t\tversion: 4.4,\r\n\t\t\t\t\ttype: 'Object',\r\n\t\t\t\t\tgenerator: 'Object3D.toJSON'\r\n\t\t\t\t};\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// standard Object3D serialization\r\n\t\r\n\t\t\tvar object = {};\r\n\t\r\n\t\t\tobject.uuid = this.uuid;\r\n\t\t\tobject.type = this.type;\r\n\t\r\n\t\t\tif ( this.name !== '' ) object.name = this.name;\r\n\t\t\tif ( JSON.stringify( this.userData ) !== '{}' ) object.userData = this.userData;\r\n\t\t\tif ( this.castShadow === true ) object.castShadow = true;\r\n\t\t\tif ( this.receiveShadow === true ) object.receiveShadow = true;\r\n\t\t\tif ( this.visible === false ) object.visible = false;\r\n\t\r\n\t\t\tobject.matrix = this.matrix.toArray();\r\n\t\r\n\t\t\t//\r\n\t\r\n\t\t\tif ( this.geometry !== undefined ) {\r\n\t\r\n\t\t\t\tif ( meta.geometries[ this.geometry.uuid ] === undefined ) {\r\n\t\r\n\t\t\t\t\tmeta.geometries[ this.geometry.uuid ] = this.geometry.toJSON( meta );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tobject.geometry = this.geometry.uuid;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( this.material !== undefined ) {\r\n\t\r\n\t\t\t\tif ( meta.materials[ this.material.uuid ] === undefined ) {\r\n\t\r\n\t\t\t\t\tmeta.materials[ this.material.uuid ] = this.material.toJSON( meta );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tobject.material = this.material.uuid;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t//\r\n\t\r\n\t\t\tif ( this.children.length > 0 ) {\r\n\t\r\n\t\t\t\tobject.children = [];\r\n\t\r\n\t\t\t\tfor ( var i = 0; i < this.children.length; i ++ ) {\r\n\t\r\n\t\t\t\t\tobject.children.push( this.children[ i ].toJSON( meta ).object );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( isRootObject ) {\r\n\t\r\n\t\t\t\tvar geometries = extractFromCache( meta.geometries );\r\n\t\t\t\tvar materials = extractFromCache( meta.materials );\r\n\t\t\t\tvar textures = extractFromCache( meta.textures );\r\n\t\t\t\tvar images = extractFromCache( meta.images );\r\n\t\r\n\t\t\t\tif ( geometries.length > 0 ) output.geometries = geometries;\r\n\t\t\t\tif ( materials.length > 0 ) output.materials = materials;\r\n\t\t\t\tif ( textures.length > 0 ) output.textures = textures;\r\n\t\t\t\tif ( images.length > 0 ) output.images = images;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\toutput.object = object;\r\n\t\r\n\t\t\treturn output;\r\n\t\r\n\t\t\t// extract data from the cache hash\r\n\t\t\t// remove metadata on each item\r\n\t\t\t// and return as array\r\n\t\t\tfunction extractFromCache ( cache ) {\r\n\t\r\n\t\t\t\tvar values = [];\r\n\t\t\t\tfor ( var key in cache ) {\r\n\t\r\n\t\t\t\t\tvar data = cache[ key ];\r\n\t\t\t\t\tdelete data.metadata;\r\n\t\t\t\t\tvalues.push( data );\r\n\t\r\n\t\t\t\t}\r\n\t\t\t\treturn values;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t},\r\n\t\r\n\t\tclone: function ( recursive ) {\r\n\t\r\n\t\t\treturn new this.constructor().copy( this, recursive );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcopy: function ( source, recursive ) {\r\n\t\r\n\t\t\tif ( recursive === undefined ) recursive = true;\r\n\t\r\n\t\t\tthis.name = source.name;\r\n\t\r\n\t\t\tthis.up.copy( source.up );\r\n\t\r\n\t\t\tthis.position.copy( source.position );\r\n\t\t\tthis.quaternion.copy( source.quaternion );\r\n\t\t\tthis.scale.copy( source.scale );\r\n\t\r\n\t\t\tthis.rotationAutoUpdate = source.rotationAutoUpdate;\r\n\t\r\n\t\t\tthis.matrix.copy( source.matrix );\r\n\t\t\tthis.matrixWorld.copy( source.matrixWorld );\r\n\t\r\n\t\t\tthis.matrixAutoUpdate = source.matrixAutoUpdate;\r\n\t\t\tthis.matrixWorldNeedsUpdate = source.matrixWorldNeedsUpdate;\r\n\t\r\n\t\t\tthis.visible = source.visible;\r\n\t\r\n\t\t\tthis.castShadow = source.castShadow;\r\n\t\t\tthis.receiveShadow = source.receiveShadow;\r\n\t\r\n\t\t\tthis.frustumCulled = source.frustumCulled;\r\n\t\t\tthis.renderOrder = source.renderOrder;\r\n\t\r\n\t\t\tthis.userData = JSON.parse( JSON.stringify( source.userData ) );\r\n\t\r\n\t\t\tif ( recursive === true ) {\r\n\t\r\n\t\t\t\tfor ( var i = 0; i < source.children.length; i ++ ) {\r\n\t\r\n\t\t\t\t\tvar child = source.children[ i ];\r\n\t\t\t\t\tthis.add( child.clone() );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.EventDispatcher.prototype.apply( THREE.Object3D.prototype );\r\n\t\r\n\tTHREE.Object3DIdCount = 0;\r\n\t\r\n\t// File:src/core/Face3.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\t\r\n\tTHREE.Face3 = function ( a, b, c, normal, color, materialIndex ) {\r\n\t\r\n\t\tthis.a = a;\r\n\t\tthis.b = b;\r\n\t\tthis.c = c;\r\n\t\r\n\t\tthis.normal = normal instanceof THREE.Vector3 ? normal : new THREE.Vector3();\r\n\t\tthis.vertexNormals = Array.isArray( normal ) ? normal : [];\r\n\t\r\n\t\tthis.color = color instanceof THREE.Color ? color : new THREE.Color();\r\n\t\tthis.vertexColors = Array.isArray( color ) ? color : [];\r\n\t\r\n\t\tthis.materialIndex = materialIndex !== undefined ? materialIndex : 0;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Face3.prototype = {\r\n\t\r\n\t\tconstructor: THREE.Face3,\r\n\t\r\n\t\tclone: function () {\r\n\t\r\n\t\t\treturn new this.constructor().copy( this );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcopy: function ( source ) {\r\n\t\r\n\t\t\tthis.a = source.a;\r\n\t\t\tthis.b = source.b;\r\n\t\t\tthis.c = source.c;\r\n\t\r\n\t\t\tthis.normal.copy( source.normal );\r\n\t\t\tthis.color.copy( source.color );\r\n\t\r\n\t\t\tthis.materialIndex = source.materialIndex;\r\n\t\r\n\t\t\tfor ( var i = 0, il = source.vertexNormals.length; i < il; i ++ ) {\r\n\t\r\n\t\t\t\tthis.vertexNormals[ i ] = source.vertexNormals[ i ].clone();\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tfor ( var i = 0, il = source.vertexColors.length; i < il; i ++ ) {\r\n\t\r\n\t\t\t\tthis.vertexColors[ i ] = source.vertexColors[ i ].clone();\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/core/Face4.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.Face4 = function ( a, b, c, d, normal, color, materialIndex ) {\r\n\t\r\n\t\tconsole.warn( 'THREE.Face4 has been removed. A THREE.Face3 will be created instead.' );\r\n\t\treturn new THREE.Face3( a, b, c, normal, color, materialIndex );\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/core/BufferAttribute.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.BufferAttribute = function ( array, itemSize ) {\r\n\t\r\n\t\tthis.uuid = THREE.Math.generateUUID();\r\n\t\r\n\t\tthis.array = array;\r\n\t\tthis.itemSize = itemSize;\r\n\t\r\n\t\tthis.dynamic = false;\r\n\t\tthis.updateRange = { offset: 0, count: - 1 };\r\n\t\r\n\t\tthis.version = 0;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.BufferAttribute.prototype = {\r\n\t\r\n\t\tconstructor: THREE.BufferAttribute,\r\n\t\r\n\t\tget length() {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.BufferAttribute: .length has been deprecated. Please use .count.' );\r\n\t\t\treturn this.array.length;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tget count() {\r\n\t\r\n\t\t\treturn this.array.length / this.itemSize;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tset needsUpdate( value ) {\r\n\t\r\n\t\t\tif ( value === true ) this.version ++;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetDynamic: function ( value ) {\r\n\t\r\n\t\t\tthis.dynamic = value;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcopy: function ( source ) {\r\n\t\r\n\t\t\tthis.array = new source.array.constructor( source.array );\r\n\t\t\tthis.itemSize = source.itemSize;\r\n\t\r\n\t\t\tthis.dynamic = source.dynamic;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcopyAt: function ( index1, attribute, index2 ) {\r\n\t\r\n\t\t\tindex1 *= this.itemSize;\r\n\t\t\tindex2 *= attribute.itemSize;\r\n\t\r\n\t\t\tfor ( var i = 0, l = this.itemSize; i < l; i ++ ) {\r\n\t\r\n\t\t\t\tthis.array[ index1 + i ] = attribute.array[ index2 + i ];\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcopyArray: function ( array ) {\r\n\t\r\n\t\t\tthis.array.set( array );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcopyColorsArray: function ( colors ) {\r\n\t\r\n\t\t\tvar array = this.array, offset = 0;\r\n\t\r\n\t\t\tfor ( var i = 0, l = colors.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\tvar color = colors[ i ];\r\n\t\r\n\t\t\t\tif ( color === undefined ) {\r\n\t\r\n\t\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyColorsArray(): color is undefined', i );\r\n\t\t\t\t\tcolor = new THREE.Color();\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tarray[ offset ++ ] = color.r;\r\n\t\t\t\tarray[ offset ++ ] = color.g;\r\n\t\t\t\tarray[ offset ++ ] = color.b;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcopyIndicesArray: function ( indices ) {\r\n\t\r\n\t\t\tvar array = this.array, offset = 0;\r\n\t\r\n\t\t\tfor ( var i = 0, l = indices.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\tvar index = indices[ i ];\r\n\t\r\n\t\t\t\tarray[ offset ++ ] = index.a;\r\n\t\t\t\tarray[ offset ++ ] = index.b;\r\n\t\t\t\tarray[ offset ++ ] = index.c;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcopyVector2sArray: function ( vectors ) {\r\n\t\r\n\t\t\tvar array = this.array, offset = 0;\r\n\t\r\n\t\t\tfor ( var i = 0, l = vectors.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\tvar vector = vectors[ i ];\r\n\t\r\n\t\t\t\tif ( vector === undefined ) {\r\n\t\r\n\t\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyVector2sArray(): vector is undefined', i );\r\n\t\t\t\t\tvector = new THREE.Vector2();\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tarray[ offset ++ ] = vector.x;\r\n\t\t\t\tarray[ offset ++ ] = vector.y;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcopyVector3sArray: function ( vectors ) {\r\n\t\r\n\t\t\tvar array = this.array, offset = 0;\r\n\t\r\n\t\t\tfor ( var i = 0, l = vectors.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\tvar vector = vectors[ i ];\r\n\t\r\n\t\t\t\tif ( vector === undefined ) {\r\n\t\r\n\t\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyVector3sArray(): vector is undefined', i );\r\n\t\t\t\t\tvector = new THREE.Vector3();\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tarray[ offset ++ ] = vector.x;\r\n\t\t\t\tarray[ offset ++ ] = vector.y;\r\n\t\t\t\tarray[ offset ++ ] = vector.z;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcopyVector4sArray: function ( vectors ) {\r\n\t\r\n\t\t\tvar array = this.array, offset = 0;\r\n\t\r\n\t\t\tfor ( var i = 0, l = vectors.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\tvar vector = vectors[ i ];\r\n\t\r\n\t\t\t\tif ( vector === undefined ) {\r\n\t\r\n\t\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyVector4sArray(): vector is undefined', i );\r\n\t\t\t\t\tvector = new THREE.Vector4();\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tarray[ offset ++ ] = vector.x;\r\n\t\t\t\tarray[ offset ++ ] = vector.y;\r\n\t\t\t\tarray[ offset ++ ] = vector.z;\r\n\t\t\t\tarray[ offset ++ ] = vector.w;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tset: function ( value, offset ) {\r\n\t\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\t\r\n\t\t\tthis.array.set( value, offset );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tgetX: function ( index ) {\r\n\t\r\n\t\t\treturn this.array[ index * this.itemSize ];\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetX: function ( index, x ) {\r\n\t\r\n\t\t\tthis.array[ index * this.itemSize ] = x;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tgetY: function ( index ) {\r\n\t\r\n\t\t\treturn this.array[ index * this.itemSize + 1 ];\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetY: function ( index, y ) {\r\n\t\r\n\t\t\tthis.array[ index * this.itemSize + 1 ] = y;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tgetZ: function ( index ) {\r\n\t\r\n\t\t\treturn this.array[ index * this.itemSize + 2 ];\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetZ: function ( index, z ) {\r\n\t\r\n\t\t\tthis.array[ index * this.itemSize + 2 ] = z;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tgetW: function ( index ) {\r\n\t\r\n\t\t\treturn this.array[ index * this.itemSize + 3 ];\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetW: function ( index, w ) {\r\n\t\r\n\t\t\tthis.array[ index * this.itemSize + 3 ] = w;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetXY: function ( index, x, y ) {\r\n\t\r\n\t\t\tindex *= this.itemSize;\r\n\t\r\n\t\t\tthis.array[ index + 0 ] = x;\r\n\t\t\tthis.array[ index + 1 ] = y;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetXYZ: function ( index, x, y, z ) {\r\n\t\r\n\t\t\tindex *= this.itemSize;\r\n\t\r\n\t\t\tthis.array[ index + 0 ] = x;\r\n\t\t\tthis.array[ index + 1 ] = y;\r\n\t\t\tthis.array[ index + 2 ] = z;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetXYZW: function ( index, x, y, z, w ) {\r\n\t\r\n\t\t\tindex *= this.itemSize;\r\n\t\r\n\t\t\tthis.array[ index + 0 ] = x;\r\n\t\t\tthis.array[ index + 1 ] = y;\r\n\t\t\tthis.array[ index + 2 ] = z;\r\n\t\t\tthis.array[ index + 3 ] = w;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tclone: function () {\r\n\t\r\n\t\t\treturn new this.constructor().copy( this );\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t//\r\n\t\r\n\tTHREE.Int8Attribute = function ( array, itemSize ) {\r\n\t\r\n\t\treturn new THREE.BufferAttribute( new Int8Array( array ), itemSize );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Uint8Attribute = function ( array, itemSize ) {\r\n\t\r\n\t\treturn new THREE.BufferAttribute( new Uint8Array( array ), itemSize );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Uint8ClampedAttribute = function ( array, itemSize ) {\r\n\t\r\n\t\treturn new THREE.BufferAttribute( new Uint8ClampedArray( array ), itemSize );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Int16Attribute = function ( array, itemSize ) {\r\n\t\r\n\t\treturn new THREE.BufferAttribute( new Int16Array( array ), itemSize );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Uint16Attribute = function ( array, itemSize ) {\r\n\t\r\n\t\treturn new THREE.BufferAttribute( new Uint16Array( array ), itemSize );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Int32Attribute = function ( array, itemSize ) {\r\n\t\r\n\t\treturn new THREE.BufferAttribute( new Int32Array( array ), itemSize );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Uint32Attribute = function ( array, itemSize ) {\r\n\t\r\n\t\treturn new THREE.BufferAttribute( new Uint32Array( array ), itemSize );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Float32Attribute = function ( array, itemSize ) {\r\n\t\r\n\t\treturn new THREE.BufferAttribute( new Float32Array( array ), itemSize );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Float64Attribute = function ( array, itemSize ) {\r\n\t\r\n\t\treturn new THREE.BufferAttribute( new Float64Array( array ), itemSize );\r\n\t\r\n\t};\r\n\t\r\n\t\r\n\t// Deprecated\r\n\t\r\n\tTHREE.DynamicBufferAttribute = function ( array, itemSize ) {\r\n\t\r\n\t\tconsole.warn( 'THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead.' );\r\n\t\treturn new THREE.BufferAttribute( array, itemSize ).setDynamic( true );\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/core/InstancedBufferAttribute.js\r\n\t\r\n\t/**\r\n\t * @author benaadams / https://twitter.com/ben_a_adams\r\n\t */\r\n\t\r\n\tTHREE.InstancedBufferAttribute = function ( array, itemSize, meshPerAttribute ) {\r\n\t\r\n\t\tTHREE.BufferAttribute.call( this, array, itemSize );\r\n\t\r\n\t\tthis.meshPerAttribute = meshPerAttribute || 1;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.InstancedBufferAttribute.prototype = Object.create( THREE.BufferAttribute.prototype );\r\n\tTHREE.InstancedBufferAttribute.prototype.constructor = THREE.InstancedBufferAttribute;\r\n\t\r\n\tTHREE.InstancedBufferAttribute.prototype.copy = function ( source ) {\r\n\t\r\n\t\tTHREE.BufferAttribute.prototype.copy.call( this, source );\r\n\t\r\n\t\tthis.meshPerAttribute = source.meshPerAttribute;\r\n\t\r\n\t\treturn this;\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/core/InterleavedBuffer.js\r\n\t\r\n\t/**\r\n\t * @author benaadams / https://twitter.com/ben_a_adams\r\n\t */\r\n\t\r\n\tTHREE.InterleavedBuffer = function ( array, stride ) {\r\n\t\r\n\t\tthis.uuid = THREE.Math.generateUUID();\r\n\t\r\n\t\tthis.array = array;\r\n\t\tthis.stride = stride;\r\n\t\r\n\t\tthis.dynamic = false;\r\n\t\tthis.updateRange = { offset: 0, count: - 1 };\r\n\t\r\n\t\tthis.version = 0;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.InterleavedBuffer.prototype = {\r\n\t\r\n\t\tconstructor: THREE.InterleavedBuffer,\r\n\t\r\n\t\tget length () {\r\n\t\r\n\t\t\treturn this.array.length;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tget count () {\r\n\t\r\n\t\t\treturn this.array.length / this.stride;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tset needsUpdate( value ) {\r\n\t\r\n\t\t\tif ( value === true ) this.version ++;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetDynamic: function ( value ) {\r\n\t\r\n\t\t\tthis.dynamic = value;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcopy: function ( source ) {\r\n\t\r\n\t\t\tthis.array = new source.array.constructor( source.array );\r\n\t\t\tthis.stride = source.stride;\r\n\t\t\tthis.dynamic = source.dynamic;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcopyAt: function ( index1, attribute, index2 ) {\r\n\t\r\n\t\t\tindex1 *= this.stride;\r\n\t\t\tindex2 *= attribute.stride;\r\n\t\r\n\t\t\tfor ( var i = 0, l = this.stride; i < l; i ++ ) {\r\n\t\r\n\t\t\t\tthis.array[ index1 + i ] = attribute.array[ index2 + i ];\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tset: function ( value, offset ) {\r\n\t\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\t\r\n\t\t\tthis.array.set( value, offset );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tclone: function () {\r\n\t\r\n\t\t\treturn new this.constructor().copy( this );\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/core/InstancedInterleavedBuffer.js\r\n\t\r\n\t/**\r\n\t * @author benaadams / https://twitter.com/ben_a_adams\r\n\t */\r\n\t\r\n\tTHREE.InstancedInterleavedBuffer = function ( array, stride, meshPerAttribute ) {\r\n\t\r\n\t\tTHREE.InterleavedBuffer.call( this, array, stride );\r\n\t\r\n\t\tthis.meshPerAttribute = meshPerAttribute || 1;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.InstancedInterleavedBuffer.prototype = Object.create( THREE.InterleavedBuffer.prototype );\r\n\tTHREE.InstancedInterleavedBuffer.prototype.constructor = THREE.InstancedInterleavedBuffer;\r\n\t\r\n\tTHREE.InstancedInterleavedBuffer.prototype.copy = function ( source ) {\r\n\t\r\n\t\tTHREE.InterleavedBuffer.prototype.copy.call( this, source );\r\n\t\r\n\t\tthis.meshPerAttribute = source.meshPerAttribute;\r\n\t\r\n\t\treturn this;\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/core/InterleavedBufferAttribute.js\r\n\t\r\n\t/**\r\n\t * @author benaadams / https://twitter.com/ben_a_adams\r\n\t */\r\n\t\r\n\tTHREE.InterleavedBufferAttribute = function ( interleavedBuffer, itemSize, offset ) {\r\n\t\r\n\t\tthis.uuid = THREE.Math.generateUUID();\r\n\t\r\n\t\tthis.data = interleavedBuffer;\r\n\t\tthis.itemSize = itemSize;\r\n\t\tthis.offset = offset;\r\n\t\r\n\t};\r\n\t\r\n\t\r\n\tTHREE.InterleavedBufferAttribute.prototype = {\r\n\t\r\n\t\tconstructor: THREE.InterleavedBufferAttribute,\r\n\t\r\n\t\tget length() {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.BufferAttribute: .length has been deprecated. Please use .count.' );\r\n\t\t\treturn this.array.length;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tget count() {\r\n\t\r\n\t\t\treturn this.data.array.length / this.data.stride;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetX: function ( index, x ) {\r\n\t\r\n\t\t\tthis.data.array[ index * this.data.stride + this.offset ] = x;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetY: function ( index, y ) {\r\n\t\r\n\t\t\tthis.data.array[ index * this.data.stride + this.offset + 1 ] = y;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetZ: function ( index, z ) {\r\n\t\r\n\t\t\tthis.data.array[ index * this.data.stride + this.offset + 2 ] = z;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetW: function ( index, w ) {\r\n\t\r\n\t\t\tthis.data.array[ index * this.data.stride + this.offset + 3 ] = w;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tgetX: function ( index ) {\r\n\t\r\n\t\t\treturn this.data.array[ index * this.data.stride + this.offset ];\r\n\t\r\n\t\t},\r\n\t\r\n\t\tgetY: function ( index ) {\r\n\t\r\n\t\t\treturn this.data.array[ index * this.data.stride + this.offset + 1 ];\r\n\t\r\n\t\t},\r\n\t\r\n\t\tgetZ: function ( index ) {\r\n\t\r\n\t\t\treturn this.data.array[ index * this.data.stride + this.offset + 2 ];\r\n\t\r\n\t\t},\r\n\t\r\n\t\tgetW: function ( index ) {\r\n\t\r\n\t\t\treturn this.data.array[ index * this.data.stride + this.offset + 3 ];\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetXY: function ( index, x, y ) {\r\n\t\r\n\t\t\tindex = index * this.data.stride + this.offset;\r\n\t\r\n\t\t\tthis.data.array[ index + 0 ] = x;\r\n\t\t\tthis.data.array[ index + 1 ] = y;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetXYZ: function ( index, x, y, z ) {\r\n\t\r\n\t\t\tindex = index * this.data.stride + this.offset;\r\n\t\r\n\t\t\tthis.data.array[ index + 0 ] = x;\r\n\t\t\tthis.data.array[ index + 1 ] = y;\r\n\t\t\tthis.data.array[ index + 2 ] = z;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetXYZW: function ( index, x, y, z, w ) {\r\n\t\r\n\t\t\tindex = index * this.data.stride + this.offset;\r\n\t\r\n\t\t\tthis.data.array[ index + 0 ] = x;\r\n\t\t\tthis.data.array[ index + 1 ] = y;\r\n\t\t\tthis.data.array[ index + 2 ] = z;\r\n\t\t\tthis.data.array[ index + 3 ] = w;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/core/Geometry.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author kile / http://kile.stravaganza.org/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\r\n\t * @author bhouston / http://clara.io\r\n\t */\r\n\t\r\n\tTHREE.Geometry = function () {\r\n\t\r\n\t\tObject.defineProperty( this, 'id', { value: THREE.GeometryIdCount ++ } );\r\n\t\r\n\t\tthis.uuid = THREE.Math.generateUUID();\r\n\t\r\n\t\tthis.name = '';\r\n\t\tthis.type = 'Geometry';\r\n\t\r\n\t\tthis.vertices = [];\r\n\t\tthis.colors = [];\r\n\t\tthis.faces = [];\r\n\t\tthis.faceVertexUvs = [ [] ];\r\n\t\r\n\t\tthis.morphTargets = [];\r\n\t\tthis.morphNormals = [];\r\n\t\r\n\t\tthis.skinWeights = [];\r\n\t\tthis.skinIndices = [];\r\n\t\r\n\t\tthis.lineDistances = [];\r\n\t\r\n\t\tthis.boundingBox = null;\r\n\t\tthis.boundingSphere = null;\r\n\t\r\n\t\t// update flags\r\n\t\r\n\t\tthis.verticesNeedUpdate = false;\r\n\t\tthis.elementsNeedUpdate = false;\r\n\t\tthis.uvsNeedUpdate = false;\r\n\t\tthis.normalsNeedUpdate = false;\r\n\t\tthis.colorsNeedUpdate = false;\r\n\t\tthis.lineDistancesNeedUpdate = false;\r\n\t\tthis.groupsNeedUpdate = false;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Geometry.prototype = {\r\n\t\r\n\t\tconstructor: THREE.Geometry,\r\n\t\r\n\t\tapplyMatrix: function ( matrix ) {\r\n\t\r\n\t\t\tvar normalMatrix = new THREE.Matrix3().getNormalMatrix( matrix );\r\n\t\r\n\t\t\tfor ( var i = 0, il = this.vertices.length; i < il; i ++ ) {\r\n\t\r\n\t\t\t\tvar vertex = this.vertices[ i ];\r\n\t\t\t\tvertex.applyMatrix4( matrix );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tfor ( var i = 0, il = this.faces.length; i < il; i ++ ) {\r\n\t\r\n\t\t\t\tvar face = this.faces[ i ];\r\n\t\t\t\tface.normal.applyMatrix3( normalMatrix ).normalize();\r\n\t\r\n\t\t\t\tfor ( var j = 0, jl = face.vertexNormals.length; j < jl; j ++ ) {\r\n\t\r\n\t\t\t\t\tface.vertexNormals[ j ].applyMatrix3( normalMatrix ).normalize();\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( this.boundingBox !== null ) {\r\n\t\r\n\t\t\t\tthis.computeBoundingBox();\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( this.boundingSphere !== null ) {\r\n\t\r\n\t\t\t\tthis.computeBoundingSphere();\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tthis.verticesNeedUpdate = true;\r\n\t\t\tthis.normalsNeedUpdate = true;\r\n\t\r\n\t\t},\r\n\t\r\n\t\trotateX: function () {\r\n\t\r\n\t\t\t// rotate geometry around world x-axis\r\n\t\r\n\t\t\tvar m1;\r\n\t\r\n\t\t\treturn function rotateX( angle ) {\r\n\t\r\n\t\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\r\n\t\r\n\t\t\t\tm1.makeRotationX( angle );\r\n\t\r\n\t\t\t\tthis.applyMatrix( m1 );\r\n\t\r\n\t\t\t\treturn this;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\trotateY: function () {\r\n\t\r\n\t\t\t// rotate geometry around world y-axis\r\n\t\r\n\t\t\tvar m1;\r\n\t\r\n\t\t\treturn function rotateY( angle ) {\r\n\t\r\n\t\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\r\n\t\r\n\t\t\t\tm1.makeRotationY( angle );\r\n\t\r\n\t\t\t\tthis.applyMatrix( m1 );\r\n\t\r\n\t\t\t\treturn this;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\trotateZ: function () {\r\n\t\r\n\t\t\t// rotate geometry around world z-axis\r\n\t\r\n\t\t\tvar m1;\r\n\t\r\n\t\t\treturn function rotateZ( angle ) {\r\n\t\r\n\t\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\r\n\t\r\n\t\t\t\tm1.makeRotationZ( angle );\r\n\t\r\n\t\t\t\tthis.applyMatrix( m1 );\r\n\t\r\n\t\t\t\treturn this;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\ttranslate: function () {\r\n\t\r\n\t\t\t// translate geometry\r\n\t\r\n\t\t\tvar m1;\r\n\t\r\n\t\t\treturn function translate( x, y, z ) {\r\n\t\r\n\t\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\r\n\t\r\n\t\t\t\tm1.makeTranslation( x, y, z );\r\n\t\r\n\t\t\t\tthis.applyMatrix( m1 );\r\n\t\r\n\t\t\t\treturn this;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tscale: function () {\r\n\t\r\n\t\t\t// scale geometry\r\n\t\r\n\t\t\tvar m1;\r\n\t\r\n\t\t\treturn function scale( x, y, z ) {\r\n\t\r\n\t\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\r\n\t\r\n\t\t\t\tm1.makeScale( x, y, z );\r\n\t\r\n\t\t\t\tthis.applyMatrix( m1 );\r\n\t\r\n\t\t\t\treturn this;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tlookAt: function () {\r\n\t\r\n\t\t\tvar obj;\r\n\t\r\n\t\t\treturn function lookAt( vector ) {\r\n\t\r\n\t\t\t\tif ( obj === undefined ) obj = new THREE.Object3D();\r\n\t\r\n\t\t\t\tobj.lookAt( vector );\r\n\t\r\n\t\t\t\tobj.updateMatrix();\r\n\t\r\n\t\t\t\tthis.applyMatrix( obj.matrix );\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tfromBufferGeometry: function ( geometry ) {\r\n\t\r\n\t\t\tvar scope = this;\r\n\t\r\n\t\t\tvar indices = geometry.index !== null ? geometry.index.array : undefined;\r\n\t\t\tvar attributes = geometry.attributes;\r\n\t\r\n\t\t\tvar vertices = attributes.position.array;\r\n\t\t\tvar normals = attributes.normal !== undefined ? attributes.normal.array : undefined;\r\n\t\t\tvar colors = attributes.color !== undefined ? attributes.color.array : undefined;\r\n\t\t\tvar uvs = attributes.uv !== undefined ? attributes.uv.array : undefined;\r\n\t\t\tvar uvs2 = attributes.uv2 !== undefined ? attributes.uv2.array : undefined;\r\n\t\r\n\t\t\tif ( uvs2 !== undefined ) this.faceVertexUvs[ 1 ] = [];\r\n\t\r\n\t\t\tvar tempNormals = [];\r\n\t\t\tvar tempUVs = [];\r\n\t\t\tvar tempUVs2 = [];\r\n\t\r\n\t\t\tfor ( var i = 0, j = 0, k = 0; i < vertices.length; i += 3, j += 2, k += 4 ) {\r\n\t\r\n\t\t\t\tscope.vertices.push( new THREE.Vector3( vertices[ i ], vertices[ i + 1 ], vertices[ i + 2 ] ) );\r\n\t\r\n\t\t\t\tif ( normals !== undefined ) {\r\n\t\r\n\t\t\t\t\ttempNormals.push( new THREE.Vector3( normals[ i ], normals[ i + 1 ], normals[ i + 2 ] ) );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( colors !== undefined ) {\r\n\t\r\n\t\t\t\t\tscope.colors.push( new THREE.Color( colors[ i ], colors[ i + 1 ], colors[ i + 2 ] ) );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( uvs !== undefined ) {\r\n\t\r\n\t\t\t\t\ttempUVs.push( new THREE.Vector2( uvs[ j ], uvs[ j + 1 ] ) );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( uvs2 !== undefined ) {\r\n\t\r\n\t\t\t\t\ttempUVs2.push( new THREE.Vector2( uvs2[ j ], uvs2[ j + 1 ] ) );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tfunction addFace( a, b, c ) {\r\n\t\r\n\t\t\t\tvar vertexNormals = normals !== undefined ? [ tempNormals[ a ].clone(), tempNormals[ b ].clone(), tempNormals[ c ].clone() ] : [];\r\n\t\t\t\tvar vertexColors = colors !== undefined ? [ scope.colors[ a ].clone(), scope.colors[ b ].clone(), scope.colors[ c ].clone() ] : [];\r\n\t\r\n\t\t\t\tvar face = new THREE.Face3( a, b, c, vertexNormals, vertexColors );\r\n\t\r\n\t\t\t\tscope.faces.push( face );\r\n\t\r\n\t\t\t\tif ( uvs !== undefined ) {\r\n\t\r\n\t\t\t\t\tscope.faceVertexUvs[ 0 ].push( [ tempUVs[ a ].clone(), tempUVs[ b ].clone(), tempUVs[ c ].clone() ] );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( uvs2 !== undefined ) {\r\n\t\r\n\t\t\t\t\tscope.faceVertexUvs[ 1 ].push( [ tempUVs2[ a ].clone(), tempUVs2[ b ].clone(), tempUVs2[ c ].clone() ] );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t\tif ( indices !== undefined ) {\r\n\t\r\n\t\t\t\tvar groups = geometry.groups;\r\n\t\r\n\t\t\t\tif ( groups.length > 0 ) {\r\n\t\r\n\t\t\t\t\tfor ( var i = 0; i < groups.length; i ++ ) {\r\n\t\r\n\t\t\t\t\t\tvar group = groups[ i ];\r\n\t\r\n\t\t\t\t\t\tvar start = group.start;\r\n\t\t\t\t\t\tvar count = group.count;\r\n\t\r\n\t\t\t\t\t\tfor ( var j = start, jl = start + count; j < jl; j += 3 ) {\r\n\t\r\n\t\t\t\t\t\t\taddFace( indices[ j ], indices[ j + 1 ], indices[ j + 2 ] );\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tfor ( var i = 0; i < indices.length; i += 3 ) {\r\n\t\r\n\t\t\t\t\t\taddFace( indices[ i ], indices[ i + 1 ], indices[ i + 2 ] );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\tfor ( var i = 0; i < vertices.length / 3; i += 3 ) {\r\n\t\r\n\t\t\t\t\taddFace( i, i + 1, i + 2 );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tthis.computeFaceNormals();\r\n\t\r\n\t\t\tif ( geometry.boundingBox !== null ) {\r\n\t\r\n\t\t\t\tthis.boundingBox = geometry.boundingBox.clone();\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( geometry.boundingSphere !== null ) {\r\n\t\r\n\t\t\t\tthis.boundingSphere = geometry.boundingSphere.clone();\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcenter: function () {\r\n\t\r\n\t\t\tthis.computeBoundingBox();\r\n\t\r\n\t\t\tvar offset = this.boundingBox.center().negate();\r\n\t\r\n\t\t\tthis.translate( offset.x, offset.y, offset.z );\r\n\t\r\n\t\t\treturn offset;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tnormalize: function () {\r\n\t\r\n\t\t\tthis.computeBoundingSphere();\r\n\t\r\n\t\t\tvar center = this.boundingSphere.center;\r\n\t\t\tvar radius = this.boundingSphere.radius;\r\n\t\r\n\t\t\tvar s = radius === 0 ? 1 : 1.0 / radius;\r\n\t\r\n\t\t\tvar matrix = new THREE.Matrix4();\r\n\t\t\tmatrix.set(\r\n\t\t\t\ts, 0, 0, - s * center.x,\r\n\t\t\t\t0, s, 0, - s * center.y,\r\n\t\t\t\t0, 0, s, - s * center.z,\r\n\t\t\t\t0, 0, 0, 1\r\n\t\t\t);\r\n\t\r\n\t\t\tthis.applyMatrix( matrix );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcomputeFaceNormals: function () {\r\n\t\r\n\t\t\tvar cb = new THREE.Vector3(), ab = new THREE.Vector3();\r\n\t\r\n\t\t\tfor ( var f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\t\r\n\t\t\t\tvar face = this.faces[ f ];\r\n\t\r\n\t\t\t\tvar vA = this.vertices[ face.a ];\r\n\t\t\t\tvar vB = this.vertices[ face.b ];\r\n\t\t\t\tvar vC = this.vertices[ face.c ];\r\n\t\r\n\t\t\t\tcb.subVectors( vC, vB );\r\n\t\t\t\tab.subVectors( vA, vB );\r\n\t\t\t\tcb.cross( ab );\r\n\t\r\n\t\t\t\tcb.normalize();\r\n\t\r\n\t\t\t\tface.normal.copy( cb );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcomputeVertexNormals: function ( areaWeighted ) {\r\n\t\r\n\t\t\tvar v, vl, f, fl, face, vertices;\r\n\t\r\n\t\t\tvertices = new Array( this.vertices.length );\r\n\t\r\n\t\t\tfor ( v = 0, vl = this.vertices.length; v < vl; v ++ ) {\r\n\t\r\n\t\t\t\tvertices[ v ] = new THREE.Vector3();\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( areaWeighted ) {\r\n\t\r\n\t\t\t\t// vertex normals weighted by triangle areas\r\n\t\t\t\t// http://www.iquilezles.org/www/articles/normals/normals.htm\r\n\t\r\n\t\t\t\tvar vA, vB, vC;\r\n\t\t\t\tvar cb = new THREE.Vector3(), ab = new THREE.Vector3();\r\n\t\r\n\t\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\t\r\n\t\t\t\t\tface = this.faces[ f ];\r\n\t\r\n\t\t\t\t\tvA = this.vertices[ face.a ];\r\n\t\t\t\t\tvB = this.vertices[ face.b ];\r\n\t\t\t\t\tvC = this.vertices[ face.c ];\r\n\t\r\n\t\t\t\t\tcb.subVectors( vC, vB );\r\n\t\t\t\t\tab.subVectors( vA, vB );\r\n\t\t\t\t\tcb.cross( ab );\r\n\t\r\n\t\t\t\t\tvertices[ face.a ].add( cb );\r\n\t\t\t\t\tvertices[ face.b ].add( cb );\r\n\t\t\t\t\tvertices[ face.c ].add( cb );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\t\r\n\t\t\t\t\tface = this.faces[ f ];\r\n\t\r\n\t\t\t\t\tvertices[ face.a ].add( face.normal );\r\n\t\t\t\t\tvertices[ face.b ].add( face.normal );\r\n\t\t\t\t\tvertices[ face.c ].add( face.normal );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tfor ( v = 0, vl = this.vertices.length; v < vl; v ++ ) {\r\n\t\r\n\t\t\t\tvertices[ v ].normalize();\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\t\r\n\t\t\t\tface = this.faces[ f ];\r\n\t\r\n\t\t\t\tvar vertexNormals = face.vertexNormals;\r\n\t\r\n\t\t\t\tif ( vertexNormals.length === 3 ) {\r\n\t\r\n\t\t\t\t\tvertexNormals[ 0 ].copy( vertices[ face.a ] );\r\n\t\t\t\t\tvertexNormals[ 1 ].copy( vertices[ face.b ] );\r\n\t\t\t\t\tvertexNormals[ 2 ].copy( vertices[ face.c ] );\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tvertexNormals[ 0 ] = vertices[ face.a ].clone();\r\n\t\t\t\t\tvertexNormals[ 1 ] = vertices[ face.b ].clone();\r\n\t\t\t\t\tvertexNormals[ 2 ] = vertices[ face.c ].clone();\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcomputeMorphNormals: function () {\r\n\t\r\n\t\t\tvar i, il, f, fl, face;\r\n\t\r\n\t\t\t// save original normals\r\n\t\t\t// - create temp variables on first access\r\n\t\t\t//   otherwise just copy (for faster repeated calls)\r\n\t\r\n\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\t\r\n\t\t\t\tface = this.faces[ f ];\r\n\t\r\n\t\t\t\tif ( ! face.__originalFaceNormal ) {\r\n\t\r\n\t\t\t\t\tface.__originalFaceNormal = face.normal.clone();\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tface.__originalFaceNormal.copy( face.normal );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( ! face.__originalVertexNormals ) face.__originalVertexNormals = [];\r\n\t\r\n\t\t\t\tfor ( i = 0, il = face.vertexNormals.length; i < il; i ++ ) {\r\n\t\r\n\t\t\t\t\tif ( ! face.__originalVertexNormals[ i ] ) {\r\n\t\r\n\t\t\t\t\t\tface.__originalVertexNormals[ i ] = face.vertexNormals[ i ].clone();\r\n\t\r\n\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\tface.__originalVertexNormals[ i ].copy( face.vertexNormals[ i ] );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// use temp geometry to compute face and vertex normals for each morph\r\n\t\r\n\t\t\tvar tmpGeo = new THREE.Geometry();\r\n\t\t\ttmpGeo.faces = this.faces;\r\n\t\r\n\t\t\tfor ( i = 0, il = this.morphTargets.length; i < il; i ++ ) {\r\n\t\r\n\t\t\t\t// create on first access\r\n\t\r\n\t\t\t\tif ( ! this.morphNormals[ i ] ) {\r\n\t\r\n\t\t\t\t\tthis.morphNormals[ i ] = {};\r\n\t\t\t\t\tthis.morphNormals[ i ].faceNormals = [];\r\n\t\t\t\t\tthis.morphNormals[ i ].vertexNormals = [];\r\n\t\r\n\t\t\t\t\tvar dstNormalsFace = this.morphNormals[ i ].faceNormals;\r\n\t\t\t\t\tvar dstNormalsVertex = this.morphNormals[ i ].vertexNormals;\r\n\t\r\n\t\t\t\t\tvar faceNormal, vertexNormals;\r\n\t\r\n\t\t\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\t\r\n\t\t\t\t\t\tfaceNormal = new THREE.Vector3();\r\n\t\t\t\t\t\tvertexNormals = { a: new THREE.Vector3(), b: new THREE.Vector3(), c: new THREE.Vector3() };\r\n\t\r\n\t\t\t\t\t\tdstNormalsFace.push( faceNormal );\r\n\t\t\t\t\t\tdstNormalsVertex.push( vertexNormals );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tvar morphNormals = this.morphNormals[ i ];\r\n\t\r\n\t\t\t\t// set vertices to morph target\r\n\t\r\n\t\t\t\ttmpGeo.vertices = this.morphTargets[ i ].vertices;\r\n\t\r\n\t\t\t\t// compute morph normals\r\n\t\r\n\t\t\t\ttmpGeo.computeFaceNormals();\r\n\t\t\t\ttmpGeo.computeVertexNormals();\r\n\t\r\n\t\t\t\t// store morph normals\r\n\t\r\n\t\t\t\tvar faceNormal, vertexNormals;\r\n\t\r\n\t\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\t\r\n\t\t\t\t\tface = this.faces[ f ];\r\n\t\r\n\t\t\t\t\tfaceNormal = morphNormals.faceNormals[ f ];\r\n\t\t\t\t\tvertexNormals = morphNormals.vertexNormals[ f ];\r\n\t\r\n\t\t\t\t\tfaceNormal.copy( face.normal );\r\n\t\r\n\t\t\t\t\tvertexNormals.a.copy( face.vertexNormals[ 0 ] );\r\n\t\t\t\t\tvertexNormals.b.copy( face.vertexNormals[ 1 ] );\r\n\t\t\t\t\tvertexNormals.c.copy( face.vertexNormals[ 2 ] );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// restore original normals\r\n\t\r\n\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\t\r\n\t\t\t\tface = this.faces[ f ];\r\n\t\r\n\t\t\t\tface.normal = face.__originalFaceNormal;\r\n\t\t\t\tface.vertexNormals = face.__originalVertexNormals;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcomputeTangents: function () {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.Geometry: .computeTangents() has been removed.' );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcomputeLineDistances: function () {\r\n\t\r\n\t\t\tvar d = 0;\r\n\t\t\tvar vertices = this.vertices;\r\n\t\r\n\t\t\tfor ( var i = 0, il = vertices.length; i < il; i ++ ) {\r\n\t\r\n\t\t\t\tif ( i > 0 ) {\r\n\t\r\n\t\t\t\t\td += vertices[ i ].distanceTo( vertices[ i - 1 ] );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tthis.lineDistances[ i ] = d;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcomputeBoundingBox: function () {\r\n\t\r\n\t\t\tif ( this.boundingBox === null ) {\r\n\t\r\n\t\t\t\tthis.boundingBox = new THREE.Box3();\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tthis.boundingBox.setFromPoints( this.vertices );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcomputeBoundingSphere: function () {\r\n\t\r\n\t\t\tif ( this.boundingSphere === null ) {\r\n\t\r\n\t\t\t\tthis.boundingSphere = new THREE.Sphere();\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tthis.boundingSphere.setFromPoints( this.vertices );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tmerge: function ( geometry, matrix, materialIndexOffset ) {\r\n\t\r\n\t\t\tif ( geometry instanceof THREE.Geometry === false ) {\r\n\t\r\n\t\t\t\tconsole.error( 'THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.', geometry );\r\n\t\t\t\treturn;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar normalMatrix,\r\n\t\t\tvertexOffset = this.vertices.length,\r\n\t\t\tvertices1 = this.vertices,\r\n\t\t\tvertices2 = geometry.vertices,\r\n\t\t\tfaces1 = this.faces,\r\n\t\t\tfaces2 = geometry.faces,\r\n\t\t\tuvs1 = this.faceVertexUvs[ 0 ],\r\n\t\t\tuvs2 = geometry.faceVertexUvs[ 0 ];\r\n\t\r\n\t\t\tif ( materialIndexOffset === undefined ) materialIndexOffset = 0;\r\n\t\r\n\t\t\tif ( matrix !== undefined ) {\r\n\t\r\n\t\t\t\tnormalMatrix = new THREE.Matrix3().getNormalMatrix( matrix );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// vertices\r\n\t\r\n\t\t\tfor ( var i = 0, il = vertices2.length; i < il; i ++ ) {\r\n\t\r\n\t\t\t\tvar vertex = vertices2[ i ];\r\n\t\r\n\t\t\t\tvar vertexCopy = vertex.clone();\r\n\t\r\n\t\t\t\tif ( matrix !== undefined ) vertexCopy.applyMatrix4( matrix );\r\n\t\r\n\t\t\t\tvertices1.push( vertexCopy );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// faces\r\n\t\r\n\t\t\tfor ( i = 0, il = faces2.length; i < il; i ++ ) {\r\n\t\r\n\t\t\t\tvar face = faces2[ i ], faceCopy, normal, color,\r\n\t\t\t\tfaceVertexNormals = face.vertexNormals,\r\n\t\t\t\tfaceVertexColors = face.vertexColors;\r\n\t\r\n\t\t\t\tfaceCopy = new THREE.Face3( face.a + vertexOffset, face.b + vertexOffset, face.c + vertexOffset );\r\n\t\t\t\tfaceCopy.normal.copy( face.normal );\r\n\t\r\n\t\t\t\tif ( normalMatrix !== undefined ) {\r\n\t\r\n\t\t\t\t\tfaceCopy.normal.applyMatrix3( normalMatrix ).normalize();\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tfor ( var j = 0, jl = faceVertexNormals.length; j < jl; j ++ ) {\r\n\t\r\n\t\t\t\t\tnormal = faceVertexNormals[ j ].clone();\r\n\t\r\n\t\t\t\t\tif ( normalMatrix !== undefined ) {\r\n\t\r\n\t\t\t\t\t\tnormal.applyMatrix3( normalMatrix ).normalize();\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tfaceCopy.vertexNormals.push( normal );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tfaceCopy.color.copy( face.color );\r\n\t\r\n\t\t\t\tfor ( var j = 0, jl = faceVertexColors.length; j < jl; j ++ ) {\r\n\t\r\n\t\t\t\t\tcolor = faceVertexColors[ j ];\r\n\t\t\t\t\tfaceCopy.vertexColors.push( color.clone() );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tfaceCopy.materialIndex = face.materialIndex + materialIndexOffset;\r\n\t\r\n\t\t\t\tfaces1.push( faceCopy );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// uvs\r\n\t\r\n\t\t\tfor ( i = 0, il = uvs2.length; i < il; i ++ ) {\r\n\t\r\n\t\t\t\tvar uv = uvs2[ i ], uvCopy = [];\r\n\t\r\n\t\t\t\tif ( uv === undefined ) {\r\n\t\r\n\t\t\t\t\tcontinue;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tfor ( var j = 0, jl = uv.length; j < jl; j ++ ) {\r\n\t\r\n\t\t\t\t\tuvCopy.push( uv[ j ].clone() );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tuvs1.push( uvCopy );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t},\r\n\t\r\n\t\tmergeMesh: function ( mesh ) {\r\n\t\r\n\t\t\tif ( mesh instanceof THREE.Mesh === false ) {\r\n\t\r\n\t\t\t\tconsole.error( 'THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.', mesh );\r\n\t\t\t\treturn;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tmesh.matrixAutoUpdate && mesh.updateMatrix();\r\n\t\r\n\t\t\tthis.merge( mesh.geometry, mesh.matrix );\r\n\t\r\n\t\t},\r\n\t\r\n\t\t/*\r\n\t\t * Checks for duplicate vertices with hashmap.\r\n\t\t * Duplicated vertices are removed\r\n\t\t * and faces' vertices are updated.\r\n\t\t */\r\n\t\r\n\t\tmergeVertices: function () {\r\n\t\r\n\t\t\tvar verticesMap = {}; // Hashmap for looking up vertices by position coordinates (and making sure they are unique)\r\n\t\t\tvar unique = [], changes = [];\r\n\t\r\n\t\t\tvar v, key;\r\n\t\t\tvar precisionPoints = 4; // number of decimal points, e.g. 4 for epsilon of 0.0001\r\n\t\t\tvar precision = Math.pow( 10, precisionPoints );\r\n\t\t\tvar i, il, face;\r\n\t\t\tvar indices, j, jl;\r\n\t\r\n\t\t\tfor ( i = 0, il = this.vertices.length; i < il; i ++ ) {\r\n\t\r\n\t\t\t\tv = this.vertices[ i ];\r\n\t\t\t\tkey = Math.round( v.x * precision ) + '_' + Math.round( v.y * precision ) + '_' + Math.round( v.z * precision );\r\n\t\r\n\t\t\t\tif ( verticesMap[ key ] === undefined ) {\r\n\t\r\n\t\t\t\t\tverticesMap[ key ] = i;\r\n\t\t\t\t\tunique.push( this.vertices[ i ] );\r\n\t\t\t\t\tchanges[ i ] = unique.length - 1;\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t//console.log('Duplicate vertex found. ', i, ' could be using ', verticesMap[key]);\r\n\t\t\t\t\tchanges[ i ] = changes[ verticesMap[ key ] ];\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\r\n\t\t\t// if faces are completely degenerate after merging vertices, we\r\n\t\t\t// have to remove them from the geometry.\r\n\t\t\tvar faceIndicesToRemove = [];\r\n\t\r\n\t\t\tfor ( i = 0, il = this.faces.length; i < il; i ++ ) {\r\n\t\r\n\t\t\t\tface = this.faces[ i ];\r\n\t\r\n\t\t\t\tface.a = changes[ face.a ];\r\n\t\t\t\tface.b = changes[ face.b ];\r\n\t\t\t\tface.c = changes[ face.c ];\r\n\t\r\n\t\t\t\tindices = [ face.a, face.b, face.c ];\r\n\t\r\n\t\t\t\tvar dupIndex = - 1;\r\n\t\r\n\t\t\t\t// if any duplicate vertices are found in a Face3\r\n\t\t\t\t// we have to remove the face as nothing can be saved\r\n\t\t\t\tfor ( var n = 0; n < 3; n ++ ) {\r\n\t\r\n\t\t\t\t\tif ( indices[ n ] === indices[ ( n + 1 ) % 3 ] ) {\r\n\t\r\n\t\t\t\t\t\tdupIndex = n;\r\n\t\t\t\t\t\tfaceIndicesToRemove.push( i );\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tfor ( i = faceIndicesToRemove.length - 1; i >= 0; i -- ) {\r\n\t\r\n\t\t\t\tvar idx = faceIndicesToRemove[ i ];\r\n\t\r\n\t\t\t\tthis.faces.splice( idx, 1 );\r\n\t\r\n\t\t\t\tfor ( j = 0, jl = this.faceVertexUvs.length; j < jl; j ++ ) {\r\n\t\r\n\t\t\t\t\tthis.faceVertexUvs[ j ].splice( idx, 1 );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// Use unique set of vertices\r\n\t\r\n\t\t\tvar diff = this.vertices.length - unique.length;\r\n\t\t\tthis.vertices = unique;\r\n\t\t\treturn diff;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsortFacesByMaterialIndex: function () {\r\n\t\r\n\t\t\tvar faces = this.faces;\r\n\t\t\tvar length = faces.length;\r\n\t\r\n\t\t\t// tag faces\r\n\t\r\n\t\t\tfor ( var i = 0; i < length; i ++ ) {\r\n\t\r\n\t\t\t\tfaces[ i ]._id = i;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// sort faces\r\n\t\r\n\t\t\tfunction materialIndexSort( a, b ) {\r\n\t\r\n\t\t\t\treturn a.materialIndex - b.materialIndex;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tfaces.sort( materialIndexSort );\r\n\t\r\n\t\t\t// sort uvs\r\n\t\r\n\t\t\tvar uvs1 = this.faceVertexUvs[ 0 ];\r\n\t\t\tvar uvs2 = this.faceVertexUvs[ 1 ];\r\n\t\r\n\t\t\tvar newUvs1, newUvs2;\r\n\t\r\n\t\t\tif ( uvs1 && uvs1.length === length ) newUvs1 = [];\r\n\t\t\tif ( uvs2 && uvs2.length === length ) newUvs2 = [];\r\n\t\r\n\t\t\tfor ( var i = 0; i < length; i ++ ) {\r\n\t\r\n\t\t\t\tvar id = faces[ i ]._id;\r\n\t\r\n\t\t\t\tif ( newUvs1 ) newUvs1.push( uvs1[ id ] );\r\n\t\t\t\tif ( newUvs2 ) newUvs2.push( uvs2[ id ] );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( newUvs1 ) this.faceVertexUvs[ 0 ] = newUvs1;\r\n\t\t\tif ( newUvs2 ) this.faceVertexUvs[ 1 ] = newUvs2;\r\n\t\r\n\t\t},\r\n\t\r\n\t\ttoJSON: function () {\r\n\t\r\n\t\t\tvar data = {\r\n\t\t\t\tmetadata: {\r\n\t\t\t\t\tversion: 4.4,\r\n\t\t\t\t\ttype: 'Geometry',\r\n\t\t\t\t\tgenerator: 'Geometry.toJSON'\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\r\n\t\t\t// standard Geometry serialization\r\n\t\r\n\t\t\tdata.uuid = this.uuid;\r\n\t\t\tdata.type = this.type;\r\n\t\t\tif ( this.name !== '' ) data.name = this.name;\r\n\t\r\n\t\t\tif ( this.parameters !== undefined ) {\r\n\t\r\n\t\t\t\tvar parameters = this.parameters;\r\n\t\r\n\t\t\t\tfor ( var key in parameters ) {\r\n\t\r\n\t\t\t\t\tif ( parameters[ key ] !== undefined ) data[ key ] = parameters[ key ];\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\treturn data;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar vertices = [];\r\n\t\r\n\t\t\tfor ( var i = 0; i < this.vertices.length; i ++ ) {\r\n\t\r\n\t\t\t\tvar vertex = this.vertices[ i ];\r\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar faces = [];\r\n\t\t\tvar normals = [];\r\n\t\t\tvar normalsHash = {};\r\n\t\t\tvar colors = [];\r\n\t\t\tvar colorsHash = {};\r\n\t\t\tvar uvs = [];\r\n\t\t\tvar uvsHash = {};\r\n\t\r\n\t\t\tfor ( var i = 0; i < this.faces.length; i ++ ) {\r\n\t\r\n\t\t\t\tvar face = this.faces[ i ];\r\n\t\r\n\t\t\t\tvar hasMaterial = false; // face.materialIndex !== undefined;\r\n\t\t\t\tvar hasFaceUv = false; // deprecated\r\n\t\t\t\tvar hasFaceVertexUv = this.faceVertexUvs[ 0 ][ i ] !== undefined;\r\n\t\t\t\tvar hasFaceNormal = face.normal.length() > 0;\r\n\t\t\t\tvar hasFaceVertexNormal = face.vertexNormals.length > 0;\r\n\t\t\t\tvar hasFaceColor = face.color.r !== 1 || face.color.g !== 1 || face.color.b !== 1;\r\n\t\t\t\tvar hasFaceVertexColor = face.vertexColors.length > 0;\r\n\t\r\n\t\t\t\tvar faceType = 0;\r\n\t\r\n\t\t\t\tfaceType = setBit( faceType, 0, 0 );\r\n\t\t\t\tfaceType = setBit( faceType, 1, hasMaterial );\r\n\t\t\t\tfaceType = setBit( faceType, 2, hasFaceUv );\r\n\t\t\t\tfaceType = setBit( faceType, 3, hasFaceVertexUv );\r\n\t\t\t\tfaceType = setBit( faceType, 4, hasFaceNormal );\r\n\t\t\t\tfaceType = setBit( faceType, 5, hasFaceVertexNormal );\r\n\t\t\t\tfaceType = setBit( faceType, 6, hasFaceColor );\r\n\t\t\t\tfaceType = setBit( faceType, 7, hasFaceVertexColor );\r\n\t\r\n\t\t\t\tfaces.push( faceType );\r\n\t\t\t\tfaces.push( face.a, face.b, face.c );\r\n\t\r\n\t\t\t\tif ( hasFaceVertexUv ) {\r\n\t\r\n\t\t\t\t\tvar faceVertexUvs = this.faceVertexUvs[ 0 ][ i ];\r\n\t\r\n\t\t\t\t\tfaces.push(\r\n\t\t\t\t\t\tgetUvIndex( faceVertexUvs[ 0 ] ),\r\n\t\t\t\t\t\tgetUvIndex( faceVertexUvs[ 1 ] ),\r\n\t\t\t\t\t\tgetUvIndex( faceVertexUvs[ 2 ] )\r\n\t\t\t\t\t);\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( hasFaceNormal ) {\r\n\t\r\n\t\t\t\t\tfaces.push( getNormalIndex( face.normal ) );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( hasFaceVertexNormal ) {\r\n\t\r\n\t\t\t\t\tvar vertexNormals = face.vertexNormals;\r\n\t\r\n\t\t\t\t\tfaces.push(\r\n\t\t\t\t\t\tgetNormalIndex( vertexNormals[ 0 ] ),\r\n\t\t\t\t\t\tgetNormalIndex( vertexNormals[ 1 ] ),\r\n\t\t\t\t\t\tgetNormalIndex( vertexNormals[ 2 ] )\r\n\t\t\t\t\t);\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( hasFaceColor ) {\r\n\t\r\n\t\t\t\t\tfaces.push( getColorIndex( face.color ) );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( hasFaceVertexColor ) {\r\n\t\r\n\t\t\t\t\tvar vertexColors = face.vertexColors;\r\n\t\r\n\t\t\t\t\tfaces.push(\r\n\t\t\t\t\t\tgetColorIndex( vertexColors[ 0 ] ),\r\n\t\t\t\t\t\tgetColorIndex( vertexColors[ 1 ] ),\r\n\t\t\t\t\t\tgetColorIndex( vertexColors[ 2 ] )\r\n\t\t\t\t\t);\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tfunction setBit( value, position, enabled ) {\r\n\t\r\n\t\t\t\treturn enabled ? value | ( 1 << position ) : value & ( ~ ( 1 << position ) );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tfunction getNormalIndex( normal ) {\r\n\t\r\n\t\t\t\tvar hash = normal.x.toString() + normal.y.toString() + normal.z.toString();\r\n\t\r\n\t\t\t\tif ( normalsHash[ hash ] !== undefined ) {\r\n\t\r\n\t\t\t\t\treturn normalsHash[ hash ];\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tnormalsHash[ hash ] = normals.length / 3;\r\n\t\t\t\tnormals.push( normal.x, normal.y, normal.z );\r\n\t\r\n\t\t\t\treturn normalsHash[ hash ];\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tfunction getColorIndex( color ) {\r\n\t\r\n\t\t\t\tvar hash = color.r.toString() + color.g.toString() + color.b.toString();\r\n\t\r\n\t\t\t\tif ( colorsHash[ hash ] !== undefined ) {\r\n\t\r\n\t\t\t\t\treturn colorsHash[ hash ];\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tcolorsHash[ hash ] = colors.length;\r\n\t\t\t\tcolors.push( color.getHex() );\r\n\t\r\n\t\t\t\treturn colorsHash[ hash ];\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tfunction getUvIndex( uv ) {\r\n\t\r\n\t\t\t\tvar hash = uv.x.toString() + uv.y.toString();\r\n\t\r\n\t\t\t\tif ( uvsHash[ hash ] !== undefined ) {\r\n\t\r\n\t\t\t\t\treturn uvsHash[ hash ];\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tuvsHash[ hash ] = uvs.length / 2;\r\n\t\t\t\tuvs.push( uv.x, uv.y );\r\n\t\r\n\t\t\t\treturn uvsHash[ hash ];\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tdata.data = {};\r\n\t\r\n\t\t\tdata.data.vertices = vertices;\r\n\t\t\tdata.data.normals = normals;\r\n\t\t\tif ( colors.length > 0 ) data.data.colors = colors;\r\n\t\t\tif ( uvs.length > 0 ) data.data.uvs = [ uvs ]; // temporal backward compatibility\r\n\t\t\tdata.data.faces = faces;\r\n\t\r\n\t\t\treturn data;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tclone: function () {\r\n\t\r\n\t\t\treturn new this.constructor().copy( this );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcopy: function ( source ) {\r\n\t\r\n\t\t\tthis.vertices = [];\r\n\t\t\tthis.faces = [];\r\n\t\t\tthis.faceVertexUvs = [ [] ];\r\n\t\r\n\t\t\tvar vertices = source.vertices;\r\n\t\r\n\t\t\tfor ( var i = 0, il = vertices.length; i < il; i ++ ) {\r\n\t\r\n\t\t\t\tthis.vertices.push( vertices[ i ].clone() );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar faces = source.faces;\r\n\t\r\n\t\t\tfor ( var i = 0, il = faces.length; i < il; i ++ ) {\r\n\t\r\n\t\t\t\tthis.faces.push( faces[ i ].clone() );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tfor ( var i = 0, il = source.faceVertexUvs.length; i < il; i ++ ) {\r\n\t\r\n\t\t\t\tvar faceVertexUvs = source.faceVertexUvs[ i ];\r\n\t\r\n\t\t\t\tif ( this.faceVertexUvs[ i ] === undefined ) {\r\n\t\r\n\t\t\t\t\tthis.faceVertexUvs[ i ] = [];\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tfor ( var j = 0, jl = faceVertexUvs.length; j < jl; j ++ ) {\r\n\t\r\n\t\t\t\t\tvar uvs = faceVertexUvs[ j ], uvsCopy = [];\r\n\t\r\n\t\t\t\t\tfor ( var k = 0, kl = uvs.length; k < kl; k ++ ) {\r\n\t\r\n\t\t\t\t\t\tvar uv = uvs[ k ];\r\n\t\r\n\t\t\t\t\t\tuvsCopy.push( uv.clone() );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tthis.faceVertexUvs[ i ].push( uvsCopy );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tdispose: function () {\r\n\t\r\n\t\t\tthis.dispatchEvent( { type: 'dispose' } );\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.EventDispatcher.prototype.apply( THREE.Geometry.prototype );\r\n\t\r\n\tTHREE.GeometryIdCount = 0;\r\n\t\r\n\t// File:src/core/DirectGeometry.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.DirectGeometry = function () {\r\n\t\r\n\t\tObject.defineProperty( this, 'id', { value: THREE.GeometryIdCount ++ } );\r\n\t\r\n\t\tthis.uuid = THREE.Math.generateUUID();\r\n\t\r\n\t\tthis.name = '';\r\n\t\tthis.type = 'DirectGeometry';\r\n\t\r\n\t\tthis.indices = [];\r\n\t\tthis.vertices = [];\r\n\t\tthis.normals = [];\r\n\t\tthis.colors = [];\r\n\t\tthis.uvs = [];\r\n\t\tthis.uvs2 = [];\r\n\t\r\n\t\tthis.groups = [];\r\n\t\r\n\t\tthis.morphTargets = {};\r\n\t\r\n\t\tthis.skinWeights = [];\r\n\t\tthis.skinIndices = [];\r\n\t\r\n\t\t// this.lineDistances = [];\r\n\t\r\n\t\tthis.boundingBox = null;\r\n\t\tthis.boundingSphere = null;\r\n\t\r\n\t\t// update flags\r\n\t\r\n\t\tthis.verticesNeedUpdate = false;\r\n\t\tthis.normalsNeedUpdate = false;\r\n\t\tthis.colorsNeedUpdate = false;\r\n\t\tthis.uvsNeedUpdate = false;\r\n\t\tthis.groupsNeedUpdate = false;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.DirectGeometry.prototype = {\r\n\t\r\n\t\tconstructor: THREE.DirectGeometry,\r\n\t\r\n\t\tcomputeBoundingBox: THREE.Geometry.prototype.computeBoundingBox,\r\n\t\tcomputeBoundingSphere: THREE.Geometry.prototype.computeBoundingSphere,\r\n\t\r\n\t\tcomputeFaceNormals: function () {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.DirectGeometry: computeFaceNormals() is not a method of this type of geometry.' );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcomputeVertexNormals: function () {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.DirectGeometry: computeVertexNormals() is not a method of this type of geometry.' );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcomputeGroups: function ( geometry ) {\r\n\t\r\n\t\t\tvar group;\r\n\t\t\tvar groups = [];\r\n\t\t\tvar materialIndex;\r\n\t\r\n\t\t\tvar faces = geometry.faces;\r\n\t\r\n\t\t\tfor ( var i = 0; i < faces.length; i ++ ) {\r\n\t\r\n\t\t\t\tvar face = faces[ i ];\r\n\t\r\n\t\t\t\t// materials\r\n\t\r\n\t\t\t\tif ( face.materialIndex !== materialIndex ) {\r\n\t\r\n\t\t\t\t\tmaterialIndex = face.materialIndex;\r\n\t\r\n\t\t\t\t\tif ( group !== undefined ) {\r\n\t\r\n\t\t\t\t\t\tgroup.count = ( i * 3 ) - group.start;\r\n\t\t\t\t\t\tgroups.push( group );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tgroup = {\r\n\t\t\t\t\t\tstart: i * 3,\r\n\t\t\t\t\t\tmaterialIndex: materialIndex\r\n\t\t\t\t\t};\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( group !== undefined ) {\r\n\t\r\n\t\t\t\tgroup.count = ( i * 3 ) - group.start;\r\n\t\t\t\tgroups.push( group );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tthis.groups = groups;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tfromGeometry: function ( geometry ) {\r\n\t\r\n\t\t\tvar faces = geometry.faces;\r\n\t\t\tvar vertices = geometry.vertices;\r\n\t\t\tvar faceVertexUvs = geometry.faceVertexUvs;\r\n\t\r\n\t\t\tvar hasFaceVertexUv = faceVertexUvs[ 0 ] && faceVertexUvs[ 0 ].length > 0;\r\n\t\t\tvar hasFaceVertexUv2 = faceVertexUvs[ 1 ] && faceVertexUvs[ 1 ].length > 0;\r\n\t\r\n\t\t\t// morphs\r\n\t\r\n\t\t\tvar morphTargets = geometry.morphTargets;\r\n\t\t\tvar morphTargetsLength = morphTargets.length;\r\n\t\r\n\t\t\tif ( morphTargetsLength > 0 ) {\r\n\t\r\n\t\t\t\tvar morphTargetsPosition = [];\r\n\t\r\n\t\t\t\tfor ( var i = 0; i < morphTargetsLength; i ++ ) {\r\n\t\r\n\t\t\t\t\tmorphTargetsPosition[ i ] = [];\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tthis.morphTargets.position = morphTargetsPosition;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar morphNormals = geometry.morphNormals;\r\n\t\t\tvar morphNormalsLength = morphNormals.length;\r\n\t\r\n\t\t\tif ( morphNormalsLength > 0 ) {\r\n\t\r\n\t\t\t\tvar morphTargetsNormal = [];\r\n\t\r\n\t\t\t\tfor ( var i = 0; i < morphNormalsLength; i ++ ) {\r\n\t\r\n\t\t\t\t\tmorphTargetsNormal[ i ] = [];\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tthis.morphTargets.normal = morphTargetsNormal;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// skins\r\n\t\r\n\t\t\tvar skinIndices = geometry.skinIndices;\r\n\t\t\tvar skinWeights = geometry.skinWeights;\r\n\t\r\n\t\t\tvar hasSkinIndices = skinIndices.length === vertices.length;\r\n\t\t\tvar hasSkinWeights = skinWeights.length === vertices.length;\r\n\t\r\n\t\t\t//\r\n\t\r\n\t\t\tfor ( var i = 0; i < faces.length; i ++ ) {\r\n\t\r\n\t\t\t\tvar face = faces[ i ];\r\n\t\r\n\t\t\t\tthis.vertices.push( vertices[ face.a ], vertices[ face.b ], vertices[ face.c ] );\r\n\t\r\n\t\t\t\tvar vertexNormals = face.vertexNormals;\r\n\t\r\n\t\t\t\tif ( vertexNormals.length === 3 ) {\r\n\t\r\n\t\t\t\t\tthis.normals.push( vertexNormals[ 0 ], vertexNormals[ 1 ], vertexNormals[ 2 ] );\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tvar normal = face.normal;\r\n\t\r\n\t\t\t\t\tthis.normals.push( normal, normal, normal );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tvar vertexColors = face.vertexColors;\r\n\t\r\n\t\t\t\tif ( vertexColors.length === 3 ) {\r\n\t\r\n\t\t\t\t\tthis.colors.push( vertexColors[ 0 ], vertexColors[ 1 ], vertexColors[ 2 ] );\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tvar color = face.color;\r\n\t\r\n\t\t\t\t\tthis.colors.push( color, color, color );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( hasFaceVertexUv === true ) {\r\n\t\r\n\t\t\t\t\tvar vertexUvs = faceVertexUvs[ 0 ][ i ];\r\n\t\r\n\t\t\t\t\tif ( vertexUvs !== undefined ) {\r\n\t\r\n\t\t\t\t\t\tthis.uvs.push( vertexUvs[ 0 ], vertexUvs[ 1 ], vertexUvs[ 2 ] );\r\n\t\r\n\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\tconsole.warn( 'THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ', i );\r\n\t\r\n\t\t\t\t\t\tthis.uvs.push( new THREE.Vector2(), new THREE.Vector2(), new THREE.Vector2() );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( hasFaceVertexUv2 === true ) {\r\n\t\r\n\t\t\t\t\tvar vertexUvs = faceVertexUvs[ 1 ][ i ];\r\n\t\r\n\t\t\t\t\tif ( vertexUvs !== undefined ) {\r\n\t\r\n\t\t\t\t\t\tthis.uvs2.push( vertexUvs[ 0 ], vertexUvs[ 1 ], vertexUvs[ 2 ] );\r\n\t\r\n\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\tconsole.warn( 'THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ', i );\r\n\t\r\n\t\t\t\t\t\tthis.uvs2.push( new THREE.Vector2(), new THREE.Vector2(), new THREE.Vector2() );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\t// morphs\r\n\t\r\n\t\t\t\tfor ( var j = 0; j < morphTargetsLength; j ++ ) {\r\n\t\r\n\t\t\t\t\tvar morphTarget = morphTargets[ j ].vertices;\r\n\t\r\n\t\t\t\t\tmorphTargetsPosition[ j ].push( morphTarget[ face.a ], morphTarget[ face.b ], morphTarget[ face.c ] );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tfor ( var j = 0; j < morphNormalsLength; j ++ ) {\r\n\t\r\n\t\t\t\t\tvar morphNormal = morphNormals[ j ].vertexNormals[ i ];\r\n\t\r\n\t\t\t\t\tmorphTargetsNormal[ j ].push( morphNormal.a, morphNormal.b, morphNormal.c );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\t// skins\r\n\t\r\n\t\t\t\tif ( hasSkinIndices ) {\r\n\t\r\n\t\t\t\t\tthis.skinIndices.push( skinIndices[ face.a ], skinIndices[ face.b ], skinIndices[ face.c ] );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( hasSkinWeights ) {\r\n\t\r\n\t\t\t\t\tthis.skinWeights.push( skinWeights[ face.a ], skinWeights[ face.b ], skinWeights[ face.c ] );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tthis.computeGroups( geometry );\r\n\t\r\n\t\t\tthis.verticesNeedUpdate = geometry.verticesNeedUpdate;\r\n\t\t\tthis.normalsNeedUpdate = geometry.normalsNeedUpdate;\r\n\t\t\tthis.colorsNeedUpdate = geometry.colorsNeedUpdate;\r\n\t\t\tthis.uvsNeedUpdate = geometry.uvsNeedUpdate;\r\n\t\t\tthis.groupsNeedUpdate = geometry.groupsNeedUpdate;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tdispose: function () {\r\n\t\r\n\t\t\tthis.dispatchEvent( { type: 'dispose' } );\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.EventDispatcher.prototype.apply( THREE.DirectGeometry.prototype );\r\n\t\r\n\t// File:src/core/BufferGeometry.js\r\n\t\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.BufferGeometry = function () {\r\n\t\r\n\t\tObject.defineProperty( this, 'id', { value: THREE.GeometryIdCount ++ } );\r\n\t\r\n\t\tthis.uuid = THREE.Math.generateUUID();\r\n\t\r\n\t\tthis.name = '';\r\n\t\tthis.type = 'BufferGeometry';\r\n\t\r\n\t\tthis.index = null;\r\n\t\tthis.attributes = {};\r\n\t\r\n\t\tthis.morphAttributes = {};\r\n\t\r\n\t\tthis.groups = [];\r\n\t\r\n\t\tthis.boundingBox = null;\r\n\t\tthis.boundingSphere = null;\r\n\t\r\n\t\tthis.drawRange = { start: 0, count: Infinity };\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.BufferGeometry.prototype = {\r\n\t\r\n\t\tconstructor: THREE.BufferGeometry,\r\n\t\r\n\t\taddIndex: function ( index ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.BufferGeometry: .addIndex() has been renamed to .setIndex().' );\r\n\t\t\tthis.setIndex( index );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tgetIndex: function () {\r\n\t\r\n\t\t\treturn this.index;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetIndex: function ( index ) {\r\n\t\r\n\t\t\tthis.index = index;\r\n\t\r\n\t\t},\r\n\t\r\n\t\taddAttribute: function ( name, attribute ) {\r\n\t\r\n\t\t\tif ( attribute instanceof THREE.BufferAttribute === false && attribute instanceof THREE.InterleavedBufferAttribute === false ) {\r\n\t\r\n\t\t\t\tconsole.warn( 'THREE.BufferGeometry: .addAttribute() now expects ( name, attribute ).' );\r\n\t\r\n\t\t\t\tthis.addAttribute( name, new THREE.BufferAttribute( arguments[ 1 ], arguments[ 2 ] ) );\r\n\t\r\n\t\t\t\treturn;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( name === 'index' ) {\r\n\t\r\n\t\t\t\tconsole.warn( 'THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute.' );\r\n\t\t\t\tthis.setIndex( attribute );\r\n\t\r\n\t\t\t\treturn;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tthis.attributes[ name ] = attribute;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tgetAttribute: function ( name ) {\r\n\t\r\n\t\t\treturn this.attributes[ name ];\r\n\t\r\n\t\t},\r\n\t\r\n\t\tremoveAttribute: function ( name ) {\r\n\t\r\n\t\t\tdelete this.attributes[ name ];\r\n\t\r\n\t\t},\r\n\t\r\n\t\tget drawcalls() {\r\n\t\r\n\t\t\tconsole.error( 'THREE.BufferGeometry: .drawcalls has been renamed to .groups.' );\r\n\t\t\treturn this.groups;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tget offsets() {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.BufferGeometry: .offsets has been renamed to .groups.' );\r\n\t\t\treturn this.groups;\r\n\t\r\n\t\t},\r\n\t\r\n\t\taddDrawCall: function ( start, count, indexOffset ) {\r\n\t\r\n\t\t\tif ( indexOffset !== undefined ) {\r\n\t\r\n\t\t\t\tconsole.warn( 'THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset.' );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tconsole.warn( 'THREE.BufferGeometry: .addDrawCall() is now .addGroup().' );\r\n\t\t\tthis.addGroup( start, count );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tclearDrawCalls: function () {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups().' );\r\n\t\t\tthis.clearGroups();\r\n\t\r\n\t\t},\r\n\t\r\n\t\taddGroup: function ( start, count, materialIndex ) {\r\n\t\r\n\t\t\tthis.groups.push( {\r\n\t\r\n\t\t\t\tstart: start,\r\n\t\t\t\tcount: count,\r\n\t\t\t\tmaterialIndex: materialIndex !== undefined ? materialIndex : 0\r\n\t\r\n\t\t\t} );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tclearGroups: function () {\r\n\t\r\n\t\t\tthis.groups = [];\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetDrawRange: function ( start, count ) {\r\n\t\r\n\t\t\tthis.drawRange.start = start;\r\n\t\t\tthis.drawRange.count = count;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tapplyMatrix: function ( matrix ) {\r\n\t\r\n\t\t\tvar position = this.attributes.position;\r\n\t\r\n\t\t\tif ( position !== undefined ) {\r\n\t\r\n\t\t\t\tmatrix.applyToVector3Array( position.array );\r\n\t\t\t\tposition.needsUpdate = true;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar normal = this.attributes.normal;\r\n\t\r\n\t\t\tif ( normal !== undefined ) {\r\n\t\r\n\t\t\t\tvar normalMatrix = new THREE.Matrix3().getNormalMatrix( matrix );\r\n\t\r\n\t\t\t\tnormalMatrix.applyToVector3Array( normal.array );\r\n\t\t\t\tnormal.needsUpdate = true;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( this.boundingBox !== null ) {\r\n\t\r\n\t\t\t\tthis.computeBoundingBox();\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( this.boundingSphere !== null ) {\r\n\t\r\n\t\t\t\tthis.computeBoundingSphere();\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t},\r\n\t\r\n\t\trotateX: function () {\r\n\t\r\n\t\t\t// rotate geometry around world x-axis\r\n\t\r\n\t\t\tvar m1;\r\n\t\r\n\t\t\treturn function rotateX( angle ) {\r\n\t\r\n\t\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\r\n\t\r\n\t\t\t\tm1.makeRotationX( angle );\r\n\t\r\n\t\t\t\tthis.applyMatrix( m1 );\r\n\t\r\n\t\t\t\treturn this;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\trotateY: function () {\r\n\t\r\n\t\t\t// rotate geometry around world y-axis\r\n\t\r\n\t\t\tvar m1;\r\n\t\r\n\t\t\treturn function rotateY( angle ) {\r\n\t\r\n\t\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\r\n\t\r\n\t\t\t\tm1.makeRotationY( angle );\r\n\t\r\n\t\t\t\tthis.applyMatrix( m1 );\r\n\t\r\n\t\t\t\treturn this;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\trotateZ: function () {\r\n\t\r\n\t\t\t// rotate geometry around world z-axis\r\n\t\r\n\t\t\tvar m1;\r\n\t\r\n\t\t\treturn function rotateZ( angle ) {\r\n\t\r\n\t\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\r\n\t\r\n\t\t\t\tm1.makeRotationZ( angle );\r\n\t\r\n\t\t\t\tthis.applyMatrix( m1 );\r\n\t\r\n\t\t\t\treturn this;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\ttranslate: function () {\r\n\t\r\n\t\t\t// translate geometry\r\n\t\r\n\t\t\tvar m1;\r\n\t\r\n\t\t\treturn function translate( x, y, z ) {\r\n\t\r\n\t\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\r\n\t\r\n\t\t\t\tm1.makeTranslation( x, y, z );\r\n\t\r\n\t\t\t\tthis.applyMatrix( m1 );\r\n\t\r\n\t\t\t\treturn this;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tscale: function () {\r\n\t\r\n\t\t\t// scale geometry\r\n\t\r\n\t\t\tvar m1;\r\n\t\r\n\t\t\treturn function scale( x, y, z ) {\r\n\t\r\n\t\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\r\n\t\r\n\t\t\t\tm1.makeScale( x, y, z );\r\n\t\r\n\t\t\t\tthis.applyMatrix( m1 );\r\n\t\r\n\t\t\t\treturn this;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tlookAt: function () {\r\n\t\r\n\t\t\tvar obj;\r\n\t\r\n\t\t\treturn function lookAt( vector ) {\r\n\t\r\n\t\t\t\tif ( obj === undefined ) obj = new THREE.Object3D();\r\n\t\r\n\t\t\t\tobj.lookAt( vector );\r\n\t\r\n\t\t\t\tobj.updateMatrix();\r\n\t\r\n\t\t\t\tthis.applyMatrix( obj.matrix );\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tcenter: function () {\r\n\t\r\n\t\t\tthis.computeBoundingBox();\r\n\t\r\n\t\t\tvar offset = this.boundingBox.center().negate();\r\n\t\r\n\t\t\tthis.translate( offset.x, offset.y, offset.z );\r\n\t\r\n\t\t\treturn offset;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetFromObject: function ( object ) {\r\n\t\r\n\t\t\t// console.log( 'THREE.BufferGeometry.setFromObject(). Converting', object, this );\r\n\t\r\n\t\t\tvar geometry = object.geometry;\r\n\t\r\n\t\t\tif ( object instanceof THREE.Points || object instanceof THREE.Line ) {\r\n\t\r\n\t\t\t\tvar positions = new THREE.Float32Attribute( geometry.vertices.length * 3, 3 );\r\n\t\t\t\tvar colors = new THREE.Float32Attribute( geometry.colors.length * 3, 3 );\r\n\t\r\n\t\t\t\tthis.addAttribute( 'position', positions.copyVector3sArray( geometry.vertices ) );\r\n\t\t\t\tthis.addAttribute( 'color', colors.copyColorsArray( geometry.colors ) );\r\n\t\r\n\t\t\t\tif ( geometry.lineDistances && geometry.lineDistances.length === geometry.vertices.length ) {\r\n\t\r\n\t\t\t\t\tvar lineDistances = new THREE.Float32Attribute( geometry.lineDistances.length, 1 );\r\n\t\r\n\t\t\t\t\tthis.addAttribute( 'lineDistance', lineDistances.copyArray( geometry.lineDistances ) );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( geometry.boundingSphere !== null ) {\r\n\t\r\n\t\t\t\t\tthis.boundingSphere = geometry.boundingSphere.clone();\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( geometry.boundingBox !== null ) {\r\n\t\r\n\t\t\t\t\tthis.boundingBox = geometry.boundingBox.clone();\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t} else if ( object instanceof THREE.Mesh ) {\r\n\t\r\n\t\t\t\tif ( geometry instanceof THREE.Geometry ) {\r\n\t\r\n\t\t\t\t\tthis.fromGeometry( geometry );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tupdateFromObject: function ( object ) {\r\n\t\r\n\t\t\tvar geometry = object.geometry;\r\n\t\r\n\t\t\tif ( object instanceof THREE.Mesh ) {\r\n\t\r\n\t\t\t\tvar direct = geometry.__directGeometry;\r\n\t\r\n\t\t\t\tif ( direct === undefined ) {\r\n\t\r\n\t\t\t\t\treturn this.fromGeometry( geometry );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tdirect.verticesNeedUpdate = geometry.verticesNeedUpdate;\r\n\t\t\t\tdirect.normalsNeedUpdate = geometry.normalsNeedUpdate;\r\n\t\t\t\tdirect.colorsNeedUpdate = geometry.colorsNeedUpdate;\r\n\t\t\t\tdirect.uvsNeedUpdate = geometry.uvsNeedUpdate;\r\n\t\t\t\tdirect.groupsNeedUpdate = geometry.groupsNeedUpdate;\r\n\t\r\n\t\t\t\tgeometry.verticesNeedUpdate = false;\r\n\t\t\t\tgeometry.normalsNeedUpdate = false;\r\n\t\t\t\tgeometry.colorsNeedUpdate = false;\r\n\t\t\t\tgeometry.uvsNeedUpdate = false;\r\n\t\t\t\tgeometry.groupsNeedUpdate = false;\r\n\t\r\n\t\t\t\tgeometry = direct;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( geometry.verticesNeedUpdate === true ) {\r\n\t\r\n\t\t\t\tvar attribute = this.attributes.position;\r\n\t\r\n\t\t\t\tif ( attribute !== undefined ) {\r\n\t\r\n\t\t\t\t\tattribute.copyVector3sArray( geometry.vertices );\r\n\t\t\t\t\tattribute.needsUpdate = true;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tgeometry.verticesNeedUpdate = false;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( geometry.normalsNeedUpdate === true ) {\r\n\t\r\n\t\t\t\tvar attribute = this.attributes.normal;\r\n\t\r\n\t\t\t\tif ( attribute !== undefined ) {\r\n\t\r\n\t\t\t\t\tattribute.copyVector3sArray( geometry.normals );\r\n\t\t\t\t\tattribute.needsUpdate = true;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tgeometry.normalsNeedUpdate = false;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( geometry.colorsNeedUpdate === true ) {\r\n\t\r\n\t\t\t\tvar attribute = this.attributes.color;\r\n\t\r\n\t\t\t\tif ( attribute !== undefined ) {\r\n\t\r\n\t\t\t\t\tattribute.copyColorsArray( geometry.colors );\r\n\t\t\t\t\tattribute.needsUpdate = true;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tgeometry.colorsNeedUpdate = false;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( geometry.uvsNeedUpdate ) {\r\n\t\r\n\t\t\t\t\tvar attribute = this.attributes.uv;\r\n\t\r\n\t\t\t\t\tif ( attribute !== undefined ) {\r\n\t\r\n\t\t\t\t\t\t\tattribute.copyVector2sArray( geometry.uvs );\r\n\t\t\t\t\t\t\tattribute.needsUpdate = true;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tgeometry.uvsNeedUpdate = false;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( geometry.lineDistancesNeedUpdate ) {\r\n\t\r\n\t\t\t\tvar attribute = this.attributes.lineDistance;\r\n\t\r\n\t\t\t\tif ( attribute !== undefined ) {\r\n\t\r\n\t\t\t\t\tattribute.copyArray( geometry.lineDistances );\r\n\t\t\t\t\tattribute.needsUpdate = true;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tgeometry.lineDistancesNeedUpdate = false;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( geometry.groupsNeedUpdate ) {\r\n\t\r\n\t\t\t\tgeometry.computeGroups( object.geometry );\r\n\t\t\t\tthis.groups = geometry.groups;\r\n\t\r\n\t\t\t\tgeometry.groupsNeedUpdate = false;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tfromGeometry: function ( geometry ) {\r\n\t\r\n\t\t\tgeometry.__directGeometry = new THREE.DirectGeometry().fromGeometry( geometry );\r\n\t\r\n\t\t\treturn this.fromDirectGeometry( geometry.__directGeometry );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tfromDirectGeometry: function ( geometry ) {\r\n\t\r\n\t\t\tvar positions = new Float32Array( geometry.vertices.length * 3 );\r\n\t\t\tthis.addAttribute( 'position', new THREE.BufferAttribute( positions, 3 ).copyVector3sArray( geometry.vertices ) );\r\n\t\r\n\t\t\tif ( geometry.normals.length > 0 ) {\r\n\t\r\n\t\t\t\tvar normals = new Float32Array( geometry.normals.length * 3 );\r\n\t\t\t\tthis.addAttribute( 'normal', new THREE.BufferAttribute( normals, 3 ).copyVector3sArray( geometry.normals ) );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( geometry.colors.length > 0 ) {\r\n\t\r\n\t\t\t\tvar colors = new Float32Array( geometry.colors.length * 3 );\r\n\t\t\t\tthis.addAttribute( 'color', new THREE.BufferAttribute( colors, 3 ).copyColorsArray( geometry.colors ) );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( geometry.uvs.length > 0 ) {\r\n\t\r\n\t\t\t\tvar uvs = new Float32Array( geometry.uvs.length * 2 );\r\n\t\t\t\tthis.addAttribute( 'uv', new THREE.BufferAttribute( uvs, 2 ).copyVector2sArray( geometry.uvs ) );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( geometry.uvs2.length > 0 ) {\r\n\t\r\n\t\t\t\tvar uvs2 = new Float32Array( geometry.uvs2.length * 2 );\r\n\t\t\t\tthis.addAttribute( 'uv2', new THREE.BufferAttribute( uvs2, 2 ).copyVector2sArray( geometry.uvs2 ) );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( geometry.indices.length > 0 ) {\r\n\t\r\n\t\t\t\tvar TypeArray = geometry.vertices.length > 65535 ? Uint32Array : Uint16Array;\r\n\t\t\t\tvar indices = new TypeArray( geometry.indices.length * 3 );\r\n\t\t\t\tthis.setIndex( new THREE.BufferAttribute( indices, 1 ).copyIndicesArray( geometry.indices ) );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// groups\r\n\t\r\n\t\t\tthis.groups = geometry.groups;\r\n\t\r\n\t\t\t// morphs\r\n\t\r\n\t\t\tfor ( var name in geometry.morphTargets ) {\r\n\t\r\n\t\t\t\tvar array = [];\r\n\t\t\t\tvar morphTargets = geometry.morphTargets[ name ];\r\n\t\r\n\t\t\t\tfor ( var i = 0, l = morphTargets.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\t\tvar morphTarget = morphTargets[ i ];\r\n\t\r\n\t\t\t\t\tvar attribute = new THREE.Float32Attribute( morphTarget.length * 3, 3 );\r\n\t\r\n\t\t\t\t\tarray.push( attribute.copyVector3sArray( morphTarget ) );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tthis.morphAttributes[ name ] = array;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// skinning\r\n\t\r\n\t\t\tif ( geometry.skinIndices.length > 0 ) {\r\n\t\r\n\t\t\t\tvar skinIndices = new THREE.Float32Attribute( geometry.skinIndices.length * 4, 4 );\r\n\t\t\t\tthis.addAttribute( 'skinIndex', skinIndices.copyVector4sArray( geometry.skinIndices ) );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( geometry.skinWeights.length > 0 ) {\r\n\t\r\n\t\t\t\tvar skinWeights = new THREE.Float32Attribute( geometry.skinWeights.length * 4, 4 );\r\n\t\t\t\tthis.addAttribute( 'skinWeight', skinWeights.copyVector4sArray( geometry.skinWeights ) );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t//\r\n\t\r\n\t\t\tif ( geometry.boundingSphere !== null ) {\r\n\t\r\n\t\t\t\tthis.boundingSphere = geometry.boundingSphere.clone();\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( geometry.boundingBox !== null ) {\r\n\t\r\n\t\t\t\tthis.boundingBox = geometry.boundingBox.clone();\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcomputeBoundingBox: function () {\r\n\t\r\n\t\t\tvar vector = new THREE.Vector3();\r\n\t\r\n\t\t\treturn function () {\r\n\t\r\n\t\t\t\tif ( this.boundingBox === null ) {\r\n\t\r\n\t\t\t\t\tthis.boundingBox = new THREE.Box3();\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tvar positions = this.attributes.position.array;\r\n\t\r\n\t\t\t\tif ( positions ) {\r\n\t\r\n\t\t\t\t\tvar bb = this.boundingBox;\r\n\t\t\t\t\tbb.makeEmpty();\r\n\t\r\n\t\t\t\t\tfor ( var i = 0, il = positions.length; i < il; i += 3 ) {\r\n\t\r\n\t\t\t\t\t\tvector.fromArray( positions, i );\r\n\t\t\t\t\t\tbb.expandByPoint( vector );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( positions === undefined || positions.length === 0 ) {\r\n\t\r\n\t\t\t\t\tthis.boundingBox.min.set( 0, 0, 0 );\r\n\t\t\t\t\tthis.boundingBox.max.set( 0, 0, 0 );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( isNaN( this.boundingBox.min.x ) || isNaN( this.boundingBox.min.y ) || isNaN( this.boundingBox.min.z ) ) {\r\n\t\r\n\t\t\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The \"position\" attribute is likely to have NaN values.', this );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tcomputeBoundingSphere: function () {\r\n\t\r\n\t\t\tvar box = new THREE.Box3();\r\n\t\t\tvar vector = new THREE.Vector3();\r\n\t\r\n\t\t\treturn function () {\r\n\t\r\n\t\t\t\tif ( this.boundingSphere === null ) {\r\n\t\r\n\t\t\t\t\tthis.boundingSphere = new THREE.Sphere();\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tvar positions = this.attributes.position.array;\r\n\t\r\n\t\t\t\tif ( positions ) {\r\n\t\r\n\t\t\t\t\tbox.makeEmpty();\r\n\t\r\n\t\t\t\t\tvar center = this.boundingSphere.center;\r\n\t\r\n\t\t\t\t\tfor ( var i = 0, il = positions.length; i < il; i += 3 ) {\r\n\t\r\n\t\t\t\t\t\tvector.fromArray( positions, i );\r\n\t\t\t\t\t\tbox.expandByPoint( vector );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tbox.center( center );\r\n\t\r\n\t\t\t\t\t// hoping to find a boundingSphere with a radius smaller than the\r\n\t\t\t\t\t// boundingSphere of the boundingBox: sqrt(3) smaller in the best case\r\n\t\r\n\t\t\t\t\tvar maxRadiusSq = 0;\r\n\t\r\n\t\t\t\t\tfor ( var i = 0, il = positions.length; i < il; i += 3 ) {\r\n\t\r\n\t\t\t\t\t\tvector.fromArray( positions, i );\r\n\t\t\t\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( vector ) );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tthis.boundingSphere.radius = Math.sqrt( maxRadiusSq );\r\n\t\r\n\t\t\t\t\tif ( isNaN( this.boundingSphere.radius ) ) {\r\n\t\r\n\t\t\t\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The \"position\" attribute is likely to have NaN values.', this );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t}(),\r\n\t\r\n\t\tcomputeFaceNormals: function () {\r\n\t\r\n\t\t\t// backwards compatibility\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcomputeVertexNormals: function () {\r\n\t\r\n\t\t\tvar index = this.index;\r\n\t\t\tvar attributes = this.attributes;\r\n\t\t\tvar groups = this.groups;\r\n\t\r\n\t\t\tif ( attributes.position ) {\r\n\t\r\n\t\t\t\tvar positions = attributes.position.array;\r\n\t\r\n\t\t\t\tif ( attributes.normal === undefined ) {\r\n\t\r\n\t\t\t\t\tthis.addAttribute( 'normal', new THREE.BufferAttribute( new Float32Array( positions.length ), 3 ) );\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t// reset existing normals to zero\r\n\t\r\n\t\t\t\t\tvar normals = attributes.normal.array;\r\n\t\r\n\t\t\t\t\tfor ( var i = 0, il = normals.length; i < il; i ++ ) {\r\n\t\r\n\t\t\t\t\t\tnormals[ i ] = 0;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tvar normals = attributes.normal.array;\r\n\t\r\n\t\t\t\tvar vA, vB, vC,\r\n\t\r\n\t\t\t\tpA = new THREE.Vector3(),\r\n\t\t\t\tpB = new THREE.Vector3(),\r\n\t\t\t\tpC = new THREE.Vector3(),\r\n\t\r\n\t\t\t\tcb = new THREE.Vector3(),\r\n\t\t\t\tab = new THREE.Vector3();\r\n\t\r\n\t\t\t\t// indexed elements\r\n\t\r\n\t\t\t\tif ( index ) {\r\n\t\r\n\t\t\t\t\tvar indices = index.array;\r\n\t\r\n\t\t\t\t\tif ( groups.length === 0 ) {\r\n\t\r\n\t\t\t\t\t\tthis.addGroup( 0, indices.length );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tfor ( var j = 0, jl = groups.length; j < jl; ++ j ) {\r\n\t\r\n\t\t\t\t\t\tvar group = groups[ j ];\r\n\t\r\n\t\t\t\t\t\tvar start = group.start;\r\n\t\t\t\t\t\tvar count = group.count;\r\n\t\r\n\t\t\t\t\t\tfor ( var i = start, il = start + count; i < il; i += 3 ) {\r\n\t\r\n\t\t\t\t\t\t\tvA = indices[ i + 0 ] * 3;\r\n\t\t\t\t\t\t\tvB = indices[ i + 1 ] * 3;\r\n\t\t\t\t\t\t\tvC = indices[ i + 2 ] * 3;\r\n\t\r\n\t\t\t\t\t\t\tpA.fromArray( positions, vA );\r\n\t\t\t\t\t\t\tpB.fromArray( positions, vB );\r\n\t\t\t\t\t\t\tpC.fromArray( positions, vC );\r\n\t\r\n\t\t\t\t\t\t\tcb.subVectors( pC, pB );\r\n\t\t\t\t\t\t\tab.subVectors( pA, pB );\r\n\t\t\t\t\t\t\tcb.cross( ab );\r\n\t\r\n\t\t\t\t\t\t\tnormals[ vA ] += cb.x;\r\n\t\t\t\t\t\t\tnormals[ vA + 1 ] += cb.y;\r\n\t\t\t\t\t\t\tnormals[ vA + 2 ] += cb.z;\r\n\t\r\n\t\t\t\t\t\t\tnormals[ vB ] += cb.x;\r\n\t\t\t\t\t\t\tnormals[ vB + 1 ] += cb.y;\r\n\t\t\t\t\t\t\tnormals[ vB + 2 ] += cb.z;\r\n\t\r\n\t\t\t\t\t\t\tnormals[ vC ] += cb.x;\r\n\t\t\t\t\t\t\tnormals[ vC + 1 ] += cb.y;\r\n\t\t\t\t\t\t\tnormals[ vC + 2 ] += cb.z;\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t// non-indexed elements (unconnected triangle soup)\r\n\t\r\n\t\t\t\t\tfor ( var i = 0, il = positions.length; i < il; i += 9 ) {\r\n\t\r\n\t\t\t\t\t\tpA.fromArray( positions, i );\r\n\t\t\t\t\t\tpB.fromArray( positions, i + 3 );\r\n\t\t\t\t\t\tpC.fromArray( positions, i + 6 );\r\n\t\r\n\t\t\t\t\t\tcb.subVectors( pC, pB );\r\n\t\t\t\t\t\tab.subVectors( pA, pB );\r\n\t\t\t\t\t\tcb.cross( ab );\r\n\t\r\n\t\t\t\t\t\tnormals[ i ] = cb.x;\r\n\t\t\t\t\t\tnormals[ i + 1 ] = cb.y;\r\n\t\t\t\t\t\tnormals[ i + 2 ] = cb.z;\r\n\t\r\n\t\t\t\t\t\tnormals[ i + 3 ] = cb.x;\r\n\t\t\t\t\t\tnormals[ i + 4 ] = cb.y;\r\n\t\t\t\t\t\tnormals[ i + 5 ] = cb.z;\r\n\t\r\n\t\t\t\t\t\tnormals[ i + 6 ] = cb.x;\r\n\t\t\t\t\t\tnormals[ i + 7 ] = cb.y;\r\n\t\t\t\t\t\tnormals[ i + 8 ] = cb.z;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tthis.normalizeNormals();\r\n\t\r\n\t\t\t\tattributes.normal.needsUpdate = true;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcomputeTangents: function () {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.BufferGeometry: .computeTangents() has been removed.' );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcomputeOffsets: function ( size ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.BufferGeometry: .computeOffsets() has been removed.')\r\n\t\r\n\t\t},\r\n\t\r\n\t\tmerge: function ( geometry, offset ) {\r\n\t\r\n\t\t\tif ( geometry instanceof THREE.BufferGeometry === false ) {\r\n\t\r\n\t\t\t\tconsole.error( 'THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.', geometry );\r\n\t\t\t\treturn;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\t\r\n\t\t\tvar attributes = this.attributes;\r\n\t\r\n\t\t\tfor ( var key in attributes ) {\r\n\t\r\n\t\t\t\tif ( geometry.attributes[ key ] === undefined ) continue;\r\n\t\r\n\t\t\t\tvar attribute1 = attributes[ key ];\r\n\t\t\t\tvar attributeArray1 = attribute1.array;\r\n\t\r\n\t\t\t\tvar attribute2 = geometry.attributes[ key ];\r\n\t\t\t\tvar attributeArray2 = attribute2.array;\r\n\t\r\n\t\t\t\tvar attributeSize = attribute2.itemSize;\r\n\t\r\n\t\t\t\tfor ( var i = 0, j = attributeSize * offset; i < attributeArray2.length; i ++, j ++ ) {\r\n\t\r\n\t\t\t\t\tattributeArray1[ j ] = attributeArray2[ i ];\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tnormalizeNormals: function () {\r\n\t\r\n\t\t\tvar normals = this.attributes.normal.array;\r\n\t\r\n\t\t\tvar x, y, z, n;\r\n\t\r\n\t\t\tfor ( var i = 0, il = normals.length; i < il; i += 3 ) {\r\n\t\r\n\t\t\t\tx = normals[ i ];\r\n\t\t\t\ty = normals[ i + 1 ];\r\n\t\t\t\tz = normals[ i + 2 ];\r\n\t\r\n\t\t\t\tn = 1.0 / Math.sqrt( x * x + y * y + z * z );\r\n\t\r\n\t\t\t\tnormals[ i ] *= n;\r\n\t\t\t\tnormals[ i + 1 ] *= n;\r\n\t\t\t\tnormals[ i + 2 ] *= n;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t},\r\n\t\r\n\t\ttoJSON: function () {\r\n\t\r\n\t\t\tvar data = {\r\n\t\t\t\tmetadata: {\r\n\t\t\t\t\tversion: 4.4,\r\n\t\t\t\t\ttype: 'BufferGeometry',\r\n\t\t\t\t\tgenerator: 'BufferGeometry.toJSON'\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\r\n\t\t\t// standard BufferGeometry serialization\r\n\t\r\n\t\t\tdata.uuid = this.uuid;\r\n\t\t\tdata.type = this.type;\r\n\t\t\tif ( this.name !== '' ) data.name = this.name;\r\n\t\r\n\t\t\tif ( this.parameters !== undefined ) {\r\n\t\r\n\t\t\t\tvar parameters = this.parameters;\r\n\t\r\n\t\t\t\tfor ( var key in parameters ) {\r\n\t\r\n\t\t\t\t\tif ( parameters[ key ] !== undefined ) data[ key ] = parameters[ key ];\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\treturn data;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tdata.data = { attributes: {} };\r\n\t\r\n\t\t\tvar index = this.index;\r\n\t\r\n\t\t\tif ( index !== null ) {\r\n\t\r\n\t\t\t\tvar array = Array.prototype.slice.call( index.array );\r\n\t\r\n\t\t\t\tdata.data.index = {\r\n\t\t\t\t\ttype: index.array.constructor.name,\r\n\t\t\t\t\tarray: array\r\n\t\t\t\t};\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar attributes = this.attributes;\r\n\t\r\n\t\t\tfor ( var key in attributes ) {\r\n\t\r\n\t\t\t\tvar attribute = attributes[ key ];\r\n\t\r\n\t\t\t\tvar array = Array.prototype.slice.call( attribute.array );\r\n\t\r\n\t\t\t\tdata.data.attributes[ key ] = {\r\n\t\t\t\t\titemSize: attribute.itemSize,\r\n\t\t\t\t\ttype: attribute.array.constructor.name,\r\n\t\t\t\t\tarray: array\r\n\t\t\t\t};\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar groups = this.groups;\r\n\t\r\n\t\t\tif ( groups.length > 0 ) {\r\n\t\r\n\t\t\t\tdata.data.groups = JSON.parse( JSON.stringify( groups ) );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar boundingSphere = this.boundingSphere;\r\n\t\r\n\t\t\tif ( boundingSphere !== null ) {\r\n\t\r\n\t\t\t\tdata.data.boundingSphere = {\r\n\t\t\t\t\tcenter: boundingSphere.center.toArray(),\r\n\t\t\t\t\tradius: boundingSphere.radius\r\n\t\t\t\t};\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn data;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tclone: function () {\r\n\t\r\n\t\t\treturn new this.constructor().copy( this );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcopy: function ( source ) {\r\n\t\r\n\t\t\tvar index = source.index;\r\n\t\r\n\t\t\tif ( index !== null ) {\r\n\t\r\n\t\t\t\tthis.setIndex( index.clone() );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar attributes = source.attributes;\r\n\t\r\n\t\t\tfor ( var name in attributes ) {\r\n\t\r\n\t\t\t\tvar attribute = attributes[ name ];\r\n\t\t\t\tthis.addAttribute( name, attribute.clone() );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar groups = source.groups;\r\n\t\r\n\t\t\tfor ( var i = 0, l = groups.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\tvar group = groups[ i ];\r\n\t\t\t\tthis.addGroup( group.start, group.count );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tdispose: function () {\r\n\t\r\n\t\t\tthis.dispatchEvent( { type: 'dispose' } );\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.EventDispatcher.prototype.apply( THREE.BufferGeometry.prototype );\r\n\t\r\n\tTHREE.BufferGeometry.MaxIndex = 65535;\r\n\t\r\n\t// File:src/core/InstancedBufferGeometry.js\r\n\t\r\n\t/**\r\n\t * @author benaadams / https://twitter.com/ben_a_adams\r\n\t */\r\n\t\r\n\tTHREE.InstancedBufferGeometry = function () {\r\n\t\r\n\t\tTHREE.BufferGeometry.call( this );\r\n\t\r\n\t\tthis.type = 'InstancedBufferGeometry';\r\n\t\tthis.maxInstancedCount = undefined;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.InstancedBufferGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\r\n\tTHREE.InstancedBufferGeometry.prototype.constructor = THREE.InstancedBufferGeometry;\r\n\t\r\n\tTHREE.InstancedBufferGeometry.prototype.addGroup = function ( start, count, instances ) {\r\n\t\r\n\t\tthis.groups.push( {\r\n\t\r\n\t\t\tstart: start,\r\n\t\t\tcount: count,\r\n\t\t\tinstances: instances\r\n\t\r\n\t\t} );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.InstancedBufferGeometry.prototype.copy = function ( source ) {\r\n\t\r\n\t\tvar index = source.index;\r\n\t\r\n\t\tif ( index !== null ) {\r\n\t\r\n\t\t\tthis.setIndex( index.clone() );\r\n\t\r\n\t\t}\r\n\t\r\n\t\tvar attributes = source.attributes;\r\n\t\r\n\t\tfor ( var name in attributes ) {\r\n\t\r\n\t\t\tvar attribute = attributes[ name ];\r\n\t\t\tthis.addAttribute( name, attribute.clone() );\r\n\t\r\n\t\t}\r\n\t\r\n\t\tvar groups = source.groups;\r\n\t\r\n\t\tfor ( var i = 0, l = groups.length; i < l; i ++ ) {\r\n\t\r\n\t\t\tvar group = groups[ i ];\r\n\t\t\tthis.addGroup( group.start, group.count, group.instances );\r\n\t\r\n\t\t}\r\n\t\r\n\t\treturn this;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.EventDispatcher.prototype.apply( THREE.InstancedBufferGeometry.prototype );\r\n\t\r\n\t// File:src/animation/AnimationAction.js\r\n\t\r\n\t/**\r\n\t *\r\n\t * A clip that has been explicitly scheduled.\r\n\t *\r\n\t * @author Ben Houston / http://clara.io/\r\n\t * @author David Sarno / http://lighthaus.us/\r\n\t */\r\n\t\r\n\tTHREE.AnimationAction = function ( clip, startTime, timeScale, weight, loop ) {\r\n\t\r\n\t\tif ( clip === undefined ) throw new Error( 'clip is null' );\r\n\t\tthis.clip = clip;\r\n\t\tthis.localRoot = null;\r\n\t\tthis.startTime = startTime || 0;\r\n\t\tthis.timeScale = timeScale || 1;\r\n\t\tthis.weight = weight || 1;\r\n\t\tthis.loop = loop || THREE.LoopRepeat;\r\n\t\tthis.loopCount = 0;\r\n\t\tthis.enabled = true;\t// allow for easy disabling of the action.\r\n\t\r\n\t\tthis.actionTime = - this.startTime;\r\n\t\tthis.clipTime = 0;\r\n\t\r\n\t\tthis.propertyBindings = [];\r\n\t};\r\n\t\r\n\t/*\r\n\tTHREE.LoopOnce = 2200;\r\n\tTHREE.LoopRepeat = 2201;\r\n\tTHREE.LoopPingPing = 2202;\r\n\t*/\r\n\t\r\n\tTHREE.AnimationAction.prototype = {\r\n\t\r\n\t\tconstructor: THREE.AnimationAction,\r\n\t\r\n\t\tsetLocalRoot: function( localRoot ) {\r\n\t\r\n\t\t\tthis.localRoot = localRoot;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tupdateTime: function( clipDeltaTime ) {\r\n\t\r\n\t\t\tvar previousClipTime = this.clipTime;\r\n\t   \t\tvar previousLoopCount = this.loopCount;\r\n\t   \t\tvar previousActionTime = this.actionTime;\r\n\t\r\n\t\t\tvar duration = this.clip.duration;\r\n\t\r\n\t\t\tthis.actionTime = this.actionTime + clipDeltaTime;\r\n\t\r\n\t\t\tif ( this.loop === THREE.LoopOnce ) {\r\n\t\r\n\t\t\t\tthis.loopCount = 0;\r\n\t\t\t\tthis.clipTime = Math.min( Math.max( this.actionTime, 0 ), duration );\r\n\t\r\n\t\t\t\t// if time is changed since last time, see if we have hit a start/end limit\r\n\t\t\t\tif ( this.clipTime !== previousClipTime ) {\r\n\t\r\n\t\t\t\t\tif ( this.clipTime === duration ) {\r\n\t\r\n\t\t\t\t\t\tthis.mixer.dispatchEvent( { type: 'finished', action: this, direction: 1 } );\r\n\t\r\n\t\t\t\t\t} else if ( this.clipTime === 0 ) {\r\n\t\r\n\t\t\t\t\t\tthis.mixer.dispatchEvent( { type: 'finished', action: this, direction: -1 } );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\r\n\t\t\t\treturn this.clipTime;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tthis.loopCount = Math.floor( this.actionTime / duration );\r\n\t\r\n\t\t\tvar newClipTime = this.actionTime - this.loopCount * duration;\r\n\t\t\tnewClipTime = newClipTime % duration;\r\n\t\r\n\t\t\t// if we are ping pong looping, ensure that we go backwards when appropriate\r\n\t\t\tif ( this.loop == THREE.LoopPingPong ) {\r\n\t\r\n\t\t\t\tif ( Math.abs( this.loopCount % 2 ) === 1 ) {\r\n\t\r\n\t\t\t\t\tnewClipTime = duration - newClipTime;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tthis.clipTime = newClipTime;\r\n\t\r\n\t\t\tif ( this.loopCount !== previousLoopCount ) {\r\n\t\r\n\t   \t\t\tthis.mixer.dispatchEvent( { type: 'loop', action: this, loopDelta: ( this.loopCount - this.loopCount ) } );\r\n\t\r\n\t   \t\t}\r\n\t\r\n\t\t   \treturn this.clipTime;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsyncWith: function( action ) {\r\n\t\r\n\t\t\tthis.actionTime = action.actionTime;\r\n\t\t\tthis.timeScale = action.timeScale;\r\n\t\r\n\t\t\treturn this;\r\n\t\t},\r\n\t\r\n\t\twarpToDuration: function( duration ) {\r\n\t\r\n\t\t\tthis.timeScale = this.clip.duration / duration;\r\n\t\r\n\t\t\treturn this;\r\n\t\t},\r\n\t\r\n\t\tinit: function( time ) {\r\n\t\r\n\t\t\tthis.clipTime = time - this.startTime;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tupdate: function( clipDeltaTime ) {\r\n\t\r\n\t\t\tthis.updateTime( clipDeltaTime );\r\n\t\r\n\t\t\tvar clipResults = this.clip.getAt( this.clipTime );\r\n\t\r\n\t\t\treturn clipResults;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tgetTimeScaleAt: function( time ) {\r\n\t\r\n\t\t\tif ( this.timeScale.getAt ) {\r\n\t\t\t\t// pass in time, not clip time, allows for fadein/fadeout across multiple loops of the clip\r\n\t\t\t\treturn this.timeScale.getAt( time );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn this.timeScale;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tgetWeightAt: function( time ) {\r\n\t\r\n\t\t\tif ( this.weight.getAt ) {\r\n\t\t\t\t// pass in time, not clip time, allows for fadein/fadeout across multiple loops of the clip\r\n\t\t\t\treturn this.weight.getAt( time );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn this.weight;\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/animation/AnimationClip.js\r\n\t\r\n\t/**\r\n\t *\r\n\t * Reusable set of Tracks that represent an animation.\r\n\t *\r\n\t * @author Ben Houston / http://clara.io/\r\n\t * @author David Sarno / http://lighthaus.us/\r\n\t */\r\n\t\r\n\tTHREE.AnimationClip = function ( name, duration, tracks ) {\r\n\t\r\n\t\tthis.name = name;\r\n\t\tthis.tracks = tracks;\r\n\t\tthis.duration = ( duration !== undefined ) ? duration : -1;\r\n\t\r\n\t\t// this means it should figure out its duration by scanning the tracks\r\n\t\tif ( this.duration < 0 ) {\r\n\t\t\tfor ( var i = 0; i < this.tracks.length; i ++ ) {\r\n\t\t\t\tvar track = this.tracks[i];\r\n\t\t\t\tthis.duration = Math.max( track.keys[ track.keys.length - 1 ].time );\r\n\t\t\t}\r\n\t\t}\r\n\t\r\n\t\t// maybe only do these on demand, as doing them here could potentially slow down loading\r\n\t\t// but leaving these here during development as this ensures a lot of testing of these functions\r\n\t\tthis.trim();\r\n\t\tthis.optimize();\r\n\t\r\n\t\tthis.results = [];\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.AnimationClip.prototype = {\r\n\t\r\n\t\tconstructor: THREE.AnimationClip,\r\n\t\r\n\t\tgetAt: function( clipTime ) {\r\n\t\r\n\t\t\tclipTime = Math.max( 0, Math.min( clipTime, this.duration ) );\r\n\t\r\n\t\t\tfor ( var i = 0; i < this.tracks.length; i ++ ) {\r\n\t\r\n\t\t\t\tvar track = this.tracks[ i ];\r\n\t\r\n\t\t\t\tthis.results[ i ] = track.getAt( clipTime );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn this.results;\r\n\t\t},\r\n\t\r\n\t\ttrim: function() {\r\n\t\r\n\t\t\tfor ( var i = 0; i < this.tracks.length; i ++ ) {\r\n\t\r\n\t\t\t\tthis.tracks[ i ].trim( 0, this.duration );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\toptimize: function() {\r\n\t\r\n\t\t\tfor ( var i = 0; i < this.tracks.length; i ++ ) {\r\n\t\r\n\t\t\t\tthis.tracks[ i ].optimize();\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t\r\n\tTHREE.AnimationClip.CreateFromMorphTargetSequence = function( name, morphTargetSequence, fps ) {\r\n\t\r\n\t\r\n\t\tvar numMorphTargets = morphTargetSequence.length;\r\n\t\tvar tracks = [];\r\n\t\r\n\t\tfor ( var i = 0; i < numMorphTargets; i ++ ) {\r\n\t\r\n\t\t\tvar keys = [];\r\n\t\r\n\t\t\tkeys.push( { time: ( i + numMorphTargets - 1 ) % numMorphTargets, value: 0 } );\r\n\t\t\tkeys.push( { time: i, value: 1 } );\r\n\t\t\tkeys.push( { time: ( i + 1 ) % numMorphTargets, value: 0 } );\r\n\t\r\n\t\t\tkeys.sort( THREE.KeyframeTrack.keyComparer );\r\n\t\r\n\t\t\t// if there is a key at the first frame, duplicate it as the last frame as well for perfect loop.\r\n\t\t\tif ( keys[0].time === 0 ) {\r\n\t\t\t\tkeys.push( {\r\n\t\t\t\t\ttime: numMorphTargets,\r\n\t\t\t\t\tvalue: keys[0].value\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\r\n\t\t\ttracks.push( new THREE.NumberKeyframeTrack( '.morphTargetInfluences[' + morphTargetSequence[i].name + ']', keys ).scale( 1.0 / fps ) );\r\n\t\t}\r\n\t\r\n\t\treturn new THREE.AnimationClip( name, -1, tracks );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.AnimationClip.findByName = function( clipArray, name ) {\r\n\t\r\n\t\tfor ( var i = 0; i < clipArray.length; i ++ ) {\r\n\t\r\n\t\t\tif ( clipArray[i].name === name ) {\r\n\t\r\n\t\t\t\treturn clipArray[i];\r\n\t\r\n\t\t\t}\r\n\t\t}\r\n\t\r\n\t\treturn null;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.AnimationClip.CreateClipsFromMorphTargetSequences = function( morphTargets, fps ) {\r\n\t\r\n\t\tvar animationToMorphTargets = {};\r\n\t\r\n\t\t// tested with https://regex101.com/ on trick sequences such flamingo_flyA_003, flamingo_run1_003, crdeath0059\r\n\t\tvar pattern = /^([\\w-]*?)([\\d]+)$/;\r\n\t\r\n\t\t// sort morph target names into animation groups based patterns like Walk_001, Walk_002, Run_001, Run_002\r\n\t\tfor ( var i = 0, il = morphTargets.length; i < il; i ++ ) {\r\n\t\r\n\t\t\tvar morphTarget = morphTargets[ i ];\r\n\t\t\tvar parts = morphTarget.name.match( pattern );\r\n\t\r\n\t\t\tif ( parts && parts.length > 1 ) {\r\n\t\r\n\t\t\t\tvar name = parts[ 1 ];\r\n\t\r\n\t\t\t\tvar animationMorphTargets = animationToMorphTargets[ name ];\r\n\t\t\t\tif ( ! animationMorphTargets ) {\r\n\t\t\t\t\tanimationToMorphTargets[ name ] = animationMorphTargets = [];\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tanimationMorphTargets.push( morphTarget );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tvar clips = [];\r\n\t\r\n\t\tfor ( var name in animationToMorphTargets ) {\r\n\t\r\n\t\t\tclips.push( THREE.AnimationClip.CreateFromMorphTargetSequence( name, animationToMorphTargets[ name ], fps ) );\r\n\t\t}\r\n\t\r\n\t\treturn clips;\r\n\t\r\n\t};\r\n\t\r\n\t// parse the standard JSON format for clips\r\n\tTHREE.AnimationClip.parse = function( json ) {\r\n\t\r\n\t\tvar tracks = [];\r\n\t\r\n\t\tfor ( var i = 0; i < json.tracks.length; i ++ ) {\r\n\t\r\n\t\t\ttracks.push( THREE.KeyframeTrack.parse( json.tracks[i] ).scale( 1.0 / json.fps ) );\r\n\t\r\n\t\t}\r\n\t\r\n\t\treturn new THREE.AnimationClip( json.name, json.duration, tracks );\r\n\t\r\n\t};\r\n\t\r\n\t\r\n\t// parse the animation.hierarchy format\r\n\tTHREE.AnimationClip.parseAnimation = function( animation, bones, nodeName ) {\r\n\t\r\n\t\tif ( ! animation ) {\r\n\t\t\tconsole.error( \"  no animation in JSONLoader data\" );\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\r\n\t\tvar convertTrack = function( trackName, animationKeys, propertyName, trackType, animationKeyToValueFunc ) {\r\n\t\r\n\t\t\tvar keys = [];\r\n\t\r\n\t\t\tfor ( var k = 0; k < animationKeys.length; k ++ ) {\r\n\t\r\n\t\t\t\tvar animationKey = animationKeys[k];\r\n\t\r\n\t\t\t\tif ( animationKey[propertyName] !== undefined ) {\r\n\t\r\n\t\t\t\t\tkeys.push( { time: animationKey.time, value: animationKeyToValueFunc( animationKey ) } );\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// only return track if there are actually keys.\r\n\t\t\tif ( keys.length > 0 ) {\r\n\t\r\n\t\t\t\treturn new trackType( trackName, keys );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn null;\r\n\t\r\n\t\t};\r\n\t\r\n\t\tvar tracks = [];\r\n\t\r\n\t\tvar clipName = animation.name || 'default';\r\n\t\tvar duration = animation.length || -1; // automatic length determination in AnimationClip.\r\n\t\tvar fps = animation.fps || 30;\r\n\t\r\n\t\tvar hierarchyTracks = animation.hierarchy || [];\r\n\t\r\n\t\tfor ( var h = 0; h < hierarchyTracks.length; h ++ ) {\r\n\t\r\n\t\t\tvar animationKeys = hierarchyTracks[ h ].keys;\r\n\t\r\n\t\t\t// skip empty tracks\r\n\t\t\tif ( ! animationKeys || animationKeys.length == 0 ) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\r\n\t\t\t// process morph targets in a way exactly compatible with AnimationHandler.init( animation )\r\n\t\t\tif ( animationKeys[0].morphTargets ) {\r\n\t\r\n\t\t\t\t// figure out all morph targets used in this track\r\n\t\t\t\tvar morphTargetNames = {};\r\n\t\t\t\tfor ( var k = 0; k < animationKeys.length; k ++ ) {\r\n\t\r\n\t\t\t\t\tif ( animationKeys[k].morphTargets ) {\r\n\t\t\t\t\t\tfor ( var m = 0; m < animationKeys[k].morphTargets.length; m ++ ) {\r\n\t\r\n\t\t\t\t\t\t\tmorphTargetNames[ animationKeys[k].morphTargets[m] ] = -1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\t// create a track for each morph target with all zero morphTargetInfluences except for the keys in which the morphTarget is named.\r\n\t\t\t\tfor ( var morphTargetName in morphTargetNames ) {\r\n\t\r\n\t\t\t\t\tvar keys = [];\r\n\t\r\n\t\t\t\t\tfor ( var m = 0; m < animationKeys[k].morphTargets.length; m ++ ) {\r\n\t\r\n\t\t\t\t\t\tvar animationKey = animationKeys[k];\r\n\t\r\n\t\t\t\t\t\tkeys.push( {\r\n\t\t\t\t\t\t\t\ttime: animationKey.time,\r\n\t\t\t\t\t\t\t\tvalue: (( animationKey.morphTarget === morphTargetName ) ? 1 : 0 )\r\n\t\t\t\t\t\t\t});\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\ttracks.push( new THREE.NumberKeyframeTrack( nodeName + '.morphTargetInfluence[' + morphTargetName + ']', keys ) );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tduration = morphTargetNames.length * ( fps || 1.0 );\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\tvar boneName = nodeName + '.bones[' + bones[ h ].name + ']';\r\n\t\r\n\t\t\t\t// track contains positions...\r\n\t\t\t\tvar positionTrack = convertTrack( boneName + '.position', animationKeys, 'pos', THREE.VectorKeyframeTrack, function( animationKey ) {\r\n\t\t\t\t\t\treturn new THREE.Vector3().fromArray( animationKey.pos )\r\n\t\t\t\t\t} );\r\n\t\r\n\t\t\t\tif ( positionTrack ) tracks.push( positionTrack );\r\n\t\r\n\t\t\t\t// track contains quaternions...\r\n\t\t\t\tvar quaternionTrack = convertTrack( boneName + '.quaternion', animationKeys, 'rot', THREE.QuaternionKeyframeTrack, function( animationKey ) {\r\n\t\t\t\t\t\tif ( animationKey.rot.slerp ) {\r\n\t\t\t\t\t\t\treturn animationKey.rot.clone();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\treturn new THREE.Quaternion().fromArray( animationKey.rot );\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} );\r\n\t\r\n\t\t\t\tif ( quaternionTrack ) tracks.push( quaternionTrack );\r\n\t\r\n\t\t\t\t// track contains quaternions...\r\n\t\t\t\tvar scaleTrack = convertTrack( boneName + '.scale', animationKeys, 'scl', THREE.VectorKeyframeTrack, function( animationKey ) {\r\n\t\t\t\t\t\treturn new THREE.Vector3().fromArray( animationKey.scl )\r\n\t\t\t\t\t} );\r\n\t\r\n\t\t\t\tif ( scaleTrack ) tracks.push( scaleTrack );\r\n\t\r\n\t\t\t}\r\n\t\t}\r\n\t\r\n\t\tif ( tracks.length === 0 ) {\r\n\t\r\n\t\t\treturn null;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tvar clip = new THREE.AnimationClip( clipName, duration, tracks );\r\n\t\r\n\t\treturn clip;\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/animation/AnimationMixer.js\r\n\t\r\n\t/**\r\n\t *\r\n\t * Mixes together the AnimationClips scheduled by AnimationActions and applies them to the root and subtree\r\n\t *\r\n\t *\r\n\t * @author Ben Houston / http://clara.io/\r\n\t * @author David Sarno / http://lighthaus.us/\r\n\t */\r\n\t\r\n\tTHREE.AnimationMixer = function( root ) {\r\n\t\r\n\t\tthis.root = root;\r\n\t\tthis.time = 0;\r\n\t\tthis.timeScale = 1.0;\r\n\t\tthis.actions = [];\r\n\t\tthis.propertyBindingMap = {};\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.AnimationMixer.prototype = {\r\n\t\r\n\t\tconstructor: THREE.AnimationMixer,\r\n\t\r\n\t\taddAction: function( action ) {\r\n\t\r\n\t\t\t// TODO: check for duplicate action names?  Or provide each action with a UUID?\r\n\t\r\n\t\t\tthis.actions.push( action );\r\n\t\t\taction.init( this.time );\r\n\t\t\taction.mixer = this;\r\n\t\r\n\t\t\tvar tracks = action.clip.tracks;\r\n\t\r\n\t\t\tvar root = action.localRoot || this.root;\r\n\t\r\n\t\t\tfor ( var i = 0; i < tracks.length; i ++ ) {\r\n\t\r\n\t\t\t\tvar track = tracks[ i ];\r\n\t\r\n\t\t\t\tvar propertyBindingKey = root.uuid + '-' + track.name;\r\n\t\t\t\tvar propertyBinding = this.propertyBindingMap[ propertyBindingKey ];\r\n\t\r\n\t\t\t\tif ( propertyBinding === undefined ) {\r\n\t\r\n\t\t\t\t\tpropertyBinding = new THREE.PropertyBinding( root, track.name );\r\n\t\t\t\t\tthis.propertyBindingMap[ propertyBindingKey ] = propertyBinding;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\t// push in the same order as the tracks.\r\n\t\t\t\taction.propertyBindings.push( propertyBinding );\r\n\t\r\n\t\t\t\t// track usages of shared property bindings, because if we leave too many around, the mixer can get slow\r\n\t\t\t\tpropertyBinding.referenceCount += 1;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t},\r\n\t\r\n\t\tremoveAllActions: function() {\r\n\t\r\n\t\t\tfor ( var i = 0; i < this.actions.length; i ++ ) {\r\n\t\r\n\t\t\t\tthis.actions[i].mixer = null;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// unbind all property bindings\r\n\t\t\tfor ( var properyBindingKey in this.propertyBindingMap ) {\r\n\t\r\n\t\t\t\tthis.propertyBindingMap[ properyBindingKey ].unbind();\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tthis.actions = [];\r\n\t\t\tthis.propertyBindingMap = {};\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tremoveAction: function( action ) {\r\n\t\r\n\t\t\tvar index = this.actions.indexOf( action );\r\n\t\r\n\t\t\tif ( index !== - 1 ) {\r\n\t\r\n\t\t\t\tthis.actions.splice( index, 1 );\r\n\t\t\t\taction.mixer = null;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\r\n\t\t\t// remove unused property bindings because if we leave them around the mixer can get slow\r\n\t\t\tvar root = action.localRoot || this.root;\r\n\t\t\tvar tracks = action.clip.tracks;\r\n\t\r\n\t\t\tfor ( var i = 0; i < tracks.length; i ++ ) {\r\n\t\r\n\t\t\t\tvar track = tracks[ i ];\r\n\t\r\n\t\t\t\tvar propertyBindingKey = root.uuid + '-' + track.name;\r\n\t\t\t\tvar propertyBinding = this.propertyBindingMap[ propertyBindingKey ];\r\n\t\r\n\t\t\t\tpropertyBinding.referenceCount -= 1;\r\n\t\r\n\t\t\t\tif ( propertyBinding.referenceCount <= 0 ) {\r\n\t\r\n\t\t\t\t\tpropertyBinding.unbind();\r\n\t\r\n\t\t\t\t\tdelete this.propertyBindingMap[ propertyBindingKey ];\r\n\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\t// can be optimized if needed\r\n\t\tfindActionByName: function( name ) {\r\n\t\r\n\t\t\tfor ( var i = 0; i < this.actions.length; i ++ ) {\r\n\t\r\n\t\t\t\tif ( this.actions[i].name === name ) return this.actions[i];\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn null;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tplay: function( action, optionalFadeInDuration ) {\r\n\t\r\n\t\t\taction.startTime = this.time;\r\n\t\t\tthis.addAction( action );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tfadeOut: function( action, duration ) {\r\n\t\r\n\t\t\tvar keys = [];\r\n\t\r\n\t\t\tkeys.push( { time: this.time, value: 1 } );\r\n\t\t\tkeys.push( { time: this.time + duration, value: 0 } );\r\n\t\r\n\t\t\taction.weight = new THREE.NumberKeyframeTrack( \"weight\", keys );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tfadeIn: function( action, duration ) {\r\n\t\r\n\t\t\tvar keys = [];\r\n\t\r\n\t\t\tkeys.push( { time: this.time, value: 0 } );\r\n\t\t\tkeys.push( { time: this.time + duration, value: 1 } );\r\n\t\r\n\t\t\taction.weight = new THREE.NumberKeyframeTrack( \"weight\", keys );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\twarp: function( action, startTimeScale, endTimeScale, duration ) {\r\n\t\r\n\t\t\tvar keys = [];\r\n\t\r\n\t\t\tkeys.push( { time: this.time, value: startTimeScale } );\r\n\t\t\tkeys.push( { time: this.time + duration, value: endTimeScale } );\r\n\t\r\n\t\t\taction.timeScale = new THREE.NumberKeyframeTrack( \"timeScale\", keys );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcrossFade: function( fadeOutAction, fadeInAction, duration, warp ) {\r\n\t\r\n\t\t\tthis.fadeOut( fadeOutAction, duration );\r\n\t\t\tthis.fadeIn( fadeInAction, duration );\r\n\t\r\n\t\t\tif ( warp ) {\r\n\t\r\n\t\t\t\tvar startEndRatio = fadeOutAction.clip.duration / fadeInAction.clip.duration;\r\n\t\t\t\tvar endStartRatio = 1.0 / startEndRatio;\r\n\t\r\n\t\t\t\tthis.warp( fadeOutAction, 1.0, startEndRatio, duration );\r\n\t\t\t\tthis.warp( fadeInAction, endStartRatio, 1.0, duration );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tupdate: function( deltaTime ) {\r\n\t\r\n\t\t\tvar mixerDeltaTime = deltaTime * this.timeScale;\r\n\t\t\tthis.time += mixerDeltaTime;\r\n\t\r\n\t\t\tfor ( var i = 0; i < this.actions.length; i ++ ) {\r\n\t\r\n\t\t\t\tvar action = this.actions[i];\r\n\t\r\n\t\t\t\tvar weight = action.getWeightAt( this.time );\r\n\t\r\n\t\t\t\tvar actionTimeScale = action.getTimeScaleAt( this.time );\r\n\t\t\t\tvar actionDeltaTime = mixerDeltaTime * actionTimeScale;\r\n\t\r\n\t\t\t\tvar actionResults = action.update( actionDeltaTime );\r\n\t\r\n\t\t\t\tif ( action.weight <= 0 || ! action.enabled ) continue;\r\n\t\r\n\t\t\t\tfor ( var j = 0; j < actionResults.length; j ++ ) {\r\n\t\r\n\t\t\t\t\tvar name = action.clip.tracks[j].name;\r\n\t\r\n\t\t\t\t\taction.propertyBindings[ j ].accumulate( actionResults[j], weight );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// apply to nodes\r\n\t\t\tfor ( var propertyBindingKey in this.propertyBindingMap ) {\r\n\t\r\n\t\t\t\tthis.propertyBindingMap[ propertyBindingKey ].apply();\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.EventDispatcher.prototype.apply( THREE.AnimationMixer.prototype );\r\n\t\r\n\t// File:src/animation/AnimationUtils.js\r\n\t\r\n\t/**\r\n\t * @author Ben Houston / http://clara.io/\r\n\t * @author David Sarno / http://lighthaus.us/\r\n\t */\r\n\t\r\n\tTHREE.AnimationUtils = {\r\n\t\r\n\t\tgetEqualsFunc: function( exemplarValue ) {\r\n\t\r\n\t\t\tif ( exemplarValue.equals ) {\r\n\t\t\t\treturn function equals_object( a, b ) {\r\n\t\t\t\t\treturn a.equals( b );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\r\n\t\t\treturn function equals_primitive( a, b ) {\r\n\t\t\t\treturn ( a === b );\r\n\t\t\t};\r\n\t\r\n\t\t},\r\n\t\r\n\t\tclone: function( exemplarValue ) {\r\n\t\r\n\t\t\tvar typeName = typeof exemplarValue;\r\n\t\t\tif ( typeName === \"object\" ) {\r\n\t\t\t\tif ( exemplarValue.clone ) {\r\n\t\t\t\t\treturn exemplarValue.clone();\r\n\t\t\t\t}\r\n\t\t\t\tconsole.error( \"can not figure out how to copy exemplarValue\", exemplarValue );\r\n\t\t\t}\r\n\t\r\n\t\t\treturn exemplarValue;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tlerp: function( a, b, alpha, interTrack ) {\r\n\t\r\n\t\t\tvar lerpFunc = THREE.AnimationUtils.getLerpFunc( a, interTrack );\r\n\t\r\n\t\t\treturn lerpFunc( a, b, alpha );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tlerp_object: function( a, b, alpha ) {\r\n\t\t\treturn a.lerp( b, alpha );\r\n\t\t},\r\n\t\r\n\t\tslerp_object: function( a, b, alpha ) {\r\n\t\t\treturn a.slerp( b, alpha );\r\n\t\t},\r\n\t\r\n\t\tlerp_number: function( a, b, alpha ) {\r\n\t\t\treturn a * ( 1 - alpha ) + b * alpha;\r\n\t\t},\r\n\t\r\n\t\tlerp_boolean: function( a, b, alpha ) {\r\n\t\t\treturn ( alpha < 0.5 ) ? a : b;\r\n\t\t},\r\n\t\r\n\t\tlerp_boolean_immediate: function( a, b, alpha ) {\r\n\t\t\treturn a;\r\n\t\t},\r\n\t\r\n\t\tlerp_string: function( a, b, alpha ) {\r\n\t\t\treturn ( alpha < 0.5 ) ? a : b;\r\n\t\t},\r\n\t\r\n\t\tlerp_string_immediate: function( a, b, alpha ) {\r\n\t \t\treturn a;\r\n\t \t},\r\n\t\r\n\t\t// NOTE: this is an accumulator function that modifies the first argument (e.g. a).\tThis is to minimize memory alocations.\r\n\t\tgetLerpFunc: function( exemplarValue, interTrack ) {\r\n\t\r\n\t\t\tif ( exemplarValue === undefined || exemplarValue === null ) throw new Error( \"examplarValue is null\" );\r\n\t\r\n\t\t\tvar typeName = typeof exemplarValue;\r\n\t\r\n\t\t\tswitch( typeName ) {\r\n\t\r\n\t\t\t\tcase \"object\":\r\n\t\t\t\t\tif ( exemplarValue.lerp ) {\r\n\t\t\t\t\t\treturn THREE.AnimationUtils.lerp_object;\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tif ( exemplarValue.slerp ) {\r\n\t\t\t\t\t\treturn THREE.AnimationUtils.slerp_object;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\tcase \"number\":\r\n\t\t\t\t\treturn THREE.AnimationUtils.lerp_number;\r\n\t\r\n\t\t\t\tcase \"boolean\":\r\n\t\t\t\t\tif ( interTrack ) {\r\n\t\t\t\t\t\treturn THREE.AnimationUtils.lerp_boolean;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn THREE.AnimationUtils.lerp_boolean_immediate;\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\tcase \"string\":\r\n\t\t\t\t\tif ( interTrack ) {\r\n\t\t\t\t\t\treturn THREE.AnimationUtils.lerp_string;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn THREE.AnimationUtils.lerp_string_immediate;\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/animation/KeyframeTrack.js\r\n\t\r\n\t/**\r\n\t *\r\n\t * A Track that returns a keyframe interpolated value, currently linearly interpolated\r\n\t *\r\n\t * @author Ben Houston / http://clara.io/\r\n\t * @author David Sarno / http://lighthaus.us/\r\n\t */\r\n\t\r\n\tTHREE.KeyframeTrack = function ( name, keys ) {\r\n\t\r\n\t\tif ( name === undefined ) throw new Error( \"track name is undefined\" );\r\n\t\tif ( keys === undefined || keys.length === 0 ) throw new Error( \"no keys in track named \" + name );\r\n\t\r\n\t\tthis.name = name;\r\n\t\tthis.keys = keys;\t// time in seconds, value as value\r\n\t\r\n\t\t// the index of the last result, used as a starting point for local search.\r\n\t\tthis.lastIndex = 0;\r\n\t\r\n\t\tthis.validate();\r\n\t\tthis.optimize();\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.KeyframeTrack.prototype = {\r\n\t\r\n\t\tconstructor: THREE.KeyframeTrack,\r\n\t\r\n\t\tgetAt: function( time ) {\r\n\t\r\n\t\r\n\t\t\t// this can not go higher than this.keys.length.\r\n\t\t\twhile( ( this.lastIndex < this.keys.length ) && ( time >= this.keys[this.lastIndex].time ) ) {\r\n\t\t\t\tthis.lastIndex ++;\r\n\t\t\t};\r\n\t\r\n\t\t\t// this can not go lower than 0.\r\n\t\t\twhile( ( this.lastIndex > 0 ) && ( time < this.keys[this.lastIndex - 1].time ) ) {\r\n\t\t\t\tthis.lastIndex --;\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( this.lastIndex >= this.keys.length ) {\r\n\t\r\n\t\t\t\tthis.setResult( this.keys[ this.keys.length - 1 ].value );\r\n\t\r\n\t\t\t\treturn this.result;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( this.lastIndex === 0 ) {\r\n\t\r\n\t\t\t\tthis.setResult( this.keys[ 0 ].value );\r\n\t\r\n\t\t\t\treturn this.result;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar prevKey = this.keys[ this.lastIndex - 1 ];\r\n\t\t\tthis.setResult( prevKey.value );\r\n\t\r\n\t\t\t// if true, means that prev/current keys are identical, thus no interpolation required.\r\n\t\t\tif ( prevKey.constantToNext ) {\r\n\t\r\n\t\t\t\treturn this.result;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// linear interpolation to start with\r\n\t\t\tvar currentKey = this.keys[ this.lastIndex ];\r\n\t\t\tvar alpha = ( time - prevKey.time ) / ( currentKey.time - prevKey.time );\r\n\t\t\tthis.result = this.lerpValues( this.result, currentKey.value, alpha );\r\n\t\r\n\t\t\treturn this.result;\r\n\t\r\n\t\t},\r\n\t\r\n\t\t// move all keyframes either forwards or backwards in time\r\n\t\tshift: function( timeOffset ) {\r\n\t\r\n\t\t\tif ( timeOffset !== 0.0 ) {\r\n\t\r\n\t\t\t\tfor ( var i = 0; i < this.keys.length; i ++ ) {\r\n\t\t\t\t\tthis.keys[i].time += timeOffset;\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\t// scale all keyframe times by a factor (useful for frame <-> seconds conversions)\r\n\t\tscale: function( timeScale ) {\r\n\t\r\n\t\t\tif ( timeScale !== 1.0 ) {\r\n\t\r\n\t\t\t\tfor ( var i = 0; i < this.keys.length; i ++ ) {\r\n\t\t\t\t\tthis.keys[i].time *= timeScale;\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\t// removes keyframes before and after animation without changing any values within the range [startTime, endTime].\r\n\t\t// IMPORTANT: We do not shift around keys to the start of the track time, because for interpolated keys this will change their values\r\n\t \ttrim: function( startTime, endTime ) {\r\n\t\r\n\t\t\tvar firstKeysToRemove = 0;\r\n\t\t\tfor ( var i = 1; i < this.keys.length; i ++ ) {\r\n\t\t\t\tif ( this.keys[i] <= startTime ) {\r\n\t\t\t\t\tfirstKeysToRemove ++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\r\n\t\t\tvar lastKeysToRemove = 0;\r\n\t\t\tfor ( var i = this.keys.length - 2; i > 0; i ++ ) {\r\n\t\t\t\tif ( this.keys[i] >= endTime ) {\r\n\t\t\t\t\tlastKeysToRemove ++;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\r\n\t\t\t// remove last keys first because it doesn't affect the position of the first keys (the otherway around doesn't work as easily)\r\n\t\t\tif ( ( firstKeysToRemove + lastKeysToRemove ) > 0 ) {\r\n\t\t\t\tthis.keys = this.keys.splice( firstKeysToRemove, this.keys.length - lastKeysToRemove - firstKeysToRemove );;\r\n\t\t\t}\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\t/* NOTE: This is commented out because we really shouldn't have to handle unsorted key lists\r\n\t\t         Tracks with out of order keys should be considered to be invalid.  - bhouston\r\n\t\tsort: function() {\r\n\t\r\n\t\t\tthis.keys.sort( THREE.KeyframeTrack.keyComparer );\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},*/\r\n\t\r\n\t\t// ensure we do not get a GarbageInGarbageOut situation, make sure tracks are at least minimally viable\r\n\t\t// One could eventually ensure that all key.values in a track are all of the same type (otherwise interpolation makes no sense.)\r\n\t\tvalidate: function() {\r\n\t\r\n\t\t\tvar prevKey = null;\r\n\t\r\n\t\t\tif ( this.keys.length === 0 ) {\r\n\t\t\t\tconsole.error( \"  track is empty, no keys\", this );\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\r\n\t\t\tfor ( var i = 0; i < this.keys.length; i ++ ) {\r\n\t\r\n\t\t\t\tvar currKey = this.keys[i];\r\n\t\r\n\t\t\t\tif ( ! currKey ) {\r\n\t\t\t\t\tconsole.error( \"  key is null in track\", this, i );\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( ( typeof currKey.time ) !== 'number' || isNaN( currKey.time ) ) {\r\n\t\t\t\t\tconsole.error( \"  key.time is not a valid number\", this, i, currKey );\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( currKey.value === undefined || currKey.value === null) {\r\n\t\t\t\t\tconsole.error( \"  key.value is null in track\", this, i, currKey );\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( prevKey && prevKey.time > currKey.time ) {\r\n\t\t\t\t\tconsole.error( \"  key.time is less than previous key time, out of order keys\", this, i, currKey, prevKey );\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tprevKey = currKey;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\t// currently only removes equivalent sequential keys (0,0,0,0,1,1,1,0,0,0,0,0,0,0) --> (0,0,1,1,0,0), which are common in morph target animations\r\n\t\toptimize: function() {\r\n\t\r\n\t\t\tvar newKeys = [];\r\n\t\t\tvar prevKey = this.keys[0];\r\n\t\t\tnewKeys.push( prevKey );\r\n\t\r\n\t\t\tvar equalsFunc = THREE.AnimationUtils.getEqualsFunc( prevKey.value );\r\n\t\r\n\t\t\tfor ( var i = 1; i < this.keys.length - 1; i ++ ) {\r\n\t\t\t\tvar currKey = this.keys[i];\r\n\t\t\t\tvar nextKey = this.keys[i+1];\r\n\t\r\n\t\t\t\t// if prevKey & currKey are the same time, remove currKey.  If you want immediate adjacent keys, use an epsilon offset\r\n\t\t\t\t// it is not possible to have two keys at the same time as we sort them.  The sort is not stable on keys with the same time.\r\n\t\t\t\tif ( ( prevKey.time === currKey.time ) ) {\r\n\t\r\n\t\t\t\t\tcontinue;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\t// remove completely unnecessary keyframes that are the same as their prev and next keys\r\n\t\t\t\tif ( this.compareValues( prevKey.value, currKey.value ) && this.compareValues( currKey.value, nextKey.value ) ) {\r\n\t\r\n\t\t\t\t\tcontinue;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\t// determine if interpolation is required\r\n\t\t\t\tprevKey.constantToNext = this.compareValues( prevKey.value, currKey.value );\r\n\t\r\n\t\t\t\tnewKeys.push( currKey );\r\n\t\t\t\tprevKey = currKey;\r\n\t\t\t}\r\n\t\t\tnewKeys.push( this.keys[ this.keys.length - 1 ] );\r\n\t\r\n\t\t\tthis.keys = newKeys;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.KeyframeTrack.keyComparer = function keyComparator(key0, key1) {\r\n\t\treturn key0.time - key1.time;\r\n\t};\r\n\t\r\n\tTHREE.KeyframeTrack.parse = function( json ) {\r\n\t\r\n\t\tif ( json.type === undefined ) throw new Error( \"track type undefined, can not parse\" );\r\n\t\r\n\t\tvar trackType = THREE.KeyframeTrack.GetTrackTypeForTypeName( json.type );\r\n\t\r\n\t\treturn trackType.parse( json );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.KeyframeTrack.GetTrackTypeForTypeName = function( typeName ) {\r\n\t\tswitch( typeName.toLowerCase() ) {\r\n\t\t \tcase \"vector\":\r\n\t\t \tcase \"vector2\":\r\n\t\t \tcase \"vector3\":\r\n\t\t \tcase \"vector4\":\r\n\t\t\t\treturn THREE.VectorKeyframeTrack;\r\n\t\r\n\t\t \tcase \"quaternion\":\r\n\t\t\t\treturn THREE.QuaternionKeyframeTrack;\r\n\t\r\n\t\t \tcase \"integer\":\r\n\t\t \tcase \"scalar\":\r\n\t\t \tcase \"double\":\r\n\t\t \tcase \"float\":\r\n\t\t \tcase \"number\":\r\n\t\t\t\treturn THREE.NumberKeyframeTrack;\r\n\t\r\n\t\t \tcase \"bool\":\r\n\t\t \tcase \"boolean\":\r\n\t\t\t\treturn THREE.BooleanKeyframeTrack;\r\n\t\r\n\t\t \tcase \"string\":\r\n\t\t \t\treturn THREE.StringKeyframeTrack;\r\n\t\t};\r\n\t\r\n\t\tthrow new Error( \"Unsupported typeName: \" + typeName );\r\n\t};\r\n\t\r\n\t// File:src/animation/PropertyBinding.js\r\n\t\r\n\t/**\r\n\t *\r\n\t * A track bound to a real value in the scene graph.\r\n\t *\r\n\t * @author Ben Houston / http://clara.io/\r\n\t * @author David Sarno / http://lighthaus.us/\r\n\t */\r\n\t\r\n\tTHREE.PropertyBinding = function ( rootNode, trackName ) {\r\n\t\r\n\t\tthis.rootNode = rootNode;\r\n\t\tthis.trackName = trackName;\r\n\t\tthis.referenceCount = 0;\r\n\t\tthis.originalValue = null; // the value of the property before it was controlled by this binding\r\n\t\r\n\t\tvar parseResults = THREE.PropertyBinding.parseTrackName( trackName );\r\n\t\r\n\t\tthis.directoryName = parseResults.directoryName;\r\n\t\tthis.nodeName = parseResults.nodeName;\r\n\t\tthis.objectName = parseResults.objectName;\r\n\t\tthis.objectIndex = parseResults.objectIndex;\r\n\t\tthis.propertyName = parseResults.propertyName;\r\n\t\tthis.propertyIndex = parseResults.propertyIndex;\r\n\t\r\n\t\tthis.node = THREE.PropertyBinding.findNode( rootNode, this.nodeName ) || rootNode;\r\n\t\r\n\t\tthis.cumulativeValue = null;\r\n\t\tthis.cumulativeWeight = 0;\r\n\t};\r\n\t\r\n\tTHREE.PropertyBinding.prototype = {\r\n\t\r\n\t\tconstructor: THREE.PropertyBinding,\r\n\t\r\n\t\treset: function() {\r\n\t\r\n\t\t\tthis.cumulativeValue = null;\r\n\t\t\tthis.cumulativeWeight = 0;\r\n\t\r\n\t\t},\r\n\t\r\n\t\taccumulate: function( value, weight ) {\r\n\t\r\n\t\t\tif ( ! this.isBound ) this.bind();\r\n\t\r\n\t\t\tif ( this.cumulativeWeight === 0 ) {\r\n\t\r\n\t\t\t\tif ( weight > 0 ) {\r\n\t\r\n\t\t\t\t\tif ( this.cumulativeValue === null ) {\r\n\t\t\t\t\t\tthis.cumulativeValue = THREE.AnimationUtils.clone( value );\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.cumulativeWeight = weight;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\tvar lerpAlpha = weight / ( this.cumulativeWeight + weight );\r\n\t\t\t\tthis.cumulativeValue = this.lerpValue( this.cumulativeValue, value, lerpAlpha );\r\n\t\t\t\tthis.cumulativeWeight += weight;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t},\r\n\t\r\n\t\tunbind: function() {\r\n\t\r\n\t\t\tif ( ! this.isBound ) return;\r\n\t\r\n\t\t\tthis.setValue( this.originalValue );\r\n\t\r\n\t\t\tthis.setValue = null;\r\n\t\t\tthis.getValue = null;\r\n\t\t\tthis.lerpValue = null;\r\n\t\t\tthis.equalsValue = null;\r\n\t\t\tthis.triggerDirty = null;\r\n\t\t\tthis.isBound = false;\r\n\t\r\n\t\t},\r\n\t\r\n\t\t// bind to the real property in the scene graph, remember original value, memorize various accessors for speed/inefficiency\r\n\t\tbind: function() {\r\n\t\r\n\t\t\tif ( this.isBound ) return;\r\n\t\r\n\t\t\tvar targetObject = this.node;\r\n\t\r\n\t \t\t// ensure there is a value node\r\n\t\t\tif ( ! targetObject ) {\r\n\t\t\t\tconsole.error( \"  trying to update node for track: \" + this.trackName + \" but it wasn't found.\" );\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( this.objectName ) {\r\n\t\t\t\t// special case were we need to reach deeper into the hierarchy to get the face materials....\r\n\t\t\t\tif ( this.objectName === \"materials\" ) {\r\n\t\t\t\t\tif ( ! targetObject.material ) {\r\n\t\t\t\t\t\tconsole.error( '  can not bind to material as node does not have a material', this );\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( ! targetObject.material.materials ) {\r\n\t\t\t\t\t\tconsole.error( '  can not bind to material.materials as node.material does not have a materials array', this );\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttargetObject = targetObject.material.materials;\r\n\t\t\t\t} else if ( this.objectName === \"bones\" ) {\r\n\t\t\t\t\tif ( ! targetObject.skeleton ) {\r\n\t\t\t\t\t\tconsole.error( '  can not bind to bones as node does not have a skeleton', this );\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// potential future optimization: skip this if propertyIndex is already an integer, and convert the integer string to a true integer.\r\n\t\r\n\t\t\t\t\ttargetObject = targetObject.skeleton.bones;\r\n\t\r\n\t\t\t\t\t// support resolving morphTarget names into indices.\r\n\t\t\t\t\tfor ( var i = 0; i < targetObject.length; i ++ ) {\r\n\t\t\t\t\t\tif ( targetObject[i].name === this.objectIndex ) {\r\n\t\t\t\t\t\t\tthis.objectIndex = i;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tif ( targetObject[ this.objectName ] === undefined ) {\r\n\t\t\t\t\t\tconsole.error( '  can not bind to objectName of node, undefined', this );\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttargetObject = targetObject[ this.objectName ];\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( this.objectIndex !== undefined ) {\r\n\t\t\t\t\tif ( targetObject[ this.objectIndex ] === undefined ) {\r\n\t\t\t\t\t\tconsole.error( \"  trying to bind to objectIndex of objectName, but is undefined:\", this, targetObject );\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\ttargetObject = targetObject[ this.objectIndex ];\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t \t\t// special case mappings\r\n\t \t\tvar nodeProperty = targetObject[ this.propertyName ];\r\n\t\t\tif ( ! nodeProperty ) {\r\n\t\t\t\tconsole.error( \"  trying to update property for track: \" + this.nodeName + '.' + this.propertyName + \" but it wasn't found.\", targetObject );\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\r\n\t\t\t// access a sub element of the property array (only primitives are supported right now)\r\n\t\t\tif ( this.propertyIndex !== undefined ) {\r\n\t\r\n\t\t\t\tif ( this.propertyName === \"morphTargetInfluences\" ) {\r\n\t\t\t\t\t// potential optimization, skip this if propertyIndex is already an integer, and convert the integer string to a true integer.\r\n\t\r\n\t\t\t\t\t// support resolving morphTarget names into indices.\r\n\t\t\t\t\tif ( ! targetObject.geometry ) {\r\n\t\t\t\t\t\tconsole.error( '  can not bind to morphTargetInfluences becasuse node does not have a geometry', this );\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( ! targetObject.geometry.morphTargets ) {\r\n\t\t\t\t\t\tconsole.error( '  can not bind to morphTargetInfluences becasuse node does not have a geometry.morphTargets', this );\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tfor ( var i = 0; i < this.node.geometry.morphTargets.length; i ++ ) {\r\n\t\t\t\t\t\tif ( targetObject.geometry.morphTargets[i].name === this.propertyIndex ) {\r\n\t\t\t\t\t\t\tthis.propertyIndex = i;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tthis.setValue = function setValue_propertyIndexed( value ) {\r\n\t\t\t\t\tif ( ! this.equalsValue( nodeProperty[ this.propertyIndex ], value ) ) {\r\n\t\t\t\t\t\tnodeProperty[ this.propertyIndex ] = value;\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t};\r\n\t\r\n\t\t\t\tthis.getValue = function getValue_propertyIndexed() {\r\n\t\t\t\t\treturn nodeProperty[ this.propertyIndex ];\r\n\t\t\t\t};\r\n\t\r\n\t\t\t}\r\n\t\t\t// must use copy for Object3D.Euler/Quaternion\r\n\t\t\telse if ( nodeProperty.copy ) {\r\n\t\r\n\t\t\t\tthis.setValue = function setValue_propertyObject( value ) {\r\n\t\t\t\t\tif ( ! this.equalsValue( nodeProperty, value ) ) {\r\n\t\t\t\t\t\tnodeProperty.copy( value );\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tthis.getValue = function getValue_propertyObject() {\r\n\t\t\t\t\treturn nodeProperty;\r\n\t\t\t\t};\r\n\t\r\n\t\t\t}\r\n\t\t\t// otherwise just set the property directly on the node (do not use nodeProperty as it may not be a reference object)\r\n\t\t\telse {\r\n\t\r\n\t\t\t\tthis.setValue = function setValue_property( value ) {\r\n\t\t\t\t\tif ( ! this.equalsValue( targetObject[ this.propertyName ], value ) ) {\r\n\t\t\t\t\t\ttargetObject[ this.propertyName ] = value;\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tthis.getValue = function getValue_property() {\r\n\t\t\t\t\treturn targetObject[ this.propertyName ];\r\n\t\t\t\t};\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// trigger node dirty\r\n\t\t\tif ( targetObject.needsUpdate !== undefined ) { // material\r\n\t\r\n\t\t\t\tthis.triggerDirty = function triggerDirty_needsUpdate() {\r\n\t\t\t\t\tthis.node.needsUpdate = true;\r\n\t\t\t\t}\r\n\t\r\n\t\t\t} else if ( targetObject.matrixWorldNeedsUpdate !== undefined ) { // node transform\r\n\t\r\n\t\t\t\tthis.triggerDirty = function triggerDirty_matrixWorldNeedsUpdate() {\r\n\t\t\t\t\ttargetObject.matrixWorldNeedsUpdate = true;\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tthis.originalValue = this.getValue();\r\n\t\r\n\t\t\tthis.equalsValue = THREE.AnimationUtils.getEqualsFunc( this.originalValue );\r\n\t\t\tthis.lerpValue = THREE.AnimationUtils.getLerpFunc( this.originalValue, true );\r\n\t\r\n\t\t\tthis.isBound = true;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tapply: function() {\r\n\t\r\n\t\t\t// for speed capture the setter pattern as a closure (sort of a memoization pattern: https://en.wikipedia.org/wiki/Memoization)\r\n\t\t\tif ( ! this.isBound ) this.bind();\r\n\t\r\n\t\t\t// early exit if there is nothing to apply.\r\n\t\t\tif ( this.cumulativeWeight > 0 ) {\r\n\t\r\n\t\t\t\t// blend with original value\r\n\t\t\t\tif ( this.cumulativeWeight < 1 ) {\r\n\t\r\n\t\t\t\t\tvar remainingWeight = 1 - this.cumulativeWeight;\r\n\t\t\t\t\tvar lerpAlpha = remainingWeight / ( this.cumulativeWeight + remainingWeight );\r\n\t\t\t\t\tthis.cumulativeValue = this.lerpValue( this.cumulativeValue, this.originalValue, lerpAlpha );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tvar valueChanged = this.setValue( this.cumulativeValue );\r\n\t\r\n\t\t\t\tif ( valueChanged && this.triggerDirty ) {\r\n\t\t\t\t\tthis.triggerDirty();\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\t// reset accumulator\r\n\t\t\t\tthis.cumulativeValue = null;\r\n\t\t\t\tthis.cumulativeWeight = 0;\r\n\t\r\n\t\t\t}\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t\r\n\tTHREE.PropertyBinding.parseTrackName = function( trackName ) {\r\n\t\r\n\t\t// matches strings in the form of:\r\n\t\t//    nodeName.property\r\n\t\t//    nodeName.property[accessor]\r\n\t\t//    nodeName.material.property[accessor]\r\n\t\t//    uuid.property[accessor]\r\n\t\t//    uuid.objectName[objectIndex].propertyName[propertyIndex]\r\n\t\t//    parentName/nodeName.property\r\n\t\t//    parentName/parentName/nodeName.property[index]\r\n\t\t//\t  .bone[Armature.DEF_cog].position\r\n\t\t// created and tested via https://regex101.com/#javascript\r\n\t\r\n\t\tvar re = /^(([\\w]+\\/)*)([\\w-\\d]+)?(\\.([\\w]+)(\\[([\\w\\d\\[\\]\\_. ]+)\\])?)?(\\.([\\w.]+)(\\[([\\w\\d\\[\\]\\_. ]+)\\])?)$/;\r\n\t\tvar matches = re.exec(trackName);\r\n\t\r\n\t\tif ( ! matches ) {\r\n\t\t\tthrow new Error( \"cannot parse trackName at all: \" + trackName );\r\n\t\t}\r\n\t\r\n\t    if (matches.index === re.lastIndex) {\r\n\t        re.lastIndex++;\r\n\t    }\r\n\t\r\n\t\tvar results = {\r\n\t\t\tdirectoryName: matches[1],\r\n\t\t\tnodeName: matches[3], \t// allowed to be null, specified root node.\r\n\t\t\tobjectName: matches[5],\r\n\t\t\tobjectIndex: matches[7],\r\n\t\t\tpropertyName: matches[9],\r\n\t\t\tpropertyIndex: matches[11]\t// allowed to be null, specifies that the whole property is set.\r\n\t\t};\r\n\t\r\n\t\tif ( results.propertyName === null || results.propertyName.length === 0 ) {\r\n\t\t\tthrow new Error( \"can not parse propertyName from trackName: \" + trackName );\r\n\t\t}\r\n\t\r\n\t\treturn results;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.PropertyBinding.findNode = function( root, nodeName ) {\r\n\t\r\n\t\tfunction searchSkeleton( skeleton ) {\r\n\t\r\n\t\t\tfor ( var i = 0; i < skeleton.bones.length; i ++ ) {\r\n\t\r\n\t\t\t\tvar bone = skeleton.bones[i];\r\n\t\r\n\t\t\t\tif ( bone.name === nodeName ) {\r\n\t\r\n\t\t\t\t\treturn bone;\r\n\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\r\n\t\t\treturn null;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction searchNodeSubtree( children ) {\r\n\t\r\n\t\t\tfor ( var i = 0; i < children.length; i ++ ) {\r\n\t\r\n\t\t\t\tvar childNode = children[i];\r\n\t\r\n\t\t\t\tif ( childNode.name === nodeName || childNode.uuid === nodeName ) {\r\n\t\r\n\t\t\t\t\treturn childNode;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tvar result = searchNodeSubtree( childNode.children );\r\n\t\r\n\t\t\t\tif ( result ) return result;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn null;\r\n\t\r\n\t\t}\r\n\t\r\n\t\t//\r\n\t\r\n\t\tif ( ! nodeName || nodeName === \"\" || nodeName === \"root\" || nodeName === \".\" || nodeName === -1 || nodeName === root.name || nodeName === root.uuid ) {\r\n\t\r\n\t\t\treturn root;\r\n\t\r\n\t\t}\r\n\t\r\n\t\t// search into skeleton bones.\r\n\t\tif ( root.skeleton ) {\r\n\t\r\n\t\t\tvar bone = searchSkeleton( root.skeleton );\r\n\t\r\n\t\t\tif ( bone ) {\r\n\t\r\n\t\t\t\treturn bone;\r\n\t\r\n\t\t\t}\r\n\t\t}\r\n\t\r\n\t\t// search into node subtree.\r\n\t\tif ( root.children ) {\r\n\t\r\n\t\t\tvar subTreeNode = searchNodeSubtree( root.children );\r\n\t\r\n\t\t\tif ( subTreeNode ) {\r\n\t\r\n\t\t\t\treturn subTreeNode;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\treturn null;\r\n\t}\r\n\t\r\n\t// File:src/animation/tracks/VectorKeyframeTrack.js\r\n\t\r\n\t/**\r\n\t *\r\n\t * A Track that interpolates Vectors\r\n\t *\r\n\t * @author Ben Houston / http://clara.io/\r\n\t * @author David Sarno / http://lighthaus.us/\r\n\t */\r\n\t\r\n\tTHREE.VectorKeyframeTrack = function ( name, keys ) {\r\n\t\r\n\t\tTHREE.KeyframeTrack.call( this, name, keys );\r\n\t\r\n\t\t// local cache of value type to avoid allocations during runtime.\r\n\t\tthis.result = this.keys[0].value.clone();\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.VectorKeyframeTrack.prototype = Object.create( THREE.KeyframeTrack.prototype );\r\n\t\r\n\tTHREE.VectorKeyframeTrack.prototype.constructor = THREE.VectorKeyframeTrack;\r\n\t\r\n\tTHREE.VectorKeyframeTrack.prototype.setResult = function( value ) {\r\n\t\r\n\t\tthis.result.copy( value );\r\n\t\r\n\t};\r\n\t\r\n\t// memoization of the lerp function for speed.\r\n\t// NOTE: Do not optimize as a prototype initialization closure, as value0 will be different on a per class basis.\r\n\tTHREE.VectorKeyframeTrack.prototype.lerpValues = function( value0, value1, alpha ) {\r\n\t\r\n\t\treturn value0.lerp( value1, alpha );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.VectorKeyframeTrack.prototype.compareValues = function( value0, value1 ) {\r\n\t\r\n\t\treturn value0.equals( value1 );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.VectorKeyframeTrack.prototype.clone = function() {\r\n\t\r\n\t\tvar clonedKeys = [];\r\n\t\r\n\t\tfor ( var i = 0; i < this.keys.length; i ++ ) {\r\n\t\r\n\t\t\tvar key = this.keys[i];\r\n\t\t\tclonedKeys.push( {\r\n\t\t\t\ttime: key.time,\r\n\t\t\t\tvalue: key.value.clone()\r\n\t\t\t} );\r\n\t\t}\r\n\t\r\n\t\treturn new THREE.VectorKeyframeTrack( this.name, clonedKeys );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.VectorKeyframeTrack.parse = function( json ) {\r\n\t\r\n\t\tvar elementCount = json.keys[0].value.length;\r\n\t\tvar valueType = THREE[ 'Vector' + elementCount ];\r\n\t\r\n\t\tvar keys = [];\r\n\t\r\n\t\tfor ( var i = 0; i < json.keys.length; i ++ ) {\r\n\t\t\tvar jsonKey = json.keys[i];\r\n\t\t\tkeys.push( {\r\n\t\t\t\tvalue: new valueType().fromArray( jsonKey.value ),\r\n\t\t\t\ttime: jsonKey.time\r\n\t\t\t} );\r\n\t\t}\r\n\t\r\n\t\treturn new THREE.VectorKeyframeTrack( json.name, keys );\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/animation/tracks/QuaternionKeyframeTrack.js\r\n\t\r\n\t/**\r\n\t *\r\n\t * A Track that interpolates Quaternion\r\n\t *\r\n\t * @author Ben Houston / http://clara.io/\r\n\t * @author David Sarno / http://lighthaus.us/\r\n\t */\r\n\t\r\n\tTHREE.QuaternionKeyframeTrack = function ( name, keys ) {\r\n\t\r\n\t\tTHREE.KeyframeTrack.call( this, name, keys );\r\n\t\r\n\t\t// local cache of value type to avoid allocations during runtime.\r\n\t\tthis.result = this.keys[0].value.clone();\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.QuaternionKeyframeTrack.prototype = Object.create( THREE.KeyframeTrack.prototype );\r\n\t\r\n\tTHREE.QuaternionKeyframeTrack.prototype.constructor = THREE.QuaternionKeyframeTrack;\r\n\t\r\n\tTHREE.QuaternionKeyframeTrack.prototype.setResult = function( value ) {\r\n\t\r\n\t\tthis.result.copy( value );\r\n\t\r\n\t};\r\n\t\r\n\t// memoization of the lerp function for speed.\r\n\t// NOTE: Do not optimize as a prototype initialization closure, as value0 will be different on a per class basis.\r\n\tTHREE.QuaternionKeyframeTrack.prototype.lerpValues = function( value0, value1, alpha ) {\r\n\t\r\n\t\treturn value0.slerp( value1, alpha );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.QuaternionKeyframeTrack.prototype.compareValues = function( value0, value1 ) {\r\n\t\r\n\t\treturn value0.equals( value1 );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.QuaternionKeyframeTrack.prototype.multiply = function( quat ) {\r\n\t\r\n\t\tfor ( var i = 0; i < this.keys.length; i ++ ) {\r\n\t\r\n\t\t\tthis.keys[i].value.multiply( quat );\r\n\t\r\n\t\t}\r\n\t\r\n\t\treturn this;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.QuaternionKeyframeTrack.prototype.clone = function() {\r\n\t\r\n\t\tvar clonedKeys = [];\r\n\t\r\n\t\tfor ( var i = 0; i < this.keys.length; i ++ ) {\r\n\t\r\n\t\t\tvar key = this.keys[i];\r\n\t\t\tclonedKeys.push( {\r\n\t\t\t\ttime: key.time,\r\n\t\t\t\tvalue: key.value.clone()\r\n\t\t\t} );\r\n\t\t}\r\n\t\r\n\t\treturn new THREE.QuaternionKeyframeTrack( this.name, clonedKeys );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.QuaternionKeyframeTrack.parse = function( json ) {\r\n\t\r\n\t\tvar keys = [];\r\n\t\r\n\t\tfor ( var i = 0; i < json.keys.length; i ++ ) {\r\n\t\t\tvar jsonKey = json.keys[i];\r\n\t\t\tkeys.push( {\r\n\t\t\t\tvalue: new THREE.Quaternion().fromArray( jsonKey.value ),\r\n\t\t\t\ttime: jsonKey.time\r\n\t\t\t} );\r\n\t\t}\r\n\t\r\n\t\treturn new THREE.QuaternionKeyframeTrack( json.name, keys );\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/animation/tracks/StringKeyframeTrack.js\r\n\t\r\n\t/**\r\n\t *\r\n\t * A Track that interpolates Strings\r\n\t *\r\n\t * @author Ben Houston / http://clara.io/\r\n\t * @author David Sarno / http://lighthaus.us/\r\n\t */\r\n\t\r\n\tTHREE.StringKeyframeTrack = function ( name, keys ) {\r\n\t\r\n\t\tTHREE.KeyframeTrack.call( this, name, keys );\r\n\t\r\n\t\t// local cache of value type to avoid allocations during runtime.\r\n\t\tthis.result = this.keys[0].value;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.StringKeyframeTrack.prototype = Object.create( THREE.KeyframeTrack.prototype );\r\n\t\r\n\tTHREE.StringKeyframeTrack.prototype.constructor = THREE.StringKeyframeTrack;\r\n\t\r\n\tTHREE.StringKeyframeTrack.prototype.setResult = function( value ) {\r\n\t\r\n\t\tthis.result = value;\r\n\t\r\n\t};\r\n\t\r\n\t// memoization of the lerp function for speed.\r\n\t// NOTE: Do not optimize as a prototype initialization closure, as value0 will be different on a per class basis.\r\n\tTHREE.StringKeyframeTrack.prototype.lerpValues = function( value0, value1, alpha ) {\r\n\t\r\n\t\treturn ( alpha < 1.0 ) ? value0 : value1;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.StringKeyframeTrack.prototype.compareValues = function( value0, value1 ) {\r\n\t\r\n\t\treturn ( value0 === value1 );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.StringKeyframeTrack.prototype.clone = function() {\r\n\t\r\n\t\tvar clonedKeys = [];\r\n\t\r\n\t\tfor ( var i = 0; i < this.keys.length; i ++ ) {\r\n\t\r\n\t\t\tvar key = this.keys[i];\r\n\t\t\tclonedKeys.push( {\r\n\t\t\t\ttime: key.time,\r\n\t\t\t\tvalue: key.value\r\n\t\t\t} );\r\n\t\t}\r\n\t\r\n\t\treturn new THREE.StringKeyframeTrack( this.name, clonedKeys );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.StringKeyframeTrack.parse = function( json ) {\r\n\t\r\n\t\treturn new THREE.StringKeyframeTrack( json.name, json.keys );\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/animation/tracks/BooleanKeyframeTrack.js\r\n\t\r\n\t/**\r\n\t *\r\n\t * A Track that interpolates Boolean\r\n\t *\r\n\t * @author Ben Houston / http://clara.io/\r\n\t * @author David Sarno / http://lighthaus.us/\r\n\t */\r\n\t\r\n\tTHREE.BooleanKeyframeTrack = function ( name, keys ) {\r\n\t\r\n\t\tTHREE.KeyframeTrack.call( this, name, keys );\r\n\t\r\n\t\t// local cache of value type to avoid allocations during runtime.\r\n\t\tthis.result = this.keys[0].value;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.BooleanKeyframeTrack.prototype = Object.create( THREE.KeyframeTrack.prototype );\r\n\t\r\n\tTHREE.BooleanKeyframeTrack.prototype.constructor = THREE.BooleanKeyframeTrack;\r\n\t\r\n\tTHREE.BooleanKeyframeTrack.prototype.setResult = function( value ) {\r\n\t\r\n\t\tthis.result = value;\r\n\t\r\n\t};\r\n\t\r\n\t// memoization of the lerp function for speed.\r\n\t// NOTE: Do not optimize as a prototype initialization closure, as value0 will be different on a per class basis.\r\n\tTHREE.BooleanKeyframeTrack.prototype.lerpValues = function( value0, value1, alpha ) {\r\n\t\r\n\t\treturn ( alpha < 1.0 ) ? value0 : value1;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.BooleanKeyframeTrack.prototype.compareValues = function( value0, value1 ) {\r\n\t\r\n\t\treturn ( value0 === value1 );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.BooleanKeyframeTrack.prototype.clone = function() {\r\n\t\r\n\t\tvar clonedKeys = [];\r\n\t\r\n\t\tfor ( var i = 0; i < this.keys.length; i ++ ) {\r\n\t\r\n\t\t\tvar key = this.keys[i];\r\n\t\t\tclonedKeys.push( {\r\n\t\t\t\ttime: key.time,\r\n\t\t\t\tvalue: key.value\r\n\t\t\t} );\r\n\t\t}\r\n\t\r\n\t\treturn new THREE.BooleanKeyframeTrack( this.name, clonedKeys );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.BooleanKeyframeTrack.parse = function( json ) {\r\n\t\r\n\t\treturn new THREE.BooleanKeyframeTrack( json.name, json.keys );\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/animation/tracks/NumberKeyframeTrack.js\r\n\t\r\n\t/**\r\n\t *\r\n\t * A Track that interpolates Numbers\r\n\t *\r\n\t * @author Ben Houston / http://clara.io/\r\n\t * @author David Sarno / http://lighthaus.us/\r\n\t */\r\n\t\r\n\tTHREE.NumberKeyframeTrack = function ( name, keys ) {\r\n\t\r\n\t\tTHREE.KeyframeTrack.call( this, name, keys );\r\n\t\r\n\t\t// local cache of value type to avoid allocations during runtime.\r\n\t\tthis.result = this.keys[0].value;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.NumberKeyframeTrack.prototype = Object.create( THREE.KeyframeTrack.prototype );\r\n\t\r\n\tTHREE.NumberKeyframeTrack.prototype.constructor = THREE.NumberKeyframeTrack;\r\n\t\r\n\tTHREE.NumberKeyframeTrack.prototype.setResult = function( value ) {\r\n\t\r\n\t\tthis.result = value;\r\n\t\r\n\t};\r\n\t\r\n\t// memoization of the lerp function for speed.\r\n\t// NOTE: Do not optimize as a prototype initialization closure, as value0 will be different on a per class basis.\r\n\tTHREE.NumberKeyframeTrack.prototype.lerpValues = function( value0, value1, alpha ) {\r\n\t\r\n\t\treturn value0 * ( 1 - alpha ) + value1 * alpha;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.NumberKeyframeTrack.prototype.compareValues = function( value0, value1 ) {\r\n\t\r\n\t\treturn ( value0 === value1 );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.NumberKeyframeTrack.prototype.clone = function() {\r\n\t\r\n\t\tvar clonedKeys = [];\r\n\t\r\n\t\tfor ( var i = 0; i < this.keys.length; i ++ ) {\r\n\t\r\n\t\t\tvar key = this.keys[i];\r\n\t\t\tclonedKeys.push( {\r\n\t\t\t\ttime: key.time,\r\n\t\t\t\tvalue: key.value\r\n\t\t\t} );\r\n\t\t}\r\n\t\r\n\t\treturn new THREE.NumberKeyframeTrack( this.name, clonedKeys );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.NumberKeyframeTrack.parse = function( json ) {\r\n\t\r\n\t\treturn new THREE.NumberKeyframeTrack( json.name, json.keys );\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/cameras/Camera.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t*/\r\n\t\r\n\tTHREE.Camera = function () {\r\n\t\r\n\t\tTHREE.Object3D.call( this );\r\n\t\r\n\t\tthis.type = 'Camera';\r\n\t\r\n\t\tthis.matrixWorldInverse = new THREE.Matrix4();\r\n\t\tthis.projectionMatrix = new THREE.Matrix4();\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Camera.prototype = Object.create( THREE.Object3D.prototype );\r\n\tTHREE.Camera.prototype.constructor = THREE.Camera;\r\n\t\r\n\tTHREE.Camera.prototype.getWorldDirection = function () {\r\n\t\r\n\t\tvar quaternion = new THREE.Quaternion();\r\n\t\r\n\t\treturn function ( optionalTarget ) {\r\n\t\r\n\t\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\r\n\t\t\tthis.getWorldQuaternion( quaternion );\r\n\t\r\n\t\t\treturn result.set( 0, 0, - 1 ).applyQuaternion( quaternion );\r\n\t\r\n\t\t};\r\n\t\r\n\t}();\r\n\t\r\n\tTHREE.Camera.prototype.lookAt = function () {\r\n\t\r\n\t\t// This routine does not support cameras with rotated and/or translated parent(s)\r\n\t\r\n\t\tvar m1 = new THREE.Matrix4();\r\n\t\r\n\t\treturn function ( vector ) {\r\n\t\r\n\t\t\tm1.lookAt( this.position, vector, this.up );\r\n\t\r\n\t\t\tthis.quaternion.setFromRotationMatrix( m1 );\r\n\t\r\n\t\t};\r\n\t\r\n\t}();\r\n\t\r\n\tTHREE.Camera.prototype.clone = function () {\r\n\t\r\n\t\treturn new this.constructor().copy( this );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Camera.prototype.copy = function ( source ) {\r\n\t\r\n\t\tTHREE.Object3D.prototype.copy.call( this, source );\r\n\t\r\n\t\tthis.matrixWorldInverse.copy( source.matrixWorldInverse );\r\n\t\tthis.projectionMatrix.copy( source.projectionMatrix );\r\n\t\r\n\t\treturn this;\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/cameras/CubeCamera.js\r\n\t\r\n\t/**\r\n\t * Camera for rendering cube maps\r\n\t *\t- renders scene into axis-aligned cube\r\n\t *\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\t\r\n\tTHREE.CubeCamera = function ( near, far, cubeResolution ) {\r\n\t\r\n\t\tTHREE.Object3D.call( this );\r\n\t\r\n\t\tthis.type = 'CubeCamera';\r\n\t\r\n\t\tvar fov = 90, aspect = 1;\r\n\t\r\n\t\tvar cameraPX = new THREE.PerspectiveCamera( fov, aspect, near, far );\r\n\t\tcameraPX.up.set( 0, - 1, 0 );\r\n\t\tcameraPX.lookAt( new THREE.Vector3( 1, 0, 0 ) );\r\n\t\tthis.add( cameraPX );\r\n\t\r\n\t\tvar cameraNX = new THREE.PerspectiveCamera( fov, aspect, near, far );\r\n\t\tcameraNX.up.set( 0, - 1, 0 );\r\n\t\tcameraNX.lookAt( new THREE.Vector3( - 1, 0, 0 ) );\r\n\t\tthis.add( cameraNX );\r\n\t\r\n\t\tvar cameraPY = new THREE.PerspectiveCamera( fov, aspect, near, far );\r\n\t\tcameraPY.up.set( 0, 0, 1 );\r\n\t\tcameraPY.lookAt( new THREE.Vector3( 0, 1, 0 ) );\r\n\t\tthis.add( cameraPY );\r\n\t\r\n\t\tvar cameraNY = new THREE.PerspectiveCamera( fov, aspect, near, far );\r\n\t\tcameraNY.up.set( 0, 0, - 1 );\r\n\t\tcameraNY.lookAt( new THREE.Vector3( 0, - 1, 0 ) );\r\n\t\tthis.add( cameraNY );\r\n\t\r\n\t\tvar cameraPZ = new THREE.PerspectiveCamera( fov, aspect, near, far );\r\n\t\tcameraPZ.up.set( 0, - 1, 0 );\r\n\t\tcameraPZ.lookAt( new THREE.Vector3( 0, 0, 1 ) );\r\n\t\tthis.add( cameraPZ );\r\n\t\r\n\t\tvar cameraNZ = new THREE.PerspectiveCamera( fov, aspect, near, far );\r\n\t\tcameraNZ.up.set( 0, - 1, 0 );\r\n\t\tcameraNZ.lookAt( new THREE.Vector3( 0, 0, - 1 ) );\r\n\t\tthis.add( cameraNZ );\r\n\t\r\n\t\tthis.renderTarget = new THREE.WebGLRenderTargetCube( cubeResolution, cubeResolution, { format: THREE.RGBFormat, magFilter: THREE.LinearFilter, minFilter: THREE.LinearFilter } );\r\n\t\r\n\t\tthis.updateCubeMap = function ( renderer, scene ) {\r\n\t\r\n\t\t\tif ( this.parent === null ) this.updateMatrixWorld();\r\n\t\r\n\t\t\tvar renderTarget = this.renderTarget;\r\n\t\t\tvar generateMipmaps = renderTarget.texture.generateMipmaps;\r\n\t\r\n\t\t\trenderTarget.texture.generateMipmaps = false;\r\n\t\r\n\t\t\trenderTarget.activeCubeFace = 0;\r\n\t\t\trenderer.render( scene, cameraPX, renderTarget );\r\n\t\r\n\t\t\trenderTarget.activeCubeFace = 1;\r\n\t\t\trenderer.render( scene, cameraNX, renderTarget );\r\n\t\r\n\t\t\trenderTarget.activeCubeFace = 2;\r\n\t\t\trenderer.render( scene, cameraPY, renderTarget );\r\n\t\r\n\t\t\trenderTarget.activeCubeFace = 3;\r\n\t\t\trenderer.render( scene, cameraNY, renderTarget );\r\n\t\r\n\t\t\trenderTarget.activeCubeFace = 4;\r\n\t\t\trenderer.render( scene, cameraPZ, renderTarget );\r\n\t\r\n\t\t\trenderTarget.texture.generateMipmaps = generateMipmaps;\r\n\t\r\n\t\t\trenderTarget.activeCubeFace = 5;\r\n\t\t\trenderer.render( scene, cameraNZ, renderTarget );\r\n\t\r\n\t\t\trenderer.setRenderTarget( null );\r\n\t\r\n\t\t};\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.CubeCamera.prototype = Object.create( THREE.Object3D.prototype );\r\n\tTHREE.CubeCamera.prototype.constructor = THREE.CubeCamera;\r\n\t\r\n\t// File:src/cameras/OrthographicCamera.js\r\n\t\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\t\r\n\tTHREE.OrthographicCamera = function ( left, right, top, bottom, near, far ) {\r\n\t\r\n\t\tTHREE.Camera.call( this );\r\n\t\r\n\t\tthis.type = 'OrthographicCamera';\r\n\t\r\n\t\tthis.zoom = 1;\r\n\t\r\n\t\tthis.left = left;\r\n\t\tthis.right = right;\r\n\t\tthis.top = top;\r\n\t\tthis.bottom = bottom;\r\n\t\r\n\t\tthis.near = ( near !== undefined ) ? near : 0.1;\r\n\t\tthis.far = ( far !== undefined ) ? far : 2000;\r\n\t\r\n\t\tthis.updateProjectionMatrix();\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.OrthographicCamera.prototype = Object.create( THREE.Camera.prototype );\r\n\tTHREE.OrthographicCamera.prototype.constructor = THREE.OrthographicCamera;\r\n\t\r\n\tTHREE.OrthographicCamera.prototype.updateProjectionMatrix = function () {\r\n\t\r\n\t\tvar dx = ( this.right - this.left ) / ( 2 * this.zoom );\r\n\t\tvar dy = ( this.top - this.bottom ) / ( 2 * this.zoom );\r\n\t\tvar cx = ( this.right + this.left ) / 2;\r\n\t\tvar cy = ( this.top + this.bottom ) / 2;\r\n\t\r\n\t\tthis.projectionMatrix.makeOrthographic( cx - dx, cx + dx, cy + dy, cy - dy, this.near, this.far );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.OrthographicCamera.prototype.copy = function ( source ) {\r\n\t\t\r\n\t\tTHREE.Camera.prototype.copy.call( this, source );\r\n\t\t\r\n\t\tthis.left = source.left;\r\n\t\tthis.right = source.right;\r\n\t\tthis.top = source.top;\r\n\t\tthis.bottom = source.bottom;\r\n\t\tthis.near = source.near;\r\n\t\tthis.far = source.far;\r\n\t\t\r\n\t\tthis.zoom = source.zoom;\r\n\t\t\r\n\t\treturn this;\r\n\t\t\t\r\n\t};\r\n\t\r\n\tTHREE.OrthographicCamera.prototype.toJSON = function ( meta ) {\r\n\t\r\n\t\tvar data = THREE.Object3D.prototype.toJSON.call( this, meta );\r\n\t\r\n\t\tdata.object.zoom = this.zoom;\r\n\t\tdata.object.left = this.left;\r\n\t\tdata.object.right = this.right;\r\n\t\tdata.object.top = this.top;\r\n\t\tdata.object.bottom = this.bottom;\r\n\t\tdata.object.near = this.near;\r\n\t\tdata.object.far = this.far;\r\n\t\r\n\t\treturn data;\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/cameras/PerspectiveCamera.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author greggman / http://games.greggman.com/\r\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\r\n\t */\r\n\t\r\n\tTHREE.PerspectiveCamera = function ( fov, aspect, near, far ) {\r\n\t\r\n\t\tTHREE.Camera.call( this );\r\n\t\r\n\t\tthis.type = 'PerspectiveCamera';\r\n\t\r\n\t\tthis.zoom = 1;\r\n\t\r\n\t\tthis.fov = fov !== undefined ? fov : 50;\r\n\t\tthis.aspect = aspect !== undefined ? aspect : 1;\r\n\t\tthis.near = near !== undefined ? near : 0.1;\r\n\t\tthis.far = far !== undefined ? far : 2000;\r\n\t\r\n\t\tthis.updateProjectionMatrix();\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.PerspectiveCamera.prototype = Object.create( THREE.Camera.prototype );\r\n\tTHREE.PerspectiveCamera.prototype.constructor = THREE.PerspectiveCamera;\r\n\t\r\n\t\r\n\t/**\r\n\t * Uses Focal Length (in mm) to estimate and set FOV\r\n\t * 35mm (full-frame) camera is used if frame size is not specified;\r\n\t * Formula based on http://www.bobatkins.com/photography/technical/field_of_view.html\r\n\t */\r\n\t\r\n\tTHREE.PerspectiveCamera.prototype.setLens = function ( focalLength, frameHeight ) {\r\n\t\r\n\t\tif ( frameHeight === undefined ) frameHeight = 24;\r\n\t\r\n\t\tthis.fov = 2 * THREE.Math.radToDeg( Math.atan( frameHeight / ( focalLength * 2 ) ) );\r\n\t\tthis.updateProjectionMatrix();\r\n\t\r\n\t};\r\n\t\r\n\t\r\n\t/**\r\n\t * Sets an offset in a larger frustum. This is useful for multi-window or\r\n\t * multi-monitor/multi-machine setups.\r\n\t *\r\n\t * For example, if you have 3x2 monitors and each monitor is 1920x1080 and\r\n\t * the monitors are in grid like this\r\n\t *\r\n\t *   +---+---+---+\r\n\t *   | A | B | C |\r\n\t *   +---+---+---+\r\n\t *   | D | E | F |\r\n\t *   +---+---+---+\r\n\t *\r\n\t * then for each monitor you would call it like this\r\n\t *\r\n\t *   var w = 1920;\r\n\t *   var h = 1080;\r\n\t *   var fullWidth = w * 3;\r\n\t *   var fullHeight = h * 2;\r\n\t *\r\n\t *   --A--\r\n\t *   camera.setOffset( fullWidth, fullHeight, w * 0, h * 0, w, h );\r\n\t *   --B--\r\n\t *   camera.setOffset( fullWidth, fullHeight, w * 1, h * 0, w, h );\r\n\t *   --C--\r\n\t *   camera.setOffset( fullWidth, fullHeight, w * 2, h * 0, w, h );\r\n\t *   --D--\r\n\t *   camera.setOffset( fullWidth, fullHeight, w * 0, h * 1, w, h );\r\n\t *   --E--\r\n\t *   camera.setOffset( fullWidth, fullHeight, w * 1, h * 1, w, h );\r\n\t *   --F--\r\n\t *   camera.setOffset( fullWidth, fullHeight, w * 2, h * 1, w, h );\r\n\t *\r\n\t *   Note there is no reason monitors have to be the same size or in a grid.\r\n\t */\r\n\t\r\n\tTHREE.PerspectiveCamera.prototype.setViewOffset = function ( fullWidth, fullHeight, x, y, width, height ) {\r\n\t\r\n\t\tthis.fullWidth = fullWidth;\r\n\t\tthis.fullHeight = fullHeight;\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t\tthis.width = width;\r\n\t\tthis.height = height;\r\n\t\r\n\t\tthis.updateProjectionMatrix();\r\n\t\r\n\t};\r\n\t\r\n\t\r\n\tTHREE.PerspectiveCamera.prototype.updateProjectionMatrix = function () {\r\n\t\r\n\t\tvar fov = THREE.Math.radToDeg( 2 * Math.atan( Math.tan( THREE.Math.degToRad( this.fov ) * 0.5 ) / this.zoom ) );\r\n\t\r\n\t\tif ( this.fullWidth ) {\r\n\t\r\n\t\t\tvar aspect = this.fullWidth / this.fullHeight;\r\n\t\t\tvar top = Math.tan( THREE.Math.degToRad( fov * 0.5 ) ) * this.near;\r\n\t\t\tvar bottom = - top;\r\n\t\t\tvar left = aspect * bottom;\r\n\t\t\tvar right = aspect * top;\r\n\t\t\tvar width = Math.abs( right - left );\r\n\t\t\tvar height = Math.abs( top - bottom );\r\n\t\r\n\t\t\tthis.projectionMatrix.makeFrustum(\r\n\t\t\t\tleft + this.x * width / this.fullWidth,\r\n\t\t\t\tleft + ( this.x + this.width ) * width / this.fullWidth,\r\n\t\t\t\ttop - ( this.y + this.height ) * height / this.fullHeight,\r\n\t\t\t\ttop - this.y * height / this.fullHeight,\r\n\t\t\t\tthis.near,\r\n\t\t\t\tthis.far\r\n\t\t\t);\r\n\t\r\n\t\t} else {\r\n\t\r\n\t\t\tthis.projectionMatrix.makePerspective( fov, this.aspect, this.near, this.far );\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.PerspectiveCamera.prototype.copy = function ( source ) {\r\n\t\t\r\n\t\tTHREE.Camera.prototype.copy.call( this, source );\r\n\t\t\r\n\t\tthis.fov = source.fov;\r\n\t\tthis.aspect = source.aspect;\r\n\t\tthis.near = source.near;\r\n\t\tthis.far = source.far;\r\n\t\t\r\n\t\tthis.zoom = source.zoom;\r\n\t\t\r\n\t\treturn this;\r\n\t\t\t\r\n\t};\r\n\t\r\n\tTHREE.PerspectiveCamera.prototype.toJSON = function ( meta ) {\r\n\t\r\n\t\tvar data = THREE.Object3D.prototype.toJSON.call( this, meta );\r\n\t\r\n\t\tdata.object.zoom = this.zoom;\r\n\t\tdata.object.fov = this.fov;\r\n\t\tdata.object.aspect = this.aspect;\r\n\t\tdata.object.near = this.near;\r\n\t\tdata.object.far = this.far;\r\n\t\r\n\t\treturn data;\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/lights/Light.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\t\r\n\tTHREE.Light = function ( color ) {\r\n\t\r\n\t\tTHREE.Object3D.call( this );\r\n\t\r\n\t\tthis.type = 'Light';\r\n\t\r\n\t\tthis.color = new THREE.Color( color );\r\n\t\r\n\t\tthis.receiveShadow = undefined;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Light.prototype = Object.create( THREE.Object3D.prototype );\r\n\tTHREE.Light.prototype.constructor = THREE.Light;\r\n\t\r\n\tObject.defineProperties( THREE.Light.prototype, {\r\n\t\tonlyShadow: {\r\n\t\t\tset: function ( value ) {\r\n\t\t\t\tconsole.warn( 'THREE.Light: .onlyShadow has been removed.' );\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowCameraFov: {\r\n\t\t\tset: function ( value ) {\r\n\t\t\t\tthis.shadow.camera.fov = value;\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowCameraLeft: {\r\n\t\t\tset: function ( value ) {\r\n\t\t\t\tthis.shadow.camera.left = value;\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowCameraRight: {\r\n\t\t\tset: function ( value ) {\r\n\t\t\t\tthis.shadow.camera.right = value;\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowCameraTop: {\r\n\t\t\tset: function ( value ) {\r\n\t\t\t\tthis.shadow.camera.top = value;\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowCameraBottom: {\r\n\t\t\tset: function ( value ) {\r\n\t\t\t\tthis.shadow.camera.bottom = value;\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowCameraNear: {\r\n\t\t\tset: function ( value ) {\r\n\t\t\t\tthis.shadow.camera.near = value;\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowCameraFar: {\r\n\t\t\tset: function ( value ) {\r\n\t\t\t\tthis.shadow.camera.far = value;\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowCameraVisible: {\r\n\t\t\tset: function ( value ) {\r\n\t\t\t\tconsole.warn( 'THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow ) instead.' );\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowBias: {\r\n\t\t\tset: function ( value ) {\r\n\t\t\t\tthis.shadow.bias = value;\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowDarkness: {\r\n\t\t\tset: function ( value ) {\r\n\t\t\t\tthis.shadow.darkness = value;\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowMapWidth: {\r\n\t\t\tset: function ( value ) {\r\n\t\t\t\tthis.shadow.mapSize.width = value;\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowMapHeight: {\r\n\t\t\tset: function ( value ) {\r\n\t\t\t\tthis.shadow.mapSize.height = value;\r\n\t\t\t}\r\n\t\t}\r\n\t} );\r\n\t\r\n\tTHREE.Light.prototype.copy = function ( source ) {\r\n\t\r\n\t\tTHREE.Object3D.prototype.copy.call( this, source );\r\n\t\r\n\t\tthis.color.copy( source.color );\r\n\t\r\n\t\treturn this;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Light.prototype.toJSON = function ( meta ) {\r\n\t\r\n\t\tvar data = THREE.Object3D.prototype.toJSON.call( this, meta );\r\n\t\r\n\t\tdata.object.color = this.color.getHex();\r\n\t\tif ( this.groundColor !== undefined ) data.object.groundColor = this.groundColor.getHex();\r\n\t\r\n\t\tif ( this.intensity !== undefined ) data.object.intensity = this.intensity;\r\n\t\tif ( this.distance !== undefined ) data.object.distance = this.distance;\r\n\t\tif ( this.angle !== undefined ) data.object.angle = this.angle;\r\n\t\tif ( this.decay !== undefined ) data.object.decay = this.decay;\r\n\t\tif ( this.exponent !== undefined ) data.object.exponent = this.exponent;\r\n\t\r\n\t\treturn data;\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/lights/LightShadow.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.LightShadow = function ( camera ) {\r\n\t\r\n\t\tthis.camera = camera;\r\n\t\r\n\t\tthis.bias = 0;\r\n\t\tthis.darkness = 1;\r\n\t\r\n\t\tthis.mapSize = new THREE.Vector2( 512, 512 );\r\n\t\r\n\t\tthis.map = null;\r\n\t\tthis.matrix = null;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.LightShadow.prototype = {\r\n\t\r\n\t\tconstructor: THREE.LightShadow,\r\n\t\r\n\t\tcopy: function ( source ) {\r\n\t\r\n\t\t\tthis.camera = source.camera.clone();\r\n\t\r\n\t\t\tthis.bias = source.bias;\r\n\t\t\tthis.darkness = source.darkness;\r\n\t\r\n\t\t\tthis.mapSize.copy( source.mapSize );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tclone: function () {\r\n\t\r\n\t\t\treturn new this.constructor().copy( this );\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/lights/AmbientLight.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.AmbientLight = function ( color ) {\r\n\t\r\n\t\tTHREE.Light.call( this, color );\r\n\t\r\n\t\tthis.type = 'AmbientLight';\r\n\t\r\n\t\tthis.castShadow = undefined;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.AmbientLight.prototype = Object.create( THREE.Light.prototype );\r\n\tTHREE.AmbientLight.prototype.constructor = THREE.AmbientLight;\r\n\t\r\n\t// File:src/lights/DirectionalLight.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\t\r\n\tTHREE.DirectionalLight = function ( color, intensity ) {\r\n\t\r\n\t\tTHREE.Light.call( this, color );\r\n\t\r\n\t\tthis.type = 'DirectionalLight';\r\n\t\r\n\t\tthis.position.set( 0, 1, 0 );\r\n\t\tthis.updateMatrix();\r\n\t\r\n\t\tthis.target = new THREE.Object3D();\r\n\t\r\n\t\tthis.intensity = ( intensity !== undefined ) ? intensity : 1;\r\n\t\r\n\t\tthis.shadow = new THREE.LightShadow( new THREE.OrthographicCamera( - 500, 500, 500, - 500, 50, 5000 ) );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.DirectionalLight.prototype = Object.create( THREE.Light.prototype );\r\n\tTHREE.DirectionalLight.prototype.constructor = THREE.DirectionalLight;\r\n\t\r\n\tTHREE.DirectionalLight.prototype.copy = function ( source ) {\r\n\t\r\n\t\tTHREE.Light.prototype.copy.call( this, source );\r\n\t\r\n\t\tthis.intensity = source.intensity;\r\n\t\tthis.target = source.target.clone();\r\n\t\r\n\t\tthis.shadow = source.shadow.clone();\r\n\t\r\n\t\treturn this;\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/lights/HemisphereLight.js\r\n\t\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\t\r\n\tTHREE.HemisphereLight = function ( skyColor, groundColor, intensity ) {\r\n\t\r\n\t\tTHREE.Light.call( this, skyColor );\r\n\t\r\n\t\tthis.type = 'HemisphereLight';\r\n\t\r\n\t\tthis.castShadow = undefined;\r\n\t\r\n\t\tthis.position.set( 0, 1, 0 );\r\n\t\tthis.updateMatrix();\r\n\t\r\n\t\tthis.groundColor = new THREE.Color( groundColor );\r\n\t\tthis.intensity = ( intensity !== undefined ) ? intensity : 1;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.HemisphereLight.prototype = Object.create( THREE.Light.prototype );\r\n\tTHREE.HemisphereLight.prototype.constructor = THREE.HemisphereLight;\r\n\t\r\n\tTHREE.HemisphereLight.prototype.copy = function ( source ) {\r\n\t\r\n\t\tTHREE.Light.prototype.copy.call( this, source );\r\n\t\r\n\t\tthis.groundColor.copy( source.groundColor );\r\n\t\tthis.intensity = source.intensity;\r\n\t\r\n\t\treturn this;\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/lights/PointLight.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\t\r\n\tTHREE.PointLight = function ( color, intensity, distance, decay ) {\r\n\t\r\n\t\tTHREE.Light.call( this, color );\r\n\t\r\n\t\tthis.type = 'PointLight';\r\n\t\r\n\t\tthis.intensity = ( intensity !== undefined ) ? intensity : 1;\r\n\t\tthis.distance = ( distance !== undefined ) ? distance : 0;\r\n\t\tthis.decay = ( decay !== undefined ) ? decay : 1;\t// for physically correct lights, should be 2.\r\n\t\r\n\t\tthis.shadow = new THREE.LightShadow( new THREE.PerspectiveCamera( 90, 1, 1, 500 ) );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.PointLight.prototype = Object.create( THREE.Light.prototype );\r\n\tTHREE.PointLight.prototype.constructor = THREE.PointLight;\r\n\t\r\n\tTHREE.PointLight.prototype.copy = function ( source ) {\r\n\t\r\n\t\tTHREE.Light.prototype.copy.call( this, source );\r\n\t\r\n\t\tthis.intensity = source.intensity;\r\n\t\tthis.distance = source.distance;\r\n\t\tthis.decay = source.decay;\r\n\t\r\n\t\tthis.shadow = source.shadow.clone();\r\n\t\r\n\t\treturn this;\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/lights/SpotLight.js\r\n\t\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\t\r\n\tTHREE.SpotLight = function ( color, intensity, distance, angle, exponent, decay ) {\r\n\t\r\n\t\tTHREE.Light.call( this, color );\r\n\t\r\n\t\tthis.type = 'SpotLight';\r\n\t\r\n\t\tthis.position.set( 0, 1, 0 );\r\n\t\tthis.updateMatrix();\r\n\t\r\n\t\tthis.target = new THREE.Object3D();\r\n\t\r\n\t\tthis.intensity = ( intensity !== undefined ) ? intensity : 1;\r\n\t\tthis.distance = ( distance !== undefined ) ? distance : 0;\r\n\t\tthis.angle = ( angle !== undefined ) ? angle : Math.PI / 3;\r\n\t\tthis.exponent = ( exponent !== undefined ) ? exponent : 10;\r\n\t\tthis.decay = ( decay !== undefined ) ? decay : 1;\t// for physically correct lights, should be 2.\r\n\t\r\n\t\tthis.shadow = new THREE.LightShadow( new THREE.PerspectiveCamera( 50, 1, 50, 5000 ) );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.SpotLight.prototype = Object.create( THREE.Light.prototype );\r\n\tTHREE.SpotLight.prototype.constructor = THREE.SpotLight;\r\n\t\r\n\tTHREE.SpotLight.prototype.copy = function ( source ) {\r\n\t\r\n\t\tTHREE.Light.prototype.copy.call( this, source );\r\n\t\r\n\t\tthis.intensity = source.intensity;\r\n\t\tthis.distance = source.distance;\r\n\t\tthis.angle = source.angle;\r\n\t\tthis.exponent = source.exponent;\r\n\t\tthis.decay = source.decay;\r\n\t\r\n\t\tthis.target = source.target.clone();\r\n\t\r\n\t\tthis.shadow = source.shadow.clone();\r\n\t\r\n\t\treturn this;\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/loaders/Cache.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.Cache = {\r\n\t\r\n\t\tenabled: false,\r\n\t\r\n\t\tfiles: {},\r\n\t\r\n\t\tadd: function ( key, file ) {\r\n\t\r\n\t\t\tif ( this.enabled === false ) return;\r\n\t\r\n\t\t\t// console.log( 'THREE.Cache', 'Adding key:', key );\r\n\t\r\n\t\t\tthis.files[ key ] = file;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tget: function ( key ) {\r\n\t\r\n\t\t\tif ( this.enabled === false ) return;\r\n\t\r\n\t\t\t// console.log( 'THREE.Cache', 'Checking key:', key );\r\n\t\r\n\t\t\treturn this.files[ key ];\r\n\t\r\n\t\t},\r\n\t\r\n\t\tremove: function ( key ) {\r\n\t\r\n\t\t\tdelete this.files[ key ];\r\n\t\r\n\t\t},\r\n\t\r\n\t\tclear: function () {\r\n\t\r\n\t\t\tthis.files = {};\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/loaders/Loader.js\r\n\t\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\t\r\n\tTHREE.Loader = function () {\r\n\t\r\n\t\tthis.onLoadStart = function () {};\r\n\t\tthis.onLoadProgress = function () {};\r\n\t\tthis.onLoadComplete = function () {};\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Loader.prototype = {\r\n\t\r\n\t\tconstructor: THREE.Loader,\r\n\t\r\n\t\tcrossOrigin: undefined,\r\n\t\r\n\t\textractUrlBase: function ( url ) {\r\n\t\r\n\t\t\tvar parts = url.split( '/' );\r\n\t\r\n\t\t\tif ( parts.length === 1 ) return './';\r\n\t\r\n\t\t\tparts.pop();\r\n\t\r\n\t\t\treturn parts.join( '/' ) + '/';\r\n\t\r\n\t\t},\r\n\t\r\n\t\tinitMaterials: function ( materials, texturePath, crossOrigin ) {\r\n\t\r\n\t\t\tvar array = [];\r\n\t\r\n\t\t\tfor ( var i = 0; i < materials.length; ++ i ) {\r\n\t\r\n\t\t\t\tarray[ i ] = this.createMaterial( materials[ i ], texturePath, crossOrigin );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn array;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcreateMaterial: ( function () {\r\n\t\r\n\t\t\tvar color, textureLoader, materialLoader;\r\n\t\r\n\t\t\treturn function ( m, texturePath, crossOrigin ) {\r\n\t\r\n\t\t\t\tif ( color === undefined ) color = new THREE.Color();\r\n\t\t\t\tif ( textureLoader === undefined ) textureLoader = new THREE.TextureLoader();\r\n\t\t\t\tif ( materialLoader === undefined ) materialLoader = new THREE.MaterialLoader();\r\n\t\r\n\t\t\t\t// convert from old material format\r\n\t\r\n\t\t\t\tvar textures = {};\r\n\t\r\n\t\t\t\tfunction loadTexture( path, repeat, offset, wrap, anisotropy ) {\r\n\t\r\n\t\t\t\t\tvar fullPath = texturePath + path;\r\n\t\t\t\t\tvar loader = THREE.Loader.Handlers.get( fullPath );\r\n\t\r\n\t\t\t\t\tvar texture;\r\n\t\r\n\t\t\t\t\tif ( loader !== null ) {\r\n\t\r\n\t\t\t\t\t\ttexture = loader.load( fullPath );\r\n\t\r\n\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\ttextureLoader.setCrossOrigin( crossOrigin );\r\n\t\t\t\t\t\ttexture = textureLoader.load( fullPath );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tif ( repeat !== undefined ) {\r\n\t\r\n\t\t\t\t\t\ttexture.repeat.fromArray( repeat );\r\n\t\r\n\t\t\t\t\t\tif ( repeat[ 0 ] !== 1 ) texture.wrapS = THREE.RepeatWrapping;\r\n\t\t\t\t\t\tif ( repeat[ 1 ] !== 1 ) texture.wrapT = THREE.RepeatWrapping;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tif ( offset !== undefined ) {\r\n\t\r\n\t\t\t\t\t\ttexture.offset.fromArray( offset );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tif ( wrap !== undefined ) {\r\n\t\r\n\t\t\t\t\t\tif ( wrap[ 0 ] === 'repeat' ) texture.wrapS = THREE.RepeatWrapping;\r\n\t\t\t\t\t\tif ( wrap[ 0 ] === 'mirror' ) texture.wrapS = THREE.MirroredRepeatWrapping;\r\n\t\r\n\t\t\t\t\t\tif ( wrap[ 1 ] === 'repeat' ) texture.wrapT = THREE.RepeatWrapping;\r\n\t\t\t\t\t\tif ( wrap[ 1 ] === 'mirror' ) texture.wrapT = THREE.MirroredRepeatWrapping;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tif ( anisotropy !== undefined ) {\r\n\t\r\n\t\t\t\t\t\ttexture.anisotropy = anisotropy;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tvar uuid = THREE.Math.generateUUID();\r\n\t\r\n\t\t\t\t\ttextures[ uuid ] = texture;\r\n\t\r\n\t\t\t\t\treturn uuid;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\t//\r\n\t\r\n\t\t\t\tvar json = {\r\n\t\t\t\t\tuuid: THREE.Math.generateUUID(),\r\n\t\t\t\t\ttype: 'MeshLambertMaterial'\r\n\t\t\t\t};\r\n\t\r\n\t\t\t\tfor ( var name in m ) {\r\n\t\r\n\t\t\t\t\tvar value = m[ name ];\r\n\t\r\n\t\t\t\t\tswitch ( name ) {\r\n\t\t\t\t\t\tcase 'DbgColor':\r\n\t\t\t\t\t\t\tjson.color = value;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'DbgIndex':\r\n\t\t\t\t\t\tcase 'opticalDensity':\r\n\t\t\t\t\t\tcase 'illumination':\r\n\t\t\t\t\t\t\t// These were never supported\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'DbgName':\r\n\t\t\t\t\t\t\tjson.name = value;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'blending':\r\n\t\t\t\t\t\t\tjson.blending = THREE[ value ];\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'colorDiffuse':\r\n\t\t\t\t\t\t\tjson.color = color.fromArray( value ).getHex();\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'colorSpecular':\r\n\t\t\t\t\t\t\tjson.specular = color.fromArray( value ).getHex();\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'colorEmissive':\r\n\t\t\t\t\t\t\tjson.emissive = color.fromArray( value ).getHex();\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'specularCoef':\r\n\t\t\t\t\t\t\tjson.shininess = value;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'shading':\r\n\t\t\t\t\t\t\tif ( value.toLowerCase() === 'basic' ) json.type = 'MeshBasicMaterial';\r\n\t\t\t\t\t\t\tif ( value.toLowerCase() === 'phong' ) json.type = 'MeshPhongMaterial';\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'mapDiffuse':\r\n\t\t\t\t\t\t\tjson.map = loadTexture( value, m.mapDiffuseRepeat, m.mapDiffuseOffset, m.mapDiffuseWrap, m.mapDiffuseAnisotropy );\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'mapDiffuseRepeat':\r\n\t\t\t\t\t\tcase 'mapDiffuseOffset':\r\n\t\t\t\t\t\tcase 'mapDiffuseWrap':\r\n\t\t\t\t\t\tcase 'mapDiffuseAnisotropy':\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'mapLight':\r\n\t\t\t\t\t\t\tjson.lightMap = loadTexture( value, m.mapLightRepeat, m.mapLightOffset, m.mapLightWrap, m.mapLightAnisotropy );\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'mapLightRepeat':\r\n\t\t\t\t\t\tcase 'mapLightOffset':\r\n\t\t\t\t\t\tcase 'mapLightWrap':\r\n\t\t\t\t\t\tcase 'mapLightAnisotropy':\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'mapAO':\r\n\t\t\t\t\t\t\tjson.aoMap = loadTexture( value, m.mapAORepeat, m.mapAOOffset, m.mapAOWrap, m.mapAOAnisotropy );\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'mapAORepeat':\r\n\t\t\t\t\t\tcase 'mapAOOffset':\r\n\t\t\t\t\t\tcase 'mapAOWrap':\r\n\t\t\t\t\t\tcase 'mapAOAnisotropy':\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'mapBump':\r\n\t\t\t\t\t\t\tjson.bumpMap = loadTexture( value, m.mapBumpRepeat, m.mapBumpOffset, m.mapBumpWrap, m.mapBumpAnisotropy );\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'mapBumpScale':\r\n\t\t\t\t\t\t\tjson.bumpScale = value;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'mapBumpRepeat':\r\n\t\t\t\t\t\tcase 'mapBumpOffset':\r\n\t\t\t\t\t\tcase 'mapBumpWrap':\r\n\t\t\t\t\t\tcase 'mapBumpAnisotropy':\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'mapNormal':\r\n\t\t\t\t\t\t\tjson.normalMap = loadTexture( value, m.mapNormalRepeat, m.mapNormalOffset, m.mapNormalWrap, m.mapNormalAnisotropy );\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'mapNormalFactor':\r\n\t\t\t\t\t\t\tjson.normalScale = [ value, value ];\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'mapNormalRepeat':\r\n\t\t\t\t\t\tcase 'mapNormalOffset':\r\n\t\t\t\t\t\tcase 'mapNormalWrap':\r\n\t\t\t\t\t\tcase 'mapNormalAnisotropy':\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'mapSpecular':\r\n\t\t\t\t\t\t\tjson.specularMap = loadTexture( value, m.mapSpecularRepeat, m.mapSpecularOffset, m.mapSpecularWrap, m.mapSpecularAnisotropy );\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'mapSpecularRepeat':\r\n\t\t\t\t\t\tcase 'mapSpecularOffset':\r\n\t\t\t\t\t\tcase 'mapSpecularWrap':\r\n\t\t\t\t\t\tcase 'mapSpecularAnisotropy':\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'mapAlpha':\r\n\t\t\t\t\t\t\tjson.alphaMap = loadTexture( value, m.mapAlphaRepeat, m.mapAlphaOffset, m.mapAlphaWrap, m.mapAlphaAnisotropy );\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'mapAlphaRepeat':\r\n\t\t\t\t\t\tcase 'mapAlphaOffset':\r\n\t\t\t\t\t\tcase 'mapAlphaWrap':\r\n\t\t\t\t\t\tcase 'mapAlphaAnisotropy':\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'flipSided':\r\n\t\t\t\t\t\t\tjson.side = THREE.BackSide;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'doubleSided':\r\n\t\t\t\t\t\t\tjson.side = THREE.DoubleSide;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'transparency':\r\n\t\t\t\t\t\t\tconsole.warn( 'THREE.Loader: transparency has been renamed to opacity' );\r\n\t\t\t\t\t\t\tjson.opacity = value;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'opacity':\r\n\t\t\t\t\t\tcase 'transparent':\r\n\t\t\t\t\t\tcase 'depthTest':\r\n\t\t\t\t\t\tcase 'depthWrite':\r\n\t\t\t\t\t\tcase 'transparent':\r\n\t\t\t\t\t\tcase 'visible':\r\n\t\t\t\t\t\tcase 'wireframe':\r\n\t\t\t\t\t\t\tjson[ name ] = value;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'vertexColors':\r\n\t\t\t\t\t\t\tif ( value === true ) json.vertexColors = THREE.VertexColors;\r\n\t\t\t\t\t\t\tif ( value === 'face' ) json.vertexColors = THREE.FaceColors;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\tconsole.error( 'Loader.createMaterial: Unsupported', name, value );\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( json.type !== 'MeshPhongMaterial' ) delete json.specular;\r\n\t\t\t\tif ( json.opacity < 1 ) json.transparent = true;\r\n\t\r\n\t\t\t\tmaterialLoader.setTextures( textures );\r\n\t\r\n\t\t\t\treturn materialLoader.parse( json );\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t} )()\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Loader.Handlers = {\r\n\t\r\n\t\thandlers: [],\r\n\t\r\n\t\tadd: function ( regex, loader ) {\r\n\t\r\n\t\t\tthis.handlers.push( regex, loader );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tget: function ( file ) {\r\n\t\r\n\t\t\tvar handlers = this.handlers;\r\n\t\r\n\t\t\tfor ( var i = 0, l = handlers.length; i < l; i += 2 ) {\r\n\t\r\n\t\t\t\tvar regex = handlers[ i ];\r\n\t\t\t\tvar loader  = handlers[ i + 1 ];\r\n\t\r\n\t\t\t\tif ( regex.test( file ) ) {\r\n\t\r\n\t\t\t\t\treturn loader;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn null;\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/loaders/XHRLoader.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.XHRLoader = function ( manager ) {\r\n\t\r\n\t\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.XHRLoader.prototype = {\r\n\t\r\n\t\tconstructor: THREE.XHRLoader,\r\n\t\r\n\t\tload: function ( url, onLoad, onProgress, onError ) {\r\n\t\r\n\t\t\tvar scope = this;\r\n\t\r\n\t\t\tvar cached = THREE.Cache.get( url );\r\n\t\r\n\t\t\tif ( cached !== undefined ) {\r\n\t\r\n\t\t\t\tif ( onLoad ) {\r\n\t\r\n\t\t\t\t\tsetTimeout( function () {\r\n\t\r\n\t\t\t\t\t\tonLoad( cached );\r\n\t\r\n\t\t\t\t\t}, 0 );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\treturn cached;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar request = new XMLHttpRequest();\r\n\t\t\trequest.open( 'GET', url, true );\r\n\t\r\n\t\t\trequest.addEventListener( 'load', function ( event ) {\r\n\t\r\n\t\t\t\tvar response = event.target.response;\r\n\t\r\n\t\t\t\tTHREE.Cache.add( url, response );\r\n\t\r\n\t\t\t\tif ( onLoad ) onLoad( response );\r\n\t\r\n\t\t\t\tscope.manager.itemEnd( url );\r\n\t\r\n\t\t\t}, false );\r\n\t\r\n\t\t\tif ( onProgress !== undefined ) {\r\n\t\r\n\t\t\t\trequest.addEventListener( 'progress', function ( event ) {\r\n\t\r\n\t\t\t\t\tonProgress( event );\r\n\t\r\n\t\t\t\t}, false );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\trequest.addEventListener( 'error', function ( event ) {\r\n\t\r\n\t\t\t\tif ( onError ) onError( event );\r\n\t\r\n\t\t\t\tscope.manager.itemError( url );\r\n\t\r\n\t\t\t}, false );\r\n\t\r\n\t\t\tif ( this.crossOrigin !== undefined ) request.crossOrigin = this.crossOrigin;\r\n\t\t\tif ( this.responseType !== undefined ) request.responseType = this.responseType;\r\n\t\t\tif ( this.withCredentials !== undefined ) request.withCredentials = this.withCredentials;\r\n\t\r\n\t\t\trequest.send( null );\r\n\t\r\n\t\t\tscope.manager.itemStart( url );\r\n\t\r\n\t\t\treturn request;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetResponseType: function ( value ) {\r\n\t\r\n\t\t\tthis.responseType = value;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetCrossOrigin: function ( value ) {\r\n\t\r\n\t\t\tthis.crossOrigin = value;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetWithCredentials: function ( value ) {\r\n\t\r\n\t\t\tthis.withCredentials = value;\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/loaders/ImageLoader.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.ImageLoader = function ( manager ) {\r\n\t\r\n\t\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.ImageLoader.prototype = {\r\n\t\r\n\t\tconstructor: THREE.ImageLoader,\r\n\t\r\n\t\tload: function ( url, onLoad, onProgress, onError ) {\r\n\t\r\n\t\t\tvar scope = this;\r\n\t\r\n\t\t\tvar cached = THREE.Cache.get( url );\r\n\t\r\n\t\t\tif ( cached !== undefined ) {\r\n\t\r\n\t\t\t\tscope.manager.itemStart( url );\r\n\t\r\n\t\t\t\tif ( onLoad ) {\r\n\t\r\n\t\t\t\t\tsetTimeout( function () {\r\n\t\r\n\t\t\t\t\t\tonLoad( cached );\r\n\t\r\n\t\t\t\t\t\tscope.manager.itemEnd( url );\r\n\t\r\n\t\t\t\t\t}, 0 );\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tscope.manager.itemEnd( url );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\treturn cached;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar image = document.createElement( 'img' );\r\n\t\r\n\t\t\timage.addEventListener( 'load', function ( event ) {\r\n\t\r\n\t\t\t\tTHREE.Cache.add( url, this );\r\n\t\r\n\t\t\t\tif ( onLoad ) onLoad( this );\r\n\t\r\n\t\t\t\tscope.manager.itemEnd( url );\r\n\t\r\n\t\t\t}, false );\r\n\t\r\n\t\t\tif ( onProgress !== undefined ) {\r\n\t\r\n\t\t\t\timage.addEventListener( 'progress', function ( event ) {\r\n\t\r\n\t\t\t\t\tonProgress( event );\r\n\t\r\n\t\t\t\t}, false );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\timage.addEventListener( 'error', function ( event ) {\r\n\t\r\n\t\t\t\tif ( onError ) onError( event );\r\n\t\r\n\t\t\t\tscope.manager.itemError( url );\r\n\t\r\n\t\t\t}, false );\r\n\t\r\n\t\t\tif ( this.crossOrigin !== undefined ) image.crossOrigin = this.crossOrigin;\r\n\t\r\n\t\t\tscope.manager.itemStart( url );\r\n\t\r\n\t\t\timage.src = url;\r\n\t\r\n\t\t\treturn image;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetCrossOrigin: function ( value ) {\r\n\t\r\n\t\t\tthis.crossOrigin = value;\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/loaders/JSONLoader.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\t\r\n\tTHREE.JSONLoader = function ( manager ) {\r\n\t\r\n\t\tif ( typeof manager === 'boolean' ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.JSONLoader: showStatus parameter has been removed from constructor.' );\r\n\t\t\tmanager = undefined;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\t\r\n\t\tthis.withCredentials = false;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.JSONLoader.prototype = {\r\n\t\r\n\t\tconstructor: THREE.JSONLoader,\r\n\t\r\n\t\t// Deprecated\r\n\t\r\n\t\tget statusDomElement () {\r\n\t\r\n\t\t\tif ( this._statusDomElement === undefined ) {\r\n\t\r\n\t\t\t\tthis._statusDomElement = document.createElement( 'div' );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tconsole.warn( 'THREE.JSONLoader: .statusDomElement has been removed.' );\r\n\t\t\treturn this._statusDomElement;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tload: function( url, onLoad, onProgress, onError ) {\r\n\t\r\n\t\t\tvar scope = this;\r\n\t\r\n\t\t\tvar texturePath = this.texturePath && ( typeof this.texturePath === \"string\" ) ? this.texturePath : THREE.Loader.prototype.extractUrlBase( url );\r\n\t\r\n\t\t\tvar loader = new THREE.XHRLoader( this.manager );\r\n\t\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\t\t\tloader.setWithCredentials( this.withCredentials );\r\n\t\t\tloader.load( url, function ( text ) {\r\n\t\r\n\t\t\t\tvar json = JSON.parse( text );\r\n\t\t\t\tvar metadata = json.metadata;\r\n\t\r\n\t\t\t\tif ( metadata !== undefined ) {\r\n\t\r\n\t\t\t\t\tif ( metadata.type === 'object' ) {\r\n\t\r\n\t\t\t\t\t\tconsole.error( 'THREE.JSONLoader: ' + url + ' should be loaded with THREE.ObjectLoader instead.' );\r\n\t\t\t\t\t\treturn;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tif ( metadata.type === 'scene' ) {\r\n\t\r\n\t\t\t\t\t\tconsole.error( 'THREE.JSONLoader: ' + url + ' should be loaded with THREE.SceneLoader instead.' );\r\n\t\t\t\t\t\treturn;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tvar object = scope.parse( json, texturePath );\r\n\t\t\t\tonLoad( object.geometry, object.materials );\r\n\t\r\n\t\t\t} );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetCrossOrigin: function ( value ) {\r\n\t\r\n\t\t\tthis.crossOrigin = value;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetTexturePath: function ( value ) {\r\n\t\r\n\t\t\tthis.texturePath = value;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tparse: function ( json, texturePath ) {\r\n\t\r\n\t\t\tvar geometry = new THREE.Geometry(),\r\n\t\t\tscale = ( json.scale !== undefined ) ? 1.0 / json.scale : 1.0;\r\n\t\r\n\t\t\tparseModel( scale );\r\n\t\r\n\t\t\tparseSkin();\r\n\t\t\tparseMorphing( scale );\r\n\t\t\tparseAnimations();\r\n\t\r\n\t\t\tgeometry.computeFaceNormals();\r\n\t\t\tgeometry.computeBoundingSphere();\r\n\t\r\n\t\t\tfunction parseModel( scale ) {\r\n\t\r\n\t\t\t\tfunction isBitSet( value, position ) {\r\n\t\r\n\t\t\t\t\treturn value & ( 1 << position );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tvar i, j, fi,\r\n\t\r\n\t\t\t\toffset, zLength,\r\n\t\r\n\t\t\tcolorIndex, normalIndex, uvIndex, materialIndex,\r\n\t\r\n\t\t\t\ttype,\r\n\t\t\t\tisQuad,\r\n\t\t\t\thasMaterial,\r\n\t\t\t\thasFaceVertexUv,\r\n\t\t\t\thasFaceNormal, hasFaceVertexNormal,\r\n\t\t\t\thasFaceColor, hasFaceVertexColor,\r\n\t\r\n\t\t\tvertex, face, faceA, faceB, hex, normal,\r\n\t\r\n\t\t\t\tuvLayer, uv, u, v,\r\n\t\r\n\t\t\t\tfaces = json.faces,\r\n\t\t\t\tvertices = json.vertices,\r\n\t\t\t\tnormals = json.normals,\r\n\t\t\t\tcolors = json.colors,\r\n\t\r\n\t\t\t\tnUvLayers = 0;\r\n\t\r\n\t\t\t\tif ( json.uvs !== undefined ) {\r\n\t\r\n\t\t\t\t\t// disregard empty arrays\r\n\t\r\n\t\t\t\t\tfor ( i = 0; i < json.uvs.length; i ++ ) {\r\n\t\r\n\t\t\t\t\t\tif ( json.uvs[ i ].length ) nUvLayers ++;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tfor ( i = 0; i < nUvLayers; i ++ ) {\r\n\t\r\n\t\t\t\t\t\tgeometry.faceVertexUvs[ i ] = [];\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\toffset = 0;\r\n\t\t\t\tzLength = vertices.length;\r\n\t\r\n\t\t\t\twhile ( offset < zLength ) {\r\n\t\r\n\t\t\t\t\tvertex = new THREE.Vector3();\r\n\t\r\n\t\t\t\t\tvertex.x = vertices[ offset ++ ] * scale;\r\n\t\t\t\t\tvertex.y = vertices[ offset ++ ] * scale;\r\n\t\t\t\t\tvertex.z = vertices[ offset ++ ] * scale;\r\n\t\r\n\t\t\t\t\tgeometry.vertices.push( vertex );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\toffset = 0;\r\n\t\t\t\tzLength = faces.length;\r\n\t\r\n\t\t\t\twhile ( offset < zLength ) {\r\n\t\r\n\t\t\t\t\ttype = faces[ offset ++ ];\r\n\t\r\n\t\r\n\t\t\t\t\tisQuad              = isBitSet( type, 0 );\r\n\t\t\t\t\thasMaterial         = isBitSet( type, 1 );\r\n\t\t\t\t\thasFaceVertexUv     = isBitSet( type, 3 );\r\n\t\t\t\t\thasFaceNormal       = isBitSet( type, 4 );\r\n\t\t\t\t\thasFaceVertexNormal = isBitSet( type, 5 );\r\n\t\t\t\t\thasFaceColor\t     = isBitSet( type, 6 );\r\n\t\t\t\t\thasFaceVertexColor  = isBitSet( type, 7 );\r\n\t\r\n\t\t\t\t\t// console.log(\"type\", type, \"bits\", isQuad, hasMaterial, hasFaceVertexUv, hasFaceNormal, hasFaceVertexNormal, hasFaceColor, hasFaceVertexColor);\r\n\t\r\n\t\t\t\t\tif ( isQuad ) {\r\n\t\r\n\t\t\t\t\t\tfaceA = new THREE.Face3();\r\n\t\t\t\t\t\tfaceA.a = faces[ offset ];\r\n\t\t\t\t\t\tfaceA.b = faces[ offset + 1 ];\r\n\t\t\t\t\t\tfaceA.c = faces[ offset + 3 ];\r\n\t\r\n\t\t\t\t\t\tfaceB = new THREE.Face3();\r\n\t\t\t\t\t\tfaceB.a = faces[ offset + 1 ];\r\n\t\t\t\t\t\tfaceB.b = faces[ offset + 2 ];\r\n\t\t\t\t\t\tfaceB.c = faces[ offset + 3 ];\r\n\t\r\n\t\t\t\t\t\toffset += 4;\r\n\t\r\n\t\t\t\t\t\tif ( hasMaterial ) {\r\n\t\r\n\t\t\t\t\t\t\tmaterialIndex = faces[ offset ++ ];\r\n\t\t\t\t\t\t\tfaceA.materialIndex = materialIndex;\r\n\t\t\t\t\t\t\tfaceB.materialIndex = materialIndex;\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t// to get face <=> uv index correspondence\r\n\t\r\n\t\t\t\t\t\tfi = geometry.faces.length;\r\n\t\r\n\t\t\t\t\t\tif ( hasFaceVertexUv ) {\r\n\t\r\n\t\t\t\t\t\t\tfor ( i = 0; i < nUvLayers; i ++ ) {\r\n\t\r\n\t\t\t\t\t\t\t\tuvLayer = json.uvs[ i ];\r\n\t\r\n\t\t\t\t\t\t\t\tgeometry.faceVertexUvs[ i ][ fi ] = [];\r\n\t\t\t\t\t\t\t\tgeometry.faceVertexUvs[ i ][ fi + 1 ] = [];\r\n\t\r\n\t\t\t\t\t\t\t\tfor ( j = 0; j < 4; j ++ ) {\r\n\t\r\n\t\t\t\t\t\t\t\t\tuvIndex = faces[ offset ++ ];\r\n\t\r\n\t\t\t\t\t\t\t\t\tu = uvLayer[ uvIndex * 2 ];\r\n\t\t\t\t\t\t\t\t\tv = uvLayer[ uvIndex * 2 + 1 ];\r\n\t\r\n\t\t\t\t\t\t\t\t\tuv = new THREE.Vector2( u, v );\r\n\t\r\n\t\t\t\t\t\t\t\t\tif ( j !== 2 ) geometry.faceVertexUvs[ i ][ fi ].push( uv );\r\n\t\t\t\t\t\t\t\t\tif ( j !== 0 ) geometry.faceVertexUvs[ i ][ fi + 1 ].push( uv );\r\n\t\r\n\t\t\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\tif ( hasFaceNormal ) {\r\n\t\r\n\t\t\t\t\t\t\tnormalIndex = faces[ offset ++ ] * 3;\r\n\t\r\n\t\t\t\t\t\t\tfaceA.normal.set(\r\n\t\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\t\tnormals[ normalIndex ]\r\n\t\t\t\t\t\t\t);\r\n\t\r\n\t\t\t\t\t\t\tfaceB.normal.copy( faceA.normal );\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\tif ( hasFaceVertexNormal ) {\r\n\t\r\n\t\t\t\t\t\t\tfor ( i = 0; i < 4; i ++ ) {\r\n\t\r\n\t\t\t\t\t\t\t\tnormalIndex = faces[ offset ++ ] * 3;\r\n\t\r\n\t\t\t\t\t\t\t\tnormal = new THREE.Vector3(\r\n\t\t\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\t\t\tnormals[ normalIndex ]\r\n\t\t\t\t\t\t\t\t);\r\n\t\r\n\t\r\n\t\t\t\t\t\t\t\tif ( i !== 2 ) faceA.vertexNormals.push( normal );\r\n\t\t\t\t\t\t\t\tif ( i !== 0 ) faceB.vertexNormals.push( normal );\r\n\t\r\n\t\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\r\n\t\t\t\t\t\tif ( hasFaceColor ) {\r\n\t\r\n\t\t\t\t\t\t\tcolorIndex = faces[ offset ++ ];\r\n\t\t\t\t\t\t\thex = colors[ colorIndex ];\r\n\t\r\n\t\t\t\t\t\t\tfaceA.color.setHex( hex );\r\n\t\t\t\t\t\t\tfaceB.color.setHex( hex );\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\r\n\t\t\t\t\t\tif ( hasFaceVertexColor ) {\r\n\t\r\n\t\t\t\t\t\t\tfor ( i = 0; i < 4; i ++ ) {\r\n\t\r\n\t\t\t\t\t\t\t\tcolorIndex = faces[ offset ++ ];\r\n\t\t\t\t\t\t\t\thex = colors[ colorIndex ];\r\n\t\r\n\t\t\t\t\t\t\t\tif ( i !== 2 ) faceA.vertexColors.push( new THREE.Color( hex ) );\r\n\t\t\t\t\t\t\t\tif ( i !== 0 ) faceB.vertexColors.push( new THREE.Color( hex ) );\r\n\t\r\n\t\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\tgeometry.faces.push( faceA );\r\n\t\t\t\t\t\tgeometry.faces.push( faceB );\r\n\t\r\n\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\tface = new THREE.Face3();\r\n\t\t\t\t\t\tface.a = faces[ offset ++ ];\r\n\t\t\t\t\t\tface.b = faces[ offset ++ ];\r\n\t\t\t\t\t\tface.c = faces[ offset ++ ];\r\n\t\r\n\t\t\t\t\t\tif ( hasMaterial ) {\r\n\t\r\n\t\t\t\t\t\t\tmaterialIndex = faces[ offset ++ ];\r\n\t\t\t\t\t\t\tface.materialIndex = materialIndex;\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t// to get face <=> uv index correspondence\r\n\t\r\n\t\t\t\t\t\tfi = geometry.faces.length;\r\n\t\r\n\t\t\t\t\t\tif ( hasFaceVertexUv ) {\r\n\t\r\n\t\t\t\t\t\t\tfor ( i = 0; i < nUvLayers; i ++ ) {\r\n\t\r\n\t\t\t\t\t\t\t\tuvLayer = json.uvs[ i ];\r\n\t\r\n\t\t\t\t\t\t\t\tgeometry.faceVertexUvs[ i ][ fi ] = [];\r\n\t\r\n\t\t\t\t\t\t\t\tfor ( j = 0; j < 3; j ++ ) {\r\n\t\r\n\t\t\t\t\t\t\t\t\tuvIndex = faces[ offset ++ ];\r\n\t\r\n\t\t\t\t\t\t\t\t\tu = uvLayer[ uvIndex * 2 ];\r\n\t\t\t\t\t\t\t\t\tv = uvLayer[ uvIndex * 2 + 1 ];\r\n\t\r\n\t\t\t\t\t\t\t\t\tuv = new THREE.Vector2( u, v );\r\n\t\r\n\t\t\t\t\t\t\t\t\tgeometry.faceVertexUvs[ i ][ fi ].push( uv );\r\n\t\r\n\t\t\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\tif ( hasFaceNormal ) {\r\n\t\r\n\t\t\t\t\t\t\tnormalIndex = faces[ offset ++ ] * 3;\r\n\t\r\n\t\t\t\t\t\t\tface.normal.set(\r\n\t\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\t\tnormals[ normalIndex ]\r\n\t\t\t\t\t\t\t);\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\tif ( hasFaceVertexNormal ) {\r\n\t\r\n\t\t\t\t\t\t\tfor ( i = 0; i < 3; i ++ ) {\r\n\t\r\n\t\t\t\t\t\t\t\tnormalIndex = faces[ offset ++ ] * 3;\r\n\t\r\n\t\t\t\t\t\t\t\tnormal = new THREE.Vector3(\r\n\t\t\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\t\t\tnormals[ normalIndex ]\r\n\t\t\t\t\t\t\t\t);\r\n\t\r\n\t\t\t\t\t\t\t\tface.vertexNormals.push( normal );\r\n\t\r\n\t\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\r\n\t\t\t\t\t\tif ( hasFaceColor ) {\r\n\t\r\n\t\t\t\t\t\t\tcolorIndex = faces[ offset ++ ];\r\n\t\t\t\t\t\t\tface.color.setHex( colors[ colorIndex ] );\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\r\n\t\t\t\t\t\tif ( hasFaceVertexColor ) {\r\n\t\r\n\t\t\t\t\t\t\tfor ( i = 0; i < 3; i ++ ) {\r\n\t\r\n\t\t\t\t\t\t\t\tcolorIndex = faces[ offset ++ ];\r\n\t\t\t\t\t\t\t\tface.vertexColors.push( new THREE.Color( colors[ colorIndex ] ) );\r\n\t\r\n\t\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\tgeometry.faces.push( face );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t\tfunction parseSkin() {\r\n\t\r\n\t\t\t\tvar influencesPerVertex = ( json.influencesPerVertex !== undefined ) ? json.influencesPerVertex : 2;\r\n\t\r\n\t\t\t\tif ( json.skinWeights ) {\r\n\t\r\n\t\t\t\t\tfor ( var i = 0, l = json.skinWeights.length; i < l; i += influencesPerVertex ) {\r\n\t\r\n\t\t\t\t\t\tvar x =                               json.skinWeights[ i ];\r\n\t\t\t\t\t\tvar y = ( influencesPerVertex > 1 ) ? json.skinWeights[ i + 1 ] : 0;\r\n\t\t\t\t\t\tvar z = ( influencesPerVertex > 2 ) ? json.skinWeights[ i + 2 ] : 0;\r\n\t\t\t\t\t\tvar w = ( influencesPerVertex > 3 ) ? json.skinWeights[ i + 3 ] : 0;\r\n\t\r\n\t\t\t\t\t\tgeometry.skinWeights.push( new THREE.Vector4( x, y, z, w ) );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( json.skinIndices ) {\r\n\t\r\n\t\t\t\t\tfor ( var i = 0, l = json.skinIndices.length; i < l; i += influencesPerVertex ) {\r\n\t\r\n\t\t\t\t\t\tvar a =                               json.skinIndices[ i ];\r\n\t\t\t\t\t\tvar b = ( influencesPerVertex > 1 ) ? json.skinIndices[ i + 1 ] : 0;\r\n\t\t\t\t\t\tvar c = ( influencesPerVertex > 2 ) ? json.skinIndices[ i + 2 ] : 0;\r\n\t\t\t\t\t\tvar d = ( influencesPerVertex > 3 ) ? json.skinIndices[ i + 3 ] : 0;\r\n\t\r\n\t\t\t\t\t\tgeometry.skinIndices.push( new THREE.Vector4( a, b, c, d ) );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tgeometry.bones = json.bones;\r\n\t\r\n\t\t\t\tif ( geometry.bones && geometry.bones.length > 0 && ( geometry.skinWeights.length !== geometry.skinIndices.length || geometry.skinIndices.length !== geometry.vertices.length ) ) {\r\n\t\r\n\t\t\t\t\tconsole.warn( 'When skinning, number of vertices (' + geometry.vertices.length + '), skinIndices (' +\r\n\t\t\t\t\t\tgeometry.skinIndices.length + '), and skinWeights (' + geometry.skinWeights.length + ') should match.' );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t\tfunction parseMorphing( scale ) {\r\n\t\r\n\t\t\t\tif ( json.morphTargets !== undefined ) {\r\n\t\r\n\t\t\t\t\tfor ( var i = 0, l = json.morphTargets.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\t\t\tgeometry.morphTargets[ i ] = {};\r\n\t\t\t\t\t\tgeometry.morphTargets[ i ].name = json.morphTargets[ i ].name;\r\n\t\t\t\t\t\tgeometry.morphTargets[ i ].vertices = [];\r\n\t\r\n\t\t\t\t\t\tvar dstVertices = geometry.morphTargets[ i ].vertices;\r\n\t\t\t\t\t\tvar srcVertices = json.morphTargets[ i ].vertices;\r\n\t\r\n\t\t\t\t\t\tfor ( var v = 0, vl = srcVertices.length; v < vl; v += 3 ) {\r\n\t\r\n\t\t\t\t\t\t\tvar vertex = new THREE.Vector3();\r\n\t\t\t\t\t\t\tvertex.x = srcVertices[ v ] * scale;\r\n\t\t\t\t\t\t\tvertex.y = srcVertices[ v + 1 ] * scale;\r\n\t\t\t\t\t\t\tvertex.z = srcVertices[ v + 2 ] * scale;\r\n\t\r\n\t\t\t\t\t\t\tdstVertices.push( vertex );\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( json.morphColors !== undefined && json.morphColors.length > 0 ) {\r\n\t\r\n\t\t\t\t\tconsole.warn( 'THREE.JSONLoader: \"morphColors\" no longer supported. Using them as face colors.' );\r\n\t\r\n\t\t\t\t\tvar faces = geometry.faces;\r\n\t\t\t\t\tvar morphColors = json.morphColors[ 0 ].colors;\r\n\t\r\n\t\t\t\t\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\t\t\tfaces[ i ].color.fromArray( morphColors, i * 3 );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tfunction parseAnimations() {\r\n\t\r\n\t\t\t\tvar outputAnimations = [];\r\n\t\r\n\t\t\t\t// parse old style Bone/Hierarchy animations\r\n\t\t\t\tvar animations = [];\r\n\t\t\t\tif ( json.animation !== undefined ) {\r\n\t\t\t\t\tanimations.push( json.animation );\r\n\t\t\t\t}\r\n\t\t\t\tif ( json.animations !== undefined ) {\r\n\t\t\t\t\tif ( json.animations.length ) {\r\n\t\t\t\t\t\tanimations = animations.concat( json.animations );\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tanimations.push( json.animations );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tfor ( var i = 0; i < animations.length; i ++ ) {\r\n\t\r\n\t\t\t\t\tvar clip = THREE.AnimationClip.parseAnimation( animations[i], geometry.bones );\r\n\t\t\t\t\tif ( clip ) outputAnimations.push( clip );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\t// parse implicit morph animations\r\n\t\t\t\tif ( geometry.morphTargets ) {\r\n\t\r\n\t\t\t\t\t// TODO: Figure out what an appropraite FPS is for morph target animations -- defaulting to 10, but really it is completely arbitrary.\r\n\t\t\t\t\tvar morphAnimationClips = THREE.AnimationClip.CreateClipsFromMorphTargetSequences( geometry.morphTargets, 10 );\r\n\t\t\t\t\toutputAnimations = outputAnimations.concat( morphAnimationClips );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( outputAnimations.length > 0 ) geometry.animations = outputAnimations;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t\tif ( json.materials === undefined || json.materials.length === 0 ) {\r\n\t\r\n\t\t\t\treturn { geometry: geometry };\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\tvar materials = THREE.Loader.prototype.initMaterials( json.materials, texturePath, this.crossOrigin );\r\n\t\r\n\t\t\t\treturn { geometry: geometry, materials: materials };\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/loaders/LoadingManager.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.LoadingManager = function ( onLoad, onProgress, onError ) {\r\n\t\r\n\t\tvar scope = this;\r\n\t\r\n\t\tvar isLoading = false, itemsLoaded = 0, itemsTotal = 0;\r\n\t\r\n\t\tthis.onStart = undefined;\r\n\t\tthis.onLoad = onLoad;\r\n\t\tthis.onProgress = onProgress;\r\n\t\tthis.onError = onError;\r\n\t\r\n\t\tthis.itemStart = function ( url ) {\r\n\t\r\n\t\t\titemsTotal ++;\r\n\t\r\n\t\t\tif ( isLoading === false ) {\r\n\t\r\n\t\t\t\tif ( scope.onStart !== undefined ) {\r\n\t\r\n\t\t\t\t\tscope.onStart( url, itemsLoaded, itemsTotal );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tisLoading = true;\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.itemEnd = function ( url ) {\r\n\t\r\n\t\t\titemsLoaded ++;\r\n\t\r\n\t\t\tif ( scope.onProgress !== undefined ) {\r\n\t\r\n\t\t\t\tscope.onProgress( url, itemsLoaded, itemsTotal );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( itemsLoaded === itemsTotal ) {\r\n\t\r\n\t\t\t\tisLoading = false;\r\n\t\r\n\t\t\t\tif ( scope.onLoad !== undefined ) {\r\n\t\r\n\t\t\t\t\tscope.onLoad();\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.itemError = function ( url ) {\r\n\t\r\n\t\t\tif ( scope.onError !== undefined ) {\r\n\t\r\n\t\t\t\tscope.onError( url );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t};\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.DefaultLoadingManager = new THREE.LoadingManager();\r\n\t\r\n\t// File:src/loaders/BufferGeometryLoader.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.BufferGeometryLoader = function ( manager ) {\r\n\t\r\n\t\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.BufferGeometryLoader.prototype = {\r\n\t\r\n\t\tconstructor: THREE.BufferGeometryLoader,\r\n\t\r\n\t\tload: function ( url, onLoad, onProgress, onError ) {\r\n\t\r\n\t\t\tvar scope = this;\r\n\t\r\n\t\t\tvar loader = new THREE.XHRLoader( scope.manager );\r\n\t\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\t\t\tloader.load( url, function ( text ) {\r\n\t\r\n\t\t\t\tonLoad( scope.parse( JSON.parse( text ) ) );\r\n\t\r\n\t\t\t}, onProgress, onError );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetCrossOrigin: function ( value ) {\r\n\t\r\n\t\t\tthis.crossOrigin = value;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tparse: function ( json ) {\r\n\t\r\n\t\t\tvar geometry = new THREE.BufferGeometry();\r\n\t\r\n\t\t\tvar index = json.data.index;\r\n\t\r\n\t\t\tif ( index !== undefined ) {\r\n\t\r\n\t\t\t\tvar typedArray = new self[ index.type ]( index.array );\r\n\t\t\t\tgeometry.setIndex( new THREE.BufferAttribute( typedArray, 1 ) );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar attributes = json.data.attributes;\r\n\t\r\n\t\t\tfor ( var key in attributes ) {\r\n\t\r\n\t\t\t\tvar attribute = attributes[ key ];\r\n\t\t\t\tvar typedArray = new self[ attribute.type ]( attribute.array );\r\n\t\r\n\t\t\t\tgeometry.addAttribute( key, new THREE.BufferAttribute( typedArray, attribute.itemSize ) );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar groups = json.data.groups || json.data.drawcalls || json.data.offsets;\r\n\t\r\n\t\t\tif ( groups !== undefined ) {\r\n\t\r\n\t\t\t\tfor ( var i = 0, n = groups.length; i !== n; ++ i ) {\r\n\t\r\n\t\t\t\t\tvar group = groups[ i ];\r\n\t\r\n\t\t\t\t\tgeometry.addGroup( group.start, group.count );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar boundingSphere = json.data.boundingSphere;\r\n\t\r\n\t\t\tif ( boundingSphere !== undefined ) {\r\n\t\r\n\t\t\t\tvar center = new THREE.Vector3();\r\n\t\r\n\t\t\t\tif ( boundingSphere.center !== undefined ) {\r\n\t\r\n\t\t\t\t\tcenter.fromArray( boundingSphere.center );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tgeometry.boundingSphere = new THREE.Sphere( center, boundingSphere.radius );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn geometry;\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/loaders/MaterialLoader.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.MaterialLoader = function ( manager ) {\r\n\t\r\n\t\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\t\tthis.textures = {};\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.MaterialLoader.prototype = {\r\n\t\r\n\t\tconstructor: THREE.MaterialLoader,\r\n\t\r\n\t\tload: function ( url, onLoad, onProgress, onError ) {\r\n\t\r\n\t\t\tvar scope = this;\r\n\t\r\n\t\t\tvar loader = new THREE.XHRLoader( scope.manager );\r\n\t\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\t\t\tloader.load( url, function ( text ) {\r\n\t\r\n\t\t\t\tonLoad( scope.parse( JSON.parse( text ) ) );\r\n\t\r\n\t\t\t}, onProgress, onError );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetCrossOrigin: function ( value ) {\r\n\t\r\n\t\t\tthis.crossOrigin = value;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetTextures: function ( value ) {\r\n\t\r\n\t\t\tthis.textures = value;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tgetTexture: function ( name ) {\r\n\t\r\n\t\t\tvar textures = this.textures;\r\n\t\r\n\t\t\tif ( textures[ name ] === undefined ) {\r\n\t\r\n\t\t\t\tconsole.warn( 'THREE.MaterialLoader: Undefined texture', name );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn textures[ name ];\r\n\t\r\n\t\t},\r\n\t\r\n\t\tparse: function ( json ) {\r\n\t\r\n\t\t\tvar material = new THREE[ json.type ];\r\n\t\t\tmaterial.uuid = json.uuid;\r\n\t\r\n\t\t\tif ( json.name !== undefined ) material.name = json.name;\r\n\t\t\tif ( json.color !== undefined ) material.color.setHex( json.color );\r\n\t\t\tif ( json.emissive !== undefined ) material.emissive.setHex( json.emissive );\r\n\t\t\tif ( json.specular !== undefined ) material.specular.setHex( json.specular );\r\n\t\t\tif ( json.shininess !== undefined ) material.shininess = json.shininess;\r\n\t\t\tif ( json.uniforms !== undefined ) material.uniforms = json.uniforms;\r\n\t\t\tif ( json.vertexShader !== undefined ) material.vertexShader = json.vertexShader;\r\n\t\t\tif ( json.fragmentShader !== undefined ) material.fragmentShader = json.fragmentShader;\r\n\t\t\tif ( json.vertexColors !== undefined ) material.vertexColors = json.vertexColors;\r\n\t\t\tif ( json.shading !== undefined ) material.shading = json.shading;\r\n\t\t\tif ( json.blending !== undefined ) material.blending = json.blending;\r\n\t\t\tif ( json.side !== undefined ) material.side = json.side;\r\n\t\t\tif ( json.opacity !== undefined ) material.opacity = json.opacity;\r\n\t\t\tif ( json.transparent !== undefined ) material.transparent = json.transparent;\r\n\t\t\tif ( json.alphaTest !== undefined ) material.alphaTest = json.alphaTest;\r\n\t\t\tif ( json.depthTest !== undefined ) material.depthTest = json.depthTest;\r\n\t\t\tif ( json.depthWrite !== undefined ) material.depthWrite = json.depthWrite;\r\n\t\t\tif ( json.wireframe !== undefined ) material.wireframe = json.wireframe;\r\n\t\t\tif ( json.wireframeLinewidth !== undefined ) material.wireframeLinewidth = json.wireframeLinewidth;\r\n\t\r\n\t\t\t// for PointsMaterial\r\n\t\t\tif ( json.size !== undefined ) material.size = json.size;\r\n\t\t\tif ( json.sizeAttenuation !== undefined ) material.sizeAttenuation = json.sizeAttenuation;\r\n\t\r\n\t\t\t// maps\r\n\t\r\n\t\t\tif ( json.map !== undefined ) material.map = this.getTexture( json.map );\r\n\t\r\n\t\t\tif ( json.alphaMap !== undefined ) {\r\n\t\r\n\t\t\t\tmaterial.alphaMap = this.getTexture( json.alphaMap );\r\n\t\t\t\tmaterial.transparent = true;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( json.bumpMap !== undefined ) material.bumpMap = this.getTexture( json.bumpMap );\r\n\t\t\tif ( json.bumpScale !== undefined ) material.bumpScale = json.bumpScale;\r\n\t\r\n\t\t\tif ( json.normalMap !== undefined ) material.normalMap = this.getTexture( json.normalMap );\r\n\t\t\tif ( json.normalScale )\tmaterial.normalScale = new THREE.Vector2( json.normalScale, json.normalScale );\r\n\t\r\n\t\t\tif ( json.displacementMap !== undefined ) material.displacementMap = this.getTexture( json.displacementMap );\r\n\t\t\tif ( json.displacementScale !== undefined ) material.displacementScale = json.displacementScale;\r\n\t\t\tif ( json.displacementBias !== undefined ) material.displacementBias = json.displacementBias;\r\n\t\r\n\t\t\tif ( json.specularMap !== undefined ) material.specularMap = this.getTexture( json.specularMap );\r\n\t\r\n\t\t\tif ( json.envMap !== undefined ) {\r\n\t\r\n\t\t\t\tmaterial.envMap = this.getTexture( json.envMap );\r\n\t\t\t\tmaterial.combine = THREE.MultiplyOperation;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( json.reflectivity ) material.reflectivity = json.reflectivity;\r\n\t\r\n\t\t\tif ( json.lightMap !== undefined ) material.lightMap = this.getTexture( json.lightMap );\r\n\t\t\tif ( json.lightMapIntensity !== undefined ) material.lightMapIntensity = json.lightMapIntensity;\r\n\t\r\n\t\t\tif ( json.aoMap !== undefined ) material.aoMap = this.getTexture( json.aoMap );\r\n\t\t\tif ( json.aoMapIntensity !== undefined ) material.aoMapIntensity = json.aoMapIntensity;\r\n\t\r\n\t\t\t// MeshFaceMaterial\r\n\t\r\n\t\t\tif ( json.materials !== undefined ) {\r\n\t\r\n\t\t\t\tfor ( var i = 0, l = json.materials.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\t\tmaterial.materials.push( this.parse( json.materials[ i ] ) );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn material;\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/loaders/ObjectLoader.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.ObjectLoader = function ( manager ) {\r\n\t\r\n\t\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\t\tthis.texturePath = '';\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.ObjectLoader.prototype = {\r\n\t\r\n\t\tconstructor: THREE.ObjectLoader,\r\n\t\r\n\t\tload: function ( url, onLoad, onProgress, onError ) {\r\n\t\r\n\t\t\tif ( this.texturePath === '' ) {\r\n\t\r\n\t\t\t\tthis.texturePath = url.substring( 0, url.lastIndexOf( '/' ) + 1 );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar scope = this;\r\n\t\r\n\t\t\tvar loader = new THREE.XHRLoader( scope.manager );\r\n\t\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\t\t\tloader.load( url, function ( text ) {\r\n\t\r\n\t\t\t\tscope.parse( JSON.parse( text ), onLoad );\r\n\t\r\n\t\t\t}, onProgress, onError );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetTexturePath: function ( value ) {\r\n\t\r\n\t\t\tthis.texturePath = value;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetCrossOrigin: function ( value ) {\r\n\t\r\n\t\t\tthis.crossOrigin = value;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tparse: function ( json, onLoad ) {\r\n\t\r\n\t\t\tvar geometries = this.parseGeometries( json.geometries );\r\n\t\r\n\t\t\tvar images = this.parseImages( json.images, function () {\r\n\t\r\n\t\t\t\tif ( onLoad !== undefined ) onLoad( object );\r\n\t\r\n\t\t\t} );\r\n\t\r\n\t\t\tvar textures  = this.parseTextures( json.textures, images );\r\n\t\t\tvar materials = this.parseMaterials( json.materials, textures );\r\n\t\r\n\t\t\tvar object = this.parseObject( json.object, geometries, materials );\r\n\t\r\n\t\t\tif ( json.animations ) {\r\n\t\r\n\t\t\t\tobject.animations = this.parseAnimations( json.animations );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( json.images === undefined || json.images.length === 0 ) {\r\n\t\r\n\t\t\t\tif ( onLoad !== undefined ) onLoad( object );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn object;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tparseGeometries: function ( json ) {\r\n\t\r\n\t\t\tvar geometries = {};\r\n\t\r\n\t\t\tif ( json !== undefined ) {\r\n\t\r\n\t\t\t\tvar geometryLoader = new THREE.JSONLoader();\r\n\t\t\t\tvar bufferGeometryLoader = new THREE.BufferGeometryLoader();\r\n\t\r\n\t\t\t\tfor ( var i = 0, l = json.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\t\tvar geometry;\r\n\t\t\t\t\tvar data = json[ i ];\r\n\t\r\n\t\t\t\t\tswitch ( data.type ) {\r\n\t\r\n\t\t\t\t\t\tcase 'PlaneGeometry':\r\n\t\t\t\t\t\tcase 'PlaneBufferGeometry':\r\n\t\r\n\t\t\t\t\t\t\tgeometry = new THREE[ data.type ](\r\n\t\t\t\t\t\t\t\tdata.width,\r\n\t\t\t\t\t\t\t\tdata.height,\r\n\t\t\t\t\t\t\t\tdata.widthSegments,\r\n\t\t\t\t\t\t\t\tdata.heightSegments\r\n\t\t\t\t\t\t\t);\r\n\t\r\n\t\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\t\tcase 'BoxGeometry':\r\n\t\t\t\t\t\tcase 'CubeGeometry': // backwards compatible\r\n\t\r\n\t\t\t\t\t\t\tgeometry = new THREE.BoxGeometry(\r\n\t\t\t\t\t\t\t\tdata.width,\r\n\t\t\t\t\t\t\t\tdata.height,\r\n\t\t\t\t\t\t\t\tdata.depth,\r\n\t\t\t\t\t\t\t\tdata.widthSegments,\r\n\t\t\t\t\t\t\t\tdata.heightSegments,\r\n\t\t\t\t\t\t\t\tdata.depthSegments\r\n\t\t\t\t\t\t\t);\r\n\t\r\n\t\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\t\tcase 'CircleBufferGeometry':\r\n\t\r\n\t\t\t\t\t\t\tgeometry = new THREE.CircleBufferGeometry(\r\n\t\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\t\tdata.segments,\r\n\t\t\t\t\t\t\t\tdata.thetaStart,\r\n\t\t\t\t\t\t\t\tdata.thetaLength\r\n\t\t\t\t\t\t\t);\r\n\t\r\n\t\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\t\tcase 'CircleGeometry':\r\n\t\r\n\t\t\t\t\t\t\tgeometry = new THREE.CircleGeometry(\r\n\t\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\t\tdata.segments,\r\n\t\t\t\t\t\t\t\tdata.thetaStart,\r\n\t\t\t\t\t\t\t\tdata.thetaLength\r\n\t\t\t\t\t\t\t);\r\n\t\r\n\t\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\t\tcase 'CylinderGeometry':\r\n\t\r\n\t\t\t\t\t\t\tgeometry = new THREE.CylinderGeometry(\r\n\t\t\t\t\t\t\t\tdata.radiusTop,\r\n\t\t\t\t\t\t\t\tdata.radiusBottom,\r\n\t\t\t\t\t\t\t\tdata.height,\r\n\t\t\t\t\t\t\t\tdata.radialSegments,\r\n\t\t\t\t\t\t\t\tdata.heightSegments,\r\n\t\t\t\t\t\t\t\tdata.openEnded,\r\n\t\t\t\t\t\t\t\tdata.thetaStart,\r\n\t\t\t\t\t\t\t\tdata.thetaLength\r\n\t\t\t\t\t\t\t);\r\n\t\r\n\t\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\t\tcase 'SphereGeometry':\r\n\t\r\n\t\t\t\t\t\t\tgeometry = new THREE.SphereGeometry(\r\n\t\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\t\tdata.widthSegments,\r\n\t\t\t\t\t\t\t\tdata.heightSegments,\r\n\t\t\t\t\t\t\t\tdata.phiStart,\r\n\t\t\t\t\t\t\t\tdata.phiLength,\r\n\t\t\t\t\t\t\t\tdata.thetaStart,\r\n\t\t\t\t\t\t\t\tdata.thetaLength\r\n\t\t\t\t\t\t\t);\r\n\t\r\n\t\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\t\tcase 'SphereBufferGeometry':\r\n\t\r\n\t\t\t\t\t\t\tgeometry = new THREE.SphereBufferGeometry(\r\n\t\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\t\tdata.widthSegments,\r\n\t\t\t\t\t\t\t\tdata.heightSegments,\r\n\t\t\t\t\t\t\t\tdata.phiStart,\r\n\t\t\t\t\t\t\t\tdata.phiLength,\r\n\t\t\t\t\t\t\t\tdata.thetaStart,\r\n\t\t\t\t\t\t\t\tdata.thetaLength\r\n\t\t\t\t\t\t\t);\r\n\t\r\n\t\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\t\tcase 'DodecahedronGeometry':\r\n\t\r\n\t\t\t\t\t\t\tgeometry = new THREE.DodecahedronGeometry(\r\n\t\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\t\tdata.detail\r\n\t\t\t\t\t\t\t);\r\n\t\r\n\t\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\t\tcase 'IcosahedronGeometry':\r\n\t\r\n\t\t\t\t\t\t\tgeometry = new THREE.IcosahedronGeometry(\r\n\t\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\t\tdata.detail\r\n\t\t\t\t\t\t\t);\r\n\t\r\n\t\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\t\tcase 'OctahedronGeometry':\r\n\t\r\n\t\t\t\t\t\t\tgeometry = new THREE.OctahedronGeometry(\r\n\t\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\t\tdata.detail\r\n\t\t\t\t\t\t\t);\r\n\t\r\n\t\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\t\tcase 'TetrahedronGeometry':\r\n\t\r\n\t\t\t\t\t\t\tgeometry = new THREE.TetrahedronGeometry(\r\n\t\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\t\tdata.detail\r\n\t\t\t\t\t\t\t);\r\n\t\r\n\t\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\t\tcase 'RingGeometry':\r\n\t\r\n\t\t\t\t\t\t\tgeometry = new THREE.RingGeometry(\r\n\t\t\t\t\t\t\t\tdata.innerRadius,\r\n\t\t\t\t\t\t\t\tdata.outerRadius,\r\n\t\t\t\t\t\t\t\tdata.thetaSegments,\r\n\t\t\t\t\t\t\t\tdata.phiSegments,\r\n\t\t\t\t\t\t\t\tdata.thetaStart,\r\n\t\t\t\t\t\t\t\tdata.thetaLength\r\n\t\t\t\t\t\t\t);\r\n\t\r\n\t\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\t\tcase 'TorusGeometry':\r\n\t\r\n\t\t\t\t\t\t\tgeometry = new THREE.TorusGeometry(\r\n\t\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\t\tdata.tube,\r\n\t\t\t\t\t\t\t\tdata.radialSegments,\r\n\t\t\t\t\t\t\t\tdata.tubularSegments,\r\n\t\t\t\t\t\t\t\tdata.arc\r\n\t\t\t\t\t\t\t);\r\n\t\r\n\t\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\t\tcase 'TorusKnotGeometry':\r\n\t\r\n\t\t\t\t\t\t\tgeometry = new THREE.TorusKnotGeometry(\r\n\t\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\t\tdata.tube,\r\n\t\t\t\t\t\t\t\tdata.radialSegments,\r\n\t\t\t\t\t\t\t\tdata.tubularSegments,\r\n\t\t\t\t\t\t\t\tdata.p,\r\n\t\t\t\t\t\t\t\tdata.q,\r\n\t\t\t\t\t\t\t\tdata.heightScale\r\n\t\t\t\t\t\t\t);\r\n\t\r\n\t\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\t\tcase 'BufferGeometry':\r\n\t\r\n\t\t\t\t\t\t\tgeometry = bufferGeometryLoader.parse( data );\r\n\t\r\n\t\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\t\tcase 'Geometry':\r\n\t\r\n\t\t\t\t\t\t\tgeometry = geometryLoader.parse( data.data, this.texturePath ).geometry;\r\n\t\r\n\t\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\t\tdefault:\r\n\t\r\n\t\t\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Unsupported geometry type \"' + data.type + '\"' );\r\n\t\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tgeometry.uuid = data.uuid;\r\n\t\r\n\t\t\t\t\tif ( data.name !== undefined ) geometry.name = data.name;\r\n\t\r\n\t\t\t\t\tgeometries[ data.uuid ] = geometry;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn geometries;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tparseMaterials: function ( json, textures ) {\r\n\t\r\n\t\t\tvar materials = {};\r\n\t\r\n\t\t\tif ( json !== undefined ) {\r\n\t\r\n\t\t\t\tvar loader = new THREE.MaterialLoader();\r\n\t\t\t\tloader.setTextures( textures );\r\n\t\r\n\t\t\t\tfor ( var i = 0, l = json.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\t\tvar material = loader.parse( json[ i ] );\r\n\t\t\t\t\tmaterials[ material.uuid ] = material;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn materials;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tparseAnimations: function ( json ) {\r\n\t\r\n\t\t\tvar animations = [];\r\n\t\r\n\t\t\tfor ( var i = 0; i < json.length; i ++ ) {\r\n\t\r\n\t\t\t\tvar clip = THREE.AnimationClip.parse( json[i] );\r\n\t\r\n\t\t\t\tanimations.push( clip );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn animations;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tparseImages: function ( json, onLoad ) {\r\n\t\r\n\t\t\tvar scope = this;\r\n\t\t\tvar images = {};\r\n\t\r\n\t\t\tfunction loadImage( url ) {\r\n\t\r\n\t\t\t\tscope.manager.itemStart( url );\r\n\t\r\n\t\t\t\treturn loader.load( url, function () {\r\n\t\r\n\t\t\t\t\tscope.manager.itemEnd( url );\r\n\t\r\n\t\t\t\t} );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( json !== undefined && json.length > 0 ) {\r\n\t\r\n\t\t\t\tvar manager = new THREE.LoadingManager( onLoad );\r\n\t\r\n\t\t\t\tvar loader = new THREE.ImageLoader( manager );\r\n\t\t\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\t\r\n\t\t\t\tfor ( var i = 0, l = json.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\t\tvar image = json[ i ];\r\n\t\t\t\t\tvar path = /^(\\/\\/)|([a-z]+:(\\/\\/)?)/i.test( image.url ) ? image.url : scope.texturePath + image.url;\r\n\t\r\n\t\t\t\t\timages[ image.uuid ] = loadImage( path );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn images;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tparseTextures: function ( json, images ) {\r\n\t\r\n\t\t\tfunction parseConstant( value ) {\r\n\t\r\n\t\t\t\tif ( typeof( value ) === 'number' ) return value;\r\n\t\r\n\t\t\t\tconsole.warn( 'THREE.ObjectLoader.parseTexture: Constant should be in numeric form.', value );\r\n\t\r\n\t\t\t\treturn THREE[ value ];\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar textures = {};\r\n\t\r\n\t\t\tif ( json !== undefined ) {\r\n\t\r\n\t\t\t\tfor ( var i = 0, l = json.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\t\tvar data = json[ i ];\r\n\t\r\n\t\t\t\t\tif ( data.image === undefined ) {\r\n\t\r\n\t\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: No \"image\" specified for', data.uuid );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tif ( images[ data.image ] === undefined ) {\r\n\t\r\n\t\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined image', data.image );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tvar texture = new THREE.Texture( images[ data.image ] );\r\n\t\t\t\t\ttexture.needsUpdate = true;\r\n\t\r\n\t\t\t\t\ttexture.uuid = data.uuid;\r\n\t\r\n\t\t\t\t\tif ( data.name !== undefined ) texture.name = data.name;\r\n\t\t\t\t\tif ( data.mapping !== undefined ) texture.mapping = parseConstant( data.mapping );\r\n\t\t\t\t\tif ( data.offset !== undefined ) texture.offset = new THREE.Vector2( data.offset[ 0 ], data.offset[ 1 ] );\r\n\t\t\t\t\tif ( data.repeat !== undefined ) texture.repeat = new THREE.Vector2( data.repeat[ 0 ], data.repeat[ 1 ] );\r\n\t\t\t\t\tif ( data.minFilter !== undefined ) texture.minFilter = parseConstant( data.minFilter );\r\n\t\t\t\t\tif ( data.magFilter !== undefined ) texture.magFilter = parseConstant( data.magFilter );\r\n\t\t\t\t\tif ( data.anisotropy !== undefined ) texture.anisotropy = data.anisotropy;\r\n\t\t\t\t\tif ( Array.isArray( data.wrap ) ) {\r\n\t\r\n\t\t\t\t\t\ttexture.wrapS = parseConstant( data.wrap[ 0 ] );\r\n\t\t\t\t\t\ttexture.wrapT = parseConstant( data.wrap[ 1 ] );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\ttextures[ data.uuid ] = texture;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn textures;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tparseObject: function () {\r\n\t\r\n\t\t\tvar matrix = new THREE.Matrix4();\r\n\t\r\n\t\t\treturn function ( data, geometries, materials ) {\r\n\t\r\n\t\t\t\tvar object;\r\n\t\r\n\t\t\t\tfunction getGeometry( name ) {\r\n\t\r\n\t\t\t\t\tif ( geometries[ name ] === undefined ) {\r\n\t\r\n\t\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined geometry', name );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\treturn geometries[ name ];\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tfunction getMaterial( name ) {\r\n\t\r\n\t\t\t\t\tif ( name === undefined ) return undefined;\r\n\t\r\n\t\t\t\t\tif ( materials[ name ] === undefined ) {\r\n\t\r\n\t\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined material', name );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\treturn materials[ name ];\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tswitch ( data.type ) {\r\n\t\r\n\t\t\t\t\tcase 'Scene':\r\n\t\r\n\t\t\t\t\t\tobject = new THREE.Scene();\r\n\t\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase 'PerspectiveCamera':\r\n\t\r\n\t\t\t\t\t\tobject = new THREE.PerspectiveCamera( data.fov, data.aspect, data.near, data.far );\r\n\t\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase 'OrthographicCamera':\r\n\t\r\n\t\t\t\t\t\tobject = new THREE.OrthographicCamera( data.left, data.right, data.top, data.bottom, data.near, data.far );\r\n\t\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase 'AmbientLight':\r\n\t\r\n\t\t\t\t\t\tobject = new THREE.AmbientLight( data.color );\r\n\t\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase 'DirectionalLight':\r\n\t\r\n\t\t\t\t\t\tobject = new THREE.DirectionalLight( data.color, data.intensity );\r\n\t\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase 'PointLight':\r\n\t\r\n\t\t\t\t\t\tobject = new THREE.PointLight( data.color, data.intensity, data.distance, data.decay );\r\n\t\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase 'SpotLight':\r\n\t\r\n\t\t\t\t\t\tobject = new THREE.SpotLight( data.color, data.intensity, data.distance, data.angle, data.exponent, data.decay );\r\n\t\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase 'HemisphereLight':\r\n\t\r\n\t\t\t\t\t\tobject = new THREE.HemisphereLight( data.color, data.groundColor, data.intensity );\r\n\t\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase 'Mesh':\r\n\t\r\n\t\t\t\t\t\tobject = new THREE.Mesh( getGeometry( data.geometry ), getMaterial( data.material ) );\r\n\t\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase 'LOD':\r\n\t\r\n\t\t\t\t\t\tobject = new THREE.LOD();\r\n\t\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase 'Line':\r\n\t\r\n\t\t\t\t\t\tobject = new THREE.Line( getGeometry( data.geometry ), getMaterial( data.material ), data.mode );\r\n\t\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase 'PointCloud':\r\n\t\t\t\t\tcase 'Points':\r\n\t\r\n\t\t\t\t\t\tobject = new THREE.Points( getGeometry( data.geometry ), getMaterial( data.material ) );\r\n\t\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase 'Sprite':\r\n\t\r\n\t\t\t\t\t\tobject = new THREE.Sprite( getMaterial( data.material ) );\r\n\t\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase 'Group':\r\n\t\r\n\t\t\t\t\t\tobject = new THREE.Group();\r\n\t\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tdefault:\r\n\t\r\n\t\t\t\t\t\tobject = new THREE.Object3D();\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tobject.uuid = data.uuid;\r\n\t\r\n\t\t\t\tif ( data.name !== undefined ) object.name = data.name;\r\n\t\t\t\tif ( data.matrix !== undefined ) {\r\n\t\r\n\t\t\t\t\tmatrix.fromArray( data.matrix );\r\n\t\t\t\t\tmatrix.decompose( object.position, object.quaternion, object.scale );\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tif ( data.position !== undefined ) object.position.fromArray( data.position );\r\n\t\t\t\t\tif ( data.rotation !== undefined ) object.rotation.fromArray( data.rotation );\r\n\t\t\t\t\tif ( data.scale !== undefined ) object.scale.fromArray( data.scale );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( data.castShadow !== undefined ) object.castShadow = data.castShadow;\r\n\t\t\t\tif ( data.receiveShadow !== undefined ) object.receiveShadow = data.receiveShadow;\r\n\t\r\n\t\t\t\tif ( data.visible !== undefined ) object.visible = data.visible;\r\n\t\t\t\tif ( data.userData !== undefined ) object.userData = data.userData;\r\n\t\r\n\t\t\t\tif ( data.children !== undefined ) {\r\n\t\r\n\t\t\t\t\tfor ( var child in data.children ) {\r\n\t\r\n\t\t\t\t\t\tobject.add( this.parseObject( data.children[ child ], geometries, materials ) );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( data.type === 'LOD' ) {\r\n\t\r\n\t\t\t\t\tvar levels = data.levels;\r\n\t\r\n\t\t\t\t\tfor ( var l = 0; l < levels.length; l ++ ) {\r\n\t\r\n\t\t\t\t\t\tvar level = levels[ l ];\r\n\t\t\t\t\t\tvar child = object.getObjectByProperty( 'uuid', level.object );\r\n\t\r\n\t\t\t\t\t\tif ( child !== undefined ) {\r\n\t\r\n\t\t\t\t\t\t\tobject.addLevel( child, level.distance );\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\treturn object;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}()\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/loaders/TextureLoader.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.TextureLoader = function ( manager ) {\r\n\t\r\n\t\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.TextureLoader.prototype = {\r\n\t\r\n\t\tconstructor: THREE.TextureLoader,\r\n\t\r\n\t\tload: function ( url, onLoad, onProgress, onError ) {\r\n\t\r\n\t\t\tvar texture = new THREE.Texture();\r\n\t\r\n\t\t\tvar loader = new THREE.ImageLoader( this.manager );\r\n\t\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\t\t\tloader.load( url, function ( image ) {\r\n\t\r\n\t\t\t\ttexture.image = image;\r\n\t\t\t\ttexture.needsUpdate = true;\r\n\t\r\n\t\t\t\tif ( onLoad !== undefined ) {\r\n\t\r\n\t\t\t\t\tonLoad( texture );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}, onProgress, onError );\r\n\t\r\n\t\t\treturn texture;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetCrossOrigin: function ( value ) {\r\n\t\r\n\t\t\tthis.crossOrigin = value;\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/loaders/CubeTextureLoader.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.CubeTextureLoader = function ( manager ) {\r\n\t\r\n\t\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.CubeTextureLoader.prototype = {\r\n\t\r\n\t\tconstructor: THREE.CubeTextureLoader,\r\n\t\r\n\t\tload: function ( urls, onLoad, onProgress, onError ) {\r\n\t\r\n\t\t\tvar texture = new THREE.CubeTexture( [] );\r\n\t\r\n\t\t\tvar loader = new THREE.ImageLoader();\r\n\t\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\t\r\n\t\t\tvar loaded = 0;\r\n\t\r\n\t\t\tfunction loadTexture( i ) {\r\n\t\r\n\t\t\t\tloader.load( urls[ i ], function ( image ) {\r\n\t\r\n\t\t\t\t\ttexture.images[ i ] = image;\r\n\t\r\n\t\t\t\t\tloaded ++;\r\n\t\r\n\t\t\t\t\tif ( loaded === 6 ) {\r\n\t\r\n\t\t\t\t\t\ttexture.needsUpdate = true;\r\n\t\r\n\t\t\t\t\t\tif ( onLoad ) onLoad( texture );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}, undefined, onError );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tfor ( var i = 0; i < urls.length; ++ i ) {\r\n\t\r\n\t\t\t\tloadTexture( i );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn texture;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetCrossOrigin: function ( value ) {\r\n\t\r\n\t\t\tthis.crossOrigin = value;\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/loaders/BinaryTextureLoader.js\r\n\t\r\n\t/**\r\n\t * @author Nikos M. / https://github.com/foo123/\r\n\t *\r\n\t * Abstract Base class to load generic binary textures formats (rgbe, hdr, ...)\r\n\t */\r\n\t\r\n\tTHREE.DataTextureLoader = THREE.BinaryTextureLoader = function ( manager ) {\r\n\t\r\n\t\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\t\r\n\t\t// override in sub classes\r\n\t\tthis._parser = null;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.BinaryTextureLoader.prototype = {\r\n\t\r\n\t\tconstructor: THREE.BinaryTextureLoader,\r\n\t\r\n\t\tload: function ( url, onLoad, onProgress, onError ) {\r\n\t\r\n\t\t\tvar scope = this;\r\n\t\r\n\t\t\tvar texture = new THREE.DataTexture();\r\n\t\r\n\t\t\tvar loader = new THREE.XHRLoader( this.manager );\r\n\t\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\t\t\tloader.setResponseType( 'arraybuffer' );\r\n\t\r\n\t\t\tloader.load( url, function ( buffer ) {\r\n\t\r\n\t\t\t\tvar texData = scope._parser( buffer );\r\n\t\r\n\t\t\t\tif ( ! texData ) return;\r\n\t\r\n\t\t\t\tif ( undefined !== texData.image ) {\r\n\t\r\n\t\t\t\t\ttexture.image = texData.image;\r\n\t\r\n\t\t\t\t} else if ( undefined !== texData.data ) {\r\n\t\r\n\t\t\t\t\ttexture.image.width = texData.width;\r\n\t\t\t\t\ttexture.image.height = texData.height;\r\n\t\t\t\t\ttexture.image.data = texData.data;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\ttexture.wrapS = undefined !== texData.wrapS ? texData.wrapS : THREE.ClampToEdgeWrapping;\r\n\t\t\t\ttexture.wrapT = undefined !== texData.wrapT ? texData.wrapT : THREE.ClampToEdgeWrapping;\r\n\t\r\n\t\t\t\ttexture.magFilter = undefined !== texData.magFilter ? texData.magFilter : THREE.LinearFilter;\r\n\t\t\t\ttexture.minFilter = undefined !== texData.minFilter ? texData.minFilter : THREE.LinearMipMapLinearFilter;\r\n\t\r\n\t\t\t\ttexture.anisotropy = undefined !== texData.anisotropy ? texData.anisotropy : 1;\r\n\t\r\n\t\t\t\tif ( undefined !== texData.format ) {\r\n\t\r\n\t\t\t\t\ttexture.format = texData.format;\r\n\t\r\n\t\t\t\t}\r\n\t\t\t\tif ( undefined !== texData.type ) {\r\n\t\r\n\t\t\t\t\ttexture.type = texData.type;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( undefined !== texData.mipmaps ) {\r\n\t\r\n\t\t\t\t\ttexture.mipmaps = texData.mipmaps;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( 1 === texData.mipmapCount ) {\r\n\t\r\n\t\t\t\t\ttexture.minFilter = THREE.LinearFilter;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\ttexture.needsUpdate = true;\r\n\t\r\n\t\t\t\tif ( onLoad ) onLoad( texture, texData );\r\n\t\r\n\t\t\t}, onProgress, onError );\r\n\t\r\n\t\r\n\t\t\treturn texture;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetCrossOrigin: function ( value ) {\r\n\t\r\n\t\t\tthis.crossOrigin = value;\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/loaders/CompressedTextureLoader.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t *\r\n\t * Abstract Base class to block based textures loader (dds, pvr, ...)\r\n\t */\r\n\t\r\n\tTHREE.CompressedTextureLoader = function ( manager ) {\r\n\t\r\n\t\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\t\r\n\t\t// override in sub classes\r\n\t\tthis._parser = null;\r\n\t\r\n\t};\r\n\t\r\n\t\r\n\tTHREE.CompressedTextureLoader.prototype = {\r\n\t\r\n\t\tconstructor: THREE.CompressedTextureLoader,\r\n\t\r\n\t\tload: function ( url, onLoad, onProgress, onError ) {\r\n\t\r\n\t\t\tvar scope = this;\r\n\t\r\n\t\t\tvar images = [];\r\n\t\r\n\t\t\tvar texture = new THREE.CompressedTexture();\r\n\t\t\ttexture.image = images;\r\n\t\r\n\t\t\tvar loader = new THREE.XHRLoader( this.manager );\r\n\t\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\t\t\tloader.setResponseType( 'arraybuffer' );\r\n\t\r\n\t\t\tif ( Array.isArray( url ) ) {\r\n\t\r\n\t\t\t\tvar loaded = 0;\r\n\t\r\n\t\t\t\tvar loadTexture = function ( i ) {\r\n\t\r\n\t\t\t\t\tloader.load( url[ i ], function ( buffer ) {\r\n\t\r\n\t\t\t\t\t\tvar texDatas = scope._parser( buffer, true );\r\n\t\r\n\t\t\t\t\t\timages[ i ] = {\r\n\t\t\t\t\t\t\twidth: texDatas.width,\r\n\t\t\t\t\t\t\theight: texDatas.height,\r\n\t\t\t\t\t\t\tformat: texDatas.format,\r\n\t\t\t\t\t\t\tmipmaps: texDatas.mipmaps\r\n\t\t\t\t\t\t};\r\n\t\r\n\t\t\t\t\t\tloaded += 1;\r\n\t\r\n\t\t\t\t\t\tif ( loaded === 6 ) {\r\n\t\r\n\t\t\t\t\t\t\tif ( texDatas.mipmapCount === 1 )\r\n\t \t\t\t\t\t\t\ttexture.minFilter = THREE.LinearFilter;\r\n\t\r\n\t\t\t\t\t\t\ttexture.format = texDatas.format;\r\n\t\t\t\t\t\t\ttexture.needsUpdate = true;\r\n\t\r\n\t\t\t\t\t\t\tif ( onLoad ) onLoad( texture );\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t}, onProgress, onError );\r\n\t\r\n\t\t\t\t};\r\n\t\r\n\t\t\t\tfor ( var i = 0, il = url.length; i < il; ++ i ) {\r\n\t\r\n\t\t\t\t\tloadTexture( i );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\t// compressed cubemap texture stored in a single DDS file\r\n\t\r\n\t\t\t\tloader.load( url, function ( buffer ) {\r\n\t\r\n\t\t\t\t\tvar texDatas = scope._parser( buffer, true );\r\n\t\r\n\t\t\t\t\tif ( texDatas.isCubemap ) {\r\n\t\r\n\t\t\t\t\t\tvar faces = texDatas.mipmaps.length / texDatas.mipmapCount;\r\n\t\r\n\t\t\t\t\t\tfor ( var f = 0; f < faces; f ++ ) {\r\n\t\r\n\t\t\t\t\t\t\timages[ f ] = { mipmaps : [] };\r\n\t\r\n\t\t\t\t\t\t\tfor ( var i = 0; i < texDatas.mipmapCount; i ++ ) {\r\n\t\r\n\t\t\t\t\t\t\t\timages[ f ].mipmaps.push( texDatas.mipmaps[ f * texDatas.mipmapCount + i ] );\r\n\t\t\t\t\t\t\t\timages[ f ].format = texDatas.format;\r\n\t\t\t\t\t\t\t\timages[ f ].width = texDatas.width;\r\n\t\t\t\t\t\t\t\timages[ f ].height = texDatas.height;\r\n\t\r\n\t\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\ttexture.image.width = texDatas.width;\r\n\t\t\t\t\t\ttexture.image.height = texDatas.height;\r\n\t\t\t\t\t\ttexture.mipmaps = texDatas.mipmaps;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tif ( texDatas.mipmapCount === 1 ) {\r\n\t\r\n\t\t\t\t\t\ttexture.minFilter = THREE.LinearFilter;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\ttexture.format = texDatas.format;\r\n\t\t\t\t\ttexture.needsUpdate = true;\r\n\t\r\n\t\t\t\t\tif ( onLoad ) onLoad( texture );\r\n\t\r\n\t\t\t\t}, onProgress, onError );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn texture;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetCrossOrigin: function ( value ) {\r\n\t\r\n\t\t\tthis.crossOrigin = value;\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/materials/Material.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\t\r\n\tTHREE.Material = function () {\r\n\t\r\n\t\tObject.defineProperty( this, 'id', { value: THREE.MaterialIdCount ++ } );\r\n\t\r\n\t\tthis.uuid = THREE.Math.generateUUID();\r\n\t\r\n\t\tthis.name = '';\r\n\t\tthis.type = 'Material';\r\n\t\r\n\t\tthis.side = THREE.FrontSide;\r\n\t\r\n\t\tthis.opacity = 1;\r\n\t\tthis.transparent = false;\r\n\t\r\n\t\tthis.blending = THREE.NormalBlending;\r\n\t\r\n\t\tthis.blendSrc = THREE.SrcAlphaFactor;\r\n\t\tthis.blendDst = THREE.OneMinusSrcAlphaFactor;\r\n\t\tthis.blendEquation = THREE.AddEquation;\r\n\t\tthis.blendSrcAlpha = null;\r\n\t\tthis.blendDstAlpha = null;\r\n\t\tthis.blendEquationAlpha = null;\r\n\t\r\n\t\tthis.depthFunc = THREE.LessEqualDepth;\r\n\t\tthis.depthTest = true;\r\n\t\tthis.depthWrite = true;\r\n\t\r\n\t\tthis.colorWrite = true;\r\n\t\r\n\t\tthis.precision = null; // override the renderer's default precision for this material\r\n\t\r\n\t\tthis.polygonOffset = false;\r\n\t\tthis.polygonOffsetFactor = 0;\r\n\t\tthis.polygonOffsetUnits = 0;\r\n\t\r\n\t\tthis.alphaTest = 0;\r\n\t\r\n\t\tthis.overdraw = 0; // Overdrawn pixels (typically between 0 and 1) for fixing antialiasing gaps in CanvasRenderer\r\n\t\r\n\t\tthis.visible = true;\r\n\t\r\n\t\tthis._needsUpdate = true;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Material.prototype = {\r\n\t\r\n\t\tconstructor: THREE.Material,\r\n\t\r\n\t\tget needsUpdate () {\r\n\t\r\n\t\t\treturn this._needsUpdate;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tset needsUpdate ( value ) {\r\n\t\r\n\t\t\tif ( value === true ) this.update();\r\n\t\r\n\t\t\tthis._needsUpdate = value;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tsetValues: function ( values ) {\r\n\t\r\n\t\t\tif ( values === undefined ) return;\r\n\t\r\n\t\t\tfor ( var key in values ) {\r\n\t\r\n\t\t\t\tvar newValue = values[ key ];\r\n\t\r\n\t\t\t\tif ( newValue === undefined ) {\r\n\t\r\n\t\t\t\t\tconsole.warn( \"THREE.Material: '\" + key + \"' parameter is undefined.\" );\r\n\t\t\t\t\tcontinue;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tvar currentValue = this[ key ];\r\n\t\r\n\t\t\t\tif ( currentValue === undefined ) {\r\n\t\r\n\t\t\t\t\tconsole.warn( \"THREE.\" + this.type + \": '\" + key + \"' is not a property of this material.\" );\r\n\t\t\t\t\tcontinue;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( currentValue instanceof THREE.Color ) {\r\n\t\r\n\t\t\t\t\tcurrentValue.set( newValue );\r\n\t\r\n\t\t\t\t} else if ( currentValue instanceof THREE.Vector3 && newValue instanceof THREE.Vector3 ) {\r\n\t\r\n\t\t\t\t\tcurrentValue.copy( newValue );\r\n\t\r\n\t\t\t\t} else if ( key === 'overdraw' ) {\r\n\t\r\n\t\t\t\t\t// ensure overdraw is backwards-compatible with legacy boolean type\r\n\t\t\t\t\tthis[ key ] = Number( newValue );\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tthis[ key ] = newValue;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t},\r\n\t\r\n\t\ttoJSON: function ( meta ) {\r\n\t\r\n\t\t\tvar data = {\r\n\t\t\t\tmetadata: {\r\n\t\t\t\t\tversion: 4.4,\r\n\t\t\t\t\ttype: 'Material',\r\n\t\t\t\t\tgenerator: 'Material.toJSON'\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\r\n\t\t\t// standard Material serialization\r\n\t\t\tdata.uuid = this.uuid;\r\n\t\t\tdata.type = this.type;\r\n\t\t\tif ( this.name !== '' ) data.name = this.name;\r\n\t\r\n\t\t\tif ( this.color instanceof THREE.Color ) data.color = this.color.getHex();\r\n\t\t\tif ( this.emissive instanceof THREE.Color ) data.emissive = this.emissive.getHex();\r\n\t\t\tif ( this.specular instanceof THREE.Color ) data.specular = this.specular.getHex();\r\n\t\t\tif ( this.shininess !== undefined ) data.shininess = this.shininess;\r\n\t\r\n\t\t\tif ( this.map instanceof THREE.Texture ) data.map = this.map.toJSON( meta ).uuid;\r\n\t\t\tif ( this.alphaMap instanceof THREE.Texture ) data.alphaMap = this.alphaMap.toJSON( meta ).uuid;\r\n\t\t\tif ( this.lightMap instanceof THREE.Texture ) data.lightMap = this.lightMap.toJSON( meta ).uuid;\r\n\t\t\tif ( this.bumpMap instanceof THREE.Texture ) {\r\n\t\r\n\t\t\t\tdata.bumpMap = this.bumpMap.toJSON( meta ).uuid;\r\n\t\t\t\tdata.bumpScale = this.bumpScale;\r\n\t\r\n\t\t\t}\r\n\t\t\tif ( this.normalMap instanceof THREE.Texture ) {\r\n\t\r\n\t\t\t\tdata.normalMap = this.normalMap.toJSON( meta ).uuid;\r\n\t\t\t\tdata.normalScale = this.normalScale; // Removed for now, causes issue in editor ui.js\r\n\t\r\n\t\t\t}\r\n\t\t\tif ( this.displacementMap instanceof THREE.Texture ) {\r\n\t\r\n\t\t\t\tdata.displacementMap = this.displacementMap.toJSON( meta ).uuid;\r\n\t\t\t\tdata.displacementScale = this.displacementScale;\r\n\t\t\t\tdata.displacementBias = this.displacementBias;\r\n\t\r\n\t\t\t}\r\n\t\t\tif ( this.specularMap instanceof THREE.Texture ) data.specularMap = this.specularMap.toJSON( meta ).uuid;\r\n\t\t\tif ( this.envMap instanceof THREE.Texture ) {\r\n\t\r\n\t\t\t\tdata.envMap = this.envMap.toJSON( meta ).uuid;\r\n\t\t\t\tdata.reflectivity = this.reflectivity; // Scale behind envMap\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( this.size !== undefined ) data.size = this.size;\r\n\t\t\tif ( this.sizeAttenuation !== undefined ) data.sizeAttenuation = this.sizeAttenuation;\r\n\t\r\n\t\t\tif ( this.vertexColors !== undefined && this.vertexColors !== THREE.NoColors ) data.vertexColors = this.vertexColors;\r\n\t\t\tif ( this.shading !== undefined && this.shading !== THREE.SmoothShading ) data.shading = this.shading;\r\n\t\t\tif ( this.blending !== undefined && this.blending !== THREE.NormalBlending ) data.blending = this.blending;\r\n\t\t\tif ( this.side !== undefined && this.side !== THREE.FrontSide ) data.side = this.side;\r\n\t\r\n\t\t\tif ( this.opacity < 1 ) data.opacity = this.opacity;\r\n\t\t\tif ( this.transparent === true ) data.transparent = this.transparent;\r\n\t\t\tif ( this.alphaTest > 0 ) data.alphaTest = this.alphaTest;\r\n\t\t\tif ( this.wireframe === true ) data.wireframe = this.wireframe;\r\n\t\t\tif ( this.wireframeLinewidth > 1 ) data.wireframeLinewidth = this.wireframeLinewidth;\r\n\t\r\n\t\t\treturn data;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tclone: function () {\r\n\t\r\n\t\t\treturn new this.constructor().copy( this );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcopy: function ( source ) {\r\n\t\r\n\t\t\tthis.name = source.name;\r\n\t\r\n\t\t\tthis.side = source.side;\r\n\t\r\n\t\t\tthis.opacity = source.opacity;\r\n\t\t\tthis.transparent = source.transparent;\r\n\t\r\n\t\t\tthis.blending = source.blending;\r\n\t\r\n\t\t\tthis.blendSrc = source.blendSrc;\r\n\t\t\tthis.blendDst = source.blendDst;\r\n\t\t\tthis.blendEquation = source.blendEquation;\r\n\t\t\tthis.blendSrcAlpha = source.blendSrcAlpha;\r\n\t\t\tthis.blendDstAlpha = source.blendDstAlpha;\r\n\t\t\tthis.blendEquationAlpha = source.blendEquationAlpha;\r\n\t\r\n\t\t\tthis.depthFunc = source.depthFunc;\r\n\t\t\tthis.depthTest = source.depthTest;\r\n\t\t\tthis.depthWrite = source.depthWrite;\r\n\t\r\n\t\t\tthis.precision = source.precision;\r\n\t\r\n\t\t\tthis.polygonOffset = source.polygonOffset;\r\n\t\t\tthis.polygonOffsetFactor = source.polygonOffsetFactor;\r\n\t\t\tthis.polygonOffsetUnits = source.polygonOffsetUnits;\r\n\t\r\n\t\t\tthis.alphaTest = source.alphaTest;\r\n\t\r\n\t\t\tthis.overdraw = source.overdraw;\r\n\t\r\n\t\t\tthis.visible = source.visible;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tupdate: function () {\r\n\t\r\n\t\t\tthis.dispatchEvent( { type: 'update' } );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tdispose: function () {\r\n\t\r\n\t\t\tthis.dispatchEvent( { type: 'dispose' } );\r\n\t\r\n\t\t},\r\n\t\r\n\t\t// Deprecated\r\n\t\r\n\t\tget wrapAround () {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.' + this.type + ': .wrapAround has been removed.' );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tset wrapAround ( boolean ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.' + this.type + ': .wrapAround has been removed.' );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tget wrapRGB () {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.' + this.type + ': .wrapRGB has been removed.' );\r\n\t\t\treturn new THREE.Color();\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.EventDispatcher.prototype.apply( THREE.Material.prototype );\r\n\t\r\n\tTHREE.MaterialIdCount = 0;\r\n\t\r\n\t// File:src/materials/LineBasicMaterial.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t *\r\n\t * parameters = {\r\n\t *  color: <hex>,\r\n\t *  opacity: <float>,\r\n\t *\r\n\t *  blending: THREE.NormalBlending,\r\n\t *  depthTest: <bool>,\r\n\t *  depthWrite: <bool>,\r\n\t *\r\n\t *  linewidth: <float>,\r\n\t *  linecap: \"round\",\r\n\t *  linejoin: \"round\",\r\n\t *\r\n\t *  vertexColors: <bool>\r\n\t *\r\n\t *  fog: <bool>\r\n\t * }\r\n\t */\r\n\t\r\n\tTHREE.LineBasicMaterial = function ( parameters ) {\r\n\t\r\n\t\tTHREE.Material.call( this );\r\n\t\r\n\t\tthis.type = 'LineBasicMaterial';\r\n\t\r\n\t\tthis.color = new THREE.Color( 0xffffff );\r\n\t\r\n\t\tthis.linewidth = 1;\r\n\t\tthis.linecap = 'round';\r\n\t\tthis.linejoin = 'round';\r\n\t\r\n\t\tthis.vertexColors = THREE.NoColors;\r\n\t\r\n\t\tthis.fog = true;\r\n\t\r\n\t\tthis.setValues( parameters );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.LineBasicMaterial.prototype = Object.create( THREE.Material.prototype );\r\n\tTHREE.LineBasicMaterial.prototype.constructor = THREE.LineBasicMaterial;\r\n\t\r\n\tTHREE.LineBasicMaterial.prototype.copy = function ( source ) {\r\n\t\r\n\t\tTHREE.Material.prototype.copy.call( this, source );\r\n\t\r\n\t\tthis.color.copy( source.color );\r\n\t\r\n\t\tthis.linewidth = source.linewidth;\r\n\t\tthis.linecap = source.linecap;\r\n\t\tthis.linejoin = source.linejoin;\r\n\t\r\n\t\tthis.vertexColors = source.vertexColors;\r\n\t\r\n\t\tthis.fog = source.fog;\r\n\t\r\n\t\treturn this;\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/materials/LineDashedMaterial.js\r\n\t\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t *\r\n\t * parameters = {\r\n\t *  color: <hex>,\r\n\t *  opacity: <float>,\r\n\t *\r\n\t *  blending: THREE.NormalBlending,\r\n\t *  depthTest: <bool>,\r\n\t *  depthWrite: <bool>,\r\n\t *\r\n\t *  linewidth: <float>,\r\n\t *\r\n\t *  scale: <float>,\r\n\t *  dashSize: <float>,\r\n\t *  gapSize: <float>,\r\n\t *\r\n\t *  vertexColors: <bool>\r\n\t *\r\n\t *  fog: <bool>\r\n\t * }\r\n\t */\r\n\t\r\n\tTHREE.LineDashedMaterial = function ( parameters ) {\r\n\t\r\n\t\tTHREE.Material.call( this );\r\n\t\r\n\t\tthis.type = 'LineDashedMaterial';\r\n\t\r\n\t\tthis.color = new THREE.Color( 0xffffff );\r\n\t\r\n\t\tthis.linewidth = 1;\r\n\t\r\n\t\tthis.scale = 1;\r\n\t\tthis.dashSize = 3;\r\n\t\tthis.gapSize = 1;\r\n\t\r\n\t\tthis.vertexColors = false;\r\n\t\r\n\t\tthis.fog = true;\r\n\t\r\n\t\tthis.setValues( parameters );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.LineDashedMaterial.prototype = Object.create( THREE.Material.prototype );\r\n\tTHREE.LineDashedMaterial.prototype.constructor = THREE.LineDashedMaterial;\r\n\t\r\n\tTHREE.LineDashedMaterial.prototype.copy = function ( source ) {\r\n\t\r\n\t\tTHREE.Material.prototype.copy.call( this, source );\r\n\t\r\n\t\tthis.color.copy( source.color );\r\n\t\t\r\n\t\tthis.linewidth = source.linewidth;\r\n\t\r\n\t\tthis.scale = source.scale;\r\n\t\tthis.dashSize = source.dashSize;\r\n\t\tthis.gapSize = source.gapSize;\r\n\t\r\n\t\tthis.vertexColors = source.vertexColors;\r\n\t\r\n\t\tthis.fog = source.fog;\r\n\t\r\n\t\treturn this;\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/materials/MeshBasicMaterial.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t *\r\n\t * parameters = {\r\n\t *  color: <hex>,\r\n\t *  opacity: <float>,\r\n\t *  map: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  aoMap: new THREE.Texture( <Image> ),\r\n\t *  aoMapIntensity: <float>\r\n\t *\r\n\t *  specularMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  alphaMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  envMap: new THREE.TextureCube( [posx, negx, posy, negy, posz, negz] ),\r\n\t *  combine: THREE.Multiply,\r\n\t *  reflectivity: <float>,\r\n\t *  refractionRatio: <float>,\r\n\t *\r\n\t *  shading: THREE.SmoothShading,\r\n\t *  blending: THREE.NormalBlending,\r\n\t *  depthTest: <bool>,\r\n\t *  depthWrite: <bool>,\r\n\t *\r\n\t *  wireframe: <boolean>,\r\n\t *  wireframeLinewidth: <float>,\r\n\t *\r\n\t *  vertexColors: THREE.NoColors / THREE.VertexColors / THREE.FaceColors,\r\n\t *\r\n\t *  skinning: <bool>,\r\n\t *  morphTargets: <bool>,\r\n\t *\r\n\t *  fog: <bool>\r\n\t * }\r\n\t */\r\n\t\r\n\tTHREE.MeshBasicMaterial = function ( parameters ) {\r\n\t\r\n\t\tTHREE.Material.call( this );\r\n\t\r\n\t\tthis.type = 'MeshBasicMaterial';\r\n\t\r\n\t\tthis.color = new THREE.Color( 0xffffff ); // emissive\r\n\t\r\n\t\tthis.map = null;\r\n\t\r\n\t\tthis.aoMap = null;\r\n\t\tthis.aoMapIntensity = 1.0;\r\n\t\r\n\t\tthis.specularMap = null;\r\n\t\r\n\t\tthis.alphaMap = null;\r\n\t\r\n\t\tthis.envMap = null;\r\n\t\tthis.combine = THREE.MultiplyOperation;\r\n\t\tthis.reflectivity = 1;\r\n\t\tthis.refractionRatio = 0.98;\r\n\t\r\n\t\tthis.fog = true;\r\n\t\r\n\t\tthis.shading = THREE.SmoothShading;\r\n\t\r\n\t\tthis.wireframe = false;\r\n\t\tthis.wireframeLinewidth = 1;\r\n\t\tthis.wireframeLinecap = 'round';\r\n\t\tthis.wireframeLinejoin = 'round';\r\n\t\r\n\t\tthis.vertexColors = THREE.NoColors;\r\n\t\r\n\t\tthis.skinning = false;\r\n\t\tthis.morphTargets = false;\r\n\t\r\n\t\tthis.setValues( parameters );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.MeshBasicMaterial.prototype = Object.create( THREE.Material.prototype );\r\n\tTHREE.MeshBasicMaterial.prototype.constructor = THREE.MeshBasicMaterial;\r\n\t\r\n\tTHREE.MeshBasicMaterial.prototype.copy = function ( source ) {\r\n\t\t\r\n\t\tTHREE.Material.prototype.copy.call( this, source );\r\n\t\r\n\t\tthis.color.copy( source.color );\r\n\t\r\n\t\tthis.map = source.map;\r\n\t\r\n\t\tthis.aoMap = source.aoMap;\r\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\r\n\t\r\n\t\tthis.specularMap = source.specularMap;\r\n\t\r\n\t\tthis.alphaMap = source.alphaMap;\r\n\t\r\n\t\tthis.envMap = source.envMap;\r\n\t\tthis.combine = source.combine;\r\n\t\tthis.reflectivity = source.reflectivity;\r\n\t\tthis.refractionRatio = source.refractionRatio;\r\n\t\r\n\t\tthis.fog = source.fog;\r\n\t\r\n\t\tthis.shading = source.shading;\r\n\t\r\n\t\tthis.wireframe = source.wireframe;\r\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\r\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\r\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\r\n\t\r\n\t\tthis.vertexColors = source.vertexColors;\r\n\t\r\n\t\tthis.skinning = source.skinning;\r\n\t\tthis.morphTargets = source.morphTargets;\r\n\t\t\r\n\t\treturn this;\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/materials/MeshLambertMaterial.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t *\r\n\t * parameters = {\r\n\t *  color: <hex>,\r\n\t *  emissive: <hex>,\r\n\t *  opacity: <float>,\r\n\t *\r\n\t *  map: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  specularMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  alphaMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  envMap: new THREE.TextureCube( [posx, negx, posy, negy, posz, negz] ),\r\n\t *  combine: THREE.Multiply,\r\n\t *  reflectivity: <float>,\r\n\t *  refractionRatio: <float>,\r\n\t *\r\n\t *  blending: THREE.NormalBlending,\r\n\t *  depthTest: <bool>,\r\n\t *  depthWrite: <bool>,\r\n\t *\r\n\t *  wireframe: <boolean>,\r\n\t *  wireframeLinewidth: <float>,\r\n\t *\r\n\t *  vertexColors: THREE.NoColors / THREE.VertexColors / THREE.FaceColors,\r\n\t *\r\n\t *  skinning: <bool>,\r\n\t *  morphTargets: <bool>,\r\n\t *  morphNormals: <bool>,\r\n\t *\r\n\t *\tfog: <bool>\r\n\t * }\r\n\t */\r\n\t\r\n\tTHREE.MeshLambertMaterial = function ( parameters ) {\r\n\t\r\n\t\tTHREE.Material.call( this );\r\n\t\r\n\t\tthis.type = 'MeshLambertMaterial';\r\n\t\r\n\t\tthis.color = new THREE.Color( 0xffffff ); // diffuse\r\n\t\tthis.emissive = new THREE.Color( 0x000000 );\r\n\t\r\n\t\tthis.map = null;\r\n\t\r\n\t\tthis.specularMap = null;\r\n\t\r\n\t\tthis.alphaMap = null;\r\n\t\r\n\t\tthis.envMap = null;\r\n\t\tthis.combine = THREE.MultiplyOperation;\r\n\t\tthis.reflectivity = 1;\r\n\t\tthis.refractionRatio = 0.98;\r\n\t\r\n\t\tthis.fog = true;\r\n\t\r\n\t\tthis.wireframe = false;\r\n\t\tthis.wireframeLinewidth = 1;\r\n\t\tthis.wireframeLinecap = 'round';\r\n\t\tthis.wireframeLinejoin = 'round';\r\n\t\r\n\t\tthis.vertexColors = THREE.NoColors;\r\n\t\r\n\t\tthis.skinning = false;\r\n\t\tthis.morphTargets = false;\r\n\t\tthis.morphNormals = false;\r\n\t\r\n\t\tthis.setValues( parameters );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.MeshLambertMaterial.prototype = Object.create( THREE.Material.prototype );\r\n\tTHREE.MeshLambertMaterial.prototype.constructor = THREE.MeshLambertMaterial;\r\n\t\r\n\tTHREE.MeshLambertMaterial.prototype.copy = function ( source ) {\r\n\t\r\n\t\tTHREE.Material.prototype.copy.call( this, source );\r\n\t\r\n\t\tthis.color.copy( source.color );\r\n\t\tthis.emissive.copy( source.emissive );\r\n\t\r\n\t\tthis.map = source.map;\r\n\t\r\n\t\tthis.specularMap = source.specularMap;\r\n\t\r\n\t\tthis.alphaMap = source.alphaMap;\r\n\t\r\n\t\tthis.envMap = source.envMap;\r\n\t\tthis.combine = source.combine;\r\n\t\tthis.reflectivity = source.reflectivity;\r\n\t\tthis.refractionRatio = source.refractionRatio;\r\n\t\r\n\t\tthis.fog = source.fog;\r\n\t\r\n\t\tthis.wireframe = source.wireframe;\r\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\r\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\r\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\r\n\t\r\n\t\tthis.vertexColors = source.vertexColors;\r\n\t\r\n\t\tthis.skinning = source.skinning;\r\n\t\tthis.morphTargets = source.morphTargets;\r\n\t\tthis.morphNormals = source.morphNormals;\r\n\t\r\n\t\treturn this;\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/materials/MeshPhongMaterial.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t *\r\n\t * parameters = {\r\n\t *  color: <hex>,\r\n\t *  emissive: <hex>,\r\n\t *  specular: <hex>,\r\n\t *  shininess: <float>,\r\n\t *  opacity: <float>,\r\n\t *\r\n\t *  map: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  lightMap: new THREE.Texture( <Image> ),\r\n\t *  lightMapIntensity: <float>\r\n\t *\r\n\t *  aoMap: new THREE.Texture( <Image> ),\r\n\t *  aoMapIntensity: <float>\r\n\t *\r\n\t *  emissiveMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  bumpMap: new THREE.Texture( <Image> ),\r\n\t *  bumpScale: <float>,\r\n\t *\r\n\t *  normalMap: new THREE.Texture( <Image> ),\r\n\t *  normalScale: <Vector2>,\r\n\t *\r\n\t *  displacementMap: new THREE.Texture( <Image> ),\r\n\t *  displacementScale: <float>,\r\n\t *  displacementBias: <float>,\r\n\t *\r\n\t *  specularMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  alphaMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  envMap: new THREE.TextureCube( [posx, negx, posy, negy, posz, negz] ),\r\n\t *  combine: THREE.Multiply,\r\n\t *  reflectivity: <float>,\r\n\t *  refractionRatio: <float>,\r\n\t *\r\n\t *  shading: THREE.SmoothShading,\r\n\t *  blending: THREE.NormalBlending,\r\n\t *  depthTest: <bool>,\r\n\t *  depthWrite: <bool>,\r\n\t *\r\n\t *  wireframe: <boolean>,\r\n\t *  wireframeLinewidth: <float>,\r\n\t *\r\n\t *  vertexColors: THREE.NoColors / THREE.VertexColors / THREE.FaceColors,\r\n\t *\r\n\t *  skinning: <bool>,\r\n\t *  morphTargets: <bool>,\r\n\t *  morphNormals: <bool>,\r\n\t *\r\n\t *\tfog: <bool>\r\n\t * }\r\n\t */\r\n\t\r\n\tTHREE.MeshPhongMaterial = function ( parameters ) {\r\n\t\r\n\t\tTHREE.Material.call( this );\r\n\t\r\n\t\tthis.type = 'MeshPhongMaterial';\r\n\t\r\n\t\tthis.color = new THREE.Color( 0xffffff ); // diffuse\r\n\t\tthis.emissive = new THREE.Color( 0x000000 );\r\n\t\tthis.specular = new THREE.Color( 0x111111 );\r\n\t\tthis.shininess = 30;\r\n\t\r\n\t\tthis.metal = false;\r\n\t\r\n\t\tthis.map = null;\r\n\t\r\n\t\tthis.lightMap = null;\r\n\t\tthis.lightMapIntensity = 1.0;\r\n\t\r\n\t\tthis.aoMap = null;\r\n\t\tthis.aoMapIntensity = 1.0;\r\n\t\r\n\t\tthis.emissiveMap = null;\r\n\t\r\n\t\tthis.bumpMap = null;\r\n\t\tthis.bumpScale = 1;\r\n\t\r\n\t\tthis.normalMap = null;\r\n\t\tthis.normalScale = new THREE.Vector2( 1, 1 );\r\n\t\r\n\t\tthis.displacementMap = null;\r\n\t\tthis.displacementScale = 1;\r\n\t\tthis.displacementBias = 0;\r\n\t\r\n\t\tthis.specularMap = null;\r\n\t\r\n\t\tthis.alphaMap = null;\r\n\t\r\n\t\tthis.envMap = null;\r\n\t\tthis.combine = THREE.MultiplyOperation;\r\n\t\tthis.reflectivity = 1;\r\n\t\tthis.refractionRatio = 0.98;\r\n\t\r\n\t\tthis.fog = true;\r\n\t\r\n\t\tthis.shading = THREE.SmoothShading;\r\n\t\r\n\t\tthis.wireframe = false;\r\n\t\tthis.wireframeLinewidth = 1;\r\n\t\tthis.wireframeLinecap = 'round';\r\n\t\tthis.wireframeLinejoin = 'round';\r\n\t\r\n\t\tthis.vertexColors = THREE.NoColors;\r\n\t\r\n\t\tthis.skinning = false;\r\n\t\tthis.morphTargets = false;\r\n\t\tthis.morphNormals = false;\r\n\t\r\n\t\tthis.setValues( parameters );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.MeshPhongMaterial.prototype = Object.create( THREE.Material.prototype );\r\n\tTHREE.MeshPhongMaterial.prototype.constructor = THREE.MeshPhongMaterial;\r\n\t\r\n\tTHREE.MeshPhongMaterial.prototype.copy = function ( source ) {\r\n\t\r\n\t\tTHREE.Material.prototype.copy.call( this, source );\r\n\t\r\n\t\tthis.color.copy( source.color );\r\n\t\tthis.emissive.copy( source.emissive );\r\n\t\tthis.specular.copy( source.specular );\r\n\t\tthis.shininess = source.shininess;\r\n\t\r\n\t\tthis.metal = source.metal;\r\n\t\r\n\t\tthis.map = source.map;\r\n\t\r\n\t\tthis.lightMap = source.lightMap;\r\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\r\n\t\r\n\t\tthis.aoMap = source.aoMap;\r\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\r\n\t\r\n\t\tthis.emissiveMap = source.emissiveMap;\r\n\t\r\n\t\tthis.bumpMap = source.bumpMap;\r\n\t\tthis.bumpScale = source.bumpScale;\r\n\t\r\n\t\tthis.normalMap = source.normalMap;\r\n\t\tthis.normalScale.copy( source.normalScale );\r\n\t\r\n\t\tthis.displacementMap = source.displacementMap;\r\n\t\tthis.displacementScale = source.displacementScale;\r\n\t\tthis.displacementBias = source.displacementBias;\r\n\t\r\n\t\tthis.specularMap = source.specularMap;\r\n\t\r\n\t\tthis.alphaMap = source.alphaMap;\r\n\t\r\n\t\tthis.envMap = source.envMap;\r\n\t\tthis.combine = source.combine;\r\n\t\tthis.reflectivity = source.reflectivity;\r\n\t\tthis.refractionRatio = source.refractionRatio;\r\n\t\r\n\t\tthis.fog = source.fog;\r\n\t\r\n\t\tthis.shading = source.shading;\r\n\t\r\n\t\tthis.wireframe = source.wireframe;\r\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\r\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\r\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\r\n\t\r\n\t\tthis.vertexColors = source.vertexColors;\r\n\t\r\n\t\tthis.skinning = source.skinning;\r\n\t\tthis.morphTargets = source.morphTargets;\r\n\t\tthis.morphNormals = source.morphNormals;\r\n\t\r\n\t\treturn this;\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/materials/MeshDepthMaterial.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t *\r\n\t * parameters = {\r\n\t *  opacity: <float>,\r\n\t *\r\n\t *  blending: THREE.NormalBlending,\r\n\t *  depthTest: <bool>,\r\n\t *  depthWrite: <bool>,\r\n\t *\r\n\t *  wireframe: <boolean>,\r\n\t *  wireframeLinewidth: <float>\r\n\t * }\r\n\t */\r\n\t\r\n\tTHREE.MeshDepthMaterial = function ( parameters ) {\r\n\t\r\n\t\tTHREE.Material.call( this );\r\n\t\r\n\t\tthis.type = 'MeshDepthMaterial';\r\n\t\r\n\t\tthis.morphTargets = false;\r\n\t\tthis.wireframe = false;\r\n\t\tthis.wireframeLinewidth = 1;\r\n\t\r\n\t\tthis.setValues( parameters );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.MeshDepthMaterial.prototype = Object.create( THREE.Material.prototype );\r\n\tTHREE.MeshDepthMaterial.prototype.constructor = THREE.MeshDepthMaterial;\r\n\t\r\n\tTHREE.MeshDepthMaterial.prototype.copy = function ( source ) {\r\n\t\r\n\t\tTHREE.Material.prototype.copy.call( this, source );\r\n\t\r\n\t\tthis.wireframe = source.wireframe;\r\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\r\n\t\r\n\t\treturn this;\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/materials/MeshNormalMaterial.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t *\r\n\t * parameters = {\r\n\t *  opacity: <float>,\r\n\t *\r\n\t *  shading: THREE.FlatShading,\r\n\t *  blending: THREE.NormalBlending,\r\n\t *  depthTest: <bool>,\r\n\t *  depthWrite: <bool>,\r\n\t *\r\n\t *  wireframe: <boolean>,\r\n\t *  wireframeLinewidth: <float>\r\n\t * }\r\n\t */\r\n\t\r\n\tTHREE.MeshNormalMaterial = function ( parameters ) {\r\n\t\r\n\t\tTHREE.Material.call( this, parameters );\r\n\t\r\n\t\tthis.type = 'MeshNormalMaterial';\r\n\t\r\n\t\tthis.wireframe = false;\r\n\t\tthis.wireframeLinewidth = 1;\r\n\t\r\n\t\tthis.morphTargets = false;\r\n\t\r\n\t\tthis.setValues( parameters );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.MeshNormalMaterial.prototype = Object.create( THREE.Material.prototype );\r\n\tTHREE.MeshNormalMaterial.prototype.constructor = THREE.MeshNormalMaterial;\r\n\t\r\n\tTHREE.MeshNormalMaterial.prototype.copy = function ( source ) {\r\n\t\r\n\t\tTHREE.Material.prototype.copy.call( this, source );\r\n\t\r\n\t\tthis.wireframe = source.wireframe;\r\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\r\n\t\r\n\t\treturn this;\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/materials/MultiMaterial.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.MultiMaterial = function ( materials ) {\r\n\t\r\n\t\tthis.uuid = THREE.Math.generateUUID();\r\n\t\r\n\t\tthis.type = 'MultiMaterial';\r\n\t\r\n\t\tthis.materials = materials instanceof Array ? materials : [];\r\n\t\r\n\t\tthis.visible = true;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.MultiMaterial.prototype = {\r\n\t\r\n\t\tconstructor: THREE.MultiMaterial,\r\n\t\r\n\t\ttoJSON: function () {\r\n\t\r\n\t\t\tvar output = {\r\n\t\t\t\tmetadata: {\r\n\t\t\t\t\tversion: 4.2,\r\n\t\t\t\t\ttype: 'material',\r\n\t\t\t\t\tgenerator: 'MaterialExporter'\r\n\t\t\t\t},\r\n\t\t\t\tuuid: this.uuid,\r\n\t\t\t\ttype: this.type,\r\n\t\t\t\tmaterials: []\r\n\t\t\t};\r\n\t\r\n\t\t\tfor ( var i = 0, l = this.materials.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\toutput.materials.push( this.materials[ i ].toJSON() );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\toutput.visible = this.visible;\r\n\t\r\n\t\t\treturn output;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tclone: function () {\r\n\t\r\n\t\t\tvar material = new this.constructor();\r\n\t\r\n\t\t\tfor ( var i = 0; i < this.materials.length; i ++ ) {\r\n\t\r\n\t\t\t\tmaterial.materials.push( this.materials[ i ].clone() );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tmaterial.visible = this.visible;\r\n\t\r\n\t\t\treturn material;\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// backwards compatibility\r\n\t\r\n\tTHREE.MeshFaceMaterial = THREE.MultiMaterial;\r\n\t\r\n\t// File:src/materials/PointsMaterial.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t *\r\n\t * parameters = {\r\n\t *  color: <hex>,\r\n\t *  opacity: <float>,\r\n\t *  map: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  size: <float>,\r\n\t *  sizeAttenuation: <bool>,\r\n\t *\r\n\t *  blending: THREE.NormalBlending,\r\n\t *  depthTest: <bool>,\r\n\t *  depthWrite: <bool>,\r\n\t *\r\n\t *  vertexColors: <bool>,\r\n\t *\r\n\t *  fog: <bool>\r\n\t * }\r\n\t */\r\n\t\r\n\tTHREE.PointsMaterial = function ( parameters ) {\r\n\t\r\n\t\tTHREE.Material.call( this );\r\n\t\r\n\t\tthis.type = 'PointsMaterial';\r\n\t\r\n\t\tthis.color = new THREE.Color( 0xffffff );\r\n\t\r\n\t\tthis.map = null;\r\n\t\r\n\t\tthis.size = 1;\r\n\t\tthis.sizeAttenuation = true;\r\n\t\r\n\t\tthis.vertexColors = THREE.NoColors;\r\n\t\r\n\t\tthis.fog = true;\r\n\t\r\n\t\tthis.setValues( parameters );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.PointsMaterial.prototype = Object.create( THREE.Material.prototype );\r\n\tTHREE.PointsMaterial.prototype.constructor = THREE.PointsMaterial;\r\n\t\r\n\tTHREE.PointsMaterial.prototype.copy = function ( source ) {\r\n\t\r\n\t\tTHREE.Material.prototype.copy.call( this, source );\r\n\t\r\n\t\tthis.color.copy( source.color );\r\n\t\r\n\t\tthis.map = source.map;\r\n\t\r\n\t\tthis.size = source.size;\r\n\t\tthis.sizeAttenuation = source.sizeAttenuation;\r\n\t\r\n\t\tthis.vertexColors = source.vertexColors;\r\n\t\r\n\t\tthis.fog = source.fog;\r\n\t\r\n\t\treturn this;\r\n\t\r\n\t};\r\n\t\r\n\t// backwards compatibility\r\n\t\r\n\tTHREE.PointCloudMaterial = function ( parameters ) {\r\n\t\r\n\t\tconsole.warn( 'THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial.' );\r\n\t\treturn new THREE.PointsMaterial( parameters );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.ParticleBasicMaterial = function ( parameters ) {\r\n\t\r\n\t\tconsole.warn( 'THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial.' );\r\n\t\treturn new THREE.PointsMaterial( parameters );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.ParticleSystemMaterial = function ( parameters ) {\r\n\t\r\n\t\tconsole.warn( 'THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial.' );\r\n\t\treturn new THREE.PointsMaterial( parameters );\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/materials/ShaderMaterial.js\r\n\t\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t *\r\n\t * parameters = {\r\n\t *  defines: { \"label\" : \"value\" },\r\n\t *  uniforms: { \"parameter1\": { type: \"f\", value: 1.0 }, \"parameter2\": { type: \"i\" value2: 2 } },\r\n\t *\r\n\t *  fragmentShader: <string>,\r\n\t *  vertexShader: <string>,\r\n\t *\r\n\t *  shading: THREE.SmoothShading,\r\n\t *  blending: THREE.NormalBlending,\r\n\t *  depthTest: <bool>,\r\n\t *  depthWrite: <bool>,\r\n\t *\r\n\t *  wireframe: <boolean>,\r\n\t *  wireframeLinewidth: <float>,\r\n\t *\r\n\t *  lights: <bool>,\r\n\t *\r\n\t *  vertexColors: THREE.NoColors / THREE.VertexColors / THREE.FaceColors,\r\n\t *\r\n\t *  skinning: <bool>,\r\n\t *  morphTargets: <bool>,\r\n\t *  morphNormals: <bool>,\r\n\t *\r\n\t *\tfog: <bool>\r\n\t * }\r\n\t */\r\n\t\r\n\tTHREE.ShaderMaterial = function ( parameters ) {\r\n\t\r\n\t\tTHREE.Material.call( this );\r\n\t\r\n\t\tthis.type = 'ShaderMaterial';\r\n\t\r\n\t\tthis.defines = {};\r\n\t\tthis.uniforms = {};\r\n\t\r\n\t\tthis.vertexShader = 'void main() {\\n\\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\\n}';\r\n\t\tthis.fragmentShader = 'void main() {\\n\\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\\n}';\r\n\t\r\n\t\tthis.shading = THREE.SmoothShading;\r\n\t\r\n\t\tthis.linewidth = 1;\r\n\t\r\n\t\tthis.wireframe = false;\r\n\t\tthis.wireframeLinewidth = 1;\r\n\t\r\n\t\tthis.fog = false; // set to use scene fog\r\n\t\r\n\t\tthis.lights = false; // set to use scene lights\r\n\t\r\n\t\tthis.vertexColors = THREE.NoColors; // set to use \"color\" attribute stream\r\n\t\r\n\t\tthis.skinning = false; // set to use skinning attribute streams\r\n\t\r\n\t\tthis.morphTargets = false; // set to use morph targets\r\n\t\tthis.morphNormals = false; // set to use morph normals\r\n\t\r\n\t\tthis.derivatives = false; // set to use derivatives\r\n\t\r\n\t\t// When rendered geometry doesn't include these attributes but the material does,\r\n\t\t// use these default values in WebGL. This avoids errors when buffer data is missing.\r\n\t\tthis.defaultAttributeValues = {\r\n\t\t\t'color': [ 1, 1, 1 ],\r\n\t\t\t'uv': [ 0, 0 ],\r\n\t\t\t'uv2': [ 0, 0 ]\r\n\t\t};\r\n\t\r\n\t\tthis.index0AttributeName = undefined;\r\n\t\r\n\t\tif ( parameters !== undefined ) {\r\n\t\r\n\t\t\tif ( parameters.attributes !== undefined ) {\r\n\t\r\n\t\t\t\tconsole.error( 'THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead.' );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tthis.setValues( parameters );\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.ShaderMaterial.prototype = Object.create( THREE.Material.prototype );\r\n\tTHREE.ShaderMaterial.prototype.constructor = THREE.ShaderMaterial;\r\n\t\r\n\tTHREE.ShaderMaterial.prototype.copy = function ( source ) {\r\n\t\r\n\t\tTHREE.Material.prototype.copy.call( this, source );\r\n\t\r\n\t\tthis.fragmentShader = source.fragmentShader;\r\n\t\tthis.vertexShader = source.vertexShader;\r\n\t\r\n\t\tthis.uniforms = THREE.UniformsUtils.clone( source.uniforms );\r\n\t\r\n\t\tthis.attributes = source.attributes;\r\n\t\tthis.defines = source.defines;\r\n\t\r\n\t\tthis.shading = source.shading;\r\n\t\r\n\t\tthis.wireframe = source.wireframe;\r\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\r\n\t\r\n\t\tthis.fog = source.fog;\r\n\t\r\n\t\tthis.lights = source.lights;\r\n\t\r\n\t\tthis.vertexColors = source.vertexColors;\r\n\t\r\n\t\tthis.skinning = source.skinning;\r\n\t\r\n\t\tthis.morphTargets = source.morphTargets;\r\n\t\tthis.morphNormals = source.morphNormals;\r\n\t\r\n\t\tthis.derivatives = source.derivatives;\r\n\t\r\n\t\treturn this;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.ShaderMaterial.prototype.toJSON = function ( meta ) {\r\n\t\r\n\t\tvar data = THREE.Material.prototype.toJSON.call( this, meta );\r\n\t\r\n\t\tdata.uniforms = this.uniforms;\r\n\t\tdata.attributes = this.attributes;\r\n\t\tdata.vertexShader = this.vertexShader;\r\n\t\tdata.fragmentShader = this.fragmentShader;\r\n\t\r\n\t\treturn data;\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/materials/RawShaderMaterial.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.RawShaderMaterial = function ( parameters ) {\r\n\t\r\n\t\tTHREE.ShaderMaterial.call( this, parameters );\r\n\t\r\n\t\tthis.type = 'RawShaderMaterial';\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.RawShaderMaterial.prototype = Object.create( THREE.ShaderMaterial.prototype );\r\n\tTHREE.RawShaderMaterial.prototype.constructor = THREE.RawShaderMaterial;\r\n\t// File:src/materials/SpriteMaterial.js\r\n\t\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t *\r\n\t * parameters = {\r\n\t *  color: <hex>,\r\n\t *  opacity: <float>,\r\n\t *  map: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  blending: THREE.NormalBlending,\r\n\t *  depthTest: <bool>,\r\n\t *  depthWrite: <bool>,\r\n\t *\r\n\t *\tuvOffset: new THREE.Vector2(),\r\n\t *\tuvScale: new THREE.Vector2(),\r\n\t *\r\n\t *  fog: <bool>\r\n\t * }\r\n\t */\r\n\t\r\n\tTHREE.SpriteMaterial = function ( parameters ) {\r\n\t\r\n\t\tTHREE.Material.call( this );\r\n\t\r\n\t\tthis.type = 'SpriteMaterial';\r\n\t\r\n\t\tthis.color = new THREE.Color( 0xffffff );\r\n\t\tthis.map = null;\r\n\t\r\n\t\tthis.rotation = 0;\r\n\t\r\n\t\tthis.fog = false;\r\n\t\r\n\t\t// set parameters\r\n\t\r\n\t\tthis.setValues( parameters );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.SpriteMaterial.prototype = Object.create( THREE.Material.prototype );\r\n\tTHREE.SpriteMaterial.prototype.constructor = THREE.SpriteMaterial;\r\n\t\r\n\tTHREE.SpriteMaterial.prototype.copy = function ( source ) {\r\n\t\r\n\t\tTHREE.Material.prototype.copy.call( this, source );\r\n\t\r\n\t\tthis.color.copy( source.color );\r\n\t\tthis.map = source.map;\r\n\t\r\n\t\tthis.rotation = source.rotation;\r\n\t\r\n\t\tthis.fog = source.fog;\r\n\t\r\n\t\treturn this;\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/textures/Texture.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author szimek / https://github.com/szimek/\r\n\t */\r\n\t\r\n\tTHREE.Texture = function ( image, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy ) {\r\n\t\r\n\t\tObject.defineProperty( this, 'id', { value: THREE.TextureIdCount ++ } );\r\n\t\r\n\t\tthis.uuid = THREE.Math.generateUUID();\r\n\t\r\n\t\tthis.name = '';\r\n\t\tthis.sourceFile = '';\r\n\t\r\n\t\tthis.image = image !== undefined ? image : THREE.Texture.DEFAULT_IMAGE;\r\n\t\tthis.mipmaps = [];\r\n\t\r\n\t\tthis.mapping = mapping !== undefined ? mapping : THREE.Texture.DEFAULT_MAPPING;\r\n\t\r\n\t\tthis.wrapS = wrapS !== undefined ? wrapS : THREE.ClampToEdgeWrapping;\r\n\t\tthis.wrapT = wrapT !== undefined ? wrapT : THREE.ClampToEdgeWrapping;\r\n\t\r\n\t\tthis.magFilter = magFilter !== undefined ? magFilter : THREE.LinearFilter;\r\n\t\tthis.minFilter = minFilter !== undefined ? minFilter : THREE.LinearMipMapLinearFilter;\r\n\t\r\n\t\tthis.anisotropy = anisotropy !== undefined ? anisotropy : 1;\r\n\t\r\n\t\tthis.format = format !== undefined ? format : THREE.RGBAFormat;\r\n\t\tthis.type = type !== undefined ? type : THREE.UnsignedByteType;\r\n\t\r\n\t\tthis.offset = new THREE.Vector2( 0, 0 );\r\n\t\tthis.repeat = new THREE.Vector2( 1, 1 );\r\n\t\r\n\t\tthis.generateMipmaps = true;\r\n\t\tthis.premultiplyAlpha = false;\r\n\t\tthis.flipY = true;\r\n\t\tthis.unpackAlignment = 4; // valid values: 1, 2, 4, 8 (see http://www.khronos.org/opengles/sdk/docs/man/xhtml/glPixelStorei.xml)\r\n\t\r\n\t\tthis.version = 0;\r\n\t\tthis.onUpdate = null;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Texture.DEFAULT_IMAGE = undefined;\r\n\tTHREE.Texture.DEFAULT_MAPPING = THREE.UVMapping;\r\n\t\r\n\tTHREE.Texture.prototype = {\r\n\t\r\n\t\tconstructor: THREE.Texture,\r\n\t\r\n\t\tset needsUpdate ( value ) {\r\n\t\r\n\t\t\tif ( value === true ) this.version ++;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tclone: function () {\r\n\t\r\n\t\t\treturn new this.constructor().copy( this );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcopy: function ( source ) {\r\n\t\r\n\t\t\tthis.image = source.image;\r\n\t\t\tthis.mipmaps = source.mipmaps.slice( 0 );\r\n\t\r\n\t\t\tthis.mapping = source.mapping;\r\n\t\r\n\t\t\tthis.wrapS = source.wrapS;\r\n\t\t\tthis.wrapT = source.wrapT;\r\n\t\r\n\t\t\tthis.magFilter = source.magFilter;\r\n\t\t\tthis.minFilter = source.minFilter;\r\n\t\r\n\t\t\tthis.anisotropy = source.anisotropy;\r\n\t\r\n\t\t\tthis.format = source.format;\r\n\t\t\tthis.type = source.type;\r\n\t\r\n\t\t\tthis.offset.copy( source.offset );\r\n\t\t\tthis.repeat.copy( source.repeat );\r\n\t\r\n\t\t\tthis.generateMipmaps = source.generateMipmaps;\r\n\t\t\tthis.premultiplyAlpha = source.premultiplyAlpha;\r\n\t\t\tthis.flipY = source.flipY;\r\n\t\t\tthis.unpackAlignment = source.unpackAlignment;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\ttoJSON: function ( meta ) {\r\n\t\r\n\t\t\tif ( meta.textures[ this.uuid ] !== undefined ) {\r\n\t\r\n\t\t\t\treturn meta.textures[ this.uuid ];\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tfunction getDataURL( image ) {\r\n\t\r\n\t\t\t\tvar canvas;\r\n\t\r\n\t\t\t\tif ( image.toDataURL !== undefined ) {\r\n\t\r\n\t\t\t\t\tcanvas = image;\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tcanvas = document.createElement( 'canvas' );\r\n\t\t\t\t\tcanvas.width = image.width;\r\n\t\t\t\t\tcanvas.height = image.height;\r\n\t\r\n\t\t\t\t\tcanvas.getContext( '2d' ).drawImage( image, 0, 0, image.width, image.height );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( canvas.width > 2048 || canvas.height > 2048 ) {\r\n\t\r\n\t\t\t\t\treturn canvas.toDataURL( 'image/jpeg', 0.6 );\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\treturn canvas.toDataURL( 'image/png' );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar output = {\r\n\t\t\t\tmetadata: {\r\n\t\t\t\t\tversion: 4.4,\r\n\t\t\t\t\ttype: 'Texture',\r\n\t\t\t\t\tgenerator: 'Texture.toJSON'\r\n\t\t\t\t},\r\n\t\r\n\t\t\t\tuuid: this.uuid,\r\n\t\t\t\tname: this.name,\r\n\t\r\n\t\t\t\tmapping: this.mapping,\r\n\t\r\n\t\t\t\trepeat: [ this.repeat.x, this.repeat.y ],\r\n\t\t\t\toffset: [ this.offset.x, this.offset.y ],\r\n\t\t\t\twrap: [ this.wrapS, this.wrapT ],\r\n\t\r\n\t\t\t\tminFilter: this.minFilter,\r\n\t\t\t\tmagFilter: this.magFilter,\r\n\t\t\t\tanisotropy: this.anisotropy\r\n\t\t\t};\r\n\t\r\n\t\t\tif ( this.image !== undefined ) {\r\n\t\r\n\t\t\t\t// TODO: Move to THREE.Image\r\n\t\r\n\t\t\t\tvar image = this.image;\r\n\t\r\n\t\t\t\tif ( image.uuid === undefined ) {\r\n\t\r\n\t\t\t\t\timage.uuid = THREE.Math.generateUUID(); // UGH\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( meta.images[ image.uuid ] === undefined ) {\r\n\t\r\n\t\t\t\t\tmeta.images[ image.uuid ] = {\r\n\t\t\t\t\t\tuuid: image.uuid,\r\n\t\t\t\t\t\turl: getDataURL( image )\r\n\t\t\t\t\t};\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\toutput.image = image.uuid;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tmeta.textures[ this.uuid ] = output;\r\n\t\r\n\t\t\treturn output;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tdispose: function () {\r\n\t\r\n\t\t\tthis.dispatchEvent( { type: 'dispose' } );\r\n\t\r\n\t\t},\r\n\t\r\n\t\ttransformUv: function ( uv ) {\r\n\t\r\n\t\t\tif ( this.mapping !== THREE.UVMapping )  return;\r\n\t\r\n\t\t\tuv.multiply( this.repeat );\r\n\t\t\tuv.add( this.offset );\r\n\t\r\n\t\t\tif ( uv.x < 0 || uv.x > 1 ) {\r\n\t\r\n\t\t\t\tswitch ( this.wrapS ) {\r\n\t\r\n\t\t\t\t\tcase THREE.RepeatWrapping:\r\n\t\r\n\t\t\t\t\t\tuv.x = uv.x - Math.floor( uv.x );\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase THREE.ClampToEdgeWrapping:\r\n\t\r\n\t\t\t\t\t\tuv.x = uv.x < 0 ? 0 : 1;\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase THREE.MirroredRepeatWrapping:\r\n\t\r\n\t\t\t\t\t\tif ( Math.abs( Math.floor( uv.x ) % 2 ) === 1 ) {\r\n\t\r\n\t\t\t\t\t\t\tuv.x = Math.ceil( uv.x ) - uv.x;\r\n\t\r\n\t\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\t\tuv.x = uv.x - Math.floor( uv.x );\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( uv.y < 0 || uv.y > 1 ) {\r\n\t\r\n\t\t\t\tswitch ( this.wrapT ) {\r\n\t\r\n\t\t\t\t\tcase THREE.RepeatWrapping:\r\n\t\r\n\t\t\t\t\t\tuv.y = uv.y - Math.floor( uv.y );\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase THREE.ClampToEdgeWrapping:\r\n\t\r\n\t\t\t\t\t\tuv.y = uv.y < 0 ? 0 : 1;\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase THREE.MirroredRepeatWrapping:\r\n\t\r\n\t\t\t\t\t\tif ( Math.abs( Math.floor( uv.y ) % 2 ) === 1 ) {\r\n\t\r\n\t\t\t\t\t\t\tuv.y = Math.ceil( uv.y ) - uv.y;\r\n\t\r\n\t\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\t\tuv.y = uv.y - Math.floor( uv.y );\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( this.flipY ) {\r\n\t\r\n\t\t\t\tuv.y = 1 - uv.y;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.EventDispatcher.prototype.apply( THREE.Texture.prototype );\r\n\t\r\n\tTHREE.TextureIdCount = 0;\r\n\t\r\n\t// File:src/textures/CanvasTexture.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.CanvasTexture = function ( canvas, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy ) {\r\n\t\r\n\t\tTHREE.Texture.call( this, canvas, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\r\n\t\r\n\t\tthis.needsUpdate = true;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.CanvasTexture.prototype = Object.create( THREE.Texture.prototype );\r\n\tTHREE.CanvasTexture.prototype.constructor = THREE.CanvasTexture;\r\n\t\r\n\t// File:src/textures/CubeTexture.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.CubeTexture = function ( images, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy ) {\r\n\t\r\n\t\tmapping = mapping !== undefined ? mapping : THREE.CubeReflectionMapping;\r\n\t\r\n\t\tTHREE.Texture.call( this, images, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\r\n\t\r\n\t\tthis.images = images;\r\n\t\tthis.flipY = false;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.CubeTexture.prototype = Object.create( THREE.Texture.prototype );\r\n\tTHREE.CubeTexture.prototype.constructor = THREE.CubeTexture;\r\n\t\r\n\tTHREE.CubeTexture.prototype.copy = function ( source ) {\r\n\t\r\n\t\tTHREE.Texture.prototype.copy.call( this, source );\r\n\t\t\r\n\t\tthis.images = source.images;\r\n\t\t\r\n\t\treturn this;\r\n\t\r\n\t};\r\n\t// File:src/textures/CompressedTexture.js\r\n\t\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\t\r\n\tTHREE.CompressedTexture = function ( mipmaps, width, height, format, type, mapping, wrapS, wrapT, magFilter, minFilter, anisotropy ) {\r\n\t\r\n\t\tTHREE.Texture.call( this, null, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\r\n\t\r\n\t\tthis.image = { width: width, height: height };\r\n\t\tthis.mipmaps = mipmaps;\r\n\t\r\n\t\t// no flipping for cube textures\r\n\t\t// (also flipping doesn't work for compressed textures )\r\n\t\r\n\t\tthis.flipY = false;\r\n\t\r\n\t\t// can't generate mipmaps for compressed textures\r\n\t\t// mips must be embedded in DDS files\r\n\t\r\n\t\tthis.generateMipmaps = false;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.CompressedTexture.prototype = Object.create( THREE.Texture.prototype );\r\n\tTHREE.CompressedTexture.prototype.constructor = THREE.CompressedTexture;\r\n\t\r\n\t// File:src/textures/DataTexture.js\r\n\t\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\t\r\n\tTHREE.DataTexture = function ( data, width, height, format, type, mapping, wrapS, wrapT, magFilter, minFilter, anisotropy ) {\r\n\t\r\n\t\tTHREE.Texture.call( this, null, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\r\n\t\r\n\t\tthis.image = { data: data, width: width, height: height };\r\n\t\r\n\t\tthis.magFilter = magFilter !== undefined ? magFilter : THREE.NearestFilter;\r\n\t\tthis.minFilter = minFilter !== undefined ? minFilter : THREE.NearestFilter;\r\n\t\t\r\n\t\tthis.flipY = false;\r\n\t\tthis.generateMipmaps  = false;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.DataTexture.prototype = Object.create( THREE.Texture.prototype );\r\n\tTHREE.DataTexture.prototype.constructor = THREE.DataTexture;\r\n\t\r\n\t// File:src/textures/VideoTexture.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.VideoTexture = function ( video, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy ) {\r\n\t\r\n\t\tTHREE.Texture.call( this, video, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\r\n\t\r\n\t\tthis.generateMipmaps = false;\r\n\t\r\n\t\tvar scope = this;\r\n\t\r\n\t\tfunction update() {\r\n\t\r\n\t\t\trequestAnimationFrame( update );\r\n\t\r\n\t\t\tif ( video.readyState === video.HAVE_ENOUGH_DATA ) {\r\n\t\r\n\t\t\t\tscope.needsUpdate = true;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tupdate();\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.VideoTexture.prototype = Object.create( THREE.Texture.prototype );\r\n\tTHREE.VideoTexture.prototype.constructor = THREE.VideoTexture;\r\n\t\r\n\t// File:src/objects/Group.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.Group = function () {\r\n\t\r\n\t\tTHREE.Object3D.call( this );\r\n\t\r\n\t\tthis.type = 'Group';\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Group.prototype = Object.create( THREE.Object3D.prototype );\r\n\tTHREE.Group.prototype.constructor = THREE.Group;\r\n\t// File:src/objects/Points.js\r\n\t\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\t\r\n\tTHREE.Points = function ( geometry, material ) {\r\n\t\r\n\t\tTHREE.Object3D.call( this );\r\n\t\r\n\t\tthis.type = 'Points';\r\n\t\r\n\t\tthis.geometry = geometry !== undefined ? geometry : new THREE.Geometry();\r\n\t\tthis.material = material !== undefined ? material : new THREE.PointsMaterial( { color: Math.random() * 0xffffff } );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Points.prototype = Object.create( THREE.Object3D.prototype );\r\n\tTHREE.Points.prototype.constructor = THREE.Points;\r\n\t\r\n\tTHREE.Points.prototype.raycast = ( function () {\r\n\t\r\n\t\tvar inverseMatrix = new THREE.Matrix4();\r\n\t\tvar ray = new THREE.Ray();\r\n\t\r\n\t\treturn function raycast( raycaster, intersects ) {\r\n\t\r\n\t\t\tvar object = this;\r\n\t\t\tvar geometry = object.geometry;\r\n\t\t\tvar threshold = raycaster.params.Points.threshold;\r\n\t\r\n\t\t\tinverseMatrix.getInverse( this.matrixWorld );\r\n\t\t\tray.copy( raycaster.ray ).applyMatrix4( inverseMatrix );\r\n\t\r\n\t\t\tif ( geometry.boundingBox !== null ) {\r\n\t\r\n\t\t\t\tif ( ray.isIntersectionBox( geometry.boundingBox ) === false ) {\r\n\t\r\n\t\t\t\t\treturn;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar localThreshold = threshold / ( ( this.scale.x + this.scale.y + this.scale.z ) / 3 );\r\n\t\t\tvar localThresholdSq = localThreshold * localThreshold;\r\n\t\t\tvar position = new THREE.Vector3();\r\n\t\r\n\t\t\tfunction testPoint( point, index ) {\r\n\t\r\n\t\t\t\tvar rayPointDistanceSq = ray.distanceSqToPoint( point );\r\n\t\r\n\t\t\t\tif ( rayPointDistanceSq < localThresholdSq ) {\r\n\t\r\n\t\t\t\t\tvar intersectPoint = ray.closestPointToPoint( point );\r\n\t\t\t\t\tintersectPoint.applyMatrix4( object.matrixWorld );\r\n\t\r\n\t\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( intersectPoint );\r\n\t\r\n\t\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) return;\r\n\t\r\n\t\t\t\t\tintersects.push( {\r\n\t\r\n\t\t\t\t\t\tdistance: distance,\r\n\t\t\t\t\t\tdistanceToRay: Math.sqrt( rayPointDistanceSq ),\r\n\t\t\t\t\t\tpoint: intersectPoint.clone(),\r\n\t\t\t\t\t\tindex: index,\r\n\t\t\t\t\t\tface: null,\r\n\t\t\t\t\t\tobject: object\r\n\t\r\n\t\t\t\t\t} );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( geometry instanceof THREE.BufferGeometry ) {\r\n\t\r\n\t\t\t\tvar index = geometry.index;\r\n\t\t\t\tvar attributes = geometry.attributes;\r\n\t\t\t\tvar positions = attributes.position.array;\r\n\t\r\n\t\t\t\tif ( index !== null ) {\r\n\t\r\n\t\t\t\t\tvar indices = index.array;\r\n\t\r\n\t\t\t\t\tfor ( var i = 0, il = indices.length; i < il; i ++ ) {\r\n\t\r\n\t\t\t\t\t\tvar a = indices[ i ];\r\n\t\r\n\t\t\t\t\t\tposition.fromArray( positions, a * 3 );\r\n\t\r\n\t\t\t\t\t\ttestPoint( position, a );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tfor ( var i = 0, l = positions.length / 3; i < l; i ++ ) {\r\n\t\r\n\t\t\t\t\t\tposition.fromArray( positions, i * 3 );\r\n\t\r\n\t\t\t\t\t\ttestPoint( position, i );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\tvar vertices = geometry.vertices;\r\n\t\r\n\t\t\t\tfor ( var i = 0, l = vertices.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\t\ttestPoint( vertices[ i ], i );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t};\r\n\t\r\n\t}() );\r\n\t\r\n\tTHREE.Points.prototype.clone = function () {\r\n\t\r\n\t\treturn new this.constructor( this.geometry, this.material ).copy( this );\r\n\t\r\n\t};\r\n\t\r\n\t// Backwards compatibility\r\n\t\r\n\tTHREE.PointCloud = function ( geometry, material ) {\r\n\t\r\n\t\tconsole.warn( 'THREE.PointCloud has been renamed to THREE.Points.' );\r\n\t\treturn new THREE.Points( geometry, material );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.ParticleSystem = function ( geometry, material ) {\r\n\t\r\n\t\tconsole.warn( 'THREE.ParticleSystem has been renamed to THREE.Points.' );\r\n\t\treturn new THREE.Points( geometry, material );\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/objects/Line.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.Line = function ( geometry, material, mode ) {\r\n\t\r\n\t\tif ( mode === 1 ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead.' );\r\n\t\t\treturn new THREE.LineSegments( geometry, material );\r\n\t\r\n\t\t}\r\n\t\r\n\t\tTHREE.Object3D.call( this );\r\n\t\r\n\t\tthis.type = 'Line';\r\n\t\r\n\t\tthis.geometry = geometry !== undefined ? geometry : new THREE.Geometry();\r\n\t\tthis.material = material !== undefined ? material : new THREE.LineBasicMaterial( { color: Math.random() * 0xffffff } );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Line.prototype = Object.create( THREE.Object3D.prototype );\r\n\tTHREE.Line.prototype.constructor = THREE.Line;\r\n\t\r\n\tTHREE.Line.prototype.raycast = ( function () {\r\n\t\r\n\t\tvar inverseMatrix = new THREE.Matrix4();\r\n\t\tvar ray = new THREE.Ray();\r\n\t\tvar sphere = new THREE.Sphere();\r\n\t\r\n\t\treturn function raycast( raycaster, intersects ) {\r\n\t\r\n\t\t\tvar precision = raycaster.linePrecision;\r\n\t\t\tvar precisionSq = precision * precision;\r\n\t\r\n\t\t\tvar geometry = this.geometry;\r\n\t\r\n\t\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\r\n\t\r\n\t\t\t// Checking boundingSphere distance to ray\r\n\t\r\n\t\t\tsphere.copy( geometry.boundingSphere );\r\n\t\t\tsphere.applyMatrix4( this.matrixWorld );\r\n\t\r\n\t\t\tif ( raycaster.ray.isIntersectionSphere( sphere ) === false ) {\r\n\t\r\n\t\t\t\treturn;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tinverseMatrix.getInverse( this.matrixWorld );\r\n\t\t\tray.copy( raycaster.ray ).applyMatrix4( inverseMatrix );\r\n\t\r\n\t\t\tvar vStart = new THREE.Vector3();\r\n\t\t\tvar vEnd = new THREE.Vector3();\r\n\t\t\tvar interSegment = new THREE.Vector3();\r\n\t\t\tvar interRay = new THREE.Vector3();\r\n\t\t\tvar step = this instanceof THREE.LineSegments ? 2 : 1;\r\n\t\r\n\t\t\tif ( geometry instanceof THREE.BufferGeometry ) {\r\n\t\r\n\t\t\t\tvar index = geometry.index;\r\n\t\t\t\tvar attributes = geometry.attributes;\r\n\t\r\n\t\t\t\tif ( index !== null ) {\r\n\t\r\n\t\t\t\t\tvar indices = index.array;\r\n\t\t\t\t\tvar positions = attributes.position.array;\r\n\t\r\n\t\t\t\t\tfor ( var i = 0, l = indices.length - 1; i < l; i += step ) {\r\n\t\r\n\t\t\t\t\t\tvar a = indices[ i ];\r\n\t\t\t\t\t\tvar b = indices[ i + 1 ];\r\n\t\r\n\t\t\t\t\t\tvStart.fromArray( positions, a * 3 );\r\n\t\t\t\t\t\tvEnd.fromArray( positions, b * 3 );\r\n\t\r\n\t\t\t\t\t\tvar distSq = ray.distanceSqToSegment( vStart, vEnd, interRay, interSegment );\r\n\t\r\n\t\t\t\t\t\tif ( distSq > precisionSq ) continue;\r\n\t\r\n\t\t\t\t\t\tinterRay.applyMatrix4( this.matrixWorld ); //Move back to world space for distance calculation\r\n\t\r\n\t\t\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( interRay );\r\n\t\r\n\t\t\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) continue;\r\n\t\r\n\t\t\t\t\t\tintersects.push( {\r\n\t\r\n\t\t\t\t\t\t\tdistance: distance,\r\n\t\t\t\t\t\t\t// What do we want? intersection point on the ray or on the segment??\r\n\t\t\t\t\t\t\t// point: raycaster.ray.at( distance ),\r\n\t\t\t\t\t\t\tpoint: interSegment.clone().applyMatrix4( this.matrixWorld ),\r\n\t\t\t\t\t\t\tindex: i,\r\n\t\t\t\t\t\t\tface: null,\r\n\t\t\t\t\t\t\tfaceIndex: null,\r\n\t\t\t\t\t\t\tobject: this\r\n\t\r\n\t\t\t\t\t\t} );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tvar positions = attributes.position.array;\r\n\t\r\n\t\t\t\t\tfor ( var i = 0, l = positions.length / 3 - 1; i < l; i += step ) {\r\n\t\r\n\t\t\t\t\t\tvStart.fromArray( positions, 3 * i );\r\n\t\t\t\t\t\tvEnd.fromArray( positions, 3 * i + 3 );\r\n\t\r\n\t\t\t\t\t\tvar distSq = ray.distanceSqToSegment( vStart, vEnd, interRay, interSegment );\r\n\t\r\n\t\t\t\t\t\tif ( distSq > precisionSq ) continue;\r\n\t\r\n\t\t\t\t\t\tinterRay.applyMatrix4( this.matrixWorld ); //Move back to world space for distance calculation\r\n\t\r\n\t\t\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( interRay );\r\n\t\r\n\t\t\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) continue;\r\n\t\r\n\t\t\t\t\t\tintersects.push( {\r\n\t\r\n\t\t\t\t\t\t\tdistance: distance,\r\n\t\t\t\t\t\t\t// What do we want? intersection point on the ray or on the segment??\r\n\t\t\t\t\t\t\t// point: raycaster.ray.at( distance ),\r\n\t\t\t\t\t\t\tpoint: interSegment.clone().applyMatrix4( this.matrixWorld ),\r\n\t\t\t\t\t\t\tindex: i,\r\n\t\t\t\t\t\t\tface: null,\r\n\t\t\t\t\t\t\tfaceIndex: null,\r\n\t\t\t\t\t\t\tobject: this\r\n\t\r\n\t\t\t\t\t\t} );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t} else if ( geometry instanceof THREE.Geometry ) {\r\n\t\r\n\t\t\t\tvar vertices = geometry.vertices;\r\n\t\t\t\tvar nbVertices = vertices.length;\r\n\t\r\n\t\t\t\tfor ( var i = 0; i < nbVertices - 1; i += step ) {\r\n\t\r\n\t\t\t\t\tvar distSq = ray.distanceSqToSegment( vertices[ i ], vertices[ i + 1 ], interRay, interSegment );\r\n\t\r\n\t\t\t\t\tif ( distSq > precisionSq ) continue;\r\n\t\r\n\t\t\t\t\tinterRay.applyMatrix4( this.matrixWorld ); //Move back to world space for distance calculation\r\n\t\r\n\t\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( interRay );\r\n\t\r\n\t\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) continue;\r\n\t\r\n\t\t\t\t\tintersects.push( {\r\n\t\r\n\t\t\t\t\t\tdistance: distance,\r\n\t\t\t\t\t\t// What do we want? intersection point on the ray or on the segment??\r\n\t\t\t\t\t\t// point: raycaster.ray.at( distance ),\r\n\t\t\t\t\t\tpoint: interSegment.clone().applyMatrix4( this.matrixWorld ),\r\n\t\t\t\t\t\tindex: i,\r\n\t\t\t\t\t\tface: null,\r\n\t\t\t\t\t\tfaceIndex: null,\r\n\t\t\t\t\t\tobject: this\r\n\t\r\n\t\t\t\t\t} );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t};\r\n\t\r\n\t}() );\r\n\t\r\n\tTHREE.Line.prototype.clone = function () {\r\n\t\r\n\t\treturn new this.constructor( this.geometry, this.material ).copy( this );\r\n\t\r\n\t};\r\n\t\r\n\t// DEPRECATED\r\n\t\r\n\tTHREE.LineStrip = 0;\r\n\tTHREE.LinePieces = 1;\r\n\t\r\n\t// File:src/objects/LineSegments.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.LineSegments = function ( geometry, material ) {\r\n\t\r\n\t\tTHREE.Line.call( this, geometry, material );\r\n\t\r\n\t\tthis.type = 'LineSegments';\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.LineSegments.prototype = Object.create( THREE.Line.prototype );\r\n\tTHREE.LineSegments.prototype.constructor = THREE.LineSegments;\r\n\t\r\n\t// File:src/objects/Mesh.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author jonobr1 / http://jonobr1.com/\r\n\t */\r\n\t\r\n\tTHREE.Mesh = function ( geometry, material ) {\r\n\t\r\n\t\tTHREE.Object3D.call( this );\r\n\t\r\n\t\tthis.type = 'Mesh';\r\n\t\r\n\t\tthis.geometry = geometry !== undefined ? geometry : new THREE.Geometry();\r\n\t\tthis.material = material !== undefined ? material : new THREE.MeshBasicMaterial( { color: Math.random() * 0xffffff } );\r\n\t\r\n\t\tthis.updateMorphTargets();\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Mesh.prototype = Object.create( THREE.Object3D.prototype );\r\n\tTHREE.Mesh.prototype.constructor = THREE.Mesh;\r\n\t\r\n\tTHREE.Mesh.prototype.updateMorphTargets = function () {\r\n\t\r\n\t\tif ( this.geometry.morphTargets !== undefined && this.geometry.morphTargets.length > 0 ) {\r\n\t\r\n\t\t\tthis.morphTargetBase = - 1;\r\n\t\t\tthis.morphTargetInfluences = [];\r\n\t\t\tthis.morphTargetDictionary = {};\r\n\t\r\n\t\t\tfor ( var m = 0, ml = this.geometry.morphTargets.length; m < ml; m ++ ) {\r\n\t\r\n\t\t\t\tthis.morphTargetInfluences.push( 0 );\r\n\t\t\t\tthis.morphTargetDictionary[ this.geometry.morphTargets[ m ].name ] = m;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Mesh.prototype.getMorphTargetIndexByName = function ( name ) {\r\n\t\r\n\t\tif ( this.morphTargetDictionary[ name ] !== undefined ) {\r\n\t\r\n\t\t\treturn this.morphTargetDictionary[ name ];\r\n\t\r\n\t\t}\r\n\t\r\n\t\tconsole.warn( 'THREE.Mesh.getMorphTargetIndexByName: morph target ' + name + ' does not exist. Returning 0.' );\r\n\t\r\n\t\treturn 0;\r\n\t\r\n\t};\r\n\t\r\n\t\r\n\tTHREE.Mesh.prototype.raycast = ( function () {\r\n\t\r\n\t\tvar inverseMatrix = new THREE.Matrix4();\r\n\t\tvar ray = new THREE.Ray();\r\n\t\tvar sphere = new THREE.Sphere();\r\n\t\r\n\t\tvar vA = new THREE.Vector3();\r\n\t\tvar vB = new THREE.Vector3();\r\n\t\tvar vC = new THREE.Vector3();\r\n\t\r\n\t\tvar tempA = new THREE.Vector3();\r\n\t\tvar tempB = new THREE.Vector3();\r\n\t\tvar tempC = new THREE.Vector3();\r\n\t\r\n\t\tvar uvA = new THREE.Vector2();\r\n\t\tvar uvB = new THREE.Vector2();\r\n\t\tvar uvC = new THREE.Vector2();\r\n\t\r\n\t\tvar barycoord = new THREE.Vector3();\r\n\t\r\n\t\tvar intersectionPoint = new THREE.Vector3();\r\n\t\tvar intersectionPointWorld = new THREE.Vector3();\r\n\t\r\n\t\tfunction uvIntersection( point, p1, p2, p3, uv1, uv2, uv3 ) {\r\n\t\r\n\t\t\tTHREE.Triangle.barycoordFromPoint( point, p1, p2, p3, barycoord );\r\n\t\r\n\t\t\tuv1.multiplyScalar( barycoord.x );\r\n\t\t\tuv2.multiplyScalar( barycoord.y );\r\n\t\t\tuv3.multiplyScalar( barycoord.z );\r\n\t\r\n\t\t\tuv1.add( uv2 ).add( uv3 );\r\n\t\r\n\t\t\treturn uv1.clone();\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction checkIntersection( object, raycaster, ray, pA, pB, pC, point ){\r\n\t\r\n\t\t\tvar intersect;\r\n\t\t\tvar material = object.material;\r\n\t\r\n\t\t\tif ( material.side === THREE.BackSide ) {\r\n\t\r\n\t\t\t\tintersect = ray.intersectTriangle( pC, pB, pA, true, point );\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\tintersect = ray.intersectTriangle( pA, pB, pC, material.side !== THREE.DoubleSide, point );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( intersect === null ) return null;\r\n\t\r\n\t\t\tintersectionPointWorld.copy( point );\r\n\t\t\tintersectionPointWorld.applyMatrix4( object.matrixWorld );\r\n\t\r\n\t\t\tvar distance = raycaster.ray.origin.distanceTo( intersectionPointWorld );\r\n\t\r\n\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) return null;\r\n\t\r\n\t\t\treturn {\r\n\t\t\t\tdistance: distance,\r\n\t\t\t\tpoint: intersectionPointWorld.clone(),\r\n\t\t\t\tobject: object\r\n\t\t\t};\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction checkBufferGeometryIntersection( object, raycaster, ray, positions, uvs, a, b, c ) {\r\n\t\r\n\t\t\tvA.fromArray( positions, a * 3 );\r\n\t\t\tvB.fromArray( positions, b * 3 );\r\n\t\t\tvC.fromArray( positions, c * 3 );\r\n\t\r\n\t\t\tvar intersection = checkIntersection( object, raycaster, ray, vA, vB, vC, intersectionPoint );\r\n\t\r\n\t\t\tif ( intersection ) {\r\n\t\r\n\t\t\t\tif ( uvs ) {\r\n\t\r\n\t\t\t\t\tuvA.fromArray( uvs, a * 2 );\r\n\t\t\t\t\tuvB.fromArray( uvs, b * 2 );\r\n\t\t\t\t\tuvC.fromArray( uvs, c * 2 );\r\n\t\r\n\t\t\t\t\tintersection.uv = uvIntersection( intersectionPoint,  vA, vB, vC,  uvA, uvB, uvC );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tintersection.face = new THREE.Face3( a, b, c, THREE.Triangle.normal( vA, vB, vC ) );\r\n\t\t\t\tintersection.faceIndex = a;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn intersection;\r\n\t\r\n\t\t}\r\n\t\r\n\t\treturn function raycast( raycaster, intersects ) {\r\n\t\r\n\t\t\tvar geometry = this.geometry;\r\n\t\t\tvar material = this.material;\r\n\t\r\n\t\t\tif ( material === undefined ) return;\r\n\t\r\n\t\t\t// Checking boundingSphere distance to ray\r\n\t\r\n\t\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\r\n\t\r\n\t\t\tvar matrixWorld = this.matrixWorld;\r\n\t\r\n\t\t\tsphere.copy( geometry.boundingSphere );\r\n\t\t\tsphere.applyMatrix4( matrixWorld );\r\n\t\r\n\t\t\tif ( raycaster.ray.isIntersectionSphere( sphere ) === false ) return;\r\n\t\r\n\t\t\t// Check boundingBox before continuing\r\n\t\r\n\t\t\tinverseMatrix.getInverse( matrixWorld );\r\n\t\t\tray.copy( raycaster.ray ).applyMatrix4( inverseMatrix );\r\n\t\r\n\t\t\tif ( geometry.boundingBox !== null ) {\r\n\t\r\n\t\t\t\tif ( ray.isIntersectionBox( geometry.boundingBox ) === false ) return;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar uvs, intersection;\r\n\t\r\n\t\t\tif ( geometry instanceof THREE.BufferGeometry ) {\r\n\t\r\n\t\t\t\tvar a, b, c;\r\n\t\t\t\tvar index = geometry.index;\r\n\t\t\t\tvar attributes = geometry.attributes;\r\n\t\t\t\tvar positions = attributes.position.array;\r\n\t\r\n\t\t\t\tif ( attributes.uv !== undefined ){\r\n\t\r\n\t\t\t\t\tuvs = attributes.uv.array;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( index !== null ) {\r\n\t\r\n\t\t\t\t\tvar indices = index.array;\r\n\t\r\n\t\t\t\t\tfor ( var i = 0, l = indices.length; i < l; i += 3 ) {\r\n\t\r\n\t\t\t\t\t\ta = indices[ i ];\r\n\t\t\t\t\t\tb = indices[ i + 1 ];\r\n\t\t\t\t\t\tc = indices[ i + 2 ];\r\n\t\r\n\t\t\t\t\t\tintersection = checkBufferGeometryIntersection( this, raycaster, ray, positions, uvs, a, b, c );\r\n\t\r\n\t\t\t\t\t\tif ( intersection ) {\r\n\t\r\n\t\t\t\t\t\t\tintersection.faceIndex = Math.floor( i / 3 ); // triangle number in indices buffer semantics\r\n\t\t\t\t\t\t\tintersects.push( intersection );\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\r\n\t\t\t\t\tfor ( var i = 0, l = positions.length; i < l; i += 9 ) {\r\n\t\r\n\t\t\t\t\t\ta = i / 3;\r\n\t\t\t\t\t\tb = a + 1;\r\n\t\t\t\t\t\tc = a + 2;\r\n\t\r\n\t\t\t\t\t\tintersection = checkBufferGeometryIntersection( this, raycaster, ray, positions, uvs, a, b, c );\r\n\t\r\n\t\t\t\t\t\tif ( intersection ) {\r\n\t\r\n\t\t\t\t\t\t\tintersection.index = a; // triangle number in positions buffer semantics\r\n\t\t\t\t\t\t\tintersects.push( intersection );\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t} else if ( geometry instanceof THREE.Geometry ) {\r\n\t\r\n\t\t\t\tvar fvA, fvB, fvC;\r\n\t\t\t\tvar isFaceMaterial = material instanceof THREE.MeshFaceMaterial;\r\n\t\t\t\tvar materials = isFaceMaterial === true ? material.materials : null;\r\n\t\r\n\t\t\t\tvar vertices = geometry.vertices;\r\n\t\t\t\tvar faces = geometry.faces;\r\n\t\t\t\tvar faceVertexUvs = geometry.faceVertexUvs[ 0 ];\r\n\t\t\t\tif ( faceVertexUvs.length > 0 ) uvs = faceVertexUvs;\r\n\t\r\n\t\t\t\tfor ( var f = 0, fl = faces.length; f < fl; f ++ ) {\r\n\t\r\n\t\t\t\t\tvar face = faces[ f ];\r\n\t\t\t\t\tvar faceMaterial = isFaceMaterial === true ? materials[ face.materialIndex ] : material;\r\n\t\r\n\t\t\t\t\tif ( faceMaterial === undefined ) continue;\r\n\t\r\n\t\t\t\t\tfvA = vertices[ face.a ];\r\n\t\t\t\t\tfvB = vertices[ face.b ];\r\n\t\t\t\t\tfvC = vertices[ face.c ];\r\n\t\r\n\t\t\t\t\tif ( faceMaterial.morphTargets === true ) {\r\n\t\r\n\t\t\t\t\t\tvar morphTargets = geometry.morphTargets;\r\n\t\t\t\t\t\tvar morphInfluences = this.morphTargetInfluences;\r\n\t\r\n\t\t\t\t\t\tvA.set( 0, 0, 0 );\r\n\t\t\t\t\t\tvB.set( 0, 0, 0 );\r\n\t\t\t\t\t\tvC.set( 0, 0, 0 );\r\n\t\r\n\t\t\t\t\t\tfor ( var t = 0, tl = morphTargets.length; t < tl; t ++ ) {\r\n\t\r\n\t\t\t\t\t\t\tvar influence = morphInfluences[ t ];\r\n\t\r\n\t\t\t\t\t\t\tif ( influence === 0 ) continue;\r\n\t\r\n\t\t\t\t\t\t\tvar targets = morphTargets[ t ].vertices;\r\n\t\r\n\t\t\t\t\t\t\tvA.addScaledVector( tempA.subVectors( targets[ face.a ], fvA ), influence );\r\n\t\t\t\t\t\t\tvB.addScaledVector( tempB.subVectors( targets[ face.b ], fvB ), influence );\r\n\t\t\t\t\t\t\tvC.addScaledVector( tempC.subVectors( targets[ face.c ], fvC ), influence );\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\tvA.add( fvA );\r\n\t\t\t\t\t\tvB.add( fvB );\r\n\t\t\t\t\t\tvC.add( fvC );\r\n\t\r\n\t\t\t\t\t\tfvA = vA;\r\n\t\t\t\t\t\tfvB = vB;\r\n\t\t\t\t\t\tfvC = vC;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tintersection = checkIntersection( this, raycaster, ray, fvA, fvB, fvC, intersectionPoint );\r\n\t\r\n\t\t\t\t\tif ( intersection ) {\r\n\t\r\n\t\t\t\t\t\tif ( uvs ) {\r\n\t\r\n\t\t\t\t\t\t\tvar uvs_f = uvs[ f ];\r\n\t\t\t\t\t\t\tuvA.copy( uvs_f[ 0 ] );\r\n\t\t\t\t\t\t\tuvB.copy( uvs_f[ 1 ] );\r\n\t\t\t\t\t\t\tuvC.copy( uvs_f[ 2 ] );\r\n\t\r\n\t\t\t\t\t\t\tintersection.uv = uvIntersection( intersectionPoint, fvA, fvB, fvC, uvA, uvB, uvC );\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\tintersection.face = face;\r\n\t\t\t\t\t\tintersection.faceIndex = f;\r\n\t\t\t\t\t\tintersects.push( intersection );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t};\r\n\t\r\n\t}() );\r\n\t\r\n\tTHREE.Mesh.prototype.clone = function () {\r\n\t\r\n\t\treturn new this.constructor( this.geometry, this.material ).copy( this );\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/objects/Bone.js\r\n\t\r\n\t/**\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author ikerr / http://verold.com\r\n\t */\r\n\t\r\n\tTHREE.Bone = function ( skin ) {\r\n\t\r\n\t\tTHREE.Object3D.call( this );\r\n\t\r\n\t\tthis.type = 'Bone';\r\n\t\r\n\t\tthis.skin = skin;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Bone.prototype = Object.create( THREE.Object3D.prototype );\r\n\tTHREE.Bone.prototype.constructor = THREE.Bone;\r\n\t\r\n\tTHREE.Bone.prototype.copy = function ( source ) {\r\n\t\t\r\n\t\tTHREE.Object3D.prototype.copy.call( this, source );\r\n\t\t\r\n\t\tthis.skin = source.skin;\r\n\t\t\r\n\t\treturn this;\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/objects/Skeleton.js\r\n\t\r\n\t/**\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author michael guerrero / http://realitymeltdown.com\r\n\t * @author ikerr / http://verold.com\r\n\t */\r\n\t\r\n\tTHREE.Skeleton = function ( bones, boneInverses, useVertexTexture ) {\r\n\t\r\n\t\tthis.useVertexTexture = useVertexTexture !== undefined ? useVertexTexture : true;\r\n\t\r\n\t\tthis.identityMatrix = new THREE.Matrix4();\r\n\t\r\n\t\t// copy the bone array\r\n\t\r\n\t\tbones = bones || [];\r\n\t\r\n\t\tthis.bones = bones.slice( 0 );\r\n\t\r\n\t\t// create a bone texture or an array of floats\r\n\t\r\n\t\tif ( this.useVertexTexture ) {\r\n\t\r\n\t\t\t// layout (1 matrix = 4 pixels)\r\n\t\t\t//      RGBA RGBA RGBA RGBA (=> column1, column2, column3, column4)\r\n\t\t\t//  with  8x8  pixel texture max   16 bones * 4 pixels =  (8 * 8)\r\n\t\t\t//       16x16 pixel texture max   64 bones * 4 pixels = (16 * 16)\r\n\t\t\t//       32x32 pixel texture max  256 bones * 4 pixels = (32 * 32)\r\n\t\t\t//       64x64 pixel texture max 1024 bones * 4 pixels = (64 * 64)\r\n\t\r\n\t\t\t\r\n\t\t\tvar size = Math.sqrt( this.bones.length * 4 ); // 4 pixels needed for 1 matrix\r\n\t\t\tsize = THREE.Math.nextPowerOfTwo( Math.ceil( size ) );\r\n\t\t\tsize = Math.max( size, 4 );\r\n\t\r\n\t\t\tthis.boneTextureWidth = size;\r\n\t\t\tthis.boneTextureHeight = size;\r\n\t\r\n\t\t\tthis.boneMatrices = new Float32Array( this.boneTextureWidth * this.boneTextureHeight * 4 ); // 4 floats per RGBA pixel\r\n\t\t\tthis.boneTexture = new THREE.DataTexture( this.boneMatrices, this.boneTextureWidth, this.boneTextureHeight, THREE.RGBAFormat, THREE.FloatType );\r\n\t\r\n\t\t} else {\r\n\t\r\n\t\t\tthis.boneMatrices = new Float32Array( 16 * this.bones.length );\r\n\t\r\n\t\t}\r\n\t\r\n\t\t// use the supplied bone inverses or calculate the inverses\r\n\t\r\n\t\tif ( boneInverses === undefined ) {\r\n\t\r\n\t\t\tthis.calculateInverses();\r\n\t\r\n\t\t} else {\r\n\t\r\n\t\t\tif ( this.bones.length === boneInverses.length ) {\r\n\t\r\n\t\t\t\tthis.boneInverses = boneInverses.slice( 0 );\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\tconsole.warn( 'THREE.Skeleton bonInverses is the wrong length.' );\r\n\t\r\n\t\t\t\tthis.boneInverses = [];\r\n\t\r\n\t\t\t\tfor ( var b = 0, bl = this.bones.length; b < bl; b ++ ) {\r\n\t\r\n\t\t\t\t\tthis.boneInverses.push( new THREE.Matrix4() );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Skeleton.prototype.calculateInverses = function () {\r\n\t\r\n\t\tthis.boneInverses = [];\r\n\t\r\n\t\tfor ( var b = 0, bl = this.bones.length; b < bl; b ++ ) {\r\n\t\r\n\t\t\tvar inverse = new THREE.Matrix4();\r\n\t\r\n\t\t\tif ( this.bones[ b ] ) {\r\n\t\r\n\t\t\t\tinverse.getInverse( this.bones[ b ].matrixWorld );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tthis.boneInverses.push( inverse );\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Skeleton.prototype.pose = function () {\r\n\t\r\n\t\tvar bone;\r\n\t\r\n\t\t// recover the bind-time world matrices\r\n\t\r\n\t\tfor ( var b = 0, bl = this.bones.length; b < bl; b ++ ) {\r\n\t\r\n\t\t\tbone = this.bones[ b ];\r\n\t\r\n\t\t\tif ( bone ) {\r\n\t\r\n\t\t\t\tbone.matrixWorld.getInverse( this.boneInverses[ b ] );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\t// compute the local matrices, positions, rotations and scales\r\n\t\r\n\t\tfor ( var b = 0, bl = this.bones.length; b < bl; b ++ ) {\r\n\t\r\n\t\t\tbone = this.bones[ b ];\r\n\t\r\n\t\t\tif ( bone ) {\r\n\t\r\n\t\t\t\tif ( bone.parent ) {\r\n\t\r\n\t\t\t\t\tbone.matrix.getInverse( bone.parent.matrixWorld );\r\n\t\t\t\t\tbone.matrix.multiply( bone.matrixWorld );\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tbone.matrix.copy( bone.matrixWorld );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tbone.matrix.decompose( bone.position, bone.quaternion, bone.scale );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Skeleton.prototype.update = ( function () {\r\n\t\r\n\t\tvar offsetMatrix = new THREE.Matrix4();\r\n\t\r\n\t\treturn function update() {\r\n\t\r\n\t\t\t// flatten bone matrices to array\r\n\t\r\n\t\t\tfor ( var b = 0, bl = this.bones.length; b < bl; b ++ ) {\r\n\t\r\n\t\t\t\t// compute the offset between the current and the original transform\r\n\t\r\n\t\t\t\tvar matrix = this.bones[ b ] ? this.bones[ b ].matrixWorld : this.identityMatrix;\r\n\t\r\n\t\t\t\toffsetMatrix.multiplyMatrices( matrix, this.boneInverses[ b ] );\r\n\t\t\t\toffsetMatrix.flattenToArrayOffset( this.boneMatrices, b * 16 );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( this.useVertexTexture ) {\r\n\t\r\n\t\t\t\tthis.boneTexture.needsUpdate = true;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t};\r\n\t\r\n\t} )();\r\n\t\r\n\tTHREE.Skeleton.prototype.clone = function () {\r\n\t\r\n\t\treturn new THREE.Skeleton( this.bones, this.boneInverses, this.useVertexTexture );\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/objects/SkinnedMesh.js\r\n\t\r\n\t/**\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author ikerr / http://verold.com\r\n\t */\r\n\t\r\n\tTHREE.SkinnedMesh = function ( geometry, material, useVertexTexture ) {\r\n\t\r\n\t\tTHREE.Mesh.call( this, geometry, material );\r\n\t\r\n\t\tthis.type = 'SkinnedMesh';\r\n\t\r\n\t\tthis.bindMode = \"attached\";\r\n\t\tthis.bindMatrix = new THREE.Matrix4();\r\n\t\tthis.bindMatrixInverse = new THREE.Matrix4();\r\n\t\r\n\t\t// init bones\r\n\t\r\n\t\t// TODO: remove bone creation as there is no reason (other than\r\n\t\t// convenience) for THREE.SkinnedMesh to do this.\r\n\t\r\n\t\tvar bones = [];\r\n\t\r\n\t\tif ( this.geometry && this.geometry.bones !== undefined ) {\r\n\t\r\n\t\t\tvar bone, gbone;\r\n\t\r\n\t\t\tfor ( var b = 0, bl = this.geometry.bones.length; b < bl; ++ b ) {\r\n\t\r\n\t\t\t\tgbone = this.geometry.bones[ b ];\r\n\t\r\n\t\t\t\tbone = new THREE.Bone( this );\r\n\t\t\t\tbones.push( bone );\r\n\t\r\n\t\t\t\tbone.name = gbone.name;\r\n\t\t\t\tbone.position.fromArray( gbone.pos );\r\n\t\t\t\tbone.quaternion.fromArray( gbone.rotq );\r\n\t\t\t\tif ( gbone.scl !== undefined ) bone.scale.fromArray( gbone.scl );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tfor ( var b = 0, bl = this.geometry.bones.length; b < bl; ++ b ) {\r\n\t\r\n\t\t\t\tgbone = this.geometry.bones[ b ];\r\n\t\r\n\t\t\t\tif ( gbone.parent !== - 1 && gbone.parent !== null) {\r\n\t\r\n\t\t\t\t\tbones[ gbone.parent ].add( bones[ b ] );\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tthis.add( bones[ b ] );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tthis.normalizeSkinWeights();\r\n\t\r\n\t\tthis.updateMatrixWorld( true );\r\n\t\tthis.bind( new THREE.Skeleton( bones, undefined, useVertexTexture ), this.matrixWorld );\r\n\t\r\n\t};\r\n\t\r\n\t\r\n\tTHREE.SkinnedMesh.prototype = Object.create( THREE.Mesh.prototype );\r\n\tTHREE.SkinnedMesh.prototype.constructor = THREE.SkinnedMesh;\r\n\t\r\n\tTHREE.SkinnedMesh.prototype.bind = function( skeleton, bindMatrix ) {\r\n\t\r\n\t\tthis.skeleton = skeleton;\r\n\t\r\n\t\tif ( bindMatrix === undefined ) {\r\n\t\r\n\t\t\tthis.updateMatrixWorld( true );\r\n\t\t\t\r\n\t\t\tthis.skeleton.calculateInverses();\r\n\t\r\n\t\t\tbindMatrix = this.matrixWorld;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tthis.bindMatrix.copy( bindMatrix );\r\n\t\tthis.bindMatrixInverse.getInverse( bindMatrix );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.SkinnedMesh.prototype.pose = function () {\r\n\t\r\n\t\tthis.skeleton.pose();\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.SkinnedMesh.prototype.normalizeSkinWeights = function () {\r\n\t\r\n\t\tif ( this.geometry instanceof THREE.Geometry ) {\r\n\t\r\n\t\t\tfor ( var i = 0; i < this.geometry.skinIndices.length; i ++ ) {\r\n\t\r\n\t\t\t\tvar sw = this.geometry.skinWeights[ i ];\r\n\t\r\n\t\t\t\tvar scale = 1.0 / sw.lengthManhattan();\r\n\t\r\n\t\t\t\tif ( scale !== Infinity ) {\r\n\t\r\n\t\t\t\t\tsw.multiplyScalar( scale );\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tsw.set( 1 ); // this will be normalized by the shader anyway\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t} else {\r\n\t\r\n\t\t\t// skinning weights assumed to be normalized for THREE.BufferGeometry\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.SkinnedMesh.prototype.updateMatrixWorld = function( force ) {\r\n\t\r\n\t\tTHREE.Mesh.prototype.updateMatrixWorld.call( this, true );\r\n\t\r\n\t\tif ( this.bindMode === \"attached\" ) {\r\n\t\r\n\t\t\tthis.bindMatrixInverse.getInverse( this.matrixWorld );\r\n\t\r\n\t\t} else if ( this.bindMode === \"detached\" ) {\r\n\t\r\n\t\t\tthis.bindMatrixInverse.getInverse( this.bindMatrix );\r\n\t\r\n\t\t} else {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.SkinnedMesh unrecognized bindMode: ' + this.bindMode );\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.SkinnedMesh.prototype.clone = function() {\r\n\t\r\n\t\treturn new this.constructor( this.geometry, this.material, this.useVertexTexture ).copy( this );\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/objects/LOD.js\r\n\t\r\n\t/**\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.LOD = function () {\r\n\t\r\n\t\tTHREE.Object3D.call( this );\r\n\t\r\n\t\tthis.type = 'LOD';\r\n\t\r\n\t\tObject.defineProperties( this, {\r\n\t\t\tlevels: {\r\n\t\t\t\tenumerable: true,\r\n\t\t\t\tvalue: []\r\n\t\t\t},\r\n\t\t\tobjects: {\r\n\t\t\t\tget: function () {\r\n\t\r\n\t\t\t\t\tconsole.warn( 'THREE.LOD: .objects has been renamed to .levels.' );\r\n\t\t\t\t\treturn this.levels;\r\n\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} );\r\n\t\r\n\t};\r\n\t\r\n\t\r\n\tTHREE.LOD.prototype = Object.create( THREE.Object3D.prototype );\r\n\tTHREE.LOD.prototype.constructor = THREE.LOD;\r\n\t\r\n\tTHREE.LOD.prototype.addLevel = function ( object, distance ) {\r\n\t\r\n\t\tif ( distance === undefined ) distance = 0;\r\n\t\r\n\t\tdistance = Math.abs( distance );\r\n\t\r\n\t\tvar levels = this.levels;\r\n\t\r\n\t\tfor ( var l = 0; l < levels.length; l ++ ) {\r\n\t\r\n\t\t\tif ( distance < levels[ l ].distance ) {\r\n\t\r\n\t\t\t\tbreak;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tlevels.splice( l, 0, { distance: distance, object: object } );\r\n\t\r\n\t\tthis.add( object );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.LOD.prototype.getObjectForDistance = function ( distance ) {\r\n\t\r\n\t\tvar levels = this.levels;\r\n\t\r\n\t\tfor ( var i = 1, l = levels.length; i < l; i ++ ) {\r\n\t\r\n\t\t\tif ( distance < levels[ i ].distance ) {\r\n\t\r\n\t\t\t\tbreak;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\treturn levels[ i - 1 ].object;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.LOD.prototype.raycast = ( function () {\r\n\t\r\n\t\tvar matrixPosition = new THREE.Vector3();\r\n\t\r\n\t\treturn function raycast( raycaster, intersects ) {\r\n\t\r\n\t\t\tmatrixPosition.setFromMatrixPosition( this.matrixWorld );\r\n\t\r\n\t\t\tvar distance = raycaster.ray.origin.distanceTo( matrixPosition );\r\n\t\r\n\t\t\tthis.getObjectForDistance( distance ).raycast( raycaster, intersects );\r\n\t\r\n\t\t};\r\n\t\r\n\t}() );\r\n\t\r\n\tTHREE.LOD.prototype.update = function () {\r\n\t\r\n\t\tvar v1 = new THREE.Vector3();\r\n\t\tvar v2 = new THREE.Vector3();\r\n\t\r\n\t\treturn function update( camera ) {\r\n\t\r\n\t\t\tvar levels = this.levels;\r\n\t\r\n\t\t\tif ( levels.length > 1 ) {\r\n\t\r\n\t\t\t\tv1.setFromMatrixPosition( camera.matrixWorld );\r\n\t\t\t\tv2.setFromMatrixPosition( this.matrixWorld );\r\n\t\r\n\t\t\t\tvar distance = v1.distanceTo( v2 );\r\n\t\r\n\t\t\t\tlevels[ 0 ].object.visible = true;\r\n\t\r\n\t\t\t\tfor ( var i = 1, l = levels.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\t\tif ( distance >= levels[ i ].distance ) {\r\n\t\r\n\t\t\t\t\t\tlevels[ i - 1 ].object.visible = false;\r\n\t\t\t\t\t\tlevels[ i ].object.visible = true;\r\n\t\r\n\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tfor ( ; i < l; i ++ ) {\r\n\t\r\n\t\t\t\t\tlevels[ i ].object.visible = false;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t};\r\n\t\r\n\t}();\r\n\t\r\n\tTHREE.LOD.prototype.copy = function ( source ) {\r\n\t\r\n\t\tTHREE.Object3D.prototype.copy.call( this, source, false );\r\n\t\r\n\t\tvar levels = source.levels;\r\n\t\r\n\t\tfor ( var i = 0, l = levels.length; i < l; i ++ ) {\r\n\t\r\n\t\t\tvar level = levels[ i ];\r\n\t\r\n\t\t\tthis.addLevel( level.object.clone(), level.distance );\r\n\t\r\n\t\t}\r\n\t\r\n\t\treturn this;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.LOD.prototype.toJSON = function ( meta ) {\r\n\t\r\n\t\tvar data = THREE.Object3D.prototype.toJSON.call( this, meta );\r\n\t\r\n\t\tdata.object.levels = [];\r\n\t\r\n\t\tvar levels = this.levels;\r\n\t\r\n\t\tfor ( var i = 0, l = levels.length; i < l; i ++ ) {\r\n\t\r\n\t\t\tvar level = levels[ i ];\r\n\t\r\n\t\t\tdata.object.levels.push( {\r\n\t\t\t\tobject: level.object.uuid,\r\n\t\t\t\tdistance: level.distance\r\n\t\t\t} );\r\n\t\r\n\t\t}\r\n\t\r\n\t\treturn data;\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/objects/Sprite.js\r\n\t\r\n\t/**\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\t\r\n\tTHREE.Sprite = ( function () {\r\n\t\r\n\t\tvar indices = new Uint16Array( [ 0, 1, 2,  0, 2, 3 ] );\r\n\t\tvar vertices = new Float32Array( [ - 0.5, - 0.5, 0,   0.5, - 0.5, 0,   0.5, 0.5, 0,   - 0.5, 0.5, 0 ] );\r\n\t\tvar uvs = new Float32Array( [ 0, 0,   1, 0,   1, 1,   0, 1 ] );\r\n\t\r\n\t\tvar geometry = new THREE.BufferGeometry();\r\n\t\tgeometry.setIndex( new THREE.BufferAttribute( indices, 1 ) );\r\n\t\tgeometry.addAttribute( 'position', new THREE.BufferAttribute( vertices, 3 ) );\r\n\t\tgeometry.addAttribute( 'uv', new THREE.BufferAttribute( uvs, 2 ) );\r\n\t\r\n\t\treturn function Sprite( material ) {\r\n\t\r\n\t\t\tTHREE.Object3D.call( this );\r\n\t\r\n\t\t\tthis.type = 'Sprite';\r\n\t\r\n\t\t\tthis.geometry = geometry;\r\n\t\t\tthis.material = ( material !== undefined ) ? material : new THREE.SpriteMaterial();\r\n\t\r\n\t\t};\r\n\t\r\n\t} )();\r\n\t\r\n\tTHREE.Sprite.prototype = Object.create( THREE.Object3D.prototype );\r\n\tTHREE.Sprite.prototype.constructor = THREE.Sprite;\r\n\t\r\n\tTHREE.Sprite.prototype.raycast = ( function () {\r\n\t\r\n\t\tvar matrixPosition = new THREE.Vector3();\r\n\t\r\n\t\treturn function raycast( raycaster, intersects ) {\r\n\t\r\n\t\t\tmatrixPosition.setFromMatrixPosition( this.matrixWorld );\r\n\t\r\n\t\t\tvar distanceSq = raycaster.ray.distanceSqToPoint( matrixPosition );\r\n\t\t\tvar guessSizeSq = this.scale.x * this.scale.y;\r\n\t\r\n\t\t\tif ( distanceSq > guessSizeSq ) {\r\n\t\r\n\t\t\t\treturn;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tintersects.push( {\r\n\t\r\n\t\t\t\tdistance: Math.sqrt( distanceSq ),\r\n\t\t\t\tpoint: this.position,\r\n\t\t\t\tface: null,\r\n\t\t\t\tobject: this\r\n\t\r\n\t\t\t} );\r\n\t\r\n\t\t};\r\n\t\r\n\t}() );\r\n\t\r\n\tTHREE.Sprite.prototype.clone = function () {\r\n\t\r\n\t\treturn new this.constructor( this.material ).copy( this );\r\n\t\r\n\t};\r\n\t\r\n\t// Backwards compatibility\r\n\t\r\n\tTHREE.Particle = THREE.Sprite;\r\n\t\r\n\t// File:src/objects/LensFlare.js\r\n\t\r\n\t/**\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\t\r\n\tTHREE.LensFlare = function ( texture, size, distance, blending, color ) {\r\n\t\r\n\t\tTHREE.Object3D.call( this );\r\n\t\r\n\t\tthis.lensFlares = [];\r\n\t\r\n\t\tthis.positionScreen = new THREE.Vector3();\r\n\t\tthis.customUpdateCallback = undefined;\r\n\t\r\n\t\tif ( texture !== undefined ) {\r\n\t\r\n\t\t\tthis.add( texture, size, distance, blending, color );\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.LensFlare.prototype = Object.create( THREE.Object3D.prototype );\r\n\tTHREE.LensFlare.prototype.constructor = THREE.LensFlare;\r\n\t\r\n\t\r\n\t/*\r\n\t * Add: adds another flare\r\n\t */\r\n\t\r\n\tTHREE.LensFlare.prototype.add = function ( texture, size, distance, blending, color, opacity ) {\r\n\t\r\n\t\tif ( size === undefined ) size = - 1;\r\n\t\tif ( distance === undefined ) distance = 0;\r\n\t\tif ( opacity === undefined ) opacity = 1;\r\n\t\tif ( color === undefined ) color = new THREE.Color( 0xffffff );\r\n\t\tif ( blending === undefined ) blending = THREE.NormalBlending;\r\n\t\r\n\t\tdistance = Math.min( distance, Math.max( 0, distance ) );\r\n\t\r\n\t\tthis.lensFlares.push( {\r\n\t\t\ttexture: texture,\t// THREE.Texture\r\n\t\t\tsize: size, \t\t// size in pixels (-1 = use texture.width)\r\n\t\t\tdistance: distance, \t// distance (0-1) from light source (0=at light source)\r\n\t\t\tx: 0, y: 0, z: 0,\t// screen position (-1 => 1) z = 0 is in front z = 1 is back\r\n\t\t\tscale: 1, \t\t// scale\r\n\t\t\trotation: 0, \t\t// rotation\r\n\t\t\topacity: opacity,\t// opacity\r\n\t\t\tcolor: color,\t\t// color\r\n\t\t\tblending: blending\t// blending\r\n\t\t} );\r\n\t\r\n\t};\r\n\t\r\n\t/*\r\n\t * Update lens flares update positions on all flares based on the screen position\r\n\t * Set myLensFlare.customUpdateCallback to alter the flares in your project specific way.\r\n\t */\r\n\t\r\n\tTHREE.LensFlare.prototype.updateLensFlares = function () {\r\n\t\r\n\t\tvar f, fl = this.lensFlares.length;\r\n\t\tvar flare;\r\n\t\tvar vecX = - this.positionScreen.x * 2;\r\n\t\tvar vecY = - this.positionScreen.y * 2;\r\n\t\r\n\t\tfor ( f = 0; f < fl; f ++ ) {\r\n\t\r\n\t\t\tflare = this.lensFlares[ f ];\r\n\t\r\n\t\t\tflare.x = this.positionScreen.x + vecX * flare.distance;\r\n\t\t\tflare.y = this.positionScreen.y + vecY * flare.distance;\r\n\t\r\n\t\t\tflare.wantedRotation = flare.x * Math.PI * 0.25;\r\n\t\t\tflare.rotation += ( flare.wantedRotation - flare.rotation ) * 0.25;\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.LensFlare.prototype.copy = function ( source ) {\r\n\t\r\n\t\tTHREE.Object3D.prototype.copy.call( this, source );\r\n\t\r\n\t\tthis.positionScreen.copy( source.positionScreen );\r\n\t\tthis.customUpdateCallback = source.customUpdateCallback;\r\n\t\r\n\t\tfor ( var i = 0, l = source.lensFlares.length; i < l; i ++ ) {\r\n\t\r\n\t\t\tthis.lensFlares.push( source.lensFlares[ i ] );\r\n\t\r\n\t\t}\r\n\t\r\n\t\treturn this;\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/scenes/Scene.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.Scene = function () {\r\n\t\r\n\t\tTHREE.Object3D.call( this );\r\n\t\r\n\t\tthis.type = 'Scene';\r\n\t\r\n\t\tthis.fog = null;\r\n\t\tthis.overrideMaterial = null;\r\n\t\r\n\t\tthis.autoUpdate = true; // checked by the renderer\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Scene.prototype = Object.create( THREE.Object3D.prototype );\r\n\tTHREE.Scene.prototype.constructor = THREE.Scene;\r\n\t\r\n\tTHREE.Scene.prototype.copy = function ( source ) {\r\n\t\r\n\t\tTHREE.Object3D.prototype.copy.call( this, source );\r\n\t\r\n\t\tif ( source.fog !== null ) this.fog = source.fog.clone();\r\n\t\tif ( source.overrideMaterial !== null ) this.overrideMaterial = source.overrideMaterial.clone();\r\n\t\r\n\t\tthis.autoUpdate = source.autoUpdate;\r\n\t\tthis.matrixAutoUpdate = source.matrixAutoUpdate;\r\n\t\r\n\t\treturn this;\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/scenes/Fog.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\t\r\n\tTHREE.Fog = function ( color, near, far ) {\r\n\t\r\n\t\tthis.name = '';\r\n\t\r\n\t\tthis.color = new THREE.Color( color );\r\n\t\r\n\t\tthis.near = ( near !== undefined ) ? near : 1;\r\n\t\tthis.far = ( far !== undefined ) ? far : 1000;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Fog.prototype.clone = function () {\r\n\t\r\n\t\treturn new THREE.Fog( this.color.getHex(), this.near, this.far );\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/scenes/FogExp2.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\t\r\n\tTHREE.FogExp2 = function ( color, density ) {\r\n\t\r\n\t\tthis.name = '';\r\n\t\r\n\t\tthis.color = new THREE.Color( color );\r\n\t\tthis.density = ( density !== undefined ) ? density : 0.00025;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.FogExp2.prototype.clone = function () {\r\n\t\r\n\t\treturn new THREE.FogExp2( this.color.getHex(), this.density );\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk.js\r\n\t\r\n\tTHREE.ShaderChunk = {};\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/alphamap_fragment.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'alphamap_fragment'] = \"#ifdef USE_ALPHAMAP\\n\\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\\n\\n#endif\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/alphamap_pars_fragment.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'alphamap_pars_fragment'] = \"#ifdef USE_ALPHAMAP\\n\\n\tuniform sampler2D alphaMap;\\n\\n#endif\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/alphatest_fragment.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'alphatest_fragment'] = \"#ifdef ALPHATEST\\n\\n\tif ( diffuseColor.a < ALPHATEST ) discard;\\n\\n#endif\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/aomap_fragment.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'aomap_fragment'] = \"#ifdef USE_AOMAP\\n\\n\ttotalAmbientLight *= ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\\n\\n#endif\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/aomap_pars_fragment.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'aomap_pars_fragment'] = \"#ifdef USE_AOMAP\\n\\n\tuniform sampler2D aoMap;\\n\tuniform float aoMapIntensity;\\n\\n#endif\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/begin_vertex.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'begin_vertex'] = \"\\nvec3 transformed = vec3( position );\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/beginnormal_vertex.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'beginnormal_vertex'] = \"\\nvec3 objectNormal = vec3( normal );\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/bumpmap_pars_fragment.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'bumpmap_pars_fragment'] = \"#ifdef USE_BUMPMAP\\n\\n\tuniform sampler2D bumpMap;\\n\tuniform float bumpScale;\\n\\n\\n\\n\tvec2 dHdxy_fwd() {\\n\\n\t\tvec2 dSTdx = dFdx( vUv );\\n\t\tvec2 dSTdy = dFdy( vUv );\\n\\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\\n\\n\t\treturn vec2( dBx, dBy );\\n\\n\t}\\n\\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\\n\\n\t\tvec3 vSigmaX = dFdx( surf_pos );\\n\t\tvec3 vSigmaY = dFdy( surf_pos );\\n\t\tvec3 vN = surf_norm;\\n\t\tvec3 R1 = cross( vSigmaY, vN );\\n\t\tvec3 R2 = cross( vN, vSigmaX );\\n\\n\t\tfloat fDet = dot( vSigmaX, R1 );\\n\\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\\n\\n\t}\\n\\n#endif\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/color_fragment.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'color_fragment'] = \"#ifdef USE_COLOR\\n\\n\tdiffuseColor.rgb *= vColor;\\n\\n#endif\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/color_pars_fragment.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'color_pars_fragment'] = \"#ifdef USE_COLOR\\n\\n\tvarying vec3 vColor;\\n\\n#endif\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/color_pars_vertex.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'color_pars_vertex'] = \"#ifdef USE_COLOR\\n\\n\tvarying vec3 vColor;\\n\\n#endif\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/color_vertex.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'color_vertex'] = \"#ifdef USE_COLOR\\n\\n\tvColor.xyz = color.xyz;\\n\\n#endif\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/common.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'common'] = \"#define PI 3.14159\\n#define PI2 6.28318\\n#define RECIPROCAL_PI2 0.15915494\\n#define LOG2 1.442695\\n#define EPSILON 1e-6\\n\\n#define saturate(a) clamp( a, 0.0, 1.0 )\\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\\n\\nvec3 transformDirection( in vec3 normal, in mat4 matrix ) {\\n\\n\treturn normalize( ( matrix * vec4( normal, 0.0 ) ).xyz );\\n\\n}\\n\\nvec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {\\n\\n\treturn normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );\\n\\n}\\n\\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\\n\\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\\n\\n\treturn - distance * planeNormal + point;\\n\\n}\\n\\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\\n\\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\\n\\n}\\n\\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\\n\\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\\n\\n}\\n\\nfloat calcLightAttenuation( float lightDistance, float cutoffDistance, float decayExponent ) {\\n\\n\tif ( decayExponent > 0.0 ) {\\n\\n\t  return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\\n\\n\t}\\n\\n\treturn 1.0;\\n\\n}\\n\\nvec3 F_Schlick( in vec3 specularColor, in float dotLH ) {\\n\\n\\n\tfloat fresnel = exp2( ( -5.55437 * dotLH - 6.98316 ) * dotLH );\\n\\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\\n\\n}\\n\\nfloat G_BlinnPhong_Implicit( /* in float dotNL, in float dotNV */ ) {\\n\\n\\n\treturn 0.25;\\n\\n}\\n\\nfloat D_BlinnPhong( in float shininess, in float dotNH ) {\\n\\n\\n\treturn ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\\n\\n}\\n\\nvec3 BRDF_BlinnPhong( in vec3 specularColor, in float shininess, in vec3 normal, in vec3 lightDir, in vec3 viewDir ) {\\n\\n\tvec3 halfDir = normalize( lightDir + viewDir );\\n\\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\\n\tfloat dotLH = saturate( dot( lightDir, halfDir ) );\\n\\n\tvec3 F = F_Schlick( specularColor, dotLH );\\n\\n\tfloat G = G_BlinnPhong_Implicit( /* dotNL, dotNV */ );\\n\\n\tfloat D = D_BlinnPhong( shininess, dotNH );\\n\\n\treturn F * G * D;\\n\\n}\\n\\nvec3 inputToLinear( in vec3 a ) {\\n\\n\t#ifdef GAMMA_INPUT\\n\\n\t\treturn pow( a, vec3( float( GAMMA_FACTOR ) ) );\\n\\n\t#else\\n\\n\t\treturn a;\\n\\n\t#endif\\n\\n}\\n\\nvec3 linearToOutput( in vec3 a ) {\\n\\n\t#ifdef GAMMA_OUTPUT\\n\\n\t\treturn pow( a, vec3( 1.0 / float( GAMMA_FACTOR ) ) );\\n\\n\t#else\\n\\n\t\treturn a;\\n\\n\t#endif\\n\\n}\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/defaultnormal_vertex.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'defaultnormal_vertex'] = \"#ifdef FLIP_SIDED\\n\\n\tobjectNormal = -objectNormal;\\n\\n#endif\\n\\nvec3 transformedNormal = normalMatrix * objectNormal;\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/displacementmap_vertex.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'displacementmap_vertex'] = \"#ifdef USE_DISPLACEMENTMAP\\n\\n\ttransformed += normal * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\\n\\n#endif\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/displacementmap_pars_vertex.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'displacementmap_pars_vertex'] = \"#ifdef USE_DISPLACEMENTMAP\\n\\n\tuniform sampler2D displacementMap;\\n\tuniform float displacementScale;\\n\tuniform float displacementBias;\\n\\n#endif\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/emissivemap_fragment.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'emissivemap_fragment'] = \"#ifdef USE_EMISSIVEMAP\\n\\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\\n\\n\temissiveColor.rgb = inputToLinear( emissiveColor.rgb );\\n\\n\ttotalEmissiveLight *= emissiveColor.rgb;\\n\\n#endif\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/emissivemap_pars_fragment.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'emissivemap_pars_fragment'] = \"#ifdef USE_EMISSIVEMAP\\n\\n\tuniform sampler2D emissiveMap;\\n\\n#endif\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/envmap_fragment.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'envmap_fragment'] = \"#ifdef USE_ENVMAP\\n\\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\\n\\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\\n\\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\\n\\n\t\t#ifdef ENVMAP_MODE_REFLECTION\\n\\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\\n\\n\t\t#else\\n\\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\\n\\n\t\t#endif\\n\\n\t#else\\n\\n\t\tvec3 reflectVec = vReflect;\\n\\n\t#endif\\n\\n\t#ifdef DOUBLE_SIDED\\n\t\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\\n\t#else\\n\t\tfloat flipNormal = 1.0;\\n\t#endif\\n\\n\t#ifdef ENVMAP_TYPE_CUBE\\n\t\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\\n\\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\\n\t\tvec2 sampleUV;\\n\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\\n\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\\n\\n\t#elif defined( ENVMAP_TYPE_SPHERE )\\n\t\tvec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\\n\t#endif\\n\\n\tenvColor.xyz = inputToLinear( envColor.xyz );\\n\\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\\n\\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\\n\\n\t#elif defined( ENVMAP_BLENDING_MIX )\\n\\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\\n\\n\t#elif defined( ENVMAP_BLENDING_ADD )\\n\\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\\n\\n\t#endif\\n\\n#endif\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/envmap_pars_fragment.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'envmap_pars_fragment'] = \"#ifdef USE_ENVMAP\\n\\n\tuniform float reflectivity;\\n\t#ifdef ENVMAP_TYPE_CUBE\\n\t\tuniform samplerCube envMap;\\n\t#else\\n\t\tuniform sampler2D envMap;\\n\t#endif\\n\tuniform float flipEnvMap;\\n\\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\\n\\n\t\tuniform float refractionRatio;\\n\\n\t#else\\n\\n\t\tvarying vec3 vReflect;\\n\\n\t#endif\\n\\n#endif\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/envmap_pars_vertex.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'envmap_pars_vertex'] = \"#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\\n\\n\tvarying vec3 vReflect;\\n\\n\tuniform float refractionRatio;\\n\\n#endif\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/envmap_vertex.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'envmap_vertex'] = \"#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\\n\\n\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\\n\\n\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\\n\\n\t#ifdef ENVMAP_MODE_REFLECTION\\n\\n\t\tvReflect = reflect( cameraToVertex, worldNormal );\\n\\n\t#else\\n\\n\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\\n\\n\t#endif\\n\\n#endif\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/fog_fragment.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'fog_fragment'] = \"#ifdef USE_FOG\\n\\n\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\\n\\n\t#else\\n\\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\\n\\n\t#endif\\n\\n\t#ifdef FOG_EXP2\\n\\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * depth * depth * LOG2 ) );\\n\\n\t#else\\n\\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, depth );\\n\\n\t#endif\\n\t\\n\toutgoingLight = mix( outgoingLight, fogColor, fogFactor );\\n\\n#endif\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/fog_pars_fragment.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'fog_pars_fragment'] = \"#ifdef USE_FOG\\n\\n\tuniform vec3 fogColor;\\n\\n\t#ifdef FOG_EXP2\\n\\n\t\tuniform float fogDensity;\\n\\n\t#else\\n\\n\t\tuniform float fogNear;\\n\t\tuniform float fogFar;\\n\t#endif\\n\\n#endif\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/hemilight_fragment.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'hemilight_fragment'] = \"#if MAX_HEMI_LIGHTS > 0\\n\\n\tfor ( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\\n\\n\t\tvec3 lightDir = hemisphereLightDirection[ i ];\\n\\n\t\tfloat dotProduct = dot( normal, lightDir );\\n\\n\t\tfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\\n\\n\t\tvec3 lightColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\\n\\n\t\ttotalAmbientLight += lightColor;\\n\\n\t}\\n\\n#endif\\n\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/lightmap_fragment.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'lightmap_fragment'] = \"#ifdef USE_LIGHTMAP\\n\\n\ttotalAmbientLight += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\\n\\n#endif\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/lightmap_pars_fragment.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'lightmap_pars_fragment'] = \"#ifdef USE_LIGHTMAP\\n\\n\tuniform sampler2D lightMap;\\n\tuniform float lightMapIntensity;\\n\\n#endif\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/lights_lambert_pars_vertex.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'lights_lambert_pars_vertex'] = \"#if MAX_DIR_LIGHTS > 0\\n\\n\tuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\\n\tuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_HEMI_LIGHTS > 0\\n\\n\tuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\\n\tuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\\n\tuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_POINT_LIGHTS > 0\\n\\n\tuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\\n\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\\n\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\\n\tuniform float pointLightDecay[ MAX_POINT_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0\\n\\n\tuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\\n\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\\n\tuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\\n\\n#endif\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/lights_lambert_vertex.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'lights_lambert_vertex'] = \"vLightFront = vec3( 0.0 );\\n\\n#ifdef DOUBLE_SIDED\\n\\n\tvLightBack = vec3( 0.0 );\\n\\n#endif\\n\\nvec3 normal = normalize( transformedNormal );\\n\\n#if MAX_POINT_LIGHTS > 0\\n\\n\tfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\\n\\n\t\tvec3 lightColor = pointLightColor[ i ];\\n\\n\t\tvec3 lVector = pointLightPosition[ i ] - mvPosition.xyz;\\n\t\tvec3 lightDir = normalize( lVector );\\n\\n\\n\t\tfloat attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\\n\\n\\n\t\tfloat dotProduct = dot( normal, lightDir );\\n\\n\t\tvLightFront += lightColor * attenuation * saturate( dotProduct );\\n\\n\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\tvLightBack += lightColor * attenuation * saturate( - dotProduct );\\n\\n\t\t#endif\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0\\n\\n\tfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\\n\\n\t\tvec3 lightColor = spotLightColor[ i ];\\n\\n\t\tvec3 lightPosition = spotLightPosition[ i ];\\n\t\tvec3 lVector = lightPosition - mvPosition.xyz;\\n\t\tvec3 lightDir = normalize( lVector );\\n\\n\t\tfloat spotEffect = dot( spotLightDirection[ i ], lightDir );\\n\\n\t\tif ( spotEffect > spotLightAngleCos[ i ] ) {\\n\\n\t\t\tspotEffect = saturate( pow( saturate( spotEffect ), spotLightExponent[ i ] ) );\\n\\n\\n\t\t\tfloat attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\\n\\n\t\t\tattenuation *= spotEffect;\\n\\n\\n\t\t\tfloat dotProduct = dot( normal, lightDir );\\n\\n\t\t\tvLightFront += lightColor * attenuation * saturate( dotProduct );\\n\\n\t\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\t\tvLightBack += lightColor * attenuation * saturate( - dotProduct );\\n\\n\t\t\t#endif\\n\\n\t\t}\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_DIR_LIGHTS > 0\\n\\n\tfor ( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\\n\\n\t\tvec3 lightColor = directionalLightColor[ i ];\\n\\n\t\tvec3 lightDir = directionalLightDirection[ i ];\\n\\n\\n\t\tfloat dotProduct = dot( normal, lightDir );\\n\\n\t\tvLightFront += lightColor * saturate( dotProduct );\\n\\n\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\tvLightBack += lightColor * saturate( - dotProduct );\\n\\n\t\t#endif\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_HEMI_LIGHTS > 0\\n\\n\tfor ( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\\n\\n\t\tvec3 lightDir = hemisphereLightDirection[ i ];\\n\\n\\n\t\tfloat dotProduct = dot( normal, lightDir );\\n\\n\t\tfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\\n\\n\t\tvLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\\n\\n\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\tfloat hemiDiffuseWeightBack = - 0.5 * dotProduct + 0.5;\\n\\n\t\t\tvLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );\\n\\n\t\t#endif\\n\\n\t}\\n\\n#endif\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/lights_phong_fragment.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'lights_phong_fragment'] = \"vec3 viewDir = normalize( vViewPosition );\\n\\nvec3 totalDiffuseLight = vec3( 0.0 );\\nvec3 totalSpecularLight = vec3( 0.0 );\\n\\n#if MAX_POINT_LIGHTS > 0\\n\\n\tfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\\n\\n\t\tvec3 lightColor = pointLightColor[ i ];\\n\\n\t\tvec3 lightPosition = pointLightPosition[ i ];\\n\t\tvec3 lVector = lightPosition + vViewPosition.xyz;\\n\t\tvec3 lightDir = normalize( lVector );\\n\\n\\n\t\tfloat attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\\n\\n\\n\t\tfloat cosineTerm = saturate( dot( normal, lightDir ) );\\n\\n\t\ttotalDiffuseLight += lightColor * attenuation * cosineTerm;\\n\\n\\n\t\tvec3 brdf = BRDF_BlinnPhong( specular, shininess, normal, lightDir, viewDir );\\n\\n\t\ttotalSpecularLight += brdf * specularStrength * lightColor * attenuation * cosineTerm;\\n\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0\\n\\n\tfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\\n\\n\t\tvec3 lightColor = spotLightColor[ i ];\\n\\n\t\tvec3 lightPosition = spotLightPosition[ i ];\\n\t\tvec3 lVector = lightPosition + vViewPosition.xyz;\\n\t\tvec3 lightDir = normalize( lVector );\\n\\n\t\tfloat spotEffect = dot( spotLightDirection[ i ], lightDir );\\n\\n\t\tif ( spotEffect > spotLightAngleCos[ i ] ) {\\n\\n\t\t\tspotEffect = saturate( pow( saturate( spotEffect ), spotLightExponent[ i ] ) );\\n\\n\\n\t\t\tfloat attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\\n\\n\t\t\tattenuation *= spotEffect;\\n\\n\\n\t\t\tfloat cosineTerm = saturate( dot( normal, lightDir ) );\\n\\n\t\t\ttotalDiffuseLight += lightColor * attenuation * cosineTerm;\\n\\n\\n\t\t\tvec3 brdf = BRDF_BlinnPhong( specular, shininess, normal, lightDir, viewDir );\\n\\n\t\t\ttotalSpecularLight += brdf * specularStrength * lightColor * attenuation * cosineTerm;\\n\\n\t\t}\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_DIR_LIGHTS > 0\\n\\n\tfor ( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\\n\\n\t\tvec3 lightColor = directionalLightColor[ i ];\\n\\n\t\tvec3 lightDir = directionalLightDirection[ i ];\\n\\n\\n\t\tfloat cosineTerm = saturate( dot( normal, lightDir ) );\\n\\n\t\ttotalDiffuseLight += lightColor * cosineTerm;\\n\\n\\n\t\tvec3 brdf = BRDF_BlinnPhong( specular, shininess, normal, lightDir, viewDir );\\n\\n\t\ttotalSpecularLight += brdf * specularStrength * lightColor * cosineTerm;\\n\\n\t}\\n\\n#endif\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/lights_phong_pars_fragment.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'lights_phong_pars_fragment'] = \"uniform vec3 ambientLightColor;\\n\\n#if MAX_DIR_LIGHTS > 0\\n\\n\tuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\\n\tuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_HEMI_LIGHTS > 0\\n\\n\tuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\\n\tuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\\n\tuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_POINT_LIGHTS > 0\\n\\n\tuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\\n\\n\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\\n\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\\n\tuniform float pointLightDecay[ MAX_POINT_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0\\n\\n\tuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\\n\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\\n\tuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_ENVMAP )\\n\\n\tvarying vec3 vWorldPosition;\\n\\n#endif\\n\\nvarying vec3 vViewPosition;\\n\\n#ifndef FLAT_SHADED\\n\\n\tvarying vec3 vNormal;\\n\\n#endif\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/lights_phong_pars_vertex.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'lights_phong_pars_vertex'] = \"#if MAX_SPOT_LIGHTS > 0 || defined( USE_ENVMAP )\\n\\n\tvarying vec3 vWorldPosition;\\n\\n#endif\\n\\n#if MAX_POINT_LIGHTS > 0\\n\\n\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\\n\\n#endif\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/lights_phong_vertex.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'lights_phong_vertex'] = \"#if MAX_SPOT_LIGHTS > 0 || defined( USE_ENVMAP )\\n\\n\tvWorldPosition = worldPosition.xyz;\\n\\n#endif\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/linear_to_gamma_fragment.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'linear_to_gamma_fragment'] = \"\\n\toutgoingLight = linearToOutput( outgoingLight );\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/logdepthbuf_fragment.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'logdepthbuf_fragment'] = \"#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\\n\\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\\n\\n#endif\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/logdepthbuf_pars_fragment.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'logdepthbuf_pars_fragment'] = \"#ifdef USE_LOGDEPTHBUF\\n\\n\tuniform float logDepthBufFC;\\n\\n\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\n\t\tvarying float vFragDepth;\\n\\n\t#endif\\n\\n#endif\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/logdepthbuf_pars_vertex.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'logdepthbuf_pars_vertex'] = \"#ifdef USE_LOGDEPTHBUF\\n\\n\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\n\t\tvarying float vFragDepth;\\n\\n\t#endif\\n\\n\tuniform float logDepthBufFC;\\n\\n#endif\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/logdepthbuf_vertex.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'logdepthbuf_vertex'] = \"#ifdef USE_LOGDEPTHBUF\\n\\n\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\\n\\n\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\n\t\tvFragDepth = 1.0 + gl_Position.w;\\n\\n#else\\n\\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\\n\\n\t#endif\\n\\n#endif\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/map_fragment.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'map_fragment'] = \"#ifdef USE_MAP\\n\\n\tvec4 texelColor = texture2D( map, vUv );\\n\\n\ttexelColor.xyz = inputToLinear( texelColor.xyz );\\n\\n\tdiffuseColor *= texelColor;\\n\\n#endif\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/map_pars_fragment.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'map_pars_fragment'] = \"#ifdef USE_MAP\\n\\n\tuniform sampler2D map;\\n\\n#endif\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/map_particle_fragment.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'map_particle_fragment'] = \"#ifdef USE_MAP\\n\\n\tdiffuseColor *= texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\\n\\n#endif\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/map_particle_pars_fragment.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'map_particle_pars_fragment'] = \"#ifdef USE_MAP\\n\\n\tuniform vec4 offsetRepeat;\\n\tuniform sampler2D map;\\n\\n#endif\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/morphnormal_vertex.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'morphnormal_vertex'] = \"#ifdef USE_MORPHNORMALS\\n\\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\\n\\n#endif\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/morphtarget_pars_vertex.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'morphtarget_pars_vertex'] = \"#ifdef USE_MORPHTARGETS\\n\\n\t#ifndef USE_MORPHNORMALS\\n\\n\tuniform float morphTargetInfluences[ 8 ];\\n\\n\t#else\\n\\n\tuniform float morphTargetInfluences[ 4 ];\\n\\n\t#endif\\n\\n#endif\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/morphtarget_vertex.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'morphtarget_vertex'] = \"#ifdef USE_MORPHTARGETS\\n\\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\\n\\n\t#ifndef USE_MORPHNORMALS\\n\\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\\n\\n\t#endif\\n\\n#endif\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/normal_phong_fragment.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'normal_phong_fragment'] = \"#ifndef FLAT_SHADED\\n\\n\tvec3 normal = normalize( vNormal );\\n\\n\t#ifdef DOUBLE_SIDED\\n\\n\t\tnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\\n\\n\t#endif\\n\\n#else\\n\\n\tvec3 fdx = dFdx( vViewPosition );\\n\tvec3 fdy = dFdy( vViewPosition );\\n\tvec3 normal = normalize( cross( fdx, fdy ) );\\n\\n#endif\\n\\n#ifdef USE_NORMALMAP\\n\\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\\n\\n#elif defined( USE_BUMPMAP )\\n\\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\\n\\n#endif\\n\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/normalmap_pars_fragment.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'normalmap_pars_fragment'] = \"#ifdef USE_NORMALMAP\\n\\n\tuniform sampler2D normalMap;\\n\tuniform vec2 normalScale;\\n\\n\\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\\n\\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\\n\t\tvec2 st0 = dFdx( vUv.st );\\n\t\tvec2 st1 = dFdy( vUv.st );\\n\\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\\n\t\tvec3 N = normalize( surf_norm );\\n\\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\\n\t\tmapN.xy = normalScale * mapN.xy;\\n\t\tmat3 tsn = mat3( S, T, N );\\n\t\treturn normalize( tsn * mapN );\\n\\n\t}\\n\\n#endif\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/project_vertex.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'project_vertex'] = \"#ifdef USE_SKINNING\\n\\n\tvec4 mvPosition = modelViewMatrix * skinned;\\n\\n#else\\n\\n\tvec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\\n\\n#endif\\n\\ngl_Position = projectionMatrix * mvPosition;\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/shadowmap_fragment.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'shadowmap_fragment'] = \"#ifdef USE_SHADOWMAP\\n\\n\tfor ( int i = 0; i < MAX_SHADOWS; i ++ ) {\\n\\n\t\tfloat texelSizeY =  1.0 / shadowMapSize[ i ].y;\\n\\n\t\tfloat shadow = 0.0;\\n\\n#if defined( POINT_LIGHT_SHADOWS )\\n\\n\t\tbool isPointLight = shadowDarkness[ i ] < 0.0;\\n\\n\t\tif ( isPointLight ) {\\n\\n\t\t\tfloat realShadowDarkness = abs( shadowDarkness[ i ] );\\n\\n\t\t\tvec3 lightToPosition = vShadowCoord[ i ].xyz;\\n\\n\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\\n\\n\t\t\tvec3 bd3D = normalize( lightToPosition );\\n\t\t\tfloat dp = length( lightToPosition );\\n\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D, texelSizeY ) ), shadowBias[ i ], shadow );\\n\\n\\n\t#if defined( SHADOWMAP_TYPE_PCF )\\n\t\t\tconst float Dr = 1.25;\\n\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\\n\t\t\tconst float Dr = 2.25;\\n\t#endif\\n\\n\t\t\tfloat os = Dr *  2.0 * texelSizeY;\\n\\n\t\t\tconst vec3 Gsd = vec3( - 1, 0, 1 );\\n\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.zzz * os, texelSizeY ) ), shadowBias[ i ], shadow );\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.zxz * os, texelSizeY ) ), shadowBias[ i ], shadow );\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.xxz * os, texelSizeY ) ), shadowBias[ i ], shadow );\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.xzz * os, texelSizeY ) ), shadowBias[ i ], shadow );\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.zzx * os, texelSizeY ) ), shadowBias[ i ], shadow );\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.zxx * os, texelSizeY ) ), shadowBias[ i ], shadow );\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.xxx * os, texelSizeY ) ), shadowBias[ i ], shadow );\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.xzx * os, texelSizeY ) ), shadowBias[ i ], shadow );\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.zzy * os, texelSizeY ) ), shadowBias[ i ], shadow );\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.zxy * os, texelSizeY ) ), shadowBias[ i ], shadow );\\n\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.xxy * os, texelSizeY ) ), shadowBias[ i ], shadow );\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.xzy * os, texelSizeY ) ), shadowBias[ i ], shadow );\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.zyz * os, texelSizeY ) ), shadowBias[ i ], shadow );\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.xyz * os, texelSizeY ) ), shadowBias[ i ], shadow );\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.zyx * os, texelSizeY ) ), shadowBias[ i ], shadow );\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.xyx * os, texelSizeY ) ), shadowBias[ i ], shadow );\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.yzz * os, texelSizeY ) ), shadowBias[ i ], shadow );\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.yxz * os, texelSizeY ) ), shadowBias[ i ], shadow );\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.yxx * os, texelSizeY ) ), shadowBias[ i ], shadow );\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.yzx * os, texelSizeY ) ), shadowBias[ i ], shadow );\\n\\n\t\t\tshadow *= realShadowDarkness * ( 1.0 / 21.0 );\\n\\n\t#else \\n\t\t\tvec3 bd3D = normalize( lightToPosition );\\n\t\t\tfloat dp = length( lightToPosition );\\n\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D, texelSizeY ) ), shadowBias[ i ], shadow );\\n\\n\t\t\tshadow *= realShadowDarkness;\\n\\n\t#endif\\n\\n\t\t} else {\\n\\n#endif \\n\t\t\tfloat texelSizeX =  1.0 / shadowMapSize[ i ].x;\\n\\n\t\t\tvec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\\n\\n\\n\t\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\\n\t\t\tbool inFrustum = all( inFrustumVec );\\n\\n\t\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\\n\\n\t\t\tbool frustumTest = all( frustumTestVec );\\n\\n\t\t\tif ( frustumTest ) {\\n\\n\t#if defined( SHADOWMAP_TYPE_PCF )\\n\\n\\n\t\t\t\t/*\\n\t\t\t\t\tfor ( float y = -1.25; y <= 1.25; y += 1.25 )\\n\t\t\t\t\t\tfor ( float x = -1.25; x <= 1.25; x += 1.25 ) {\\n\t\t\t\t\t\t\tvec4 rgbaDepth = texture2D( shadowMap[ i ], vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy );\\n\t\t\t\t\t\t\tfloat fDepth = unpackDepth( rgbaDepth );\\n\t\t\t\t\t\t\tif ( fDepth < shadowCoord.z )\\n\t\t\t\t\t\t\t\tshadow += 1.0;\\n\t\t\t\t\t}\\n\t\t\t\t\tshadow /= 9.0;\\n\t\t\t\t*/\\n\\n\t\t\t\tshadowCoord.z += shadowBias[ i ];\\n\\n\t\t\t\tconst float ShadowDelta = 1.0 / 9.0;\\n\\n\t\t\t\tfloat xPixelOffset = texelSizeX;\\n\t\t\t\tfloat yPixelOffset = texelSizeY;\\n\\n\t\t\t\tfloat dx0 = - 1.25 * xPixelOffset;\\n\t\t\t\tfloat dy0 = - 1.25 * yPixelOffset;\\n\t\t\t\tfloat dx1 = 1.25 * xPixelOffset;\\n\t\t\t\tfloat dy1 = 1.25 * yPixelOffset;\\n\\n\t\t\t\tfloat fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += ShadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += ShadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += ShadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += ShadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += ShadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += ShadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += ShadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += ShadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += ShadowDelta;\\n\\n\t\t\t\tshadow *= shadowDarkness[ i ];\\n\\n\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\\n\\n\\n\t\t\t\tshadowCoord.z += shadowBias[ i ];\\n\\n\t\t\t\tfloat xPixelOffset = texelSizeX;\\n\t\t\t\tfloat yPixelOffset = texelSizeY;\\n\\n\t\t\t\tfloat dx0 = - 1.0 * xPixelOffset;\\n\t\t\t\tfloat dy0 = - 1.0 * yPixelOffset;\\n\t\t\t\tfloat dx1 = 1.0 * xPixelOffset;\\n\t\t\t\tfloat dy1 = 1.0 * yPixelOffset;\\n\\n\t\t\t\tmat3 shadowKernel;\\n\t\t\t\tmat3 depthKernel;\\n\\n\t\t\t\tdepthKernel[ 0 ][ 0 ] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\\n\t\t\t\tdepthKernel[ 0 ][ 1 ] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\\n\t\t\t\tdepthKernel[ 0 ][ 2 ] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\\n\t\t\t\tdepthKernel[ 1 ][ 0 ] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\\n\t\t\t\tdepthKernel[ 1 ][ 1 ] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\\n\t\t\t\tdepthKernel[ 1 ][ 2 ] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\\n\t\t\t\tdepthKernel[ 2 ][ 0 ] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\\n\t\t\t\tdepthKernel[ 2 ][ 1 ] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\\n\t\t\t\tdepthKernel[ 2 ][ 2 ] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\\n\\n\t\t\t\tvec3 shadowZ = vec3( shadowCoord.z );\\n\t\t\t\tshadowKernel[ 0 ] = vec3( lessThan( depthKernel[ 0 ], shadowZ ) );\\n\t\t\t\tshadowKernel[ 0 ] *= vec3( 0.25 );\\n\\n\t\t\t\tshadowKernel[ 1 ] = vec3( lessThan( depthKernel[ 1 ], shadowZ ) );\\n\t\t\t\tshadowKernel[ 1 ] *= vec3( 0.25 );\\n\\n\t\t\t\tshadowKernel[ 2 ] = vec3( lessThan( depthKernel[ 2 ], shadowZ ) );\\n\t\t\t\tshadowKernel[ 2 ] *= vec3( 0.25 );\\n\\n\t\t\t\tvec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[ i ].xy );\\n\\n\t\t\t\tshadowKernel[ 0 ] = mix( shadowKernel[ 1 ], shadowKernel[ 0 ], fractionalCoord.x );\\n\t\t\t\tshadowKernel[ 1 ] = mix( shadowKernel[ 2 ], shadowKernel[ 1 ], fractionalCoord.x );\\n\\n\t\t\t\tvec4 shadowValues;\\n\t\t\t\tshadowValues.x = mix( shadowKernel[ 0 ][ 1 ], shadowKernel[ 0 ][ 0 ], fractionalCoord.y );\\n\t\t\t\tshadowValues.y = mix( shadowKernel[ 0 ][ 2 ], shadowKernel[ 0 ][ 1 ], fractionalCoord.y );\\n\t\t\t\tshadowValues.z = mix( shadowKernel[ 1 ][ 1 ], shadowKernel[ 1 ][ 0 ], fractionalCoord.y );\\n\t\t\t\tshadowValues.w = mix( shadowKernel[ 1 ][ 2 ], shadowKernel[ 1 ][ 1 ], fractionalCoord.y );\\n\\n\t\t\t\tshadow = dot( shadowValues, vec4( 1.0 ) ) * shadowDarkness[ i ];\\n\\n\t#else \\n\t\t\t\tshadowCoord.z += shadowBias[ i ];\\n\\n\t\t\t\tvec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\\n\t\t\t\tfloat fDepth = unpackDepth( rgbaDepth );\\n\\n\t\t\t\tif ( fDepth < shadowCoord.z )\\n\t\t\t\t\tshadow = shadowDarkness[ i ];\\n\\n\t#endif\\n\\n\t\t\t}\\n\\n#ifdef SHADOWMAP_DEBUG\\n\\n\t\t\tif ( inFrustum ) {\\n\\n\t\t\t\tif ( i == 0 ) {\\n\\n\t\t\t\t\toutgoingLight *= vec3( 1.0, 0.5, 0.0 );\\n\\n\t\t\t\t} else if ( i == 1 ) {\\n\\n\t\t\t\t\toutgoingLight *= vec3( 0.0, 1.0, 0.8 );\\n\\n\t\t\t\t} else {\\n\\n\t\t\t\t\toutgoingLight *= vec3( 0.0, 0.5, 1.0 );\\n\\n\t\t\t\t}\\n\\n\t\t\t}\\n\\n#endif\\n\\n#if defined( POINT_LIGHT_SHADOWS )\\n\\n\t\t}\\n\\n#endif\\n\\n\t\tshadowMask = shadowMask * vec3( 1.0 - shadow );\\n\\n\t}\\n\\n#endif\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/shadowmap_pars_fragment.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'shadowmap_pars_fragment'] = \"#ifdef USE_SHADOWMAP\\n\\n\tuniform sampler2D shadowMap[ MAX_SHADOWS ];\\n\tuniform vec2 shadowMapSize[ MAX_SHADOWS ];\\n\\n\tuniform float shadowDarkness[ MAX_SHADOWS ];\\n\tuniform float shadowBias[ MAX_SHADOWS ];\\n\\n\tvarying vec4 vShadowCoord[ MAX_SHADOWS ];\\n\\n\tfloat unpackDepth( const in vec4 rgba_depth ) {\\n\\n\t\tconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\\n\t\tfloat depth = dot( rgba_depth, bit_shift );\\n\t\treturn depth;\\n\\n\t}\\n\\n\t#if defined(POINT_LIGHT_SHADOWS)\\n\\n\\n\t\tvoid adjustShadowValue1K( const float testDepth, const vec4 textureData, const float bias, inout float shadowValue ) {\\n\\n\t\t\tconst vec4 bitSh = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\\n\t\t\tif ( testDepth >= dot( textureData, bitSh ) * 1000.0 + bias )\\n\t\t\t\tshadowValue += 1.0;\\n\\n\t\t}\\n\\n\\n\t\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\\n\\n\\n\t\t\tvec3 absV = abs( v );\\n\\n\\n\t\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\\n\t\t\tabsV *= scaleToCube;\\n\\n\\n\t\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\\n\\n\\n\\n\t\t\tvec2 planar = v.xy;\\n\\n\t\t\tfloat almostATexel = 1.5 * texelSizeY;\\n\t\t\tfloat almostOne = 1.0 - almostATexel;\\n\\n\t\t\tif ( absV.z >= almostOne ) {\\n\\n\t\t\t\tif ( v.z > 0.0 )\\n\t\t\t\t\tplanar.x = 4.0 - v.x;\\n\\n\t\t\t} else if ( absV.x >= almostOne ) {\\n\\n\t\t\t\tfloat signX = sign( v.x );\\n\t\t\t\tplanar.x = v.z * signX + 2.0 * signX;\\n\\n\t\t\t} else if ( absV.y >= almostOne ) {\\n\\n\t\t\t\tfloat signY = sign( v.y );\\n\t\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\\n\t\t\t\tplanar.y = v.z * signY - 2.0;\\n\\n\t\t\t}\\n\\n\\n\t\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\\n\\n\t\t}\\n\\n\t#endif\\n\\n#endif\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/shadowmap_pars_vertex.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'shadowmap_pars_vertex'] = \"#ifdef USE_SHADOWMAP\\n\\n\tuniform float shadowDarkness[ MAX_SHADOWS ];\\n\tuniform mat4 shadowMatrix[ MAX_SHADOWS ];\\n\tvarying vec4 vShadowCoord[ MAX_SHADOWS ];\\n\\n#endif\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/shadowmap_vertex.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'shadowmap_vertex'] = \"#ifdef USE_SHADOWMAP\\n\\n\tfor ( int i = 0; i < MAX_SHADOWS; i ++ ) {\\n\\n\t\t\tvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\\n\\n\t}\\n\\n#endif\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/skinbase_vertex.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'skinbase_vertex'] = \"#ifdef USE_SKINNING\\n\\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\\n\\n#endif\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/skinning_pars_vertex.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'skinning_pars_vertex'] = \"#ifdef USE_SKINNING\\n\\n\tuniform mat4 bindMatrix;\\n\tuniform mat4 bindMatrixInverse;\\n\\n\t#ifdef BONE_TEXTURE\\n\\n\t\tuniform sampler2D boneTexture;\\n\t\tuniform int boneTextureWidth;\\n\t\tuniform int boneTextureHeight;\\n\\n\t\tmat4 getBoneMatrix( const in float i ) {\\n\\n\t\t\tfloat j = i * 4.0;\\n\t\t\tfloat x = mod( j, float( boneTextureWidth ) );\\n\t\t\tfloat y = floor( j / float( boneTextureWidth ) );\\n\\n\t\t\tfloat dx = 1.0 / float( boneTextureWidth );\\n\t\t\tfloat dy = 1.0 / float( boneTextureHeight );\\n\\n\t\t\ty = dy * ( y + 0.5 );\\n\\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\\n\\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\\n\\n\t\t\treturn bone;\\n\\n\t\t}\\n\\n\t#else\\n\\n\t\tuniform mat4 boneGlobalMatrices[ MAX_BONES ];\\n\\n\t\tmat4 getBoneMatrix( const in float i ) {\\n\\n\t\t\tmat4 bone = boneGlobalMatrices[ int(i) ];\\n\t\t\treturn bone;\\n\\n\t\t}\\n\\n\t#endif\\n\\n#endif\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/skinning_vertex.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'skinning_vertex'] = \"#ifdef USE_SKINNING\\n\\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\\n\\n\tvec4 skinned = vec4( 0.0 );\\n\tskinned += boneMatX * skinVertex * skinWeight.x;\\n\tskinned += boneMatY * skinVertex * skinWeight.y;\\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\\n\tskinned += boneMatW * skinVertex * skinWeight.w;\\n\tskinned  = bindMatrixInverse * skinned;\\n\\n#endif\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/skinnormal_vertex.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'skinnormal_vertex'] = \"#ifdef USE_SKINNING\\n\\n\tmat4 skinMatrix = mat4( 0.0 );\\n\tskinMatrix += skinWeight.x * boneMatX;\\n\tskinMatrix += skinWeight.y * boneMatY;\\n\tskinMatrix += skinWeight.z * boneMatZ;\\n\tskinMatrix += skinWeight.w * boneMatW;\\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\\n\\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\\n\\n#endif\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/specularmap_fragment.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'specularmap_fragment'] = \"float specularStrength;\\n\\n#ifdef USE_SPECULARMAP\\n\\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\\n\tspecularStrength = texelSpecular.r;\\n\\n#else\\n\\n\tspecularStrength = 1.0;\\n\\n#endif\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/specularmap_pars_fragment.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'specularmap_pars_fragment'] = \"#ifdef USE_SPECULARMAP\\n\\n\tuniform sampler2D specularMap;\\n\\n#endif\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/uv2_pars_fragment.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'uv2_pars_fragment'] = \"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\n\\n\tvarying vec2 vUv2;\\n\\n#endif\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/uv2_pars_vertex.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'uv2_pars_vertex'] = \"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\n\\n\tattribute vec2 uv2;\\n\tvarying vec2 vUv2;\\n\\n#endif\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/uv2_vertex.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'uv2_vertex'] = \"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\n\\n\tvUv2 = uv2;\\n\\n#endif\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/uv_pars_fragment.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'uv_pars_fragment'] = \"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP )\\n\\n\tvarying vec2 vUv;\\n\\n#endif\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/uv_pars_vertex.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'uv_pars_vertex'] = \"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP )\\n\\n\tvarying vec2 vUv;\\n\tuniform vec4 offsetRepeat;\\n\\n#endif\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/uv_vertex.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'uv_vertex'] = \"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP )\\n\\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\\n\\n#endif\";\r\n\t\r\n\t// File:src/renderers/shaders/ShaderChunk/worldpos_vertex.glsl\r\n\t\r\n\tTHREE.ShaderChunk[ 'worldpos_vertex'] = \"#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\\n\\n\t#ifdef USE_SKINNING\\n\\n\t\tvec4 worldPosition = modelMatrix * skinned;\\n\\n\t#else\\n\\n\t\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\\n\\n\t#endif\\n\\n#endif\\n\";\r\n\t\r\n\t// File:src/renderers/shaders/UniformsUtils.js\r\n\t\r\n\t/**\r\n\t * Uniform Utilities\r\n\t */\r\n\t\r\n\tTHREE.UniformsUtils = {\r\n\t\r\n\t\tmerge: function ( uniforms ) {\r\n\t\r\n\t\t\tvar merged = {};\r\n\t\r\n\t\t\tfor ( var u = 0; u < uniforms.length; u ++ ) {\r\n\t\r\n\t\t\t\tvar tmp = this.clone( uniforms[ u ] );\r\n\t\r\n\t\t\t\tfor ( var p in tmp ) {\r\n\t\r\n\t\t\t\t\tmerged[ p ] = tmp[ p ];\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn merged;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tclone: function ( uniforms_src ) {\r\n\t\r\n\t\t\tvar uniforms_dst = {};\r\n\t\r\n\t\t\tfor ( var u in uniforms_src ) {\r\n\t\r\n\t\t\t\tuniforms_dst[ u ] = {};\r\n\t\r\n\t\t\t\tfor ( var p in uniforms_src[ u ] ) {\r\n\t\r\n\t\t\t\t\tvar parameter_src = uniforms_src[ u ][ p ];\r\n\t\r\n\t\t\t\t\tif ( parameter_src instanceof THREE.Color ||\r\n\t\t\t\t\t\t parameter_src instanceof THREE.Vector2 ||\r\n\t\t\t\t\t\t parameter_src instanceof THREE.Vector3 ||\r\n\t\t\t\t\t\t parameter_src instanceof THREE.Vector4 ||\r\n\t\t\t\t\t\t parameter_src instanceof THREE.Matrix3 ||\r\n\t\t\t\t\t\t parameter_src instanceof THREE.Matrix4 ||\r\n\t\t\t\t\t\t parameter_src instanceof THREE.Texture ) {\r\n\t\r\n\t\t\t\t\t\tuniforms_dst[ u ][ p ] = parameter_src.clone();\r\n\t\r\n\t\t\t\t\t} else if ( Array.isArray( parameter_src ) ) {\r\n\t\r\n\t\t\t\t\t\tuniforms_dst[ u ][ p ] = parameter_src.slice();\r\n\t\r\n\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\tuniforms_dst[ u ][ p ] = parameter_src;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn uniforms_dst;\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/renderers/shaders/UniformsLib.js\r\n\t\r\n\t/**\r\n\t * Uniforms library for shared webgl shaders\r\n\t */\r\n\t\r\n\tTHREE.UniformsLib = {\r\n\t\r\n\t\tcommon: {\r\n\t\r\n\t\t\t\"diffuse\" : { type: \"c\", value: new THREE.Color( 0xeeeeee ) },\r\n\t\t\t\"opacity\" : { type: \"f\", value: 1.0 },\r\n\t\r\n\t\t\t\"map\" : { type: \"t\", value: null },\r\n\t\t\t\"offsetRepeat\" : { type: \"v4\", value: new THREE.Vector4( 0, 0, 1, 1 ) },\r\n\t\r\n\t\t\t\"specularMap\" : { type: \"t\", value: null },\r\n\t\t\t\"alphaMap\" : { type: \"t\", value: null },\r\n\t\r\n\t\t\t\"envMap\" : { type: \"t\", value: null },\r\n\t\t\t\"flipEnvMap\" : { type: \"f\", value: - 1 },\r\n\t\t\t\"reflectivity\" : { type: \"f\", value: 1.0 },\r\n\t\t\t\"refractionRatio\" : { type: \"f\", value: 0.98 }\r\n\t\r\n\t\t},\r\n\t\r\n\t\taomap: {\r\n\t\r\n\t\t\t\"aoMap\" : { type: \"t\", value: null },\r\n\t\t\t\"aoMapIntensity\" : { type: \"f\", value: 1 },\r\n\t\r\n\t\t},\r\n\t\r\n\t\tlightmap: {\r\n\t\r\n\t\t\t\"lightMap\" : { type: \"t\", value: null },\r\n\t\t\t\"lightMapIntensity\" : { type: \"f\", value: 1 },\r\n\t\r\n\t\t},\r\n\t\r\n\t\temissivemap: {\r\n\t\r\n\t\t\t\"emissiveMap\" : { type: \"t\", value: null },\r\n\t\r\n\t\t},\r\n\t\r\n\t\tbumpmap: {\r\n\t\r\n\t\t\t\"bumpMap\" : { type: \"t\", value: null },\r\n\t\t\t\"bumpScale\" : { type: \"f\", value: 1 }\r\n\t\r\n\t\t},\r\n\t\r\n\t\tnormalmap: {\r\n\t\r\n\t\t\t\"normalMap\" : { type: \"t\", value: null },\r\n\t\t\t\"normalScale\" : { type: \"v2\", value: new THREE.Vector2( 1, 1 ) }\r\n\t\r\n\t\t},\r\n\t\r\n\t\tdisplacementmap: {\r\n\t\r\n\t\t\t\"displacementMap\" : { type: \"t\", value: null },\r\n\t\t\t\"displacementScale\" : { type: \"f\", value: 1 },\r\n\t\t\t\"displacementBias\" : { type: \"f\", value: 0 }\r\n\t\r\n\t\t},\r\n\t\r\n\t\tfog : {\r\n\t\r\n\t\t\t\"fogDensity\" : { type: \"f\", value: 0.00025 },\r\n\t\t\t\"fogNear\" : { type: \"f\", value: 1 },\r\n\t\t\t\"fogFar\" : { type: \"f\", value: 2000 },\r\n\t\t\t\"fogColor\" : { type: \"c\", value: new THREE.Color( 0xffffff ) }\r\n\t\r\n\t\t},\r\n\t\r\n\t\tlights: {\r\n\t\r\n\t\t\t\"ambientLightColor\" : { type: \"fv\", value: [] },\r\n\t\r\n\t\t\t\"directionalLightDirection\" : { type: \"fv\", value: [] },\r\n\t\t\t\"directionalLightColor\" : { type: \"fv\", value: [] },\r\n\t\r\n\t\t\t\"hemisphereLightDirection\" : { type: \"fv\", value: [] },\r\n\t\t\t\"hemisphereLightSkyColor\" : { type: \"fv\", value: [] },\r\n\t\t\t\"hemisphereLightGroundColor\" : { type: \"fv\", value: [] },\r\n\t\r\n\t\t\t\"pointLightColor\" : { type: \"fv\", value: [] },\r\n\t\t\t\"pointLightPosition\" : { type: \"fv\", value: [] },\r\n\t\t\t\"pointLightDistance\" : { type: \"fv1\", value: [] },\r\n\t\t\t\"pointLightDecay\" : { type: \"fv1\", value: [] },\r\n\t\r\n\t\t\t\"spotLightColor\" : { type: \"fv\", value: [] },\r\n\t\t\t\"spotLightPosition\" : { type: \"fv\", value: [] },\r\n\t\t\t\"spotLightDirection\" : { type: \"fv\", value: [] },\r\n\t\t\t\"spotLightDistance\" : { type: \"fv1\", value: [] },\r\n\t\t\t\"spotLightAngleCos\" : { type: \"fv1\", value: [] },\r\n\t\t\t\"spotLightExponent\" : { type: \"fv1\", value: [] },\r\n\t\t\t\"spotLightDecay\" : { type: \"fv1\", value: [] }\r\n\t\r\n\t\t},\r\n\t\r\n\t\tpoints: {\r\n\t\r\n\t\t\t\"psColor\" : { type: \"c\", value: new THREE.Color( 0xeeeeee ) },\r\n\t\t\t\"opacity\" : { type: \"f\", value: 1.0 },\r\n\t\t\t\"size\" : { type: \"f\", value: 1.0 },\r\n\t\t\t\"scale\" : { type: \"f\", value: 1.0 },\r\n\t\t\t\"map\" : { type: \"t\", value: null },\r\n\t\t\t\"offsetRepeat\" : { type: \"v4\", value: new THREE.Vector4( 0, 0, 1, 1 ) },\r\n\t\r\n\t\t\t\"fogDensity\" : { type: \"f\", value: 0.00025 },\r\n\t\t\t\"fogNear\" : { type: \"f\", value: 1 },\r\n\t\t\t\"fogFar\" : { type: \"f\", value: 2000 },\r\n\t\t\t\"fogColor\" : { type: \"c\", value: new THREE.Color( 0xffffff ) }\r\n\t\r\n\t\t},\r\n\t\r\n\t\tshadowmap: {\r\n\t\r\n\t\t\t\"shadowMap\": { type: \"tv\", value: [] },\r\n\t\t\t\"shadowMapSize\": { type: \"v2v\", value: [] },\r\n\t\r\n\t\t\t\"shadowBias\" : { type: \"fv1\", value: [] },\r\n\t\t\t\"shadowDarkness\": { type: \"fv1\", value: [] },\r\n\t\r\n\t\t\t\"shadowMatrix\" : { type: \"m4v\", value: [] }\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/renderers/shaders/ShaderLib.js\r\n\t\r\n\t/**\r\n\t * Webgl Shader Library for three.js\r\n\t *\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t */\r\n\t\r\n\t\r\n\tTHREE.ShaderLib = {\r\n\t\r\n\t\t'basic': {\r\n\t\r\n\t\t\tuniforms: THREE.UniformsUtils.merge( [\r\n\t\r\n\t\t\t\tTHREE.UniformsLib[ \"common\" ],\r\n\t\t\t\tTHREE.UniformsLib[ \"aomap\" ],\r\n\t\t\t\tTHREE.UniformsLib[ \"fog\" ],\r\n\t\t\t\tTHREE.UniformsLib[ \"shadowmap\" ]\r\n\t\r\n\t\t\t] ),\r\n\t\r\n\t\t\tvertexShader: [\r\n\t\r\n\t\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"uv_pars_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"uv2_pars_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"envmap_pars_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"color_pars_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"morphtarget_pars_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"skinning_pars_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"shadowmap_pars_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_vertex\" ],\r\n\t\r\n\t\t\t\t\"void main() {\",\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"uv_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"uv2_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"color_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"skinbase_vertex\" ],\r\n\t\r\n\t\t\t\t\"\t#ifdef USE_ENVMAP\",\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"beginnormal_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"morphnormal_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"skinnormal_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"defaultnormal_vertex\" ],\r\n\t\r\n\t\t\t\t\"\t#endif\",\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"begin_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"morphtarget_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"skinning_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"project_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_vertex\" ],\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"worldpos_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"envmap_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"shadowmap_vertex\" ],\r\n\t\r\n\t\t\t\t\"}\"\r\n\t\r\n\t\t\t].join( \"\\n\" ),\r\n\t\r\n\t\t\tfragmentShader: [\r\n\t\r\n\t\t\t\t\"uniform vec3 diffuse;\",\r\n\t\t\t\t\"uniform float opacity;\",\r\n\t\r\n\t\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"color_pars_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"uv_pars_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"uv2_pars_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"map_pars_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"alphamap_pars_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"aomap_pars_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"envmap_pars_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"fog_pars_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"shadowmap_pars_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"specularmap_pars_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_fragment\" ],\r\n\t\r\n\t\t\t\t\"void main() {\",\r\n\t\r\n\t\t\t\t\"\tvec3 outgoingLight = vec3( 0.0 );\",\r\n\t\t\t\t\"\tvec4 diffuseColor = vec4( diffuse, opacity );\",\r\n\t\t\t\t\"\tvec3 totalAmbientLight = vec3( 1.0 );\", // hardwired\r\n\t\t\t\t\"\tvec3 shadowMask = vec3( 1.0 );\",\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_fragment\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"map_fragment\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"color_fragment\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"alphamap_fragment\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"alphatest_fragment\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"specularmap_fragment\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"aomap_fragment\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"shadowmap_fragment\" ],\r\n\t\r\n\t\t\t\t\"\toutgoingLight = diffuseColor.rgb * totalAmbientLight * shadowMask;\",\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"envmap_fragment\" ],\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"linear_to_gamma_fragment\" ],\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"fog_fragment\" ],\r\n\t\r\n\t\t\t\t\"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\",\r\n\t\r\n\t\t\t\t\"}\"\r\n\t\r\n\t\t\t].join( \"\\n\" )\r\n\t\r\n\t\t},\r\n\t\r\n\t\t'lambert': {\r\n\t\r\n\t\t\tuniforms: THREE.UniformsUtils.merge( [\r\n\t\r\n\t\t\t\tTHREE.UniformsLib[ \"common\" ],\r\n\t\t\t\tTHREE.UniformsLib[ \"fog\" ],\r\n\t\t\t\tTHREE.UniformsLib[ \"lights\" ],\r\n\t\t\t\tTHREE.UniformsLib[ \"shadowmap\" ],\r\n\t\r\n\t\t\t\t{\r\n\t\t\t\t\t\"emissive\" : { type: \"c\", value: new THREE.Color( 0x000000 ) }\r\n\t\t\t\t}\r\n\t\r\n\t\t\t] ),\r\n\t\r\n\t\t\tvertexShader: [\r\n\t\r\n\t\t\t\t\"#define LAMBERT\",\r\n\t\r\n\t\t\t\t\"varying vec3 vLightFront;\",\r\n\t\r\n\t\t\t\t\"#ifdef DOUBLE_SIDED\",\r\n\t\r\n\t\t\t\t\"\tvarying vec3 vLightBack;\",\r\n\t\r\n\t\t\t\t\"#endif\",\r\n\t\r\n\t\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"uv_pars_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"uv2_pars_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"envmap_pars_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"lights_lambert_pars_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"color_pars_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"morphtarget_pars_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"skinning_pars_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"shadowmap_pars_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_vertex\" ],\r\n\t\r\n\t\t\t\t\"void main() {\",\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"uv_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"uv2_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"color_vertex\" ],\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"beginnormal_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"morphnormal_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"skinbase_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"skinnormal_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"defaultnormal_vertex\" ],\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"begin_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"morphtarget_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"skinning_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"project_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_vertex\" ],\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"worldpos_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"envmap_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"lights_lambert_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"shadowmap_vertex\" ],\r\n\t\r\n\t\t\t\t\"}\"\r\n\t\r\n\t\t\t].join( \"\\n\" ),\r\n\t\r\n\t\t\tfragmentShader: [\r\n\t\r\n\t\t\t\t\"uniform vec3 diffuse;\",\r\n\t\t\t\t\"uniform vec3 emissive;\",\r\n\t\t\t\t\"uniform float opacity;\",\r\n\t\r\n\t\t\t\t\"uniform vec3 ambientLightColor;\",\r\n\t\r\n\t\t\t\t\"varying vec3 vLightFront;\",\r\n\t\r\n\t\t\t\t\"#ifdef DOUBLE_SIDED\",\r\n\t\r\n\t\t\t\t\"\tvarying vec3 vLightBack;\",\r\n\t\r\n\t\t\t\t\"#endif\",\r\n\t\r\n\t\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"color_pars_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"uv_pars_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"uv2_pars_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"map_pars_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"alphamap_pars_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"envmap_pars_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"fog_pars_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"shadowmap_pars_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"specularmap_pars_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_fragment\" ],\r\n\t\r\n\t\t\t\t\"void main() {\",\r\n\t\r\n\t\t\t\t\"\tvec3 outgoingLight = vec3( 0.0 );\",\t// outgoing light does not have an alpha, the surface does\r\n\t\t\t\t\"\tvec4 diffuseColor = vec4( diffuse, opacity );\",\r\n\t\t\t\t\"\tvec3 totalAmbientLight = ambientLightColor;\",\r\n\t\t\t\t\"\tvec3 shadowMask = vec3( 1.0 );\",\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_fragment\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"map_fragment\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"color_fragment\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"alphamap_fragment\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"alphatest_fragment\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"specularmap_fragment\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"shadowmap_fragment\" ],\r\n\t\r\n\t\t\t\t\"\t#ifdef DOUBLE_SIDED\",\r\n\t\r\n\t\t\t\t\"\t\tif ( gl_FrontFacing )\",\r\n\t\t\t\t\"\t\t\toutgoingLight += diffuseColor.rgb * ( vLightFront * shadowMask + totalAmbientLight ) + emissive;\",\r\n\t\t\t\t\"\t\telse\",\r\n\t\t\t\t\"\t\t\toutgoingLight += diffuseColor.rgb * ( vLightBack * shadowMask + totalAmbientLight ) + emissive;\",\r\n\t\r\n\t\t\t\t\"\t#else\",\r\n\t\r\n\t\t\t\t\"\t\toutgoingLight += diffuseColor.rgb * ( vLightFront * shadowMask + totalAmbientLight ) + emissive;\",\r\n\t\r\n\t\t\t\t\"\t#endif\",\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"envmap_fragment\" ],\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"linear_to_gamma_fragment\" ],\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"fog_fragment\" ],\r\n\t\r\n\t\t\t\t\"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\",\r\n\t\r\n\t\t\t\t\"}\"\r\n\t\r\n\t\t\t].join( \"\\n\" )\r\n\t\r\n\t\t},\r\n\t\r\n\t\t'phong': {\r\n\t\r\n\t\t\tuniforms: THREE.UniformsUtils.merge( [\r\n\t\r\n\t\t\t\tTHREE.UniformsLib[ \"common\" ],\r\n\t\t\t\tTHREE.UniformsLib[ \"aomap\" ],\r\n\t\t\t\tTHREE.UniformsLib[ \"lightmap\" ],\r\n\t\t\t\tTHREE.UniformsLib[ \"emissivemap\" ],\r\n\t\t\t\tTHREE.UniformsLib[ \"bumpmap\" ],\r\n\t\t\t\tTHREE.UniformsLib[ \"normalmap\" ],\r\n\t\t\t\tTHREE.UniformsLib[ \"displacementmap\" ],\r\n\t\t\t\tTHREE.UniformsLib[ \"fog\" ],\r\n\t\t\t\tTHREE.UniformsLib[ \"lights\" ],\r\n\t\t\t\tTHREE.UniformsLib[ \"shadowmap\" ],\r\n\t\r\n\t\t\t\t{\r\n\t\t\t\t\t\"emissive\" : { type: \"c\", value: new THREE.Color( 0x000000 ) },\r\n\t\t\t\t\t\"specular\" : { type: \"c\", value: new THREE.Color( 0x111111 ) },\r\n\t\t\t\t\t\"shininess\": { type: \"f\", value: 30 }\r\n\t\t\t\t}\r\n\t\r\n\t\t\t] ),\r\n\t\r\n\t\t\tvertexShader: [\r\n\t\r\n\t\t\t\t\"#define PHONG\",\r\n\t\r\n\t\t\t\t\"varying vec3 vViewPosition;\",\r\n\t\r\n\t\t\t\t\"#ifndef FLAT_SHADED\",\r\n\t\r\n\t\t\t\t\"\tvarying vec3 vNormal;\",\r\n\t\r\n\t\t\t\t\"#endif\",\r\n\t\r\n\t\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"uv_pars_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"uv2_pars_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"displacementmap_pars_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"envmap_pars_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"lights_phong_pars_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"color_pars_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"morphtarget_pars_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"skinning_pars_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"shadowmap_pars_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_vertex\" ],\r\n\t\r\n\t\t\t\t\"void main() {\",\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"uv_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"uv2_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"color_vertex\" ],\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"beginnormal_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"morphnormal_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"skinbase_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"skinnormal_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"defaultnormal_vertex\" ],\r\n\t\r\n\t\t\t\t\"#ifndef FLAT_SHADED\", // Normal computed with derivatives when FLAT_SHADED\r\n\t\r\n\t\t\t\t\"\tvNormal = normalize( transformedNormal );\",\r\n\t\r\n\t\t\t\t\"#endif\",\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"begin_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"displacementmap_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"morphtarget_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"skinning_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"project_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_vertex\" ],\r\n\t\r\n\t\t\t\t\"\tvViewPosition = - mvPosition.xyz;\",\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"worldpos_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"envmap_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"lights_phong_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"shadowmap_vertex\" ],\r\n\t\r\n\t\t\t\t\"}\"\r\n\t\r\n\t\t\t].join( \"\\n\" ),\r\n\t\r\n\t\t\tfragmentShader: [\r\n\t\r\n\t\t\t\t\"#define PHONG\",\r\n\t\r\n\t\t\t\t\"uniform vec3 diffuse;\",\r\n\t\t\t\t\"uniform vec3 emissive;\",\r\n\t\t\t\t\"uniform vec3 specular;\",\r\n\t\t\t\t\"uniform float shininess;\",\r\n\t\t\t\t\"uniform float opacity;\",\r\n\t\r\n\t\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"color_pars_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"uv_pars_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"uv2_pars_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"map_pars_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"alphamap_pars_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"aomap_pars_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"lightmap_pars_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"emissivemap_pars_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"envmap_pars_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"fog_pars_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"lights_phong_pars_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"shadowmap_pars_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"bumpmap_pars_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"normalmap_pars_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"specularmap_pars_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_fragment\" ],\r\n\t\r\n\t\t\t\t\"void main() {\",\r\n\t\r\n\t\t\t\t\"\tvec3 outgoingLight = vec3( 0.0 );\",\r\n\t\t\t\t\"\tvec4 diffuseColor = vec4( diffuse, opacity );\",\r\n\t\t\t\t\"\tvec3 totalAmbientLight = ambientLightColor;\",\r\n\t\t\t\t\"\tvec3 totalEmissiveLight = emissive;\",\r\n\t\t\t\t\"\tvec3 shadowMask = vec3( 1.0 );\",\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_fragment\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"map_fragment\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"color_fragment\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"alphamap_fragment\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"alphatest_fragment\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"specularmap_fragment\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"normal_phong_fragment\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"lightmap_fragment\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"hemilight_fragment\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"aomap_fragment\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"emissivemap_fragment\" ],\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"lights_phong_fragment\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"shadowmap_fragment\" ],\r\n\t\r\n\t\t\t\t\t\"totalDiffuseLight *= shadowMask;\",\r\n\t\t\t\t\t\"totalSpecularLight *= shadowMask;\",\r\n\t\r\n\t\t\t\t\t\"#ifdef METAL\",\r\n\t\r\n\t\t\t\t\t\"\toutgoingLight += diffuseColor.rgb * ( totalDiffuseLight + totalAmbientLight ) * specular + totalSpecularLight + totalEmissiveLight;\",\r\n\t\r\n\t\t\t\t\t\"#else\",\r\n\t\r\n\t\t\t\t\t\"\toutgoingLight += diffuseColor.rgb * ( totalDiffuseLight + totalAmbientLight ) + totalSpecularLight + totalEmissiveLight;\",\r\n\t\r\n\t\t\t\t\t\"#endif\",\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"envmap_fragment\" ],\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"linear_to_gamma_fragment\" ],\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"fog_fragment\" ],\r\n\t\r\n\t\t\t\t\"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\",\r\n\t\r\n\t\t\t\t\"}\"\r\n\t\r\n\t\t\t].join( \"\\n\" )\r\n\t\r\n\t\t},\r\n\t\r\n\t\t'points': {\r\n\t\r\n\t\t\tuniforms: THREE.UniformsUtils.merge( [\r\n\t\r\n\t\t\t\tTHREE.UniformsLib[ \"points\" ],\r\n\t\t\t\tTHREE.UniformsLib[ \"shadowmap\" ]\r\n\t\r\n\t\t\t] ),\r\n\t\r\n\t\t\tvertexShader: [\r\n\t\r\n\t\t\t\t\"uniform float size;\",\r\n\t\t\t\t\"uniform float scale;\",\r\n\t\r\n\t\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"color_pars_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"shadowmap_pars_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_vertex\" ],\r\n\t\r\n\t\t\t\t\"void main() {\",\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"color_vertex\" ],\r\n\t\r\n\t\t\t\t\"\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\",\r\n\t\r\n\t\t\t\t\"\t#ifdef USE_SIZEATTENUATION\",\r\n\t\t\t\t\"\t\tgl_PointSize = size * ( scale / length( mvPosition.xyz ) );\",\r\n\t\t\t\t\"\t#else\",\r\n\t\t\t\t\"\t\tgl_PointSize = size;\",\r\n\t\t\t\t\"\t#endif\",\r\n\t\r\n\t\t\t\t\"\tgl_Position = projectionMatrix * mvPosition;\",\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"worldpos_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"shadowmap_vertex\" ],\r\n\t\r\n\t\t\t\t\"}\"\r\n\t\r\n\t\t\t].join( \"\\n\" ),\r\n\t\r\n\t\t\tfragmentShader: [\r\n\t\r\n\t\t\t\t\"uniform vec3 psColor;\",\r\n\t\t\t\t\"uniform float opacity;\",\r\n\t\r\n\t\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"color_pars_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"map_particle_pars_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"fog_pars_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"shadowmap_pars_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_fragment\" ],\r\n\t\r\n\t\t\t\t\"void main() {\",\r\n\t\r\n\t\t\t\t\"\tvec3 outgoingLight = vec3( 0.0 );\",\r\n\t\t\t\t\"\tvec4 diffuseColor = vec4( psColor, opacity );\",\r\n\t\t\t\t\"\tvec3 shadowMask = vec3( 1.0 );\",\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_fragment\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"map_particle_fragment\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"color_fragment\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"alphatest_fragment\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"shadowmap_fragment\" ],\r\n\t\r\n\t\t\t\t\"\toutgoingLight = diffuseColor.rgb * shadowMask;\",\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"fog_fragment\" ],\r\n\t\r\n\t\t\t\t\"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\",\r\n\t\r\n\t\t\t\t\"}\"\r\n\t\r\n\t\t\t].join( \"\\n\" )\r\n\t\r\n\t\t},\r\n\t\r\n\t\t'dashed': {\r\n\t\r\n\t\t\tuniforms: THREE.UniformsUtils.merge( [\r\n\t\r\n\t\t\t\tTHREE.UniformsLib[ \"common\" ],\r\n\t\t\t\tTHREE.UniformsLib[ \"fog\" ],\r\n\t\r\n\t\t\t\t{\r\n\t\t\t\t\t\"scale\"    : { type: \"f\", value: 1 },\r\n\t\t\t\t\t\"dashSize\" : { type: \"f\", value: 1 },\r\n\t\t\t\t\t\"totalSize\": { type: \"f\", value: 2 }\r\n\t\t\t\t}\r\n\t\r\n\t\t\t] ),\r\n\t\r\n\t\t\tvertexShader: [\r\n\t\r\n\t\t\t\t\"uniform float scale;\",\r\n\t\t\t\t\"attribute float lineDistance;\",\r\n\t\r\n\t\t\t\t\"varying float vLineDistance;\",\r\n\t\r\n\t\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"color_pars_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_vertex\" ],\r\n\t\r\n\t\t\t\t\"void main() {\",\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"color_vertex\" ],\r\n\t\r\n\t\t\t\t\"\tvLineDistance = scale * lineDistance;\",\r\n\t\r\n\t\t\t\t\"\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\",\r\n\t\t\t\t\"\tgl_Position = projectionMatrix * mvPosition;\",\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_vertex\" ],\r\n\t\r\n\t\t\t\t\"}\"\r\n\t\r\n\t\t\t].join( \"\\n\" ),\r\n\t\r\n\t\t\tfragmentShader: [\r\n\t\r\n\t\t\t\t\"uniform vec3 diffuse;\",\r\n\t\t\t\t\"uniform float opacity;\",\r\n\t\r\n\t\t\t\t\"uniform float dashSize;\",\r\n\t\t\t\t\"uniform float totalSize;\",\r\n\t\r\n\t\t\t\t\"varying float vLineDistance;\",\r\n\t\r\n\t\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"color_pars_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"fog_pars_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_fragment\" ],\r\n\t\r\n\t\t\t\t\"void main() {\",\r\n\t\r\n\t\t\t\t\"\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\",\r\n\t\r\n\t\t\t\t\"\t\tdiscard;\",\r\n\t\r\n\t\t\t\t\"\t}\",\r\n\t\r\n\t\t\t\t\"\tvec3 outgoingLight = vec3( 0.0 );\",\r\n\t\t\t\t\"\tvec4 diffuseColor = vec4( diffuse, opacity );\",\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_fragment\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"color_fragment\" ],\r\n\t\r\n\t\t\t\t\"\toutgoingLight = diffuseColor.rgb;\", // simple shader\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"fog_fragment\" ],\r\n\t\r\n\t\t\t\t\"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\",\r\n\t\r\n\t\t\t\t\"}\"\r\n\t\r\n\t\t\t].join( \"\\n\" )\r\n\t\r\n\t\t},\r\n\t\r\n\t\t'depth': {\r\n\t\r\n\t\t\tuniforms: {\r\n\t\r\n\t\t\t\t\"mNear\": { type: \"f\", value: 1.0 },\r\n\t\t\t\t\"mFar\" : { type: \"f\", value: 2000.0 },\r\n\t\t\t\t\"opacity\" : { type: \"f\", value: 1.0 }\r\n\t\r\n\t\t\t},\r\n\t\r\n\t\t\tvertexShader: [\r\n\t\r\n\t\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"morphtarget_pars_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_vertex\" ],\r\n\t\r\n\t\t\t\t\"void main() {\",\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"begin_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"morphtarget_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"project_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_vertex\" ],\r\n\t\r\n\t\t\t\t\"}\"\r\n\t\r\n\t\t\t].join( \"\\n\" ),\r\n\t\r\n\t\t\tfragmentShader: [\r\n\t\r\n\t\t\t\t\"uniform float mNear;\",\r\n\t\t\t\t\"uniform float mFar;\",\r\n\t\t\t\t\"uniform float opacity;\",\r\n\t\r\n\t\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_fragment\" ],\r\n\t\r\n\t\t\t\t\"void main() {\",\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_fragment\" ],\r\n\t\r\n\t\t\t\t\"\t#ifdef USE_LOGDEPTHBUF_EXT\",\r\n\t\r\n\t\t\t\t\"\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\",\r\n\t\r\n\t\t\t\t\"\t#else\",\r\n\t\r\n\t\t\t\t\"\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\",\r\n\t\r\n\t\t\t\t\"\t#endif\",\r\n\t\r\n\t\t\t\t\"\tfloat color = 1.0 - smoothstep( mNear, mFar, depth );\",\r\n\t\t\t\t\"\tgl_FragColor = vec4( vec3( color ), opacity );\",\r\n\t\r\n\t\t\t\t\"}\"\r\n\t\r\n\t\t\t].join( \"\\n\" )\r\n\t\r\n\t\t},\r\n\t\r\n\t\t'normal': {\r\n\t\r\n\t\t\tuniforms: {\r\n\t\r\n\t\t\t\t\"opacity\" : { type: \"f\", value: 1.0 }\r\n\t\r\n\t\t\t},\r\n\t\r\n\t\t\tvertexShader: [\r\n\t\r\n\t\t\t\t\"varying vec3 vNormal;\",\r\n\t\r\n\t\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"morphtarget_pars_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_vertex\" ],\r\n\t\r\n\t\t\t\t\"void main() {\",\r\n\t\r\n\t\t\t\t\"\tvNormal = normalize( normalMatrix * normal );\",\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"begin_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"morphtarget_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"project_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_vertex\" ],\r\n\t\r\n\t\t\t\t\"}\"\r\n\t\r\n\t\t\t].join( \"\\n\" ),\r\n\t\r\n\t\t\tfragmentShader: [\r\n\t\r\n\t\t\t\t\"uniform float opacity;\",\r\n\t\t\t\t\"varying vec3 vNormal;\",\r\n\t\r\n\t\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_fragment\" ],\r\n\t\r\n\t\t\t\t\"void main() {\",\r\n\t\r\n\t\t\t\t\"\tgl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );\",\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_fragment\" ],\r\n\t\r\n\t\t\t\t\"}\"\r\n\t\r\n\t\t\t].join( \"\\n\" )\r\n\t\r\n\t\t},\r\n\t\r\n\t\t/* -------------------------------------------------------------------------\r\n\t\t//\tCube map shader\r\n\t\t ------------------------------------------------------------------------- */\r\n\t\r\n\t\t'cube': {\r\n\t\r\n\t\t\tuniforms: { \"tCube\": { type: \"t\", value: null },\r\n\t\t\t\t\t\t\"tFlip\": { type: \"f\", value: - 1 } },\r\n\t\r\n\t\t\tvertexShader: [\r\n\t\r\n\t\t\t\t\"varying vec3 vWorldPosition;\",\r\n\t\r\n\t\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_vertex\" ],\r\n\t\r\n\t\t\t\t\"void main() {\",\r\n\t\r\n\t\t\t\t\"\tvWorldPosition = transformDirection( position, modelMatrix );\",\r\n\t\r\n\t\t\t\t\"\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_vertex\" ],\r\n\t\r\n\t\t\t\t\"}\"\r\n\t\r\n\t\t\t].join( \"\\n\" ),\r\n\t\r\n\t\t\tfragmentShader: [\r\n\t\r\n\t\t\t\t\"uniform samplerCube tCube;\",\r\n\t\t\t\t\"uniform float tFlip;\",\r\n\t\r\n\t\t\t\t\"varying vec3 vWorldPosition;\",\r\n\t\r\n\t\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_fragment\" ],\r\n\t\r\n\t\t\t\t\"void main() {\",\r\n\t\r\n\t\t\t\t\"\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\",\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_fragment\" ],\r\n\t\r\n\t\t\t\t\"}\"\r\n\t\r\n\t\t\t].join( \"\\n\" )\r\n\t\r\n\t\t},\r\n\t\r\n\t\t/* -------------------------------------------------------------------------\r\n\t\t//\tCube map shader\r\n\t\t ------------------------------------------------------------------------- */\r\n\t\r\n\t\t'equirect': {\r\n\t\r\n\t\t\tuniforms: { \"tEquirect\": { type: \"t\", value: null },\r\n\t\t\t\t\t\t\"tFlip\": { type: \"f\", value: - 1 } },\r\n\t\r\n\t\t\tvertexShader: [\r\n\t\r\n\t\t\t\t\"varying vec3 vWorldPosition;\",\r\n\t\r\n\t\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_vertex\" ],\r\n\t\r\n\t\t\t\t\"void main() {\",\r\n\t\r\n\t\t\t\t\"\tvWorldPosition = transformDirection( position, modelMatrix );\",\r\n\t\r\n\t\t\t\t\"\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_vertex\" ],\r\n\t\r\n\t\t\t\t\"}\"\r\n\t\r\n\t\t\t].join( \"\\n\" ),\r\n\t\r\n\t\t\tfragmentShader: [\r\n\t\r\n\t\t\t\t\"uniform sampler2D tEquirect;\",\r\n\t\t\t\t\"uniform float tFlip;\",\r\n\t\r\n\t\t\t\t\"varying vec3 vWorldPosition;\",\r\n\t\r\n\t\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_fragment\" ],\r\n\t\r\n\t\t\t\t\"void main() {\",\r\n\t\r\n\t\t\t\t\t// \"\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\",\r\n\t\t\t\t\t\"vec3 direction = normalize( vWorldPosition );\",\r\n\t\t\t\t\t\"vec2 sampleUV;\",\r\n\t\t\t\t\t\"sampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );\",\r\n\t\t\t\t\t\"sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\",\r\n\t\t\t\t\t\"gl_FragColor = texture2D( tEquirect, sampleUV );\",\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_fragment\" ],\r\n\t\r\n\t\t\t\t\"}\"\r\n\t\r\n\t\t\t].join( \"\\n\" )\r\n\t\r\n\t\t},\r\n\t\r\n\t\t/* Depth encoding into RGBA texture\r\n\t\t *\r\n\t\t * based on SpiderGL shadow map example\r\n\t\t * http://spidergl.org/example.php?id=6\r\n\t\t *\r\n\t\t * originally from\r\n\t\t * http://www.gamedev.net/topic/442138-packing-a-float-into-a-a8r8g8b8-texture-shader/page__whichpage__1%25EF%25BF%25BD\r\n\t\t *\r\n\t\t * see also\r\n\t\t * http://aras-p.info/blog/2009/07/30/encoding-floats-to-rgba-the-final/\r\n\t\t */\r\n\t\r\n\t\t'depthRGBA': {\r\n\t\r\n\t\t\tuniforms: {},\r\n\t\r\n\t\t\tvertexShader: [\r\n\t\r\n\t\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"morphtarget_pars_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"skinning_pars_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_vertex\" ],\r\n\t\r\n\t\t\t\t\"void main() {\",\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"skinbase_vertex\" ],\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"begin_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"morphtarget_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"skinning_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"project_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_vertex\" ],\r\n\t\r\n\t\t\t\t\"}\"\r\n\t\r\n\t\t\t].join( \"\\n\" ),\r\n\t\r\n\t\t\tfragmentShader: [\r\n\t\r\n\t\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_fragment\" ],\r\n\t\r\n\t\t\t\t\"vec4 pack_depth( const in float depth ) {\",\r\n\t\r\n\t\t\t\t\"\tconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\",\r\n\t\t\t\t\"\tconst vec4 bit_mask = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\",\r\n\t\t\t\t\"\tvec4 res = mod( depth * bit_shift * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );\", // \"\tvec4 res = fract( depth * bit_shift );\",\r\n\t\t\t\t\"\tres -= res.xxyz * bit_mask;\",\r\n\t\t\t\t\"\treturn res;\",\r\n\t\r\n\t\t\t\t\"}\",\r\n\t\r\n\t\t\t\t\"void main() {\",\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_fragment\" ],\r\n\t\r\n\t\t\t\t\"\t#ifdef USE_LOGDEPTHBUF_EXT\",\r\n\t\r\n\t\t\t\t\"\t\tgl_FragData[ 0 ] = pack_depth( gl_FragDepthEXT );\",\r\n\t\r\n\t\t\t\t\"\t#else\",\r\n\t\r\n\t\t\t\t\"\t\tgl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );\",\r\n\t\r\n\t\t\t\t\"\t#endif\",\r\n\t\r\n\t\t\t\t\t//\"gl_FragData[ 0 ] = pack_depth( gl_FragCoord.z / gl_FragCoord.w );\",\r\n\t\t\t\t\t//\"float z = ( ( gl_FragCoord.z / gl_FragCoord.w ) - 3.0 ) / ( 4000.0 - 3.0 );\",\r\n\t\t\t\t\t//\"gl_FragData[ 0 ] = pack_depth( z );\",\r\n\t\t\t\t\t//\"gl_FragData[ 0 ] = vec4( z, z, z, 1.0 );\",\r\n\t\r\n\t\t\t\t\"}\"\r\n\t\r\n\t\t\t].join( \"\\n\" )\r\n\t\r\n\t\t},\r\n\t\r\n\t\r\n\t\t'distanceRGBA': {\r\n\t\r\n\t\t\tuniforms: {\r\n\t\r\n\t\t\t\t\"lightPos\": { type: \"v3\", value: new THREE.Vector3( 0, 0, 0 ) }\r\n\t\r\n\t\t\t},\r\n\t\r\n\t\t\tvertexShader: [\r\n\t\r\n\t\t\t\t\"varying vec4 vWorldPosition;\",\r\n\t\r\n\t\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"morphtarget_pars_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"skinning_pars_vertex\" ],\r\n\t\r\n\t\t\t\t\"void main() {\",\r\n\t\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"skinbase_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"begin_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"morphtarget_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"skinning_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"project_vertex\" ],\r\n\t\t\t\t\tTHREE.ShaderChunk[ \"worldpos_vertex\" ],\r\n\t\r\n\t\t\t\t\t\"vWorldPosition = worldPosition;\",\r\n\t\r\n\t\t\t\t\"}\"\r\n\t\r\n\t\t\t].join( \"\\n\" ),\r\n\t\r\n\t\t\tfragmentShader: [\r\n\t\r\n\t\t\t\t\"uniform vec3 lightPos;\",\r\n\t\t\t\t\"varying vec4 vWorldPosition;\",\r\n\t\r\n\t\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\r\n\t\t\t\t\"vec4 pack1K ( float depth ) {\",\r\n\t\r\n\t\t\t\t\"   depth /= 1000.0;\",\r\n\t\t\t\t\"   const vec4 bitSh = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\",\r\n\t  \t\t\t\"\tconst vec4 bitMsk = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\",\r\n\t   \t\t\t\"\tvec4 res = fract( depth * bitSh );\",\r\n\t   \t\t\t\"\tres -= res.xxyz * bitMsk;\",\r\n\t   \t\t\t\"\treturn res; \",\r\n\t\r\n\t\t\t\t\"}\",\r\n\t\r\n\t\t\t\t\"float unpack1K ( vec4 color ) {\",\r\n\t\r\n\t\t\t\t\"\tconst vec4 bitSh = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\",\r\n\t\t\t\t\"\treturn dot( color, bitSh ) * 1000.0;\",\r\n\t\r\n\t\t\t\t\"}\",\r\n\t\r\n\t\t\t\t\"void main () {\",\r\n\t\r\n\t\t\t\t\"\tgl_FragColor = pack1K( length( vWorldPosition.xyz - lightPos.xyz ) );\",\r\n\t\r\n\t\t\t\t\"}\"\r\n\t\r\n\t\t\t].join( \"\\n\" )\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/renderers/WebGLRenderer.js\r\n\t\r\n\t/**\r\n\t * @author supereggbert / http://www.paulbrunt.co.uk/\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author szimek / https://github.com/szimek/\r\n\t */\r\n\t\r\n\tTHREE.WebGLRenderer = function ( parameters ) {\r\n\t\r\n\t\tconsole.log( 'THREE.WebGLRenderer', THREE.REVISION );\r\n\t\r\n\t\tparameters = parameters || {};\r\n\t\r\n\t\tvar _canvas = parameters.canvas !== undefined ? parameters.canvas : document.createElement( 'canvas' ),\r\n\t\t_context = parameters.context !== undefined ? parameters.context : null,\r\n\t\r\n\t\t_width = _canvas.width,\r\n\t\t_height = _canvas.height,\r\n\t\r\n\t\tpixelRatio = 1,\r\n\t\r\n\t\t_alpha = parameters.alpha !== undefined ? parameters.alpha : false,\r\n\t\t_depth = parameters.depth !== undefined ? parameters.depth : true,\r\n\t\t_stencil = parameters.stencil !== undefined ? parameters.stencil : true,\r\n\t\t_antialias = parameters.antialias !== undefined ? parameters.antialias : false,\r\n\t\t_premultipliedAlpha = parameters.premultipliedAlpha !== undefined ? parameters.premultipliedAlpha : true,\r\n\t\t_preserveDrawingBuffer = parameters.preserveDrawingBuffer !== undefined ? parameters.preserveDrawingBuffer : false,\r\n\t\r\n\t\t_clearColor = new THREE.Color( 0x000000 ),\r\n\t\t_clearAlpha = 0;\r\n\t\r\n\t\tvar lights = [];\r\n\t\r\n\t\tvar opaqueObjects = [];\r\n\t\tvar opaqueObjectsLastIndex = - 1;\r\n\t\tvar transparentObjects = [];\r\n\t\tvar transparentObjectsLastIndex = - 1;\r\n\t\r\n\t\tvar morphInfluences = new Float32Array( 8 );\r\n\t\r\n\t\r\n\t\tvar sprites = [];\r\n\t\tvar lensFlares = [];\r\n\t\r\n\t\t// public properties\r\n\t\r\n\t\tthis.domElement = _canvas;\r\n\t\tthis.context = null;\r\n\t\r\n\t\t// clearing\r\n\t\r\n\t\tthis.autoClear = true;\r\n\t\tthis.autoClearColor = true;\r\n\t\tthis.autoClearDepth = true;\r\n\t\tthis.autoClearStencil = true;\r\n\t\r\n\t\t// scene graph\r\n\t\r\n\t\tthis.sortObjects = true;\r\n\t\r\n\t\t// physically based shading\r\n\t\r\n\t\tthis.gammaFactor = 2.0;\t// for backwards compatibility\r\n\t\tthis.gammaInput = false;\r\n\t\tthis.gammaOutput = false;\r\n\t\r\n\t\t// morphs\r\n\t\r\n\t\tthis.maxMorphTargets = 8;\r\n\t\tthis.maxMorphNormals = 4;\r\n\t\r\n\t\t// flags\r\n\t\r\n\t\tthis.autoScaleCubemaps = true;\r\n\t\r\n\t\t// internal properties\r\n\t\r\n\t\tvar _this = this,\r\n\t\r\n\t\t// internal state cache\r\n\t\r\n\t\t_currentProgram = null,\r\n\t\t_currentFramebuffer = null,\r\n\t\t_currentMaterialId = - 1,\r\n\t\t_currentGeometryProgram = '',\r\n\t\t_currentCamera = null,\r\n\t\r\n\t\t_usedTextureUnits = 0,\r\n\t\r\n\t\t_viewportX = 0,\r\n\t\t_viewportY = 0,\r\n\t\t_viewportWidth = _canvas.width,\r\n\t\t_viewportHeight = _canvas.height,\r\n\t\t_currentWidth = 0,\r\n\t\t_currentHeight = 0,\r\n\t\r\n\t\t// frustum\r\n\t\r\n\t\t_frustum = new THREE.Frustum(),\r\n\t\r\n\t\t // camera matrices cache\r\n\t\r\n\t\t_projScreenMatrix = new THREE.Matrix4(),\r\n\t\r\n\t\t_vector3 = new THREE.Vector3(),\r\n\t\r\n\t\t// light arrays cache\r\n\t\r\n\t\t_direction = new THREE.Vector3(),\r\n\t\r\n\t\t_lightsNeedUpdate = true,\r\n\t\r\n\t\t_lights = {\r\n\t\r\n\t\t\tambient: [ 0, 0, 0 ],\r\n\t\t\tdirectional: { length: 0, colors: [], positions: [] },\r\n\t\t\tpoint: { length: 0, colors: [], positions: [], distances: [], decays: [] },\r\n\t\t\tspot: { length: 0, colors: [], positions: [], distances: [], directions: [], anglesCos: [], exponents: [], decays: [] },\r\n\t\t\themi: { length: 0, skyColors: [], groundColors: [], positions: [] }\r\n\t\r\n\t\t},\r\n\t\r\n\t\t// info\r\n\t\r\n\t\t_infoMemory = {\r\n\t\r\n\t\t\tgeometries: 0,\r\n\t\t\ttextures: 0\r\n\t\r\n\t\t},\r\n\t\r\n\t\t_infoRender = {\r\n\t\r\n\t\t\tcalls: 0,\r\n\t\t\tvertices: 0,\r\n\t\t\tfaces: 0,\r\n\t\t\tpoints: 0\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.info = {\r\n\t\r\n\t\t\trender: _infoRender,\r\n\t\t\tmemory: _infoMemory,\r\n\t\t\tprograms: null\r\n\t\r\n\t\t};\r\n\t\r\n\t\r\n\t\t// initialize\r\n\t\r\n\t\tvar _gl;\r\n\t\r\n\t\ttry {\r\n\t\r\n\t\t\tvar attributes = {\r\n\t\t\t\talpha: _alpha,\r\n\t\t\t\tdepth: _depth,\r\n\t\t\t\tstencil: _stencil,\r\n\t\t\t\tantialias: _antialias,\r\n\t\t\t\tpremultipliedAlpha: _premultipliedAlpha,\r\n\t\t\t\tpreserveDrawingBuffer: _preserveDrawingBuffer\r\n\t\t\t};\r\n\t\r\n\t\t\t_gl = _context || _canvas.getContext( 'webgl', attributes ) || _canvas.getContext( 'experimental-webgl', attributes );\r\n\t\r\n\t\t\tif ( _gl === null ) {\r\n\t\r\n\t\t\t\tif ( _canvas.getContext( 'webgl' ) !== null ) {\r\n\t\r\n\t\t\t\t\tthrow 'Error creating WebGL context with your selected attributes.';\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tthrow 'Error creating WebGL context.';\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t_canvas.addEventListener( 'webglcontextlost', onContextLost, false );\r\n\t\r\n\t\t} catch ( error ) {\r\n\t\r\n\t\t\tconsole.error( 'THREE.WebGLRenderer: ' + error );\r\n\t\r\n\t\t}\r\n\t\r\n\t\tvar extensions = new THREE.WebGLExtensions( _gl );\r\n\t\r\n\t\textensions.get( 'OES_texture_float' );\r\n\t\textensions.get( 'OES_texture_float_linear' );\r\n\t\textensions.get( 'OES_texture_half_float' );\r\n\t\textensions.get( 'OES_texture_half_float_linear' );\r\n\t\textensions.get( 'OES_standard_derivatives' );\r\n\t\textensions.get( 'ANGLE_instanced_arrays' );\r\n\t\r\n\t\tif ( extensions.get( 'OES_element_index_uint' ) ) {\r\n\t\r\n\t\t\tTHREE.BufferGeometry.MaxIndex = 4294967296;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tvar capabilities = new THREE.WebGLCapabilities( _gl, extensions, parameters );\r\n\t\r\n\t\tvar state = new THREE.WebGLState( _gl, extensions, paramThreeToGL );\r\n\t\tvar properties = new THREE.WebGLProperties();\r\n\t\tvar objects = new THREE.WebGLObjects( _gl, properties, this.info );\r\n\t\tvar programCache = new THREE.WebGLPrograms( this, capabilities );\r\n\t\r\n\t\tthis.info.programs = programCache.programs;\r\n\t\r\n\t\tvar bufferRenderer = new THREE.WebGLBufferRenderer( _gl, extensions, _infoRender );\r\n\t\tvar indexedBufferRenderer = new THREE.WebGLIndexedBufferRenderer( _gl, extensions, _infoRender );\r\n\t\r\n\t\t//\r\n\t\r\n\t\tfunction glClearColor( r, g, b, a ) {\r\n\t\r\n\t\t\tif ( _premultipliedAlpha === true ) {\r\n\t\r\n\t\t\t\tr *= a; g *= a; b *= a;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t_gl.clearColor( r, g, b, a );\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction setDefaultGLState() {\r\n\t\r\n\t\t\tstate.init();\r\n\t\r\n\t\t\t_gl.viewport( _viewportX, _viewportY, _viewportWidth, _viewportHeight );\r\n\t\r\n\t\t\tglClearColor( _clearColor.r, _clearColor.g, _clearColor.b, _clearAlpha );\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction resetGLState() {\r\n\t\r\n\t\t\t_currentProgram = null;\r\n\t\t\t_currentCamera = null;\r\n\t\r\n\t\t\t_currentGeometryProgram = '';\r\n\t\t\t_currentMaterialId = - 1;\r\n\t\r\n\t\t\t_lightsNeedUpdate = true;\r\n\t\r\n\t\t\tstate.reset();\r\n\t\r\n\t\t}\r\n\t\r\n\t\tsetDefaultGLState();\r\n\t\r\n\t\tthis.context = _gl;\r\n\t\tthis.capabilities = capabilities;\r\n\t\tthis.extensions = extensions;\r\n\t\tthis.state = state;\r\n\t\r\n\t\t// shadow map\r\n\t\r\n\t\tvar shadowMap = new THREE.WebGLShadowMap( this, lights, objects );\r\n\t\r\n\t\tthis.shadowMap = shadowMap;\r\n\t\r\n\t\r\n\t\t// Plugins\r\n\t\r\n\t\tvar spritePlugin = new THREE.SpritePlugin( this, sprites );\r\n\t\tvar lensFlarePlugin = new THREE.LensFlarePlugin( this, lensFlares );\r\n\t\r\n\t\t// API\r\n\t\r\n\t\tthis.getContext = function () {\r\n\t\r\n\t\t\treturn _gl;\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.getContextAttributes = function () {\r\n\t\r\n\t\t\treturn _gl.getContextAttributes();\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.forceContextLoss = function () {\r\n\t\r\n\t\t\textensions.get( 'WEBGL_lose_context' ).loseContext();\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.getMaxAnisotropy = ( function () {\r\n\t\r\n\t\t\tvar value;\r\n\t\r\n\t\t\treturn function getMaxAnisotropy() {\r\n\t\r\n\t\t\t\tif ( value !== undefined ) return value;\r\n\t\r\n\t\t\t\tvar extension = extensions.get( 'EXT_texture_filter_anisotropic' );\r\n\t\r\n\t\t\t\tif ( extension !== null ) {\r\n\t\r\n\t\t\t\t\tvalue = _gl.getParameter( extension.MAX_TEXTURE_MAX_ANISOTROPY_EXT );\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tvalue = 0;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\treturn value;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t} )();\r\n\t\r\n\t\tthis.getPrecision = function () {\r\n\t\r\n\t\t\treturn capabilities.precision;\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.getPixelRatio = function () {\r\n\t\r\n\t\t\treturn pixelRatio;\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.setPixelRatio = function ( value ) {\r\n\t\r\n\t\t\tif ( value !== undefined ) pixelRatio = value;\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.getSize = function () {\r\n\t\r\n\t\t\treturn {\r\n\t\t\t\twidth: _width,\r\n\t\t\t\theight: _height\r\n\t\t\t};\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.setSize = function ( width, height, updateStyle ) {\r\n\t\r\n\t\t\t_width = width;\r\n\t\t\t_height = height;\r\n\t\r\n\t\t\t_canvas.width = width * pixelRatio;\r\n\t\t\t_canvas.height = height * pixelRatio;\r\n\t\r\n\t\t\tif ( updateStyle !== false ) {\r\n\t\r\n\t\t\t\t_canvas.style.width = width + 'px';\r\n\t\t\t\t_canvas.style.height = height + 'px';\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tthis.setViewport( 0, 0, width, height );\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.setViewport = function ( x, y, width, height ) {\r\n\t\r\n\t\t\t_viewportX = x * pixelRatio;\r\n\t\t\t_viewportY = y * pixelRatio;\r\n\t\r\n\t\t\t_viewportWidth = width * pixelRatio;\r\n\t\t\t_viewportHeight = height * pixelRatio;\r\n\t\r\n\t\t\t_gl.viewport( _viewportX, _viewportY, _viewportWidth, _viewportHeight );\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.getViewport = function ( dimensions ) {\r\n\t\r\n\t\t\tdimensions.x = _viewportX / pixelRatio;\r\n\t\t\tdimensions.y = _viewportY / pixelRatio;\r\n\t\r\n\t\t\tdimensions.z = _viewportWidth / pixelRatio;\r\n\t\t\tdimensions.w = _viewportHeight / pixelRatio;\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.setScissor = function ( x, y, width, height ) {\r\n\t\r\n\t\t\t_gl.scissor(\r\n\t\t\t\tx * pixelRatio,\r\n\t\t\t\ty * pixelRatio,\r\n\t\t\t\twidth * pixelRatio,\r\n\t\t\t\theight * pixelRatio\r\n\t\t\t);\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.enableScissorTest = function ( boolean ) {\r\n\t\r\n\t\t\tstate.setScissorTest( boolean );\r\n\t\r\n\t\t};\r\n\t\r\n\t\t// Clearing\r\n\t\r\n\t\tthis.getClearColor = function () {\r\n\t\r\n\t\t\treturn _clearColor;\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.setClearColor = function ( color, alpha ) {\r\n\t\r\n\t\t\t_clearColor.set( color );\r\n\t\r\n\t\t\t_clearAlpha = alpha !== undefined ? alpha : 1;\r\n\t\r\n\t\t\tglClearColor( _clearColor.r, _clearColor.g, _clearColor.b, _clearAlpha );\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.getClearAlpha = function () {\r\n\t\r\n\t\t\treturn _clearAlpha;\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.setClearAlpha = function ( alpha ) {\r\n\t\r\n\t\t\t_clearAlpha = alpha;\r\n\t\r\n\t\t\tglClearColor( _clearColor.r, _clearColor.g, _clearColor.b, _clearAlpha );\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.clear = function ( color, depth, stencil ) {\r\n\t\r\n\t\t\tvar bits = 0;\r\n\t\r\n\t\t\tif ( color === undefined || color ) bits |= _gl.COLOR_BUFFER_BIT;\r\n\t\t\tif ( depth === undefined || depth ) bits |= _gl.DEPTH_BUFFER_BIT;\r\n\t\t\tif ( stencil === undefined || stencil ) bits |= _gl.STENCIL_BUFFER_BIT;\r\n\t\r\n\t\t\t_gl.clear( bits );\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.clearColor = function () {\r\n\t\r\n\t\t\t_gl.clear( _gl.COLOR_BUFFER_BIT );\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.clearDepth = function () {\r\n\t\r\n\t\t\t_gl.clear( _gl.DEPTH_BUFFER_BIT );\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.clearStencil = function () {\r\n\t\r\n\t\t\t_gl.clear( _gl.STENCIL_BUFFER_BIT );\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.clearTarget = function ( renderTarget, color, depth, stencil ) {\r\n\t\r\n\t\t\tthis.setRenderTarget( renderTarget );\r\n\t\t\tthis.clear( color, depth, stencil );\r\n\t\r\n\t\t};\r\n\t\r\n\t\t// Reset\r\n\t\r\n\t\tthis.resetGLState = resetGLState;\r\n\t\r\n\t\tthis.dispose = function() {\r\n\t\r\n\t\t\t_canvas.removeEventListener( 'webglcontextlost', onContextLost, false );\r\n\t\r\n\t\t};\r\n\t\r\n\t\t// Events\r\n\t\r\n\t\tfunction onContextLost( event ) {\r\n\t\r\n\t\t\tevent.preventDefault();\r\n\t\r\n\t\t\tresetGLState();\r\n\t\t\tsetDefaultGLState();\r\n\t\r\n\t\t\tproperties.clear();\r\n\t\r\n\t\t};\r\n\t\r\n\t\tfunction onTextureDispose( event ) {\r\n\t\r\n\t\t\tvar texture = event.target;\r\n\t\r\n\t\t\ttexture.removeEventListener( 'dispose', onTextureDispose );\r\n\t\r\n\t\t\tdeallocateTexture( texture );\r\n\t\r\n\t\t\t_infoMemory.textures --;\r\n\t\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction onRenderTargetDispose( event ) {\r\n\t\r\n\t\t\tvar renderTarget = event.target;\r\n\t\r\n\t\t\trenderTarget.removeEventListener( 'dispose', onRenderTargetDispose );\r\n\t\r\n\t\t\tdeallocateRenderTarget( renderTarget );\r\n\t\r\n\t\t\t_infoMemory.textures --;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction onMaterialDispose( event ) {\r\n\t\r\n\t\t\tvar material = event.target;\r\n\t\r\n\t\t\tmaterial.removeEventListener( 'dispose', onMaterialDispose );\r\n\t\r\n\t\t\tdeallocateMaterial( material );\r\n\t\r\n\t\t}\r\n\t\r\n\t\t// Buffer deallocation\r\n\t\r\n\t\tfunction deallocateTexture( texture ) {\r\n\t\r\n\t\t\tvar textureProperties = properties.get( texture );\r\n\t\r\n\t\t\tif ( texture.image && textureProperties.__image__webglTextureCube ) {\r\n\t\r\n\t\t\t\t// cube texture\r\n\t\r\n\t\t\t\t_gl.deleteTexture( textureProperties.__image__webglTextureCube );\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\t// 2D texture\r\n\t\r\n\t\t\t\tif ( textureProperties.__webglInit === undefined ) return;\r\n\t\r\n\t\t\t\t_gl.deleteTexture( textureProperties.__webglTexture );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// remove all webgl properties\r\n\t\t\tproperties.delete( texture );\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction deallocateRenderTarget( renderTarget ) {\r\n\t\r\n\t\t\tvar renderTargetProperties = properties.get( renderTarget );\r\n\t\t\tvar textureProperties = properties.get( renderTarget.texture );\r\n\t\r\n\t\t\tif ( ! renderTarget || textureProperties.__webglTexture === undefined ) return;\r\n\t\r\n\t\t\t_gl.deleteTexture( textureProperties.__webglTexture );\r\n\t\r\n\t\t\tif ( renderTarget instanceof THREE.WebGLRenderTargetCube ) {\r\n\t\r\n\t\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\t\r\n\t\t\t\t\t_gl.deleteFramebuffer( renderTargetProperties.__webglFramebuffer[ i ] );\r\n\t\t\t\t\t_gl.deleteRenderbuffer( renderTargetProperties.__webglRenderbuffer[ i ] );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\t_gl.deleteFramebuffer( renderTargetProperties.__webglFramebuffer );\r\n\t\t\t\t_gl.deleteRenderbuffer( renderTargetProperties.__webglRenderbuffer );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tproperties.delete( renderTarget.texture );\r\n\t\t\tproperties.delete( renderTarget );\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction deallocateMaterial( material ) {\r\n\t\r\n\t\t\treleaseMaterialProgramReference( material );\r\n\t\r\n\t\t\tproperties.delete( material );\r\n\t\r\n\t\t}\r\n\t\r\n\t\r\n\t\tfunction releaseMaterialProgramReference( material ) {\r\n\t\r\n\t\t\tvar programInfo = properties.get( material ).program;\r\n\t\r\n\t\t\tmaterial.program = undefined;\r\n\t\r\n\t\t\tif ( programInfo !== undefined ) {\r\n\t\r\n\t\t\t\tprogramCache.releaseProgram( programInfo );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\t// Buffer rendering\r\n\t\r\n\t\tthis.renderBufferImmediate = function ( object, program, material ) {\r\n\t\r\n\t\t\tstate.initAttributes();\r\n\t\r\n\t\t\tvar buffers = properties.get( object );\r\n\t\r\n\t\t\tif ( object.hasPositions && ! buffers.position ) buffers.position = _gl.createBuffer();\r\n\t\t\tif ( object.hasNormals && ! buffers.normal ) buffers.normal = _gl.createBuffer();\r\n\t\t\tif ( object.hasUvs && ! buffers.uv ) buffers.uv = _gl.createBuffer();\r\n\t\t\tif ( object.hasColors && ! buffers.color ) buffers.color = _gl.createBuffer();\r\n\t\r\n\t\t\tvar attributes = program.getAttributes();\r\n\t\r\n\t\t\tif ( object.hasPositions ) {\r\n\t\r\n\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffers.position );\r\n\t\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, object.positionArray, _gl.DYNAMIC_DRAW );\r\n\t\r\n\t\t\t\tstate.enableAttribute( attributes.position );\r\n\t\t\t\t_gl.vertexAttribPointer( attributes.position, 3, _gl.FLOAT, false, 0, 0 );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( object.hasNormals ) {\r\n\t\r\n\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffers.normal );\r\n\t\r\n\t\t\t\tif ( material.type !== 'MeshPhongMaterial' && material.shading === THREE.FlatShading ) {\r\n\t\r\n\t\t\t\t\tfor ( var i = 0, l = object.count * 3; i < l; i += 9 ) {\r\n\t\r\n\t\t\t\t\t\tvar array = object.normalArray;\r\n\t\r\n\t\t\t\t\t\tvar nx = ( array[ i + 0 ] + array[ i + 3 ] + array[ i + 6 ] ) / 3;\r\n\t\t\t\t\t\tvar ny = ( array[ i + 1 ] + array[ i + 4 ] + array[ i + 7 ] ) / 3;\r\n\t\t\t\t\t\tvar nz = ( array[ i + 2 ] + array[ i + 5 ] + array[ i + 8 ] ) / 3;\r\n\t\r\n\t\t\t\t\t\tarray[ i + 0 ] = nx;\r\n\t\t\t\t\t\tarray[ i + 1 ] = ny;\r\n\t\t\t\t\t\tarray[ i + 2 ] = nz;\r\n\t\r\n\t\t\t\t\t\tarray[ i + 3 ] = nx;\r\n\t\t\t\t\t\tarray[ i + 4 ] = ny;\r\n\t\t\t\t\t\tarray[ i + 5 ] = nz;\r\n\t\r\n\t\t\t\t\t\tarray[ i + 6 ] = nx;\r\n\t\t\t\t\t\tarray[ i + 7 ] = ny;\r\n\t\t\t\t\t\tarray[ i + 8 ] = nz;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, object.normalArray, _gl.DYNAMIC_DRAW );\r\n\t\r\n\t\t\t\tstate.enableAttribute( attributes.normal );\r\n\t\r\n\t\t\t\t_gl.vertexAttribPointer( attributes.normal, 3, _gl.FLOAT, false, 0, 0 );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( object.hasUvs && material.map ) {\r\n\t\r\n\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffers.uv );\r\n\t\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, object.uvArray, _gl.DYNAMIC_DRAW );\r\n\t\r\n\t\t\t\tstate.enableAttribute( attributes.uv );\r\n\t\r\n\t\t\t\t_gl.vertexAttribPointer( attributes.uv, 2, _gl.FLOAT, false, 0, 0 );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( object.hasColors && material.vertexColors !== THREE.NoColors ) {\r\n\t\r\n\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffers.color );\r\n\t\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, object.colorArray, _gl.DYNAMIC_DRAW );\r\n\t\r\n\t\t\t\tstate.enableAttribute( attributes.color );\r\n\t\r\n\t\t\t\t_gl.vertexAttribPointer( attributes.color, 3, _gl.FLOAT, false, 0, 0 );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tstate.disableUnusedAttributes();\r\n\t\r\n\t\t\t_gl.drawArrays( _gl.TRIANGLES, 0, object.count );\r\n\t\r\n\t\t\tobject.count = 0;\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.renderBufferDirect = function ( camera, lights, fog, geometry, material, object, group ) {\r\n\t\r\n\t\t\tsetMaterial( material );\r\n\t\r\n\t\t\tvar program = setProgram( camera, lights, fog, material, object );\r\n\t\r\n\t\t\tvar updateBuffers = false;\r\n\t\t\tvar geometryProgram = geometry.id + '_' + program.id + '_' + material.wireframe;\r\n\t\r\n\t\t\tif ( geometryProgram !== _currentGeometryProgram ) {\r\n\t\r\n\t\t\t\t_currentGeometryProgram = geometryProgram;\r\n\t\t\t\tupdateBuffers = true;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// morph targets\r\n\t\r\n\t\t\tvar morphTargetInfluences = object.morphTargetInfluences;\r\n\t\r\n\t\t\tif ( morphTargetInfluences !== undefined ) {\r\n\t\r\n\t\t\t\tvar activeInfluences = [];\r\n\t\r\n\t\t\t\tfor ( var i = 0, l = morphTargetInfluences.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\t\tvar influence = morphTargetInfluences[ i ];\r\n\t\t\t\t\tactiveInfluences.push( [ influence, i ] );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tactiveInfluences.sort( numericalSort );\r\n\t\r\n\t\t\t\tif ( activeInfluences.length > 8 ) {\r\n\t\r\n\t\t\t\t\tactiveInfluences.length = 8;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tvar morphAttributes = geometry.morphAttributes;\r\n\t\r\n\t\t\t\tfor ( var i = 0, l = activeInfluences.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\t\tvar influence = activeInfluences[ i ];\r\n\t\t\t\t\tmorphInfluences[ i ] = influence[ 0 ];\r\n\t\r\n\t\t\t\t\tif ( influence[ 0 ] !== 0 ) {\r\n\t\r\n\t\t\t\t\t\tvar index = influence[ 1 ];\r\n\t\r\n\t\t\t\t\t\tif ( material.morphTargets === true && morphAttributes.position ) geometry.addAttribute( 'morphTarget' + i, morphAttributes.position[ index ] );\r\n\t\t\t\t\t\tif ( material.morphNormals === true && morphAttributes.normal ) geometry.addAttribute( 'morphNormal' + i, morphAttributes.normal[ index ] );\r\n\t\r\n\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\tif ( material.morphTargets === true ) geometry.removeAttribute( 'morphTarget' + i );\r\n\t\t\t\t\t\tif ( material.morphNormals === true ) geometry.removeAttribute( 'morphNormal' + i );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tvar uniforms = program.getUniforms();\r\n\t\r\n\t\t\t\tif ( uniforms.morphTargetInfluences !== null ) {\r\n\t\r\n\t\t\t\t\t_gl.uniform1fv( uniforms.morphTargetInfluences, morphInfluences );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tupdateBuffers = true;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t//\r\n\t\r\n\t\t\tvar index = geometry.index;\r\n\t\t\tvar position = geometry.attributes.position;\r\n\t\r\n\t\t\tif ( material.wireframe === true ) {\r\n\t\r\n\t\t\t\tindex = objects.getWireframeAttribute( geometry );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar renderer;\r\n\t\r\n\t\t\tif ( index !== null ) {\r\n\t\r\n\t\t\t\trenderer = indexedBufferRenderer;\r\n\t\t\t\trenderer.setIndex( index );\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\trenderer = bufferRenderer;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( updateBuffers ) {\r\n\t\r\n\t\t\t\tsetupVertexAttributes( material, program, geometry );\r\n\t\r\n\t\t\t\tif ( index !== null ) {\r\n\t\r\n\t\t\t\t\t_gl.bindBuffer( _gl.ELEMENT_ARRAY_BUFFER, objects.getAttributeBuffer( index ) );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t//\r\n\t\r\n\t\t\tvar dataStart = 0;\r\n\t\t\tvar dataCount = Infinity;\r\n\t\r\n\t\t\tif ( index !== null ) {\r\n\t\r\n\t\t\t\tdataCount = index.count\r\n\t\r\n\t\t\t} else if ( position !== undefined ) {\r\n\t\r\n\t\t\t\tdataCount = position.count;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar rangeStart = geometry.drawRange.start;\r\n\t\t\tvar rangeCount = geometry.drawRange.count;\r\n\t\r\n\t\t\tvar groupStart = group !== null ? group.start : 0;\r\n\t\t\tvar groupCount = group !== null ? group.count : Infinity;\r\n\t\r\n\t\t\tvar drawStart = Math.max( dataStart, rangeStart, groupStart );\r\n\t\t\tvar drawEnd = Math.min( dataStart + dataCount, rangeStart + rangeCount, groupStart + groupCount ) - 1;\r\n\t\r\n\t\t\tvar drawCount = Math.max( 0, drawEnd - drawStart + 1 );\r\n\t\r\n\t\t\t//\r\n\t\r\n\t\t\tif ( object instanceof THREE.Mesh ) {\r\n\t\r\n\t\t\t\tif ( material.wireframe === true ) {\r\n\t\r\n\t\t\t\t\tstate.setLineWidth( material.wireframeLinewidth * pixelRatio );\r\n\t\t\t\t\trenderer.setMode( _gl.LINES );\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\trenderer.setMode( _gl.TRIANGLES );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( geometry instanceof THREE.InstancedBufferGeometry && geometry.maxInstancedCount > 0 ) {\r\n\t\r\n\t\t\t\t\trenderer.renderInstances( geometry );\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\trenderer.render( drawStart, drawCount );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t} else if ( object instanceof THREE.Line ) {\r\n\t\r\n\t\t\t\tvar lineWidth = material.linewidth;\r\n\t\r\n\t\t\t\tif ( lineWidth === undefined ) lineWidth = 1; // Not using Line*Material\r\n\t\r\n\t\t\t\tstate.setLineWidth( lineWidth * pixelRatio );\r\n\t\r\n\t\t\t\tif ( object instanceof THREE.LineSegments ) {\r\n\t\r\n\t\t\t\t\trenderer.setMode( _gl.LINES );\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\trenderer.setMode( _gl.LINE_STRIP );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\trenderer.render( drawStart, drawCount );\r\n\t\r\n\t\t\t} else if ( object instanceof THREE.Points ) {\r\n\t\r\n\t\t\t\trenderer.setMode( _gl.POINTS );\r\n\t\t\t\trenderer.render( drawStart, drawCount );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t};\r\n\t\r\n\t\tfunction setupVertexAttributes( material, program, geometry, startIndex ) {\r\n\t\r\n\t\t\tvar extension;\r\n\t\r\n\t\t\tif ( geometry instanceof THREE.InstancedBufferGeometry ) {\r\n\t\r\n\t\t\t\textension = extensions.get( 'ANGLE_instanced_arrays' );\r\n\t\r\n\t\t\t\tif ( extension === null ) {\r\n\t\r\n\t\t\t\t\tconsole.error( 'THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.' );\r\n\t\t\t\t\treturn;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( startIndex === undefined ) startIndex = 0;\r\n\t\r\n\t\t\tstate.initAttributes();\r\n\t\r\n\t\t\tvar geometryAttributes = geometry.attributes;\r\n\t\r\n\t\t\tvar programAttributes = program.getAttributes();\r\n\t\r\n\t\t\tvar materialDefaultAttributeValues = material.defaultAttributeValues;\r\n\t\r\n\t\t\tfor ( var name in programAttributes ) {\r\n\t\r\n\t\t\t\tvar programAttribute = programAttributes[ name ];\r\n\t\r\n\t\t\t\tif ( programAttribute >= 0 ) {\r\n\t\r\n\t\t\t\t\tvar geometryAttribute = geometryAttributes[ name ];\r\n\t\r\n\t\t\t\t\tif ( geometryAttribute !== undefined ) {\r\n\t\r\n\t\t\t\t\t\tvar size = geometryAttribute.itemSize;\r\n\t\t\t\t\t\tvar buffer = objects.getAttributeBuffer( geometryAttribute );\r\n\t\r\n\t\t\t\t\t\tif ( geometryAttribute instanceof THREE.InterleavedBufferAttribute ) {\r\n\t\r\n\t\t\t\t\t\t\tvar data = geometryAttribute.data;\r\n\t\t\t\t\t\t\tvar stride = data.stride;\r\n\t\t\t\t\t\t\tvar offset = geometryAttribute.offset;\r\n\t\r\n\t\t\t\t\t\t\tif ( data instanceof THREE.InstancedInterleavedBuffer ) {\r\n\t\r\n\t\t\t\t\t\t\t\tstate.enableAttributeAndDivisor( programAttribute, data.meshPerAttribute, extension );\r\n\t\r\n\t\t\t\t\t\t\t\tif ( geometry.maxInstancedCount === undefined ) {\r\n\t\r\n\t\t\t\t\t\t\t\t\tgeometry.maxInstancedCount = data.meshPerAttribute * data.count;\r\n\t\r\n\t\t\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\t\t\tstate.enableAttribute( programAttribute );\r\n\t\r\n\t\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffer );\r\n\t\t\t\t\t\t\t_gl.vertexAttribPointer( programAttribute, size, _gl.FLOAT, false, stride * data.array.BYTES_PER_ELEMENT, ( startIndex * stride + offset ) * data.array.BYTES_PER_ELEMENT );\r\n\t\r\n\t\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\t\tif ( geometryAttribute instanceof THREE.InstancedBufferAttribute ) {\r\n\t\r\n\t\t\t\t\t\t\t\tstate.enableAttributeAndDivisor( programAttribute, geometryAttribute.meshPerAttribute, extension );\r\n\t\r\n\t\t\t\t\t\t\t\tif ( geometry.maxInstancedCount === undefined ) {\r\n\t\r\n\t\t\t\t\t\t\t\t\tgeometry.maxInstancedCount = geometryAttribute.meshPerAttribute * geometryAttribute.count;\r\n\t\r\n\t\t\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\t\t\tstate.enableAttribute( programAttribute );\r\n\t\r\n\t\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffer );\r\n\t\t\t\t\t\t\t_gl.vertexAttribPointer( programAttribute, size, _gl.FLOAT, false, 0, startIndex * size * 4 ); // 4 bytes per Float32\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t} else if ( materialDefaultAttributeValues !== undefined ) {\r\n\t\r\n\t\t\t\t\t\tvar value = materialDefaultAttributeValues[ name ];\r\n\t\r\n\t\t\t\t\t\tif ( value !== undefined ) {\r\n\t\r\n\t\t\t\t\t\t\tswitch ( value.length ) {\r\n\t\r\n\t\t\t\t\t\t\t\tcase 2:\r\n\t\t\t\t\t\t\t\t\t_gl.vertexAttrib2fv( programAttribute, value );\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\t\t\t\tcase 3:\r\n\t\t\t\t\t\t\t\t\t_gl.vertexAttrib3fv( programAttribute, value );\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\t\t\t\tcase 4:\r\n\t\t\t\t\t\t\t\t\t_gl.vertexAttrib4fv( programAttribute, value );\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\t\t\t_gl.vertexAttrib1fv( programAttribute, value );\r\n\t\r\n\t\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tstate.disableUnusedAttributes();\r\n\t\r\n\t\t}\r\n\t\r\n\t\t// Sorting\r\n\t\r\n\t\tfunction numericalSort ( a, b ) {\r\n\t\r\n\t\t\treturn b[ 0 ] - a[ 0 ];\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction painterSortStable ( a, b ) {\r\n\t\r\n\t\t\tif ( a.object.renderOrder !== b.object.renderOrder ) {\r\n\t\r\n\t\t\t\treturn a.object.renderOrder - b.object.renderOrder;\r\n\t\r\n\t\t\t} else if ( a.material.id !== b.material.id ) {\r\n\t\r\n\t\t\t\treturn a.material.id - b.material.id;\r\n\t\r\n\t\t\t} else if ( a.z !== b.z ) {\r\n\t\r\n\t\t\t\treturn a.z - b.z;\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\treturn a.id - b.id;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction reversePainterSortStable ( a, b ) {\r\n\t\r\n\t\t\tif ( a.object.renderOrder !== b.object.renderOrder ) {\r\n\t\r\n\t\t\t\treturn a.object.renderOrder - b.object.renderOrder;\r\n\t\r\n\t\t\t} if ( a.z !== b.z ) {\r\n\t\r\n\t\t\t\treturn b.z - a.z;\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\treturn a.id - b.id;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\t// Rendering\r\n\t\r\n\t\tthis.render = function ( scene, camera, renderTarget, forceClear ) {\r\n\t\r\n\t\t\tif ( camera instanceof THREE.Camera === false ) {\r\n\t\r\n\t\t\t\tconsole.error( 'THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.' );\r\n\t\t\t\treturn;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar fog = scene.fog;\r\n\t\r\n\t\t\t// reset caching for this frame\r\n\t\r\n\t\t\t_currentGeometryProgram = '';\r\n\t\t\t_currentMaterialId = - 1;\r\n\t\t\t_currentCamera = null;\r\n\t\t\t_lightsNeedUpdate = true;\r\n\t\r\n\t\t\t// update scene graph\r\n\t\r\n\t\t\tif ( scene.autoUpdate === true ) scene.updateMatrixWorld();\r\n\t\r\n\t\t\t// update camera matrices and frustum\r\n\t\r\n\t\t\tif ( camera.parent === null ) camera.updateMatrixWorld();\r\n\t\r\n\t\t\tcamera.matrixWorldInverse.getInverse( camera.matrixWorld );\r\n\t\r\n\t\t\t_projScreenMatrix.multiplyMatrices( camera.projectionMatrix, camera.matrixWorldInverse );\r\n\t\t\t_frustum.setFromMatrix( _projScreenMatrix );\r\n\t\r\n\t\t\tlights.length = 0;\r\n\t\r\n\t\t\topaqueObjectsLastIndex = - 1;\r\n\t\t\ttransparentObjectsLastIndex = - 1;\r\n\t\r\n\t\t\tsprites.length = 0;\r\n\t\t\tlensFlares.length = 0;\r\n\t\r\n\t\t\tprojectObject( scene, camera );\r\n\t\r\n\t\t\topaqueObjects.length = opaqueObjectsLastIndex + 1;\r\n\t\t\ttransparentObjects.length = transparentObjectsLastIndex + 1;\r\n\t\r\n\t\t\tif ( _this.sortObjects === true ) {\r\n\t\r\n\t\t\t\topaqueObjects.sort( painterSortStable );\r\n\t\t\t\ttransparentObjects.sort( reversePainterSortStable );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t//\r\n\t\r\n\t\t\tshadowMap.render( scene );\r\n\t\r\n\t\t\t//\r\n\t\r\n\t\t\t_infoRender.calls = 0;\r\n\t\t\t_infoRender.vertices = 0;\r\n\t\t\t_infoRender.faces = 0;\r\n\t\t\t_infoRender.points = 0;\r\n\t\r\n\t\t\tthis.setRenderTarget( renderTarget );\r\n\t\r\n\t\t\tif ( this.autoClear || forceClear ) {\r\n\t\r\n\t\t\t\tthis.clear( this.autoClearColor, this.autoClearDepth, this.autoClearStencil );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t//\r\n\t\r\n\t\t\tif ( scene.overrideMaterial ) {\r\n\t\r\n\t\t\t\tvar overrideMaterial = scene.overrideMaterial;\r\n\t\r\n\t\t\t\trenderObjects( opaqueObjects, camera, lights, fog, overrideMaterial );\r\n\t\t\t\trenderObjects( transparentObjects, camera, lights, fog, overrideMaterial );\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\t// opaque pass (front-to-back order)\r\n\t\r\n\t\t\t\tstate.setBlending( THREE.NoBlending );\r\n\t\t\t\trenderObjects( opaqueObjects, camera, lights, fog );\r\n\t\r\n\t\t\t\t// transparent pass (back-to-front order)\r\n\t\r\n\t\t\t\trenderObjects( transparentObjects, camera, lights, fog );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// custom render plugins (post pass)\r\n\t\r\n\t\t\tspritePlugin.render( scene, camera );\r\n\t\t\tlensFlarePlugin.render( scene, camera, _currentWidth, _currentHeight );\r\n\t\r\n\t\t\t// Generate mipmap if we're using any kind of mipmap filtering\r\n\t\r\n\t\t\tif ( renderTarget ) {\r\n\t\r\n\t\t\t\tvar texture = renderTarget.texture;\r\n\t\t\t\tvar isTargetPowerOfTwo = isPowerOfTwo( renderTarget );\r\n\t\t\t\tif ( texture.generateMipmaps && isTargetPowerOfTwo && texture.minFilter !== THREE.NearestFilter && texture.minFilter !== THREE.LinearFilter ) {\r\n\t\r\n\t\t\t\t\t updateRenderTargetMipmap( renderTarget );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// Ensure depth buffer writing is enabled so it can be cleared on next render\r\n\t\r\n\t\t\tstate.setDepthTest( true );\r\n\t\t\tstate.setDepthWrite( true );\r\n\t\t\tstate.setColorWrite( true );\r\n\t\r\n\t\t\t// _gl.finish();\r\n\t\r\n\t\t};\r\n\t\r\n\t\tfunction pushRenderItem( object, geometry, material, z, group ) {\r\n\t\r\n\t\t\tvar array, index;\r\n\t\r\n\t\t\t// allocate the next position in the appropriate array\r\n\t\r\n\t\t\tif ( material.transparent ) {\r\n\t\r\n\t\t\t\tarray = transparentObjects;\r\n\t\t\t\tindex = ++ transparentObjectsLastIndex;\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\tarray = opaqueObjects;\r\n\t\t\t\tindex = ++ opaqueObjectsLastIndex;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// recycle existing render item or grow the array\r\n\t\r\n\t\t\tvar renderItem = array[ index ];\r\n\t\r\n\t\t\tif ( renderItem !== undefined ) {\r\n\t\r\n\t\t\t\trenderItem.id = object.id;\r\n\t\t\t\trenderItem.object = object;\r\n\t\t\t\trenderItem.geometry = geometry;\r\n\t\t\t\trenderItem.material = material;\r\n\t\t\t\trenderItem.z = _vector3.z;\r\n\t\t\t\trenderItem.group = group;\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\trenderItem = {\r\n\t\t\t\t\tid: object.id,\r\n\t\t\t\t\tobject: object,\r\n\t\t\t\t\tgeometry: geometry,\r\n\t\t\t\t\tmaterial: material,\r\n\t\t\t\t\tz: _vector3.z,\r\n\t\t\t\t\tgroup: group\r\n\t\t\t\t};\r\n\t\r\n\t\t\t\t// assert( index === array.length );\r\n\t\t\t\tarray.push( renderItem );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction projectObject( object, camera ) {\r\n\t\r\n\t\t\tif ( object.visible === false ) return;\r\n\t\r\n\t\t\tif ( ( object.channels.mask & camera.channels.mask ) !== 0 ) {\r\n\t\r\n\t\t\t\tif ( object instanceof THREE.Light ) {\r\n\t\r\n\t\t\t\t\tlights.push( object );\r\n\t\r\n\t\t\t\t} else if ( object instanceof THREE.Sprite ) {\r\n\t\r\n\t\t\t\t\tsprites.push( object );\r\n\t\r\n\t\t\t\t} else if ( object instanceof THREE.LensFlare ) {\r\n\t\r\n\t\t\t\t\tlensFlares.push( object );\r\n\t\r\n\t\t\t\t} else if ( object instanceof THREE.ImmediateRenderObject ) {\r\n\t\r\n\t\t\t\t\tif ( _this.sortObjects === true ) {\r\n\t\r\n\t\t\t\t\t\t_vector3.setFromMatrixPosition( object.matrixWorld );\r\n\t\t\t\t\t\t_vector3.applyProjection( _projScreenMatrix );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tpushRenderItem( object, null, object.material, _vector3.z, null );\r\n\t\r\n\t\t\t\t} else if ( object instanceof THREE.Mesh || object instanceof THREE.Line || object instanceof THREE.Points ) {\r\n\t\r\n\t\t\t\t\tif ( object instanceof THREE.SkinnedMesh ) {\r\n\t\r\n\t\t\t\t\t\tobject.skeleton.update();\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tif ( object.frustumCulled === false || _frustum.intersectsObject( object ) === true ) {\r\n\t\r\n\t\t\t\t\t\tvar material = object.material;\r\n\t\r\n\t\t\t\t\t\tif ( material.visible === true ) {\r\n\t\r\n\t\t\t\t\t\t\tif ( _this.sortObjects === true ) {\r\n\t\r\n\t\t\t\t\t\t\t\t_vector3.setFromMatrixPosition( object.matrixWorld );\r\n\t\t\t\t\t\t\t\t_vector3.applyProjection( _projScreenMatrix );\r\n\t\r\n\t\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t\tvar geometry = objects.update( object );\r\n\t\r\n\t\t\t\t\t\t\tif ( material instanceof THREE.MeshFaceMaterial ) {\r\n\t\r\n\t\t\t\t\t\t\t\tvar groups = geometry.groups;\r\n\t\t\t\t\t\t\t\tvar materials = material.materials;\r\n\t\r\n\t\t\t\t\t\t\t\tfor ( var i = 0, l = groups.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\t\t\t\t\t\tvar group = groups[ i ];\r\n\t\t\t\t\t\t\t\t\tvar groupMaterial = materials[ group.materialIndex ];\r\n\t\r\n\t\t\t\t\t\t\t\t\tif ( groupMaterial.visible === true ) {\r\n\t\r\n\t\t\t\t\t\t\t\t\t\tpushRenderItem( object, geometry, groupMaterial, _vector3.z, group );\r\n\t\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\t\t\tpushRenderItem( object, geometry, material, _vector3.z, null );\r\n\t\r\n\t\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar children = object.children;\r\n\t\r\n\t\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\tprojectObject( children[ i ], camera );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction renderObjects( renderList, camera, lights, fog, overrideMaterial ) {\r\n\t\r\n\t\t\tfor ( var i = 0, l = renderList.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\tvar renderItem = renderList[ i ];\r\n\t\r\n\t\t\t\tvar object = renderItem.object;\r\n\t\t\t\tvar geometry = renderItem.geometry;\r\n\t\t\t\tvar material = overrideMaterial === undefined ? renderItem.material : overrideMaterial;\r\n\t\t\t\tvar group = renderItem.group;\r\n\t\r\n\t\t\t\tobject.modelViewMatrix.multiplyMatrices( camera.matrixWorldInverse, object.matrixWorld );\r\n\t\t\t\tobject.normalMatrix.getNormalMatrix( object.modelViewMatrix );\r\n\t\r\n\t\t\t\tif ( object instanceof THREE.ImmediateRenderObject ) {\r\n\t\r\n\t\t\t\t\tsetMaterial( material );\r\n\t\r\n\t\t\t\t\tvar program = setProgram( camera, lights, fog, material, object );\r\n\t\r\n\t\t\t\t\t_currentGeometryProgram = '';\r\n\t\r\n\t\t\t\t\tobject.render( function ( object ) {\r\n\t\r\n\t\t\t\t\t\t_this.renderBufferImmediate( object, program, material );\r\n\t\r\n\t\t\t\t\t} );\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t_this.renderBufferDirect( camera, lights, fog, geometry, material, object, group );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction initMaterial( material, lights, fog, object ) {\r\n\t\r\n\t\t\tvar materialProperties = properties.get( material );\r\n\t\r\n\t\t\tvar parameters = programCache.getParameters( material, lights, fog, object );\r\n\t\t\tvar code = programCache.getProgramCode( material, parameters );\r\n\t\r\n\t\t\tvar program = materialProperties.program;\r\n\t\t\tvar programChange = true;\r\n\t\r\n\t\t\tif ( program === undefined ) {\r\n\t\r\n\t\t\t\t// new material\r\n\t\t\t\tmaterial.addEventListener( 'dispose', onMaterialDispose );\r\n\t\r\n\t\t\t} else if ( program.code !== code ) {\r\n\t\r\n\t\t\t\t// changed glsl or parameters\r\n\t\t\t\treleaseMaterialProgramReference( material );\r\n\t\r\n\t\t\t} else if ( parameters.shaderID !== undefined ) {\r\n\t\r\n\t\t\t\t// same glsl and uniform list\r\n\t\t\t\treturn;\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\t// only rebuild uniform list\r\n\t\t\t\tprogramChange = false;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( programChange ) {\r\n\t\r\n\t\t\t\tif ( parameters.shaderID ) {\r\n\t\r\n\t\t\t\t\tvar shader = THREE.ShaderLib[ parameters.shaderID ];\r\n\t\r\n\t\t\t\t\tmaterialProperties.__webglShader = {\r\n\t\t\t\t\t\tname: material.type,\r\n\t\t\t\t\t\tuniforms: THREE.UniformsUtils.clone( shader.uniforms ),\r\n\t\t\t\t\t\tvertexShader: shader.vertexShader,\r\n\t\t\t\t\t\tfragmentShader: shader.fragmentShader\r\n\t\t\t\t\t};\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tmaterialProperties.__webglShader = {\r\n\t\t\t\t\t\tname: material.type,\r\n\t\t\t\t\t\tuniforms: material.uniforms,\r\n\t\t\t\t\t\tvertexShader: material.vertexShader,\r\n\t\t\t\t\t\tfragmentShader: material.fragmentShader\r\n\t\t\t\t\t};\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tmaterial.__webglShader = materialProperties.__webglShader;\r\n\t\r\n\t\t\t\tprogram = programCache.acquireProgram( material, parameters, code );\r\n\t\r\n\t\t\t\tmaterialProperties.program = program;\r\n\t\t\t\tmaterial.program = program;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar attributes = program.getAttributes();\r\n\t\r\n\t\t\tif ( material.morphTargets ) {\r\n\t\r\n\t\t\t\tmaterial.numSupportedMorphTargets = 0;\r\n\t\r\n\t\t\t\tfor ( var i = 0; i < _this.maxMorphTargets; i ++ ) {\r\n\t\r\n\t\t\t\t\tif ( attributes[ 'morphTarget' + i ] >= 0 ) {\r\n\t\r\n\t\t\t\t\t\tmaterial.numSupportedMorphTargets ++;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( material.morphNormals ) {\r\n\t\r\n\t\t\t\tmaterial.numSupportedMorphNormals = 0;\r\n\t\r\n\t\t\t\tfor ( i = 0; i < _this.maxMorphNormals; i ++ ) {\r\n\t\r\n\t\t\t\t\tif ( attributes[ 'morphNormal' + i ] >= 0 ) {\r\n\t\r\n\t\t\t\t\t\tmaterial.numSupportedMorphNormals ++;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tmaterialProperties.uniformsList = [];\r\n\t\r\n\t\t\tvar uniformLocations = materialProperties.program.getUniforms();\r\n\t\r\n\t\t\tfor ( var u in materialProperties.__webglShader.uniforms ) {\r\n\t\r\n\t\t\t\tvar location = uniformLocations[ u ];\r\n\t\r\n\t\t\t\tif ( location ) {\r\n\t\r\n\t\t\t\t\tmaterialProperties.uniformsList.push( [ materialProperties.__webglShader.uniforms[ u ], location ] );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction setMaterial( material ) {\r\n\t\r\n\t\t\tsetMaterialFaces( material );\r\n\t\r\n\t\t\tif ( material.transparent === true ) {\r\n\t\r\n\t\t\t\tstate.setBlending( material.blending, material.blendEquation, material.blendSrc, material.blendDst, material.blendEquationAlpha, material.blendSrcAlpha, material.blendDstAlpha );\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\tstate.setBlending( THREE.NoBlending );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tstate.setDepthFunc( material.depthFunc );\r\n\t\t\tstate.setDepthTest( material.depthTest );\r\n\t\t\tstate.setDepthWrite( material.depthWrite );\r\n\t\t\tstate.setColorWrite( material.colorWrite );\r\n\t\t\tstate.setPolygonOffset( material.polygonOffset, material.polygonOffsetFactor, material.polygonOffsetUnits );\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction setMaterialFaces( material ) {\r\n\t\r\n\t\t\tmaterial.side !== THREE.DoubleSide ? state.enable( _gl.CULL_FACE ) : state.disable( _gl.CULL_FACE );\r\n\t\t\tstate.setFlipSided( material.side === THREE.BackSide );\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction setProgram( camera, lights, fog, material, object ) {\r\n\t\r\n\t\t\t_usedTextureUnits = 0;\r\n\t\r\n\t\t\tvar materialProperties = properties.get( material );\r\n\t\r\n\t\t\tif ( material.needsUpdate || ! materialProperties.program ) {\r\n\t\r\n\t\t\t\tinitMaterial( material, lights, fog, object );\r\n\t\t\t\tmaterial.needsUpdate = false;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar refreshProgram = false;\r\n\t\t\tvar refreshMaterial = false;\r\n\t\t\tvar refreshLights = false;\r\n\t\r\n\t\t\tvar program = materialProperties.program,\r\n\t\t\t\tp_uniforms = program.getUniforms(),\r\n\t\t\t\tm_uniforms = materialProperties.__webglShader.uniforms;\r\n\t\r\n\t\t\tif ( program.id !== _currentProgram ) {\r\n\t\r\n\t\t\t\t_gl.useProgram( program.program );\r\n\t\t\t\t_currentProgram = program.id;\r\n\t\r\n\t\t\t\trefreshProgram = true;\r\n\t\t\t\trefreshMaterial = true;\r\n\t\t\t\trefreshLights = true;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( material.id !== _currentMaterialId ) {\r\n\t\r\n\t\t\t\tif ( _currentMaterialId === - 1 ) refreshLights = true;\r\n\t\t\t\t_currentMaterialId = material.id;\r\n\t\r\n\t\t\t\trefreshMaterial = true;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( refreshProgram || camera !== _currentCamera ) {\r\n\t\r\n\t\t\t\t_gl.uniformMatrix4fv( p_uniforms.projectionMatrix, false, camera.projectionMatrix.elements );\r\n\t\r\n\t\t\t\tif ( capabilities.logarithmicDepthBuffer ) {\r\n\t\r\n\t\t\t\t\t_gl.uniform1f( p_uniforms.logDepthBufFC, 2.0 / ( Math.log( camera.far + 1.0 ) / Math.LN2 ) );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\r\n\t\t\t\tif ( camera !== _currentCamera ) _currentCamera = camera;\r\n\t\r\n\t\t\t\t// load material specific uniforms\r\n\t\t\t\t// (shader material also gets them for the sake of genericity)\r\n\t\r\n\t\t\t\tif ( material instanceof THREE.ShaderMaterial ||\r\n\t\t\t\t\t material instanceof THREE.MeshPhongMaterial ||\r\n\t\t\t\t\t material.envMap ) {\r\n\t\r\n\t\t\t\t\tif ( p_uniforms.cameraPosition !== undefined ) {\r\n\t\r\n\t\t\t\t\t\t_vector3.setFromMatrixPosition( camera.matrixWorld );\r\n\t\t\t\t\t\t_gl.uniform3f( p_uniforms.cameraPosition, _vector3.x, _vector3.y, _vector3.z );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( material instanceof THREE.MeshPhongMaterial ||\r\n\t\t\t\t\t material instanceof THREE.MeshLambertMaterial ||\r\n\t\t\t\t\t material instanceof THREE.MeshBasicMaterial ||\r\n\t\t\t\t\t material instanceof THREE.ShaderMaterial ||\r\n\t\t\t\t\t material.skinning ) {\r\n\t\r\n\t\t\t\t\tif ( p_uniforms.viewMatrix !== undefined ) {\r\n\t\r\n\t\t\t\t\t\t_gl.uniformMatrix4fv( p_uniforms.viewMatrix, false, camera.matrixWorldInverse.elements );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// skinning uniforms must be set even if material didn't change\r\n\t\t\t// auto-setting of texture unit for bone texture must go before other textures\r\n\t\t\t// not sure why, but otherwise weird things happen\r\n\t\r\n\t\t\tif ( material.skinning ) {\r\n\t\r\n\t\t\t\tif ( object.bindMatrix && p_uniforms.bindMatrix !== undefined ) {\r\n\t\r\n\t\t\t\t\t_gl.uniformMatrix4fv( p_uniforms.bindMatrix, false, object.bindMatrix.elements );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( object.bindMatrixInverse && p_uniforms.bindMatrixInverse !== undefined ) {\r\n\t\r\n\t\t\t\t\t_gl.uniformMatrix4fv( p_uniforms.bindMatrixInverse, false, object.bindMatrixInverse.elements );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( capabilities.floatVertexTextures && object.skeleton && object.skeleton.useVertexTexture ) {\r\n\t\r\n\t\t\t\t\tif ( p_uniforms.boneTexture !== undefined ) {\r\n\t\r\n\t\t\t\t\t\tvar textureUnit = getTextureUnit();\r\n\t\r\n\t\t\t\t\t\t_gl.uniform1i( p_uniforms.boneTexture, textureUnit );\r\n\t\t\t\t\t\t_this.setTexture( object.skeleton.boneTexture, textureUnit );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tif ( p_uniforms.boneTextureWidth !== undefined ) {\r\n\t\r\n\t\t\t\t\t\t_gl.uniform1i( p_uniforms.boneTextureWidth, object.skeleton.boneTextureWidth );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tif ( p_uniforms.boneTextureHeight !== undefined ) {\r\n\t\r\n\t\t\t\t\t\t_gl.uniform1i( p_uniforms.boneTextureHeight, object.skeleton.boneTextureHeight );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t} else if ( object.skeleton && object.skeleton.boneMatrices ) {\r\n\t\r\n\t\t\t\t\tif ( p_uniforms.boneGlobalMatrices !== undefined ) {\r\n\t\r\n\t\t\t\t\t\t_gl.uniformMatrix4fv( p_uniforms.boneGlobalMatrices, false, object.skeleton.boneMatrices );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( refreshMaterial ) {\r\n\t\r\n\t\t\t\t// refresh uniforms common to several materials\r\n\t\r\n\t\t\t\tif ( fog && material.fog ) {\r\n\t\r\n\t\t\t\t\trefreshUniformsFog( m_uniforms, fog );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( material instanceof THREE.MeshPhongMaterial ||\r\n\t\t\t\t\t material instanceof THREE.MeshLambertMaterial ||\r\n\t\t\t\t\t material.lights ) {\r\n\t\r\n\t\t\t\t\tif ( _lightsNeedUpdate ) {\r\n\t\r\n\t\t\t\t\t\trefreshLights = true;\r\n\t\t\t\t\t\tsetupLights( lights, camera );\r\n\t\t\t\t\t\t_lightsNeedUpdate = false;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tif ( refreshLights ) {\r\n\t\r\n\t\t\t\t\t\trefreshUniformsLights( m_uniforms, _lights );\r\n\t\t\t\t\t\tmarkUniformsLightsNeedsUpdate( m_uniforms, true );\r\n\t\r\n\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\tmarkUniformsLightsNeedsUpdate( m_uniforms, false );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( material instanceof THREE.MeshBasicMaterial ||\r\n\t\t\t\t\t material instanceof THREE.MeshLambertMaterial ||\r\n\t\t\t\t\t material instanceof THREE.MeshPhongMaterial ) {\r\n\t\r\n\t\t\t\t\trefreshUniformsCommon( m_uniforms, material );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\t// refresh single material specific uniforms\r\n\t\r\n\t\t\t\tif ( material instanceof THREE.LineBasicMaterial ) {\r\n\t\r\n\t\t\t\t\trefreshUniformsLine( m_uniforms, material );\r\n\t\r\n\t\t\t\t} else if ( material instanceof THREE.LineDashedMaterial ) {\r\n\t\r\n\t\t\t\t\trefreshUniformsLine( m_uniforms, material );\r\n\t\t\t\t\trefreshUniformsDash( m_uniforms, material );\r\n\t\r\n\t\t\t\t} else if ( material instanceof THREE.PointsMaterial ) {\r\n\t\r\n\t\t\t\t\trefreshUniformsParticle( m_uniforms, material );\r\n\t\r\n\t\t\t\t} else if ( material instanceof THREE.MeshPhongMaterial ) {\r\n\t\r\n\t\t\t\t\trefreshUniformsPhong( m_uniforms, material );\r\n\t\r\n\t\t\t\t} else if ( material instanceof THREE.MeshDepthMaterial ) {\r\n\t\r\n\t\t\t\t\tm_uniforms.mNear.value = camera.near;\r\n\t\t\t\t\tm_uniforms.mFar.value = camera.far;\r\n\t\t\t\t\tm_uniforms.opacity.value = material.opacity;\r\n\t\r\n\t\t\t\t} else if ( material instanceof THREE.MeshNormalMaterial ) {\r\n\t\r\n\t\t\t\t\tm_uniforms.opacity.value = material.opacity;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( object.receiveShadow && ! material._shadowPass ) {\r\n\t\r\n\t\t\t\t\trefreshUniformsShadow( m_uniforms, lights, camera );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\t// load common uniforms\r\n\t\r\n\t\t\t\tloadUniformsGeneric( materialProperties.uniformsList );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tloadUniformsMatrices( p_uniforms, object );\r\n\t\r\n\t\t\tif ( p_uniforms.modelMatrix !== undefined ) {\r\n\t\r\n\t\t\t\t_gl.uniformMatrix4fv( p_uniforms.modelMatrix, false, object.matrixWorld.elements );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn program;\r\n\t\r\n\t\t}\r\n\t\r\n\t\t// Uniforms (refresh uniforms objects)\r\n\t\r\n\t\tfunction refreshUniformsCommon ( uniforms, material ) {\r\n\t\r\n\t\t\tuniforms.opacity.value = material.opacity;\r\n\t\r\n\t\t\tuniforms.diffuse.value = material.color;\r\n\t\r\n\t\t\tif ( material.emissive ) {\r\n\t\r\n\t\t\t\tuniforms.emissive.value = material.emissive;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tuniforms.map.value = material.map;\r\n\t\t\tuniforms.specularMap.value = material.specularMap;\r\n\t\t\tuniforms.alphaMap.value = material.alphaMap;\r\n\t\r\n\t\t\tif ( material.aoMap ) {\r\n\t\r\n\t\t\t\tuniforms.aoMap.value = material.aoMap;\r\n\t\t\t\tuniforms.aoMapIntensity.value = material.aoMapIntensity;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// uv repeat and offset setting priorities\r\n\t\t\t// 1. color map\r\n\t\t\t// 2. specular map\r\n\t\t\t// 3. normal map\r\n\t\t\t// 4. bump map\r\n\t\t\t// 5. alpha map\r\n\t\t\t// 6. emissive map\r\n\t\r\n\t\t\tvar uvScaleMap;\r\n\t\r\n\t\t\tif ( material.map ) {\r\n\t\r\n\t\t\t\tuvScaleMap = material.map;\r\n\t\r\n\t\t\t} else if ( material.specularMap ) {\r\n\t\r\n\t\t\t\tuvScaleMap = material.specularMap;\r\n\t\r\n\t\t\t} else if ( material.displacementMap ) {\r\n\t\r\n\t\t\t\tuvScaleMap = material.displacementMap;\r\n\t\r\n\t\t\t} else if ( material.normalMap ) {\r\n\t\r\n\t\t\t\tuvScaleMap = material.normalMap;\r\n\t\r\n\t\t\t} else if ( material.bumpMap ) {\r\n\t\r\n\t\t\t\tuvScaleMap = material.bumpMap;\r\n\t\r\n\t\t\t} else if ( material.alphaMap ) {\r\n\t\r\n\t\t\t\tuvScaleMap = material.alphaMap;\r\n\t\r\n\t\t\t} else if ( material.emissiveMap ) {\r\n\t\r\n\t\t\t\tuvScaleMap = material.emissiveMap;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( uvScaleMap !== undefined ) {\r\n\t\r\n\t\t\t\tif ( uvScaleMap instanceof THREE.WebGLRenderTarget ) uvScaleMap = uvScaleMap.texture;\r\n\t\t\t\tvar offset = uvScaleMap.offset;\r\n\t\t\t\tvar repeat = uvScaleMap.repeat;\r\n\t\r\n\t\t\t\tuniforms.offsetRepeat.value.set( offset.x, offset.y, repeat.x, repeat.y );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tuniforms.envMap.value = material.envMap;\r\n\t\t\tuniforms.flipEnvMap.value = ( material.envMap instanceof THREE.WebGLRenderTargetCube ) ? 1 : - 1;\r\n\t\r\n\t\t\tuniforms.reflectivity.value = material.reflectivity;\r\n\t\t\tuniforms.refractionRatio.value = material.refractionRatio;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction refreshUniformsLine ( uniforms, material ) {\r\n\t\r\n\t\t\tuniforms.diffuse.value = material.color;\r\n\t\t\tuniforms.opacity.value = material.opacity;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction refreshUniformsDash ( uniforms, material ) {\r\n\t\r\n\t\t\tuniforms.dashSize.value = material.dashSize;\r\n\t\t\tuniforms.totalSize.value = material.dashSize + material.gapSize;\r\n\t\t\tuniforms.scale.value = material.scale;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction refreshUniformsParticle ( uniforms, material ) {\r\n\t\r\n\t\t\tuniforms.psColor.value = material.color;\r\n\t\t\tuniforms.opacity.value = material.opacity;\r\n\t\t\tuniforms.size.value = material.size;\r\n\t\t\tuniforms.scale.value = _canvas.height / 2.0; // TODO: Cache this.\r\n\t\r\n\t\t\tuniforms.map.value = material.map;\r\n\t\r\n\t\t\tif ( material.map !== null ) {\r\n\t\r\n\t\t\t\tvar offset = material.map.offset;\r\n\t\t\t\tvar repeat = material.map.repeat;\r\n\t\r\n\t\t\t\tuniforms.offsetRepeat.value.set( offset.x, offset.y, repeat.x, repeat.y );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction refreshUniformsFog ( uniforms, fog ) {\r\n\t\r\n\t\t\tuniforms.fogColor.value = fog.color;\r\n\t\r\n\t\t\tif ( fog instanceof THREE.Fog ) {\r\n\t\r\n\t\t\t\tuniforms.fogNear.value = fog.near;\r\n\t\t\t\tuniforms.fogFar.value = fog.far;\r\n\t\r\n\t\t\t} else if ( fog instanceof THREE.FogExp2 ) {\r\n\t\r\n\t\t\t\tuniforms.fogDensity.value = fog.density;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction refreshUniformsPhong ( uniforms, material ) {\r\n\t\r\n\t\t\tuniforms.specular.value = material.specular;\r\n\t\t\tuniforms.shininess.value = Math.max( material.shininess, 1e-4 ); // to prevent pow( 0.0, 0.0 )\r\n\t\r\n\t\t\tif ( material.lightMap ) {\r\n\t\r\n\t\t\t\tuniforms.lightMap.value = material.lightMap;\r\n\t\t\t\tuniforms.lightMapIntensity.value = material.lightMapIntensity;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( material.emissiveMap ) {\r\n\t\r\n\t\t\t\tuniforms.emissiveMap.value = material.emissiveMap;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( material.bumpMap ) {\r\n\t\r\n\t\t\t\tuniforms.bumpMap.value = material.bumpMap;\r\n\t\t\t\tuniforms.bumpScale.value = material.bumpScale;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( material.normalMap ) {\r\n\t\r\n\t\t\t\tuniforms.normalMap.value = material.normalMap;\r\n\t\t\t\tuniforms.normalScale.value.copy( material.normalScale );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( material.displacementMap ) {\r\n\t\r\n\t\t\t\tuniforms.displacementMap.value = material.displacementMap;\r\n\t\t\t\tuniforms.displacementScale.value = material.displacementScale;\r\n\t\t\t\tuniforms.displacementBias.value = material.displacementBias;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction refreshUniformsLights ( uniforms, lights ) {\r\n\t\r\n\t\t\tuniforms.ambientLightColor.value = lights.ambient;\r\n\t\r\n\t\t\tuniforms.directionalLightColor.value = lights.directional.colors;\r\n\t\t\tuniforms.directionalLightDirection.value = lights.directional.positions;\r\n\t\r\n\t\t\tuniforms.pointLightColor.value = lights.point.colors;\r\n\t\t\tuniforms.pointLightPosition.value = lights.point.positions;\r\n\t\t\tuniforms.pointLightDistance.value = lights.point.distances;\r\n\t\t\tuniforms.pointLightDecay.value = lights.point.decays;\r\n\t\r\n\t\t\tuniforms.spotLightColor.value = lights.spot.colors;\r\n\t\t\tuniforms.spotLightPosition.value = lights.spot.positions;\r\n\t\t\tuniforms.spotLightDistance.value = lights.spot.distances;\r\n\t\t\tuniforms.spotLightDirection.value = lights.spot.directions;\r\n\t\t\tuniforms.spotLightAngleCos.value = lights.spot.anglesCos;\r\n\t\t\tuniforms.spotLightExponent.value = lights.spot.exponents;\r\n\t\t\tuniforms.spotLightDecay.value = lights.spot.decays;\r\n\t\r\n\t\t\tuniforms.hemisphereLightSkyColor.value = lights.hemi.skyColors;\r\n\t\t\tuniforms.hemisphereLightGroundColor.value = lights.hemi.groundColors;\r\n\t\t\tuniforms.hemisphereLightDirection.value = lights.hemi.positions;\r\n\t\r\n\t\t}\r\n\t\r\n\t\t// If uniforms are marked as clean, they don't need to be loaded to the GPU.\r\n\t\r\n\t\tfunction markUniformsLightsNeedsUpdate ( uniforms, value ) {\r\n\t\r\n\t\t\tuniforms.ambientLightColor.needsUpdate = value;\r\n\t\r\n\t\t\tuniforms.directionalLightColor.needsUpdate = value;\r\n\t\t\tuniforms.directionalLightDirection.needsUpdate = value;\r\n\t\r\n\t\t\tuniforms.pointLightColor.needsUpdate = value;\r\n\t\t\tuniforms.pointLightPosition.needsUpdate = value;\r\n\t\t\tuniforms.pointLightDistance.needsUpdate = value;\r\n\t\t\tuniforms.pointLightDecay.needsUpdate = value;\r\n\t\r\n\t\t\tuniforms.spotLightColor.needsUpdate = value;\r\n\t\t\tuniforms.spotLightPosition.needsUpdate = value;\r\n\t\t\tuniforms.spotLightDistance.needsUpdate = value;\r\n\t\t\tuniforms.spotLightDirection.needsUpdate = value;\r\n\t\t\tuniforms.spotLightAngleCos.needsUpdate = value;\r\n\t\t\tuniforms.spotLightExponent.needsUpdate = value;\r\n\t\t\tuniforms.spotLightDecay.needsUpdate = value;\r\n\t\r\n\t\t\tuniforms.hemisphereLightSkyColor.needsUpdate = value;\r\n\t\t\tuniforms.hemisphereLightGroundColor.needsUpdate = value;\r\n\t\t\tuniforms.hemisphereLightDirection.needsUpdate = value;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction refreshUniformsShadow ( uniforms, lights, camera ) {\r\n\t\r\n\t\t\tif ( uniforms.shadowMatrix ) {\r\n\t\r\n\t\t\t\tvar j = 0;\r\n\t\r\n\t\t\t\tfor ( var i = 0, il = lights.length; i < il; i ++ ) {\r\n\t\r\n\t\t\t\t\tvar light = lights[ i ];\r\n\t\r\n\t\t\t\t\tif ( light.castShadow === true ) {\r\n\t\r\n\t\t\t\t\t\tif ( light instanceof THREE.PointLight || light instanceof THREE.SpotLight || light instanceof THREE.DirectionalLight ) {\r\n\t\r\n\t\t\t\t\t\t\tvar shadow = light.shadow;\r\n\t\r\n\t\t\t\t\t\t\tif ( light instanceof THREE.PointLight ) {\r\n\t\r\n\t\t\t\t\t\t\t\t// for point lights we set the shadow matrix to be a translation-only matrix\r\n\t\t\t\t\t\t\t\t// equal to inverse of the light's position\r\n\t\t\t\t\t\t\t\t_vector3.setFromMatrixPosition( light.matrixWorld ).negate();\r\n\t\t\t\t\t\t\t\tshadow.matrix.identity().setPosition( _vector3 );\r\n\t\r\n\t\t\t\t\t\t\t\t// for point lights we set the sign of the shadowDarkness uniform to be negative\r\n\t\t\t\t\t\t\t\tuniforms.shadowDarkness.value[ j ] = - shadow.darkness;\r\n\t\r\n\t\t\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\t\t\tuniforms.shadowDarkness.value[ j ] = shadow.darkness;\r\n\t\r\n\t\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t\tuniforms.shadowMatrix.value[ j ] = shadow.matrix;\r\n\t\t\t\t\t\t\tuniforms.shadowMap.value[ j ] = shadow.map;\r\n\t\t\t\t\t\t\tuniforms.shadowMapSize.value[ j ] = shadow.mapSize;\r\n\t\t\t\t\t\t\tuniforms.shadowBias.value[ j ] = shadow.bias;\r\n\t\r\n\t\t\t\t\t\t\tj ++;\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\t// Uniforms (load to GPU)\r\n\t\r\n\t\tfunction loadUniformsMatrices ( uniforms, object ) {\r\n\t\r\n\t\t\t_gl.uniformMatrix4fv( uniforms.modelViewMatrix, false, object.modelViewMatrix.elements );\r\n\t\r\n\t\t\tif ( uniforms.normalMatrix ) {\r\n\t\r\n\t\t\t\t_gl.uniformMatrix3fv( uniforms.normalMatrix, false, object.normalMatrix.elements );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction getTextureUnit() {\r\n\t\r\n\t\t\tvar textureUnit = _usedTextureUnits;\r\n\t\r\n\t\t\tif ( textureUnit >= capabilities.maxTextures ) {\r\n\t\r\n\t\t\t\tconsole.warn( 'WebGLRenderer: trying to use ' + textureUnit + ' texture units while this GPU supports only ' + capabilities.maxTextures );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t_usedTextureUnits += 1;\r\n\t\r\n\t\t\treturn textureUnit;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction loadUniformsGeneric ( uniforms ) {\r\n\t\r\n\t\t\tvar texture, textureUnit;\r\n\t\r\n\t\t\tfor ( var j = 0, jl = uniforms.length; j < jl; j ++ ) {\r\n\t\r\n\t\t\t\tvar uniform = uniforms[ j ][ 0 ];\r\n\t\r\n\t\t\t\t// needsUpdate property is not added to all uniforms.\r\n\t\t\t\tif ( uniform.needsUpdate === false ) continue;\r\n\t\r\n\t\t\t\tvar type = uniform.type;\r\n\t\t\t\tvar value = uniform.value;\r\n\t\t\t\tvar location = uniforms[ j ][ 1 ];\r\n\t\r\n\t\t\t\tswitch ( type ) {\r\n\t\r\n\t\t\t\t\tcase '1i':\r\n\t\t\t\t\t\t_gl.uniform1i( location, value );\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase '1f':\r\n\t\t\t\t\t\t_gl.uniform1f( location, value );\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase '2f':\r\n\t\t\t\t\t\t_gl.uniform2f( location, value[ 0 ], value[ 1 ] );\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase '3f':\r\n\t\t\t\t\t\t_gl.uniform3f( location, value[ 0 ], value[ 1 ], value[ 2 ] );\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase '4f':\r\n\t\t\t\t\t\t_gl.uniform4f( location, value[ 0 ], value[ 1 ], value[ 2 ], value[ 3 ] );\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase '1iv':\r\n\t\t\t\t\t\t_gl.uniform1iv( location, value );\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase '3iv':\r\n\t\t\t\t\t\t_gl.uniform3iv( location, value );\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase '1fv':\r\n\t\t\t\t\t\t_gl.uniform1fv( location, value );\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase '2fv':\r\n\t\t\t\t\t\t_gl.uniform2fv( location, value );\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase '3fv':\r\n\t\t\t\t\t\t_gl.uniform3fv( location, value );\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase '4fv':\r\n\t\t\t\t\t\t_gl.uniform4fv( location, value );\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase 'Matrix3fv':\r\n\t\t\t\t\t\t_gl.uniformMatrix3fv( location, false, value );\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase 'Matrix4fv':\r\n\t\t\t\t\t\t_gl.uniformMatrix4fv( location, false, value );\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\t//\r\n\t\r\n\t\t\t\t\tcase 'i':\r\n\t\r\n\t\t\t\t\t\t// single integer\r\n\t\t\t\t\t\t_gl.uniform1i( location, value );\r\n\t\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase 'f':\r\n\t\r\n\t\t\t\t\t\t// single float\r\n\t\t\t\t\t\t_gl.uniform1f( location, value );\r\n\t\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase 'v2':\r\n\t\r\n\t\t\t\t\t\t// single THREE.Vector2\r\n\t\t\t\t\t\t_gl.uniform2f( location, value.x, value.y );\r\n\t\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase 'v3':\r\n\t\r\n\t\t\t\t\t\t// single THREE.Vector3\r\n\t\t\t\t\t\t_gl.uniform3f( location, value.x, value.y, value.z );\r\n\t\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase 'v4':\r\n\t\r\n\t\t\t\t\t\t// single THREE.Vector4\r\n\t\t\t\t\t\t_gl.uniform4f( location, value.x, value.y, value.z, value.w );\r\n\t\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase 'c':\r\n\t\r\n\t\t\t\t\t\t// single THREE.Color\r\n\t\t\t\t\t\t_gl.uniform3f( location, value.r, value.g, value.b );\r\n\t\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase 'iv1':\r\n\t\r\n\t\t\t\t\t\t// flat array of integers (JS or typed array)\r\n\t\t\t\t\t\t_gl.uniform1iv( location, value );\r\n\t\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase 'iv':\r\n\t\r\n\t\t\t\t\t\t// flat array of integers with 3 x N size (JS or typed array)\r\n\t\t\t\t\t\t_gl.uniform3iv( location, value );\r\n\t\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase 'fv1':\r\n\t\r\n\t\t\t\t\t\t// flat array of floats (JS or typed array)\r\n\t\t\t\t\t\t_gl.uniform1fv( location, value );\r\n\t\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase 'fv':\r\n\t\r\n\t\t\t\t\t\t// flat array of floats with 3 x N size (JS or typed array)\r\n\t\t\t\t\t\t_gl.uniform3fv( location, value );\r\n\t\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase 'v2v':\r\n\t\r\n\t\t\t\t\t\t// array of THREE.Vector2\r\n\t\r\n\t\t\t\t\t\tif ( uniform._array === undefined ) {\r\n\t\r\n\t\t\t\t\t\t\tuniform._array = new Float32Array( 2 * value.length );\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\tfor ( var i = 0, i2 = 0, il = value.length; i < il; i ++, i2 += 2 ) {\r\n\t\r\n\t\t\t\t\t\t\tuniform._array[ i2 + 0 ] = value[ i ].x;\r\n\t\t\t\t\t\t\tuniform._array[ i2 + 1 ] = value[ i ].y;\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t_gl.uniform2fv( location, uniform._array );\r\n\t\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase 'v3v':\r\n\t\r\n\t\t\t\t\t\t// array of THREE.Vector3\r\n\t\r\n\t\t\t\t\t\tif ( uniform._array === undefined ) {\r\n\t\r\n\t\t\t\t\t\t\tuniform._array = new Float32Array( 3 * value.length );\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\tfor ( var i = 0, i3 = 0, il = value.length; i < il; i ++, i3 += 3 ) {\r\n\t\r\n\t\t\t\t\t\t\tuniform._array[ i3 + 0 ] = value[ i ].x;\r\n\t\t\t\t\t\t\tuniform._array[ i3 + 1 ] = value[ i ].y;\r\n\t\t\t\t\t\t\tuniform._array[ i3 + 2 ] = value[ i ].z;\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t_gl.uniform3fv( location, uniform._array );\r\n\t\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase 'v4v':\r\n\t\r\n\t\t\t\t\t\t// array of THREE.Vector4\r\n\t\r\n\t\t\t\t\t\tif ( uniform._array === undefined ) {\r\n\t\r\n\t\t\t\t\t\t\tuniform._array = new Float32Array( 4 * value.length );\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\tfor ( var i = 0, i4 = 0, il = value.length; i < il; i ++, i4 += 4 ) {\r\n\t\r\n\t\t\t\t\t\t\tuniform._array[ i4 + 0 ] = value[ i ].x;\r\n\t\t\t\t\t\t\tuniform._array[ i4 + 1 ] = value[ i ].y;\r\n\t\t\t\t\t\t\tuniform._array[ i4 + 2 ] = value[ i ].z;\r\n\t\t\t\t\t\t\tuniform._array[ i4 + 3 ] = value[ i ].w;\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t_gl.uniform4fv( location, uniform._array );\r\n\t\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase 'm3':\r\n\t\r\n\t\t\t\t\t\t// single THREE.Matrix3\r\n\t\t\t\t\t\t_gl.uniformMatrix3fv( location, false, value.elements );\r\n\t\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase 'm3v':\r\n\t\r\n\t\t\t\t\t\t// array of THREE.Matrix3\r\n\t\r\n\t\t\t\t\t\tif ( uniform._array === undefined ) {\r\n\t\r\n\t\t\t\t\t\t\tuniform._array = new Float32Array( 9 * value.length );\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\tfor ( var i = 0, il = value.length; i < il; i ++ ) {\r\n\t\r\n\t\t\t\t\t\t\tvalue[ i ].flattenToArrayOffset( uniform._array, i * 9 );\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t_gl.uniformMatrix3fv( location, false, uniform._array );\r\n\t\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase 'm4':\r\n\t\r\n\t\t\t\t\t\t// single THREE.Matrix4\r\n\t\t\t\t\t\t_gl.uniformMatrix4fv( location, false, value.elements );\r\n\t\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase 'm4v':\r\n\t\r\n\t\t\t\t\t\t// array of THREE.Matrix4\r\n\t\r\n\t\t\t\t\t\tif ( uniform._array === undefined ) {\r\n\t\r\n\t\t\t\t\t\t\tuniform._array = new Float32Array( 16 * value.length );\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\tfor ( var i = 0, il = value.length; i < il; i ++ ) {\r\n\t\r\n\t\t\t\t\t\t\tvalue[ i ].flattenToArrayOffset( uniform._array, i * 16 );\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t_gl.uniformMatrix4fv( location, false, uniform._array );\r\n\t\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase 't':\r\n\t\r\n\t\t\t\t\t\t// single THREE.Texture (2d or cube)\r\n\t\r\n\t\t\t\t\t\ttexture = value;\r\n\t\t\t\t\t\ttextureUnit = getTextureUnit();\r\n\t\r\n\t\t\t\t\t\t_gl.uniform1i( location, textureUnit );\r\n\t\r\n\t\t\t\t\t\tif ( ! texture ) continue;\r\n\t\r\n\t\t\t\t\t\tif ( texture instanceof THREE.CubeTexture ||\r\n\t\t\t\t\t\t\t ( Array.isArray( texture.image ) && texture.image.length === 6 ) ) {\r\n\t\r\n\t\t\t\t\t\t\t// CompressedTexture can have Array in image :/\r\n\t\r\n\t\t\t\t\t\t\tsetCubeTexture( texture, textureUnit );\r\n\t\r\n\t\t\t\t\t\t} else if ( texture instanceof THREE.WebGLRenderTargetCube ) {\r\n\t\r\n\t\t\t\t\t\t\tsetCubeTextureDynamic( texture.texture, textureUnit );\r\n\t\r\n\t\t\t\t\t\t} else if ( texture instanceof THREE.WebGLRenderTarget ) {\r\n\t\r\n\t\t\t\t\t\t\t_this.setTexture( texture.texture, textureUnit );\r\n\t\r\n\t\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\t\t_this.setTexture( texture, textureUnit );\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase 'tv':\r\n\t\r\n\t\t\t\t\t\t// array of THREE.Texture (2d or cube)\r\n\t\r\n\t\t\t\t\t\tif ( uniform._array === undefined ) {\r\n\t\r\n\t\t\t\t\t\t\tuniform._array = [];\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\tfor ( var i = 0, il = uniform.value.length; i < il; i ++ ) {\r\n\t\r\n\t\t\t\t\t\t\tuniform._array[ i ] = getTextureUnit();\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t_gl.uniform1iv( location, uniform._array );\r\n\t\r\n\t\t\t\t\t\tfor ( var i = 0, il = uniform.value.length; i < il; i ++ ) {\r\n\t\r\n\t\t\t\t\t\t\ttexture = uniform.value[ i ];\r\n\t\t\t\t\t\t\ttextureUnit = uniform._array[ i ];\r\n\t\r\n\t\t\t\t\t\t\tif ( ! texture ) continue;\r\n\t\r\n\t\t\t\t\t\t\tif ( texture instanceof THREE.CubeTexture ||\r\n\t\t\t\t\t\t\t\t ( texture.image instanceof Array && texture.image.length === 6 ) ) {\r\n\t\r\n\t\t\t\t\t\t\t\t// CompressedTexture can have Array in image :/\r\n\t\r\n\t\t\t\t\t\t\t\tsetCubeTexture( texture, textureUnit );\r\n\t\r\n\t\t\t\t\t\t\t} else if ( texture instanceof THREE.WebGLRenderTarget ) {\r\n\t\r\n\t\t\t\t\t\t\t\t_this.setTexture( texture.texture, textureUnit );\r\n\t\r\n\t\t\t\t\t\t\t} else if ( texture instanceof THREE.WebGLRenderTargetCube ) {\r\n\t\r\n\t\t\t\t\t\t\t\tsetCubeTextureDynamic( texture.texture, textureUnit );\r\n\t\r\n\t\t\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\t\t\t_this.setTexture( texture, textureUnit );\r\n\t\r\n\t\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tdefault:\r\n\t\r\n\t\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Unknown uniform type: ' + type );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction setColorLinear( array, offset, color, intensity ) {\r\n\t\r\n\t\t\tarray[ offset + 0 ] = color.r * intensity;\r\n\t\t\tarray[ offset + 1 ] = color.g * intensity;\r\n\t\t\tarray[ offset + 2 ] = color.b * intensity;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction setupLights ( lights, camera ) {\r\n\t\r\n\t\t\tvar l, ll, light,\r\n\t\t\tr = 0, g = 0, b = 0,\r\n\t\t\tcolor, skyColor, groundColor,\r\n\t\t\tintensity,\r\n\t\t\tdistance,\r\n\t\r\n\t\t\tzlights = _lights,\r\n\t\r\n\t\t\tviewMatrix = camera.matrixWorldInverse,\r\n\t\r\n\t\t\tdirColors = zlights.directional.colors,\r\n\t\t\tdirPositions = zlights.directional.positions,\r\n\t\r\n\t\t\tpointColors = zlights.point.colors,\r\n\t\t\tpointPositions = zlights.point.positions,\r\n\t\t\tpointDistances = zlights.point.distances,\r\n\t\t\tpointDecays = zlights.point.decays,\r\n\t\r\n\t\t\tspotColors = zlights.spot.colors,\r\n\t\t\tspotPositions = zlights.spot.positions,\r\n\t\t\tspotDistances = zlights.spot.distances,\r\n\t\t\tspotDirections = zlights.spot.directions,\r\n\t\t\tspotAnglesCos = zlights.spot.anglesCos,\r\n\t\t\tspotExponents = zlights.spot.exponents,\r\n\t\t\tspotDecays = zlights.spot.decays,\r\n\t\r\n\t\t\themiSkyColors = zlights.hemi.skyColors,\r\n\t\t\themiGroundColors = zlights.hemi.groundColors,\r\n\t\t\themiPositions = zlights.hemi.positions,\r\n\t\r\n\t\t\tdirLength = 0,\r\n\t\t\tpointLength = 0,\r\n\t\t\tspotLength = 0,\r\n\t\t\themiLength = 0,\r\n\t\r\n\t\t\tdirCount = 0,\r\n\t\t\tpointCount = 0,\r\n\t\t\tspotCount = 0,\r\n\t\t\themiCount = 0,\r\n\t\r\n\t\t\tdirOffset = 0,\r\n\t\t\tpointOffset = 0,\r\n\t\t\tspotOffset = 0,\r\n\t\t\themiOffset = 0;\r\n\t\r\n\t\t\tfor ( l = 0, ll = lights.length; l < ll; l ++ ) {\r\n\t\r\n\t\t\t\tlight = lights[ l ];\r\n\t\r\n\t\t\t\tcolor = light.color;\r\n\t\t\t\tintensity = light.intensity;\r\n\t\t\t\tdistance = light.distance;\r\n\t\r\n\t\t\t\tif ( light instanceof THREE.AmbientLight ) {\r\n\t\r\n\t\t\t\t\tif ( ! light.visible ) continue;\r\n\t\r\n\t\t\t\t\tr += color.r;\r\n\t\t\t\t\tg += color.g;\r\n\t\t\t\t\tb += color.b;\r\n\t\r\n\t\t\t\t} else if ( light instanceof THREE.DirectionalLight ) {\r\n\t\r\n\t\t\t\t\tdirCount += 1;\r\n\t\r\n\t\t\t\t\tif ( ! light.visible ) continue;\r\n\t\r\n\t\t\t\t\t_direction.setFromMatrixPosition( light.matrixWorld );\r\n\t\t\t\t\t_vector3.setFromMatrixPosition( light.target.matrixWorld );\r\n\t\t\t\t\t_direction.sub( _vector3 );\r\n\t\t\t\t\t_direction.transformDirection( viewMatrix );\r\n\t\r\n\t\t\t\t\tdirOffset = dirLength * 3;\r\n\t\r\n\t\t\t\t\tdirPositions[ dirOffset + 0 ] = _direction.x;\r\n\t\t\t\t\tdirPositions[ dirOffset + 1 ] = _direction.y;\r\n\t\t\t\t\tdirPositions[ dirOffset + 2 ] = _direction.z;\r\n\t\r\n\t\t\t\t\tsetColorLinear( dirColors, dirOffset, color, intensity );\r\n\t\r\n\t\t\t\t\tdirLength += 1;\r\n\t\r\n\t\t\t\t} else if ( light instanceof THREE.PointLight ) {\r\n\t\r\n\t\t\t\t\tpointCount += 1;\r\n\t\r\n\t\t\t\t\tif ( ! light.visible ) continue;\r\n\t\r\n\t\t\t\t\tpointOffset = pointLength * 3;\r\n\t\r\n\t\t\t\t\tsetColorLinear( pointColors, pointOffset, color, intensity );\r\n\t\r\n\t\t\t\t\t_vector3.setFromMatrixPosition( light.matrixWorld );\r\n\t\t\t\t\t_vector3.applyMatrix4( viewMatrix );\r\n\t\r\n\t\t\t\t\tpointPositions[ pointOffset + 0 ] = _vector3.x;\r\n\t\t\t\t\tpointPositions[ pointOffset + 1 ] = _vector3.y;\r\n\t\t\t\t\tpointPositions[ pointOffset + 2 ] = _vector3.z;\r\n\t\r\n\t\t\t\t\t// distance is 0 if decay is 0, because there is no attenuation at all.\r\n\t\t\t\t\tpointDistances[ pointLength ] = distance;\r\n\t\t\t\t\tpointDecays[ pointLength ] = ( light.distance === 0 ) ? 0.0 : light.decay;\r\n\t\r\n\t\t\t\t\tpointLength += 1;\r\n\t\r\n\t\t\t\t} else if ( light instanceof THREE.SpotLight ) {\r\n\t\r\n\t\t\t\t\tspotCount += 1;\r\n\t\r\n\t\t\t\t\tif ( ! light.visible ) continue;\r\n\t\r\n\t\t\t\t\tspotOffset = spotLength * 3;\r\n\t\r\n\t\t\t\t\tsetColorLinear( spotColors, spotOffset, color, intensity );\r\n\t\r\n\t\t\t\t\t_direction.setFromMatrixPosition( light.matrixWorld );\r\n\t\t\t\t\t_vector3.copy( _direction ).applyMatrix4( viewMatrix );\r\n\t\r\n\t\t\t\t\tspotPositions[ spotOffset + 0 ] = _vector3.x;\r\n\t\t\t\t\tspotPositions[ spotOffset + 1 ] = _vector3.y;\r\n\t\t\t\t\tspotPositions[ spotOffset + 2 ] = _vector3.z;\r\n\t\r\n\t\t\t\t\tspotDistances[ spotLength ] = distance;\r\n\t\r\n\t\t\t\t\t_vector3.setFromMatrixPosition( light.target.matrixWorld );\r\n\t\t\t\t\t_direction.sub( _vector3 );\r\n\t\t\t\t\t_direction.transformDirection( viewMatrix );\r\n\t\r\n\t\t\t\t\tspotDirections[ spotOffset + 0 ] = _direction.x;\r\n\t\t\t\t\tspotDirections[ spotOffset + 1 ] = _direction.y;\r\n\t\t\t\t\tspotDirections[ spotOffset + 2 ] = _direction.z;\r\n\t\r\n\t\t\t\t\tspotAnglesCos[ spotLength ] = Math.cos( light.angle );\r\n\t\t\t\t\tspotExponents[ spotLength ] = light.exponent;\r\n\t\t\t\t\tspotDecays[ spotLength ] = ( light.distance === 0 ) ? 0.0 : light.decay;\r\n\t\r\n\t\t\t\t\tspotLength += 1;\r\n\t\r\n\t\t\t\t} else if ( light instanceof THREE.HemisphereLight ) {\r\n\t\r\n\t\t\t\t\themiCount += 1;\r\n\t\r\n\t\t\t\t\tif ( ! light.visible ) continue;\r\n\t\r\n\t\t\t\t\t_direction.setFromMatrixPosition( light.matrixWorld );\r\n\t\t\t\t\t_direction.transformDirection( viewMatrix );\r\n\t\r\n\t\t\t\t\themiOffset = hemiLength * 3;\r\n\t\r\n\t\t\t\t\themiPositions[ hemiOffset + 0 ] = _direction.x;\r\n\t\t\t\t\themiPositions[ hemiOffset + 1 ] = _direction.y;\r\n\t\t\t\t\themiPositions[ hemiOffset + 2 ] = _direction.z;\r\n\t\r\n\t\t\t\t\tskyColor = light.color;\r\n\t\t\t\t\tgroundColor = light.groundColor;\r\n\t\r\n\t\t\t\t\tsetColorLinear( hemiSkyColors, hemiOffset, skyColor, intensity );\r\n\t\t\t\t\tsetColorLinear( hemiGroundColors, hemiOffset, groundColor, intensity );\r\n\t\r\n\t\t\t\t\themiLength += 1;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// null eventual remains from removed lights\r\n\t\t\t// (this is to avoid if in shader)\r\n\t\r\n\t\t\tfor ( l = dirLength * 3, ll = Math.max( dirColors.length, dirCount * 3 ); l < ll; l ++ ) dirColors[ l ] = 0.0;\r\n\t\t\tfor ( l = pointLength * 3, ll = Math.max( pointColors.length, pointCount * 3 ); l < ll; l ++ ) pointColors[ l ] = 0.0;\r\n\t\t\tfor ( l = spotLength * 3, ll = Math.max( spotColors.length, spotCount * 3 ); l < ll; l ++ ) spotColors[ l ] = 0.0;\r\n\t\t\tfor ( l = hemiLength * 3, ll = Math.max( hemiSkyColors.length, hemiCount * 3 ); l < ll; l ++ ) hemiSkyColors[ l ] = 0.0;\r\n\t\t\tfor ( l = hemiLength * 3, ll = Math.max( hemiGroundColors.length, hemiCount * 3 ); l < ll; l ++ ) hemiGroundColors[ l ] = 0.0;\r\n\t\r\n\t\t\tzlights.directional.length = dirLength;\r\n\t\t\tzlights.point.length = pointLength;\r\n\t\t\tzlights.spot.length = spotLength;\r\n\t\t\tzlights.hemi.length = hemiLength;\r\n\t\r\n\t\t\tzlights.ambient[ 0 ] = r;\r\n\t\t\tzlights.ambient[ 1 ] = g;\r\n\t\t\tzlights.ambient[ 2 ] = b;\r\n\t\r\n\t\t}\r\n\t\r\n\t\t// GL state setting\r\n\t\r\n\t\tthis.setFaceCulling = function ( cullFace, frontFaceDirection ) {\r\n\t\r\n\t\t\tif ( cullFace === THREE.CullFaceNone ) {\r\n\t\r\n\t\t\t\tstate.disable( _gl.CULL_FACE );\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\tif ( frontFaceDirection === THREE.FrontFaceDirectionCW ) {\r\n\t\r\n\t\t\t\t\t_gl.frontFace( _gl.CW );\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t_gl.frontFace( _gl.CCW );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( cullFace === THREE.CullFaceBack ) {\r\n\t\r\n\t\t\t\t\t_gl.cullFace( _gl.BACK );\r\n\t\r\n\t\t\t\t} else if ( cullFace === THREE.CullFaceFront ) {\r\n\t\r\n\t\t\t\t\t_gl.cullFace( _gl.FRONT );\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t_gl.cullFace( _gl.FRONT_AND_BACK );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tstate.enable( _gl.CULL_FACE );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t};\r\n\t\r\n\t\t// Textures\r\n\t\r\n\t\tfunction setTextureParameters ( textureType, texture, isImagePowerOfTwo ) {\r\n\t\r\n\t\t\tvar extension;\r\n\t\r\n\t\t\tif ( isImagePowerOfTwo ) {\r\n\t\r\n\t\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_WRAP_S, paramThreeToGL( texture.wrapS ) );\r\n\t\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_WRAP_T, paramThreeToGL( texture.wrapT ) );\r\n\t\r\n\t\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_MAG_FILTER, paramThreeToGL( texture.magFilter ) );\r\n\t\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_MIN_FILTER, paramThreeToGL( texture.minFilter ) );\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_WRAP_S, _gl.CLAMP_TO_EDGE );\r\n\t\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_WRAP_T, _gl.CLAMP_TO_EDGE );\r\n\t\r\n\t\t\t\tif ( texture.wrapS !== THREE.ClampToEdgeWrapping || texture.wrapT !== THREE.ClampToEdgeWrapping ) {\r\n\t\r\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.', texture );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_MAG_FILTER, filterFallback( texture.magFilter ) );\r\n\t\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_MIN_FILTER, filterFallback( texture.minFilter ) );\r\n\t\r\n\t\t\t\tif ( texture.minFilter !== THREE.NearestFilter && texture.minFilter !== THREE.LinearFilter ) {\r\n\t\r\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.', texture );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\textension = extensions.get( 'EXT_texture_filter_anisotropic' );\r\n\t\r\n\t\t\tif ( extension ) {\r\n\t\r\n\t\t\t\tif ( texture.type === THREE.FloatType && extensions.get( 'OES_texture_float_linear' ) === null ) return;\r\n\t\t\t\tif ( texture.type === THREE.HalfFloatType && extensions.get( 'OES_texture_half_float_linear' ) === null ) return;\r\n\t\r\n\t\t\t\tif ( texture.anisotropy > 1 || properties.get( texture ).__currentAnisotropy ) {\r\n\t\r\n\t\t\t\t\t_gl.texParameterf( textureType, extension.TEXTURE_MAX_ANISOTROPY_EXT, Math.min( texture.anisotropy, _this.getMaxAnisotropy() ) );\r\n\t\t\t\t\tproperties.get( texture ).__currentAnisotropy = texture.anisotropy;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction uploadTexture( textureProperties, texture, slot ) {\r\n\t\r\n\t\t\tif ( textureProperties.__webglInit === undefined ) {\r\n\t\r\n\t\t\t\ttextureProperties.__webglInit = true;\r\n\t\r\n\t\t\t\ttexture.addEventListener( 'dispose', onTextureDispose );\r\n\t\r\n\t\t\t\ttextureProperties.__webglTexture = _gl.createTexture();\r\n\t\r\n\t\t\t\t_infoMemory.textures ++;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tstate.activeTexture( _gl.TEXTURE0 + slot );\r\n\t\t\tstate.bindTexture( _gl.TEXTURE_2D, textureProperties.__webglTexture );\r\n\t\r\n\t\t\t_gl.pixelStorei( _gl.UNPACK_FLIP_Y_WEBGL, texture.flipY );\r\n\t\t\t_gl.pixelStorei( _gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, texture.premultiplyAlpha );\r\n\t\t\t_gl.pixelStorei( _gl.UNPACK_ALIGNMENT, texture.unpackAlignment );\r\n\t\r\n\t\t\ttexture.image = clampToMaxSize( texture.image, capabilities.maxTextureSize );\r\n\t\r\n\t\t\tif ( textureNeedsPowerOfTwo( texture ) && isPowerOfTwo( texture.image ) === false ) {\r\n\t\r\n\t\t\t\ttexture.image = makePowerOfTwo( texture.image );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar image = texture.image,\r\n\t\t\tisImagePowerOfTwo = isPowerOfTwo( image ),\r\n\t\t\tglFormat = paramThreeToGL( texture.format ),\r\n\t\t\tglType = paramThreeToGL( texture.type );\r\n\t\r\n\t\t\tsetTextureParameters( _gl.TEXTURE_2D, texture, isImagePowerOfTwo );\r\n\t\r\n\t\t\tvar mipmap, mipmaps = texture.mipmaps;\r\n\t\r\n\t\t\tif ( texture instanceof THREE.DataTexture ) {\r\n\t\r\n\t\t\t\t// use manually created mipmaps if available\r\n\t\t\t\t// if there are no manual mipmaps\r\n\t\t\t\t// set 0 level mipmap and then use GL to generate other mipmap levels\r\n\t\r\n\t\t\t\tif ( mipmaps.length > 0 && isImagePowerOfTwo ) {\r\n\t\r\n\t\t\t\t\tfor ( var i = 0, il = mipmaps.length; i < il; i ++ ) {\r\n\t\r\n\t\t\t\t\t\tmipmap = mipmaps[ i ];\r\n\t\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, i, glFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\ttexture.generateMipmaps = false;\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, 0, glFormat, image.width, image.height, 0, glFormat, glType, image.data );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t} else if ( texture instanceof THREE.CompressedTexture ) {\r\n\t\r\n\t\t\t\tfor ( var i = 0, il = mipmaps.length; i < il; i ++ ) {\r\n\t\r\n\t\t\t\t\tmipmap = mipmaps[ i ];\r\n\t\r\n\t\t\t\t\tif ( texture.format !== THREE.RGBAFormat && texture.format !== THREE.RGBFormat ) {\r\n\t\r\n\t\t\t\t\t\tif ( state.getCompressedTextureFormats().indexOf( glFormat ) > - 1 ) {\r\n\t\r\n\t\t\t\t\t\t\tstate.compressedTexImage2D( _gl.TEXTURE_2D, i, glFormat, mipmap.width, mipmap.height, 0, mipmap.data );\r\n\t\r\n\t\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\t\tconsole.warn( \"THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()\" );\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, i, glFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\t// regular Texture (image, video, canvas)\r\n\t\r\n\t\t\t\t// use manually created mipmaps if available\r\n\t\t\t\t// if there are no manual mipmaps\r\n\t\t\t\t// set 0 level mipmap and then use GL to generate other mipmap levels\r\n\t\r\n\t\t\t\tif ( mipmaps.length > 0 && isImagePowerOfTwo ) {\r\n\t\r\n\t\t\t\t\tfor ( var i = 0, il = mipmaps.length; i < il; i ++ ) {\r\n\t\r\n\t\t\t\t\t\tmipmap = mipmaps[ i ];\r\n\t\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, i, glFormat, glFormat, glType, mipmap );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\ttexture.generateMipmaps = false;\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, 0, glFormat, glFormat, glType, texture.image );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( texture.generateMipmaps && isImagePowerOfTwo ) _gl.generateMipmap( _gl.TEXTURE_2D );\r\n\t\r\n\t\t\ttextureProperties.__version = texture.version;\r\n\t\r\n\t\t\tif ( texture.onUpdate ) texture.onUpdate( texture );\r\n\t\r\n\t\t}\r\n\t\r\n\t\tthis.setTexture = function ( texture, slot ) {\r\n\t\r\n\t\t\tvar textureProperties = properties.get( texture );\r\n\t\r\n\t\t\tif ( texture.version > 0 && textureProperties.__version !== texture.version ) {\r\n\t\r\n\t\t\t\tvar image = texture.image;\r\n\t\r\n\t\t\t\tif ( image === undefined ) {\r\n\t\r\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture marked for update but image is undefined', texture );\r\n\t\t\t\t\treturn;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( image.complete === false ) {\r\n\t\r\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture marked for update but image is incomplete', texture );\r\n\t\t\t\t\treturn;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tuploadTexture( textureProperties, texture, slot );\r\n\t\r\n\t\t\t\treturn;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tstate.activeTexture( _gl.TEXTURE0 + slot );\r\n\t\t\tstate.bindTexture( _gl.TEXTURE_2D, textureProperties.__webglTexture );\r\n\t\r\n\t\t};\r\n\t\r\n\t\tfunction clampToMaxSize ( image, maxSize ) {\r\n\t\r\n\t\t\tif ( image.width > maxSize || image.height > maxSize ) {\r\n\t\r\n\t\t\t\t// Warning: Scaling through the canvas will only work with images that use\r\n\t\t\t\t// premultiplied alpha.\r\n\t\r\n\t\t\t\tvar scale = maxSize / Math.max( image.width, image.height );\r\n\t\r\n\t\t\t\tvar canvas = document.createElement( 'canvas' );\r\n\t\t\t\tcanvas.width = Math.floor( image.width * scale );\r\n\t\t\t\tcanvas.height = Math.floor( image.height * scale );\r\n\t\r\n\t\t\t\tvar context = canvas.getContext( '2d' );\r\n\t\t\t\tcontext.drawImage( image, 0, 0, image.width, image.height, 0, 0, canvas.width, canvas.height );\r\n\t\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: image is too big (' + image.width + 'x' + image.height + '). Resized to ' + canvas.width + 'x' + canvas.height, image );\r\n\t\r\n\t\t\t\treturn canvas;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn image;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction isPowerOfTwo( image ) {\r\n\t\r\n\t\t\treturn THREE.Math.isPowerOfTwo( image.width ) && THREE.Math.isPowerOfTwo( image.height );\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction textureNeedsPowerOfTwo( texture ) {\r\n\t\r\n\t\t\tif ( texture.wrapS !== THREE.ClampToEdgeWrapping || texture.wrapT !== THREE.ClampToEdgeWrapping ) return true;\r\n\t\t\tif ( texture.minFilter !== THREE.NearestFilter && texture.minFilter !== THREE.LinearFilter ) return true;\r\n\t\r\n\t\t\treturn false;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction makePowerOfTwo( image ) {\r\n\t\r\n\t\t\tif ( image instanceof HTMLImageElement || image instanceof HTMLCanvasElement ) {\r\n\t\r\n\t\t\t\tvar canvas = document.createElement( 'canvas' );\r\n\t\t\t\tcanvas.width = THREE.Math.nearestPowerOfTwo( image.width );\r\n\t\t\t\tcanvas.height = THREE.Math.nearestPowerOfTwo( image.height );\r\n\t\r\n\t\t\t\tvar context = canvas.getContext( '2d' );\r\n\t\t\t\tcontext.drawImage( image, 0, 0, canvas.width, canvas.height );\r\n\t\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: image is not power of two (' + image.width + 'x' + image.height + '). Resized to ' + canvas.width + 'x' + canvas.height, image );\r\n\t\r\n\t\t\t\treturn canvas;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn image;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction setCubeTexture ( texture, slot ) {\r\n\t\r\n\t\t\tvar textureProperties = properties.get( texture );\r\n\t\r\n\t\t\tif ( texture.image.length === 6 ) {\r\n\t\r\n\t\t\t\tif ( texture.version > 0 && textureProperties.__version !== texture.version ) {\r\n\t\r\n\t\t\t\t\tif ( ! textureProperties.__image__webglTextureCube ) {\r\n\t\r\n\t\t\t\t\t\ttexture.addEventListener( 'dispose', onTextureDispose );\r\n\t\r\n\t\t\t\t\t\ttextureProperties.__image__webglTextureCube = _gl.createTexture();\r\n\t\r\n\t\t\t\t\t\t_infoMemory.textures ++;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tstate.activeTexture( _gl.TEXTURE0 + slot );\r\n\t\t\t\t\tstate.bindTexture( _gl.TEXTURE_CUBE_MAP, textureProperties.__image__webglTextureCube );\r\n\t\r\n\t\t\t\t\t_gl.pixelStorei( _gl.UNPACK_FLIP_Y_WEBGL, texture.flipY );\r\n\t\r\n\t\t\t\t\tvar isCompressed = texture instanceof THREE.CompressedTexture;\r\n\t\t\t\t\tvar isDataTexture = texture.image[ 0 ] instanceof THREE.DataTexture;\r\n\t\r\n\t\t\t\t\tvar cubeImage = [];\r\n\t\r\n\t\t\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\t\r\n\t\t\t\t\t\tif ( _this.autoScaleCubemaps && ! isCompressed && ! isDataTexture ) {\r\n\t\r\n\t\t\t\t\t\t\tcubeImage[ i ] = clampToMaxSize( texture.image[ i ], capabilities.maxCubemapSize );\r\n\t\r\n\t\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\t\tcubeImage[ i ] = isDataTexture ? texture.image[ i ].image : texture.image[ i ];\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tvar image = cubeImage[ 0 ],\r\n\t\t\t\t\tisImagePowerOfTwo = isPowerOfTwo( image ),\r\n\t\t\t\t\tglFormat = paramThreeToGL( texture.format ),\r\n\t\t\t\t\tglType = paramThreeToGL( texture.type );\r\n\t\r\n\t\t\t\t\tsetTextureParameters( _gl.TEXTURE_CUBE_MAP, texture, isImagePowerOfTwo );\r\n\t\r\n\t\t\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\t\r\n\t\t\t\t\t\tif ( ! isCompressed ) {\r\n\t\r\n\t\t\t\t\t\t\tif ( isDataTexture ) {\r\n\t\r\n\t\t\t\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, 0, glFormat, cubeImage[ i ].width, cubeImage[ i ].height, 0, glFormat, glType, cubeImage[ i ].data );\r\n\t\r\n\t\t\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, 0, glFormat, glFormat, glType, cubeImage[ i ] );\r\n\t\r\n\t\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\t\tvar mipmap, mipmaps = cubeImage[ i ].mipmaps;\r\n\t\r\n\t\t\t\t\t\t\tfor ( var j = 0, jl = mipmaps.length; j < jl; j ++ ) {\r\n\t\r\n\t\t\t\t\t\t\t\tmipmap = mipmaps[ j ];\r\n\t\r\n\t\t\t\t\t\t\t\tif ( texture.format !== THREE.RGBAFormat && texture.format !== THREE.RGBFormat ) {\r\n\t\r\n\t\t\t\t\t\t\t\t\tif ( state.getCompressedTextureFormats().indexOf( glFormat ) > - 1 ) {\r\n\t\r\n\t\t\t\t\t\t\t\t\t\tstate.compressedTexImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, j, glFormat, mipmap.width, mipmap.height, 0, mipmap.data );\r\n\t\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\t\t\t\t\tconsole.warn( \"THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setCubeTexture()\" );\r\n\t\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, j, glFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data );\r\n\t\r\n\t\t\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tif ( texture.generateMipmaps && isImagePowerOfTwo ) {\r\n\t\r\n\t\t\t\t\t\t_gl.generateMipmap( _gl.TEXTURE_CUBE_MAP );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\ttextureProperties.__version = texture.version;\r\n\t\r\n\t\t\t\t\tif ( texture.onUpdate ) texture.onUpdate( texture );\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tstate.activeTexture( _gl.TEXTURE0 + slot );\r\n\t\t\t\t\tstate.bindTexture( _gl.TEXTURE_CUBE_MAP, textureProperties.__image__webglTextureCube );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction setCubeTextureDynamic ( texture, slot ) {\r\n\t\r\n\t\t\tstate.activeTexture( _gl.TEXTURE0 + slot );\r\n\t\t\tstate.bindTexture( _gl.TEXTURE_CUBE_MAP, properties.get( texture ).__webglTexture );\r\n\t\r\n\t\t}\r\n\t\r\n\t\t// Render targets\r\n\t\r\n\t\tfunction setupFrameBuffer ( framebuffer, renderTarget, textureTarget ) {\r\n\t\r\n\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, framebuffer );\r\n\t\t\t_gl.framebufferTexture2D( _gl.FRAMEBUFFER, _gl.COLOR_ATTACHMENT0, textureTarget, properties.get( renderTarget.texture ).__webglTexture, 0 );\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction setupRenderBuffer ( renderbuffer, renderTarget ) {\r\n\t\r\n\t\t\t_gl.bindRenderbuffer( _gl.RENDERBUFFER, renderbuffer );\r\n\t\r\n\t\t\tif ( renderTarget.depthBuffer && ! renderTarget.stencilBuffer ) {\r\n\t\r\n\t\t\t\t_gl.renderbufferStorage( _gl.RENDERBUFFER, _gl.DEPTH_COMPONENT16, renderTarget.width, renderTarget.height );\r\n\t\t\t\t_gl.framebufferRenderbuffer( _gl.FRAMEBUFFER, _gl.DEPTH_ATTACHMENT, _gl.RENDERBUFFER, renderbuffer );\r\n\t\r\n\t\t\t/* For some reason this is not working. Defaulting to RGBA4.\r\n\t\t\t} else if ( ! renderTarget.depthBuffer && renderTarget.stencilBuffer ) {\r\n\t\r\n\t\t\t\t_gl.renderbufferStorage( _gl.RENDERBUFFER, _gl.STENCIL_INDEX8, renderTarget.width, renderTarget.height );\r\n\t\t\t\t_gl.framebufferRenderbuffer( _gl.FRAMEBUFFER, _gl.STENCIL_ATTACHMENT, _gl.RENDERBUFFER, renderbuffer );\r\n\t\t\t*/\r\n\t\r\n\t\t\t} else if ( renderTarget.depthBuffer && renderTarget.stencilBuffer ) {\r\n\t\r\n\t\t\t\t_gl.renderbufferStorage( _gl.RENDERBUFFER, _gl.DEPTH_STENCIL, renderTarget.width, renderTarget.height );\r\n\t\t\t\t_gl.framebufferRenderbuffer( _gl.FRAMEBUFFER, _gl.DEPTH_STENCIL_ATTACHMENT, _gl.RENDERBUFFER, renderbuffer );\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\t_gl.renderbufferStorage( _gl.RENDERBUFFER, _gl.RGBA4, renderTarget.width, renderTarget.height );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tthis.setRenderTarget = function ( renderTarget ) {\r\n\t\r\n\t\t\tvar isCube = ( renderTarget instanceof THREE.WebGLRenderTargetCube );\r\n\t\r\n\t\t\tif ( renderTarget && properties.get( renderTarget ).__webglFramebuffer === undefined ) {\r\n\t\r\n\t\t\t\tvar renderTargetProperties = properties.get( renderTarget );\r\n\t\t\t\tvar textureProperties = properties.get( renderTarget.texture );\r\n\t\r\n\t\t\t\tif ( renderTarget.depthBuffer === undefined ) renderTarget.depthBuffer = true;\r\n\t\t\t\tif ( renderTarget.stencilBuffer === undefined ) renderTarget.stencilBuffer = true;\r\n\t\r\n\t\t\t\trenderTarget.addEventListener( 'dispose', onRenderTargetDispose );\r\n\t\r\n\t\t\t\ttextureProperties.__webglTexture = _gl.createTexture();\r\n\t\r\n\t\t\t\t_infoMemory.textures ++;\r\n\t\r\n\t\t\t\t// Setup texture, create render and frame buffers\r\n\t\r\n\t\t\t\tvar isTargetPowerOfTwo = isPowerOfTwo( renderTarget ),\r\n\t\t\t\t\tglFormat = paramThreeToGL( renderTarget.texture.format ),\r\n\t\t\t\t\tglType = paramThreeToGL( renderTarget.texture.type );\r\n\t\r\n\t\t\t\tif ( isCube ) {\r\n\t\r\n\t\t\t\t\trenderTargetProperties.__webglFramebuffer = [];\r\n\t\t\t\t\trenderTargetProperties.__webglRenderbuffer = [];\r\n\t\r\n\t\t\t\t\tstate.bindTexture( _gl.TEXTURE_CUBE_MAP, textureProperties.__webglTexture );\r\n\t\r\n\t\t\t\t\tsetTextureParameters( _gl.TEXTURE_CUBE_MAP, renderTarget.texture, isTargetPowerOfTwo );\r\n\t\r\n\t\t\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\t\r\n\t\t\t\t\t\trenderTargetProperties.__webglFramebuffer[ i ] = _gl.createFramebuffer();\r\n\t\t\t\t\t\trenderTargetProperties.__webglRenderbuffer[ i ] = _gl.createRenderbuffer();\r\n\t\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, 0, glFormat, renderTarget.width, renderTarget.height, 0, glFormat, glType, null );\r\n\t\r\n\t\t\t\t\t\tsetupFrameBuffer( renderTargetProperties.__webglFramebuffer[ i ], renderTarget, _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i );\r\n\t\t\t\t\t\tsetupRenderBuffer( renderTargetProperties.__webglRenderbuffer[ i ], renderTarget );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tif ( renderTarget.texture.generateMipmaps && isTargetPowerOfTwo ) _gl.generateMipmap( _gl.TEXTURE_CUBE_MAP );\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\trenderTargetProperties.__webglFramebuffer = _gl.createFramebuffer();\r\n\t\r\n\t\t\t\t\tif ( renderTarget.shareDepthFrom ) {\r\n\t\r\n\t\t\t\t\t\trenderTargetProperties.__webglRenderbuffer = renderTarget.shareDepthFrom.__webglRenderbuffer;\r\n\t\r\n\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\trenderTargetProperties.__webglRenderbuffer = _gl.createRenderbuffer();\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tstate.bindTexture( _gl.TEXTURE_2D, textureProperties.__webglTexture );\r\n\t\t\t\t\tsetTextureParameters( _gl.TEXTURE_2D, renderTarget.texture, isTargetPowerOfTwo );\r\n\t\r\n\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, 0, glFormat, renderTarget.width, renderTarget.height, 0, glFormat, glType, null );\r\n\t\r\n\t\t\t\t\tsetupFrameBuffer( renderTargetProperties.__webglFramebuffer, renderTarget, _gl.TEXTURE_2D );\r\n\t\r\n\t\t\t\t\tif ( renderTarget.shareDepthFrom ) {\r\n\t\r\n\t\t\t\t\t\tif ( renderTarget.depthBuffer && ! renderTarget.stencilBuffer ) {\r\n\t\r\n\t\t\t\t\t\t\t_gl.framebufferRenderbuffer( _gl.FRAMEBUFFER, _gl.DEPTH_ATTACHMENT, _gl.RENDERBUFFER, renderTargetProperties.__webglRenderbuffer );\r\n\t\r\n\t\t\t\t\t\t} else if ( renderTarget.depthBuffer && renderTarget.stencilBuffer ) {\r\n\t\r\n\t\t\t\t\t\t\t_gl.framebufferRenderbuffer( _gl.FRAMEBUFFER, _gl.DEPTH_STENCIL_ATTACHMENT, _gl.RENDERBUFFER, renderTargetProperties.__webglRenderbuffer );\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\tsetupRenderBuffer( renderTargetProperties.__webglRenderbuffer, renderTarget );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tif ( renderTarget.texture.generateMipmaps && isTargetPowerOfTwo ) _gl.generateMipmap( _gl.TEXTURE_2D );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\t// Release everything\r\n\t\r\n\t\t\t\tif ( isCube ) {\r\n\t\r\n\t\t\t\t\tstate.bindTexture( _gl.TEXTURE_CUBE_MAP, null );\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tstate.bindTexture( _gl.TEXTURE_2D, null );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\t_gl.bindRenderbuffer( _gl.RENDERBUFFER, null );\r\n\t\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, null );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar framebuffer, width, height, vx, vy;\r\n\t\r\n\t\t\tif ( renderTarget ) {\r\n\t\r\n\t\t\t\tvar renderTargetProperties = properties.get( renderTarget );\r\n\t\r\n\t\t\t\tif ( isCube ) {\r\n\t\r\n\t\t\t\t\tframebuffer = renderTargetProperties.__webglFramebuffer[ renderTarget.activeCubeFace ];\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tframebuffer = renderTargetProperties.__webglFramebuffer;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\twidth = renderTarget.width;\r\n\t\t\t\theight = renderTarget.height;\r\n\t\r\n\t\t\t\tvx = 0;\r\n\t\t\t\tvy = 0;\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\tframebuffer = null;\r\n\t\r\n\t\t\t\twidth = _viewportWidth;\r\n\t\t\t\theight = _viewportHeight;\r\n\t\r\n\t\t\t\tvx = _viewportX;\r\n\t\t\t\tvy = _viewportY;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( framebuffer !== _currentFramebuffer ) {\r\n\t\r\n\t\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, framebuffer );\r\n\t\t\t\t_gl.viewport( vx, vy, width, height );\r\n\t\r\n\t\t\t\t_currentFramebuffer = framebuffer;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( isCube ) {\r\n\t\r\n\t\t\t\tvar textureProperties = properties.get( renderTarget.texture );\r\n\t\t\t\t_gl.framebufferTexture2D( _gl.FRAMEBUFFER, _gl.COLOR_ATTACHMENT0, _gl.TEXTURE_CUBE_MAP_POSITIVE_X + renderTarget.activeCubeFace, textureProperties.__webglTexture, 0 );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t_currentWidth = width;\r\n\t\t\t_currentHeight = height;\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.readRenderTargetPixels = function ( renderTarget, x, y, width, height, buffer ) {\r\n\t\r\n\t\t\tif ( renderTarget instanceof THREE.WebGLRenderTarget === false ) {\r\n\t\r\n\t\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.' );\r\n\t\t\t\treturn;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar framebuffer = properties.get( renderTarget ).__webglFramebuffer;\r\n\t\r\n\t\t\tif ( framebuffer ) {\r\n\t\r\n\t\t\t\tvar restore = false;\r\n\t\r\n\t\t\t\tif ( framebuffer !== _currentFramebuffer ) {\r\n\t\r\n\t\t\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, framebuffer );\r\n\t\r\n\t\t\t\t\trestore = true;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\ttry {\r\n\t\r\n\t\t\t\t\tvar texture = renderTarget.texture;\r\n\t\r\n\t\t\t\t\tif ( texture.format !== THREE.RGBAFormat\r\n\t\t\t\t\t\t&& paramThreeToGL( texture.format ) !== _gl.getParameter( _gl.IMPLEMENTATION_COLOR_READ_FORMAT ) ) {\r\n\t\r\n\t\t\t\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.' );\r\n\t\t\t\t\t\treturn;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tif ( texture.type !== THREE.UnsignedByteType\r\n\t\t\t\t\t\t&& paramThreeToGL( texture.type ) !== _gl.getParameter( _gl.IMPLEMENTATION_COLOR_READ_TYPE )\r\n\t\t\t\t\t\t&& ! ( texture.type === THREE.FloatType && extensions.get( 'WEBGL_color_buffer_float' ) )\r\n\t\t\t\t\t\t&& ! ( texture.type === THREE.HalfFloatType && extensions.get( 'EXT_color_buffer_half_float' ) ) ) {\r\n\t\r\n\t\t\t\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.' );\r\n\t\t\t\t\t\treturn;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tif ( _gl.checkFramebufferStatus( _gl.FRAMEBUFFER ) === _gl.FRAMEBUFFER_COMPLETE ) {\r\n\t\r\n\t\t\t\t\t\t_gl.readPixels( x, y, width, height, paramThreeToGL( texture.format ), paramThreeToGL( texture.type ), buffer );\r\n\t\r\n\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.' );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t} finally {\r\n\t\r\n\t\t\t\t\tif ( restore ) {\r\n\t\r\n\t\t\t\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, _currentFramebuffer );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t};\r\n\t\r\n\t\tfunction updateRenderTargetMipmap( renderTarget ) {\r\n\t\r\n\t\t\tvar target = renderTarget instanceof THREE.WebGLRenderTargetCube ? _gl.TEXTURE_CUBE_MAP : _gl.TEXTURE_2D;\r\n\t\t\tvar texture = properties.get( renderTarget.texture ).__webglTexture;\r\n\t\r\n\t\t\tstate.bindTexture( target, texture );\r\n\t\t\t_gl.generateMipmap( target );\r\n\t\t\tstate.bindTexture( target, null );\r\n\t\r\n\t\t}\r\n\t\r\n\t\t// Fallback filters for non-power-of-2 textures\r\n\t\r\n\t\tfunction filterFallback ( f ) {\r\n\t\r\n\t\t\tif ( f === THREE.NearestFilter || f === THREE.NearestMipMapNearestFilter || f === THREE.NearestMipMapLinearFilter ) {\r\n\t\r\n\t\t\t\treturn _gl.NEAREST;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn _gl.LINEAR;\r\n\t\r\n\t\t}\r\n\t\r\n\t\t// Map three.js constants to WebGL constants\r\n\t\r\n\t\tfunction paramThreeToGL ( p ) {\r\n\t\r\n\t\t\tvar extension;\r\n\t\r\n\t\t\tif ( p === THREE.RepeatWrapping ) return _gl.REPEAT;\r\n\t\t\tif ( p === THREE.ClampToEdgeWrapping ) return _gl.CLAMP_TO_EDGE;\r\n\t\t\tif ( p === THREE.MirroredRepeatWrapping ) return _gl.MIRRORED_REPEAT;\r\n\t\r\n\t\t\tif ( p === THREE.NearestFilter ) return _gl.NEAREST;\r\n\t\t\tif ( p === THREE.NearestMipMapNearestFilter ) return _gl.NEAREST_MIPMAP_NEAREST;\r\n\t\t\tif ( p === THREE.NearestMipMapLinearFilter ) return _gl.NEAREST_MIPMAP_LINEAR;\r\n\t\r\n\t\t\tif ( p === THREE.LinearFilter ) return _gl.LINEAR;\r\n\t\t\tif ( p === THREE.LinearMipMapNearestFilter ) return _gl.LINEAR_MIPMAP_NEAREST;\r\n\t\t\tif ( p === THREE.LinearMipMapLinearFilter ) return _gl.LINEAR_MIPMAP_LINEAR;\r\n\t\r\n\t\t\tif ( p === THREE.UnsignedByteType ) return _gl.UNSIGNED_BYTE;\r\n\t\t\tif ( p === THREE.UnsignedShort4444Type ) return _gl.UNSIGNED_SHORT_4_4_4_4;\r\n\t\t\tif ( p === THREE.UnsignedShort5551Type ) return _gl.UNSIGNED_SHORT_5_5_5_1;\r\n\t\t\tif ( p === THREE.UnsignedShort565Type ) return _gl.UNSIGNED_SHORT_5_6_5;\r\n\t\r\n\t\t\tif ( p === THREE.ByteType ) return _gl.BYTE;\r\n\t\t\tif ( p === THREE.ShortType ) return _gl.SHORT;\r\n\t\t\tif ( p === THREE.UnsignedShortType ) return _gl.UNSIGNED_SHORT;\r\n\t\t\tif ( p === THREE.IntType ) return _gl.INT;\r\n\t\t\tif ( p === THREE.UnsignedIntType ) return _gl.UNSIGNED_INT;\r\n\t\t\tif ( p === THREE.FloatType ) return _gl.FLOAT;\r\n\t\r\n\t\t\textension = extensions.get( 'OES_texture_half_float' );\r\n\t\r\n\t\t\tif ( extension !== null ) {\r\n\t\r\n\t\t\t\tif ( p === THREE.HalfFloatType ) return extension.HALF_FLOAT_OES;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( p === THREE.AlphaFormat ) return _gl.ALPHA;\r\n\t\t\tif ( p === THREE.RGBFormat ) return _gl.RGB;\r\n\t\t\tif ( p === THREE.RGBAFormat ) return _gl.RGBA;\r\n\t\t\tif ( p === THREE.LuminanceFormat ) return _gl.LUMINANCE;\r\n\t\t\tif ( p === THREE.LuminanceAlphaFormat ) return _gl.LUMINANCE_ALPHA;\r\n\t\r\n\t\t\tif ( p === THREE.AddEquation ) return _gl.FUNC_ADD;\r\n\t\t\tif ( p === THREE.SubtractEquation ) return _gl.FUNC_SUBTRACT;\r\n\t\t\tif ( p === THREE.ReverseSubtractEquation ) return _gl.FUNC_REVERSE_SUBTRACT;\r\n\t\r\n\t\t\tif ( p === THREE.ZeroFactor ) return _gl.ZERO;\r\n\t\t\tif ( p === THREE.OneFactor ) return _gl.ONE;\r\n\t\t\tif ( p === THREE.SrcColorFactor ) return _gl.SRC_COLOR;\r\n\t\t\tif ( p === THREE.OneMinusSrcColorFactor ) return _gl.ONE_MINUS_SRC_COLOR;\r\n\t\t\tif ( p === THREE.SrcAlphaFactor ) return _gl.SRC_ALPHA;\r\n\t\t\tif ( p === THREE.OneMinusSrcAlphaFactor ) return _gl.ONE_MINUS_SRC_ALPHA;\r\n\t\t\tif ( p === THREE.DstAlphaFactor ) return _gl.DST_ALPHA;\r\n\t\t\tif ( p === THREE.OneMinusDstAlphaFactor ) return _gl.ONE_MINUS_DST_ALPHA;\r\n\t\r\n\t\t\tif ( p === THREE.DstColorFactor ) return _gl.DST_COLOR;\r\n\t\t\tif ( p === THREE.OneMinusDstColorFactor ) return _gl.ONE_MINUS_DST_COLOR;\r\n\t\t\tif ( p === THREE.SrcAlphaSaturateFactor ) return _gl.SRC_ALPHA_SATURATE;\r\n\t\r\n\t\t\textension = extensions.get( 'WEBGL_compressed_texture_s3tc' );\r\n\t\r\n\t\t\tif ( extension !== null ) {\r\n\t\r\n\t\t\t\tif ( p === THREE.RGB_S3TC_DXT1_Format ) return extension.COMPRESSED_RGB_S3TC_DXT1_EXT;\r\n\t\t\t\tif ( p === THREE.RGBA_S3TC_DXT1_Format ) return extension.COMPRESSED_RGBA_S3TC_DXT1_EXT;\r\n\t\t\t\tif ( p === THREE.RGBA_S3TC_DXT3_Format ) return extension.COMPRESSED_RGBA_S3TC_DXT3_EXT;\r\n\t\t\t\tif ( p === THREE.RGBA_S3TC_DXT5_Format ) return extension.COMPRESSED_RGBA_S3TC_DXT5_EXT;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\textension = extensions.get( 'WEBGL_compressed_texture_pvrtc' );\r\n\t\r\n\t\t\tif ( extension !== null ) {\r\n\t\r\n\t\t\t\tif ( p === THREE.RGB_PVRTC_4BPPV1_Format ) return extension.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;\r\n\t\t\t\tif ( p === THREE.RGB_PVRTC_2BPPV1_Format ) return extension.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;\r\n\t\t\t\tif ( p === THREE.RGBA_PVRTC_4BPPV1_Format ) return extension.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;\r\n\t\t\t\tif ( p === THREE.RGBA_PVRTC_2BPPV1_Format ) return extension.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\textension = extensions.get( 'EXT_blend_minmax' );\r\n\t\r\n\t\t\tif ( extension !== null ) {\r\n\t\r\n\t\t\t\tif ( p === THREE.MinEquation ) return extension.MIN_EXT;\r\n\t\t\t\tif ( p === THREE.MaxEquation ) return extension.MAX_EXT;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn 0;\r\n\t\r\n\t\t}\r\n\t\r\n\t\t// DEPRECATED\r\n\t\r\n\t\tthis.supportsFloatTextures = function () {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( \\'OES_texture_float\\' ).' );\r\n\t\t\treturn extensions.get( 'OES_texture_float' );\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.supportsHalfFloatTextures = function () {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( \\'OES_texture_half_float\\' ).' );\r\n\t\t\treturn extensions.get( 'OES_texture_half_float' );\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.supportsStandardDerivatives = function () {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( \\'OES_standard_derivatives\\' ).' );\r\n\t\t\treturn extensions.get( 'OES_standard_derivatives' );\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.supportsCompressedTextureS3TC = function () {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( \\'WEBGL_compressed_texture_s3tc\\' ).' );\r\n\t\t\treturn extensions.get( 'WEBGL_compressed_texture_s3tc' );\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.supportsCompressedTexturePVRTC = function () {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( \\'WEBGL_compressed_texture_pvrtc\\' ).' );\r\n\t\t\treturn extensions.get( 'WEBGL_compressed_texture_pvrtc' );\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.supportsBlendMinMax = function () {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( \\'EXT_blend_minmax\\' ).' );\r\n\t\t\treturn extensions.get( 'EXT_blend_minmax' );\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.supportsVertexTextures = function () {\r\n\t\r\n\t\t\treturn capabilities.vertexTextures;\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.supportsInstancedArrays = function () {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( \\'ANGLE_instanced_arrays\\' ).' );\r\n\t\t\treturn extensions.get( 'ANGLE_instanced_arrays' );\r\n\t\r\n\t\t};\r\n\t\r\n\t\t//\r\n\t\r\n\t\tthis.initMaterial = function () {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .initMaterial() has been removed.' );\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.addPrePlugin = function () {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .addPrePlugin() has been removed.' );\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.addPostPlugin = function () {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .addPostPlugin() has been removed.' );\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.updateShadowMap = function () {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .updateShadowMap() has been removed.' );\r\n\t\r\n\t\t};\r\n\t\r\n\t\tObject.defineProperties( this, {\r\n\t\t\tshadowMapEnabled: {\r\n\t\t\t\tget: function () {\r\n\t\r\n\t\t\t\t\treturn shadowMap.enabled;\r\n\t\r\n\t\t\t\t},\r\n\t\t\t\tset: function ( value ) {\r\n\t\r\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled.' );\r\n\t\t\t\t\tshadowMap.enabled = value;\r\n\t\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tshadowMapType: {\r\n\t\t\t\tget: function () {\r\n\t\r\n\t\t\t\t\treturn shadowMap.type;\r\n\t\r\n\t\t\t\t},\r\n\t\t\t\tset: function ( value ) {\r\n\t\r\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type.' );\r\n\t\t\t\t\tshadowMap.type = value;\r\n\t\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tshadowMapCullFace: {\r\n\t\t\t\tget: function () {\r\n\t\r\n\t\t\t\t\treturn shadowMap.cullFace;\r\n\t\r\n\t\t\t\t},\r\n\t\t\t\tset: function ( value ) {\r\n\t\r\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace.' );\r\n\t\t\t\t\tshadowMap.cullFace = value;\r\n\t\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tshadowMapDebug: {\r\n\t\t\t\tget: function () {\r\n\t\r\n\t\t\t\t\treturn shadowMap.debug;\r\n\t\r\n\t\t\t\t},\r\n\t\t\t\tset: function ( value ) {\r\n\t\r\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMapDebug is now .shadowMap.debug.' );\r\n\t\t\t\t\tshadowMap.debug = value;\r\n\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} );\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/renderers/WebGLRenderTarget.js\r\n\t\r\n\t/**\r\n\t * @author szimek / https://github.com/szimek/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\t\r\n\tTHREE.WebGLRenderTarget = function ( width, height, options ) {\r\n\t\r\n\t\tthis.uuid = THREE.Math.generateUUID();\r\n\t\r\n\t\tthis.width = width;\r\n\t\tthis.height = height;\r\n\t\r\n\t\toptions = options || {};\r\n\t\r\n\t\tif ( options.minFilter === undefined ) options.minFilter = THREE.LinearFilter;\r\n\t\r\n\t\tthis.texture = new THREE.Texture( undefined, undefined, options.wrapS, options.wrapT, options.magFilter, options.minFilter, options.format, options.type, options.anisotropy );\r\n\t\r\n\t\tthis.depthBuffer = options.depthBuffer !== undefined ? options.depthBuffer : true;\r\n\t\tthis.stencilBuffer = options.stencilBuffer !== undefined ? options.stencilBuffer : true;\r\n\t\r\n\t\tthis.shareDepthFrom = options.shareDepthFrom !== undefined ? options.shareDepthFrom : null;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.WebGLRenderTarget.prototype = {\r\n\t\r\n\t\tconstructor: THREE.WebGLRenderTarget,\r\n\t\r\n\t\tget wrapS() {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.' );\r\n\t\r\n\t\t\treturn this.texture.wrapS;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tset wrapS( value ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.' );\r\n\t\r\n\t\t\tthis.texture.wrapS = value;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tget wrapT() {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.' );\r\n\t\r\n\t\t\treturn this.texture.wrapT;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tset wrapT( value ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.' );\r\n\t\r\n\t\t\tthis.texture.wrapT = value;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tget magFilter() {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.' );\r\n\t\r\n\t\t\treturn this.texture.magFilter;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tset magFilter( value ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.' );\r\n\t\r\n\t\t\tthis.texture.magFilter = value;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tget minFilter() {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.' );\r\n\t\r\n\t\t\treturn this.texture.minFilter;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tset minFilter( value ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.' );\r\n\t\r\n\t\t\tthis.texture.minFilter = value;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tget anisotropy() {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.' );\r\n\t\r\n\t\t\treturn this.texture.anisotropy;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tset anisotropy( value ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.' );\r\n\t\r\n\t\t\tthis.texture.anisotropy = value;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tget offset() {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .offset is now .texture.offset.' );\r\n\t\r\n\t\t\treturn this.texture.offset;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tset offset( value ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .offset is now .texture.offset.' );\r\n\t\r\n\t\t\tthis.texture.offset = value;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tget repeat() {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .repeat is now .texture.repeat.' );\r\n\t\r\n\t\t\treturn this.texture.repeat;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tset repeat( value ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .repeat is now .texture.repeat.' );\r\n\t\r\n\t\t\tthis.texture.repeat = value;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tget format() {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .format is now .texture.format.' );\r\n\t\r\n\t\t\treturn this.texture.format;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tset format( value ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .format is now .texture.format.' );\r\n\t\r\n\t\t\tthis.texture.format = value;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tget type() {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .type is now .texture.type.' );\r\n\t\r\n\t\t\treturn this.texture.type;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tset type( value ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .type is now .texture.type.' );\r\n\t\r\n\t\t\tthis.texture.type = value;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tget generateMipmaps() {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.' );\r\n\t\r\n\t\t\treturn this.texture.generateMipmaps;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tset generateMipmaps( value ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.' );\r\n\t\r\n\t\t\tthis.texture.generateMipmaps = value;\r\n\t\r\n\t\t},\r\n\t\r\n\t\t//\r\n\t\r\n\t\tsetSize: function ( width, height ) {\r\n\t\r\n\t\t\tif ( this.width !== width || this.height !== height ) {\r\n\t\r\n\t\t\t\tthis.width = width;\r\n\t\t\t\tthis.height = height;\r\n\t\r\n\t\t\t\tthis.dispose();\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t},\r\n\t\r\n\t\tclone: function () {\r\n\t\r\n\t\t\treturn new this.constructor().copy( this );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcopy: function ( source ) {\r\n\t\r\n\t\t\tthis.width = source.width;\r\n\t\t\tthis.height = source.height;\r\n\t\r\n\t\t\tthis.texture = source.texture.clone();\r\n\t\r\n\t\t\tthis.depthBuffer = source.depthBuffer;\r\n\t\t\tthis.stencilBuffer = source.stencilBuffer;\r\n\t\r\n\t\t\tthis.shareDepthFrom = source.shareDepthFrom;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tdispose: function () {\r\n\t\r\n\t\t\tthis.dispatchEvent( { type: 'dispose' } );\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.EventDispatcher.prototype.apply( THREE.WebGLRenderTarget.prototype );\r\n\t\r\n\t// File:src/renderers/WebGLRenderTargetCube.js\r\n\t\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com\r\n\t */\r\n\t\r\n\tTHREE.WebGLRenderTargetCube = function ( width, height, options ) {\r\n\t\r\n\t\tTHREE.WebGLRenderTarget.call( this, width, height, options );\r\n\t\r\n\t\tthis.activeCubeFace = 0; // PX 0, NX 1, PY 2, NY 3, PZ 4, NZ 5\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.WebGLRenderTargetCube.prototype = Object.create( THREE.WebGLRenderTarget.prototype );\r\n\tTHREE.WebGLRenderTargetCube.prototype.constructor = THREE.WebGLRenderTargetCube;\r\n\t\r\n\t// File:src/renderers/webgl/WebGLBufferRenderer.js\r\n\t\r\n\t/**\r\n\t* @author mrdoob / http://mrdoob.com/\r\n\t*/\r\n\t\r\n\tTHREE.WebGLBufferRenderer = function ( _gl, extensions, _infoRender ) {\r\n\t\r\n\t\tvar mode;\r\n\t\r\n\t\tfunction setMode( value ) {\r\n\t\r\n\t\t\tmode = value;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction render( start, count ) {\r\n\t\r\n\t\t\t_gl.drawArrays( mode, start, count );\r\n\t\r\n\t\t\t_infoRender.calls ++;\r\n\t\t\t_infoRender.vertices += count;\r\n\t\t\tif ( mode === _gl.TRIANGLES ) _infoRender.faces += count / 3;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction renderInstances( geometry ) {\r\n\t\r\n\t\t\tvar extension = extensions.get( 'ANGLE_instanced_arrays' );\r\n\t\r\n\t\t\tif ( extension === null ) {\r\n\t\r\n\t\t\t\tconsole.error( 'THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.' );\r\n\t\t\t\treturn;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar position = geometry.attributes.position;\r\n\t\r\n\t\t\tif ( position instanceof THREE.InterleavedBufferAttribute ) {\r\n\t\r\n\t\t\t\textension.drawArraysInstancedANGLE( mode, 0, position.data.count, geometry.maxInstancedCount );\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\textension.drawArraysInstancedANGLE( mode, 0, position.count, geometry.maxInstancedCount );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tthis.setMode = setMode;\r\n\t\tthis.render = render;\r\n\t\tthis.renderInstances = renderInstances;\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/renderers/webgl/WebGLIndexedBufferRenderer.js\r\n\t\r\n\t/**\r\n\t* @author mrdoob / http://mrdoob.com/\r\n\t*/\r\n\t\r\n\tTHREE.WebGLIndexedBufferRenderer = function ( _gl, extensions, _infoRender ) {\r\n\t\r\n\t\tvar mode;\r\n\t\r\n\t\tfunction setMode( value ) {\r\n\t\r\n\t\t\tmode = value;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tvar type, size;\r\n\t\r\n\t\tfunction setIndex( index ) {\r\n\t\r\n\t\t\tif ( index.array instanceof Uint32Array && extensions.get( 'OES_element_index_uint' ) ) {\r\n\t\r\n\t\t\t\ttype = _gl.UNSIGNED_INT;\r\n\t\t\t\tsize = 4;\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\ttype = _gl.UNSIGNED_SHORT;\r\n\t\t\t\tsize = 2;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction render( start, count ) {\r\n\t\r\n\t\t\t_gl.drawElements( mode, count, type, start * size );\r\n\t\r\n\t\t\t_infoRender.calls ++;\r\n\t\t\t_infoRender.vertices += count;\r\n\t\t\tif ( mode === _gl.TRIANGLES ) _infoRender.faces += count / 3;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction renderInstances( geometry ) {\r\n\t\r\n\t\t\tvar extension = extensions.get( 'ANGLE_instanced_arrays' );\r\n\t\r\n\t\t\tif ( extension === null ) {\r\n\t\r\n\t\t\t\tconsole.error( 'THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.' );\r\n\t\t\t\treturn;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar index = geometry.index;\r\n\t\r\n\t\t\textension.drawElementsInstancedANGLE( mode, index.array.length, type, 0, geometry.maxInstancedCount );\r\n\t\r\n\t\t}\r\n\t\r\n\t\tthis.setMode = setMode;\r\n\t\tthis.setIndex = setIndex;\r\n\t\tthis.render = render;\r\n\t\tthis.renderInstances = renderInstances;\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/renderers/webgl/WebGLExtensions.js\r\n\t\r\n\t/**\r\n\t* @author mrdoob / http://mrdoob.com/\r\n\t*/\r\n\t\r\n\tTHREE.WebGLExtensions = function ( gl ) {\r\n\t\r\n\t\tvar extensions = {};\r\n\t\r\n\t\tthis.get = function ( name ) {\r\n\t\r\n\t\t\tif ( extensions[ name ] !== undefined ) {\r\n\t\r\n\t\t\t\treturn extensions[ name ];\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar extension;\r\n\t\r\n\t\t\tswitch ( name ) {\r\n\t\r\n\t\t\t\tcase 'EXT_texture_filter_anisotropic':\r\n\t\t\t\t\textension = gl.getExtension( 'EXT_texture_filter_anisotropic' ) || gl.getExtension( 'MOZ_EXT_texture_filter_anisotropic' ) || gl.getExtension( 'WEBKIT_EXT_texture_filter_anisotropic' );\r\n\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\tcase 'WEBGL_compressed_texture_s3tc':\r\n\t\t\t\t\textension = gl.getExtension( 'WEBGL_compressed_texture_s3tc' ) || gl.getExtension( 'MOZ_WEBGL_compressed_texture_s3tc' ) || gl.getExtension( 'WEBKIT_WEBGL_compressed_texture_s3tc' );\r\n\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\tcase 'WEBGL_compressed_texture_pvrtc':\r\n\t\t\t\t\textension = gl.getExtension( 'WEBGL_compressed_texture_pvrtc' ) || gl.getExtension( 'WEBKIT_WEBGL_compressed_texture_pvrtc' );\r\n\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\tdefault:\r\n\t\t\t\t\textension = gl.getExtension( name );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( extension === null ) {\r\n\t\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: ' + name + ' extension not supported.' );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\textensions[ name ] = extension;\r\n\t\r\n\t\t\treturn extension;\r\n\t\r\n\t\t};\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/renderers/webgl/WebGLCapabilities.js\r\n\t\r\n\tTHREE.WebGLCapabilities = function ( gl, extensions, parameters ) {\r\n\t\r\n\t\tfunction getMaxPrecision( precision ) {\r\n\t\r\n\t\t\tif ( precision === 'highp' ) {\r\n\t\r\n\t\t\t\tif ( gl.getShaderPrecisionFormat( gl.VERTEX_SHADER, gl.HIGH_FLOAT ).precision > 0 &&\r\n\t\t\t\t     gl.getShaderPrecisionFormat( gl.FRAGMENT_SHADER, gl.HIGH_FLOAT ).precision > 0 ) {\r\n\t\r\n\t\t\t\t\treturn 'highp';\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tprecision = 'mediump';\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( precision === 'mediump' ) {\r\n\t\r\n\t\t\t\tif ( gl.getShaderPrecisionFormat( gl.VERTEX_SHADER, gl.MEDIUM_FLOAT ).precision > 0 &&\r\n\t\t\t\t     gl.getShaderPrecisionFormat( gl.FRAGMENT_SHADER, gl.MEDIUM_FLOAT ).precision > 0 ) {\r\n\t\r\n\t\t\t\t\treturn 'mediump';\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn 'lowp';\r\n\t\r\n\t\t}\r\n\t\r\n\t\tthis.getMaxPrecision = getMaxPrecision;\r\n\t\r\n\t\tthis.precision = parameters.precision !== undefined ? parameters.precision : 'highp',\r\n\t\tthis.logarithmicDepthBuffer = parameters.logarithmicDepthBuffer !== undefined ? parameters.logarithmicDepthBuffer : false;\r\n\t\r\n\t\tthis.maxTextures = gl.getParameter( gl.MAX_TEXTURE_IMAGE_UNITS );\r\n\t\tthis.maxVertexTextures = gl.getParameter( gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS );\r\n\t\tthis.maxTextureSize = gl.getParameter( gl.MAX_TEXTURE_SIZE );\r\n\t\tthis.maxCubemapSize = gl.getParameter( gl.MAX_CUBE_MAP_TEXTURE_SIZE );\r\n\t\r\n\t\tthis.maxAttributes = gl.getParameter( gl.MAX_VERTEX_ATTRIBS );\r\n\t\tthis.maxVertexUniforms = gl.getParameter( gl.MAX_VERTEX_UNIFORM_VECTORS );\r\n\t\tthis.maxVaryings = gl.getParameter( gl.MAX_VARYING_VECTORS );\r\n\t\tthis.maxFragmentUniforms = gl.getParameter( gl.MAX_FRAGMENT_UNIFORM_VECTORS );\r\n\t\r\n\t\tthis.vertexTextures = this.maxVertexTextures > 0;\r\n\t\tthis.floatFragmentTextures = !! extensions.get( 'OES_texture_float' );\r\n\t\tthis.floatVertexTextures = this.vertexTextures && this.floatFragmentTextures;\r\n\t\r\n\t\tvar _maxPrecision = getMaxPrecision( this.precision );\r\n\t\r\n\t\tif ( _maxPrecision !== this.precision ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer:', this.precision, 'not supported, using', _maxPrecision, 'instead.' );\r\n\t\t\tthis.precision = _maxPrecision;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tif ( this.logarithmicDepthBuffer ) {\r\n\t\r\n\t\t\tthis.logarithmicDepthBuffer = !! extensions.get( 'EXT_frag_depth' );\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/renderers/webgl/WebGLGeometries.js\r\n\t\r\n\t/**\r\n\t* @author mrdoob / http://mrdoob.com/\r\n\t*/\r\n\t\r\n\tTHREE.WebGLGeometries = function ( gl, properties, info ) {\r\n\t\r\n\t\tvar geometries = {};\r\n\t\r\n\t\tfunction get( object ) {\r\n\t\r\n\t\t\tvar geometry = object.geometry;\r\n\t\r\n\t\t\tif ( geometries[ geometry.id ] !== undefined ) {\r\n\t\r\n\t\t\t\treturn geometries[ geometry.id ];\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tgeometry.addEventListener( 'dispose', onGeometryDispose );\r\n\t\r\n\t\t\tvar buffergeometry;\r\n\t\r\n\t\t\tif ( geometry instanceof THREE.BufferGeometry ) {\r\n\t\r\n\t\t\t\tbuffergeometry = geometry;\r\n\t\r\n\t\t\t} else if ( geometry instanceof THREE.Geometry ) {\r\n\t\r\n\t\t\t\tif ( geometry._bufferGeometry === undefined ) {\r\n\t\r\n\t\t\t\t\tgeometry._bufferGeometry = new THREE.BufferGeometry().setFromObject( object );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tbuffergeometry = geometry._bufferGeometry;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tgeometries[ geometry.id ] = buffergeometry;\r\n\t\r\n\t\t\tinfo.memory.geometries ++;\r\n\t\r\n\t\t\treturn buffergeometry;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction onGeometryDispose( event ) {\r\n\t\r\n\t\t\tvar geometry = event.target;\r\n\t\t\tvar buffergeometry = geometries[ geometry.id ];\r\n\t\r\n\t\t\tdeleteAttributes( buffergeometry.attributes );\r\n\t\r\n\t\t\tgeometry.removeEventListener( 'dispose', onGeometryDispose );\r\n\t\r\n\t\t\tdelete geometries[ geometry.id ];\r\n\t\r\n\t\t\tvar property = properties.get( geometry );\r\n\t\t\tif ( property.wireframe ) deleteAttribute( property.wireframe );\r\n\t\r\n\t\t\tinfo.memory.geometries --;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction getAttributeBuffer( attribute ) {\r\n\t\r\n\t\t\tif ( attribute instanceof THREE.InterleavedBufferAttribute ) {\r\n\t\r\n\t\t\t\treturn properties.get( attribute.data ).__webglBuffer;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn properties.get( attribute ).__webglBuffer;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction deleteAttribute( attribute ) {\r\n\t\r\n\t\t\tvar buffer = getAttributeBuffer( attribute );\r\n\t\r\n\t\t\tif ( buffer !== undefined ) {\r\n\t\r\n\t\t\t\tgl.deleteBuffer( buffer );\r\n\t\t\t\tremoveAttributeBuffer( attribute );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction deleteAttributes( attributes ) {\r\n\t\r\n\t\t\tfor ( var name in attributes ) {\r\n\t\r\n\t\t\t\tdeleteAttribute( attributes[ name ] );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction removeAttributeBuffer( attribute ) {\r\n\t\r\n\t\t\tif ( attribute instanceof THREE.InterleavedBufferAttribute ) {\r\n\t\r\n\t\t\t\tproperties.delete( attribute.data );\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\tproperties.delete( attribute );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tthis.get = get;\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/renderers/webgl/WebGLObjects.js\r\n\t\r\n\t/**\r\n\t* @author mrdoob / http://mrdoob.com/\r\n\t*/\r\n\t\r\n\tTHREE.WebGLObjects = function ( gl, properties, info ) {\r\n\t\r\n\t\tvar geometries = new THREE.WebGLGeometries( gl, properties, info );\r\n\t\r\n\t\t//\r\n\t\r\n\t\tfunction update( object ) {\r\n\t\r\n\t\t\t// TODO: Avoid updating twice (when using shadowMap). Maybe add frame counter.\r\n\t\r\n\t\t\tvar geometry = geometries.get( object );\r\n\t\r\n\t\t\tif ( object.geometry instanceof THREE.Geometry ) {\r\n\t\r\n\t\t\t\tgeometry.updateFromObject( object );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar index = geometry.index;\r\n\t\t\tvar attributes = geometry.attributes;\r\n\t\r\n\t\t\tif ( index !== null ) {\r\n\t\r\n\t\t\t\tupdateAttribute( index, gl.ELEMENT_ARRAY_BUFFER );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tfor ( var name in attributes ) {\r\n\t\r\n\t\t\t\tupdateAttribute( attributes[ name ], gl.ARRAY_BUFFER );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// morph targets\r\n\t\r\n\t\t\tvar morphAttributes = geometry.morphAttributes;\r\n\t\r\n\t\t\tfor ( var name in morphAttributes ) {\r\n\t\r\n\t\t\t\tvar array = morphAttributes[ name ];\r\n\t\r\n\t\t\t\tfor ( var i = 0, l = array.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\t\tupdateAttribute( array[ i ], gl.ARRAY_BUFFER );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn geometry;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction updateAttribute( attribute, bufferType ) {\r\n\t\r\n\t\t\tvar data = ( attribute instanceof THREE.InterleavedBufferAttribute ) ? attribute.data : attribute;\r\n\t\r\n\t\t\tvar attributeProperties = properties.get( data );\r\n\t\r\n\t\t\tif ( attributeProperties.__webglBuffer === undefined ) {\r\n\t\r\n\t\t\t\tcreateBuffer( attributeProperties, data, bufferType );\r\n\t\r\n\t\t\t} else if ( attributeProperties.version !== data.version ) {\r\n\t\r\n\t\t\t\tupdateBuffer( attributeProperties, data, bufferType );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction createBuffer( attributeProperties, data, bufferType ) {\r\n\t\r\n\t\t\tattributeProperties.__webglBuffer = gl.createBuffer();\r\n\t\t\tgl.bindBuffer( bufferType, attributeProperties.__webglBuffer );\r\n\t\r\n\t\t\tvar usage = data.dynamic ? gl.DYNAMIC_DRAW : gl.STATIC_DRAW;\r\n\t\r\n\t\t\tgl.bufferData( bufferType, data.array, usage );\r\n\t\r\n\t\t\tattributeProperties.version = data.version;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction updateBuffer( attributeProperties, data, bufferType ) {\r\n\t\r\n\t\t\tgl.bindBuffer( bufferType, attributeProperties.__webglBuffer );\r\n\t\r\n\t\t\tif ( data.dynamic === false || data.updateRange.count === - 1 ) {\r\n\t\r\n\t\t\t\t// Not using update ranges\r\n\t\r\n\t\t\t\tgl.bufferSubData( bufferType, 0, data.array );\r\n\t\r\n\t\t\t} else if ( data.updateRange.count === 0 ) {\r\n\t\r\n\t\t\t\tconsole.error( 'THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually.' );\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\tgl.bufferSubData( bufferType, data.updateRange.offset * data.array.BYTES_PER_ELEMENT,\r\n\t\t\t\t\t\t\t\t  data.array.subarray( data.updateRange.offset, data.updateRange.offset + data.updateRange.count ) );\r\n\t\r\n\t\t\t\tdata.updateRange.count = 0; // reset range\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tattributeProperties.version = data.version;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction getAttributeBuffer( attribute ) {\r\n\t\r\n\t\t\tif ( attribute instanceof THREE.InterleavedBufferAttribute ) {\r\n\t\r\n\t\t\t\treturn properties.get( attribute.data ).__webglBuffer;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn properties.get( attribute ).__webglBuffer;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction getWireframeAttribute( geometry ) {\r\n\t\r\n\t\t\tvar property = properties.get( geometry );\r\n\t\r\n\t\t\tif ( property.wireframe !== undefined ) {\r\n\t\r\n\t\t\t\treturn property.wireframe;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar indices = [];\r\n\t\r\n\t\t\tvar index = geometry.index;\r\n\t\t\tvar attributes = geometry.attributes;\r\n\t\t\tvar position = attributes.position;\r\n\t\r\n\t\t\t// console.time( 'wireframe' );\r\n\t\r\n\t\t\tif ( index !== null ) {\r\n\t\r\n\t\t\t\tvar edges = {};\r\n\t\t\t\tvar array = index.array;\r\n\t\r\n\t\t\t\tfor ( var i = 0, l = array.length; i < l; i += 3 ) {\r\n\t\r\n\t\t\t\t\tvar a = array[ i + 0 ];\r\n\t\t\t\t\tvar b = array[ i + 1 ];\r\n\t\t\t\t\tvar c = array[ i + 2 ];\r\n\t\r\n\t\t\t\t\tif ( checkEdge( edges, a, b ) ) indices.push( a, b );\r\n\t\t\t\t\tif ( checkEdge( edges, b, c ) ) indices.push( b, c );\r\n\t\t\t\t\tif ( checkEdge( edges, c, a ) ) indices.push( c, a );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\tvar array = attributes.position.array;\r\n\t\r\n\t\t\t\tfor ( var i = 0, l = ( array.length / 3 ) - 1; i < l; i += 3 ) {\r\n\t\r\n\t\t\t\t\tvar a = i + 0;\r\n\t\t\t\t\tvar b = i + 1;\r\n\t\t\t\t\tvar c = i + 2;\r\n\t\r\n\t\t\t\t\tindices.push( a, b, b, c, c, a );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// console.timeEnd( 'wireframe' );\r\n\t\r\n\t\t\tvar TypeArray = position.count > 65535 ? Uint32Array : Uint16Array;\r\n\t\t\tvar attribute = new THREE.BufferAttribute( new TypeArray( indices ), 1 );\r\n\t\r\n\t\t\tupdateAttribute( attribute, gl.ELEMENT_ARRAY_BUFFER );\r\n\t\r\n\t\t\tproperty.wireframe = attribute;\r\n\t\r\n\t\t\treturn attribute;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction checkEdge( edges, a, b ) {\r\n\t\r\n\t\t\tif ( a > b ) {\r\n\t\r\n\t\t\t\tvar tmp = a;\r\n\t\t\t\ta = b;\r\n\t\t\t\tb = tmp;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar list = edges[ a ];\r\n\t\r\n\t\t\tif ( list === undefined ) {\r\n\t\r\n\t\t\t\tedges[ a ] = [ b ];\r\n\t\t\t\treturn true;\r\n\t\r\n\t\t\t} else if ( list.indexOf( b ) === -1 ) {\r\n\t\r\n\t\t\t\tlist.push( b );\r\n\t\t\t\treturn true;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn false;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tthis.getAttributeBuffer = getAttributeBuffer;\r\n\t\tthis.getWireframeAttribute = getWireframeAttribute;\r\n\t\r\n\t\tthis.update = update;\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/renderers/webgl/WebGLProgram.js\r\n\t\r\n\tTHREE.WebGLProgram = ( function () {\r\n\t\r\n\t\tvar programIdCount = 0;\r\n\t\r\n\t\tfunction generateDefines( defines ) {\r\n\t\r\n\t\t\tvar chunks = [];\r\n\t\r\n\t\t\tfor ( var name in defines ) {\r\n\t\r\n\t\t\t\tvar value = defines[ name ];\r\n\t\r\n\t\t\t\tif ( value === false ) continue;\r\n\t\r\n\t\t\t\tchunks.push( '#define ' + name + ' ' + value );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn chunks.join( '\\n' );\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction fetchUniformLocations( gl, program, identifiers ) {\r\n\t\r\n\t\t\tvar uniforms = {};\r\n\t\r\n\t\t\tvar n = gl.getProgramParameter( program, gl.ACTIVE_UNIFORMS );\r\n\t\r\n\t\t\tfor ( var i = 0; i < n; i ++ ) {\r\n\t\r\n\t\t\t\tvar info = gl.getActiveUniform( program, i );\r\n\t\t\t\tvar name = info.name;\r\n\t\t\t\tvar location = gl.getUniformLocation( program, name );\r\n\t\r\n\t\t\t\t// console.log(\"THREE.WebGLProgram: ACTIVE UNIFORM:\", name);\r\n\t\r\n\t\t\t\tvar suffixPos = name.lastIndexOf( '[0]' );\r\n\t\t\t\tif ( suffixPos !== - 1 && suffixPos === name.length - 3 ) {\r\n\t\r\n\t\t\t\t\tuniforms[ name.substr( 0, suffixPos ) ] = location;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tuniforms[ name ] = location;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn uniforms;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction fetchAttributeLocations( gl, program, identifiers ) {\r\n\t\r\n\t\t\tvar attributes = {};\r\n\t\r\n\t\t\tvar n = gl.getProgramParameter( program, gl.ACTIVE_ATTRIBUTES );\r\n\t\r\n\t\t\tfor ( var i = 0; i < n; i ++ ) {\r\n\t\r\n\t\t\t\tvar info = gl.getActiveAttrib( program, i );\r\n\t\t\t\tvar name = info.name;\r\n\t\r\n\t\t\t\t// console.log(\"THREE.WebGLProgram: ACTIVE VERTEX ATTRIBUTE:\", name, i );\r\n\t\r\n\t\t\t\tattributes[ name ] = gl.getAttribLocation( program, name );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn attributes;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction filterEmptyLine( string ) {\r\n\t\r\n\t\t\treturn string !== '';\r\n\t\r\n\t\t}\r\n\t\r\n\t\treturn function WebGLProgram( renderer, code, material, parameters ) {\r\n\t\r\n\t\t\tvar gl = renderer.context;\r\n\t\r\n\t\t\tvar defines = material.defines;\r\n\t\r\n\t\t\tvar vertexShader = material.__webglShader.vertexShader;\r\n\t\t\tvar fragmentShader = material.__webglShader.fragmentShader;\r\n\t\r\n\t\t\tvar shadowMapTypeDefine = 'SHADOWMAP_TYPE_BASIC';\r\n\t\r\n\t\t\tif ( parameters.shadowMapType === THREE.PCFShadowMap ) {\r\n\t\r\n\t\t\t\tshadowMapTypeDefine = 'SHADOWMAP_TYPE_PCF';\r\n\t\r\n\t\t\t} else if ( parameters.shadowMapType === THREE.PCFSoftShadowMap ) {\r\n\t\r\n\t\t\t\tshadowMapTypeDefine = 'SHADOWMAP_TYPE_PCF_SOFT';\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar envMapTypeDefine = 'ENVMAP_TYPE_CUBE';\r\n\t\t\tvar envMapModeDefine = 'ENVMAP_MODE_REFLECTION';\r\n\t\t\tvar envMapBlendingDefine = 'ENVMAP_BLENDING_MULTIPLY';\r\n\t\r\n\t\t\tif ( parameters.envMap ) {\r\n\t\r\n\t\t\t\tswitch ( material.envMap.mapping ) {\r\n\t\r\n\t\t\t\t\tcase THREE.CubeReflectionMapping:\r\n\t\t\t\t\tcase THREE.CubeRefractionMapping:\r\n\t\t\t\t\t\tenvMapTypeDefine = 'ENVMAP_TYPE_CUBE';\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase THREE.EquirectangularReflectionMapping:\r\n\t\t\t\t\tcase THREE.EquirectangularRefractionMapping:\r\n\t\t\t\t\t\tenvMapTypeDefine = 'ENVMAP_TYPE_EQUIREC';\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase THREE.SphericalReflectionMapping:\r\n\t\t\t\t\t\tenvMapTypeDefine = 'ENVMAP_TYPE_SPHERE';\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tswitch ( material.envMap.mapping ) {\r\n\t\r\n\t\t\t\t\tcase THREE.CubeRefractionMapping:\r\n\t\t\t\t\tcase THREE.EquirectangularRefractionMapping:\r\n\t\t\t\t\t\tenvMapModeDefine = 'ENVMAP_MODE_REFRACTION';\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tswitch ( material.combine ) {\r\n\t\r\n\t\t\t\t\tcase THREE.MultiplyOperation:\r\n\t\t\t\t\t\tenvMapBlendingDefine = 'ENVMAP_BLENDING_MULTIPLY';\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase THREE.MixOperation:\r\n\t\t\t\t\t\tenvMapBlendingDefine = 'ENVMAP_BLENDING_MIX';\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\tcase THREE.AddOperation:\r\n\t\t\t\t\t\tenvMapBlendingDefine = 'ENVMAP_BLENDING_ADD';\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar gammaFactorDefine = ( renderer.gammaFactor > 0 ) ? renderer.gammaFactor : 1.0;\r\n\t\r\n\t\t\t// console.log( 'building new program ' );\r\n\t\r\n\t\t\t//\r\n\t\r\n\t\t\tvar customDefines = generateDefines( defines );\r\n\t\r\n\t\t\t//\r\n\t\r\n\t\t\tvar program = gl.createProgram();\r\n\t\r\n\t\t\tvar prefixVertex, prefixFragment;\r\n\t\r\n\t\t\tif ( material instanceof THREE.RawShaderMaterial ) {\r\n\t\r\n\t\t\t\tprefixVertex = '';\r\n\t\t\t\tprefixFragment = '';\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\tprefixVertex = [\r\n\t\r\n\t\t\t\t\t'precision ' + parameters.precision + ' float;',\r\n\t\t\t\t\t'precision ' + parameters.precision + ' int;',\r\n\t\r\n\t\t\t\t\t'#define SHADER_NAME ' + material.__webglShader.name,\r\n\t\r\n\t\t\t\t\tcustomDefines,\r\n\t\r\n\t\t\t\t\tparameters.supportsVertexTextures ? '#define VERTEX_TEXTURES' : '',\r\n\t\r\n\t\t\t\t\trenderer.gammaInput ? '#define GAMMA_INPUT' : '',\r\n\t\t\t\t\trenderer.gammaOutput ? '#define GAMMA_OUTPUT' : '',\r\n\t\t\t\t\t'#define GAMMA_FACTOR ' + gammaFactorDefine,\r\n\t\r\n\t\t\t\t\t'#define MAX_DIR_LIGHTS ' + parameters.maxDirLights,\r\n\t\t\t\t\t'#define MAX_POINT_LIGHTS ' + parameters.maxPointLights,\r\n\t\t\t\t\t'#define MAX_SPOT_LIGHTS ' + parameters.maxSpotLights,\r\n\t\t\t\t\t'#define MAX_HEMI_LIGHTS ' + parameters.maxHemiLights,\r\n\t\r\n\t\t\t\t\t'#define MAX_SHADOWS ' + parameters.maxShadows,\r\n\t\r\n\t\t\t\t\t'#define MAX_BONES ' + parameters.maxBones,\r\n\t\r\n\t\t\t\t\tparameters.map ? '#define USE_MAP' : '',\r\n\t\t\t\t\tparameters.envMap ? '#define USE_ENVMAP' : '',\r\n\t\t\t\t\tparameters.envMap ? '#define ' + envMapModeDefine : '',\r\n\t\t\t\t\tparameters.lightMap ? '#define USE_LIGHTMAP' : '',\r\n\t\t\t\t\tparameters.aoMap ? '#define USE_AOMAP' : '',\r\n\t\t\t\t\tparameters.emissiveMap ? '#define USE_EMISSIVEMAP' : '',\r\n\t\t\t\t\tparameters.bumpMap ? '#define USE_BUMPMAP' : '',\r\n\t\t\t\t\tparameters.normalMap ? '#define USE_NORMALMAP' : '',\r\n\t\t\t\t\tparameters.displacementMap && parameters.supportsVertexTextures ? '#define USE_DISPLACEMENTMAP' : '',\r\n\t\t\t\t\tparameters.specularMap ? '#define USE_SPECULARMAP' : '',\r\n\t\t\t\t\tparameters.alphaMap ? '#define USE_ALPHAMAP' : '',\r\n\t\t\t\t\tparameters.vertexColors ? '#define USE_COLOR' : '',\r\n\t\r\n\t\t\t\t\tparameters.flatShading ? '#define FLAT_SHADED' : '',\r\n\t\r\n\t\t\t\t\tparameters.skinning ? '#define USE_SKINNING' : '',\r\n\t\t\t\t\tparameters.useVertexTexture ? '#define BONE_TEXTURE' : '',\r\n\t\r\n\t\t\t\t\tparameters.morphTargets ? '#define USE_MORPHTARGETS' : '',\r\n\t\t\t\t\tparameters.morphNormals && parameters.flatShading === false ? '#define USE_MORPHNORMALS' : '',\r\n\t\t\t\t\tparameters.doubleSided ? '#define DOUBLE_SIDED' : '',\r\n\t\t\t\t\tparameters.flipSided ? '#define FLIP_SIDED' : '',\r\n\t\r\n\t\t\t\t\tparameters.shadowMapEnabled ? '#define USE_SHADOWMAP' : '',\r\n\t\t\t\t\tparameters.shadowMapEnabled ? '#define ' + shadowMapTypeDefine : '',\r\n\t\t\t\t\tparameters.shadowMapDebug ? '#define SHADOWMAP_DEBUG' : '',\r\n\t\t\t\t\tparameters.pointLightShadows > 0 ? '#define POINT_LIGHT_SHADOWS' : '',\r\n\t\r\n\t\t\t\t\tparameters.sizeAttenuation ? '#define USE_SIZEATTENUATION' : '',\r\n\t\r\n\t\t\t\t\tparameters.logarithmicDepthBuffer ? '#define USE_LOGDEPTHBUF' : '',\r\n\t\t\t\t\tparameters.logarithmicDepthBuffer && renderer.extensions.get( 'EXT_frag_depth' ) ? '#define USE_LOGDEPTHBUF_EXT' : '',\r\n\t\r\n\t\r\n\t\t\t\t\t'uniform mat4 modelMatrix;',\r\n\t\t\t\t\t'uniform mat4 modelViewMatrix;',\r\n\t\t\t\t\t'uniform mat4 projectionMatrix;',\r\n\t\t\t\t\t'uniform mat4 viewMatrix;',\r\n\t\t\t\t\t'uniform mat3 normalMatrix;',\r\n\t\t\t\t\t'uniform vec3 cameraPosition;',\r\n\t\r\n\t\t\t\t\t'attribute vec3 position;',\r\n\t\t\t\t\t'attribute vec3 normal;',\r\n\t\t\t\t\t'attribute vec2 uv;',\r\n\t\r\n\t\t\t\t\t'#ifdef USE_COLOR',\r\n\t\r\n\t\t\t\t\t'\tattribute vec3 color;',\r\n\t\r\n\t\t\t\t\t'#endif',\r\n\t\r\n\t\t\t\t\t'#ifdef USE_MORPHTARGETS',\r\n\t\r\n\t\t\t\t\t'\tattribute vec3 morphTarget0;',\r\n\t\t\t\t\t'\tattribute vec3 morphTarget1;',\r\n\t\t\t\t\t'\tattribute vec3 morphTarget2;',\r\n\t\t\t\t\t'\tattribute vec3 morphTarget3;',\r\n\t\r\n\t\t\t\t\t'\t#ifdef USE_MORPHNORMALS',\r\n\t\r\n\t\t\t\t\t'\t\tattribute vec3 morphNormal0;',\r\n\t\t\t\t\t'\t\tattribute vec3 morphNormal1;',\r\n\t\t\t\t\t'\t\tattribute vec3 morphNormal2;',\r\n\t\t\t\t\t'\t\tattribute vec3 morphNormal3;',\r\n\t\r\n\t\t\t\t\t'\t#else',\r\n\t\r\n\t\t\t\t\t'\t\tattribute vec3 morphTarget4;',\r\n\t\t\t\t\t'\t\tattribute vec3 morphTarget5;',\r\n\t\t\t\t\t'\t\tattribute vec3 morphTarget6;',\r\n\t\t\t\t\t'\t\tattribute vec3 morphTarget7;',\r\n\t\r\n\t\t\t\t\t'\t#endif',\r\n\t\r\n\t\t\t\t\t'#endif',\r\n\t\r\n\t\t\t\t\t'#ifdef USE_SKINNING',\r\n\t\r\n\t\t\t\t\t'\tattribute vec4 skinIndex;',\r\n\t\t\t\t\t'\tattribute vec4 skinWeight;',\r\n\t\r\n\t\t\t\t\t'#endif',\r\n\t\r\n\t\t\t\t\t'\\n'\r\n\t\r\n\t\t\t\t].filter( filterEmptyLine ).join( '\\n' );\r\n\t\r\n\t\t\t\tprefixFragment = [\r\n\t\r\n\t\t\t\t\tparameters.bumpMap || parameters.normalMap || parameters.flatShading || material.derivatives ? '#extension GL_OES_standard_derivatives : enable' : '',\r\n\t\t\t\t\tparameters.logarithmicDepthBuffer && renderer.extensions.get( 'EXT_frag_depth' ) ? '#extension GL_EXT_frag_depth : enable' : '',\r\n\t\r\n\t\t\t\t\t'precision ' + parameters.precision + ' float;',\r\n\t\t\t\t\t'precision ' + parameters.precision + ' int;',\r\n\t\r\n\t\t\t\t\t'#define SHADER_NAME ' + material.__webglShader.name,\r\n\t\r\n\t\t\t\t\tcustomDefines,\r\n\t\r\n\t\t\t\t\t'#define MAX_DIR_LIGHTS ' + parameters.maxDirLights,\r\n\t\t\t\t\t'#define MAX_POINT_LIGHTS ' + parameters.maxPointLights,\r\n\t\t\t\t\t'#define MAX_SPOT_LIGHTS ' + parameters.maxSpotLights,\r\n\t\t\t\t\t'#define MAX_HEMI_LIGHTS ' + parameters.maxHemiLights,\r\n\t\r\n\t\t\t\t\t'#define MAX_SHADOWS ' + parameters.maxShadows,\r\n\t\r\n\t\t\t\t\tparameters.alphaTest ? '#define ALPHATEST ' + parameters.alphaTest : '',\r\n\t\r\n\t\t\t\t\trenderer.gammaInput ? '#define GAMMA_INPUT' : '',\r\n\t\t\t\t\trenderer.gammaOutput ? '#define GAMMA_OUTPUT' : '',\r\n\t\t\t\t\t'#define GAMMA_FACTOR ' + gammaFactorDefine,\r\n\t\r\n\t\t\t\t\t( parameters.useFog && parameters.fog ) ? '#define USE_FOG' : '',\r\n\t\t\t\t\t( parameters.useFog && parameters.fogExp ) ? '#define FOG_EXP2' : '',\r\n\t\r\n\t\t\t\t\tparameters.map ? '#define USE_MAP' : '',\r\n\t\t\t\t\tparameters.envMap ? '#define USE_ENVMAP' : '',\r\n\t\t\t\t\tparameters.envMap ? '#define ' + envMapTypeDefine : '',\r\n\t\t\t\t\tparameters.envMap ? '#define ' + envMapModeDefine : '',\r\n\t\t\t\t\tparameters.envMap ? '#define ' + envMapBlendingDefine : '',\r\n\t\t\t\t\tparameters.lightMap ? '#define USE_LIGHTMAP' : '',\r\n\t\t\t\t\tparameters.aoMap ? '#define USE_AOMAP' : '',\r\n\t\t\t\t\tparameters.emissiveMap ? '#define USE_EMISSIVEMAP' : '',\r\n\t\t\t\t\tparameters.bumpMap ? '#define USE_BUMPMAP' : '',\r\n\t\t\t\t\tparameters.normalMap ? '#define USE_NORMALMAP' : '',\r\n\t\t\t\t\tparameters.specularMap ? '#define USE_SPECULARMAP' : '',\r\n\t\t\t\t\tparameters.alphaMap ? '#define USE_ALPHAMAP' : '',\r\n\t\t\t\t\tparameters.vertexColors ? '#define USE_COLOR' : '',\r\n\t\r\n\t\t\t\t\tparameters.flatShading ? '#define FLAT_SHADED' : '',\r\n\t\r\n\t\t\t\t\tparameters.metal ? '#define METAL' : '',\r\n\t\t\t\t\tparameters.doubleSided ? '#define DOUBLE_SIDED' : '',\r\n\t\t\t\t\tparameters.flipSided ? '#define FLIP_SIDED' : '',\r\n\t\r\n\t\t\t\t\tparameters.shadowMapEnabled ? '#define USE_SHADOWMAP' : '',\r\n\t\t\t\t\tparameters.shadowMapEnabled ? '#define ' + shadowMapTypeDefine : '',\r\n\t\t\t\t\tparameters.shadowMapDebug ? '#define SHADOWMAP_DEBUG' : '',\r\n\t\t\t\t\tparameters.pointLightShadows > 0 ? '#define POINT_LIGHT_SHADOWS' : '',\r\n\t\r\n\t\t\t\t\tparameters.logarithmicDepthBuffer ? '#define USE_LOGDEPTHBUF' : '',\r\n\t\t\t\t\tparameters.logarithmicDepthBuffer && renderer.extensions.get( 'EXT_frag_depth' ) ? '#define USE_LOGDEPTHBUF_EXT' : '',\r\n\t\r\n\t\t\t\t\t'uniform mat4 viewMatrix;',\r\n\t\t\t\t\t'uniform vec3 cameraPosition;',\r\n\t\r\n\t\t\t\t\t'\\n'\r\n\t\r\n\t\t\t\t].filter( filterEmptyLine ).join( '\\n' );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar vertexGlsl = prefixVertex + vertexShader;\r\n\t\t\tvar fragmentGlsl = prefixFragment + fragmentShader;\r\n\t\r\n\t\t\tvar glVertexShader = THREE.WebGLShader( gl, gl.VERTEX_SHADER, vertexGlsl );\r\n\t\t\tvar glFragmentShader = THREE.WebGLShader( gl, gl.FRAGMENT_SHADER, fragmentGlsl );\r\n\t\r\n\t\t\tgl.attachShader( program, glVertexShader );\r\n\t\t\tgl.attachShader( program, glFragmentShader );\r\n\t\r\n\t\t\t// Force a particular attribute to index 0.\r\n\t\r\n\t\t\tif ( material.index0AttributeName !== undefined ) {\r\n\t\r\n\t\t\t\tgl.bindAttribLocation( program, 0, material.index0AttributeName );\r\n\t\r\n\t\t\t} else if ( parameters.morphTargets === true ) {\r\n\t\r\n\t\t\t\t// programs with morphTargets displace position out of attribute 0\r\n\t\t\t\tgl.bindAttribLocation( program, 0, 'position' );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tgl.linkProgram( program );\r\n\t\r\n\t\t\tvar programLog = gl.getProgramInfoLog( program );\r\n\t\t\tvar vertexLog = gl.getShaderInfoLog( glVertexShader );\r\n\t\t\tvar fragmentLog = gl.getShaderInfoLog( glFragmentShader );\r\n\t\r\n\t\t\tvar runnable = true;\r\n\t\t\tvar haveDiagnostics = true;\r\n\t\r\n\t\t\tif ( gl.getProgramParameter( program, gl.LINK_STATUS ) === false ) {\r\n\t\r\n\t\t\t\trunnable = false;\r\n\t\r\n\t\t\t\tconsole.error( 'THREE.WebGLProgram: shader error: ', gl.getError(), 'gl.VALIDATE_STATUS', gl.getProgramParameter( program, gl.VALIDATE_STATUS ), 'gl.getProgramInfoLog', programLog, vertexLog, fragmentLog );\r\n\t\r\n\t\t\t} else if ( programLog !== '' ) {\r\n\t\r\n\t\t\t\tconsole.warn( 'THREE.WebGLProgram: gl.getProgramInfoLog()', programLog );\r\n\t\r\n\t\t\t} else if ( vertexLog === '' || fragmentLog === '' ) {\r\n\t\r\n\t\t\t\thaveDiagnostics = false;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( haveDiagnostics ) {\r\n\t\r\n\t\t\t\tthis.diagnostics = {\r\n\t\r\n\t\t\t\t\trunnable: runnable,\r\n\t\t\t\t\tmaterial: material,\r\n\t\r\n\t\t\t\t\tprogramLog: programLog,\r\n\t\r\n\t\t\t\t\tvertexShader: {\r\n\t\r\n\t\t\t\t\t\tlog: vertexLog,\r\n\t\t\t\t\t\tprefix: prefixVertex\r\n\t\r\n\t\t\t\t\t},\r\n\t\r\n\t\t\t\t\tfragmentShader: {\r\n\t\r\n\t\t\t\t\t\tlog: fragmentLog,\r\n\t\t\t\t\t\tprefix: prefixFragment\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t};\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// clean up\r\n\t\r\n\t\t\tgl.deleteShader( glVertexShader );\r\n\t\t\tgl.deleteShader( glFragmentShader );\r\n\t\r\n\t\t\t// set up caching for uniform locations\r\n\t\r\n\t\t\tvar cachedUniforms;\r\n\t\r\n\t\t\tthis.getUniforms = function() {\r\n\t\r\n\t\t\t\tif ( cachedUniforms === undefined ) {\r\n\t\r\n\t\t\t\t\tcachedUniforms = fetchUniformLocations( gl, program );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\treturn cachedUniforms;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t\t// set up caching for attribute locations\r\n\t\r\n\t\t\tvar cachedAttributes;\r\n\t\r\n\t\t\tthis.getAttributes = function() {\r\n\t\r\n\t\t\t\tif ( cachedAttributes === undefined ) {\r\n\t\r\n\t\t\t\t\tcachedAttributes = fetchAttributeLocations( gl, program );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\treturn cachedAttributes;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t\t// free resource\r\n\t\r\n\t\t\tthis.destroy = function() {\r\n\t\r\n\t\t\t\tgl.deleteProgram( program );\r\n\t\t\t\tthis.program = undefined;\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t\t// DEPRECATED\r\n\t\r\n\t\t\tObject.defineProperties( this, {\r\n\t\r\n\t\t\t\tuniforms: {\r\n\t\t\t\t\tget: function() {\r\n\t\r\n\t\t\t\t\t\tconsole.warn( 'THREE.WebGLProgram: .uniforms is now .getUniforms().' );\r\n\t\t\t\t\t\treturn this.getUniforms();\r\n\t\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\r\n\t\t\t\tattributes: {\r\n\t\t\t\t\tget: function() {\r\n\t\r\n\t\t\t\t\t\tconsole.warn( 'THREE.WebGLProgram: .attributes is now .getAttributes().' );\r\n\t\t\t\t\t\treturn this.getAttributes();\r\n\t\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\r\n\t\t\t} );\r\n\t\r\n\t\r\n\t\t\t//\r\n\t\r\n\t\t\tthis.id = programIdCount ++;\r\n\t\t\tthis.code = code;\r\n\t\t\tthis.usedTimes = 1;\r\n\t\t\tthis.program = program;\r\n\t\t\tthis.vertexShader = glVertexShader;\r\n\t\t\tthis.fragmentShader = glFragmentShader;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t};\r\n\t\r\n\t} )();\r\n\t\r\n\t// File:src/renderers/webgl/WebGLPrograms.js\r\n\t\r\n\tTHREE.WebGLPrograms = function ( renderer, capabilities ) {\r\n\t\r\n\t\tvar programs = [];\r\n\t\r\n\t\tvar shaderIDs = {\r\n\t\t\tMeshDepthMaterial: 'depth',\r\n\t\t\tMeshNormalMaterial: 'normal',\r\n\t\t\tMeshBasicMaterial: 'basic',\r\n\t\t\tMeshLambertMaterial: 'lambert',\r\n\t\t\tMeshPhongMaterial: 'phong',\r\n\t\t\tLineBasicMaterial: 'basic',\r\n\t\t\tLineDashedMaterial: 'dashed',\r\n\t\t\tPointsMaterial: 'points'\r\n\t\t};\r\n\t\r\n\t\tvar parameterNames = [\r\n\t\t\t\"precision\", \"supportsVertexTextures\", \"map\", \"envMap\", \"envMapMode\",\r\n\t\t\t\"lightMap\", \"aoMap\", \"emissiveMap\", \"bumpMap\", \"normalMap\", \"displacementMap\", \"specularMap\",\r\n\t\t\t\"alphaMap\", \"combine\", \"vertexColors\", \"fog\", \"useFog\", \"fogExp\",\r\n\t\t\t\"flatShading\", \"sizeAttenuation\", \"logarithmicDepthBuffer\", \"skinning\",\r\n\t\t\t\"maxBones\", \"useVertexTexture\", \"morphTargets\", \"morphNormals\",\r\n\t\t\t\"maxMorphTargets\", \"maxMorphNormals\", \"maxDirLights\", \"maxPointLights\",\r\n\t\t\t\"maxSpotLights\", \"maxHemiLights\", \"maxShadows\", \"shadowMapEnabled\", \"pointLightShadows\",\r\n\t\t\t\"shadowMapType\", \"shadowMapDebug\", \"alphaTest\", \"metal\", \"doubleSided\",\r\n\t\t\t\"flipSided\"\r\n\t\t];\r\n\t\r\n\t\r\n\t\tfunction allocateBones ( object ) {\r\n\t\r\n\t\t\tif ( capabilities.floatVertexTextures && object && object.skeleton && object.skeleton.useVertexTexture ) {\r\n\t\r\n\t\t\t\treturn 1024;\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\t// default for when object is not specified\r\n\t\t\t\t// ( for example when prebuilding shader to be used with multiple objects )\r\n\t\t\t\t//\r\n\t\t\t\t//  - leave some extra space for other uniforms\r\n\t\t\t\t//  - limit here is ANGLE's 254 max uniform vectors\r\n\t\t\t\t//    (up to 54 should be safe)\r\n\t\r\n\t\t\t\tvar nVertexUniforms = capabilities.maxVertexUniforms;\r\n\t\t\t\tvar nVertexMatrices = Math.floor( ( nVertexUniforms - 20 ) / 4 );\r\n\t\r\n\t\t\t\tvar maxBones = nVertexMatrices;\r\n\t\r\n\t\t\t\tif ( object !== undefined && object instanceof THREE.SkinnedMesh ) {\r\n\t\r\n\t\t\t\t\tmaxBones = Math.min( object.skeleton.bones.length, maxBones );\r\n\t\r\n\t\t\t\t\tif ( maxBones < object.skeleton.bones.length ) {\r\n\t\r\n\t\t\t\t\t\tconsole.warn( 'WebGLRenderer: too many bones - ' + object.skeleton.bones.length + ', this GPU supports just ' + maxBones + ' (try OpenGL instead of ANGLE)' );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\treturn maxBones;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction allocateLights( lights ) {\r\n\t\r\n\t\t\tvar dirLights = 0;\r\n\t\t\tvar pointLights = 0;\r\n\t\t\tvar spotLights = 0;\r\n\t\t\tvar hemiLights = 0;\r\n\t\r\n\t\t\tfor ( var l = 0, ll = lights.length; l < ll; l ++ ) {\r\n\t\r\n\t\t\t\tvar light = lights[ l ];\r\n\t\r\n\t\t\t\tif ( light.visible === false ) continue;\r\n\t\r\n\t\t\t\tif ( light instanceof THREE.DirectionalLight ) dirLights ++;\r\n\t\t\t\tif ( light instanceof THREE.PointLight ) pointLights ++;\r\n\t\t\t\tif ( light instanceof THREE.SpotLight ) spotLights ++;\r\n\t\t\t\tif ( light instanceof THREE.HemisphereLight ) hemiLights ++;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn { 'directional': dirLights, 'point': pointLights, 'spot': spotLights, 'hemi': hemiLights };\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction allocateShadows( lights ) {\r\n\t\r\n\t\t\tvar maxShadows = 0;\r\n\t\t\tvar pointLightShadows = 0;\r\n\t\r\n\t\t\tfor ( var l = 0, ll = lights.length; l < ll; l ++ ) {\r\n\t\r\n\t\t\t\tvar light = lights[ l ];\r\n\t\r\n\t\t\t\tif ( ! light.castShadow ) continue;\r\n\t\r\n\t\t\t\tif ( light instanceof THREE.SpotLight || light instanceof THREE.DirectionalLight ) maxShadows ++;\r\n\t\t\t\tif ( light instanceof THREE.PointLight ) {\r\n\t\r\n\t\t\t\t\tmaxShadows ++;\r\n\t\t\t\t\tpointLightShadows ++;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn { 'maxShadows': maxShadows, 'pointLightShadows': pointLightShadows };\r\n\t\r\n\t\t}\r\n\t\r\n\t\tthis.getParameters = function ( material, lights, fog, object ) {\r\n\t\r\n\t\t\tvar shaderID = shaderIDs[ material.type ];\r\n\t\t\t// heuristics to create shader parameters according to lights in the scene\r\n\t\t\t// (not to blow over maxLights budget)\r\n\t\r\n\t\t\tvar maxLightCount = allocateLights( lights );\r\n\t\t\tvar allocatedShadows = allocateShadows( lights );\r\n\t\t\tvar maxBones = allocateBones( object );\r\n\t\t\tvar precision = renderer.getPrecision();\r\n\t\r\n\t\t\tif ( material.precision !== null ) {\r\n\t\r\n\t\t\t\tprecision = capabilities.getMaxPrecision( material.precision );\r\n\t\r\n\t\t\t\tif ( precision !== material.precision ) {\r\n\t\r\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer.initMaterial:', material.precision, 'not supported, using', precision, 'instead.' );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar parameters = {\r\n\t\r\n\t\t\t\tshaderID: shaderID,\r\n\t\r\n\t\t\t\tprecision: precision,\r\n\t\t\t\tsupportsVertexTextures: capabilities.vertexTextures,\r\n\t\r\n\t\t\t\tmap: !! material.map,\r\n\t\t\t\tenvMap: !! material.envMap,\r\n\t\t\t\tenvMapMode: material.envMap && material.envMap.mapping,\r\n\t\t\t\tlightMap: !! material.lightMap,\r\n\t\t\t\taoMap: !! material.aoMap,\r\n\t\t\t\temissiveMap: !! material.emissiveMap,\r\n\t\t\t\tbumpMap: !! material.bumpMap,\r\n\t\t\t\tnormalMap: !! material.normalMap,\r\n\t\t\t\tdisplacementMap: !! material.displacementMap,\r\n\t\t\t\tspecularMap: !! material.specularMap,\r\n\t\t\t\talphaMap: !! material.alphaMap,\r\n\t\r\n\t\t\t\tcombine: material.combine,\r\n\t\r\n\t\t\t\tvertexColors: material.vertexColors,\r\n\t\r\n\t\t\t\tfog: fog,\r\n\t\t\t\tuseFog: material.fog,\r\n\t\t\t\tfogExp: fog instanceof THREE.FogExp2,\r\n\t\r\n\t\t\t\tflatShading: material.shading === THREE.FlatShading,\r\n\t\r\n\t\t\t\tsizeAttenuation: material.sizeAttenuation,\r\n\t\t\t\tlogarithmicDepthBuffer: capabilities.logarithmicDepthBuffer,\r\n\t\r\n\t\t\t\tskinning: material.skinning,\r\n\t\t\t\tmaxBones: maxBones,\r\n\t\t\t\tuseVertexTexture: capabilities.floatVertexTextures && object && object.skeleton && object.skeleton.useVertexTexture,\r\n\t\r\n\t\t\t\tmorphTargets: material.morphTargets,\r\n\t\t\t\tmorphNormals: material.morphNormals,\r\n\t\t\t\tmaxMorphTargets: renderer.maxMorphTargets,\r\n\t\t\t\tmaxMorphNormals: renderer.maxMorphNormals,\r\n\t\r\n\t\t\t\tmaxDirLights: maxLightCount.directional,\r\n\t\t\t\tmaxPointLights: maxLightCount.point,\r\n\t\t\t\tmaxSpotLights: maxLightCount.spot,\r\n\t\t\t\tmaxHemiLights: maxLightCount.hemi,\r\n\t\r\n\t\t\t\tmaxShadows: allocatedShadows.maxShadows,\r\n\t\t\t\tpointLightShadows: allocatedShadows.pointLightShadows,\r\n\t\t\t\tshadowMapEnabled: renderer.shadowMap.enabled && object.receiveShadow && allocatedShadows.maxShadows > 0,\r\n\t\t\t\tshadowMapType: renderer.shadowMap.type,\r\n\t\t\t\tshadowMapDebug: renderer.shadowMap.debug,\r\n\t\r\n\t\t\t\talphaTest: material.alphaTest,\r\n\t\t\t\tmetal: material.metal,\r\n\t\t\t\tdoubleSided: material.side === THREE.DoubleSide,\r\n\t\t\t\tflipSided: material.side === THREE.BackSide\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t\treturn parameters;\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.getProgramCode = function ( material, parameters ) {\r\n\t\r\n\t\t\tvar chunks = [];\r\n\t\r\n\t\t\tif ( parameters.shaderID ) {\r\n\t\r\n\t\t\t\tchunks.push( parameters.shaderID );\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\tchunks.push( material.fragmentShader );\r\n\t\t\t\tchunks.push( material.vertexShader );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( material.defines !== undefined ) {\r\n\t\r\n\t\t\t\tfor ( var name in material.defines ) {\r\n\t\r\n\t\t\t\t\tchunks.push( name );\r\n\t\t\t\t\tchunks.push( material.defines[ name ] );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tfor ( var i = 0; i < parameterNames.length; i ++ ) {\r\n\t\r\n\t\t\t\tvar parameterName = parameterNames[ i ];\r\n\t\t\t\tchunks.push( parameterName );\r\n\t\t\t\tchunks.push( parameters[ parameterName ] );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn chunks.join();\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.acquireProgram = function ( material, parameters, code ) {\r\n\t\r\n\t\t\tvar program;\r\n\t\r\n\t\t\t// Check if code has been already compiled\r\n\t\t\tfor ( var p = 0, pl = programs.length; p < pl; p ++ ) {\r\n\t\r\n\t\t\t\tvar programInfo = programs[ p ];\r\n\t\r\n\t\t\t\tif ( programInfo.code === code ) {\r\n\t\r\n\t\t\t\t\tprogram = programInfo;\r\n\t\t\t\t\t++ program.usedTimes;\r\n\t\r\n\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( program === undefined ) {\r\n\t\r\n\t\t\t\tprogram = new THREE.WebGLProgram( renderer, code, material, parameters );\r\n\t\t\t\tprograms.push( program );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn program;\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.releaseProgram = function( program ) {\r\n\t\r\n\t\t\tif ( -- program.usedTimes === 0 ) {\r\n\t\r\n\t\t\t\t// Remove from unordered set\r\n\t\t\t\tvar i = programs.indexOf( program );\r\n\t\t\t\tprograms[ i ] = programs[ programs.length - 1 ];\r\n\t\t\t\tprograms.pop();\r\n\t\r\n\t\t\t\t// Free WebGL resources\r\n\t\t\t\tprogram.destroy();\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t};\r\n\t\r\n\t\t// Exposed for resource monitoring & error feedback via renderer.info:\r\n\t\tthis.programs = programs;\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/renderers/webgl/WebGLProperties.js\r\n\t\r\n\t/**\r\n\t* @author fordacious / fordacious.github.io\r\n\t*/\r\n\t\r\n\tTHREE.WebGLProperties = function () {\r\n\t\r\n\t\tvar properties = {};\r\n\t\r\n\t\tthis.get = function ( object ) {\r\n\t\r\n\t\t\tvar uuid = object.uuid;\r\n\t\t\tvar map = properties[ uuid ];\r\n\t\r\n\t\t\tif ( map === undefined ) {\r\n\t\r\n\t\t\t\tmap = {};\r\n\t\t\t\tproperties[ uuid ] = map;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn map;\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.delete = function ( object ) {\r\n\t\r\n\t\t\tdelete properties[ object.uuid ];\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.clear = function () {\r\n\t\r\n\t\t\tproperties = {};\r\n\t\r\n\t\t};\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/renderers/webgl/WebGLShader.js\r\n\t\r\n\tTHREE.WebGLShader = ( function () {\r\n\t\r\n\t\tfunction addLineNumbers( string ) {\r\n\t\r\n\t\t\tvar lines = string.split( '\\n' );\r\n\t\r\n\t\t\tfor ( var i = 0; i < lines.length; i ++ ) {\r\n\t\r\n\t\t\t\tlines[ i ] = ( i + 1 ) + ': ' + lines[ i ];\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn lines.join( '\\n' );\r\n\t\r\n\t\t}\r\n\t\r\n\t\treturn function WebGLShader( gl, type, string ) {\r\n\t\r\n\t\t\tvar shader = gl.createShader( type );\r\n\t\r\n\t\t\tgl.shaderSource( shader, string );\r\n\t\t\tgl.compileShader( shader );\r\n\t\r\n\t\t\tif ( gl.getShaderParameter( shader, gl.COMPILE_STATUS ) === false ) {\r\n\t\r\n\t\t\t\tconsole.error( 'THREE.WebGLShader: Shader couldn\\'t compile.' );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( gl.getShaderInfoLog( shader ) !== '' ) {\r\n\t\r\n\t\t\t\tconsole.warn( 'THREE.WebGLShader: gl.getShaderInfoLog()', type === gl.VERTEX_SHADER ? 'vertex' : 'fragment', gl.getShaderInfoLog( shader ), addLineNumbers( string ) );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// --enable-privileged-webgl-extension\r\n\t\t\t// console.log( type, gl.getExtension( 'WEBGL_debug_shaders' ).getTranslatedShaderSource( shader ) );\r\n\t\r\n\t\t\treturn shader;\r\n\t\r\n\t\t};\r\n\t\r\n\t} )();\r\n\t\r\n\t// File:src/renderers/webgl/WebGLShadowMap.js\r\n\t\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.WebGLShadowMap = function ( _renderer, _lights, _objects ) {\r\n\t\r\n\t\tvar _gl = _renderer.context,\r\n\t\t_state = _renderer.state,\r\n\t\t_frustum = new THREE.Frustum(),\r\n\t\t_projScreenMatrix = new THREE.Matrix4(),\r\n\t\r\n\t\t_min = new THREE.Vector3(),\r\n\t\t_max = new THREE.Vector3(),\r\n\t\r\n\t\t_lookTarget = new THREE.Vector3(),\r\n\t\t_lightPositionWorld = new THREE.Vector3(),\r\n\t\r\n\t\t_renderList = [],\r\n\t\r\n\t\t_MorphingFlag = 1,\r\n\t\t_SkinningFlag = 2,\r\n\t\r\n\t\t_NumberOfMaterialVariants = ( _MorphingFlag | _SkinningFlag ) + 1,\r\n\t\r\n\t\t_depthMaterials = new Array( _NumberOfMaterialVariants ),\r\n\t\t_distanceMaterials = new Array( _NumberOfMaterialVariants );\r\n\t\r\n\t\tvar cubeDirections = [\r\n\t\t\tnew THREE.Vector3( 1, 0, 0 ), new THREE.Vector3( - 1, 0, 0 ), new THREE.Vector3( 0, 0, 1 ),\r\n\t\t\tnew THREE.Vector3( 0, 0, - 1 ), new THREE.Vector3( 0, 1, 0 ), new THREE.Vector3( 0, - 1, 0 )\r\n\t\t];\r\n\t\r\n\t\tvar cubeUps = [\r\n\t\t\tnew THREE.Vector3( 0, 1, 0 ), new THREE.Vector3( 0, 1, 0 ), new THREE.Vector3( 0, 1, 0 ),\r\n\t\t\tnew THREE.Vector3( 0, 1, 0 ), new THREE.Vector3( 0, 0, 1 ),\tnew THREE.Vector3( 0, 0, - 1 )\r\n\t\t];\r\n\t\r\n\t\tvar cube2DViewPorts = [\r\n\t\t\tnew THREE.Vector4(), new THREE.Vector4(), new THREE.Vector4(),\r\n\t\t\tnew THREE.Vector4(), new THREE.Vector4(), new THREE.Vector4()\r\n\t\t];\r\n\t\r\n\t\tvar _vector4 = new THREE.Vector4();\r\n\t\r\n\t\t// init\r\n\t\r\n\t\tvar depthShader = THREE.ShaderLib[ \"depthRGBA\" ];\r\n\t\tvar depthUniforms = THREE.UniformsUtils.clone( depthShader.uniforms );\r\n\t\r\n\t\tvar distanceShader = THREE.ShaderLib[ \"distanceRGBA\" ];\r\n\t\tvar distanceUniforms = THREE.UniformsUtils.clone( distanceShader.uniforms );\r\n\t\r\n\t\tfor ( var i = 0; i !== _NumberOfMaterialVariants; ++ i ) {\r\n\t\r\n\t\t\tvar useMorphing = ( i & _MorphingFlag ) !== 0;\r\n\t\t\tvar useSkinning = ( i & _SkinningFlag ) !== 0;\r\n\t\r\n\t\t\tvar depthMaterial = new THREE.ShaderMaterial( {\r\n\t\t\t\tuniforms: depthUniforms,\r\n\t\t\t\tvertexShader: depthShader.vertexShader,\r\n\t\t\t\tfragmentShader: depthShader.fragmentShader,\r\n\t\t\t\tmorphTargets: useMorphing,\r\n\t\t\t\tskinning: useSkinning\r\n\t\t\t} );\r\n\t\r\n\t\t\tdepthMaterial._shadowPass = true;\r\n\t\r\n\t\t\t_depthMaterials[ i ] = depthMaterial;\r\n\t\r\n\t\t\tvar distanceMaterial = new THREE.ShaderMaterial( {\r\n\t\t\t\tuniforms: distanceUniforms,\r\n\t\t\t\tvertexShader: distanceShader.vertexShader,\r\n\t\t\t\tfragmentShader: distanceShader.fragmentShader,\r\n\t\t\t\tmorphTargets: useMorphing,\r\n\t\t\t\tskinning: useSkinning\r\n\t\t\t} );\r\n\t\r\n\t\t\tdistanceMaterial._shadowPass = true;\r\n\t\r\n\t\t\t_distanceMaterials[ i ] = distanceMaterial;\r\n\t\r\n\t\t}\r\n\t\r\n\t\t//\r\n\t\r\n\t\tvar scope = this;\r\n\t\r\n\t\tthis.enabled = false;\r\n\t\r\n\t\tthis.autoUpdate = true;\r\n\t\tthis.needsUpdate = false;\r\n\t\r\n\t\tthis.type = THREE.PCFShadowMap;\r\n\t\tthis.cullFace = THREE.CullFaceFront;\r\n\t\r\n\t\tthis.render = function ( scene ) {\r\n\t\r\n\t\t\tvar faceCount, isPointLight;\r\n\t\r\n\t\t\tif ( scope.enabled === false ) return;\r\n\t\t\tif ( scope.autoUpdate === false && scope.needsUpdate === false ) return;\r\n\t\r\n\t\t\t// Set GL state for depth map.\r\n\t\t\t_gl.clearColor( 1, 1, 1, 1 );\r\n\t\t\t_state.disable( _gl.BLEND );\r\n\t\t\t_state.enable( _gl.CULL_FACE );\r\n\t\t\t_gl.frontFace( _gl.CCW );\r\n\t\t\t_gl.cullFace( scope.cullFace === THREE.CullFaceFront ? _gl.FRONT : _gl.BACK );\r\n\t\t\t_state.setDepthTest( true );\r\n\t\r\n\t\t\t// save the existing viewport so it can be restored later\r\n\t\t\t_renderer.getViewport( _vector4 );\r\n\t\r\n\t\t\t// render depth map\r\n\t\r\n\t\t\tfor ( var i = 0, il = _lights.length; i < il; i ++ ) {\r\n\t\r\n\t\t\t\tvar light = _lights[ i ];\r\n\t\r\n\t\t\t\tif ( light.castShadow === true ) {\r\n\t\r\n\t\t\t\t\tvar shadow = light.shadow;\r\n\t\t\t\t\tvar shadowCamera = shadow.camera;\r\n\t\t\t\t\tvar shadowMapSize = shadow.mapSize;\r\n\t\r\n\t\t\t\t\tif ( light instanceof THREE.PointLight ) {\r\n\t\r\n\t\t\t\t\t\tfaceCount = 6;\r\n\t\t\t\t\t\tisPointLight = true;\r\n\t\r\n\t\t\t\t\t\tvar vpWidth = shadowMapSize.x / 4.0;\r\n\t\t\t\t\t\tvar vpHeight = shadowMapSize.y / 2.0;\r\n\t\r\n\t\t\t\t\t\t// These viewports map a cube-map onto a 2D texture with the\r\n\t\t\t\t\t\t// following orientation:\r\n\t\t\t\t\t\t//\r\n\t\t\t\t\t\t//  xzXZ\r\n\t\t\t\t\t\t//   y Y\r\n\t\t\t\t\t\t//\r\n\t\t\t\t\t\t// X - Positive x direction\r\n\t\t\t\t\t\t// x - Negative x direction\r\n\t\t\t\t\t\t// Y - Positive y direction\r\n\t\t\t\t\t\t// y - Negative y direction\r\n\t\t\t\t\t\t// Z - Positive z direction\r\n\t\t\t\t\t\t// z - Negative z direction\r\n\t\r\n\t\t\t\t\t\t// positive X\r\n\t\t\t\t\t\tcube2DViewPorts[ 0 ].set( vpWidth * 2, vpHeight, vpWidth, vpHeight );\r\n\t\t\t\t\t\t// negative X\r\n\t\t\t\t\t\tcube2DViewPorts[ 1 ].set( 0, vpHeight, vpWidth, vpHeight );\r\n\t\t\t\t\t\t// positive Z\r\n\t\t\t\t\t\tcube2DViewPorts[ 2 ].set( vpWidth * 3, vpHeight, vpWidth, vpHeight );\r\n\t\t\t\t\t\t// negative Z\r\n\t\t\t\t\t\tcube2DViewPorts[ 3 ].set( vpWidth, vpHeight, vpWidth, vpHeight );\r\n\t\t\t\t\t\t// positive Y\r\n\t\t\t\t\t\tcube2DViewPorts[ 4 ].set( vpWidth * 3, 0, vpWidth, vpHeight );\r\n\t\t\t\t\t\t// negative Y\r\n\t\t\t\t\t\tcube2DViewPorts[ 5 ].set( vpWidth, 0, vpWidth, vpHeight );\r\n\t\r\n\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\tfaceCount = 1;\r\n\t\t\t\t\t\tisPointLight = false;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tif ( shadow.map === null ) {\r\n\t\r\n\t\t\t\t\t\tvar shadowFilter = THREE.LinearFilter;\r\n\t\r\n\t\t\t\t\t\tif ( scope.type === THREE.PCFSoftShadowMap ) {\r\n\t\r\n\t\t\t\t\t\t\tshadowFilter = THREE.NearestFilter;\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\tvar pars = { minFilter: shadowFilter, magFilter: shadowFilter, format: THREE.RGBAFormat };\r\n\t\r\n\t\t\t\t\t\tshadow.map = new THREE.WebGLRenderTarget( shadowMapSize.x, shadowMapSize.y, pars );\r\n\t\t\t\t\t\tshadow.matrix = new THREE.Matrix4();\r\n\t\r\n\t\t\t\t\t\t//\r\n\t\r\n\t\t\t\t\t\tif ( light instanceof THREE.SpotLight ) {\r\n\t\r\n\t\t\t\t\t\t\tshadowCamera.aspect = shadowMapSize.x / shadowMapSize.y;\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\tshadowCamera.updateProjectionMatrix();\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tvar shadowMap = shadow.map;\r\n\t\t\t\t\tvar shadowMatrix = shadow.matrix;\r\n\t\r\n\t\t\t\t\t_lightPositionWorld.setFromMatrixPosition( light.matrixWorld );\r\n\t\t\t\t\tshadowCamera.position.copy( _lightPositionWorld );\r\n\t\r\n\t\t\t\t\t_renderer.setRenderTarget( shadowMap );\r\n\t\t\t\t\t_renderer.clear();\r\n\t\r\n\t\t\t\t\t// render shadow map for each cube face (if omni-directional) or\r\n\t\t\t\t\t// run a single pass if not\r\n\t\r\n\t\t\t\t\tfor ( var face = 0; face < faceCount; face ++ ) {\r\n\t\r\n\t\t\t\t\t\tif ( isPointLight ) {\r\n\t\r\n\t\t\t\t\t\t\t_lookTarget.copy( shadowCamera.position );\r\n\t\t\t\t\t\t\t_lookTarget.add( cubeDirections[ face ] );\r\n\t\t\t\t\t\t\tshadowCamera.up.copy( cubeUps[ face ] );\r\n\t\t\t\t\t\t\tshadowCamera.lookAt( _lookTarget );\r\n\t\t\t\t\t\t\tvar vpDimensions = cube2DViewPorts[ face ];\r\n\t\t\t\t\t\t\t_renderer.setViewport( vpDimensions.x, vpDimensions.y, vpDimensions.z, vpDimensions.w );\r\n\t\r\n\t\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\t\t_lookTarget.setFromMatrixPosition( light.target.matrixWorld );\r\n\t\t\t\t\t\t\tshadowCamera.lookAt( _lookTarget );\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\tshadowCamera.updateMatrixWorld();\r\n\t\t\t\t\t\tshadowCamera.matrixWorldInverse.getInverse( shadowCamera.matrixWorld );\r\n\t\r\n\t\t\t\t\t\t// compute shadow matrix\r\n\t\r\n\t\t\t\t\t\tshadowMatrix.set(\r\n\t\t\t\t\t\t\t0.5, 0.0, 0.0, 0.5,\r\n\t\t\t\t\t\t\t0.0, 0.5, 0.0, 0.5,\r\n\t\t\t\t\t\t\t0.0, 0.0, 0.5, 0.5,\r\n\t\t\t\t\t\t\t0.0, 0.0, 0.0, 1.0\r\n\t\t\t\t\t\t);\r\n\t\r\n\t\t\t\t\t\tshadowMatrix.multiply( shadowCamera.projectionMatrix );\r\n\t\t\t\t\t\tshadowMatrix.multiply( shadowCamera.matrixWorldInverse );\r\n\t\r\n\t\t\t\t\t\t// update camera matrices and frustum\r\n\t\r\n\t\t\t\t\t\t_projScreenMatrix.multiplyMatrices( shadowCamera.projectionMatrix, shadowCamera.matrixWorldInverse );\r\n\t\t\t\t\t\t_frustum.setFromMatrix( _projScreenMatrix );\r\n\t\r\n\t\t\t\t\t\t// set object matrices & frustum culling\r\n\t\r\n\t\t\t\t\t\t_renderList.length = 0;\r\n\t\r\n\t\t\t\t\t\tprojectObject( scene, shadowCamera );\r\n\t\r\n\t\t\t\t\t\t// render shadow map\r\n\t\t\t\t\t\t// render regular objects\r\n\t\r\n\t\t\t\t\t\tfor ( var j = 0, jl = _renderList.length; j < jl; j ++ ) {\r\n\t\r\n\t\t\t\t\t\t\tvar object = _renderList[ j ];\r\n\t\t\t\t\t\t\tvar geometry = _objects.update( object );\r\n\t\t\t\t\t\t\tvar material = object.material;\r\n\t\r\n\t\t\t\t\t\t\tif ( material instanceof THREE.MeshFaceMaterial ) {\r\n\t\r\n\t\t\t\t\t\t\t\tvar groups = geometry.groups;\r\n\t\t\t\t\t\t\t\tvar materials = material.materials;\r\n\t\r\n\t\t\t\t\t\t\t\tfor ( var k = 0, kl = groups.length; k < kl; k ++ ) {\r\n\t\r\n\t\t\t\t\t\t\t\t\tvar group = groups[ k ];\r\n\t\t\t\t\t\t\t\t\tvar groupMaterial = materials[ group.materialIndex ];\r\n\t\r\n\t\t\t\t\t\t\t\t\tif ( groupMaterial.visible === true ) {\r\n\t\r\n\t\t\t\t\t\t\t\t\t\tvar depthMaterial = getDepthMaterial( object, groupMaterial, isPointLight, _lightPositionWorld );\r\n\t\t\t\t\t\t\t\t\t\t_renderer.renderBufferDirect( shadowCamera, _lights, null, geometry, depthMaterial, object, group );\r\n\t\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\t\t\tvar depthMaterial = getDepthMaterial( object, material, isPointLight, _lightPositionWorld );\r\n\t\t\t\t\t\t\t\t_renderer.renderBufferDirect( shadowCamera, _lights, null, geometry, depthMaterial, object, null );\r\n\t\r\n\t\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t// We must call _renderer.resetGLState() at the end of each iteration of\r\n\t\t\t\t\t// the light loop in order to force material updates for each light.\r\n\t\t\t\t\t_renderer.resetGLState();\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t_renderer.setViewport( _vector4.x, _vector4.y, _vector4.z, _vector4.w );\r\n\t\r\n\t\t\t// Restore GL state.\r\n\t\t\tvar clearColor = _renderer.getClearColor(),\r\n\t\t\tclearAlpha = _renderer.getClearAlpha();\r\n\t\t\t_renderer.setClearColor( clearColor, clearAlpha );\r\n\t\t\t_state.enable( _gl.BLEND );\r\n\t\r\n\t\t\tif ( scope.cullFace === THREE.CullFaceFront ) {\r\n\t\r\n\t\t\t\t_gl.cullFace( _gl.BACK );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t_renderer.resetGLState();\r\n\t\r\n\t\t\tscope.needsUpdate = false;\r\n\t\r\n\t\t};\r\n\t\r\n\t\tfunction getDepthMaterial( object, material, isPointLight, lightPositionWorld ) {\r\n\t\r\n\t\t\tvar geometry = object.geometry;\r\n\t\r\n\t\t\tvar newMaterial = null;\r\n\t\r\n\t\t\tvar materialVariants = _depthMaterials;\r\n\t\t\tvar customMaterial = object.customDepthMaterial;\r\n\t\r\n\t\t\tif ( isPointLight ) {\r\n\t\r\n\t\t\t\tmaterialVariants = _distanceMaterials;\r\n\t\t\t\tcustomMaterial = object.customDistanceMaterial;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( ! customMaterial ) {\r\n\t\r\n\t\t\t\tvar useMorphing = geometry.morphTargets !== undefined &&\r\n\t\t\t\t\t\tgeometry.morphTargets.length > 0 && material.morphTargets;\r\n\t\r\n\t\t\t\tvar useSkinning = object instanceof THREE.SkinnedMesh && material.skinning;\r\n\t\r\n\t\t\t\tvar variantIndex = 0;\r\n\t\r\n\t\t\t\tif ( useMorphing ) variantIndex |= _MorphingFlag;\r\n\t\t\t\tif ( useSkinning ) variantIndex |= _SkinningFlag;\r\n\t\r\n\t\t\t\tnewMaterial = materialVariants[ variantIndex ];\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\tnewMaterial = customMaterial;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tnewMaterial.visible = material.visible;\r\n\t\t\tnewMaterial.wireframe = material.wireframe;\r\n\t\t\tnewMaterial.wireframeLinewidth = material.wireframeLinewidth;\r\n\t\r\n\t\t\tif ( isPointLight && newMaterial.uniforms.lightPos !== undefined ) {\r\n\t\r\n\t\t\t\tnewMaterial.uniforms.lightPos.value.copy( lightPositionWorld );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn newMaterial;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction projectObject( object, camera ) {\r\n\t\r\n\t\t\tif ( object.visible === false ) return;\r\n\t\r\n\t\t\tif ( object instanceof THREE.Mesh || object instanceof THREE.Line || object instanceof THREE.Points ) {\r\n\t\r\n\t\t\t\tif ( object.castShadow && ( object.frustumCulled === false || _frustum.intersectsObject( object ) === true ) ) {\r\n\t\r\n\t\t\t\t\tvar material = object.material;\r\n\t\r\n\t\t\t\t\tif ( material.visible === true ) {\r\n\t\r\n\t\t\t\t\t\tobject.modelViewMatrix.multiplyMatrices( camera.matrixWorldInverse, object.matrixWorld );\r\n\t\t\t\t\t\t_renderList.push( object );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar children = object.children;\r\n\t\r\n\t\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\tprojectObject( children[ i ], camera );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/renderers/webgl/WebGLState.js\r\n\t\r\n\t/**\r\n\t* @author mrdoob / http://mrdoob.com/\r\n\t*/\r\n\t\r\n\tTHREE.WebGLState = function ( gl, extensions, paramThreeToGL ) {\r\n\t\r\n\t\tvar _this = this;\r\n\t\r\n\t\tvar newAttributes = new Uint8Array( 16 );\r\n\t\tvar enabledAttributes = new Uint8Array( 16 );\r\n\t\tvar attributeDivisors = new Uint8Array( 16 );\r\n\t\r\n\t\tvar capabilities = {};\r\n\t\r\n\t\tvar compressedTextureFormats = null;\r\n\t\r\n\t\tvar currentBlending = null;\r\n\t\tvar currentBlendEquation = null;\r\n\t\tvar currentBlendSrc = null;\r\n\t\tvar currentBlendDst = null;\r\n\t\tvar currentBlendEquationAlpha = null;\r\n\t\tvar currentBlendSrcAlpha = null;\r\n\t\tvar currentBlendDstAlpha = null;\r\n\t\r\n\t\tvar currentDepthFunc = null;\r\n\t\tvar currentDepthWrite = null;\r\n\t\r\n\t\tvar currentColorWrite = null;\r\n\t\r\n\t\tvar currentFlipSided = null;\r\n\t\r\n\t\tvar currentLineWidth = null;\r\n\t\r\n\t\tvar currentPolygonOffsetFactor = null;\r\n\t\tvar currentPolygonOffsetUnits = null;\r\n\t\r\n\t\tvar maxTextures = gl.getParameter( gl.MAX_TEXTURE_IMAGE_UNITS );\r\n\t\r\n\t\tvar currentTextureSlot = undefined;\r\n\t\tvar currentBoundTextures = {};\r\n\t\r\n\t\tthis.init = function () {\r\n\t\r\n\t\t\tgl.clearColor( 0, 0, 0, 1 );\r\n\t\t\tgl.clearDepth( 1 );\r\n\t\t\tgl.clearStencil( 0 );\r\n\t\r\n\t\t\tthis.enable( gl.DEPTH_TEST );\r\n\t\t\tgl.depthFunc( gl.LEQUAL );\r\n\t\r\n\t\t\tgl.frontFace( gl.CCW );\r\n\t\t\tgl.cullFace( gl.BACK );\r\n\t\t\tthis.enable( gl.CULL_FACE );\r\n\t\r\n\t\t\tthis.enable( gl.BLEND );\r\n\t\t\tgl.blendEquation( gl.FUNC_ADD );\r\n\t\t\tgl.blendFunc( gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA );\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.initAttributes = function () {\r\n\t\r\n\t\t\tfor ( var i = 0, l = newAttributes.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\tnewAttributes[ i ] = 0;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.enableAttribute = function ( attribute ) {\r\n\t\r\n\t\t\tnewAttributes[ attribute ] = 1;\r\n\t\r\n\t\t\tif ( enabledAttributes[ attribute ] === 0 ) {\r\n\t\r\n\t\t\t\tgl.enableVertexAttribArray( attribute );\r\n\t\t\t\tenabledAttributes[ attribute ] = 1;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( attributeDivisors[ attribute ] !== 0 ) {\r\n\t\r\n\t\t\t\tvar extension = extensions.get( 'ANGLE_instanced_arrays' );\r\n\t\r\n\t\t\t\textension.vertexAttribDivisorANGLE( attribute, 0 );\r\n\t\t\t\tattributeDivisors[ attribute ] = 0;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.enableAttributeAndDivisor = function ( attribute, meshPerAttribute, extension ) {\r\n\t\r\n\t\t\tnewAttributes[ attribute ] = 1;\r\n\t\r\n\t\t\tif ( enabledAttributes[ attribute ] === 0 ) {\r\n\t\r\n\t\t\t\tgl.enableVertexAttribArray( attribute );\r\n\t\t\t\tenabledAttributes[ attribute ] = 1;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( attributeDivisors[ attribute ] !== meshPerAttribute ) {\r\n\t\r\n\t\t\t\textension.vertexAttribDivisorANGLE( attribute, meshPerAttribute );\r\n\t\t\t\tattributeDivisors[ attribute ] = meshPerAttribute;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.disableUnusedAttributes = function () {\r\n\t\r\n\t\t\tfor ( var i = 0, l = enabledAttributes.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\tif ( enabledAttributes[ i ] !== newAttributes[ i ] ) {\r\n\t\r\n\t\t\t\t\tgl.disableVertexAttribArray( i );\r\n\t\t\t\t\tenabledAttributes[ i ] = 0;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.enable = function ( id ) {\r\n\t\r\n\t\t\tif ( capabilities[ id ] !== true ) {\r\n\t\r\n\t\t\t\tgl.enable( id );\r\n\t\t\t\tcapabilities[ id ] = true;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.disable = function ( id ) {\r\n\t\r\n\t\t\tif ( capabilities[ id ] !== false ) {\r\n\t\r\n\t\t\t\tgl.disable( id );\r\n\t\t\t\tcapabilities[ id ] = false;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.getCompressedTextureFormats = function () {\r\n\t\r\n\t\t\tif ( compressedTextureFormats === null ) {\r\n\t\r\n\t\t\t\tcompressedTextureFormats = [];\r\n\t\r\n\t\t\t\tif ( extensions.get( 'WEBGL_compressed_texture_pvrtc' ) ||\r\n\t\t\t\t     extensions.get( 'WEBGL_compressed_texture_s3tc' ) ) {\r\n\t\r\n\t\t\t\t\tvar formats = gl.getParameter( gl.COMPRESSED_TEXTURE_FORMATS );\r\n\t\r\n\t\t\t\t\tfor ( var i = 0; i < formats.length; i ++ ) {\r\n\t\r\n\t\t\t\t\t\tcompressedTextureFormats.push( formats[ i ] );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn compressedTextureFormats;\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.setBlending = function ( blending, blendEquation, blendSrc, blendDst, blendEquationAlpha, blendSrcAlpha, blendDstAlpha ) {\r\n\t\r\n\t\t\tif ( blending !== currentBlending ) {\r\n\t\r\n\t\t\t\tif ( blending === THREE.NoBlending ) {\r\n\t\r\n\t\t\t\t\tthis.disable( gl.BLEND );\r\n\t\r\n\t\t\t\t} else if ( blending === THREE.AdditiveBlending ) {\r\n\t\r\n\t\t\t\t\tthis.enable( gl.BLEND );\r\n\t\t\t\t\tgl.blendEquation( gl.FUNC_ADD );\r\n\t\t\t\t\tgl.blendFunc( gl.SRC_ALPHA, gl.ONE );\r\n\t\r\n\t\t\t\t} else if ( blending === THREE.SubtractiveBlending ) {\r\n\t\r\n\t\t\t\t\t// TODO: Find blendFuncSeparate() combination\r\n\t\r\n\t\t\t\t\tthis.enable( gl.BLEND );\r\n\t\t\t\t\tgl.blendEquation( gl.FUNC_ADD );\r\n\t\t\t\t\tgl.blendFunc( gl.ZERO, gl.ONE_MINUS_SRC_COLOR );\r\n\t\r\n\t\t\t\t} else if ( blending === THREE.MultiplyBlending ) {\r\n\t\r\n\t\t\t\t\t// TODO: Find blendFuncSeparate() combination\r\n\t\r\n\t\t\t\t\tthis.enable( gl.BLEND );\r\n\t\t\t\t\tgl.blendEquation( gl.FUNC_ADD );\r\n\t\t\t\t\tgl.blendFunc( gl.ZERO, gl.SRC_COLOR );\r\n\t\r\n\t\t\t\t} else if ( blending === THREE.CustomBlending ) {\r\n\t\r\n\t\t\t\t\tthis.enable( gl.BLEND );\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tthis.enable( gl.BLEND );\r\n\t\t\t\t\tgl.blendEquationSeparate( gl.FUNC_ADD, gl.FUNC_ADD );\r\n\t\t\t\t\tgl.blendFuncSeparate( gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tcurrentBlending = blending;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( blending === THREE.CustomBlending ) {\r\n\t\r\n\t\t\t\tblendEquationAlpha = blendEquationAlpha || blendEquation;\r\n\t\t\t\tblendSrcAlpha = blendSrcAlpha || blendSrc;\r\n\t\t\t\tblendDstAlpha = blendDstAlpha || blendDst;\r\n\t\r\n\t\t\t\tif ( blendEquation !== currentBlendEquation || blendEquationAlpha !== currentBlendEquationAlpha ) {\r\n\t\r\n\t\t\t\t\tgl.blendEquationSeparate( paramThreeToGL( blendEquation ), paramThreeToGL( blendEquationAlpha ) );\r\n\t\r\n\t\t\t\t\tcurrentBlendEquation = blendEquation;\r\n\t\t\t\t\tcurrentBlendEquationAlpha = blendEquationAlpha;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( blendSrc !== currentBlendSrc || blendDst !== currentBlendDst || blendSrcAlpha !== currentBlendSrcAlpha || blendDstAlpha !== currentBlendDstAlpha ) {\r\n\t\r\n\t\t\t\t\tgl.blendFuncSeparate( paramThreeToGL( blendSrc ), paramThreeToGL( blendDst ), paramThreeToGL( blendSrcAlpha ), paramThreeToGL( blendDstAlpha ) );\r\n\t\r\n\t\t\t\t\tcurrentBlendSrc = blendSrc;\r\n\t\t\t\t\tcurrentBlendDst = blendDst;\r\n\t\t\t\t\tcurrentBlendSrcAlpha = blendSrcAlpha;\r\n\t\t\t\t\tcurrentBlendDstAlpha = blendDstAlpha;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\tcurrentBlendEquation = null;\r\n\t\t\t\tcurrentBlendSrc = null;\r\n\t\t\t\tcurrentBlendDst = null;\r\n\t\t\t\tcurrentBlendEquationAlpha = null;\r\n\t\t\t\tcurrentBlendSrcAlpha = null;\r\n\t\t\t\tcurrentBlendDstAlpha = null;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.setDepthFunc = function ( depthFunc ) {\r\n\t\r\n\t\t\tif ( currentDepthFunc !== depthFunc ) {\r\n\t\r\n\t\t\t\tif ( depthFunc ) {\r\n\t\r\n\t\t\t\t\tswitch ( depthFunc ) {\r\n\t\r\n\t\t\t\t\t\tcase THREE.NeverDepth:\r\n\t\r\n\t\t\t\t\t\t\tgl.depthFunc( gl.NEVER );\r\n\t\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\t\tcase THREE.AlwaysDepth:\r\n\t\r\n\t\t\t\t\t\t\tgl.depthFunc( gl.ALWAYS );\r\n\t\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\t\tcase THREE.LessDepth:\r\n\t\r\n\t\t\t\t\t\t\tgl.depthFunc( gl.LESS );\r\n\t\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\t\tcase THREE.LessEqualDepth:\r\n\t\r\n\t\t\t\t\t\t\tgl.depthFunc( gl.LEQUAL );\r\n\t\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\t\tcase THREE.EqualDepth:\r\n\t\r\n\t\t\t\t\t\t\tgl.depthFunc( gl.EQUAL );\r\n\t\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\t\tcase THREE.GreaterEqualDepth:\r\n\t\r\n\t\t\t\t\t\t\tgl.depthFunc( gl.GEQUAL );\r\n\t\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\t\tcase THREE.GreaterDepth:\r\n\t\r\n\t\t\t\t\t\t\tgl.depthFunc( gl.GREATER );\r\n\t\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\t\tcase THREE.NotEqualDepth:\r\n\t\r\n\t\t\t\t\t\t\tgl.depthFunc( gl.NOTEQUAL );\r\n\t\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\t\tdefault:\r\n\t\r\n\t\t\t\t\t\t\tgl.depthFunc( gl.LEQUAL );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tgl.depthFunc( gl.LEQUAL );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tcurrentDepthFunc = depthFunc;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.setDepthTest = function ( depthTest ) {\r\n\t\r\n\t\t\tif ( depthTest ) {\r\n\t\r\n\t\t\t\tthis.enable( gl.DEPTH_TEST );\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\tthis.disable( gl.DEPTH_TEST );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.setDepthWrite = function ( depthWrite ) {\r\n\t\r\n\t\t\tif ( currentDepthWrite !== depthWrite ) {\r\n\t\r\n\t\t\t\tgl.depthMask( depthWrite );\r\n\t\t\t\tcurrentDepthWrite = depthWrite;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.setColorWrite = function ( colorWrite ) {\r\n\t\r\n\t\t\tif ( currentColorWrite !== colorWrite ) {\r\n\t\r\n\t\t\t\tgl.colorMask( colorWrite, colorWrite, colorWrite, colorWrite );\r\n\t\t\t\tcurrentColorWrite = colorWrite;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.setFlipSided = function ( flipSided ) {\r\n\t\r\n\t\t\tif ( currentFlipSided !== flipSided ) {\r\n\t\r\n\t\t\t\tif ( flipSided ) {\r\n\t\r\n\t\t\t\t\tgl.frontFace( gl.CW );\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tgl.frontFace( gl.CCW );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tcurrentFlipSided = flipSided;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.setLineWidth = function ( width ) {\r\n\t\r\n\t\t\tif ( width !== currentLineWidth ) {\r\n\t\r\n\t\t\t\tgl.lineWidth( width );\r\n\t\r\n\t\t\t\tcurrentLineWidth = width;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.setPolygonOffset = function ( polygonOffset, factor, units ) {\r\n\t\r\n\t\t\tif ( polygonOffset ) {\r\n\t\r\n\t\t\t\tthis.enable( gl.POLYGON_OFFSET_FILL );\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\tthis.disable( gl.POLYGON_OFFSET_FILL );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( polygonOffset && ( currentPolygonOffsetFactor !== factor || currentPolygonOffsetUnits !== units ) ) {\r\n\t\r\n\t\t\t\tgl.polygonOffset( factor, units );\r\n\t\r\n\t\t\t\tcurrentPolygonOffsetFactor = factor;\r\n\t\t\t\tcurrentPolygonOffsetUnits = units;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.setScissorTest = function ( scissorTest ) {\r\n\t\r\n\t\t\tif ( scissorTest ) {\r\n\t\r\n\t\t\t\tthis.enable( gl.SCISSOR_TEST );\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\tthis.disable( gl.SCISSOR_TEST );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t};\r\n\t\r\n\t\t// texture\r\n\t\r\n\t\tthis.activeTexture = function ( webglSlot ) {\r\n\t\r\n\t\t\tif ( webglSlot === undefined ) webglSlot = gl.TEXTURE0 + maxTextures - 1;\r\n\t\r\n\t\t\tif ( currentTextureSlot !== webglSlot ) {\r\n\t\r\n\t\t\t\tgl.activeTexture( webglSlot );\r\n\t\t\t\tcurrentTextureSlot = webglSlot;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tthis.bindTexture = function ( webglType, webglTexture ) {\r\n\t\r\n\t\t\tif ( currentTextureSlot === undefined ) {\r\n\t\r\n\t\t\t\t_this.activeTexture();\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar boundTexture = currentBoundTextures[ currentTextureSlot ];\r\n\t\r\n\t\t\tif ( boundTexture === undefined ) {\r\n\t\r\n\t\t\t\tboundTexture = { type: undefined, texture: undefined };\r\n\t\t\t\tcurrentBoundTextures[ currentTextureSlot ] = boundTexture;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( boundTexture.type !== webglType || boundTexture.texture !== webglTexture ) {\r\n\t\r\n\t\t\t\tgl.bindTexture( webglType, webglTexture );\r\n\t\r\n\t\t\t\tboundTexture.type = webglType;\r\n\t\t\t\tboundTexture.texture = webglTexture;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.compressedTexImage2D = function () {\r\n\t\r\n\t\t\ttry {\r\n\t\r\n\t\t\t\tgl.compressedTexImage2D.apply( gl, arguments );\r\n\t\r\n\t\t\t} catch ( error ) {\r\n\t\r\n\t\t\t\tconsole.error( error );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.texImage2D = function () {\r\n\t\r\n\t\t\ttry {\r\n\t\r\n\t\t\t\tgl.texImage2D.apply( gl, arguments );\r\n\t\r\n\t\t\t} catch ( error ) {\r\n\t\r\n\t\t\t\tconsole.error( error );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t};\r\n\t\r\n\t\t//\r\n\t\r\n\t\tthis.reset = function () {\r\n\t\r\n\t\t\tfor ( var i = 0; i < enabledAttributes.length; i ++ ) {\r\n\t\r\n\t\t\t\tif ( enabledAttributes[ i ] === 1 ) {\r\n\t\r\n\t\t\t\t\tgl.disableVertexAttribArray( i );\r\n\t\t\t\t\tenabledAttributes[ i ] = 0;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tcapabilities = {};\r\n\t\r\n\t\t\tcompressedTextureFormats = null;\r\n\t\r\n\t\t\tcurrentBlending = null;\r\n\t\r\n\t\t\tcurrentDepthWrite = null;\r\n\t\t\tcurrentColorWrite = null;\r\n\t\r\n\t\t\tcurrentFlipSided = null;\r\n\t\r\n\t\t};\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/renderers/webgl/plugins/LensFlarePlugin.js\r\n\t\r\n\t/**\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\t\r\n\tTHREE.LensFlarePlugin = function ( renderer, flares ) {\r\n\t\r\n\t\tvar gl = renderer.context;\r\n\t\tvar state = renderer.state;\r\n\t\r\n\t\tvar vertexBuffer, elementBuffer;\r\n\t\tvar program, attributes, uniforms;\r\n\t\tvar hasVertexTexture;\r\n\t\r\n\t\tvar tempTexture, occlusionTexture;\r\n\t\r\n\t\tfunction init() {\r\n\t\r\n\t\t\tvar vertices = new Float32Array( [\r\n\t\t\t\t- 1, - 1,  0, 0,\r\n\t\t\t\t 1, - 1,  1, 0,\r\n\t\t\t\t 1,  1,  1, 1,\r\n\t\t\t\t- 1,  1,  0, 1\r\n\t\t\t] );\r\n\t\r\n\t\t\tvar faces = new Uint16Array( [\r\n\t\t\t\t0, 1, 2,\r\n\t\t\t\t0, 2, 3\r\n\t\t\t] );\r\n\t\r\n\t\t\t// buffers\r\n\t\r\n\t\t\tvertexBuffer     = gl.createBuffer();\r\n\t\t\telementBuffer    = gl.createBuffer();\r\n\t\r\n\t\t\tgl.bindBuffer( gl.ARRAY_BUFFER, vertexBuffer );\r\n\t\t\tgl.bufferData( gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW );\r\n\t\r\n\t\t\tgl.bindBuffer( gl.ELEMENT_ARRAY_BUFFER, elementBuffer );\r\n\t\t\tgl.bufferData( gl.ELEMENT_ARRAY_BUFFER, faces, gl.STATIC_DRAW );\r\n\t\r\n\t\t\t// textures\r\n\t\r\n\t\t\ttempTexture      = gl.createTexture();\r\n\t\t\tocclusionTexture = gl.createTexture();\r\n\t\r\n\t\t\tstate.bindTexture( gl.TEXTURE_2D, tempTexture );\r\n\t\t\tgl.texImage2D( gl.TEXTURE_2D, 0, gl.RGB, 16, 16, 0, gl.RGB, gl.UNSIGNED_BYTE, null );\r\n\t\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE );\r\n\t\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE );\r\n\t\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST );\r\n\t\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST );\r\n\t\r\n\t\t\tstate.bindTexture( gl.TEXTURE_2D, occlusionTexture );\r\n\t\t\tgl.texImage2D( gl.TEXTURE_2D, 0, gl.RGBA, 16, 16, 0, gl.RGBA, gl.UNSIGNED_BYTE, null );\r\n\t\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE );\r\n\t\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE );\r\n\t\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST );\r\n\t\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST );\r\n\t\r\n\t\t\thasVertexTexture = gl.getParameter( gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS ) > 0;\r\n\t\r\n\t\t\tvar shader;\r\n\t\r\n\t\t\tif ( hasVertexTexture ) {\r\n\t\r\n\t\t\t\tshader = {\r\n\t\r\n\t\t\t\t\tvertexShader: [\r\n\t\r\n\t\t\t\t\t\t\"uniform lowp int renderType;\",\r\n\t\r\n\t\t\t\t\t\t\"uniform vec3 screenPosition;\",\r\n\t\t\t\t\t\t\"uniform vec2 scale;\",\r\n\t\t\t\t\t\t\"uniform float rotation;\",\r\n\t\r\n\t\t\t\t\t\t\"uniform sampler2D occlusionMap;\",\r\n\t\r\n\t\t\t\t\t\t\"attribute vec2 position;\",\r\n\t\t\t\t\t\t\"attribute vec2 uv;\",\r\n\t\r\n\t\t\t\t\t\t\"varying vec2 vUV;\",\r\n\t\t\t\t\t\t\"varying float vVisibility;\",\r\n\t\r\n\t\t\t\t\t\t\"void main() {\",\r\n\t\r\n\t\t\t\t\t\t\t\"vUV = uv;\",\r\n\t\r\n\t\t\t\t\t\t\t\"vec2 pos = position;\",\r\n\t\r\n\t\t\t\t\t\t\t\"if ( renderType == 2 ) {\",\r\n\t\r\n\t\t\t\t\t\t\t\t\"vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );\",\r\n\t\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );\",\r\n\t\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );\",\r\n\t\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );\",\r\n\t\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );\",\r\n\t\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );\",\r\n\t\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );\",\r\n\t\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );\",\r\n\t\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );\",\r\n\t\r\n\t\t\t\t\t\t\t\t\"vVisibility =        visibility.r / 9.0;\",\r\n\t\t\t\t\t\t\t\t\"vVisibility *= 1.0 - visibility.g / 9.0;\",\r\n\t\t\t\t\t\t\t\t\"vVisibility *=       visibility.b / 9.0;\",\r\n\t\t\t\t\t\t\t\t\"vVisibility *= 1.0 - visibility.a / 9.0;\",\r\n\t\r\n\t\t\t\t\t\t\t\t\"pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\",\r\n\t\t\t\t\t\t\t\t\"pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\",\r\n\t\r\n\t\t\t\t\t\t\t\"}\",\r\n\t\r\n\t\t\t\t\t\t\t\"gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\",\r\n\t\r\n\t\t\t\t\t\t\"}\"\r\n\t\r\n\t\t\t\t\t].join( \"\\n\" ),\r\n\t\r\n\t\t\t\t\tfragmentShader: [\r\n\t\r\n\t\t\t\t\t\t\"uniform lowp int renderType;\",\r\n\t\r\n\t\t\t\t\t\t\"uniform sampler2D map;\",\r\n\t\t\t\t\t\t\"uniform float opacity;\",\r\n\t\t\t\t\t\t\"uniform vec3 color;\",\r\n\t\r\n\t\t\t\t\t\t\"varying vec2 vUV;\",\r\n\t\t\t\t\t\t\"varying float vVisibility;\",\r\n\t\r\n\t\t\t\t\t\t\"void main() {\",\r\n\t\r\n\t\t\t\t\t\t\t// pink square\r\n\t\r\n\t\t\t\t\t\t\t\"if ( renderType == 0 ) {\",\r\n\t\r\n\t\t\t\t\t\t\t\t\"gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\",\r\n\t\r\n\t\t\t\t\t\t\t// restore\r\n\t\r\n\t\t\t\t\t\t\t\"} else if ( renderType == 1 ) {\",\r\n\t\r\n\t\t\t\t\t\t\t\t\"gl_FragColor = texture2D( map, vUV );\",\r\n\t\r\n\t\t\t\t\t\t\t// flare\r\n\t\r\n\t\t\t\t\t\t\t\"} else {\",\r\n\t\r\n\t\t\t\t\t\t\t\t\"vec4 texture = texture2D( map, vUV );\",\r\n\t\t\t\t\t\t\t\t\"texture.a *= opacity * vVisibility;\",\r\n\t\t\t\t\t\t\t\t\"gl_FragColor = texture;\",\r\n\t\t\t\t\t\t\t\t\"gl_FragColor.rgb *= color;\",\r\n\t\r\n\t\t\t\t\t\t\t\"}\",\r\n\t\r\n\t\t\t\t\t\t\"}\"\r\n\t\r\n\t\t\t\t\t].join( \"\\n\" )\r\n\t\r\n\t\t\t\t};\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\tshader = {\r\n\t\r\n\t\t\t\t\tvertexShader: [\r\n\t\r\n\t\t\t\t\t\t\"uniform lowp int renderType;\",\r\n\t\r\n\t\t\t\t\t\t\"uniform vec3 screenPosition;\",\r\n\t\t\t\t\t\t\"uniform vec2 scale;\",\r\n\t\t\t\t\t\t\"uniform float rotation;\",\r\n\t\r\n\t\t\t\t\t\t\"attribute vec2 position;\",\r\n\t\t\t\t\t\t\"attribute vec2 uv;\",\r\n\t\r\n\t\t\t\t\t\t\"varying vec2 vUV;\",\r\n\t\r\n\t\t\t\t\t\t\"void main() {\",\r\n\t\r\n\t\t\t\t\t\t\t\"vUV = uv;\",\r\n\t\r\n\t\t\t\t\t\t\t\"vec2 pos = position;\",\r\n\t\r\n\t\t\t\t\t\t\t\"if ( renderType == 2 ) {\",\r\n\t\r\n\t\t\t\t\t\t\t\t\"pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\",\r\n\t\t\t\t\t\t\t\t\"pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\",\r\n\t\r\n\t\t\t\t\t\t\t\"}\",\r\n\t\r\n\t\t\t\t\t\t\t\"gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\",\r\n\t\r\n\t\t\t\t\t\t\"}\"\r\n\t\r\n\t\t\t\t\t].join( \"\\n\" ),\r\n\t\r\n\t\t\t\t\tfragmentShader: [\r\n\t\r\n\t\t\t\t\t\t\"precision mediump float;\",\r\n\t\r\n\t\t\t\t\t\t\"uniform lowp int renderType;\",\r\n\t\r\n\t\t\t\t\t\t\"uniform sampler2D map;\",\r\n\t\t\t\t\t\t\"uniform sampler2D occlusionMap;\",\r\n\t\t\t\t\t\t\"uniform float opacity;\",\r\n\t\t\t\t\t\t\"uniform vec3 color;\",\r\n\t\r\n\t\t\t\t\t\t\"varying vec2 vUV;\",\r\n\t\r\n\t\t\t\t\t\t\"void main() {\",\r\n\t\r\n\t\t\t\t\t\t\t// pink square\r\n\t\r\n\t\t\t\t\t\t\t\"if ( renderType == 0 ) {\",\r\n\t\r\n\t\t\t\t\t\t\t\t\"gl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );\",\r\n\t\r\n\t\t\t\t\t\t\t// restore\r\n\t\r\n\t\t\t\t\t\t\t\"} else if ( renderType == 1 ) {\",\r\n\t\r\n\t\t\t\t\t\t\t\t\"gl_FragColor = texture2D( map, vUV );\",\r\n\t\r\n\t\t\t\t\t\t\t// flare\r\n\t\r\n\t\t\t\t\t\t\t\"} else {\",\r\n\t\r\n\t\t\t\t\t\t\t\t\"float visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a;\",\r\n\t\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a;\",\r\n\t\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a;\",\r\n\t\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;\",\r\n\t\t\t\t\t\t\t\t\"visibility = ( 1.0 - visibility / 4.0 );\",\r\n\t\r\n\t\t\t\t\t\t\t\t\"vec4 texture = texture2D( map, vUV );\",\r\n\t\t\t\t\t\t\t\t\"texture.a *= opacity * visibility;\",\r\n\t\t\t\t\t\t\t\t\"gl_FragColor = texture;\",\r\n\t\t\t\t\t\t\t\t\"gl_FragColor.rgb *= color;\",\r\n\t\r\n\t\t\t\t\t\t\t\"}\",\r\n\t\r\n\t\t\t\t\t\t\"}\"\r\n\t\r\n\t\t\t\t\t].join( \"\\n\" )\r\n\t\r\n\t\t\t\t};\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tprogram = createProgram( shader );\r\n\t\r\n\t\t\tattributes = {\r\n\t\t\t\tvertex: gl.getAttribLocation ( program, \"position\" ),\r\n\t\t\t\tuv:     gl.getAttribLocation ( program, \"uv\" )\r\n\t\t\t};\r\n\t\r\n\t\t\tuniforms = {\r\n\t\t\t\trenderType:     gl.getUniformLocation( program, \"renderType\" ),\r\n\t\t\t\tmap:            gl.getUniformLocation( program, \"map\" ),\r\n\t\t\t\tocclusionMap:   gl.getUniformLocation( program, \"occlusionMap\" ),\r\n\t\t\t\topacity:        gl.getUniformLocation( program, \"opacity\" ),\r\n\t\t\t\tcolor:          gl.getUniformLocation( program, \"color\" ),\r\n\t\t\t\tscale:          gl.getUniformLocation( program, \"scale\" ),\r\n\t\t\t\trotation:       gl.getUniformLocation( program, \"rotation\" ),\r\n\t\t\t\tscreenPosition: gl.getUniformLocation( program, \"screenPosition\" )\r\n\t\t\t};\r\n\t\r\n\t\t}\r\n\t\r\n\t\t/*\r\n\t\t * Render lens flares\r\n\t\t * Method: renders 16x16 0xff00ff-colored points scattered over the light source area,\r\n\t\t *         reads these back and calculates occlusion.\r\n\t\t */\r\n\t\r\n\t\tthis.render = function ( scene, camera, viewportWidth, viewportHeight ) {\r\n\t\r\n\t\t\tif ( flares.length === 0 ) return;\r\n\t\r\n\t\t\tvar tempPosition = new THREE.Vector3();\r\n\t\r\n\t\t\tvar invAspect = viewportHeight / viewportWidth,\r\n\t\t\t\thalfViewportWidth = viewportWidth * 0.5,\r\n\t\t\t\thalfViewportHeight = viewportHeight * 0.5;\r\n\t\r\n\t\t\tvar size = 16 / viewportHeight,\r\n\t\t\t\tscale = new THREE.Vector2( size * invAspect, size );\r\n\t\r\n\t\t\tvar screenPosition = new THREE.Vector3( 1, 1, 0 ),\r\n\t\t\t\tscreenPositionPixels = new THREE.Vector2( 1, 1 );\r\n\t\r\n\t\t\tif ( program === undefined ) {\r\n\t\r\n\t\t\t\tinit();\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tgl.useProgram( program );\r\n\t\r\n\t\t\tstate.initAttributes();\r\n\t\t\tstate.enableAttribute( attributes.vertex );\r\n\t\t\tstate.enableAttribute( attributes.uv );\r\n\t\t\tstate.disableUnusedAttributes();\r\n\t\r\n\t\t\t// loop through all lens flares to update their occlusion and positions\r\n\t\t\t// setup gl and common used attribs/uniforms\r\n\t\r\n\t\t\tgl.uniform1i( uniforms.occlusionMap, 0 );\r\n\t\t\tgl.uniform1i( uniforms.map, 1 );\r\n\t\r\n\t\t\tgl.bindBuffer( gl.ARRAY_BUFFER, vertexBuffer );\r\n\t\t\tgl.vertexAttribPointer( attributes.vertex, 2, gl.FLOAT, false, 2 * 8, 0 );\r\n\t\t\tgl.vertexAttribPointer( attributes.uv, 2, gl.FLOAT, false, 2 * 8, 8 );\r\n\t\r\n\t\t\tgl.bindBuffer( gl.ELEMENT_ARRAY_BUFFER, elementBuffer );\r\n\t\r\n\t\t\tstate.disable( gl.CULL_FACE );\r\n\t\t\tgl.depthMask( false );\r\n\t\r\n\t\t\tfor ( var i = 0, l = flares.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\tsize = 16 / viewportHeight;\r\n\t\t\t\tscale.set( size * invAspect, size );\r\n\t\r\n\t\t\t\t// calc object screen position\r\n\t\r\n\t\t\t\tvar flare = flares[ i ];\r\n\t\r\n\t\t\t\ttempPosition.set( flare.matrixWorld.elements[ 12 ], flare.matrixWorld.elements[ 13 ], flare.matrixWorld.elements[ 14 ] );\r\n\t\r\n\t\t\t\ttempPosition.applyMatrix4( camera.matrixWorldInverse );\r\n\t\t\t\ttempPosition.applyProjection( camera.projectionMatrix );\r\n\t\r\n\t\t\t\t// setup arrays for gl programs\r\n\t\r\n\t\t\t\tscreenPosition.copy( tempPosition );\r\n\t\r\n\t\t\t\tscreenPositionPixels.x = screenPosition.x * halfViewportWidth + halfViewportWidth;\r\n\t\t\t\tscreenPositionPixels.y = screenPosition.y * halfViewportHeight + halfViewportHeight;\r\n\t\r\n\t\t\t\t// screen cull\r\n\t\r\n\t\t\t\tif ( hasVertexTexture || (\r\n\t\t\t\t\tscreenPositionPixels.x > 0 &&\r\n\t\t\t\t\tscreenPositionPixels.x < viewportWidth &&\r\n\t\t\t\t\tscreenPositionPixels.y > 0 &&\r\n\t\t\t\t\tscreenPositionPixels.y < viewportHeight ) ) {\r\n\t\r\n\t\t\t\t\t// save current RGB to temp texture\r\n\t\r\n\t\t\t\t\tstate.activeTexture( gl.TEXTURE0 );\r\n\t\t\t\t\tstate.bindTexture( gl.TEXTURE_2D, null );\r\n\t\t\t\t\tstate.activeTexture( gl.TEXTURE1 );\r\n\t\t\t\t\tstate.bindTexture( gl.TEXTURE_2D, tempTexture );\r\n\t\t\t\t\tgl.copyTexImage2D( gl.TEXTURE_2D, 0, gl.RGB, screenPositionPixels.x - 8, screenPositionPixels.y - 8, 16, 16, 0 );\r\n\t\r\n\t\r\n\t\t\t\t\t// render pink quad\r\n\t\r\n\t\t\t\t\tgl.uniform1i( uniforms.renderType, 0 );\r\n\t\t\t\t\tgl.uniform2f( uniforms.scale, scale.x, scale.y );\r\n\t\t\t\t\tgl.uniform3f( uniforms.screenPosition, screenPosition.x, screenPosition.y, screenPosition.z );\r\n\t\r\n\t\t\t\t\tstate.disable( gl.BLEND );\r\n\t\t\t\t\tstate.enable( gl.DEPTH_TEST );\r\n\t\r\n\t\t\t\t\tgl.drawElements( gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0 );\r\n\t\r\n\t\r\n\t\t\t\t\t// copy result to occlusionMap\r\n\t\r\n\t\t\t\t\tstate.activeTexture( gl.TEXTURE0 );\r\n\t\t\t\t\tstate.bindTexture( gl.TEXTURE_2D, occlusionTexture );\r\n\t\t\t\t\tgl.copyTexImage2D( gl.TEXTURE_2D, 0, gl.RGBA, screenPositionPixels.x - 8, screenPositionPixels.y - 8, 16, 16, 0 );\r\n\t\r\n\t\r\n\t\t\t\t\t// restore graphics\r\n\t\r\n\t\t\t\t\tgl.uniform1i( uniforms.renderType, 1 );\r\n\t\t\t\t\tstate.disable( gl.DEPTH_TEST );\r\n\t\r\n\t\t\t\t\tstate.activeTexture( gl.TEXTURE1 );\r\n\t\t\t\t\tstate.bindTexture( gl.TEXTURE_2D, tempTexture );\r\n\t\t\t\t\tgl.drawElements( gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0 );\r\n\t\r\n\t\r\n\t\t\t\t\t// update object positions\r\n\t\r\n\t\t\t\t\tflare.positionScreen.copy( screenPosition );\r\n\t\r\n\t\t\t\t\tif ( flare.customUpdateCallback ) {\r\n\t\r\n\t\t\t\t\t\tflare.customUpdateCallback( flare );\r\n\t\r\n\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\tflare.updateLensFlares();\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t// render flares\r\n\t\r\n\t\t\t\t\tgl.uniform1i( uniforms.renderType, 2 );\r\n\t\t\t\t\tstate.enable( gl.BLEND );\r\n\t\r\n\t\t\t\t\tfor ( var j = 0, jl = flare.lensFlares.length; j < jl; j ++ ) {\r\n\t\r\n\t\t\t\t\t\tvar sprite = flare.lensFlares[ j ];\r\n\t\r\n\t\t\t\t\t\tif ( sprite.opacity > 0.001 && sprite.scale > 0.001 ) {\r\n\t\r\n\t\t\t\t\t\t\tscreenPosition.x = sprite.x;\r\n\t\t\t\t\t\t\tscreenPosition.y = sprite.y;\r\n\t\t\t\t\t\t\tscreenPosition.z = sprite.z;\r\n\t\r\n\t\t\t\t\t\t\tsize = sprite.size * sprite.scale / viewportHeight;\r\n\t\r\n\t\t\t\t\t\t\tscale.x = size * invAspect;\r\n\t\t\t\t\t\t\tscale.y = size;\r\n\t\r\n\t\t\t\t\t\t\tgl.uniform3f( uniforms.screenPosition, screenPosition.x, screenPosition.y, screenPosition.z );\r\n\t\t\t\t\t\t\tgl.uniform2f( uniforms.scale, scale.x, scale.y );\r\n\t\t\t\t\t\t\tgl.uniform1f( uniforms.rotation, sprite.rotation );\r\n\t\r\n\t\t\t\t\t\t\tgl.uniform1f( uniforms.opacity, sprite.opacity );\r\n\t\t\t\t\t\t\tgl.uniform3f( uniforms.color, sprite.color.r, sprite.color.g, sprite.color.b );\r\n\t\r\n\t\t\t\t\t\t\tstate.setBlending( sprite.blending, sprite.blendEquation, sprite.blendSrc, sprite.blendDst );\r\n\t\t\t\t\t\t\trenderer.setTexture( sprite.texture, 1 );\r\n\t\r\n\t\t\t\t\t\t\tgl.drawElements( gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0 );\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// restore gl\r\n\t\r\n\t\t\tstate.enable( gl.CULL_FACE );\r\n\t\t\tstate.enable( gl.DEPTH_TEST );\r\n\t\t\tgl.depthMask( true );\r\n\t\r\n\t\t\trenderer.resetGLState();\r\n\t\r\n\t\t};\r\n\t\r\n\t\tfunction createProgram ( shader ) {\r\n\t\r\n\t\t\tvar program = gl.createProgram();\r\n\t\r\n\t\t\tvar fragmentShader = gl.createShader( gl.FRAGMENT_SHADER );\r\n\t\t\tvar vertexShader = gl.createShader( gl.VERTEX_SHADER );\r\n\t\r\n\t\t\tvar prefix = \"precision \" + renderer.getPrecision() + \" float;\\n\";\r\n\t\r\n\t\t\tgl.shaderSource( fragmentShader, prefix + shader.fragmentShader );\r\n\t\t\tgl.shaderSource( vertexShader, prefix + shader.vertexShader );\r\n\t\r\n\t\t\tgl.compileShader( fragmentShader );\r\n\t\t\tgl.compileShader( vertexShader );\r\n\t\r\n\t\t\tgl.attachShader( program, fragmentShader );\r\n\t\t\tgl.attachShader( program, vertexShader );\r\n\t\r\n\t\t\tgl.linkProgram( program );\r\n\t\r\n\t\t\treturn program;\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/renderers/webgl/plugins/SpritePlugin.js\r\n\t\r\n\t/**\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\t\r\n\tTHREE.SpritePlugin = function ( renderer, sprites ) {\r\n\t\r\n\t\tvar gl = renderer.context;\r\n\t\tvar state = renderer.state;\r\n\t\r\n\t\tvar vertexBuffer, elementBuffer;\r\n\t\tvar program, attributes, uniforms;\r\n\t\r\n\t\tvar texture;\r\n\t\r\n\t\t// decompose matrixWorld\r\n\t\r\n\t\tvar spritePosition = new THREE.Vector3();\r\n\t\tvar spriteRotation = new THREE.Quaternion();\r\n\t\tvar spriteScale = new THREE.Vector3();\r\n\t\r\n\t\tfunction init() {\r\n\t\r\n\t\t\tvar vertices = new Float32Array( [\r\n\t\t\t\t- 0.5, - 0.5,  0, 0,\r\n\t\t\t\t  0.5, - 0.5,  1, 0,\r\n\t\t\t\t  0.5,   0.5,  1, 1,\r\n\t\t\t\t- 0.5,   0.5,  0, 1\r\n\t\t\t] );\r\n\t\r\n\t\t\tvar faces = new Uint16Array( [\r\n\t\t\t\t0, 1, 2,\r\n\t\t\t\t0, 2, 3\r\n\t\t\t] );\r\n\t\r\n\t\t\tvertexBuffer  = gl.createBuffer();\r\n\t\t\telementBuffer = gl.createBuffer();\r\n\t\r\n\t\t\tgl.bindBuffer( gl.ARRAY_BUFFER, vertexBuffer );\r\n\t\t\tgl.bufferData( gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW );\r\n\t\r\n\t\t\tgl.bindBuffer( gl.ELEMENT_ARRAY_BUFFER, elementBuffer );\r\n\t\t\tgl.bufferData( gl.ELEMENT_ARRAY_BUFFER, faces, gl.STATIC_DRAW );\r\n\t\r\n\t\t\tprogram = createProgram();\r\n\t\r\n\t\t\tattributes = {\r\n\t\t\t\tposition:\t\t\tgl.getAttribLocation ( program, 'position' ),\r\n\t\t\t\tuv:\t\t\t\t\tgl.getAttribLocation ( program, 'uv' )\r\n\t\t\t};\r\n\t\r\n\t\t\tuniforms = {\r\n\t\t\t\tuvOffset:\t\t\tgl.getUniformLocation( program, 'uvOffset' ),\r\n\t\t\t\tuvScale:\t\t\tgl.getUniformLocation( program, 'uvScale' ),\r\n\t\r\n\t\t\t\trotation:\t\t\tgl.getUniformLocation( program, 'rotation' ),\r\n\t\t\t\tscale:\t\t\t\tgl.getUniformLocation( program, 'scale' ),\r\n\t\r\n\t\t\t\tcolor:\t\t\t\tgl.getUniformLocation( program, 'color' ),\r\n\t\t\t\tmap:\t\t\t\tgl.getUniformLocation( program, 'map' ),\r\n\t\t\t\topacity:\t\t\tgl.getUniformLocation( program, 'opacity' ),\r\n\t\r\n\t\t\t\tmodelViewMatrix: \tgl.getUniformLocation( program, 'modelViewMatrix' ),\r\n\t\t\t\tprojectionMatrix:\tgl.getUniformLocation( program, 'projectionMatrix' ),\r\n\t\r\n\t\t\t\tfogType:\t\t\tgl.getUniformLocation( program, 'fogType' ),\r\n\t\t\t\tfogDensity:\t\t\tgl.getUniformLocation( program, 'fogDensity' ),\r\n\t\t\t\tfogNear:\t\t\tgl.getUniformLocation( program, 'fogNear' ),\r\n\t\t\t\tfogFar:\t\t\t\tgl.getUniformLocation( program, 'fogFar' ),\r\n\t\t\t\tfogColor:\t\t\tgl.getUniformLocation( program, 'fogColor' ),\r\n\t\r\n\t\t\t\talphaTest:\t\t\tgl.getUniformLocation( program, 'alphaTest' )\r\n\t\t\t};\r\n\t\r\n\t\t\tvar canvas = document.createElement( 'canvas' );\r\n\t\t\tcanvas.width = 8;\r\n\t\t\tcanvas.height = 8;\r\n\t\r\n\t\t\tvar context = canvas.getContext( '2d' );\r\n\t\t\tcontext.fillStyle = 'white';\r\n\t\t\tcontext.fillRect( 0, 0, 8, 8 );\r\n\t\r\n\t\t\ttexture = new THREE.Texture( canvas );\r\n\t\t\ttexture.needsUpdate = true;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tthis.render = function ( scene, camera ) {\r\n\t\r\n\t\t\tif ( sprites.length === 0 ) return;\r\n\t\r\n\t\t\t// setup gl\r\n\t\r\n\t\t\tif ( program === undefined ) {\r\n\t\r\n\t\t\t\tinit();\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tgl.useProgram( program );\r\n\t\r\n\t\t\tstate.initAttributes();\r\n\t\t\tstate.enableAttribute( attributes.position );\r\n\t\t\tstate.enableAttribute( attributes.uv );\r\n\t\t\tstate.disableUnusedAttributes();\r\n\t\r\n\t\t\tstate.disable( gl.CULL_FACE );\r\n\t\t\tstate.enable( gl.BLEND );\r\n\t\r\n\t\t\tgl.bindBuffer( gl.ARRAY_BUFFER, vertexBuffer );\r\n\t\t\tgl.vertexAttribPointer( attributes.position, 2, gl.FLOAT, false, 2 * 8, 0 );\r\n\t\t\tgl.vertexAttribPointer( attributes.uv, 2, gl.FLOAT, false, 2 * 8, 8 );\r\n\t\r\n\t\t\tgl.bindBuffer( gl.ELEMENT_ARRAY_BUFFER, elementBuffer );\r\n\t\r\n\t\t\tgl.uniformMatrix4fv( uniforms.projectionMatrix, false, camera.projectionMatrix.elements );\r\n\t\r\n\t\t\tstate.activeTexture( gl.TEXTURE0 );\r\n\t\t\tgl.uniform1i( uniforms.map, 0 );\r\n\t\r\n\t\t\tvar oldFogType = 0;\r\n\t\t\tvar sceneFogType = 0;\r\n\t\t\tvar fog = scene.fog;\r\n\t\r\n\t\t\tif ( fog ) {\r\n\t\r\n\t\t\t\tgl.uniform3f( uniforms.fogColor, fog.color.r, fog.color.g, fog.color.b );\r\n\t\r\n\t\t\t\tif ( fog instanceof THREE.Fog ) {\r\n\t\r\n\t\t\t\t\tgl.uniform1f( uniforms.fogNear, fog.near );\r\n\t\t\t\t\tgl.uniform1f( uniforms.fogFar, fog.far );\r\n\t\r\n\t\t\t\t\tgl.uniform1i( uniforms.fogType, 1 );\r\n\t\t\t\t\toldFogType = 1;\r\n\t\t\t\t\tsceneFogType = 1;\r\n\t\r\n\t\t\t\t} else if ( fog instanceof THREE.FogExp2 ) {\r\n\t\r\n\t\t\t\t\tgl.uniform1f( uniforms.fogDensity, fog.density );\r\n\t\r\n\t\t\t\t\tgl.uniform1i( uniforms.fogType, 2 );\r\n\t\t\t\t\toldFogType = 2;\r\n\t\t\t\t\tsceneFogType = 2;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\tgl.uniform1i( uniforms.fogType, 0 );\r\n\t\t\t\toldFogType = 0;\r\n\t\t\t\tsceneFogType = 0;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\r\n\t\t\t// update positions and sort\r\n\t\r\n\t\t\tfor ( var i = 0, l = sprites.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\tvar sprite = sprites[ i ];\r\n\t\r\n\t\t\t\tsprite.modelViewMatrix.multiplyMatrices( camera.matrixWorldInverse, sprite.matrixWorld );\r\n\t\t\t\tsprite.z = - sprite.modelViewMatrix.elements[ 14 ];\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tsprites.sort( painterSortStable );\r\n\t\r\n\t\t\t// render all sprites\r\n\t\r\n\t\t\tvar scale = [];\r\n\t\r\n\t\t\tfor ( var i = 0, l = sprites.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\tvar sprite = sprites[ i ];\r\n\t\t\t\tvar material = sprite.material;\r\n\t\r\n\t\t\t\tgl.uniform1f( uniforms.alphaTest, material.alphaTest );\r\n\t\t\t\tgl.uniformMatrix4fv( uniforms.modelViewMatrix, false, sprite.modelViewMatrix.elements );\r\n\t\r\n\t\t\t\tsprite.matrixWorld.decompose( spritePosition, spriteRotation, spriteScale );\r\n\t\r\n\t\t\t\tscale[ 0 ] = spriteScale.x;\r\n\t\t\t\tscale[ 1 ] = spriteScale.y;\r\n\t\r\n\t\t\t\tvar fogType = 0;\r\n\t\r\n\t\t\t\tif ( scene.fog && material.fog ) {\r\n\t\r\n\t\t\t\t\tfogType = sceneFogType;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( oldFogType !== fogType ) {\r\n\t\r\n\t\t\t\t\tgl.uniform1i( uniforms.fogType, fogType );\r\n\t\t\t\t\toldFogType = fogType;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( material.map !== null ) {\r\n\t\r\n\t\t\t\t\tgl.uniform2f( uniforms.uvOffset, material.map.offset.x, material.map.offset.y );\r\n\t\t\t\t\tgl.uniform2f( uniforms.uvScale, material.map.repeat.x, material.map.repeat.y );\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tgl.uniform2f( uniforms.uvOffset, 0, 0 );\r\n\t\t\t\t\tgl.uniform2f( uniforms.uvScale, 1, 1 );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tgl.uniform1f( uniforms.opacity, material.opacity );\r\n\t\t\t\tgl.uniform3f( uniforms.color, material.color.r, material.color.g, material.color.b );\r\n\t\r\n\t\t\t\tgl.uniform1f( uniforms.rotation, material.rotation );\r\n\t\t\t\tgl.uniform2fv( uniforms.scale, scale );\r\n\t\r\n\t\t\t\tstate.setBlending( material.blending, material.blendEquation, material.blendSrc, material.blendDst );\r\n\t\t\t\tstate.setDepthTest( material.depthTest );\r\n\t\t\t\tstate.setDepthWrite( material.depthWrite );\r\n\t\r\n\t\t\t\tif ( material.map && material.map.image && material.map.image.width ) {\r\n\t\r\n\t\t\t\t\trenderer.setTexture( material.map, 0 );\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\trenderer.setTexture( texture, 0 );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tgl.drawElements( gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0 );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// restore gl\r\n\t\r\n\t\t\tstate.enable( gl.CULL_FACE );\r\n\t\r\n\t\t\trenderer.resetGLState();\r\n\t\r\n\t\t};\r\n\t\r\n\t\tfunction createProgram () {\r\n\t\r\n\t\t\tvar program = gl.createProgram();\r\n\t\r\n\t\t\tvar vertexShader = gl.createShader( gl.VERTEX_SHADER );\r\n\t\t\tvar fragmentShader = gl.createShader( gl.FRAGMENT_SHADER );\r\n\t\r\n\t\t\tgl.shaderSource( vertexShader, [\r\n\t\r\n\t\t\t\t'precision ' + renderer.getPrecision() + ' float;',\r\n\t\r\n\t\t\t\t'uniform mat4 modelViewMatrix;',\r\n\t\t\t\t'uniform mat4 projectionMatrix;',\r\n\t\t\t\t'uniform float rotation;',\r\n\t\t\t\t'uniform vec2 scale;',\r\n\t\t\t\t'uniform vec2 uvOffset;',\r\n\t\t\t\t'uniform vec2 uvScale;',\r\n\t\r\n\t\t\t\t'attribute vec2 position;',\r\n\t\t\t\t'attribute vec2 uv;',\r\n\t\r\n\t\t\t\t'varying vec2 vUV;',\r\n\t\r\n\t\t\t\t'void main() {',\r\n\t\r\n\t\t\t\t\t'vUV = uvOffset + uv * uvScale;',\r\n\t\r\n\t\t\t\t\t'vec2 alignedPosition = position * scale;',\r\n\t\r\n\t\t\t\t\t'vec2 rotatedPosition;',\r\n\t\t\t\t\t'rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;',\r\n\t\t\t\t\t'rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;',\r\n\t\r\n\t\t\t\t\t'vec4 finalPosition;',\r\n\t\r\n\t\t\t\t\t'finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );',\r\n\t\t\t\t\t'finalPosition.xy += rotatedPosition;',\r\n\t\t\t\t\t'finalPosition = projectionMatrix * finalPosition;',\r\n\t\r\n\t\t\t\t\t'gl_Position = finalPosition;',\r\n\t\r\n\t\t\t\t'}'\r\n\t\r\n\t\t\t].join( '\\n' ) );\r\n\t\r\n\t\t\tgl.shaderSource( fragmentShader, [\r\n\t\r\n\t\t\t\t'precision ' + renderer.getPrecision() + ' float;',\r\n\t\r\n\t\t\t\t'uniform vec3 color;',\r\n\t\t\t\t'uniform sampler2D map;',\r\n\t\t\t\t'uniform float opacity;',\r\n\t\r\n\t\t\t\t'uniform int fogType;',\r\n\t\t\t\t'uniform vec3 fogColor;',\r\n\t\t\t\t'uniform float fogDensity;',\r\n\t\t\t\t'uniform float fogNear;',\r\n\t\t\t\t'uniform float fogFar;',\r\n\t\t\t\t'uniform float alphaTest;',\r\n\t\r\n\t\t\t\t'varying vec2 vUV;',\r\n\t\r\n\t\t\t\t'void main() {',\r\n\t\r\n\t\t\t\t\t'vec4 texture = texture2D( map, vUV );',\r\n\t\r\n\t\t\t\t\t'if ( texture.a < alphaTest ) discard;',\r\n\t\r\n\t\t\t\t\t'gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );',\r\n\t\r\n\t\t\t\t\t'if ( fogType > 0 ) {',\r\n\t\r\n\t\t\t\t\t\t'float depth = gl_FragCoord.z / gl_FragCoord.w;',\r\n\t\t\t\t\t\t'float fogFactor = 0.0;',\r\n\t\r\n\t\t\t\t\t\t'if ( fogType == 1 ) {',\r\n\t\r\n\t\t\t\t\t\t\t'fogFactor = smoothstep( fogNear, fogFar, depth );',\r\n\t\r\n\t\t\t\t\t\t'} else {',\r\n\t\r\n\t\t\t\t\t\t\t'const float LOG2 = 1.442695;',\r\n\t\t\t\t\t\t\t'fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );',\r\n\t\t\t\t\t\t\t'fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );',\r\n\t\r\n\t\t\t\t\t\t'}',\r\n\t\r\n\t\t\t\t\t\t'gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );',\r\n\t\r\n\t\t\t\t\t'}',\r\n\t\r\n\t\t\t\t'}'\r\n\t\r\n\t\t\t].join( '\\n' ) );\r\n\t\r\n\t\t\tgl.compileShader( vertexShader );\r\n\t\t\tgl.compileShader( fragmentShader );\r\n\t\r\n\t\t\tgl.attachShader( program, vertexShader );\r\n\t\t\tgl.attachShader( program, fragmentShader );\r\n\t\r\n\t\t\tgl.linkProgram( program );\r\n\t\r\n\t\t\treturn program;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction painterSortStable ( a, b ) {\r\n\t\r\n\t\t\tif ( a.z !== b.z ) {\r\n\t\r\n\t\t\t\treturn b.z - a.z;\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\treturn b.id - a.id;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/extras/CurveUtils.js\r\n\t\r\n\t/**\r\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\r\n\t */\r\n\t\r\n\tTHREE.CurveUtils = {\r\n\t\r\n\t\ttangentQuadraticBezier: function ( t, p0, p1, p2 ) {\r\n\t\r\n\t\t\treturn 2 * ( 1 - t ) * ( p1 - p0 ) + 2 * t * ( p2 - p1 );\r\n\t\r\n\t\t},\r\n\t\r\n\t\t// Puay Bing, thanks for helping with this derivative!\r\n\t\r\n\t\ttangentCubicBezier: function ( t, p0, p1, p2, p3 ) {\r\n\t\r\n\t\t\treturn - 3 * p0 * ( 1 - t ) * ( 1 - t )  +\r\n\t\t\t\t3 * p1 * ( 1 - t ) * ( 1 - t ) - 6 * t * p1 * ( 1 - t ) +\r\n\t\t\t\t6 * t *  p2 * ( 1 - t ) - 3 * t * t * p2 +\r\n\t\t\t\t3 * t * t * p3;\r\n\t\r\n\t\t},\r\n\t\r\n\t\ttangentSpline: function ( t, p0, p1, p2, p3 ) {\r\n\t\r\n\t\t\t// To check if my formulas are correct\r\n\t\r\n\t\t\tvar h00 = 6 * t * t - 6 * t; \t// derived from 2t^3  3t^2 + 1\r\n\t\t\tvar h10 = 3 * t * t - 4 * t + 1; // t^3  2t^2 + t\r\n\t\t\tvar h01 = - 6 * t * t + 6 * t; \t//  2t3 + 3t2\r\n\t\t\tvar h11 = 3 * t * t - 2 * t;\t// t3  t2\r\n\t\r\n\t\t\treturn h00 + h10 + h01 + h11;\r\n\t\r\n\t\t},\r\n\t\r\n\t\t// Catmull-Rom\r\n\t\r\n\t\tinterpolate: function( p0, p1, p2, p3, t ) {\r\n\t\r\n\t\t\tvar v0 = ( p2 - p0 ) * 0.5;\r\n\t\t\tvar v1 = ( p3 - p1 ) * 0.5;\r\n\t\t\tvar t2 = t * t;\r\n\t\t\tvar t3 = t * t2;\r\n\t\t\treturn ( 2 * p1 - 2 * p2 + v0 + v1 ) * t3 + ( - 3 * p1 + 3 * p2 - 2 * v0 - v1 ) * t2 + v0 * t + p1;\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/extras/GeometryUtils.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.GeometryUtils = {\r\n\t\r\n\t\tmerge: function ( geometry1, geometry2, materialIndexOffset ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.' );\r\n\t\r\n\t\t\tvar matrix;\r\n\t\r\n\t\t\tif ( geometry2 instanceof THREE.Mesh ) {\r\n\t\r\n\t\t\t\tgeometry2.matrixAutoUpdate && geometry2.updateMatrix();\r\n\t\r\n\t\t\t\tmatrix = geometry2.matrix;\r\n\t\t\t\tgeometry2 = geometry2.geometry;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tgeometry1.merge( geometry2, matrix, materialIndexOffset );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tcenter: function ( geometry ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead.' );\r\n\t\t\treturn geometry.center();\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/extras/ImageUtils.js\r\n\t\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author Daosheng Mu / https://github.com/DaoshengMu/\r\n\t */\r\n\t\r\n\tTHREE.ImageUtils = {\r\n\t\r\n\t\tcrossOrigin: undefined,\r\n\t\r\n\t\tloadTexture: function ( url, mapping, onLoad, onError ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.ImageUtils.loadTexture is being deprecated. Use THREE.TextureLoader() instead.' );\r\n\t\r\n\t\t\tvar loader = new THREE.TextureLoader();\r\n\t\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\t\r\n\t\t\tvar texture = loader.load( url, onLoad, undefined, onError );\r\n\t\r\n\t\t\tif ( mapping ) texture.mapping = mapping;\r\n\t\r\n\t\t\treturn texture;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tloadTextureCube: function ( urls, mapping, onLoad, onError ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.ImageUtils.loadTextureCube is being deprecated. Use THREE.CubeTextureLoader() instead.' );\r\n\t\r\n\t\t\tvar loader = new THREE.CubeTextureLoader();\r\n\t\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\t\r\n\t\t\tvar texture = loader.load( urls, onLoad, undefined, onError );\r\n\t\r\n\t\t\tif ( mapping ) texture.mapping = mapping;\r\n\t\r\n\t\t\treturn texture;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tloadCompressedTexture: function () {\r\n\t\r\n\t\t\tconsole.error( 'THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.' )\r\n\t\r\n\t\t},\r\n\t\r\n\t\tloadCompressedTextureCube: function () {\r\n\t\r\n\t\t\tconsole.error( 'THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.' )\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/extras/SceneUtils.js\r\n\t\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\t\r\n\tTHREE.SceneUtils = {\r\n\t\r\n\t\tcreateMultiMaterialObject: function ( geometry, materials ) {\r\n\t\r\n\t\t\tvar group = new THREE.Group();\r\n\t\r\n\t\t\tfor ( var i = 0, l = materials.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\tgroup.add( new THREE.Mesh( geometry, materials[ i ] ) );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn group;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tdetach: function ( child, parent, scene ) {\r\n\t\r\n\t\t\tchild.applyMatrix( parent.matrixWorld );\r\n\t\t\tparent.remove( child );\r\n\t\t\tscene.add( child );\r\n\t\r\n\t\t},\r\n\t\r\n\t\tattach: function ( child, scene, parent ) {\r\n\t\r\n\t\t\tvar matrixWorldInverse = new THREE.Matrix4();\r\n\t\t\tmatrixWorldInverse.getInverse( parent.matrixWorld );\r\n\t\t\tchild.applyMatrix( matrixWorldInverse );\r\n\t\r\n\t\t\tscene.remove( child );\r\n\t\t\tparent.add( child );\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/extras/ShapeUtils.js\r\n\t\r\n\t/**\r\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\r\n\t */\r\n\t\r\n\tTHREE.ShapeUtils = {\r\n\t\r\n\t\t// calculate area of the contour polygon\r\n\t\r\n\t\tarea: function ( contour ) {\r\n\t\r\n\t\t\tvar n = contour.length;\r\n\t\t\tvar a = 0.0;\r\n\t\r\n\t\t\tfor ( var p = n - 1, q = 0; q < n; p = q ++ ) {\r\n\t\r\n\t\t\t\ta += contour[ p ].x * contour[ q ].y - contour[ q ].x * contour[ p ].y;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn a * 0.5;\r\n\t\r\n\t\t},\r\n\t\r\n\t\ttriangulate: ( function () {\r\n\t\r\n\t\t\t/**\r\n\t\t\t * This code is a quick port of code written in C++ which was submitted to\r\n\t\t\t * flipcode.com by John W. Ratcliff  // July 22, 2000\r\n\t\t\t * See original code and more information here:\r\n\t\t\t * http://www.flipcode.com/archives/Efficient_Polygon_Triangulation.shtml\r\n\t\t\t *\r\n\t\t\t * ported to actionscript by Zevan Rosser\r\n\t\t\t * www.actionsnippet.com\r\n\t\t\t *\r\n\t\t\t * ported to javascript by Joshua Koo\r\n\t\t\t * http://www.lab4games.net/zz85/blog\r\n\t\t\t *\r\n\t\t\t */\r\n\t\r\n\t\t\tfunction snip( contour, u, v, w, n, verts ) {\r\n\t\r\n\t\t\t\tvar p;\r\n\t\t\t\tvar ax, ay, bx, by;\r\n\t\t\t\tvar cx, cy, px, py;\r\n\t\r\n\t\t\t\tax = contour[ verts[ u ] ].x;\r\n\t\t\t\tay = contour[ verts[ u ] ].y;\r\n\t\r\n\t\t\t\tbx = contour[ verts[ v ] ].x;\r\n\t\t\t\tby = contour[ verts[ v ] ].y;\r\n\t\r\n\t\t\t\tcx = contour[ verts[ w ] ].x;\r\n\t\t\t\tcy = contour[ verts[ w ] ].y;\r\n\t\r\n\t\t\t\tif ( Number.EPSILON > ( ( ( bx - ax ) * ( cy - ay ) ) - ( ( by - ay ) * ( cx - ax ) ) ) ) return false;\r\n\t\r\n\t\t\t\tvar aX, aY, bX, bY, cX, cY;\r\n\t\t\t\tvar apx, apy, bpx, bpy, cpx, cpy;\r\n\t\t\t\tvar cCROSSap, bCROSScp, aCROSSbp;\r\n\t\r\n\t\t\t\taX = cx - bx;  aY = cy - by;\r\n\t\t\t\tbX = ax - cx;  bY = ay - cy;\r\n\t\t\t\tcX = bx - ax;  cY = by - ay;\r\n\t\r\n\t\t\t\tfor ( p = 0; p < n; p ++ ) {\r\n\t\r\n\t\t\t\t\tpx = contour[ verts[ p ] ].x;\r\n\t\t\t\t\tpy = contour[ verts[ p ] ].y;\r\n\t\r\n\t\t\t\t\tif ( ( ( px === ax ) && ( py === ay ) ) ||\r\n\t\t\t\t\t\t ( ( px === bx ) && ( py === by ) ) ||\r\n\t\t\t\t\t\t ( ( px === cx ) && ( py === cy ) ) )\tcontinue;\r\n\t\r\n\t\t\t\t\tapx = px - ax;  apy = py - ay;\r\n\t\t\t\t\tbpx = px - bx;  bpy = py - by;\r\n\t\t\t\t\tcpx = px - cx;  cpy = py - cy;\r\n\t\r\n\t\t\t\t\t// see if p is inside triangle abc\r\n\t\r\n\t\t\t\t\taCROSSbp = aX * bpy - aY * bpx;\r\n\t\t\t\t\tcCROSSap = cX * apy - cY * apx;\r\n\t\t\t\t\tbCROSScp = bX * cpy - bY * cpx;\r\n\t\r\n\t\t\t\t\tif ( ( aCROSSbp >= - Number.EPSILON ) && ( bCROSScp >= - Number.EPSILON ) && ( cCROSSap >= - Number.EPSILON ) ) return false;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\treturn true;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// takes in an contour array and returns\r\n\t\r\n\t\t\treturn function ( contour, indices ) {\r\n\t\r\n\t\t\t\tvar n = contour.length;\r\n\t\r\n\t\t\t\tif ( n < 3 ) return null;\r\n\t\r\n\t\t\t\tvar result = [],\r\n\t\t\t\t\tverts = [],\r\n\t\t\t\t\tvertIndices = [];\r\n\t\r\n\t\t\t\t/* we want a counter-clockwise polygon in verts */\r\n\t\r\n\t\t\t\tvar u, v, w;\r\n\t\r\n\t\t\t\tif ( THREE.ShapeUtils.area( contour ) > 0.0 ) {\r\n\t\r\n\t\t\t\t\tfor ( v = 0; v < n; v ++ ) verts[ v ] = v;\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tfor ( v = 0; v < n; v ++ ) verts[ v ] = ( n - 1 ) - v;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tvar nv = n;\r\n\t\r\n\t\t\t\t/*  remove nv - 2 vertices, creating 1 triangle every time */\r\n\t\r\n\t\t\t\tvar count = 2 * nv;   /* error detection */\r\n\t\r\n\t\t\t\tfor ( v = nv - 1; nv > 2; ) {\r\n\t\r\n\t\t\t\t\t/* if we loop, it is probably a non-simple polygon */\r\n\t\r\n\t\t\t\t\tif ( ( count -- ) <= 0 ) {\r\n\t\r\n\t\t\t\t\t\t//** Triangulate: ERROR - probable bad polygon!\r\n\t\r\n\t\t\t\t\t\t//throw ( \"Warning, unable to triangulate polygon!\" );\r\n\t\t\t\t\t\t//return null;\r\n\t\t\t\t\t\t// Sometimes warning is fine, especially polygons are triangulated in reverse.\r\n\t\t\t\t\t\tconsole.warn( 'THREE.ShapeUtils: Unable to triangulate polygon! in triangulate()' );\r\n\t\r\n\t\t\t\t\t\tif ( indices ) return vertIndices;\r\n\t\t\t\t\t\treturn result;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t/* three consecutive vertices in current polygon, <u,v,w> */\r\n\t\r\n\t\t\t\t\tu = v; \t \tif ( nv <= u ) u = 0;     /* previous */\r\n\t\t\t\t\tv = u + 1;  if ( nv <= v ) v = 0;     /* new v    */\r\n\t\t\t\t\tw = v + 1;  if ( nv <= w ) w = 0;     /* next     */\r\n\t\r\n\t\t\t\t\tif ( snip( contour, u, v, w, nv, verts ) ) {\r\n\t\r\n\t\t\t\t\t\tvar a, b, c, s, t;\r\n\t\r\n\t\t\t\t\t\t/* true names of the vertices */\r\n\t\r\n\t\t\t\t\t\ta = verts[ u ];\r\n\t\t\t\t\t\tb = verts[ v ];\r\n\t\t\t\t\t\tc = verts[ w ];\r\n\t\r\n\t\t\t\t\t\t/* output Triangle */\r\n\t\r\n\t\t\t\t\t\tresult.push( [ contour[ a ],\r\n\t\t\t\t\t\t\tcontour[ b ],\r\n\t\t\t\t\t\t\tcontour[ c ] ] );\r\n\t\r\n\t\r\n\t\t\t\t\t\tvertIndices.push( [ verts[ u ], verts[ v ], verts[ w ] ] );\r\n\t\r\n\t\t\t\t\t\t/* remove v from the remaining polygon */\r\n\t\r\n\t\t\t\t\t\tfor ( s = v, t = v + 1; t < nv; s ++, t ++ ) {\r\n\t\r\n\t\t\t\t\t\t\tverts[ s ] = verts[ t ];\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\tnv --;\r\n\t\r\n\t\t\t\t\t\t/* reset error detection counter */\r\n\t\r\n\t\t\t\t\t\tcount = 2 * nv;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( indices ) return vertIndices;\r\n\t\t\t\treturn result;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t} )(),\r\n\t\r\n\t\ttriangulateShape: function ( contour, holes ) {\r\n\t\r\n\t\t\tfunction point_in_segment_2D_colin( inSegPt1, inSegPt2, inOtherPt ) {\r\n\t\r\n\t\t\t\t// inOtherPt needs to be collinear to the inSegment\r\n\t\t\t\tif ( inSegPt1.x !== inSegPt2.x ) {\r\n\t\r\n\t\t\t\t\tif ( inSegPt1.x < inSegPt2.x ) {\r\n\t\r\n\t\t\t\t\t\treturn\t( ( inSegPt1.x <= inOtherPt.x ) && ( inOtherPt.x <= inSegPt2.x ) );\r\n\t\r\n\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\treturn\t( ( inSegPt2.x <= inOtherPt.x ) && ( inOtherPt.x <= inSegPt1.x ) );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tif ( inSegPt1.y < inSegPt2.y ) {\r\n\t\r\n\t\t\t\t\t\treturn\t( ( inSegPt1.y <= inOtherPt.y ) && ( inOtherPt.y <= inSegPt2.y ) );\r\n\t\r\n\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\treturn\t( ( inSegPt2.y <= inOtherPt.y ) && ( inOtherPt.y <= inSegPt1.y ) );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tfunction intersect_segments_2D( inSeg1Pt1, inSeg1Pt2, inSeg2Pt1, inSeg2Pt2, inExcludeAdjacentSegs ) {\r\n\t\r\n\t\t\t\tvar seg1dx = inSeg1Pt2.x - inSeg1Pt1.x,   seg1dy = inSeg1Pt2.y - inSeg1Pt1.y;\r\n\t\t\t\tvar seg2dx = inSeg2Pt2.x - inSeg2Pt1.x,   seg2dy = inSeg2Pt2.y - inSeg2Pt1.y;\r\n\t\r\n\t\t\t\tvar seg1seg2dx = inSeg1Pt1.x - inSeg2Pt1.x;\r\n\t\t\t\tvar seg1seg2dy = inSeg1Pt1.y - inSeg2Pt1.y;\r\n\t\r\n\t\t\t\tvar limit\t\t= seg1dy * seg2dx - seg1dx * seg2dy;\r\n\t\t\t\tvar perpSeg1\t= seg1dy * seg1seg2dx - seg1dx * seg1seg2dy;\r\n\t\r\n\t\t\t\tif ( Math.abs( limit ) > Number.EPSILON ) {\r\n\t\r\n\t\t\t\t\t// not parallel\r\n\t\r\n\t\t\t\t\tvar perpSeg2;\r\n\t\t\t\t\tif ( limit > 0 ) {\r\n\t\r\n\t\t\t\t\t\tif ( ( perpSeg1 < 0 ) || ( perpSeg1 > limit ) ) \t\treturn [];\r\n\t\t\t\t\t\tperpSeg2 = seg2dy * seg1seg2dx - seg2dx * seg1seg2dy;\r\n\t\t\t\t\t\tif ( ( perpSeg2 < 0 ) || ( perpSeg2 > limit ) ) \t\treturn [];\r\n\t\r\n\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\tif ( ( perpSeg1 > 0 ) || ( perpSeg1 < limit ) ) \t\treturn [];\r\n\t\t\t\t\t\tperpSeg2 = seg2dy * seg1seg2dx - seg2dx * seg1seg2dy;\r\n\t\t\t\t\t\tif ( ( perpSeg2 > 0 ) || ( perpSeg2 < limit ) ) \t\treturn [];\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t// i.e. to reduce rounding errors\r\n\t\t\t\t\t// intersection at endpoint of segment#1?\r\n\t\t\t\t\tif ( perpSeg2 === 0 ) {\r\n\t\r\n\t\t\t\t\t\tif ( ( inExcludeAdjacentSegs ) &&\r\n\t\t\t\t\t\t\t ( ( perpSeg1 === 0 ) || ( perpSeg1 === limit ) ) )\t\treturn [];\r\n\t\t\t\t\t\treturn [ inSeg1Pt1 ];\r\n\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( perpSeg2 === limit ) {\r\n\t\r\n\t\t\t\t\t\tif ( ( inExcludeAdjacentSegs ) &&\r\n\t\t\t\t\t\t\t ( ( perpSeg1 === 0 ) || ( perpSeg1 === limit ) ) )\t\treturn [];\r\n\t\t\t\t\t\treturn [ inSeg1Pt2 ];\r\n\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// intersection at endpoint of segment#2?\r\n\t\t\t\t\tif ( perpSeg1 === 0 )\t\treturn [ inSeg2Pt1 ];\r\n\t\t\t\t\tif ( perpSeg1 === limit )\treturn [ inSeg2Pt2 ];\r\n\t\r\n\t\t\t\t\t// return real intersection point\r\n\t\t\t\t\tvar factorSeg1 = perpSeg2 / limit;\r\n\t\t\t\t\treturn\t[ { x: inSeg1Pt1.x + factorSeg1 * seg1dx,\r\n\t\t\t\t\t\t\t\ty: inSeg1Pt1.y + factorSeg1 * seg1dy } ];\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t// parallel or collinear\r\n\t\t\t\t\tif ( ( perpSeg1 !== 0 ) ||\r\n\t\t\t\t\t\t ( seg2dy * seg1seg2dx !== seg2dx * seg1seg2dy ) ) \t\t\treturn [];\r\n\t\r\n\t\t\t\t\t// they are collinear or degenerate\r\n\t\t\t\t\tvar seg1Pt = ( ( seg1dx === 0 ) && ( seg1dy === 0 ) );\t// segment1 is just a point?\r\n\t\t\t\t\tvar seg2Pt = ( ( seg2dx === 0 ) && ( seg2dy === 0 ) );\t// segment2 is just a point?\r\n\t\t\t\t\t// both segments are points\r\n\t\t\t\t\tif ( seg1Pt && seg2Pt ) {\r\n\t\r\n\t\t\t\t\t\tif ( ( inSeg1Pt1.x !== inSeg2Pt1.x ) ||\r\n\t\t\t\t\t\t\t ( inSeg1Pt1.y !== inSeg2Pt1.y ) )\t\treturn [];\t// they are distinct  points\r\n\t\t\t\t\t\treturn [ inSeg1Pt1 ];                 \t\t\t\t\t\t// they are the same point\r\n\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// segment#1  is a single point\r\n\t\t\t\t\tif ( seg1Pt ) {\r\n\t\r\n\t\t\t\t\t\tif ( ! point_in_segment_2D_colin( inSeg2Pt1, inSeg2Pt2, inSeg1Pt1 ) )\t\treturn [];\t\t// but not in segment#2\r\n\t\t\t\t\t\treturn [ inSeg1Pt1 ];\r\n\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// segment#2  is a single point\r\n\t\t\t\t\tif ( seg2Pt ) {\r\n\t\r\n\t\t\t\t\t\tif ( ! point_in_segment_2D_colin( inSeg1Pt1, inSeg1Pt2, inSeg2Pt1 ) )\t\treturn [];\t\t// but not in segment#1\r\n\t\t\t\t\t\treturn [ inSeg2Pt1 ];\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t// they are collinear segments, which might overlap\r\n\t\t\t\t\tvar seg1min, seg1max, seg1minVal, seg1maxVal;\r\n\t\t\t\t\tvar seg2min, seg2max, seg2minVal, seg2maxVal;\r\n\t\t\t\t\tif ( seg1dx !== 0 ) {\r\n\t\r\n\t\t\t\t\t\t// the segments are NOT on a vertical line\r\n\t\t\t\t\t\tif ( inSeg1Pt1.x < inSeg1Pt2.x ) {\r\n\t\r\n\t\t\t\t\t\t\tseg1min = inSeg1Pt1; seg1minVal = inSeg1Pt1.x;\r\n\t\t\t\t\t\t\tseg1max = inSeg1Pt2; seg1maxVal = inSeg1Pt2.x;\r\n\t\r\n\t\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\t\tseg1min = inSeg1Pt2; seg1minVal = inSeg1Pt2.x;\r\n\t\t\t\t\t\t\tseg1max = inSeg1Pt1; seg1maxVal = inSeg1Pt1.x;\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ( inSeg2Pt1.x < inSeg2Pt2.x ) {\r\n\t\r\n\t\t\t\t\t\t\tseg2min = inSeg2Pt1; seg2minVal = inSeg2Pt1.x;\r\n\t\t\t\t\t\t\tseg2max = inSeg2Pt2; seg2maxVal = inSeg2Pt2.x;\r\n\t\r\n\t\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\t\tseg2min = inSeg2Pt2; seg2minVal = inSeg2Pt2.x;\r\n\t\t\t\t\t\t\tseg2max = inSeg2Pt1; seg2maxVal = inSeg2Pt1.x;\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\t// the segments are on a vertical line\r\n\t\t\t\t\t\tif ( inSeg1Pt1.y < inSeg1Pt2.y ) {\r\n\t\r\n\t\t\t\t\t\t\tseg1min = inSeg1Pt1; seg1minVal = inSeg1Pt1.y;\r\n\t\t\t\t\t\t\tseg1max = inSeg1Pt2; seg1maxVal = inSeg1Pt2.y;\r\n\t\r\n\t\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\t\tseg1min = inSeg1Pt2; seg1minVal = inSeg1Pt2.y;\r\n\t\t\t\t\t\t\tseg1max = inSeg1Pt1; seg1maxVal = inSeg1Pt1.y;\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ( inSeg2Pt1.y < inSeg2Pt2.y ) {\r\n\t\r\n\t\t\t\t\t\t\tseg2min = inSeg2Pt1; seg2minVal = inSeg2Pt1.y;\r\n\t\t\t\t\t\t\tseg2max = inSeg2Pt2; seg2maxVal = inSeg2Pt2.y;\r\n\t\r\n\t\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\t\tseg2min = inSeg2Pt2; seg2minVal = inSeg2Pt2.y;\r\n\t\t\t\t\t\t\tseg2max = inSeg2Pt1; seg2maxVal = inSeg2Pt1.y;\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( seg1minVal <= seg2minVal ) {\r\n\t\r\n\t\t\t\t\t\tif ( seg1maxVal <  seg2minVal )\treturn [];\r\n\t\t\t\t\t\tif ( seg1maxVal === seg2minVal )\t{\r\n\t\r\n\t\t\t\t\t\t\tif ( inExcludeAdjacentSegs )\t\treturn [];\r\n\t\t\t\t\t\t\treturn [ seg2min ];\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ( seg1maxVal <= seg2maxVal )\treturn [ seg2min, seg1max ];\r\n\t\t\t\t\t\treturn\t[ seg2min, seg2max ];\r\n\t\r\n\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\tif ( seg1minVal >  seg2maxVal )\treturn [];\r\n\t\t\t\t\t\tif ( seg1minVal === seg2maxVal )\t{\r\n\t\r\n\t\t\t\t\t\t\tif ( inExcludeAdjacentSegs )\t\treturn [];\r\n\t\t\t\t\t\t\treturn [ seg1min ];\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ( seg1maxVal <= seg2maxVal )\treturn [ seg1min, seg1max ];\r\n\t\t\t\t\t\treturn\t[ seg1min, seg2max ];\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tfunction isPointInsideAngle( inVertex, inLegFromPt, inLegToPt, inOtherPt ) {\r\n\t\r\n\t\t\t\t// The order of legs is important\r\n\t\r\n\t\t\t\t// translation of all points, so that Vertex is at (0,0)\r\n\t\t\t\tvar legFromPtX\t= inLegFromPt.x - inVertex.x,  legFromPtY\t= inLegFromPt.y - inVertex.y;\r\n\t\t\t\tvar legToPtX\t= inLegToPt.x\t- inVertex.x,  legToPtY\t\t= inLegToPt.y\t- inVertex.y;\r\n\t\t\t\tvar otherPtX\t= inOtherPt.x\t- inVertex.x,  otherPtY\t\t= inOtherPt.y\t- inVertex.y;\r\n\t\r\n\t\t\t\t// main angle >0: < 180 deg.; 0: 180 deg.; <0: > 180 deg.\r\n\t\t\t\tvar from2toAngle\t= legFromPtX * legToPtY - legFromPtY * legToPtX;\r\n\t\t\t\tvar from2otherAngle\t= legFromPtX * otherPtY - legFromPtY * otherPtX;\r\n\t\r\n\t\t\t\tif ( Math.abs( from2toAngle ) > Number.EPSILON ) {\r\n\t\r\n\t\t\t\t\t// angle != 180 deg.\r\n\t\r\n\t\t\t\t\tvar other2toAngle\t\t= otherPtX * legToPtY - otherPtY * legToPtX;\r\n\t\t\t\t\t// console.log( \"from2to: \" + from2toAngle + \", from2other: \" + from2otherAngle + \", other2to: \" + other2toAngle );\r\n\t\r\n\t\t\t\t\tif ( from2toAngle > 0 ) {\r\n\t\r\n\t\t\t\t\t\t// main angle < 180 deg.\r\n\t\t\t\t\t\treturn\t( ( from2otherAngle >= 0 ) && ( other2toAngle >= 0 ) );\r\n\t\r\n\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\t// main angle > 180 deg.\r\n\t\t\t\t\t\treturn\t( ( from2otherAngle >= 0 ) || ( other2toAngle >= 0 ) );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t// angle == 180 deg.\r\n\t\t\t\t\t// console.log( \"from2to: 180 deg., from2other: \" + from2otherAngle  );\r\n\t\t\t\t\treturn\t( from2otherAngle > 0 );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\r\n\t\t\tfunction removeHoles( contour, holes ) {\r\n\t\r\n\t\t\t\tvar shape = contour.concat(); // work on this shape\r\n\t\t\t\tvar hole;\r\n\t\r\n\t\t\t\tfunction isCutLineInsideAngles( inShapeIdx, inHoleIdx ) {\r\n\t\r\n\t\t\t\t\t// Check if hole point lies within angle around shape point\r\n\t\t\t\t\tvar lastShapeIdx = shape.length - 1;\r\n\t\r\n\t\t\t\t\tvar prevShapeIdx = inShapeIdx - 1;\r\n\t\t\t\t\tif ( prevShapeIdx < 0 )\t\t\tprevShapeIdx = lastShapeIdx;\r\n\t\r\n\t\t\t\t\tvar nextShapeIdx = inShapeIdx + 1;\r\n\t\t\t\t\tif ( nextShapeIdx > lastShapeIdx )\tnextShapeIdx = 0;\r\n\t\r\n\t\t\t\t\tvar insideAngle = isPointInsideAngle( shape[ inShapeIdx ], shape[ prevShapeIdx ], shape[ nextShapeIdx ], hole[ inHoleIdx ] );\r\n\t\t\t\t\tif ( ! insideAngle ) {\r\n\t\r\n\t\t\t\t\t\t// console.log( \"Vertex (Shape): \" + inShapeIdx + \", Point: \" + hole[inHoleIdx].x + \"/\" + hole[inHoleIdx].y );\r\n\t\t\t\t\t\treturn\tfalse;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t// Check if shape point lies within angle around hole point\r\n\t\t\t\t\tvar lastHoleIdx = hole.length - 1;\r\n\t\r\n\t\t\t\t\tvar prevHoleIdx = inHoleIdx - 1;\r\n\t\t\t\t\tif ( prevHoleIdx < 0 )\t\t\tprevHoleIdx = lastHoleIdx;\r\n\t\r\n\t\t\t\t\tvar nextHoleIdx = inHoleIdx + 1;\r\n\t\t\t\t\tif ( nextHoleIdx > lastHoleIdx )\tnextHoleIdx = 0;\r\n\t\r\n\t\t\t\t\tinsideAngle = isPointInsideAngle( hole[ inHoleIdx ], hole[ prevHoleIdx ], hole[ nextHoleIdx ], shape[ inShapeIdx ] );\r\n\t\t\t\t\tif ( ! insideAngle ) {\r\n\t\r\n\t\t\t\t\t\t// console.log( \"Vertex (Hole): \" + inHoleIdx + \", Point: \" + shape[inShapeIdx].x + \"/\" + shape[inShapeIdx].y );\r\n\t\t\t\t\t\treturn\tfalse;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\treturn\ttrue;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tfunction intersectsShapeEdge( inShapePt, inHolePt ) {\r\n\t\r\n\t\t\t\t\t// checks for intersections with shape edges\r\n\t\t\t\t\tvar sIdx, nextIdx, intersection;\r\n\t\t\t\t\tfor ( sIdx = 0; sIdx < shape.length; sIdx ++ ) {\r\n\t\r\n\t\t\t\t\t\tnextIdx = sIdx + 1; nextIdx %= shape.length;\r\n\t\t\t\t\t\tintersection = intersect_segments_2D( inShapePt, inHolePt, shape[ sIdx ], shape[ nextIdx ], true );\r\n\t\t\t\t\t\tif ( intersection.length > 0 )\t\treturn\ttrue;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\treturn\tfalse;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tvar indepHoles = [];\r\n\t\r\n\t\t\t\tfunction intersectsHoleEdge( inShapePt, inHolePt ) {\r\n\t\r\n\t\t\t\t\t// checks for intersections with hole edges\r\n\t\t\t\t\tvar ihIdx, chkHole,\r\n\t\t\t\t\t\thIdx, nextIdx, intersection;\r\n\t\t\t\t\tfor ( ihIdx = 0; ihIdx < indepHoles.length; ihIdx ++ ) {\r\n\t\r\n\t\t\t\t\t\tchkHole = holes[ indepHoles[ ihIdx ]];\r\n\t\t\t\t\t\tfor ( hIdx = 0; hIdx < chkHole.length; hIdx ++ ) {\r\n\t\r\n\t\t\t\t\t\t\tnextIdx = hIdx + 1; nextIdx %= chkHole.length;\r\n\t\t\t\t\t\t\tintersection = intersect_segments_2D( inShapePt, inHolePt, chkHole[ hIdx ], chkHole[ nextIdx ], true );\r\n\t\t\t\t\t\t\tif ( intersection.length > 0 )\t\treturn\ttrue;\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn\tfalse;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tvar holeIndex, shapeIndex,\r\n\t\t\t\t\tshapePt, holePt,\r\n\t\t\t\t\tholeIdx, cutKey, failedCuts = [],\r\n\t\t\t\t\ttmpShape1, tmpShape2,\r\n\t\t\t\t\ttmpHole1, tmpHole2;\r\n\t\r\n\t\t\t\tfor ( var h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\t\r\n\t\t\t\t\tindepHoles.push( h );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tvar minShapeIndex = 0;\r\n\t\t\t\tvar counter = indepHoles.length * 2;\r\n\t\t\t\twhile ( indepHoles.length > 0 ) {\r\n\t\r\n\t\t\t\t\tcounter --;\r\n\t\t\t\t\tif ( counter < 0 ) {\r\n\t\r\n\t\t\t\t\t\tconsole.log( \"Infinite Loop! Holes left:\" + indepHoles.length + \", Probably Hole outside Shape!\" );\r\n\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t// search for shape-vertex and hole-vertex,\r\n\t\t\t\t\t// which can be connected without intersections\r\n\t\t\t\t\tfor ( shapeIndex = minShapeIndex; shapeIndex < shape.length; shapeIndex ++ ) {\r\n\t\r\n\t\t\t\t\t\tshapePt = shape[ shapeIndex ];\r\n\t\t\t\t\t\tholeIndex\t= - 1;\r\n\t\r\n\t\t\t\t\t\t// search for hole which can be reached without intersections\r\n\t\t\t\t\t\tfor ( var h = 0; h < indepHoles.length; h ++ ) {\r\n\t\r\n\t\t\t\t\t\t\tholeIdx = indepHoles[ h ];\r\n\t\r\n\t\t\t\t\t\t\t// prevent multiple checks\r\n\t\t\t\t\t\t\tcutKey = shapePt.x + \":\" + shapePt.y + \":\" + holeIdx;\r\n\t\t\t\t\t\t\tif ( failedCuts[ cutKey ] !== undefined )\t\t\tcontinue;\r\n\t\r\n\t\t\t\t\t\t\thole = holes[ holeIdx ];\r\n\t\t\t\t\t\t\tfor ( var h2 = 0; h2 < hole.length; h2 ++ ) {\r\n\t\r\n\t\t\t\t\t\t\t\tholePt = hole[ h2 ];\r\n\t\t\t\t\t\t\t\tif ( ! isCutLineInsideAngles( shapeIndex, h2 ) )\t\tcontinue;\r\n\t\t\t\t\t\t\t\tif ( intersectsShapeEdge( shapePt, holePt ) )\t\tcontinue;\r\n\t\t\t\t\t\t\t\tif ( intersectsHoleEdge( shapePt, holePt ) )\t\tcontinue;\r\n\t\r\n\t\t\t\t\t\t\t\tholeIndex = h2;\r\n\t\t\t\t\t\t\t\tindepHoles.splice( h, 1 );\r\n\t\r\n\t\t\t\t\t\t\t\ttmpShape1 = shape.slice( 0, shapeIndex + 1 );\r\n\t\t\t\t\t\t\t\ttmpShape2 = shape.slice( shapeIndex );\r\n\t\t\t\t\t\t\t\ttmpHole1 = hole.slice( holeIndex );\r\n\t\t\t\t\t\t\t\ttmpHole2 = hole.slice( 0, holeIndex + 1 );\r\n\t\r\n\t\t\t\t\t\t\t\tshape = tmpShape1.concat( tmpHole1 ).concat( tmpHole2 ).concat( tmpShape2 );\r\n\t\r\n\t\t\t\t\t\t\t\tminShapeIndex = shapeIndex;\r\n\t\r\n\t\t\t\t\t\t\t\t// Debug only, to show the selected cuts\r\n\t\t\t\t\t\t\t\t// glob_CutLines.push( [ shapePt, holePt ] );\r\n\t\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif ( holeIndex >= 0 )\tbreak;\t\t// hole-vertex found\r\n\t\r\n\t\t\t\t\t\t\tfailedCuts[ cutKey ] = true;\t\t\t// remember failure\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ( holeIndex >= 0 )\tbreak;\t\t// hole-vertex found\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\treturn shape; \t\t\t/* shape with no holes */\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\r\n\t\t\tvar i, il, f, face,\r\n\t\t\t\tkey, index,\r\n\t\t\t\tallPointsMap = {};\r\n\t\r\n\t\t\t// To maintain reference to old shape, one must match coordinates, or offset the indices from original arrays. It's probably easier to do the first.\r\n\t\r\n\t\t\tvar allpoints = contour.concat();\r\n\t\r\n\t\t\tfor ( var h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\t\r\n\t\t\t\tArray.prototype.push.apply( allpoints, holes[ h ] );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t//console.log( \"allpoints\",allpoints, allpoints.length );\r\n\t\r\n\t\t\t// prepare all points map\r\n\t\r\n\t\t\tfor ( i = 0, il = allpoints.length; i < il; i ++ ) {\r\n\t\r\n\t\t\t\tkey = allpoints[ i ].x + \":\" + allpoints[ i ].y;\r\n\t\r\n\t\t\t\tif ( allPointsMap[ key ] !== undefined ) {\r\n\t\r\n\t\t\t\t\tconsole.warn( \"THREE.Shape: Duplicate point\", key );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tallPointsMap[ key ] = i;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// remove holes by cutting paths to holes and adding them to the shape\r\n\t\t\tvar shapeWithoutHoles = removeHoles( contour, holes );\r\n\t\r\n\t\t\tvar triangles = THREE.ShapeUtils.triangulate( shapeWithoutHoles, false ); // True returns indices for points of spooled shape\r\n\t\t\t//console.log( \"triangles\",triangles, triangles.length );\r\n\t\r\n\t\t\t// check all face vertices against all points map\r\n\t\r\n\t\t\tfor ( i = 0, il = triangles.length; i < il; i ++ ) {\r\n\t\r\n\t\t\t\tface = triangles[ i ];\r\n\t\r\n\t\t\t\tfor ( f = 0; f < 3; f ++ ) {\r\n\t\r\n\t\t\t\t\tkey = face[ f ].x + \":\" + face[ f ].y;\r\n\t\r\n\t\t\t\t\tindex = allPointsMap[ key ];\r\n\t\r\n\t\t\t\t\tif ( index !== undefined ) {\r\n\t\r\n\t\t\t\t\t\tface[ f ] = index;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn triangles.concat();\r\n\t\r\n\t\t},\r\n\t\r\n\t\tisClockWise: function ( pts ) {\r\n\t\r\n\t\t\treturn THREE.ShapeUtils.area( pts ) < 0;\r\n\t\r\n\t\t},\r\n\t\r\n\t\t// Bezier Curves formulas obtained from\r\n\t\t// http://en.wikipedia.org/wiki/B%C3%A9zier_curve\r\n\t\r\n\t\t// Quad Bezier Functions\r\n\t\r\n\t\tb2: ( function () {\r\n\t\r\n\t\t\tfunction b2p0( t, p ) {\r\n\t\r\n\t\t\t\tvar k = 1 - t;\r\n\t\t\t\treturn k * k * p;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tfunction b2p1( t, p ) {\r\n\t\r\n\t\t\t\treturn 2 * ( 1 - t ) * t * p;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tfunction b2p2( t, p ) {\r\n\t\r\n\t\t\t\treturn t * t * p;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn function ( t, p0, p1, p2 ) {\r\n\t\r\n\t\t\t\treturn b2p0( t, p0 ) + b2p1( t, p1 ) + b2p2( t, p2 );\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t} )(),\r\n\t\r\n\t\t// Cubic Bezier Functions\r\n\t\r\n\t\tb3: ( function () {\r\n\t\r\n\t\t\tfunction b3p0( t, p ) {\r\n\t\r\n\t\t\t\tvar k = 1 - t;\r\n\t\t\t\treturn k * k * k * p;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tfunction b3p1( t, p ) {\r\n\t\r\n\t\t\t\tvar k = 1 - t;\r\n\t\t\t\treturn 3 * k * k * t * p;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tfunction b3p2( t, p ) {\r\n\t\r\n\t\t\t\tvar k = 1 - t;\r\n\t\t\t\treturn 3 * k * t * t * p;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tfunction b3p3( t, p ) {\r\n\t\r\n\t\t\t\treturn t * t * t * p;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn function ( t, p0, p1, p2, p3 ) {\r\n\t\r\n\t\t\t\treturn b3p0( t, p0 ) + b3p1( t, p1 ) + b3p2( t, p2 ) + b3p3( t, p3 );\r\n\t\r\n\t\t\t};\r\n\t\r\n\t\t} )()\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/extras/audio/Audio.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.Audio = function ( listener ) {\r\n\t\r\n\t\tTHREE.Object3D.call( this );\r\n\t\r\n\t\tthis.type = 'Audio';\r\n\t\r\n\t\tthis.context = listener.context;\r\n\t\tthis.source = this.context.createBufferSource();\r\n\t\tthis.source.onended = this.onEnded.bind( this );\r\n\t\r\n\t\tthis.gain = this.context.createGain();\r\n\t\tthis.gain.connect( this.context.destination );\r\n\t\r\n\t\tthis.panner = this.context.createPanner();\r\n\t\tthis.panner.connect( this.gain );\r\n\t\r\n\t\tthis.autoplay = false;\r\n\t\r\n\t\tthis.startTime = 0;\r\n\t\tthis.playbackRate = 1;\r\n\t\tthis.isPlaying = false;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Audio.prototype = Object.create( THREE.Object3D.prototype );\r\n\tTHREE.Audio.prototype.constructor = THREE.Audio;\r\n\t\r\n\tTHREE.Audio.prototype.load = function ( file ) {\r\n\t\r\n\t\tvar scope = this;\r\n\t\r\n\t\tvar request = new XMLHttpRequest();\r\n\t\trequest.open( 'GET', file, true );\r\n\t\trequest.responseType = 'arraybuffer';\r\n\t\trequest.onload = function ( e ) {\r\n\t\r\n\t\t\tscope.context.decodeAudioData( this.response, function ( buffer ) {\r\n\t\r\n\t\t\t\tscope.source.buffer = buffer;\r\n\t\r\n\t\t\t\tif ( scope.autoplay ) scope.play();\r\n\t\r\n\t\t\t} );\r\n\t\r\n\t\t};\r\n\t\trequest.send();\r\n\t\r\n\t\treturn this;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Audio.prototype.play = function () {\r\n\t\r\n\t\tif ( this.isPlaying === true ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.Audio: Audio is already playing.' );\r\n\t\t\treturn;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tvar source = this.context.createBufferSource();\r\n\t\r\n\t\tsource.buffer = this.source.buffer;\r\n\t\tsource.loop = this.source.loop;\r\n\t\tsource.onended = this.source.onended;\r\n\t\tsource.start( 0, this.startTime );\r\n\t\tsource.playbackRate.value = this.playbackRate;\r\n\t\r\n\t\tthis.isPlaying = true;\r\n\t\r\n\t\tthis.source = source;\r\n\t\r\n\t\tthis.connect();\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Audio.prototype.pause = function () {\r\n\t\r\n\t\tthis.source.stop();\r\n\t\tthis.startTime = this.context.currentTime;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Audio.prototype.stop = function () {\r\n\t\r\n\t\tthis.source.stop();\r\n\t\tthis.startTime = 0;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Audio.prototype.connect = function () {\r\n\t\r\n\t\tif ( this.filter !== undefined ) {\r\n\t\r\n\t\t\tthis.source.connect( this.filter );\r\n\t\t\tthis.filter.connect( this.panner );\r\n\t\r\n\t\t} else {\r\n\t\r\n\t\t\tthis.source.connect( this.panner );\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Audio.prototype.disconnect = function () {\r\n\t\r\n\t\tif ( this.filter !== undefined ) {\r\n\t\r\n\t\t\tthis.source.disconnect( this.filter );\r\n\t\t\tthis.filter.disconnect( this.panner );\r\n\t\r\n\t\t} else {\r\n\t\r\n\t\t\tthis.source.disconnect( this.panner );\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Audio.prototype.setFilter = function ( value ) {\r\n\t\r\n\t\tif ( this.isPlaying === true ) {\r\n\t\r\n\t\t\tthis.disconnect();\r\n\t\t\tthis.filter = value;\r\n\t\t\tthis.connect();\r\n\t\r\n\t\t} else {\r\n\t\r\n\t\t\tthis.filter = value;\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Audio.prototype.getFilter = function () {\r\n\t\r\n\t\treturn this.filter;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Audio.prototype.setPlaybackRate = function ( value ) {\r\n\t\r\n\t\tthis.playbackRate = value;\r\n\t\r\n\t\tif ( this.isPlaying === true ) {\r\n\t\r\n\t\t\tthis.source.playbackRate.value = this.playbackRate;\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Audio.prototype.getPlaybackRate = function () {\r\n\t\r\n\t\treturn this.playbackRate;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Audio.prototype.onEnded = function() {\r\n\t\r\n\t\tthis.isPlaying = false;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Audio.prototype.setLoop = function ( value ) {\r\n\t\r\n\t\tthis.source.loop = value;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Audio.prototype.getLoop = function () {\r\n\t\r\n\t\treturn this.source.loop;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Audio.prototype.setRefDistance = function ( value ) {\r\n\t\r\n\t\tthis.panner.refDistance = value;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Audio.prototype.getRefDistance = function () {\r\n\t\r\n\t\treturn this.panner.refDistance;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Audio.prototype.setRolloffFactor = function ( value ) {\r\n\t\r\n\t\tthis.panner.rolloffFactor = value;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Audio.prototype.getRolloffFactor = function () {\r\n\t\r\n\t\treturn this.panner.rolloffFactor;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Audio.prototype.setVolume = function ( value ) {\r\n\t\r\n\t\tthis.gain.gain.value = value;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Audio.prototype.getVolume = function () {\r\n\t\r\n\t\treturn this.gain.gain.value;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Audio.prototype.updateMatrixWorld = ( function () {\r\n\t\r\n\t\tvar position = new THREE.Vector3();\r\n\t\r\n\t\treturn function updateMatrixWorld( force ) {\r\n\t\r\n\t\t\tTHREE.Object3D.prototype.updateMatrixWorld.call( this, force );\r\n\t\r\n\t\t\tposition.setFromMatrixPosition( this.matrixWorld );\r\n\t\r\n\t\t\tthis.panner.setPosition( position.x, position.y, position.z );\r\n\t\r\n\t\t};\r\n\t\r\n\t} )();\r\n\t\r\n\t// File:src/extras/audio/AudioListener.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.AudioListener = function () {\r\n\t\r\n\t\tTHREE.Object3D.call( this );\r\n\t\r\n\t\tthis.type = 'AudioListener';\r\n\t\r\n\t\tthis.context = new ( window.AudioContext || window.webkitAudioContext )();\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.AudioListener.prototype = Object.create( THREE.Object3D.prototype );\r\n\tTHREE.AudioListener.prototype.constructor = THREE.AudioListener;\r\n\t\r\n\tTHREE.AudioListener.prototype.updateMatrixWorld = ( function () {\r\n\t\r\n\t\tvar position = new THREE.Vector3();\r\n\t\tvar quaternion = new THREE.Quaternion();\r\n\t\tvar scale = new THREE.Vector3();\r\n\t\r\n\t\tvar orientation = new THREE.Vector3();\r\n\t\r\n\t\treturn function updateMatrixWorld( force ) {\r\n\t\r\n\t\t\tTHREE.Object3D.prototype.updateMatrixWorld.call( this, force );\r\n\t\r\n\t\t\tvar listener = this.context.listener;\r\n\t\t\tvar up = this.up;\r\n\t\r\n\t\t\tthis.matrixWorld.decompose( position, quaternion, scale );\r\n\t\r\n\t\t\torientation.set( 0, 0, - 1 ).applyQuaternion( quaternion );\r\n\t\r\n\t\t\tlistener.setPosition( position.x, position.y, position.z );\r\n\t\t\tlistener.setOrientation( orientation.x, orientation.y, orientation.z, up.x, up.y, up.z );\r\n\t\r\n\t\t};\r\n\t\r\n\t} )();\r\n\t\r\n\t// File:src/extras/core/Curve.js\r\n\t\r\n\t/**\r\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\r\n\t * Extensible curve object\r\n\t *\r\n\t * Some common of Curve methods\r\n\t * .getPoint(t), getTangent(t)\r\n\t * .getPointAt(u), getTagentAt(u)\r\n\t * .getPoints(), .getSpacedPoints()\r\n\t * .getLength()\r\n\t * .updateArcLengths()\r\n\t *\r\n\t * This following classes subclasses THREE.Curve:\r\n\t *\r\n\t * -- 2d classes --\r\n\t * THREE.LineCurve\r\n\t * THREE.QuadraticBezierCurve\r\n\t * THREE.CubicBezierCurve\r\n\t * THREE.SplineCurve\r\n\t * THREE.ArcCurve\r\n\t * THREE.EllipseCurve\r\n\t *\r\n\t * -- 3d classes --\r\n\t * THREE.LineCurve3\r\n\t * THREE.QuadraticBezierCurve3\r\n\t * THREE.CubicBezierCurve3\r\n\t * THREE.SplineCurve3\r\n\t * THREE.ClosedSplineCurve3\r\n\t *\r\n\t * A series of curves can be represented as a THREE.CurvePath\r\n\t *\r\n\t **/\r\n\t\r\n\t/**************************************************************\r\n\t *\tAbstract Curve base class\r\n\t **************************************************************/\r\n\t\r\n\tTHREE.Curve = function () {\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Curve.prototype = {\r\n\t\r\n\t\tconstructor: THREE.Curve,\r\n\t\r\n\t\t// Virtual base class method to overwrite and implement in subclasses\r\n\t\t//\t- t [0 .. 1]\r\n\t\r\n\t\tgetPoint: function ( t ) {\r\n\t\r\n\t\t\tconsole.warn( \"THREE.Curve: Warning, getPoint() not implemented!\" );\r\n\t\t\treturn null;\r\n\t\r\n\t\t},\r\n\t\r\n\t\t// Get point at relative position in curve according to arc length\r\n\t\t// - u [0 .. 1]\r\n\t\r\n\t\tgetPointAt: function ( u ) {\r\n\t\r\n\t\t\tvar t = this.getUtoTmapping( u );\r\n\t\t\treturn this.getPoint( t );\r\n\t\r\n\t\t},\r\n\t\r\n\t\t// Get sequence of points using getPoint( t )\r\n\t\r\n\t\tgetPoints: function ( divisions ) {\r\n\t\r\n\t\t\tif ( ! divisions ) divisions = 5;\r\n\t\r\n\t\t\tvar d, pts = [];\r\n\t\r\n\t\t\tfor ( d = 0; d <= divisions; d ++ ) {\r\n\t\r\n\t\t\t\tpts.push( this.getPoint( d / divisions ) );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn pts;\r\n\t\r\n\t\t},\r\n\t\r\n\t\t// Get sequence of points using getPointAt( u )\r\n\t\r\n\t\tgetSpacedPoints: function ( divisions ) {\r\n\t\r\n\t\t\tif ( ! divisions ) divisions = 5;\r\n\t\r\n\t\t\tvar d, pts = [];\r\n\t\r\n\t\t\tfor ( d = 0; d <= divisions; d ++ ) {\r\n\t\r\n\t\t\t\tpts.push( this.getPointAt( d / divisions ) );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn pts;\r\n\t\r\n\t\t},\r\n\t\r\n\t\t// Get total curve arc length\r\n\t\r\n\t\tgetLength: function () {\r\n\t\r\n\t\t\tvar lengths = this.getLengths();\r\n\t\t\treturn lengths[ lengths.length - 1 ];\r\n\t\r\n\t\t},\r\n\t\r\n\t\t// Get list of cumulative segment lengths\r\n\t\r\n\t\tgetLengths: function ( divisions ) {\r\n\t\r\n\t\t\tif ( ! divisions ) divisions = ( this.__arcLengthDivisions ) ? ( this.__arcLengthDivisions ) : 200;\r\n\t\r\n\t\t\tif ( this.cacheArcLengths\r\n\t\t\t\t&& ( this.cacheArcLengths.length === divisions + 1 )\r\n\t\t\t\t&& ! this.needsUpdate ) {\r\n\t\r\n\t\t\t\t//console.log( \"cached\", this.cacheArcLengths );\r\n\t\t\t\treturn this.cacheArcLengths;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tthis.needsUpdate = false;\r\n\t\r\n\t\t\tvar cache = [];\r\n\t\t\tvar current, last = this.getPoint( 0 );\r\n\t\t\tvar p, sum = 0;\r\n\t\r\n\t\t\tcache.push( 0 );\r\n\t\r\n\t\t\tfor ( p = 1; p <= divisions; p ++ ) {\r\n\t\r\n\t\t\t\tcurrent = this.getPoint ( p / divisions );\r\n\t\t\t\tsum += current.distanceTo( last );\r\n\t\t\t\tcache.push( sum );\r\n\t\t\t\tlast = current;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tthis.cacheArcLengths = cache;\r\n\t\r\n\t\t\treturn cache; // { sums: cache, sum:sum }; Sum is in the last element.\r\n\t\r\n\t\t},\r\n\t\r\n\t\tupdateArcLengths: function() {\r\n\t\r\n\t\t\tthis.needsUpdate = true;\r\n\t\t\tthis.getLengths();\r\n\t\r\n\t\t},\r\n\t\r\n\t\t// Given u ( 0 .. 1 ), get a t to find p. This gives you points which are equidistant\r\n\t\r\n\t\tgetUtoTmapping: function ( u, distance ) {\r\n\t\r\n\t\t\tvar arcLengths = this.getLengths();\r\n\t\r\n\t\t\tvar i = 0, il = arcLengths.length;\r\n\t\r\n\t\t\tvar targetArcLength; // The targeted u distance value to get\r\n\t\r\n\t\t\tif ( distance ) {\r\n\t\r\n\t\t\t\ttargetArcLength = distance;\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\ttargetArcLength = u * arcLengths[ il - 1 ];\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t//var time = Date.now();\r\n\t\r\n\t\t\t// binary search for the index with largest value smaller than target u distance\r\n\t\r\n\t\t\tvar low = 0, high = il - 1, comparison;\r\n\t\r\n\t\t\twhile ( low <= high ) {\r\n\t\r\n\t\t\t\ti = Math.floor( low + ( high - low ) / 2 ); // less likely to overflow, though probably not issue here, JS doesn't really have integers, all numbers are floats\r\n\t\r\n\t\t\t\tcomparison = arcLengths[ i ] - targetArcLength;\r\n\t\r\n\t\t\t\tif ( comparison < 0 ) {\r\n\t\r\n\t\t\t\t\tlow = i + 1;\r\n\t\r\n\t\t\t\t} else if ( comparison > 0 ) {\r\n\t\r\n\t\t\t\t\thigh = i - 1;\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\thigh = i;\r\n\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t\t// DONE\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\ti = high;\r\n\t\r\n\t\t\t//console.log('b' , i, low, high, Date.now()- time);\r\n\t\r\n\t\t\tif ( arcLengths[ i ] === targetArcLength ) {\r\n\t\r\n\t\t\t\tvar t = i / ( il - 1 );\r\n\t\t\t\treturn t;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// we could get finer grain at lengths, or use simple interpolation between two points\r\n\t\r\n\t\t\tvar lengthBefore = arcLengths[ i ];\r\n\t\t\tvar lengthAfter = arcLengths[ i + 1 ];\r\n\t\r\n\t\t\tvar segmentLength = lengthAfter - lengthBefore;\r\n\t\r\n\t\t\t// determine where we are between the 'before' and 'after' points\r\n\t\r\n\t\t\tvar segmentFraction = ( targetArcLength - lengthBefore ) / segmentLength;\r\n\t\r\n\t\t\t// add that fractional amount to t\r\n\t\r\n\t\t\tvar t = ( i + segmentFraction ) / ( il - 1 );\r\n\t\r\n\t\t\treturn t;\r\n\t\r\n\t\t},\r\n\t\r\n\t\t// Returns a unit vector tangent at t\r\n\t\t// In case any sub curve does not implement its tangent derivation,\r\n\t\t// 2 points a small delta apart will be used to find its gradient\r\n\t\t// which seems to give a reasonable approximation\r\n\t\r\n\t\tgetTangent: function( t ) {\r\n\t\r\n\t\t\tvar delta = 0.0001;\r\n\t\t\tvar t1 = t - delta;\r\n\t\t\tvar t2 = t + delta;\r\n\t\r\n\t\t\t// Capping in case of danger\r\n\t\r\n\t\t\tif ( t1 < 0 ) t1 = 0;\r\n\t\t\tif ( t2 > 1 ) t2 = 1;\r\n\t\r\n\t\t\tvar pt1 = this.getPoint( t1 );\r\n\t\t\tvar pt2 = this.getPoint( t2 );\r\n\t\r\n\t\t\tvar vec = pt2.clone().sub( pt1 );\r\n\t\t\treturn vec.normalize();\r\n\t\r\n\t\t},\r\n\t\r\n\t\tgetTangentAt: function ( u ) {\r\n\t\r\n\t\t\tvar t = this.getUtoTmapping( u );\r\n\t\t\treturn this.getTangent( t );\r\n\t\r\n\t\t}\r\n\t\r\n\t}\r\n\t\r\n\tTHREE.Curve.Utils = THREE.CurveUtils; // backwards compatibility\r\n\t\r\n\t// TODO: Transformation for Curves?\r\n\t\r\n\t/**************************************************************\r\n\t *\t3D Curves\r\n\t **************************************************************/\r\n\t\r\n\t// A Factory method for creating new curve subclasses\r\n\t\r\n\tTHREE.Curve.create = function ( constructor, getPointFunc ) {\r\n\t\r\n\t\tconstructor.prototype = Object.create( THREE.Curve.prototype );\r\n\t\tconstructor.prototype.constructor = constructor;\r\n\t\tconstructor.prototype.getPoint = getPointFunc;\r\n\t\r\n\t\treturn constructor;\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/extras/core/CurvePath.js\r\n\t\r\n\t/**\r\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\r\n\t *\r\n\t **/\r\n\t\r\n\t/**************************************************************\r\n\t *\tCurved Path - a curve path is simply a array of connected\r\n\t *  curves, but retains the api of a curve\r\n\t **************************************************************/\r\n\t\r\n\tTHREE.CurvePath = function () {\r\n\t\r\n\t\tthis.curves = [];\r\n\t\r\n\t\tthis.autoClose = false; // Automatically closes the path\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.CurvePath.prototype = Object.create( THREE.Curve.prototype );\r\n\tTHREE.CurvePath.prototype.constructor = THREE.CurvePath;\r\n\t\r\n\tTHREE.CurvePath.prototype.add = function ( curve ) {\r\n\t\r\n\t\tthis.curves.push( curve );\r\n\t\r\n\t};\r\n\t\r\n\t/*\r\n\tTHREE.CurvePath.prototype.checkConnection = function() {\r\n\t\t// TODO\r\n\t\t// If the ending of curve is not connected to the starting\r\n\t\t// or the next curve, then, this is not a real path\r\n\t};\r\n\t*/\r\n\t\r\n\tTHREE.CurvePath.prototype.closePath = function() {\r\n\t\r\n\t\t// TODO Test\r\n\t\t// and verify for vector3 (needs to implement equals)\r\n\t\t// Add a line curve if start and end of lines are not connected\r\n\t\tvar startPoint = this.curves[ 0 ].getPoint( 0 );\r\n\t\tvar endPoint = this.curves[ this.curves.length - 1 ].getPoint( 1 );\r\n\t\r\n\t\tif ( ! startPoint.equals( endPoint ) ) {\r\n\t\r\n\t\t\tthis.curves.push( new THREE.LineCurve( endPoint, startPoint ) );\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// To get accurate point with reference to\r\n\t// entire path distance at time t,\r\n\t// following has to be done:\r\n\t\r\n\t// 1. Length of each sub path have to be known\r\n\t// 2. Locate and identify type of curve\r\n\t// 3. Get t for the curve\r\n\t// 4. Return curve.getPointAt(t')\r\n\t\r\n\tTHREE.CurvePath.prototype.getPoint = function( t ) {\r\n\t\r\n\t\tvar d = t * this.getLength();\r\n\t\tvar curveLengths = this.getCurveLengths();\r\n\t\tvar i = 0;\r\n\t\r\n\t\t// To think about boundaries points.\r\n\t\r\n\t\twhile ( i < curveLengths.length ) {\r\n\t\r\n\t\t\tif ( curveLengths[ i ] >= d ) {\r\n\t\r\n\t\t\t\tvar diff = curveLengths[ i ] - d;\r\n\t\t\t\tvar curve = this.curves[ i ];\r\n\t\r\n\t\t\t\tvar u = 1 - diff / curve.getLength();\r\n\t\r\n\t\t\t\treturn curve.getPointAt( u );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\ti ++;\r\n\t\r\n\t\t}\r\n\t\r\n\t\treturn null;\r\n\t\r\n\t\t// loop where sum != 0, sum > d , sum+1 <d\r\n\t\r\n\t};\r\n\t\r\n\t/*\r\n\tTHREE.CurvePath.prototype.getTangent = function( t ) {\r\n\t};\r\n\t*/\r\n\t\r\n\t// We cannot use the default THREE.Curve getPoint() with getLength() because in\r\n\t// THREE.Curve, getLength() depends on getPoint() but in THREE.CurvePath\r\n\t// getPoint() depends on getLength\r\n\t\r\n\tTHREE.CurvePath.prototype.getLength = function() {\r\n\t\r\n\t\tvar lens = this.getCurveLengths();\r\n\t\treturn lens[ lens.length - 1 ];\r\n\t\r\n\t};\r\n\t\r\n\t// Compute lengths and cache them\r\n\t// We cannot overwrite getLengths() because UtoT mapping uses it.\r\n\t\r\n\tTHREE.CurvePath.prototype.getCurveLengths = function() {\r\n\t\r\n\t\t// We use cache values if curves and cache array are same length\r\n\t\r\n\t\tif ( this.cacheLengths && this.cacheLengths.length === this.curves.length ) {\r\n\t\r\n\t\t\treturn this.cacheLengths;\r\n\t\r\n\t\t}\r\n\t\r\n\t\t// Get length of sub-curve\r\n\t\t// Push sums into cached array\r\n\t\r\n\t\tvar lengths = [], sums = 0;\r\n\t\r\n\t\tfor ( var i = 0, l = this.curves.length; i < l; i ++ ) {\r\n\t\r\n\t\t\tsums += this.curves[ i ].getLength();\r\n\t\t\tlengths.push( sums );\r\n\t\r\n\t\t}\r\n\t\r\n\t\tthis.cacheLengths = lengths;\r\n\t\r\n\t\treturn lengths;\r\n\t\r\n\t};\r\n\t\r\n\t\r\n\t\r\n\t/**************************************************************\r\n\t *\tCreate Geometries Helpers\r\n\t **************************************************************/\r\n\t\r\n\t/// Generate geometry from path points (for Line or Points objects)\r\n\t\r\n\tTHREE.CurvePath.prototype.createPointsGeometry = function( divisions ) {\r\n\t\r\n\t\tvar pts = this.getPoints( divisions, true );\r\n\t\treturn this.createGeometry( pts );\r\n\t\r\n\t};\r\n\t\r\n\t// Generate geometry from equidistant sampling along the path\r\n\t\r\n\tTHREE.CurvePath.prototype.createSpacedPointsGeometry = function( divisions ) {\r\n\t\r\n\t\tvar pts = this.getSpacedPoints( divisions, true );\r\n\t\treturn this.createGeometry( pts );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.CurvePath.prototype.createGeometry = function( points ) {\r\n\t\r\n\t\tvar geometry = new THREE.Geometry();\r\n\t\r\n\t\tfor ( var i = 0, l = points.length; i < l; i ++ ) {\r\n\t\r\n\t\t\tvar point = points[ i ];\r\n\t\t\tgeometry.vertices.push( new THREE.Vector3( point.x, point.y, point.z || 0 ) );\r\n\t\r\n\t\t}\r\n\t\r\n\t\treturn geometry;\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/extras/core/Path.js\r\n\t\r\n\t/**\r\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\r\n\t * Creates free form 2d path using series of points, lines or curves.\r\n\t *\r\n\t **/\r\n\t\r\n\tTHREE.Path = function ( points ) {\r\n\t\r\n\t\tTHREE.CurvePath.call( this );\r\n\t\r\n\t\tthis.actions = [];\r\n\t\r\n\t\tif ( points ) {\r\n\t\r\n\t\t\tthis.fromPoints( points );\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Path.prototype = Object.create( THREE.CurvePath.prototype );\r\n\tTHREE.Path.prototype.constructor = THREE.Path;\r\n\t\r\n\t// TODO Clean up PATH API\r\n\t\r\n\t// Create path using straight lines to connect all points\r\n\t// - vectors: array of Vector2\r\n\t\r\n\tTHREE.Path.prototype.fromPoints = function ( vectors ) {\r\n\t\r\n\t\tthis.moveTo( vectors[ 0 ].x, vectors[ 0 ].y );\r\n\t\r\n\t\tfor ( var i = 1, l = vectors.length; i < l; i ++ ) {\r\n\t\r\n\t\t\tthis.lineTo( vectors[ i ].x, vectors[ i ].y );\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// startPath() endPath()?\r\n\t\r\n\tTHREE.Path.prototype.moveTo = function ( x, y ) {\r\n\t\r\n\t\tthis.actions.push( { action: 'moveTo', args: [ x, y ] } );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Path.prototype.lineTo = function ( x, y ) {\r\n\t\r\n\t\tvar lastargs = this.actions[ this.actions.length - 1 ].args;\r\n\t\r\n\t\tvar x0 = lastargs[ lastargs.length - 2 ];\r\n\t\tvar y0 = lastargs[ lastargs.length - 1 ];\r\n\t\r\n\t\tvar curve = new THREE.LineCurve( new THREE.Vector2( x0, y0 ), new THREE.Vector2( x, y ) );\r\n\t\tthis.curves.push( curve );\r\n\t\r\n\t\tthis.actions.push( { action: 'lineTo', args: [ x, y ] } );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Path.prototype.quadraticCurveTo = function( aCPx, aCPy, aX, aY ) {\r\n\t\r\n\t\tvar lastargs = this.actions[ this.actions.length - 1 ].args;\r\n\t\r\n\t\tvar x0 = lastargs[ lastargs.length - 2 ];\r\n\t\tvar y0 = lastargs[ lastargs.length - 1 ];\r\n\t\r\n\t\tvar curve = new THREE.QuadraticBezierCurve(\r\n\t\t\tnew THREE.Vector2( x0, y0 ),\r\n\t\t\tnew THREE.Vector2( aCPx, aCPy ),\r\n\t\t\tnew THREE.Vector2( aX, aY )\r\n\t\t);\r\n\t\r\n\t\tthis.curves.push( curve );\r\n\t\r\n\t\tthis.actions.push( { action: 'quadraticCurveTo', args: [ aCPx, aCPy, aX, aY ] } );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Path.prototype.bezierCurveTo = function( aCP1x, aCP1y, aCP2x, aCP2y, aX, aY ) {\r\n\t\r\n\t\tvar lastargs = this.actions[ this.actions.length - 1 ].args;\r\n\t\r\n\t\tvar x0 = lastargs[ lastargs.length - 2 ];\r\n\t\tvar y0 = lastargs[ lastargs.length - 1 ];\r\n\t\r\n\t\tvar curve = new THREE.CubicBezierCurve(\r\n\t\t\tnew THREE.Vector2( x0, y0 ),\r\n\t\t\tnew THREE.Vector2( aCP1x, aCP1y ),\r\n\t\t\tnew THREE.Vector2( aCP2x, aCP2y ),\r\n\t\t\tnew THREE.Vector2( aX, aY )\r\n\t\t);\r\n\t\r\n\t\tthis.curves.push( curve );\r\n\t\r\n\t\tthis.actions.push( { action: 'bezierCurveTo', args: [ aCP1x, aCP1y, aCP2x, aCP2y, aX, aY ] } );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Path.prototype.splineThru = function( pts /*Array of Vector*/ ) {\r\n\t\r\n\t\tvar args = Array.prototype.slice.call( arguments );\r\n\t\r\n\t\tvar lastargs = this.actions[ this.actions.length - 1 ].args;\r\n\t\r\n\t\tvar x0 = lastargs[ lastargs.length - 2 ];\r\n\t\tvar y0 = lastargs[ lastargs.length - 1 ];\r\n\t\r\n\t\tvar npts = [ new THREE.Vector2( x0, y0 ) ];\r\n\t\tArray.prototype.push.apply( npts, pts );\r\n\t\r\n\t\tvar curve = new THREE.SplineCurve( npts );\r\n\t\tthis.curves.push( curve );\r\n\t\r\n\t\tthis.actions.push( { action: 'splineThru', args: args } );\r\n\t\r\n\t};\r\n\t\r\n\t// FUTURE: Change the API or follow canvas API?\r\n\t\r\n\tTHREE.Path.prototype.arc = function ( aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise ) {\r\n\t\r\n\t\tvar lastargs = this.actions[ this.actions.length - 1 ].args;\r\n\t\tvar x0 = lastargs[ lastargs.length - 2 ];\r\n\t\tvar y0 = lastargs[ lastargs.length - 1 ];\r\n\t\r\n\t\tthis.absarc( aX + x0, aY + y0, aRadius,\r\n\t\t\taStartAngle, aEndAngle, aClockwise );\r\n\t\r\n\t };\r\n\t\r\n\t THREE.Path.prototype.absarc = function ( aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise ) {\r\n\t\r\n\t\tthis.absellipse( aX, aY, aRadius, aRadius, aStartAngle, aEndAngle, aClockwise );\r\n\t\r\n\t };\r\n\t\r\n\tTHREE.Path.prototype.ellipse = function ( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation ) {\r\n\t\r\n\t\tvar lastargs = this.actions[ this.actions.length - 1 ].args;\r\n\t\tvar x0 = lastargs[ lastargs.length - 2 ];\r\n\t\tvar y0 = lastargs[ lastargs.length - 1 ];\r\n\t\r\n\t\tthis.absellipse( aX + x0, aY + y0, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation );\r\n\t\r\n\t };\r\n\t\r\n\t\r\n\tTHREE.Path.prototype.absellipse = function ( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation ) {\r\n\t\r\n\t\tvar args = [\r\n\t\t\taX, aY,\r\n\t\t\txRadius, yRadius,\r\n\t\t\taStartAngle, aEndAngle,\r\n\t\t\taClockwise,\r\n\t\t\taRotation || 0 // aRotation is optional.\r\n\t\t];\r\n\t\r\n\t\tvar curve = new THREE.EllipseCurve( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation );\r\n\t\tthis.curves.push( curve );\r\n\t\r\n\t\tvar lastPoint = curve.getPoint( 1 );\r\n\t\targs.push( lastPoint.x );\r\n\t\targs.push( lastPoint.y );\r\n\t\r\n\t\tthis.actions.push( { action: 'ellipse', args: args } );\r\n\t\r\n\t };\r\n\t\r\n\tTHREE.Path.prototype.getSpacedPoints = function ( divisions, closedPath ) {\r\n\t\r\n\t\tif ( ! divisions ) divisions = 40;\r\n\t\r\n\t\tvar points = [];\r\n\t\r\n\t\tfor ( var i = 0; i < divisions; i ++ ) {\r\n\t\r\n\t\t\tpoints.push( this.getPoint( i / divisions ) );\r\n\t\r\n\t\t\t//if ( !this.getPoint( i / divisions ) ) throw \"DIE\";\r\n\t\r\n\t\t}\r\n\t\r\n\t\t// if ( closedPath ) {\r\n\t\t//\r\n\t\t// \tpoints.push( points[ 0 ] );\r\n\t\t//\r\n\t\t// }\r\n\t\r\n\t\treturn points;\r\n\t\r\n\t};\r\n\t\r\n\t/* Return an array of vectors based on contour of the path */\r\n\t\r\n\tTHREE.Path.prototype.getPoints = function( divisions, closedPath ) {\r\n\t\r\n\t\tdivisions = divisions || 12;\r\n\t\r\n\t\tvar b2 = THREE.ShapeUtils.b2;\r\n\t\tvar b3 = THREE.ShapeUtils.b3;\r\n\t\r\n\t\tvar points = [];\r\n\t\r\n\t\tvar cpx, cpy, cpx2, cpy2, cpx1, cpy1, cpx0, cpy0,\r\n\t\t\tlaste, tx, ty;\r\n\t\r\n\t\tfor ( var i = 0, l = this.actions.length; i < l; i ++ ) {\r\n\t\r\n\t\t\tvar item = this.actions[ i ];\r\n\t\r\n\t\t\tvar action = item.action;\r\n\t\t\tvar args = item.args;\r\n\t\r\n\t\t\tswitch ( action ) {\r\n\t\r\n\t\t\tcase 'moveTo':\r\n\t\r\n\t\t\t\tpoints.push( new THREE.Vector2( args[ 0 ], args[ 1 ] ) );\r\n\t\r\n\t\t\t\tbreak;\r\n\t\r\n\t\t\tcase 'lineTo':\r\n\t\r\n\t\t\t\tpoints.push( new THREE.Vector2( args[ 0 ], args[ 1 ] ) );\r\n\t\r\n\t\t\t\tbreak;\r\n\t\r\n\t\t\tcase 'quadraticCurveTo':\r\n\t\r\n\t\t\t\tcpx  = args[ 2 ];\r\n\t\t\t\tcpy  = args[ 3 ];\r\n\t\r\n\t\t\t\tcpx1 = args[ 0 ];\r\n\t\t\t\tcpy1 = args[ 1 ];\r\n\t\r\n\t\t\t\tif ( points.length > 0 ) {\r\n\t\r\n\t\t\t\t\tlaste = points[ points.length - 1 ];\r\n\t\r\n\t\t\t\t\tcpx0 = laste.x;\r\n\t\t\t\t\tcpy0 = laste.y;\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tlaste = this.actions[ i - 1 ].args;\r\n\t\r\n\t\t\t\t\tcpx0 = laste[ laste.length - 2 ];\r\n\t\t\t\t\tcpy0 = laste[ laste.length - 1 ];\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tfor ( var j = 1; j <= divisions; j ++ ) {\r\n\t\r\n\t\t\t\t\tvar t = j / divisions;\r\n\t\r\n\t\t\t\t\ttx = b2( t, cpx0, cpx1, cpx );\r\n\t\t\t\t\tty = b2( t, cpy0, cpy1, cpy );\r\n\t\r\n\t\t\t\t\tpoints.push( new THREE.Vector2( tx, ty ) );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tbreak;\r\n\t\r\n\t\t\tcase 'bezierCurveTo':\r\n\t\r\n\t\t\t\tcpx  = args[ 4 ];\r\n\t\t\t\tcpy  = args[ 5 ];\r\n\t\r\n\t\t\t\tcpx1 = args[ 0 ];\r\n\t\t\t\tcpy1 = args[ 1 ];\r\n\t\r\n\t\t\t\tcpx2 = args[ 2 ];\r\n\t\t\t\tcpy2 = args[ 3 ];\r\n\t\r\n\t\t\t\tif ( points.length > 0 ) {\r\n\t\r\n\t\t\t\t\tlaste = points[ points.length - 1 ];\r\n\t\r\n\t\t\t\t\tcpx0 = laste.x;\r\n\t\t\t\t\tcpy0 = laste.y;\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tlaste = this.actions[ i - 1 ].args;\r\n\t\r\n\t\t\t\t\tcpx0 = laste[ laste.length - 2 ];\r\n\t\t\t\t\tcpy0 = laste[ laste.length - 1 ];\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\r\n\t\t\t\tfor ( var j = 1; j <= divisions; j ++ ) {\r\n\t\r\n\t\t\t\t\tvar t = j / divisions;\r\n\t\r\n\t\t\t\t\ttx = b3( t, cpx0, cpx1, cpx2, cpx );\r\n\t\t\t\t\tty = b3( t, cpy0, cpy1, cpy2, cpy );\r\n\t\r\n\t\t\t\t\tpoints.push( new THREE.Vector2( tx, ty ) );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tbreak;\r\n\t\r\n\t\t\tcase 'splineThru':\r\n\t\r\n\t\t\t\tlaste = this.actions[ i - 1 ].args;\r\n\t\r\n\t\t\t\tvar last = new THREE.Vector2( laste[ laste.length - 2 ], laste[ laste.length - 1 ] );\r\n\t\t\t\tvar spts = [ last ];\r\n\t\r\n\t\t\t\tvar n = divisions * args[ 0 ].length;\r\n\t\r\n\t\t\t\tspts = spts.concat( args[ 0 ] );\r\n\t\r\n\t\t\t\tvar spline = new THREE.SplineCurve( spts );\r\n\t\r\n\t\t\t\tfor ( var j = 1; j <= n; j ++ ) {\r\n\t\r\n\t\t\t\t\tpoints.push( spline.getPointAt( j / n ) );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tbreak;\r\n\t\r\n\t\t\tcase 'arc':\r\n\t\r\n\t\t\t\tvar aX = args[ 0 ], aY = args[ 1 ],\r\n\t\t\t\t\taRadius = args[ 2 ],\r\n\t\t\t\t\taStartAngle = args[ 3 ], aEndAngle = args[ 4 ],\r\n\t\t\t\t\taClockwise = !! args[ 5 ];\r\n\t\r\n\t\t\t\tvar deltaAngle = aEndAngle - aStartAngle;\r\n\t\t\t\tvar angle;\r\n\t\t\t\tvar tdivisions = divisions * 2;\r\n\t\r\n\t\t\t\tfor ( var j = 1; j <= tdivisions; j ++ ) {\r\n\t\r\n\t\t\t\t\tvar t = j / tdivisions;\r\n\t\r\n\t\t\t\t\tif ( ! aClockwise ) {\r\n\t\r\n\t\t\t\t\t\tt = 1 - t;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tangle = aStartAngle + t * deltaAngle;\r\n\t\r\n\t\t\t\t\ttx = aX + aRadius * Math.cos( angle );\r\n\t\t\t\t\tty = aY + aRadius * Math.sin( angle );\r\n\t\r\n\t\t\t\t\t//console.log('t', t, 'angle', angle, 'tx', tx, 'ty', ty);\r\n\t\r\n\t\t\t\t\tpoints.push( new THREE.Vector2( tx, ty ) );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\t//console.log(points);\r\n\t\r\n\t\t\t\tbreak;\r\n\t\r\n\t\t\tcase 'ellipse':\r\n\t\r\n\t\t\t\tvar aX = args[ 0 ], aY = args[ 1 ],\r\n\t\t\t\t\txRadius = args[ 2 ],\r\n\t\t\t\t\tyRadius = args[ 3 ],\r\n\t\t\t\t\taStartAngle = args[ 4 ], aEndAngle = args[ 5 ],\r\n\t\t\t\t\taClockwise = !! args[ 6 ],\r\n\t\t\t\t\taRotation = args[ 7 ];\r\n\t\r\n\t\r\n\t\t\t\tvar deltaAngle = aEndAngle - aStartAngle;\r\n\t\t\t\tvar angle;\r\n\t\t\t\tvar tdivisions = divisions * 2;\r\n\t\r\n\t\t\t\tvar cos, sin;\r\n\t\t\t\tif ( aRotation !== 0 ) {\r\n\t\r\n\t\t\t\t\tcos = Math.cos( aRotation );\r\n\t\t\t\t\tsin = Math.sin( aRotation );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tfor ( var j = 1; j <= tdivisions; j ++ ) {\r\n\t\r\n\t\t\t\t\tvar t = j / tdivisions;\r\n\t\r\n\t\t\t\t\tif ( ! aClockwise ) {\r\n\t\r\n\t\t\t\t\t\tt = 1 - t;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tangle = aStartAngle + t * deltaAngle;\r\n\t\r\n\t\t\t\t\ttx = aX + xRadius * Math.cos( angle );\r\n\t\t\t\t\tty = aY + yRadius * Math.sin( angle );\r\n\t\r\n\t\t\t\t\tif ( aRotation !== 0 ) {\r\n\t\r\n\t\t\t\t\t\tvar x = tx, y = ty;\r\n\t\r\n\t\t\t\t\t\t// Rotate the point about the center of the ellipse.\r\n\t\t\t\t\t\ttx = ( x - aX ) * cos - ( y - aY ) * sin + aX;\r\n\t\t\t\t\t\tty = ( x - aX ) * sin + ( y - aY ) * cos + aY;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t//console.log('t', t, 'angle', angle, 'tx', tx, 'ty', ty);\r\n\t\r\n\t\t\t\t\tpoints.push( new THREE.Vector2( tx, ty ) );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\t//console.log(points);\r\n\t\r\n\t\t\t\tbreak;\r\n\t\r\n\t\t\t} // end switch\r\n\t\r\n\t\t}\r\n\t\r\n\t\r\n\t\r\n\t\t// Normalize to remove the closing point by default.\r\n\t\tvar lastPoint = points[ points.length - 1 ];\r\n\t\tif ( Math.abs( lastPoint.x - points[ 0 ].x ) < Number.EPSILON &&\r\n\t\t\t\t Math.abs( lastPoint.y - points[ 0 ].y ) < Number.EPSILON )\r\n\t\t\tpoints.splice( points.length - 1, 1 );\r\n\t\tif ( closedPath ) {\r\n\t\r\n\t\t\tpoints.push( points[ 0 ] );\r\n\t\r\n\t\t}\r\n\t\r\n\t\treturn points;\r\n\t\r\n\t};\r\n\t\r\n\t//\r\n\t// Breaks path into shapes\r\n\t//\r\n\t//\tAssumptions (if parameter isCCW==true the opposite holds):\r\n\t//\t- solid shapes are defined clockwise (CW)\r\n\t//\t- holes are defined counterclockwise (CCW)\r\n\t//\r\n\t//\tIf parameter noHoles==true:\r\n\t//  - all subPaths are regarded as solid shapes\r\n\t//  - definition order CW/CCW has no relevance\r\n\t//\r\n\t\r\n\tTHREE.Path.prototype.toShapes = function( isCCW, noHoles ) {\r\n\t\r\n\t\tfunction extractSubpaths( inActions ) {\r\n\t\r\n\t\t\tvar subPaths = [], lastPath = new THREE.Path();\r\n\t\r\n\t\t\tfor ( var i = 0, l = inActions.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\tvar item = inActions[ i ];\r\n\t\r\n\t\t\t\tvar args = item.args;\r\n\t\t\t\tvar action = item.action;\r\n\t\r\n\t\t\t\tif ( action === 'moveTo' ) {\r\n\t\r\n\t\t\t\t\tif ( lastPath.actions.length !== 0 ) {\r\n\t\r\n\t\t\t\t\t\tsubPaths.push( lastPath );\r\n\t\t\t\t\t\tlastPath = new THREE.Path();\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tlastPath[ action ].apply( lastPath, args );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( lastPath.actions.length !== 0 ) {\r\n\t\r\n\t\t\t\tsubPaths.push( lastPath );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// console.log(subPaths);\r\n\t\r\n\t\t\treturn\tsubPaths;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction toShapesNoHoles( inSubpaths ) {\r\n\t\r\n\t\t\tvar shapes = [];\r\n\t\r\n\t\t\tfor ( var i = 0, l = inSubpaths.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\tvar tmpPath = inSubpaths[ i ];\r\n\t\r\n\t\t\t\tvar tmpShape = new THREE.Shape();\r\n\t\t\t\ttmpShape.actions = tmpPath.actions;\r\n\t\t\t\ttmpShape.curves = tmpPath.curves;\r\n\t\r\n\t\t\t\tshapes.push( tmpShape );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t//console.log(\"shape\", shapes);\r\n\t\r\n\t\t\treturn shapes;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction isPointInsidePolygon( inPt, inPolygon ) {\r\n\t\r\n\t\t\tvar polyLen = inPolygon.length;\r\n\t\r\n\t\t\t// inPt on polygon contour => immediate success    or\r\n\t\t\t// toggling of inside/outside at every single! intersection point of an edge\r\n\t\t\t//  with the horizontal line through inPt, left of inPt\r\n\t\t\t//  not counting lowerY endpoints of edges and whole edges on that line\r\n\t\t\tvar inside = false;\r\n\t\t\tfor ( var p = polyLen - 1, q = 0; q < polyLen; p = q ++ ) {\r\n\t\r\n\t\t\t\tvar edgeLowPt  = inPolygon[ p ];\r\n\t\t\t\tvar edgeHighPt = inPolygon[ q ];\r\n\t\r\n\t\t\t\tvar edgeDx = edgeHighPt.x - edgeLowPt.x;\r\n\t\t\t\tvar edgeDy = edgeHighPt.y - edgeLowPt.y;\r\n\t\r\n\t\t\t\tif ( Math.abs( edgeDy ) > Number.EPSILON ) {\r\n\t\r\n\t\t\t\t\t// not parallel\r\n\t\t\t\t\tif ( edgeDy < 0 ) {\r\n\t\r\n\t\t\t\t\t\tedgeLowPt  = inPolygon[ q ]; edgeDx = - edgeDx;\r\n\t\t\t\t\t\tedgeHighPt = inPolygon[ p ]; edgeDy = - edgeDy;\r\n\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( ( inPt.y < edgeLowPt.y ) || ( inPt.y > edgeHighPt.y ) ) \t\tcontinue;\r\n\t\r\n\t\t\t\t\tif ( inPt.y === edgeLowPt.y ) {\r\n\t\r\n\t\t\t\t\t\tif ( inPt.x === edgeLowPt.x )\t\treturn\ttrue;\t\t// inPt is on contour ?\r\n\t\t\t\t\t\t// continue;\t\t\t\t// no intersection or edgeLowPt => doesn't count !!!\r\n\t\r\n\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\tvar perpEdge = edgeDy * ( inPt.x - edgeLowPt.x ) - edgeDx * ( inPt.y - edgeLowPt.y );\r\n\t\t\t\t\t\tif ( perpEdge === 0 )\t\t\t\treturn\ttrue;\t\t// inPt is on contour ?\r\n\t\t\t\t\t\tif ( perpEdge < 0 ) \t\t\t\tcontinue;\r\n\t\t\t\t\t\tinside = ! inside;\t\t// true intersection left of inPt\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t// parallel or collinear\r\n\t\t\t\t\tif ( inPt.y !== edgeLowPt.y ) \t\tcontinue;\t\t\t// parallel\r\n\t\t\t\t\t// edge lies on the same horizontal line as inPt\r\n\t\t\t\t\tif ( ( ( edgeHighPt.x <= inPt.x ) && ( inPt.x <= edgeLowPt.x ) ) ||\r\n\t\t\t\t\t\t ( ( edgeLowPt.x <= inPt.x ) && ( inPt.x <= edgeHighPt.x ) ) )\t\treturn\ttrue;\t// inPt: Point on contour !\r\n\t\t\t\t\t// continue;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn\tinside;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tvar isClockWise = THREE.ShapeUtils.isClockWise;\r\n\t\r\n\t\tvar subPaths = extractSubpaths( this.actions );\r\n\t\tif ( subPaths.length === 0 ) return [];\r\n\t\r\n\t\tif ( noHoles === true )\treturn\ttoShapesNoHoles( subPaths );\r\n\t\r\n\t\r\n\t\tvar solid, tmpPath, tmpShape, shapes = [];\r\n\t\r\n\t\tif ( subPaths.length === 1 ) {\r\n\t\r\n\t\t\ttmpPath = subPaths[ 0 ];\r\n\t\t\ttmpShape = new THREE.Shape();\r\n\t\t\ttmpShape.actions = tmpPath.actions;\r\n\t\t\ttmpShape.curves = tmpPath.curves;\r\n\t\t\tshapes.push( tmpShape );\r\n\t\t\treturn shapes;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tvar holesFirst = ! isClockWise( subPaths[ 0 ].getPoints() );\r\n\t\tholesFirst = isCCW ? ! holesFirst : holesFirst;\r\n\t\r\n\t\t// console.log(\"Holes first\", holesFirst);\r\n\t\r\n\t\tvar betterShapeHoles = [];\r\n\t\tvar newShapes = [];\r\n\t\tvar newShapeHoles = [];\r\n\t\tvar mainIdx = 0;\r\n\t\tvar tmpPoints;\r\n\t\r\n\t\tnewShapes[ mainIdx ] = undefined;\r\n\t\tnewShapeHoles[ mainIdx ] = [];\r\n\t\r\n\t\tfor ( var i = 0, l = subPaths.length; i < l; i ++ ) {\r\n\t\r\n\t\t\ttmpPath = subPaths[ i ];\r\n\t\t\ttmpPoints = tmpPath.getPoints();\r\n\t\t\tsolid = isClockWise( tmpPoints );\r\n\t\t\tsolid = isCCW ? ! solid : solid;\r\n\t\r\n\t\t\tif ( solid ) {\r\n\t\r\n\t\t\t\tif ( ( ! holesFirst ) && ( newShapes[ mainIdx ] ) )\tmainIdx ++;\r\n\t\r\n\t\t\t\tnewShapes[ mainIdx ] = { s: new THREE.Shape(), p: tmpPoints };\r\n\t\t\t\tnewShapes[ mainIdx ].s.actions = tmpPath.actions;\r\n\t\t\t\tnewShapes[ mainIdx ].s.curves = tmpPath.curves;\r\n\t\r\n\t\t\t\tif ( holesFirst )\tmainIdx ++;\r\n\t\t\t\tnewShapeHoles[ mainIdx ] = [];\r\n\t\r\n\t\t\t\t//console.log('cw', i);\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\tnewShapeHoles[ mainIdx ].push( { h: tmpPath, p: tmpPoints[ 0 ] } );\r\n\t\r\n\t\t\t\t//console.log('ccw', i);\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\t// only Holes? -> probably all Shapes with wrong orientation\r\n\t\tif ( ! newShapes[ 0 ] )\treturn\ttoShapesNoHoles( subPaths );\r\n\t\r\n\t\r\n\t\tif ( newShapes.length > 1 ) {\r\n\t\r\n\t\t\tvar ambiguous = false;\r\n\t\t\tvar toChange = [];\r\n\t\r\n\t\t\tfor ( var sIdx = 0, sLen = newShapes.length; sIdx < sLen; sIdx ++ ) {\r\n\t\r\n\t\t\t\tbetterShapeHoles[ sIdx ] = [];\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tfor ( var sIdx = 0, sLen = newShapes.length; sIdx < sLen; sIdx ++ ) {\r\n\t\r\n\t\t\t\tvar sho = newShapeHoles[ sIdx ];\r\n\t\r\n\t\t\t\tfor ( var hIdx = 0; hIdx < sho.length; hIdx ++ ) {\r\n\t\r\n\t\t\t\t\tvar ho = sho[ hIdx ];\r\n\t\t\t\t\tvar hole_unassigned = true;\r\n\t\r\n\t\t\t\t\tfor ( var s2Idx = 0; s2Idx < newShapes.length; s2Idx ++ ) {\r\n\t\r\n\t\t\t\t\t\tif ( isPointInsidePolygon( ho.p, newShapes[ s2Idx ].p ) ) {\r\n\t\r\n\t\t\t\t\t\t\tif ( sIdx !== s2Idx )\ttoChange.push( { froms: sIdx, tos: s2Idx, hole: hIdx } );\r\n\t\t\t\t\t\t\tif ( hole_unassigned ) {\r\n\t\r\n\t\t\t\t\t\t\t\thole_unassigned = false;\r\n\t\t\t\t\t\t\t\tbetterShapeHoles[ s2Idx ].push( ho );\r\n\t\r\n\t\t\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\t\t\tambiguous = true;\r\n\t\r\n\t\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( hole_unassigned ) {\r\n\t\r\n\t\t\t\t\t\tbetterShapeHoles[ sIdx ].push( ho );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\t\t// console.log(\"ambiguous: \", ambiguous);\r\n\t\t\tif ( toChange.length > 0 ) {\r\n\t\r\n\t\t\t\t// console.log(\"to change: \", toChange);\r\n\t\t\t\tif ( ! ambiguous )\tnewShapeHoles = betterShapeHoles;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tvar tmpHoles;\r\n\t\r\n\t\tfor ( var i = 0, il = newShapes.length; i < il; i ++ ) {\r\n\t\r\n\t\t\ttmpShape = newShapes[ i ].s;\r\n\t\t\tshapes.push( tmpShape );\r\n\t\t\ttmpHoles = newShapeHoles[ i ];\r\n\t\r\n\t\t\tfor ( var j = 0, jl = tmpHoles.length; j < jl; j ++ ) {\r\n\t\r\n\t\t\t\ttmpShape.holes.push( tmpHoles[ j ].h );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\t//console.log(\"shape\", shapes);\r\n\t\r\n\t\treturn shapes;\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/extras/core/Shape.js\r\n\t\r\n\t/**\r\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\r\n\t * Defines a 2d shape plane using paths.\r\n\t **/\r\n\t\r\n\t// STEP 1 Create a path.\r\n\t// STEP 2 Turn path into shape.\r\n\t// STEP 3 ExtrudeGeometry takes in Shape/Shapes\r\n\t// STEP 3a - Extract points from each shape, turn to vertices\r\n\t// STEP 3b - Triangulate each shape, add faces.\r\n\t\r\n\tTHREE.Shape = function () {\r\n\t\r\n\t\tTHREE.Path.apply( this, arguments );\r\n\t\r\n\t\tthis.holes = [];\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Shape.prototype = Object.create( THREE.Path.prototype );\r\n\tTHREE.Shape.prototype.constructor = THREE.Shape;\r\n\t\r\n\t// Convenience method to return ExtrudeGeometry\r\n\t\r\n\tTHREE.Shape.prototype.extrude = function ( options ) {\r\n\t\r\n\t\treturn new THREE.ExtrudeGeometry( this, options );\r\n\t\r\n\t};\r\n\t\r\n\t// Convenience method to return ShapeGeometry\r\n\t\r\n\tTHREE.Shape.prototype.makeGeometry = function ( options ) {\r\n\t\r\n\t\treturn new THREE.ShapeGeometry( this, options );\r\n\t\r\n\t};\r\n\t\r\n\t// Get points of holes\r\n\t\r\n\tTHREE.Shape.prototype.getPointsHoles = function ( divisions ) {\r\n\t\r\n\t\tvar holesPts = [];\r\n\t\r\n\t\tfor ( var i = 0, l = this.holes.length; i < l; i ++ ) {\r\n\t\r\n\t\t\tholesPts[ i ] = this.holes[ i ].getPoints( divisions );\r\n\t\r\n\t\t}\r\n\t\r\n\t\treturn holesPts;\r\n\t\r\n\t};\r\n\t\r\n\t\r\n\t// Get points of shape and holes (keypoints based on segments parameter)\r\n\t\r\n\tTHREE.Shape.prototype.extractAllPoints = function ( divisions ) {\r\n\t\r\n\t\treturn {\r\n\t\r\n\t\t\tshape: this.getPoints( divisions ),\r\n\t\t\tholes: this.getPointsHoles( divisions )\r\n\t\r\n\t\t};\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Shape.prototype.extractPoints = function ( divisions ) {\r\n\t\r\n\t\treturn this.extractAllPoints( divisions );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.Shape.Utils = THREE.ShapeUtils; // backwards compatibility\r\n\t\r\n\t// File:src/extras/curves/LineCurve.js\r\n\t\r\n\t/**************************************************************\r\n\t *\tLine\r\n\t **************************************************************/\r\n\t\r\n\tTHREE.LineCurve = function ( v1, v2 ) {\r\n\t\r\n\t\tthis.v1 = v1;\r\n\t\tthis.v2 = v2;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.LineCurve.prototype = Object.create( THREE.Curve.prototype );\r\n\tTHREE.LineCurve.prototype.constructor = THREE.LineCurve;\r\n\t\r\n\tTHREE.LineCurve.prototype.getPoint = function ( t ) {\r\n\t\r\n\t\tvar point = this.v2.clone().sub( this.v1 );\r\n\t\tpoint.multiplyScalar( t ).add( this.v1 );\r\n\t\r\n\t\treturn point;\r\n\t\r\n\t};\r\n\t\r\n\t// Line curve is linear, so we can overwrite default getPointAt\r\n\t\r\n\tTHREE.LineCurve.prototype.getPointAt = function ( u ) {\r\n\t\r\n\t\treturn this.getPoint( u );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.LineCurve.prototype.getTangent = function( t ) {\r\n\t\r\n\t\tvar tangent = this.v2.clone().sub( this.v1 );\r\n\t\r\n\t\treturn tangent.normalize();\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/extras/curves/QuadraticBezierCurve.js\r\n\t\r\n\t/**************************************************************\r\n\t *\tQuadratic Bezier curve\r\n\t **************************************************************/\r\n\t\r\n\t\r\n\tTHREE.QuadraticBezierCurve = function ( v0, v1, v2 ) {\r\n\t\r\n\t\tthis.v0 = v0;\r\n\t\tthis.v1 = v1;\r\n\t\tthis.v2 = v2;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.QuadraticBezierCurve.prototype = Object.create( THREE.Curve.prototype );\r\n\tTHREE.QuadraticBezierCurve.prototype.constructor = THREE.QuadraticBezierCurve;\r\n\t\r\n\t\r\n\tTHREE.QuadraticBezierCurve.prototype.getPoint = function ( t ) {\r\n\t\r\n\t\tvar b2 = THREE.ShapeUtils.b2;\r\n\t\r\n\t\treturn new THREE.Vector2(\r\n\t\t\tb2( t, this.v0.x, this.v1.x, this.v2.x ),\r\n\t\t\tb2( t, this.v0.y, this.v1.y, this.v2.y )\r\n\t\t);\r\n\t\r\n\t};\r\n\t\r\n\t\r\n\tTHREE.QuadraticBezierCurve.prototype.getTangent = function( t ) {\r\n\t\r\n\t\tvar tangentQuadraticBezier = THREE.CurveUtils.tangentQuadraticBezier;\r\n\t\r\n\t\treturn new THREE.Vector2(\r\n\t\t\ttangentQuadraticBezier( t, this.v0.x, this.v1.x, this.v2.x ),\r\n\t\t\ttangentQuadraticBezier( t, this.v0.y, this.v1.y, this.v2.y )\r\n\t\t).normalize();\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/extras/curves/CubicBezierCurve.js\r\n\t\r\n\t/**************************************************************\r\n\t *\tCubic Bezier curve\r\n\t **************************************************************/\r\n\t\r\n\tTHREE.CubicBezierCurve = function ( v0, v1, v2, v3 ) {\r\n\t\r\n\t\tthis.v0 = v0;\r\n\t\tthis.v1 = v1;\r\n\t\tthis.v2 = v2;\r\n\t\tthis.v3 = v3;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.CubicBezierCurve.prototype = Object.create( THREE.Curve.prototype );\r\n\tTHREE.CubicBezierCurve.prototype.constructor = THREE.CubicBezierCurve;\r\n\t\r\n\tTHREE.CubicBezierCurve.prototype.getPoint = function ( t ) {\r\n\t\r\n\t\tvar b3 = THREE.ShapeUtils.b3;\r\n\t\r\n\t\treturn new THREE.Vector2( \r\n\t\t\tb3( t, this.v0.x, this.v1.x, this.v2.x, this.v3.x ),\r\n\t\t\tb3( t, this.v0.y, this.v1.y, this.v2.y, this.v3.y )\r\n\t\t);\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.CubicBezierCurve.prototype.getTangent = function( t ) {\r\n\t\r\n\t\tvar tangentCubicBezier = THREE.CurveUtils.tangentCubicBezier;\r\n\t\r\n\t\treturn new THREE.Vector2( \r\n\t\t\ttangentCubicBezier( t, this.v0.x, this.v1.x, this.v2.x, this.v3.x ),\r\n\t\t\ttangentCubicBezier( t, this.v0.y, this.v1.y, this.v2.y, this.v3.y )\r\n\t\t).normalize();\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/extras/curves/SplineCurve.js\r\n\t\r\n\t/**************************************************************\r\n\t *\tSpline curve\r\n\t **************************************************************/\r\n\t\r\n\tTHREE.SplineCurve = function ( points /* array of Vector2 */ ) {\r\n\t\r\n\t\tthis.points = ( points == undefined ) ? [] : points;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.SplineCurve.prototype = Object.create( THREE.Curve.prototype );\r\n\tTHREE.SplineCurve.prototype.constructor = THREE.SplineCurve;\r\n\t\r\n\tTHREE.SplineCurve.prototype.getPoint = function ( t ) {\r\n\t\r\n\t\tvar points = this.points;\r\n\t\tvar point = ( points.length - 1 ) * t;\r\n\t\r\n\t\tvar intPoint = Math.floor( point );\r\n\t\tvar weight = point - intPoint;\r\n\t\r\n\t\tvar point0 = points[ intPoint === 0 ? intPoint : intPoint - 1 ];\r\n\t\tvar point1 = points[ intPoint ];\r\n\t\tvar point2 = points[ intPoint > points.length - 2 ? points.length - 1 : intPoint + 1 ];\r\n\t\tvar point3 = points[ intPoint > points.length - 3 ? points.length - 1 : intPoint + 2 ];\r\n\t\r\n\t\tvar interpolate = THREE.CurveUtils.interpolate;\r\n\t\r\n\t\treturn new THREE.Vector2(\r\n\t\t\tinterpolate( point0.x, point1.x, point2.x, point3.x, weight ),\r\n\t\t\tinterpolate( point0.y, point1.y, point2.y, point3.y, weight )\r\n\t\t);\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/extras/curves/EllipseCurve.js\r\n\t\r\n\t/**************************************************************\r\n\t *\tEllipse curve\r\n\t **************************************************************/\r\n\t\r\n\tTHREE.EllipseCurve = function ( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation ) {\r\n\t\r\n\t\tthis.aX = aX;\r\n\t\tthis.aY = aY;\r\n\t\r\n\t\tthis.xRadius = xRadius;\r\n\t\tthis.yRadius = yRadius;\r\n\t\r\n\t\tthis.aStartAngle = aStartAngle;\r\n\t\tthis.aEndAngle = aEndAngle;\r\n\t\r\n\t\tthis.aClockwise = aClockwise;\r\n\t\t\r\n\t\tthis.aRotation = aRotation || 0;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.EllipseCurve.prototype = Object.create( THREE.Curve.prototype );\r\n\tTHREE.EllipseCurve.prototype.constructor = THREE.EllipseCurve;\r\n\t\r\n\tTHREE.EllipseCurve.prototype.getPoint = function ( t ) {\r\n\t\r\n\t\tvar deltaAngle = this.aEndAngle - this.aStartAngle;\r\n\t\r\n\t\tif ( deltaAngle < 0 ) deltaAngle += Math.PI * 2;\r\n\t\tif ( deltaAngle > Math.PI * 2 ) deltaAngle -= Math.PI * 2;\r\n\t\r\n\t\tvar angle;\r\n\t\r\n\t\tif ( this.aClockwise === true ) {\r\n\t\r\n\t\t\tangle = this.aEndAngle + ( 1 - t ) * ( Math.PI * 2 - deltaAngle );\r\n\t\r\n\t\t} else {\r\n\t\r\n\t\t\tangle = this.aStartAngle + t * deltaAngle;\r\n\t\r\n\t\t}\r\n\t\t\r\n\t\tvar x = this.aX + this.xRadius * Math.cos( angle );\r\n\t\tvar y = this.aY + this.yRadius * Math.sin( angle );\r\n\t\r\n\t\tif ( this.aRotation !== 0 ) {\r\n\t\r\n\t\t\tvar cos = Math.cos( this.aRotation );\r\n\t\t\tvar sin = Math.sin( this.aRotation );\r\n\t\r\n\t\t\tvar tx = x, ty = y;\r\n\t\r\n\t\t\t// Rotate the point about the center of the ellipse.\r\n\t\t\tx = ( tx - this.aX ) * cos - ( ty - this.aY ) * sin + this.aX;\r\n\t\t\ty = ( tx - this.aX ) * sin + ( ty - this.aY ) * cos + this.aY;\r\n\t\r\n\t\t}\r\n\t\r\n\t\treturn new THREE.Vector2( x, y );\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/extras/curves/ArcCurve.js\r\n\t\r\n\t/**************************************************************\r\n\t *\tArc curve\r\n\t **************************************************************/\r\n\t\r\n\tTHREE.ArcCurve = function ( aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise ) {\r\n\t\r\n\t\tTHREE.EllipseCurve.call( this, aX, aY, aRadius, aRadius, aStartAngle, aEndAngle, aClockwise );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.ArcCurve.prototype = Object.create( THREE.EllipseCurve.prototype );\r\n\tTHREE.ArcCurve.prototype.constructor = THREE.ArcCurve;\r\n\t\r\n\t// File:src/extras/curves/LineCurve3.js\r\n\t\r\n\t/**************************************************************\r\n\t *\tLine3D\r\n\t **************************************************************/\r\n\t\r\n\tTHREE.LineCurve3 = THREE.Curve.create(\r\n\t\r\n\t\tfunction ( v1, v2 ) {\r\n\t\r\n\t\t\tthis.v1 = v1;\r\n\t\t\tthis.v2 = v2;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tfunction ( t ) {\r\n\t\r\n\t\t\tvar vector = new THREE.Vector3();\r\n\t\r\n\t\t\tvector.subVectors( this.v2, this.v1 ); // diff\r\n\t\t\tvector.multiplyScalar( t );\r\n\t\t\tvector.add( this.v1 );\r\n\t\r\n\t\t\treturn vector;\r\n\t\r\n\t\t}\r\n\t\r\n\t);\r\n\t\r\n\t// File:src/extras/curves/QuadraticBezierCurve3.js\r\n\t\r\n\t/**************************************************************\r\n\t *\tQuadratic Bezier 3D curve\r\n\t **************************************************************/\r\n\t\r\n\tTHREE.QuadraticBezierCurve3 = THREE.Curve.create(\r\n\t\r\n\t\tfunction ( v0, v1, v2 ) {\r\n\t\r\n\t\t\tthis.v0 = v0;\r\n\t\t\tthis.v1 = v1;\r\n\t\t\tthis.v2 = v2;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tfunction ( t ) {\r\n\t\r\n\t\t\tvar b2 = THREE.ShapeUtils.b2;\t\t\r\n\t\r\n\t\t\treturn new THREE.Vector3(\r\n\t\t\t\tb2( t, this.v0.x, this.v1.x, this.v2.x ),\r\n\t\t\t\tb2( t, this.v0.y, this.v1.y, this.v2.y ),\r\n\t\t\t\tb2( t, this.v0.z, this.v1.z, this.v2.z )\r\n\t\t\t);\r\n\t\r\n\t\t}\r\n\t\r\n\t);\r\n\t\r\n\t// File:src/extras/curves/CubicBezierCurve3.js\r\n\t\r\n\t/**************************************************************\r\n\t *\tCubic Bezier 3D curve\r\n\t **************************************************************/\r\n\t\r\n\tTHREE.CubicBezierCurve3 = THREE.Curve.create(\r\n\t\r\n\t\tfunction ( v0, v1, v2, v3 ) {\r\n\t\r\n\t\t\tthis.v0 = v0;\r\n\t\t\tthis.v1 = v1;\r\n\t\t\tthis.v2 = v2;\r\n\t\t\tthis.v3 = v3;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tfunction ( t ) {\r\n\t\r\n\t\t\tvar b3 = THREE.ShapeUtils.b3;\r\n\t\r\n\t\t\treturn new THREE.Vector3(\r\n\t\t\t\tb3( t, this.v0.x, this.v1.x, this.v2.x, this.v3.x ),\r\n\t\t\t\tb3( t, this.v0.y, this.v1.y, this.v2.y, this.v3.y ),\r\n\t\t\t\tb3( t, this.v0.z, this.v1.z, this.v2.z, this.v3.z )\r\n\t\t\t);\r\n\t\r\n\t\t}\r\n\t\r\n\t);\r\n\t\r\n\t// File:src/extras/curves/SplineCurve3.js\r\n\t\r\n\t/**************************************************************\r\n\t *\tSpline 3D curve\r\n\t **************************************************************/\r\n\t\r\n\t\r\n\tTHREE.SplineCurve3 = THREE.Curve.create(\r\n\t\r\n\t\tfunction ( points /* array of Vector3 */ ) {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.SplineCurve3 will be deprecated. Please use THREE.CatmullRomCurve3' );\r\n\t\t\tthis.points = ( points == undefined ) ? [] : points;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tfunction ( t ) {\r\n\t\r\n\t\t\tvar points = this.points;\r\n\t\t\tvar point = ( points.length - 1 ) * t;\r\n\t\r\n\t\t\tvar intPoint = Math.floor( point );\r\n\t\t\tvar weight = point - intPoint;\r\n\t\r\n\t\t\tvar point0 = points[ intPoint == 0 ? intPoint : intPoint - 1 ];\r\n\t\t\tvar point1 = points[ intPoint ];\r\n\t\t\tvar point2 = points[ intPoint > points.length - 2 ? points.length - 1 : intPoint + 1 ];\r\n\t\t\tvar point3 = points[ intPoint > points.length - 3 ? points.length - 1 : intPoint + 2 ];\r\n\t\r\n\t\t\tvar interpolate = THREE.CurveUtils.interpolate;\r\n\t\r\n\t\t\treturn new THREE.Vector3(\r\n\t\t\t\tinterpolate( point0.x, point1.x, point2.x, point3.x, weight ),\r\n\t\t\t\tinterpolate( point0.y, point1.y, point2.y, point3.y, weight ),\r\n\t\t\t\tinterpolate( point0.z, point1.z, point2.z, point3.z, weight )\r\n\t\t\t);\r\n\t\r\n\t\t}\r\n\t\r\n\t);\r\n\t\r\n\t// File:src/extras/curves/CatmullRomCurve3.js\r\n\t\r\n\t/**\r\n\t * @author zz85 https://github.com/zz85\r\n\t *\r\n\t * Centripetal CatmullRom Curve - which is useful for avoiding\r\n\t * cusps and self-intersections in non-uniform catmull rom curves.\r\n\t * http://www.cemyuksel.com/research/catmullrom_param/catmullrom.pdf\r\n\t *\r\n\t * curve.type accepts centripetal(default), chordal and catmullrom\r\n\t * curve.tension is used for catmullrom which defaults to 0.5\r\n\t */\r\n\t\r\n\tTHREE.CatmullRomCurve3 = ( function() {\r\n\t\r\n\t\tvar\r\n\t\t\ttmp = new THREE.Vector3(),\r\n\t\t\tpx = new CubicPoly(),\r\n\t\t\tpy = new CubicPoly(),\r\n\t\t\tpz = new CubicPoly();\r\n\t\r\n\t\t/*\r\n\t\tBased on an optimized c++ solution in\r\n\t\t - http://stackoverflow.com/questions/9489736/catmull-rom-curve-with-no-cusps-and-no-self-intersections/\r\n\t\t - http://ideone.com/NoEbVM\r\n\t\r\n\t\tThis CubicPoly class could be used for reusing some variables and calculations,\r\n\t\tbut for three.js curve use, it could be possible inlined and flatten into a single function call\r\n\t\twhich can be placed in CurveUtils.\r\n\t\t*/\r\n\t\r\n\t\tfunction CubicPoly() {\r\n\t\r\n\t\t}\r\n\t\r\n\t\t/*\r\n\t\t * Compute coefficients for a cubic polynomial\r\n\t\t *   p(s) = c0 + c1*s + c2*s^2 + c3*s^3\r\n\t\t * such that\r\n\t\t *   p(0) = x0, p(1) = x1\r\n\t\t *  and\r\n\t\t *   p'(0) = t0, p'(1) = t1.\r\n\t\t */\r\n\t\tCubicPoly.prototype.init = function( x0, x1, t0, t1 ) {\r\n\t\r\n\t\t\tthis.c0 = x0;\r\n\t\t\tthis.c1 = t0;\r\n\t\t\tthis.c2 = - 3 * x0 + 3 * x1 - 2 * t0 - t1;\r\n\t\t\tthis.c3 = 2 * x0 - 2 * x1 + t0 + t1;\r\n\t\r\n\t\t};\r\n\t\r\n\t\tCubicPoly.prototype.initNonuniformCatmullRom = function( x0, x1, x2, x3, dt0, dt1, dt2 ) {\r\n\t\r\n\t\t\t// compute tangents when parameterized in [t1,t2]\r\n\t\t\tvar t1 = ( x1 - x0 ) / dt0 - ( x2 - x0 ) / ( dt0 + dt1 ) + ( x2 - x1 ) / dt1;\r\n\t\t\tvar t2 = ( x2 - x1 ) / dt1 - ( x3 - x1 ) / ( dt1 + dt2 ) + ( x3 - x2 ) / dt2;\r\n\t\r\n\t\t\t// rescale tangents for parametrization in [0,1]\r\n\t\t\tt1 *= dt1;\r\n\t\t\tt2 *= dt1;\r\n\t\r\n\t\t\t// initCubicPoly\r\n\t\t\tthis.init( x1, x2, t1, t2 );\r\n\t\r\n\t\t};\r\n\t\r\n\t\t// standard Catmull-Rom spline: interpolate between x1 and x2 with previous/following points x1/x4\r\n\t\tCubicPoly.prototype.initCatmullRom = function( x0, x1, x2, x3, tension ) {\r\n\t\r\n\t\t\tthis.init( x1, x2, tension * ( x2 - x0 ), tension * ( x3 - x1 ) );\r\n\t\r\n\t\t};\r\n\t\r\n\t\tCubicPoly.prototype.calc = function( t ) {\r\n\t\r\n\t\t\tvar t2 = t * t;\r\n\t\t\tvar t3 = t2 * t;\r\n\t\t\treturn this.c0 + this.c1 * t + this.c2 * t2 + this.c3 * t3;\r\n\t\r\n\t\t};\r\n\t\r\n\t\t// Subclass Three.js curve\r\n\t\treturn THREE.Curve.create(\r\n\t\r\n\t\t\tfunction ( p /* array of Vector3 */ ) {\r\n\t\r\n\t\t\t\tthis.points = p || [];\r\n\t\r\n\t\t\t},\r\n\t\r\n\t\t\tfunction ( t ) {\r\n\t\r\n\t\t\t\tvar points = this.points,\r\n\t\t\t\t\tpoint, intPoint, weight, l;\r\n\t\r\n\t\t\t\tl = points.length;\r\n\t\r\n\t\t\t\tif ( l < 2 ) console.log( 'duh, you need at least 2 points' );\r\n\t\r\n\t\t\t\tpoint = ( l - 1 ) * t;\r\n\t\t\t\tintPoint = Math.floor( point );\r\n\t\t\t\tweight = point - intPoint;\r\n\t\r\n\t\t\t\tif ( weight === 0 && intPoint === l - 1 ) {\r\n\t\r\n\t\t\t\t\tintPoint = l - 2;\r\n\t\t\t\t\tweight = 1;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tvar p0, p1, p2, p3;\r\n\t\r\n\t\t\t\tif ( intPoint === 0 ) {\r\n\t\r\n\t\t\t\t\t// extrapolate first point\r\n\t\t\t\t\ttmp.subVectors( points[ 0 ], points[ 1 ] ).add( points[ 0 ] );\r\n\t\t\t\t\tp0 = tmp;\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tp0 = points[ intPoint - 1 ];\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tp1 = points[ intPoint ];\r\n\t\t\t\tp2 = points[ intPoint + 1 ];\r\n\t\r\n\t\t\t\tif ( intPoint + 2 < l ) {\r\n\t\r\n\t\t\t\t\tp3 = points[ intPoint + 2 ]\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t// extrapolate last point\r\n\t\t\t\t\ttmp.subVectors( points[ l - 1 ], points[ l - 2 ] ).add( points[ l - 2 ] );\r\n\t\t\t\t\tp3 = tmp;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( this.type === undefined || this.type === 'centripetal' || this.type === 'chordal' ) {\r\n\t\r\n\t\t\t\t\t// init Centripetal / Chordal Catmull-Rom\r\n\t\t\t\t\tvar pow = this.type === 'chordal' ? 0.5 : 0.25;\r\n\t\t\t\t\tvar dt0 = Math.pow( p0.distanceToSquared( p1 ), pow );\r\n\t\t\t\t\tvar dt1 = Math.pow( p1.distanceToSquared( p2 ), pow );\r\n\t\t\t\t\tvar dt2 = Math.pow( p2.distanceToSquared( p3 ), pow );\r\n\t\r\n\t\t\t\t\t// safety check for repeated points\r\n\t\t\t\t\tif ( dt1 < 1e-4 ) dt1 = 1.0;\r\n\t\t\t\t\tif ( dt0 < 1e-4 ) dt0 = dt1;\r\n\t\t\t\t\tif ( dt2 < 1e-4 ) dt2 = dt1;\r\n\t\r\n\t\t\t\t\tpx.initNonuniformCatmullRom( p0.x, p1.x, p2.x, p3.x, dt0, dt1, dt2 );\r\n\t\t\t\t\tpy.initNonuniformCatmullRom( p0.y, p1.y, p2.y, p3.y, dt0, dt1, dt2 );\r\n\t\t\t\t\tpz.initNonuniformCatmullRom( p0.z, p1.z, p2.z, p3.z, dt0, dt1, dt2 );\r\n\t\r\n\t\t\t\t} else if ( this.type === 'catmullrom' ) {\r\n\t\r\n\t\t\t\t\tvar tension = this.tension !== undefined ? this.tension : 0.5;\r\n\t\t\t\t\tpx.initCatmullRom( p0.x, p1.x, p2.x, p3.x, tension );\r\n\t\t\t\t\tpy.initCatmullRom( p0.y, p1.y, p2.y, p3.y, tension );\r\n\t\t\t\t\tpz.initCatmullRom( p0.z, p1.z, p2.z, p3.z, tension );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tvar v = new THREE.Vector3(\r\n\t\t\t\t\tpx.calc( weight ),\r\n\t\t\t\t\tpy.calc( weight ),\r\n\t\t\t\t\tpz.calc( weight )\r\n\t\t\t\t);\r\n\t\r\n\t\t\t\treturn v;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t);\r\n\t\r\n\t} )();\r\n\t\r\n\t// File:src/extras/curves/ClosedSplineCurve3.js\r\n\t\r\n\t/**************************************************************\r\n\t *\tClosed Spline 3D curve\r\n\t **************************************************************/\r\n\t\r\n\t\r\n\tTHREE.ClosedSplineCurve3 = THREE.Curve.create(\r\n\t\r\n\t\tfunction ( points /* array of Vector3 */ ) {\r\n\t\r\n\t\t\tthis.points = ( points == undefined ) ? [] : points;\r\n\t\r\n\t\t},\r\n\t\r\n\t\tfunction ( t ) {\r\n\t\r\n\t\t\tvar points = this.points;\r\n\t\t\tvar point = ( points.length - 0 ) * t; // This needs to be from 0-length +1\r\n\t\r\n\t\t\tvar intPoint = Math.floor( point );\r\n\t\t\tvar weight = point - intPoint;\r\n\t\r\n\t\t\tintPoint += intPoint > 0 ? 0 : ( Math.floor( Math.abs( intPoint ) / points.length ) + 1 ) * points.length;\r\n\t\r\n\t\t\tvar point0 = points[ ( intPoint - 1 ) % points.length ];\r\n\t\t\tvar point1 = points[ ( intPoint     ) % points.length ];\r\n\t\t\tvar point2 = points[ ( intPoint + 1 ) % points.length ];\r\n\t\t\tvar point3 = points[ ( intPoint + 2 ) % points.length ];\r\n\t\r\n\t\t\tvar interpolate = THREE.CurveUtils.interpolate;\r\n\t\r\n\t\t\treturn new THREE.Vector3(\r\n\t\t\t\tinterpolate( point0.x, point1.x, point2.x, point3.x, weight ),\r\n\t\t\t\tinterpolate( point0.y, point1.y, point2.y, point3.y, weight ),\r\n\t\t\t\tinterpolate( point0.z, point1.z, point2.z, point3.z, weight )\r\n\t\t\t);\r\n\t\r\n\t\t}\r\n\t\r\n\t);\r\n\t\r\n\t// File:src/extras/geometries/BoxGeometry.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * based on http://papervision3d.googlecode.com/svn/trunk/as3/trunk/src/org/papervision3d/objects/primitives/Cube.as\r\n\t */\r\n\t\r\n\tTHREE.BoxGeometry = function ( width, height, depth, widthSegments, heightSegments, depthSegments ) {\r\n\t\r\n\t\tTHREE.Geometry.call( this );\r\n\t\r\n\t\tthis.type = 'BoxGeometry';\r\n\t\r\n\t\tthis.parameters = {\r\n\t\t\twidth: width,\r\n\t\t\theight: height,\r\n\t\t\tdepth: depth,\r\n\t\t\twidthSegments: widthSegments,\r\n\t\t\theightSegments: heightSegments,\r\n\t\t\tdepthSegments: depthSegments\r\n\t\t};\r\n\t\r\n\t\tthis.widthSegments = widthSegments || 1;\r\n\t\tthis.heightSegments = heightSegments || 1;\r\n\t\tthis.depthSegments = depthSegments || 1;\r\n\t\r\n\t\tvar scope = this;\r\n\t\r\n\t\tvar width_half = width / 2;\r\n\t\tvar height_half = height / 2;\r\n\t\tvar depth_half = depth / 2;\r\n\t\r\n\t\tbuildPlane( 'z', 'y', - 1, - 1, depth, height, width_half, 0 ); // px\r\n\t\tbuildPlane( 'z', 'y',   1, - 1, depth, height, - width_half, 1 ); // nx\r\n\t\tbuildPlane( 'x', 'z',   1,   1, width, depth, height_half, 2 ); // py\r\n\t\tbuildPlane( 'x', 'z',   1, - 1, width, depth, - height_half, 3 ); // ny\r\n\t\tbuildPlane( 'x', 'y',   1, - 1, width, height, depth_half, 4 ); // pz\r\n\t\tbuildPlane( 'x', 'y', - 1, - 1, width, height, - depth_half, 5 ); // nz\r\n\t\r\n\t\tfunction buildPlane( u, v, udir, vdir, width, height, depth, materialIndex ) {\r\n\t\r\n\t\t\tvar w, ix, iy,\r\n\t\t\tgridX = scope.widthSegments,\r\n\t\t\tgridY = scope.heightSegments,\r\n\t\t\twidth_half = width / 2,\r\n\t\t\theight_half = height / 2,\r\n\t\t\toffset = scope.vertices.length;\r\n\t\r\n\t\t\tif ( ( u === 'x' && v === 'y' ) || ( u === 'y' && v === 'x' ) ) {\r\n\t\r\n\t\t\t\tw = 'z';\r\n\t\r\n\t\t\t} else if ( ( u === 'x' && v === 'z' ) || ( u === 'z' && v === 'x' ) ) {\r\n\t\r\n\t\t\t\tw = 'y';\r\n\t\t\t\tgridY = scope.depthSegments;\r\n\t\r\n\t\t\t} else if ( ( u === 'z' && v === 'y' ) || ( u === 'y' && v === 'z' ) ) {\r\n\t\r\n\t\t\t\tw = 'x';\r\n\t\t\t\tgridX = scope.depthSegments;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar gridX1 = gridX + 1,\r\n\t\t\tgridY1 = gridY + 1,\r\n\t\t\tsegment_width = width / gridX,\r\n\t\t\tsegment_height = height / gridY,\r\n\t\t\tnormal = new THREE.Vector3();\r\n\t\r\n\t\t\tnormal[ w ] = depth > 0 ? 1 : - 1;\r\n\t\r\n\t\t\tfor ( iy = 0; iy < gridY1; iy ++ ) {\r\n\t\r\n\t\t\t\tfor ( ix = 0; ix < gridX1; ix ++ ) {\r\n\t\r\n\t\t\t\t\tvar vector = new THREE.Vector3();\r\n\t\t\t\t\tvector[ u ] = ( ix * segment_width - width_half ) * udir;\r\n\t\t\t\t\tvector[ v ] = ( iy * segment_height - height_half ) * vdir;\r\n\t\t\t\t\tvector[ w ] = depth;\r\n\t\r\n\t\t\t\t\tscope.vertices.push( vector );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tfor ( iy = 0; iy < gridY; iy ++ ) {\r\n\t\r\n\t\t\t\tfor ( ix = 0; ix < gridX; ix ++ ) {\r\n\t\r\n\t\t\t\t\tvar a = ix + gridX1 * iy;\r\n\t\t\t\t\tvar b = ix + gridX1 * ( iy + 1 );\r\n\t\t\t\t\tvar c = ( ix + 1 ) + gridX1 * ( iy + 1 );\r\n\t\t\t\t\tvar d = ( ix + 1 ) + gridX1 * iy;\r\n\t\r\n\t\t\t\t\tvar uva = new THREE.Vector2( ix / gridX, 1 - iy / gridY );\r\n\t\t\t\t\tvar uvb = new THREE.Vector2( ix / gridX, 1 - ( iy + 1 ) / gridY );\r\n\t\t\t\t\tvar uvc = new THREE.Vector2( ( ix + 1 ) / gridX, 1 - ( iy + 1 ) / gridY );\r\n\t\t\t\t\tvar uvd = new THREE.Vector2( ( ix + 1 ) / gridX, 1 - iy / gridY );\r\n\t\r\n\t\t\t\t\tvar face = new THREE.Face3( a + offset, b + offset, d + offset );\r\n\t\t\t\t\tface.normal.copy( normal );\r\n\t\t\t\t\tface.vertexNormals.push( normal.clone(), normal.clone(), normal.clone() );\r\n\t\t\t\t\tface.materialIndex = materialIndex;\r\n\t\r\n\t\t\t\t\tscope.faces.push( face );\r\n\t\t\t\t\tscope.faceVertexUvs[ 0 ].push( [ uva, uvb, uvd ] );\r\n\t\r\n\t\t\t\t\tface = new THREE.Face3( b + offset, c + offset, d + offset );\r\n\t\t\t\t\tface.normal.copy( normal );\r\n\t\t\t\t\tface.vertexNormals.push( normal.clone(), normal.clone(), normal.clone() );\r\n\t\t\t\t\tface.materialIndex = materialIndex;\r\n\t\r\n\t\t\t\t\tscope.faces.push( face );\r\n\t\t\t\t\tscope.faceVertexUvs[ 0 ].push( [ uvb.clone(), uvc, uvd.clone() ] );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tthis.mergeVertices();\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.BoxGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\n\tTHREE.BoxGeometry.prototype.constructor = THREE.BoxGeometry;\r\n\t\r\n\tTHREE.BoxGeometry.prototype.clone = function () {\r\n\t\r\n\t\tvar parameters = this.parameters;\r\n\t\r\n\t\treturn new THREE.BoxGeometry(\r\n\t\t\tparameters.width,\r\n\t\t\tparameters.height,\r\n\t\t\tparameters.depth,\r\n\t\t\tparameters.widthSegments,\r\n\t\t\tparameters.heightSegments,\r\n\t\t\tparameters.depthSegments\r\n\t\t);\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.CubeGeometry = THREE.BoxGeometry; // backwards compatibility\r\n\t\r\n\t// File:src/extras/geometries/CircleGeometry.js\r\n\t\r\n\t/**\r\n\t * @author hughes\r\n\t */\r\n\t\r\n\tTHREE.CircleGeometry = function ( radius, segments, thetaStart, thetaLength ) {\r\n\t\r\n\t\tTHREE.Geometry.call( this );\r\n\t\r\n\t\tthis.type = 'CircleGeometry';\r\n\t\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\tsegments: segments,\r\n\t\t\tthetaStart: thetaStart,\r\n\t\t\tthetaLength: thetaLength\r\n\t\t};\r\n\t\r\n\t\tthis.fromBufferGeometry( new THREE.CircleBufferGeometry( radius, segments, thetaStart, thetaLength ) );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.CircleGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\n\tTHREE.CircleGeometry.prototype.constructor = THREE.CircleGeometry;\r\n\t\r\n\tTHREE.CircleGeometry.prototype.clone = function () {\r\n\t\r\n\t\tvar parameters = this.parameters;\r\n\t\r\n\t\treturn new THREE.CircleGeometry(\r\n\t\t\tparameters.radius,\r\n\t\t\tparameters.segments,\r\n\t\t\tparameters.thetaStart,\r\n\t\t\tparameters.thetaLength\r\n\t\t);\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/extras/geometries/CircleBufferGeometry.js\r\n\t\r\n\t/**\r\n\t * @author benaadams / https://twitter.com/ben_a_adams\r\n\t */\r\n\t\r\n\tTHREE.CircleBufferGeometry = function ( radius, segments, thetaStart, thetaLength ) {\r\n\t\r\n\t\tTHREE.BufferGeometry.call( this );\r\n\t\r\n\t\tthis.type = 'CircleBufferGeometry';\r\n\t\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\tsegments: segments,\r\n\t\t\tthetaStart: thetaStart,\r\n\t\t\tthetaLength: thetaLength\r\n\t\t};\r\n\t\r\n\t\tradius = radius || 50;\r\n\t\tsegments = segments !== undefined ? Math.max( 3, segments ) : 8;\r\n\t\r\n\t\tthetaStart = thetaStart !== undefined ? thetaStart : 0;\r\n\t\tthetaLength = thetaLength !== undefined ? thetaLength : Math.PI * 2;\r\n\t\r\n\t\tvar vertices = segments + 2;\r\n\t\r\n\t\tvar positions = new Float32Array( vertices * 3 );\r\n\t\tvar normals = new Float32Array( vertices * 3 );\r\n\t\tvar uvs = new Float32Array( vertices * 2 );\r\n\t\r\n\t\t// center data is already zero, but need to set a few extras\r\n\t\tnormals[ 2 ] = 1.0;\r\n\t\tuvs[ 0 ] = 0.5;\r\n\t\tuvs[ 1 ] = 0.5;\r\n\t\r\n\t\tfor ( var s = 0, i = 3, ii = 2 ; s <= segments; s ++, i += 3, ii += 2 ) {\r\n\t\r\n\t\t\tvar segment = thetaStart + s / segments * thetaLength;\r\n\t\r\n\t\t\tpositions[ i ] = radius * Math.cos( segment );\r\n\t\t\tpositions[ i + 1 ] = radius * Math.sin( segment );\r\n\t\r\n\t\t\tnormals[ i + 2 ] = 1; // normal z\r\n\t\r\n\t\t\tuvs[ ii ] = ( positions[ i ] / radius + 1 ) / 2;\r\n\t\t\tuvs[ ii + 1 ] = ( positions[ i + 1 ] / radius + 1 ) / 2;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tvar indices = [];\r\n\t\r\n\t\tfor ( var i = 1; i <= segments; i ++ ) {\r\n\t\r\n\t\t\tindices.push( i, i + 1, 0 );\r\n\t\r\n\t\t}\r\n\t\r\n\t\tthis.setIndex( new THREE.BufferAttribute( new Uint16Array( indices ), 1 ) );\r\n\t\tthis.addAttribute( 'position', new THREE.BufferAttribute( positions, 3 ) );\r\n\t\tthis.addAttribute( 'normal', new THREE.BufferAttribute( normals, 3 ) );\r\n\t\tthis.addAttribute( 'uv', new THREE.BufferAttribute( uvs, 2 ) );\r\n\t\r\n\t\tthis.boundingSphere = new THREE.Sphere( new THREE.Vector3(), radius );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.CircleBufferGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\r\n\tTHREE.CircleBufferGeometry.prototype.constructor = THREE.CircleBufferGeometry;\r\n\t\r\n\tTHREE.CircleBufferGeometry.prototype.clone = function () {\r\n\t\r\n\t\tvar parameters = this.parameters;\r\n\t\r\n\t\treturn new THREE.CircleBufferGeometry(\r\n\t\t\tparameters.radius,\r\n\t\t\tparameters.segments,\r\n\t\t\tparameters.thetaStart,\r\n\t\t\tparameters.thetaLength\r\n\t\t);\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/extras/geometries/CylinderGeometry.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.CylinderGeometry = function ( radiusTop, radiusBottom, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength ) {\r\n\t\r\n\t\tTHREE.Geometry.call( this );\r\n\t\r\n\t\tthis.type = 'CylinderGeometry';\r\n\t\r\n\t\tthis.parameters = {\r\n\t\t\tradiusTop: radiusTop,\r\n\t\t\tradiusBottom: radiusBottom,\r\n\t\t\theight: height,\r\n\t\t\tradialSegments: radialSegments,\r\n\t\t\theightSegments: heightSegments,\r\n\t\t\topenEnded: openEnded,\r\n\t\t\tthetaStart: thetaStart,\r\n\t\t\tthetaLength: thetaLength\r\n\t\t};\r\n\t\r\n\t\tradiusTop = radiusTop !== undefined ? radiusTop : 20;\r\n\t\tradiusBottom = radiusBottom !== undefined ? radiusBottom : 20;\r\n\t\theight = height !== undefined ? height : 100;\r\n\t\r\n\t\tradialSegments = radialSegments || 8;\r\n\t\theightSegments = heightSegments || 1;\r\n\t\r\n\t\topenEnded = openEnded !== undefined ? openEnded : false;\r\n\t\tthetaStart = thetaStart !== undefined ? thetaStart : 0;\r\n\t\tthetaLength = thetaLength !== undefined ? thetaLength : 2 * Math.PI;\r\n\t\r\n\t\tvar heightHalf = height / 2;\r\n\t\r\n\t\tvar x, y, vertices = [], uvs = [];\r\n\t\r\n\t\tfor ( y = 0; y <= heightSegments; y ++ ) {\r\n\t\r\n\t\t\tvar verticesRow = [];\r\n\t\t\tvar uvsRow = [];\r\n\t\r\n\t\t\tvar v = y / heightSegments;\r\n\t\t\tvar radius = v * ( radiusBottom - radiusTop ) + radiusTop;\r\n\t\r\n\t\t\tfor ( x = 0; x <= radialSegments; x ++ ) {\r\n\t\r\n\t\t\t\tvar u = x / radialSegments;\r\n\t\r\n\t\t\t\tvar vertex = new THREE.Vector3();\r\n\t\t\t\tvertex.x = radius * Math.sin( u * thetaLength + thetaStart );\r\n\t\t\t\tvertex.y = - v * height + heightHalf;\r\n\t\t\t\tvertex.z = radius * Math.cos( u * thetaLength + thetaStart );\r\n\t\r\n\t\t\t\tthis.vertices.push( vertex );\r\n\t\r\n\t\t\t\tverticesRow.push( this.vertices.length - 1 );\r\n\t\t\t\tuvsRow.push( new THREE.Vector2( u, 1 - v ) );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvertices.push( verticesRow );\r\n\t\t\tuvs.push( uvsRow );\r\n\t\r\n\t\t}\r\n\t\r\n\t\tvar tanTheta = ( radiusBottom - radiusTop ) / height;\r\n\t\tvar na, nb;\r\n\t\r\n\t\tfor ( x = 0; x < radialSegments; x ++ ) {\r\n\t\r\n\t\t\tif ( radiusTop !== 0 ) {\r\n\t\r\n\t\t\t\tna = this.vertices[ vertices[ 0 ][ x ] ].clone();\r\n\t\t\t\tnb = this.vertices[ vertices[ 0 ][ x + 1 ] ].clone();\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\tna = this.vertices[ vertices[ 1 ][ x ] ].clone();\r\n\t\t\t\tnb = this.vertices[ vertices[ 1 ][ x + 1 ] ].clone();\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tna.setY( Math.sqrt( na.x * na.x + na.z * na.z ) * tanTheta ).normalize();\r\n\t\t\tnb.setY( Math.sqrt( nb.x * nb.x + nb.z * nb.z ) * tanTheta ).normalize();\r\n\t\r\n\t\t\tfor ( y = 0; y < heightSegments; y ++ ) {\r\n\t\r\n\t\t\t\tvar v1 = vertices[ y ][ x ];\r\n\t\t\t\tvar v2 = vertices[ y + 1 ][ x ];\r\n\t\t\t\tvar v3 = vertices[ y + 1 ][ x + 1 ];\r\n\t\t\t\tvar v4 = vertices[ y ][ x + 1 ];\r\n\t\r\n\t\t\t\tvar n1 = na.clone();\r\n\t\t\t\tvar n2 = na.clone();\r\n\t\t\t\tvar n3 = nb.clone();\r\n\t\t\t\tvar n4 = nb.clone();\r\n\t\r\n\t\t\t\tvar uv1 = uvs[ y ][ x ].clone();\r\n\t\t\t\tvar uv2 = uvs[ y + 1 ][ x ].clone();\r\n\t\t\t\tvar uv3 = uvs[ y + 1 ][ x + 1 ].clone();\r\n\t\t\t\tvar uv4 = uvs[ y ][ x + 1 ].clone();\r\n\t\r\n\t\t\t\tthis.faces.push( new THREE.Face3( v1, v2, v4, [ n1, n2, n4 ] ) );\r\n\t\t\t\tthis.faceVertexUvs[ 0 ].push( [ uv1, uv2, uv4 ] );\r\n\t\r\n\t\t\t\tthis.faces.push( new THREE.Face3( v2, v3, v4, [ n2.clone(), n3, n4.clone() ] ) );\r\n\t\t\t\tthis.faceVertexUvs[ 0 ].push( [ uv2.clone(), uv3, uv4.clone() ] );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\t// top cap\r\n\t\r\n\t\tif ( openEnded === false && radiusTop > 0 ) {\r\n\t\r\n\t\t\tthis.vertices.push( new THREE.Vector3( 0, heightHalf, 0 ) );\r\n\t\r\n\t\t\tfor ( x = 0; x < radialSegments; x ++ ) {\r\n\t\r\n\t\t\t\tvar v1 = vertices[ 0 ][ x ];\r\n\t\t\t\tvar v2 = vertices[ 0 ][ x + 1 ];\r\n\t\t\t\tvar v3 = this.vertices.length - 1;\r\n\t\r\n\t\t\t\tvar n1 = new THREE.Vector3( 0, 1, 0 );\r\n\t\t\t\tvar n2 = new THREE.Vector3( 0, 1, 0 );\r\n\t\t\t\tvar n3 = new THREE.Vector3( 0, 1, 0 );\r\n\t\r\n\t\t\t\tvar uv1 = uvs[ 0 ][ x ].clone();\r\n\t\t\t\tvar uv2 = uvs[ 0 ][ x + 1 ].clone();\r\n\t\t\t\tvar uv3 = new THREE.Vector2( uv2.x, 0 );\r\n\t\r\n\t\t\t\tthis.faces.push( new THREE.Face3( v1, v2, v3, [ n1, n2, n3 ], undefined, 1 ) );\r\n\t\t\t\tthis.faceVertexUvs[ 0 ].push( [ uv1, uv2, uv3 ] );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\t// bottom cap\r\n\t\r\n\t\tif ( openEnded === false && radiusBottom > 0 ) {\r\n\t\r\n\t\t\tthis.vertices.push( new THREE.Vector3( 0, - heightHalf, 0 ) );\r\n\t\r\n\t\t\tfor ( x = 0; x < radialSegments; x ++ ) {\r\n\t\r\n\t\t\t\tvar v1 = vertices[ heightSegments ][ x + 1 ];\r\n\t\t\t\tvar v2 = vertices[ heightSegments ][ x ];\r\n\t\t\t\tvar v3 = this.vertices.length - 1;\r\n\t\r\n\t\t\t\tvar n1 = new THREE.Vector3( 0, - 1, 0 );\r\n\t\t\t\tvar n2 = new THREE.Vector3( 0, - 1, 0 );\r\n\t\t\t\tvar n3 = new THREE.Vector3( 0, - 1, 0 );\r\n\t\r\n\t\t\t\tvar uv1 = uvs[ heightSegments ][ x + 1 ].clone();\r\n\t\t\t\tvar uv2 = uvs[ heightSegments ][ x ].clone();\r\n\t\t\t\tvar uv3 = new THREE.Vector2( uv2.x, 1 );\r\n\t\r\n\t\t\t\tthis.faces.push( new THREE.Face3( v1, v2, v3, [ n1, n2, n3 ], undefined, 2 ) );\r\n\t\t\t\tthis.faceVertexUvs[ 0 ].push( [ uv1, uv2, uv3 ] );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tthis.computeFaceNormals();\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.CylinderGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\n\tTHREE.CylinderGeometry.prototype.constructor = THREE.CylinderGeometry;\r\n\t\r\n\tTHREE.CylinderGeometry.prototype.clone = function () {\r\n\t\r\n\t\tvar parameters = this.parameters;\r\n\t\r\n\t\treturn new THREE.CylinderGeometry(\r\n\t\t\tparameters.radiusTop,\r\n\t\t\tparameters.radiusBottom,\r\n\t\t\tparameters.height,\r\n\t\t\tparameters.radialSegments,\r\n\t\t\tparameters.heightSegments,\r\n\t\t\tparameters.openEnded,\r\n\t\t\tparameters.thetaStart,\r\n\t\t\tparameters.thetaLength\r\n\t\t);\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/extras/geometries/EdgesGeometry.js\r\n\t\r\n\t/**\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t */\r\n\t\r\n\tTHREE.EdgesGeometry = function ( geometry, thresholdAngle ) {\r\n\t\r\n\t\tTHREE.BufferGeometry.call( this );\r\n\t\r\n\t\tthresholdAngle = ( thresholdAngle !== undefined ) ? thresholdAngle : 1;\r\n\t\r\n\t\tvar thresholdDot = Math.cos( THREE.Math.degToRad( thresholdAngle ) );\r\n\t\r\n\t\tvar edge = [ 0, 0 ], hash = {};\r\n\t\r\n\t\tfunction sortFunction( a, b ) {\r\n\t\r\n\t\t\treturn a - b;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tvar keys = [ 'a', 'b', 'c' ];\r\n\t\r\n\t\tvar geometry2;\r\n\t\r\n\t\tif ( geometry instanceof THREE.BufferGeometry ) {\r\n\t\r\n\t\t\tgeometry2 = new THREE.Geometry();\r\n\t\t\tgeometry2.fromBufferGeometry( geometry );\r\n\t\r\n\t\t} else {\r\n\t\r\n\t\t\tgeometry2 = geometry.clone();\r\n\t\r\n\t\t}\r\n\t\r\n\t\tgeometry2.mergeVertices();\r\n\t\tgeometry2.computeFaceNormals();\r\n\t\r\n\t\tvar vertices = geometry2.vertices;\r\n\t\tvar faces = geometry2.faces;\r\n\t\r\n\t\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\r\n\t\r\n\t\t\tvar face = faces[ i ];\r\n\t\r\n\t\t\tfor ( var j = 0; j < 3; j ++ ) {\r\n\t\r\n\t\t\t\tedge[ 0 ] = face[ keys[ j ] ];\r\n\t\t\t\tedge[ 1 ] = face[ keys[ ( j + 1 ) % 3 ] ];\r\n\t\t\t\tedge.sort( sortFunction );\r\n\t\r\n\t\t\t\tvar key = edge.toString();\r\n\t\r\n\t\t\t\tif ( hash[ key ] === undefined ) {\r\n\t\r\n\t\t\t\t\thash[ key ] = { vert1: edge[ 0 ], vert2: edge[ 1 ], face1: i, face2: undefined };\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\thash[ key ].face2 = i;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tvar coords = [];\r\n\t\r\n\t\tfor ( var key in hash ) {\r\n\t\r\n\t\t\tvar h = hash[ key ];\r\n\t\r\n\t\t\tif ( h.face2 === undefined || faces[ h.face1 ].normal.dot( faces[ h.face2 ].normal ) <= thresholdDot ) {\r\n\t\r\n\t\t\t\tvar vertex = vertices[ h.vert1 ];\r\n\t\t\t\tcoords.push( vertex.x );\r\n\t\t\t\tcoords.push( vertex.y );\r\n\t\t\t\tcoords.push( vertex.z );\r\n\t\r\n\t\t\t\tvertex = vertices[ h.vert2 ];\r\n\t\t\t\tcoords.push( vertex.x );\r\n\t\t\t\tcoords.push( vertex.y );\r\n\t\t\t\tcoords.push( vertex.z );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tthis.addAttribute( 'position', new THREE.BufferAttribute( new Float32Array( coords ), 3 ) );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.EdgesGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\r\n\tTHREE.EdgesGeometry.prototype.constructor = THREE.EdgesGeometry;\r\n\t\r\n\t// File:src/extras/geometries/ExtrudeGeometry.js\r\n\t\r\n\t/**\r\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\r\n\t *\r\n\t * Creates extruded geometry from a path shape.\r\n\t *\r\n\t * parameters = {\r\n\t *\r\n\t *  curveSegments: <int>, // number of points on the curves\r\n\t *  steps: <int>, // number of points for z-side extrusions / used for subdividing segments of extrude spline too\r\n\t *  amount: <int>, // Depth to extrude the shape\r\n\t *\r\n\t *  bevelEnabled: <bool>, // turn on bevel\r\n\t *  bevelThickness: <float>, // how deep into the original shape bevel goes\r\n\t *  bevelSize: <float>, // how far from shape outline is bevel\r\n\t *  bevelSegments: <int>, // number of bevel layers\r\n\t *\r\n\t *  extrudePath: <THREE.CurvePath> // 3d spline path to extrude shape along. (creates Frames if .frames aren't defined)\r\n\t *  frames: <THREE.TubeGeometry.FrenetFrames> // containing arrays of tangents, normals, binormals\r\n\t *\r\n\t *  uvGenerator: <Object> // object that provides UV generator functions\r\n\t *\r\n\t * }\r\n\t **/\r\n\t\r\n\tTHREE.ExtrudeGeometry = function ( shapes, options ) {\r\n\t\r\n\t\tif ( typeof( shapes ) === \"undefined\" ) {\r\n\t\r\n\t\t\tshapes = [];\r\n\t\t\treturn;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tTHREE.Geometry.call( this );\r\n\t\r\n\t\tthis.type = 'ExtrudeGeometry';\r\n\t\r\n\t\tshapes = Array.isArray( shapes ) ? shapes : [ shapes ];\r\n\t\r\n\t\tthis.addShapeList( shapes, options );\r\n\t\r\n\t\tthis.computeFaceNormals();\r\n\t\r\n\t\t// can't really use automatic vertex normals\r\n\t\t// as then front and back sides get smoothed too\r\n\t\t// should do separate smoothing just for sides\r\n\t\r\n\t\t//this.computeVertexNormals();\r\n\t\r\n\t\t//console.log( \"took\", ( Date.now() - startTime ) );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.ExtrudeGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\n\tTHREE.ExtrudeGeometry.prototype.constructor = THREE.ExtrudeGeometry;\r\n\t\r\n\tTHREE.ExtrudeGeometry.prototype.addShapeList = function ( shapes, options ) {\r\n\t\r\n\t\tvar sl = shapes.length;\r\n\t\r\n\t\tfor ( var s = 0; s < sl; s ++ ) {\r\n\t\r\n\t\t\tvar shape = shapes[ s ];\r\n\t\t\tthis.addShape( shape, options );\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.ExtrudeGeometry.prototype.addShape = function ( shape, options ) {\r\n\t\r\n\t\tvar amount = options.amount !== undefined ? options.amount : 100;\r\n\t\r\n\t\tvar bevelThickness = options.bevelThickness !== undefined ? options.bevelThickness : 6; // 10\r\n\t\tvar bevelSize = options.bevelSize !== undefined ? options.bevelSize : bevelThickness - 2; // 8\r\n\t\tvar bevelSegments = options.bevelSegments !== undefined ? options.bevelSegments : 3;\r\n\t\r\n\t\tvar bevelEnabled = options.bevelEnabled !== undefined ? options.bevelEnabled : true; // false\r\n\t\r\n\t\tvar curveSegments = options.curveSegments !== undefined ? options.curveSegments : 12;\r\n\t\r\n\t\tvar steps = options.steps !== undefined ? options.steps : 1;\r\n\t\r\n\t\tvar extrudePath = options.extrudePath;\r\n\t\tvar extrudePts, extrudeByPath = false;\r\n\t\r\n\t\t// Use default WorldUVGenerator if no UV generators are specified.\r\n\t\tvar uvgen = options.UVGenerator !== undefined ? options.UVGenerator : THREE.ExtrudeGeometry.WorldUVGenerator;\r\n\t\r\n\t\tvar splineTube, binormal, normal, position2;\r\n\t\tif ( extrudePath ) {\r\n\t\r\n\t\t\textrudePts = extrudePath.getSpacedPoints( steps );\r\n\t\r\n\t\t\textrudeByPath = true;\r\n\t\t\tbevelEnabled = false; // bevels not supported for path extrusion\r\n\t\r\n\t\t\t// SETUP TNB variables\r\n\t\r\n\t\t\t// Reuse TNB from TubeGeomtry for now.\r\n\t\t\t// TODO1 - have a .isClosed in spline?\r\n\t\r\n\t\t\tsplineTube = options.frames !== undefined ? options.frames : new THREE.TubeGeometry.FrenetFrames( extrudePath, steps, false );\r\n\t\r\n\t\t\t// console.log(splineTube, 'splineTube', splineTube.normals.length, 'steps', steps, 'extrudePts', extrudePts.length);\r\n\t\r\n\t\t\tbinormal = new THREE.Vector3();\r\n\t\t\tnormal = new THREE.Vector3();\r\n\t\t\tposition2 = new THREE.Vector3();\r\n\t\r\n\t\t}\r\n\t\r\n\t\t// Safeguards if bevels are not enabled\r\n\t\r\n\t\tif ( ! bevelEnabled ) {\r\n\t\r\n\t\t\tbevelSegments = 0;\r\n\t\t\tbevelThickness = 0;\r\n\t\t\tbevelSize = 0;\r\n\t\r\n\t\t}\r\n\t\r\n\t\t// Variables initialization\r\n\t\r\n\t\tvar ahole, h, hl; // looping of holes\r\n\t\tvar scope = this;\r\n\t\r\n\t\tvar shapesOffset = this.vertices.length;\r\n\t\r\n\t\tvar shapePoints = shape.extractPoints( curveSegments );\r\n\t\r\n\t\tvar vertices = shapePoints.shape;\r\n\t\tvar holes = shapePoints.holes;\r\n\t\r\n\t\tvar reverse = ! THREE.ShapeUtils.isClockWise( vertices );\r\n\t\r\n\t\tif ( reverse ) {\r\n\t\r\n\t\t\tvertices = vertices.reverse();\r\n\t\r\n\t\t\t// Maybe we should also check if holes are in the opposite direction, just to be safe ...\r\n\t\r\n\t\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\t\r\n\t\t\t\tahole = holes[ h ];\r\n\t\r\n\t\t\t\tif ( THREE.ShapeUtils.isClockWise( ahole ) ) {\r\n\t\r\n\t\t\t\t\tholes[ h ] = ahole.reverse();\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treverse = false; // If vertices are in order now, we shouldn't need to worry about them again (hopefully)!\r\n\t\r\n\t\t}\r\n\t\r\n\t\r\n\t\tvar faces = THREE.ShapeUtils.triangulateShape( vertices, holes );\r\n\t\r\n\t\t/* Vertices */\r\n\t\r\n\t\tvar contour = vertices; // vertices has all points but contour has only points of circumference\r\n\t\r\n\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\t\r\n\t\t\tahole = holes[ h ];\r\n\t\r\n\t\t\tvertices = vertices.concat( ahole );\r\n\t\r\n\t\t}\r\n\t\r\n\t\r\n\t\tfunction scalePt2 ( pt, vec, size ) {\r\n\t\r\n\t\t\tif ( ! vec ) console.error( \"THREE.ExtrudeGeometry: vec does not exist\" );\r\n\t\r\n\t\t\treturn vec.clone().multiplyScalar( size ).add( pt );\r\n\t\r\n\t\t}\r\n\t\r\n\t\tvar b, bs, t, z,\r\n\t\t\tvert, vlen = vertices.length,\r\n\t\t\tface, flen = faces.length;\r\n\t\r\n\t\r\n\t\t// Find directions for point movement\r\n\t\r\n\t\r\n\t\tfunction getBevelVec( inPt, inPrev, inNext ) {\r\n\t\r\n\t\t\t// computes for inPt the corresponding point inPt' on a new contour\r\n\t\t\t//   shifted by 1 unit (length of normalized vector) to the left\r\n\t\t\t// if we walk along contour clockwise, this new contour is outside the old one\r\n\t\t\t//\r\n\t\t\t// inPt' is the intersection of the two lines parallel to the two\r\n\t\t\t//  adjacent edges of inPt at a distance of 1 unit on the left side.\r\n\t\r\n\t\t\tvar v_trans_x, v_trans_y, shrink_by = 1;\t\t// resulting translation vector for inPt\r\n\t\r\n\t\t\t// good reading for geometry algorithms (here: line-line intersection)\r\n\t\t\t// http://geomalgorithms.com/a05-_intersect-1.html\r\n\t\r\n\t\t\tvar v_prev_x = inPt.x - inPrev.x, v_prev_y = inPt.y - inPrev.y;\r\n\t\t\tvar v_next_x = inNext.x - inPt.x, v_next_y = inNext.y - inPt.y;\r\n\t\r\n\t\t\tvar v_prev_lensq = ( v_prev_x * v_prev_x + v_prev_y * v_prev_y );\r\n\t\r\n\t\t\t// check for collinear edges\r\n\t\t\tvar collinear0 = ( v_prev_x * v_next_y - v_prev_y * v_next_x );\r\n\t\r\n\t\t\tif ( Math.abs( collinear0 ) > Number.EPSILON ) {\r\n\t\r\n\t\t\t\t// not collinear\r\n\t\r\n\t\t\t\t// length of vectors for normalizing\r\n\t\r\n\t\t\t\tvar v_prev_len = Math.sqrt( v_prev_lensq );\r\n\t\t\t\tvar v_next_len = Math.sqrt( v_next_x * v_next_x + v_next_y * v_next_y );\r\n\t\r\n\t\t\t\t// shift adjacent points by unit vectors to the left\r\n\t\r\n\t\t\t\tvar ptPrevShift_x = ( inPrev.x - v_prev_y / v_prev_len );\r\n\t\t\t\tvar ptPrevShift_y = ( inPrev.y + v_prev_x / v_prev_len );\r\n\t\r\n\t\t\t\tvar ptNextShift_x = ( inNext.x - v_next_y / v_next_len );\r\n\t\t\t\tvar ptNextShift_y = ( inNext.y + v_next_x / v_next_len );\r\n\t\r\n\t\t\t\t// scaling factor for v_prev to intersection point\r\n\t\r\n\t\t\t\tvar sf = (  ( ptNextShift_x - ptPrevShift_x ) * v_next_y -\r\n\t\t\t\t\t\t\t( ptNextShift_y - ptPrevShift_y ) * v_next_x    ) /\r\n\t\t\t\t\t\t  ( v_prev_x * v_next_y - v_prev_y * v_next_x );\r\n\t\r\n\t\t\t\t// vector from inPt to intersection point\r\n\t\r\n\t\t\t\tv_trans_x = ( ptPrevShift_x + v_prev_x * sf - inPt.x );\r\n\t\t\t\tv_trans_y = ( ptPrevShift_y + v_prev_y * sf - inPt.y );\r\n\t\r\n\t\t\t\t// Don't normalize!, otherwise sharp corners become ugly\r\n\t\t\t\t//  but prevent crazy spikes\r\n\t\t\t\tvar v_trans_lensq = ( v_trans_x * v_trans_x + v_trans_y * v_trans_y );\r\n\t\t\t\tif ( v_trans_lensq <= 2 ) {\r\n\t\r\n\t\t\t\t\treturn\tnew THREE.Vector2( v_trans_x, v_trans_y );\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tshrink_by = Math.sqrt( v_trans_lensq / 2 );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\t// handle special case of collinear edges\r\n\t\r\n\t\t\t\tvar direction_eq = false;\t\t// assumes: opposite\r\n\t\t\t\tif ( v_prev_x > Number.EPSILON ) {\r\n\t\r\n\t\t\t\t\tif ( v_next_x > Number.EPSILON ) {\r\n\t\r\n\t\t\t\t\t\tdirection_eq = true;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\tif ( v_prev_x < - Number.EPSILON ) {\r\n\t\r\n\t\t\t\t\t\tif ( v_next_x < - Number.EPSILON ) {\r\n\t\r\n\t\t\t\t\t\t\tdirection_eq = true;\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\tif ( Math.sign( v_prev_y ) === Math.sign( v_next_y ) ) {\r\n\t\r\n\t\t\t\t\t\t\tdirection_eq = true;\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif ( direction_eq ) {\r\n\t\r\n\t\t\t\t\t// console.log(\"Warning: lines are a straight sequence\");\r\n\t\t\t\t\tv_trans_x = - v_prev_y;\r\n\t\t\t\t\tv_trans_y =  v_prev_x;\r\n\t\t\t\t\tshrink_by = Math.sqrt( v_prev_lensq );\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t// console.log(\"Warning: lines are a straight spike\");\r\n\t\t\t\t\tv_trans_x = v_prev_x;\r\n\t\t\t\t\tv_trans_y = v_prev_y;\r\n\t\t\t\t\tshrink_by = Math.sqrt( v_prev_lensq / 2 );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treturn\tnew THREE.Vector2( v_trans_x / shrink_by, v_trans_y / shrink_by );\r\n\t\r\n\t\t}\r\n\t\r\n\t\r\n\t\tvar contourMovements = [];\r\n\t\r\n\t\tfor ( var i = 0, il = contour.length, j = il - 1, k = i + 1; i < il; i ++, j ++, k ++ ) {\r\n\t\r\n\t\t\tif ( j === il ) j = 0;\r\n\t\t\tif ( k === il ) k = 0;\r\n\t\r\n\t\t\t//  (j)---(i)---(k)\r\n\t\t\t// console.log('i,j,k', i, j , k)\r\n\t\r\n\t\t\tcontourMovements[ i ] = getBevelVec( contour[ i ], contour[ j ], contour[ k ] );\r\n\t\r\n\t\t}\r\n\t\r\n\t\tvar holesMovements = [], oneHoleMovements, verticesMovements = contourMovements.concat();\r\n\t\r\n\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\t\r\n\t\t\tahole = holes[ h ];\r\n\t\r\n\t\t\toneHoleMovements = [];\r\n\t\r\n\t\t\tfor ( i = 0, il = ahole.length, j = il - 1, k = i + 1; i < il; i ++, j ++, k ++ ) {\r\n\t\r\n\t\t\t\tif ( j === il ) j = 0;\r\n\t\t\t\tif ( k === il ) k = 0;\r\n\t\r\n\t\t\t\t//  (j)---(i)---(k)\r\n\t\t\t\toneHoleMovements[ i ] = getBevelVec( ahole[ i ], ahole[ j ], ahole[ k ] );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tholesMovements.push( oneHoleMovements );\r\n\t\t\tverticesMovements = verticesMovements.concat( oneHoleMovements );\r\n\t\r\n\t\t}\r\n\t\r\n\t\r\n\t\t// Loop bevelSegments, 1 for the front, 1 for the back\r\n\t\r\n\t\tfor ( b = 0; b < bevelSegments; b ++ ) {\r\n\t\r\n\t\t\t//for ( b = bevelSegments; b > 0; b -- ) {\r\n\t\r\n\t\t\tt = b / bevelSegments;\r\n\t\t\tz = bevelThickness * ( 1 - t );\r\n\t\r\n\t\t\t//z = bevelThickness * t;\r\n\t\t\tbs = bevelSize * ( Math.sin ( t * Math.PI / 2 ) ); // curved\r\n\t\t\t//bs = bevelSize * t; // linear\r\n\t\r\n\t\t\t// contract shape\r\n\t\r\n\t\t\tfor ( i = 0, il = contour.length; i < il; i ++ ) {\r\n\t\r\n\t\t\t\tvert = scalePt2( contour[ i ], contourMovements[ i ], bs );\r\n\t\r\n\t\t\t\tv( vert.x, vert.y,  - z );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// expand holes\r\n\t\r\n\t\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\t\r\n\t\t\t\tahole = holes[ h ];\r\n\t\t\t\toneHoleMovements = holesMovements[ h ];\r\n\t\r\n\t\t\t\tfor ( i = 0, il = ahole.length; i < il; i ++ ) {\r\n\t\r\n\t\t\t\t\tvert = scalePt2( ahole[ i ], oneHoleMovements[ i ], bs );\r\n\t\r\n\t\t\t\t\tv( vert.x, vert.y,  - z );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tbs = bevelSize;\r\n\t\r\n\t\t// Back facing vertices\r\n\t\r\n\t\tfor ( i = 0; i < vlen; i ++ ) {\r\n\t\r\n\t\t\tvert = bevelEnabled ? scalePt2( vertices[ i ], verticesMovements[ i ], bs ) : vertices[ i ];\r\n\t\r\n\t\t\tif ( ! extrudeByPath ) {\r\n\t\r\n\t\t\t\tv( vert.x, vert.y, 0 );\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\t// v( vert.x, vert.y + extrudePts[ 0 ].y, extrudePts[ 0 ].x );\r\n\t\r\n\t\t\t\tnormal.copy( splineTube.normals[ 0 ] ).multiplyScalar( vert.x );\r\n\t\t\t\tbinormal.copy( splineTube.binormals[ 0 ] ).multiplyScalar( vert.y );\r\n\t\r\n\t\t\t\tposition2.copy( extrudePts[ 0 ] ).add( normal ).add( binormal );\r\n\t\r\n\t\t\t\tv( position2.x, position2.y, position2.z );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\t// Add stepped vertices...\r\n\t\t// Including front facing vertices\r\n\t\r\n\t\tvar s;\r\n\t\r\n\t\tfor ( s = 1; s <= steps; s ++ ) {\r\n\t\r\n\t\t\tfor ( i = 0; i < vlen; i ++ ) {\r\n\t\r\n\t\t\t\tvert = bevelEnabled ? scalePt2( vertices[ i ], verticesMovements[ i ], bs ) : vertices[ i ];\r\n\t\r\n\t\t\t\tif ( ! extrudeByPath ) {\r\n\t\r\n\t\t\t\t\tv( vert.x, vert.y, amount / steps * s );\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t// v( vert.x, vert.y + extrudePts[ s - 1 ].y, extrudePts[ s - 1 ].x );\r\n\t\r\n\t\t\t\t\tnormal.copy( splineTube.normals[ s ] ).multiplyScalar( vert.x );\r\n\t\t\t\t\tbinormal.copy( splineTube.binormals[ s ] ).multiplyScalar( vert.y );\r\n\t\r\n\t\t\t\t\tposition2.copy( extrudePts[ s ] ).add( normal ).add( binormal );\r\n\t\r\n\t\t\t\t\tv( position2.x, position2.y, position2.z );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\r\n\t\t// Add bevel segments planes\r\n\t\r\n\t\t//for ( b = 1; b <= bevelSegments; b ++ ) {\r\n\t\tfor ( b = bevelSegments - 1; b >= 0; b -- ) {\r\n\t\r\n\t\t\tt = b / bevelSegments;\r\n\t\t\tz = bevelThickness * ( 1 - t );\r\n\t\t\t//bs = bevelSize * ( 1-Math.sin ( ( 1 - t ) * Math.PI/2 ) );\r\n\t\t\tbs = bevelSize * Math.sin ( t * Math.PI / 2 );\r\n\t\r\n\t\t\t// contract shape\r\n\t\r\n\t\t\tfor ( i = 0, il = contour.length; i < il; i ++ ) {\r\n\t\r\n\t\t\t\tvert = scalePt2( contour[ i ], contourMovements[ i ], bs );\r\n\t\t\t\tv( vert.x, vert.y,  amount + z );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// expand holes\r\n\t\r\n\t\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\t\r\n\t\t\t\tahole = holes[ h ];\r\n\t\t\t\toneHoleMovements = holesMovements[ h ];\r\n\t\r\n\t\t\t\tfor ( i = 0, il = ahole.length; i < il; i ++ ) {\r\n\t\r\n\t\t\t\t\tvert = scalePt2( ahole[ i ], oneHoleMovements[ i ], bs );\r\n\t\r\n\t\t\t\t\tif ( ! extrudeByPath ) {\r\n\t\r\n\t\t\t\t\t\tv( vert.x, vert.y,  amount + z );\r\n\t\r\n\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\tv( vert.x, vert.y + extrudePts[ steps - 1 ].y, extrudePts[ steps - 1 ].x + z );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\t/* Faces */\r\n\t\r\n\t\t// Top and bottom faces\r\n\t\r\n\t\tbuildLidFaces();\r\n\t\r\n\t\t// Sides faces\r\n\t\r\n\t\tbuildSideFaces();\r\n\t\r\n\t\r\n\t\t/////  Internal functions\r\n\t\r\n\t\tfunction buildLidFaces() {\r\n\t\r\n\t\t\tif ( bevelEnabled ) {\r\n\t\r\n\t\t\t\tvar layer = 0; // steps + 1\r\n\t\t\t\tvar offset = vlen * layer;\r\n\t\r\n\t\t\t\t// Bottom faces\r\n\t\r\n\t\t\t\tfor ( i = 0; i < flen; i ++ ) {\r\n\t\r\n\t\t\t\t\tface = faces[ i ];\r\n\t\t\t\t\tf3( face[ 2 ] + offset, face[ 1 ] + offset, face[ 0 ] + offset );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tlayer = steps + bevelSegments * 2;\r\n\t\t\t\toffset = vlen * layer;\r\n\t\r\n\t\t\t\t// Top faces\r\n\t\r\n\t\t\t\tfor ( i = 0; i < flen; i ++ ) {\r\n\t\r\n\t\t\t\t\tface = faces[ i ];\r\n\t\t\t\t\tf3( face[ 0 ] + offset, face[ 1 ] + offset, face[ 2 ] + offset );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\t// Bottom faces\r\n\t\r\n\t\t\t\tfor ( i = 0; i < flen; i ++ ) {\r\n\t\r\n\t\t\t\t\tface = faces[ i ];\r\n\t\t\t\t\tf3( face[ 2 ], face[ 1 ], face[ 0 ] );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\t// Top faces\r\n\t\r\n\t\t\t\tfor ( i = 0; i < flen; i ++ ) {\r\n\t\r\n\t\t\t\t\tface = faces[ i ];\r\n\t\t\t\t\tf3( face[ 0 ] + vlen * steps, face[ 1 ] + vlen * steps, face[ 2 ] + vlen * steps );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\t// Create faces for the z-sides of the shape\r\n\t\r\n\t\tfunction buildSideFaces() {\r\n\t\r\n\t\t\tvar layeroffset = 0;\r\n\t\t\tsidewalls( contour, layeroffset );\r\n\t\t\tlayeroffset += contour.length;\r\n\t\r\n\t\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\t\r\n\t\t\t\tahole = holes[ h ];\r\n\t\t\t\tsidewalls( ahole, layeroffset );\r\n\t\r\n\t\t\t\t//, true\r\n\t\t\t\tlayeroffset += ahole.length;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction sidewalls( contour, layeroffset ) {\r\n\t\r\n\t\t\tvar j, k;\r\n\t\t\ti = contour.length;\r\n\t\r\n\t\t\twhile ( -- i >= 0 ) {\r\n\t\r\n\t\t\t\tj = i;\r\n\t\t\t\tk = i - 1;\r\n\t\t\t\tif ( k < 0 ) k = contour.length - 1;\r\n\t\r\n\t\t\t\t//console.log('b', i,j, i-1, k,vertices.length);\r\n\t\r\n\t\t\t\tvar s = 0, sl = steps  + bevelSegments * 2;\r\n\t\r\n\t\t\t\tfor ( s = 0; s < sl; s ++ ) {\r\n\t\r\n\t\t\t\t\tvar slen1 = vlen * s;\r\n\t\t\t\t\tvar slen2 = vlen * ( s + 1 );\r\n\t\r\n\t\t\t\t\tvar a = layeroffset + j + slen1,\r\n\t\t\t\t\t\tb = layeroffset + k + slen1,\r\n\t\t\t\t\t\tc = layeroffset + k + slen2,\r\n\t\t\t\t\t\td = layeroffset + j + slen2;\r\n\t\r\n\t\t\t\t\tf4( a, b, c, d, contour, s, sl, j, k );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\r\n\t\tfunction v( x, y, z ) {\r\n\t\r\n\t\t\tscope.vertices.push( new THREE.Vector3( x, y, z ) );\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction f3( a, b, c ) {\r\n\t\r\n\t\t\ta += shapesOffset;\r\n\t\t\tb += shapesOffset;\r\n\t\t\tc += shapesOffset;\r\n\t\r\n\t\t\tscope.faces.push( new THREE.Face3( a, b, c, null, null, 0 ) );\r\n\t\r\n\t\t\tvar uvs = uvgen.generateTopUV( scope, a, b, c );\r\n\t\r\n\t\t\tscope.faceVertexUvs[ 0 ].push( uvs );\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction f4( a, b, c, d, wallContour, stepIndex, stepsLength, contourIndex1, contourIndex2 ) {\r\n\t\r\n\t\t\ta += shapesOffset;\r\n\t\t\tb += shapesOffset;\r\n\t\t\tc += shapesOffset;\r\n\t\t\td += shapesOffset;\r\n\t\r\n\t\t\tscope.faces.push( new THREE.Face3( a, b, d, null, null, 1 ) );\r\n\t\t\tscope.faces.push( new THREE.Face3( b, c, d, null, null, 1 ) );\r\n\t\r\n\t\t\tvar uvs = uvgen.generateSideWallUV( scope, a, b, c, d );\r\n\t\r\n\t\t\tscope.faceVertexUvs[ 0 ].push( [ uvs[ 0 ], uvs[ 1 ], uvs[ 3 ] ] );\r\n\t\t\tscope.faceVertexUvs[ 0 ].push( [ uvs[ 1 ], uvs[ 2 ], uvs[ 3 ] ] );\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.ExtrudeGeometry.WorldUVGenerator = {\r\n\t\r\n\t\tgenerateTopUV: function ( geometry, indexA, indexB, indexC ) {\r\n\t\r\n\t\t\tvar vertices = geometry.vertices;\r\n\t\r\n\t\t\tvar a = vertices[ indexA ];\r\n\t\t\tvar b = vertices[ indexB ];\r\n\t\t\tvar c = vertices[ indexC ];\r\n\t\r\n\t\t\treturn [\r\n\t\t\t\tnew THREE.Vector2( a.x, a.y ),\r\n\t\t\t\tnew THREE.Vector2( b.x, b.y ),\r\n\t\t\t\tnew THREE.Vector2( c.x, c.y )\r\n\t\t\t];\r\n\t\r\n\t\t},\r\n\t\r\n\t\tgenerateSideWallUV: function ( geometry, indexA, indexB, indexC, indexD ) {\r\n\t\r\n\t\t\tvar vertices = geometry.vertices;\r\n\t\r\n\t\t\tvar a = vertices[ indexA ];\r\n\t\t\tvar b = vertices[ indexB ];\r\n\t\t\tvar c = vertices[ indexC ];\r\n\t\t\tvar d = vertices[ indexD ];\r\n\t\r\n\t\t\tif ( Math.abs( a.y - b.y ) < 0.01 ) {\r\n\t\r\n\t\t\t\treturn [\r\n\t\t\t\t\tnew THREE.Vector2( a.x, 1 - a.z ),\r\n\t\t\t\t\tnew THREE.Vector2( b.x, 1 - b.z ),\r\n\t\t\t\t\tnew THREE.Vector2( c.x, 1 - c.z ),\r\n\t\t\t\t\tnew THREE.Vector2( d.x, 1 - d.z )\r\n\t\t\t\t];\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\treturn [\r\n\t\t\t\t\tnew THREE.Vector2( a.y, 1 - a.z ),\r\n\t\t\t\t\tnew THREE.Vector2( b.y, 1 - b.z ),\r\n\t\t\t\t\tnew THREE.Vector2( c.y, 1 - c.z ),\r\n\t\t\t\t\tnew THREE.Vector2( d.y, 1 - d.z )\r\n\t\t\t\t];\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t};\r\n\t\r\n\t// File:src/extras/geometries/ShapeGeometry.js\r\n\t\r\n\t/**\r\n\t * @author jonobr1 / http://jonobr1.com\r\n\t *\r\n\t * Creates a one-sided polygonal geometry from a path shape. Similar to\r\n\t * ExtrudeGeometry.\r\n\t *\r\n\t * parameters = {\r\n\t *\r\n\t *\tcurveSegments: <int>, // number of points on the curves. NOT USED AT THE MOMENT.\r\n\t *\r\n\t *\tmaterial: <int> // material index for front and back faces\r\n\t *\tuvGenerator: <Object> // object that provides UV generator functions\r\n\t *\r\n\t * }\r\n\t **/\r\n\t\r\n\tTHREE.ShapeGeometry = function ( shapes, options ) {\r\n\t\r\n\t\tTHREE.Geometry.call( this );\r\n\t\r\n\t\tthis.type = 'ShapeGeometry';\r\n\t\r\n\t\tif ( Array.isArray( shapes ) === false ) shapes = [ shapes ];\r\n\t\r\n\t\tthis.addShapeList( shapes, options );\r\n\t\r\n\t\tthis.computeFaceNormals();\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.ShapeGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\n\tTHREE.ShapeGeometry.prototype.constructor = THREE.ShapeGeometry;\r\n\t\r\n\t/**\r\n\t * Add an array of shapes to THREE.ShapeGeometry.\r\n\t */\r\n\tTHREE.ShapeGeometry.prototype.addShapeList = function ( shapes, options ) {\r\n\t\r\n\t\tfor ( var i = 0, l = shapes.length; i < l; i ++ ) {\r\n\t\r\n\t\t\tthis.addShape( shapes[ i ], options );\r\n\t\r\n\t\t}\r\n\t\r\n\t\treturn this;\r\n\t\r\n\t};\r\n\t\r\n\t/**\r\n\t * Adds a shape to THREE.ShapeGeometry, based on THREE.ExtrudeGeometry.\r\n\t */\r\n\tTHREE.ShapeGeometry.prototype.addShape = function ( shape, options ) {\r\n\t\r\n\t\tif ( options === undefined ) options = {};\r\n\t\tvar curveSegments = options.curveSegments !== undefined ? options.curveSegments : 12;\r\n\t\r\n\t\tvar material = options.material;\r\n\t\tvar uvgen = options.UVGenerator === undefined ? THREE.ExtrudeGeometry.WorldUVGenerator : options.UVGenerator;\r\n\t\r\n\t\t//\r\n\t\r\n\t\tvar i, l, hole;\r\n\t\r\n\t\tvar shapesOffset = this.vertices.length;\r\n\t\tvar shapePoints = shape.extractPoints( curveSegments );\r\n\t\r\n\t\tvar vertices = shapePoints.shape;\r\n\t\tvar holes = shapePoints.holes;\r\n\t\r\n\t\tvar reverse = ! THREE.ShapeUtils.isClockWise( vertices );\r\n\t\r\n\t\tif ( reverse ) {\r\n\t\r\n\t\t\tvertices = vertices.reverse();\r\n\t\r\n\t\t\t// Maybe we should also check if holes are in the opposite direction, just to be safe...\r\n\t\r\n\t\t\tfor ( i = 0, l = holes.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\thole = holes[ i ];\r\n\t\r\n\t\t\t\tif ( THREE.ShapeUtils.isClockWise( hole ) ) {\r\n\t\r\n\t\t\t\t\tholes[ i ] = hole.reverse();\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\treverse = false;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tvar faces = THREE.ShapeUtils.triangulateShape( vertices, holes );\r\n\t\r\n\t\t// Vertices\r\n\t\r\n\t\tfor ( i = 0, l = holes.length; i < l; i ++ ) {\r\n\t\r\n\t\t\thole = holes[ i ];\r\n\t\t\tvertices = vertices.concat( hole );\r\n\t\r\n\t\t}\r\n\t\r\n\t\t//\r\n\t\r\n\t\tvar vert, vlen = vertices.length;\r\n\t\tvar face, flen = faces.length;\r\n\t\r\n\t\tfor ( i = 0; i < vlen; i ++ ) {\r\n\t\r\n\t\t\tvert = vertices[ i ];\r\n\t\r\n\t\t\tthis.vertices.push( new THREE.Vector3( vert.x, vert.y, 0 ) );\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfor ( i = 0; i < flen; i ++ ) {\r\n\t\r\n\t\t\tface = faces[ i ];\r\n\t\r\n\t\t\tvar a = face[ 0 ] + shapesOffset;\r\n\t\t\tvar b = face[ 1 ] + shapesOffset;\r\n\t\t\tvar c = face[ 2 ] + shapesOffset;\r\n\t\r\n\t\t\tthis.faces.push( new THREE.Face3( a, b, c, null, null, material ) );\r\n\t\t\tthis.faceVertexUvs[ 0 ].push( uvgen.generateTopUV( this, a, b, c ) );\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/extras/geometries/LatheGeometry.js\r\n\t\r\n\t/**\r\n\t * @author astrodud / http://astrodud.isgreat.org/\r\n\t * @author zz85 / https://github.com/zz85\r\n\t * @author bhouston / http://clara.io\r\n\t */\r\n\t\r\n\t// points - to create a closed torus, one must use a set of points \r\n\t//    like so: [ a, b, c, d, a ], see first is the same as last.\r\n\t// segments - the number of circumference segments to create\r\n\t// phiStart - the starting radian\r\n\t// phiLength - the radian (0 to 2*PI) range of the lathed section\r\n\t//    2*pi is a closed lathe, less than 2PI is a portion.\r\n\t\r\n\tTHREE.LatheGeometry = function ( points, segments, phiStart, phiLength ) {\r\n\t\r\n\t\tTHREE.Geometry.call( this );\r\n\t\r\n\t\tthis.type = 'LatheGeometry';\r\n\t\r\n\t\tthis.parameters = {\r\n\t\t\tpoints: points,\r\n\t\t\tsegments: segments,\r\n\t\t\tphiStart: phiStart,\r\n\t\t\tphiLength: phiLength\r\n\t\t};\r\n\t\r\n\t\tsegments = segments || 12;\r\n\t\tphiStart = phiStart || 0;\r\n\t\tphiLength = phiLength || 2 * Math.PI;\r\n\t\r\n\t\tvar inversePointLength = 1.0 / ( points.length - 1 );\r\n\t\tvar inverseSegments = 1.0 / segments;\r\n\t\r\n\t\tfor ( var i = 0, il = segments; i <= il; i ++ ) {\r\n\t\r\n\t\t\tvar phi = phiStart + i * inverseSegments * phiLength;\r\n\t\r\n\t\t\tvar c = Math.cos( phi ),\r\n\t\t\t\ts = Math.sin( phi );\r\n\t\r\n\t\t\tfor ( var j = 0, jl = points.length; j < jl; j ++ ) {\r\n\t\r\n\t\t\t\tvar pt = points[ j ];\r\n\t\r\n\t\t\t\tvar vertex = new THREE.Vector3();\r\n\t\r\n\t\t\t\tvertex.x = c * pt.x - s * pt.y;\r\n\t\t\t\tvertex.y = s * pt.x + c * pt.y;\r\n\t\t\t\tvertex.z = pt.z;\r\n\t\r\n\t\t\t\tthis.vertices.push( vertex );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tvar np = points.length;\r\n\t\r\n\t\tfor ( var i = 0, il = segments; i < il; i ++ ) {\r\n\t\r\n\t\t\tfor ( var j = 0, jl = points.length - 1; j < jl; j ++ ) {\r\n\t\r\n\t\t\t\tvar base = j + np * i;\r\n\t\t\t\tvar a = base;\r\n\t\t\t\tvar b = base + np;\r\n\t\t\t\tvar c = base + 1 + np;\r\n\t\t\t\tvar d = base + 1;\r\n\t\r\n\t\t\t\tvar u0 = i * inverseSegments;\r\n\t\t\t\tvar v0 = j * inversePointLength;\r\n\t\t\t\tvar u1 = u0 + inverseSegments;\r\n\t\t\t\tvar v1 = v0 + inversePointLength;\r\n\t\r\n\t\t\t\tthis.faces.push( new THREE.Face3( a, b, d ) );\r\n\t\r\n\t\t\t\tthis.faceVertexUvs[ 0 ].push( [\r\n\t\r\n\t\t\t\t\tnew THREE.Vector2( u0, v0 ),\r\n\t\t\t\t\tnew THREE.Vector2( u1, v0 ),\r\n\t\t\t\t\tnew THREE.Vector2( u0, v1 )\r\n\t\r\n\t\t\t\t] );\r\n\t\r\n\t\t\t\tthis.faces.push( new THREE.Face3( b, c, d ) );\r\n\t\r\n\t\t\t\tthis.faceVertexUvs[ 0 ].push( [\r\n\t\r\n\t\t\t\t\tnew THREE.Vector2( u1, v0 ),\r\n\t\t\t\t\tnew THREE.Vector2( u1, v1 ),\r\n\t\t\t\t\tnew THREE.Vector2( u0, v1 )\r\n\t\r\n\t\t\t\t] );\r\n\t\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tthis.mergeVertices();\r\n\t\tthis.computeFaceNormals();\r\n\t\tthis.computeVertexNormals();\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.LatheGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\n\tTHREE.LatheGeometry.prototype.constructor = THREE.LatheGeometry;\r\n\t\r\n\t// File:src/extras/geometries/PlaneGeometry.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * based on http://papervision3d.googlecode.com/svn/trunk/as3/trunk/src/org/papervision3d/objects/primitives/Plane.as\r\n\t */\r\n\t\r\n\tTHREE.PlaneGeometry = function ( width, height, widthSegments, heightSegments ) {\r\n\t\r\n\t\tTHREE.Geometry.call( this );\r\n\t\r\n\t\tthis.type = 'PlaneGeometry';\r\n\t\r\n\t\tthis.parameters = {\r\n\t\t\twidth: width,\r\n\t\t\theight: height,\r\n\t\t\twidthSegments: widthSegments,\r\n\t\t\theightSegments: heightSegments\r\n\t\t};\r\n\t\r\n\t\tthis.fromBufferGeometry( new THREE.PlaneBufferGeometry( width, height, widthSegments, heightSegments ) );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.PlaneGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\n\tTHREE.PlaneGeometry.prototype.constructor = THREE.PlaneGeometry;\r\n\t\r\n\tTHREE.PlaneGeometry.prototype.clone = function () {\r\n\t\r\n\t\tvar parameters = this.parameters;\r\n\t\r\n\t\treturn new THREE.PlaneGeometry(\r\n\t\t\tparameters.width,\r\n\t\t\tparameters.height,\r\n\t\t\tparameters.widthSegments,\r\n\t\t\tparameters.heightSegments\r\n\t\t);\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/extras/geometries/PlaneBufferGeometry.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * based on http://papervision3d.googlecode.com/svn/trunk/as3/trunk/src/org/papervision3d/objects/primitives/Plane.as\r\n\t */\r\n\t\r\n\tTHREE.PlaneBufferGeometry = function ( width, height, widthSegments, heightSegments ) {\r\n\t\r\n\t\tTHREE.BufferGeometry.call( this );\r\n\t\r\n\t\tthis.type = 'PlaneBufferGeometry';\r\n\t\r\n\t\tthis.parameters = {\r\n\t\t\twidth: width,\r\n\t\t\theight: height,\r\n\t\t\twidthSegments: widthSegments,\r\n\t\t\theightSegments: heightSegments\r\n\t\t};\r\n\t\r\n\t\tvar width_half = width / 2;\r\n\t\tvar height_half = height / 2;\r\n\t\r\n\t\tvar gridX = Math.floor( widthSegments ) || 1;\r\n\t\tvar gridY = Math.floor( heightSegments ) || 1;\r\n\t\r\n\t\tvar gridX1 = gridX + 1;\r\n\t\tvar gridY1 = gridY + 1;\r\n\t\r\n\t\tvar segment_width = width / gridX;\r\n\t\tvar segment_height = height / gridY;\r\n\t\r\n\t\tvar vertices = new Float32Array( gridX1 * gridY1 * 3 );\r\n\t\tvar normals = new Float32Array( gridX1 * gridY1 * 3 );\r\n\t\tvar uvs = new Float32Array( gridX1 * gridY1 * 2 );\r\n\t\r\n\t\tvar offset = 0;\r\n\t\tvar offset2 = 0;\r\n\t\r\n\t\tfor ( var iy = 0; iy < gridY1; iy ++ ) {\r\n\t\r\n\t\t\tvar y = iy * segment_height - height_half;\r\n\t\r\n\t\t\tfor ( var ix = 0; ix < gridX1; ix ++ ) {\r\n\t\r\n\t\t\t\tvar x = ix * segment_width - width_half;\r\n\t\r\n\t\t\t\tvertices[ offset ] = x;\r\n\t\t\t\tvertices[ offset + 1 ] = - y;\r\n\t\r\n\t\t\t\tnormals[ offset + 2 ] = 1;\r\n\t\r\n\t\t\t\tuvs[ offset2 ] = ix / gridX;\r\n\t\t\t\tuvs[ offset2 + 1 ] = 1 - ( iy / gridY );\r\n\t\r\n\t\t\t\toffset += 3;\r\n\t\t\t\toffset2 += 2;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\toffset = 0;\r\n\t\r\n\t\tvar indices = new ( ( vertices.length / 3 ) > 65535 ? Uint32Array : Uint16Array )( gridX * gridY * 6 );\r\n\t\r\n\t\tfor ( var iy = 0; iy < gridY; iy ++ ) {\r\n\t\r\n\t\t\tfor ( var ix = 0; ix < gridX; ix ++ ) {\r\n\t\r\n\t\t\t\tvar a = ix + gridX1 * iy;\r\n\t\t\t\tvar b = ix + gridX1 * ( iy + 1 );\r\n\t\t\t\tvar c = ( ix + 1 ) + gridX1 * ( iy + 1 );\r\n\t\t\t\tvar d = ( ix + 1 ) + gridX1 * iy;\r\n\t\r\n\t\t\t\tindices[ offset ] = a;\r\n\t\t\t\tindices[ offset + 1 ] = b;\r\n\t\t\t\tindices[ offset + 2 ] = d;\r\n\t\r\n\t\t\t\tindices[ offset + 3 ] = b;\r\n\t\t\t\tindices[ offset + 4 ] = c;\r\n\t\t\t\tindices[ offset + 5 ] = d;\r\n\t\r\n\t\t\t\toffset += 6;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tthis.setIndex( new THREE.BufferAttribute( indices, 1 ) );\r\n\t\tthis.addAttribute( 'position', new THREE.BufferAttribute( vertices, 3 ) );\r\n\t\tthis.addAttribute( 'normal', new THREE.BufferAttribute( normals, 3 ) );\r\n\t\tthis.addAttribute( 'uv', new THREE.BufferAttribute( uvs, 2 ) );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.PlaneBufferGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\r\n\tTHREE.PlaneBufferGeometry.prototype.constructor = THREE.PlaneBufferGeometry;\r\n\t\r\n\tTHREE.PlaneBufferGeometry.prototype.clone = function () {\r\n\t\r\n\t\tvar parameters = this.parameters;\r\n\t\r\n\t\treturn new THREE.PlaneBufferGeometry(\r\n\t\t\tparameters.width,\r\n\t\t\tparameters.height,\r\n\t\t\tparameters.widthSegments,\r\n\t\t\tparameters.heightSegments\r\n\t\t);\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/extras/geometries/RingGeometry.js\r\n\t\r\n\t/**\r\n\t * @author Kaleb Murphy\r\n\t */\r\n\t\r\n\tTHREE.RingGeometry = function ( innerRadius, outerRadius, thetaSegments, phiSegments, thetaStart, thetaLength ) {\r\n\t\r\n\t\tTHREE.Geometry.call( this );\r\n\t\r\n\t\tthis.type = 'RingGeometry';\r\n\t\r\n\t\tthis.parameters = {\r\n\t\t\tinnerRadius: innerRadius,\r\n\t\t\touterRadius: outerRadius,\r\n\t\t\tthetaSegments: thetaSegments,\r\n\t\t\tphiSegments: phiSegments,\r\n\t\t\tthetaStart: thetaStart,\r\n\t\t\tthetaLength: thetaLength\r\n\t\t};\r\n\t\r\n\t\tinnerRadius = innerRadius || 0;\r\n\t\touterRadius = outerRadius || 50;\r\n\t\r\n\t\tthetaStart = thetaStart !== undefined ? thetaStart : 0;\r\n\t\tthetaLength = thetaLength !== undefined ? thetaLength : Math.PI * 2;\r\n\t\r\n\t\tthetaSegments = thetaSegments !== undefined ? Math.max( 3, thetaSegments ) : 8;\r\n\t\tphiSegments = phiSegments !== undefined ? Math.max( 1, phiSegments ) : 8;\r\n\t\r\n\t\tvar i, o, uvs = [], radius = innerRadius, radiusStep = ( ( outerRadius - innerRadius ) / phiSegments );\r\n\t\r\n\t\tfor ( i = 0; i < phiSegments + 1; i ++ ) {\r\n\t\r\n\t\t\t// concentric circles inside ring\r\n\t\r\n\t\t\tfor ( o = 0; o < thetaSegments + 1; o ++ ) {\r\n\t\r\n\t\t\t\t// number of segments per circle\r\n\t\r\n\t\t\t\tvar vertex = new THREE.Vector3();\r\n\t\t\t\tvar segment = thetaStart + o / thetaSegments * thetaLength;\r\n\t\t\t\tvertex.x = radius * Math.cos( segment );\r\n\t\t\t\tvertex.y = radius * Math.sin( segment );\r\n\t\r\n\t\t\t\tthis.vertices.push( vertex );\r\n\t\t\t\tuvs.push( new THREE.Vector2( ( vertex.x / outerRadius + 1 ) / 2, ( vertex.y / outerRadius + 1 ) / 2 ) );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tradius += radiusStep;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tvar n = new THREE.Vector3( 0, 0, 1 );\r\n\t\r\n\t\tfor ( i = 0; i < phiSegments; i ++ ) {\r\n\t\r\n\t\t\t// concentric circles inside ring\r\n\t\r\n\t\t\tvar thetaSegment = i * ( thetaSegments + 1 );\r\n\t\r\n\t\t\tfor ( o = 0; o < thetaSegments ; o ++ ) {\r\n\t\r\n\t\t\t\t// number of segments per circle\r\n\t\r\n\t\t\t\tvar segment = o + thetaSegment;\r\n\t\r\n\t\t\t\tvar v1 = segment;\r\n\t\t\t\tvar v2 = segment + thetaSegments + 1;\r\n\t\t\t\tvar v3 = segment + thetaSegments + 2;\r\n\t\r\n\t\t\t\tthis.faces.push( new THREE.Face3( v1, v2, v3, [ n.clone(), n.clone(), n.clone() ] ) );\r\n\t\t\t\tthis.faceVertexUvs[ 0 ].push( [ uvs[ v1 ].clone(), uvs[ v2 ].clone(), uvs[ v3 ].clone() ] );\r\n\t\r\n\t\t\t\tv1 = segment;\r\n\t\t\t\tv2 = segment + thetaSegments + 2;\r\n\t\t\t\tv3 = segment + 1;\r\n\t\r\n\t\t\t\tthis.faces.push( new THREE.Face3( v1, v2, v3, [ n.clone(), n.clone(), n.clone() ] ) );\r\n\t\t\t\tthis.faceVertexUvs[ 0 ].push( [ uvs[ v1 ].clone(), uvs[ v2 ].clone(), uvs[ v3 ].clone() ] );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tthis.computeFaceNormals();\r\n\t\r\n\t\tthis.boundingSphere = new THREE.Sphere( new THREE.Vector3(), radius );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.RingGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\n\tTHREE.RingGeometry.prototype.constructor = THREE.RingGeometry;\r\n\t\r\n\tTHREE.RingGeometry.prototype.clone = function () {\r\n\t\r\n\t\tvar parameters = this.parameters;\r\n\t\r\n\t\treturn new THREE.RingGeometry(\r\n\t\t\tparameters.innerRadius,\r\n\t\t\tparameters.outerRadius,\r\n\t\t\tparameters.thetaSegments,\r\n\t\t\tparameters.phiSegments,\r\n\t\t\tparameters.thetaStart,\r\n\t\t\tparameters.thetaLength\r\n\t\t);\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/extras/geometries/SphereGeometry.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.SphereGeometry = function ( radius, widthSegments, heightSegments, phiStart, phiLength, thetaStart, thetaLength ) {\r\n\t\r\n\t\tTHREE.Geometry.call( this );\r\n\t\r\n\t\tthis.type = 'SphereGeometry';\r\n\t\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\twidthSegments: widthSegments,\r\n\t\t\theightSegments: heightSegments,\r\n\t\t\tphiStart: phiStart,\r\n\t\t\tphiLength: phiLength,\r\n\t\t\tthetaStart: thetaStart,\r\n\t\t\tthetaLength: thetaLength\r\n\t\t};\r\n\t\r\n\t\tthis.fromBufferGeometry( new THREE.SphereBufferGeometry( radius, widthSegments, heightSegments, phiStart, phiLength, thetaStart, thetaLength ) );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.SphereGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\n\tTHREE.SphereGeometry.prototype.constructor = THREE.SphereGeometry;\r\n\t\r\n\tTHREE.SphereGeometry.prototype.clone = function () {\r\n\t\r\n\t\tvar parameters = this.parameters;\r\n\t\r\n\t\treturn new THREE.SphereGeometry(\r\n\t\t\tparameters.radius,\r\n\t\t\tparameters.widthSegments,\r\n\t\t\tparameters.heightSegments,\r\n\t\t\tparameters.phiStart,\r\n\t\t\tparameters.phiLength,\r\n\t\t\tparameters.thetaStart,\r\n\t\t\tparameters.thetaLength\r\n\t\t);\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/extras/geometries/SphereBufferGeometry.js\r\n\t\r\n\t/**\r\n\t * @author benaadams / https://twitter.com/ben_a_adams\r\n\t * based on THREE.SphereGeometry\r\n\t */\r\n\t\r\n\tTHREE.SphereBufferGeometry = function ( radius, widthSegments, heightSegments, phiStart, phiLength, thetaStart, thetaLength ) {\r\n\t\r\n\t\tTHREE.BufferGeometry.call( this );\r\n\t\r\n\t\tthis.type = 'SphereBufferGeometry';\r\n\t\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\twidthSegments: widthSegments,\r\n\t\t\theightSegments: heightSegments,\r\n\t\t\tphiStart: phiStart,\r\n\t\t\tphiLength: phiLength,\r\n\t\t\tthetaStart: thetaStart,\r\n\t\t\tthetaLength: thetaLength\r\n\t\t};\r\n\t\r\n\t\tradius = radius || 50;\r\n\t\r\n\t\twidthSegments = Math.max( 3, Math.floor( widthSegments ) || 8 );\r\n\t\theightSegments = Math.max( 2, Math.floor( heightSegments ) || 6 );\r\n\t\r\n\t\tphiStart = phiStart !== undefined ? phiStart : 0;\r\n\t\tphiLength = phiLength !== undefined ? phiLength : Math.PI * 2;\r\n\t\r\n\t\tthetaStart = thetaStart !== undefined ? thetaStart : 0;\r\n\t\tthetaLength = thetaLength !== undefined ? thetaLength : Math.PI;\r\n\t\r\n\t\tvar thetaEnd = thetaStart + thetaLength;\r\n\t\r\n\t\tvar vertexCount = ( ( widthSegments + 1 ) * ( heightSegments + 1 ) );\r\n\t\r\n\t\tvar positions = new THREE.BufferAttribute( new Float32Array( vertexCount * 3 ), 3 );\r\n\t\tvar normals = new THREE.BufferAttribute( new Float32Array( vertexCount * 3 ), 3 );\r\n\t\tvar uvs = new THREE.BufferAttribute( new Float32Array( vertexCount * 2 ), 2 );\r\n\t\r\n\t\tvar index = 0, vertices = [], normal = new THREE.Vector3();\r\n\t\r\n\t\tfor ( var y = 0; y <= heightSegments; y ++ ) {\r\n\t\r\n\t\t\tvar verticesRow = [];\r\n\t\r\n\t\t\tvar v = y / heightSegments;\r\n\t\r\n\t\t\tfor ( var x = 0; x <= widthSegments; x ++ ) {\r\n\t\r\n\t\t\t\tvar u = x / widthSegments;\r\n\t\r\n\t\t\t\tvar px = - radius * Math.cos( phiStart + u * phiLength ) * Math.sin( thetaStart + v * thetaLength );\r\n\t\t\t\tvar py = radius * Math.cos( thetaStart + v * thetaLength );\r\n\t\t\t\tvar pz = radius * Math.sin( phiStart + u * phiLength ) * Math.sin( thetaStart + v * thetaLength );\r\n\t\r\n\t\t\t\tnormal.set( px, py, pz ).normalize();\r\n\t\r\n\t\t\t\tpositions.setXYZ( index, px, py, pz );\r\n\t\t\t\tnormals.setXYZ( index, normal.x, normal.y, normal.z );\r\n\t\t\t\tuvs.setXY( index, u, 1 - v );\r\n\t\r\n\t\t\t\tverticesRow.push( index );\r\n\t\r\n\t\t\t\tindex ++;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvertices.push( verticesRow );\r\n\t\r\n\t\t}\r\n\t\r\n\t\tvar indices = [];\r\n\t\r\n\t\tfor ( var y = 0; y < heightSegments; y ++ ) {\r\n\t\r\n\t\t\tfor ( var x = 0; x < widthSegments; x ++ ) {\r\n\t\r\n\t\t\t\tvar v1 = vertices[ y ][ x + 1 ];\r\n\t\t\t\tvar v2 = vertices[ y ][ x ];\r\n\t\t\t\tvar v3 = vertices[ y + 1 ][ x ];\r\n\t\t\t\tvar v4 = vertices[ y + 1 ][ x + 1 ];\r\n\t\r\n\t\t\t\tif ( y !== 0 || thetaStart > 0 ) indices.push( v1, v2, v4 );\r\n\t\t\t\tif ( y !== heightSegments - 1 || thetaEnd < Math.PI ) indices.push( v2, v3, v4 );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tthis.setIndex( new ( positions.count > 65535 ? THREE.Uint32Attribute : THREE.Uint16Attribute )( indices, 1 ) );\r\n\t\tthis.addAttribute( 'position', positions );\r\n\t\tthis.addAttribute( 'normal', normals );\r\n\t\tthis.addAttribute( 'uv', uvs );\r\n\t\r\n\t\tthis.boundingSphere = new THREE.Sphere( new THREE.Vector3(), radius );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.SphereBufferGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\r\n\tTHREE.SphereBufferGeometry.prototype.constructor = THREE.SphereBufferGeometry;\r\n\t\r\n\tTHREE.SphereBufferGeometry.prototype.clone = function () {\r\n\t\r\n\t\tvar parameters = this.parameters;\r\n\t\r\n\t\treturn new THREE.SphereBufferGeometry(\r\n\t\t\tparameters.radius,\r\n\t\t\tparameters.widthSegments,\r\n\t\t\tparameters.heightSegments,\r\n\t\t\tparameters.phiStart,\r\n\t\t\tparameters.phiLength,\r\n\t\t\tparameters.thetaStart,\r\n\t\t\tparameters.thetaLength\r\n\t\t);\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/extras/geometries/TorusGeometry.js\r\n\t\r\n\t/**\r\n\t * @author oosmoxiecode\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * based on http://code.google.com/p/away3d/source/browse/trunk/fp10/Away3DLite/src/away3dlite/primitives/Torus.as?r=2888\r\n\t */\r\n\t\r\n\tTHREE.TorusGeometry = function ( radius, tube, radialSegments, tubularSegments, arc ) {\r\n\t\r\n\t\tTHREE.Geometry.call( this );\r\n\t\r\n\t\tthis.type = 'TorusGeometry';\r\n\t\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\ttube: tube,\r\n\t\t\tradialSegments: radialSegments,\r\n\t\t\ttubularSegments: tubularSegments,\r\n\t\t\tarc: arc\r\n\t\t};\r\n\t\r\n\t\tradius = radius || 100;\r\n\t\ttube = tube || 40;\r\n\t\tradialSegments = radialSegments || 8;\r\n\t\ttubularSegments = tubularSegments || 6;\r\n\t\tarc = arc || Math.PI * 2;\r\n\t\r\n\t\tvar center = new THREE.Vector3(), uvs = [], normals = [];\r\n\t\r\n\t\tfor ( var j = 0; j <= radialSegments; j ++ ) {\r\n\t\r\n\t\t\tfor ( var i = 0; i <= tubularSegments; i ++ ) {\r\n\t\r\n\t\t\t\tvar u = i / tubularSegments * arc;\r\n\t\t\t\tvar v = j / radialSegments * Math.PI * 2;\r\n\t\r\n\t\t\t\tcenter.x = radius * Math.cos( u );\r\n\t\t\t\tcenter.y = radius * Math.sin( u );\r\n\t\r\n\t\t\t\tvar vertex = new THREE.Vector3();\r\n\t\t\t\tvertex.x = ( radius + tube * Math.cos( v ) ) * Math.cos( u );\r\n\t\t\t\tvertex.y = ( radius + tube * Math.cos( v ) ) * Math.sin( u );\r\n\t\t\t\tvertex.z = tube * Math.sin( v );\r\n\t\r\n\t\t\t\tthis.vertices.push( vertex );\r\n\t\r\n\t\t\t\tuvs.push( new THREE.Vector2( i / tubularSegments, j / radialSegments ) );\r\n\t\t\t\tnormals.push( vertex.clone().sub( center ).normalize() );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfor ( var j = 1; j <= radialSegments; j ++ ) {\r\n\t\r\n\t\t\tfor ( var i = 1; i <= tubularSegments; i ++ ) {\r\n\t\r\n\t\t\t\tvar a = ( tubularSegments + 1 ) * j + i - 1;\r\n\t\t\t\tvar b = ( tubularSegments + 1 ) * ( j - 1 ) + i - 1;\r\n\t\t\t\tvar c = ( tubularSegments + 1 ) * ( j - 1 ) + i;\r\n\t\t\t\tvar d = ( tubularSegments + 1 ) * j + i;\r\n\t\r\n\t\t\t\tvar face = new THREE.Face3( a, b, d, [ normals[ a ].clone(), normals[ b ].clone(), normals[ d ].clone() ] );\r\n\t\t\t\tthis.faces.push( face );\r\n\t\t\t\tthis.faceVertexUvs[ 0 ].push( [ uvs[ a ].clone(), uvs[ b ].clone(), uvs[ d ].clone() ] );\r\n\t\r\n\t\t\t\tface = new THREE.Face3( b, c, d, [ normals[ b ].clone(), normals[ c ].clone(), normals[ d ].clone() ] );\r\n\t\t\t\tthis.faces.push( face );\r\n\t\t\t\tthis.faceVertexUvs[ 0 ].push( [ uvs[ b ].clone(), uvs[ c ].clone(), uvs[ d ].clone() ] );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tthis.computeFaceNormals();\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.TorusGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\n\tTHREE.TorusGeometry.prototype.constructor = THREE.TorusGeometry;\r\n\t\r\n\tTHREE.TorusGeometry.prototype.clone = function () {\r\n\t\r\n\t\tvar parameters = this.parameters;\r\n\t\r\n\t\treturn new THREE.TorusGeometry(\r\n\t\t\tparameters.radius,\r\n\t\t\tparameters.tube,\r\n\t\t\tparameters.radialSegments,\r\n\t\t\tparameters.tubularSegments,\r\n\t\t\tparameters.arc\r\n\t\t);\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/extras/geometries/TorusKnotGeometry.js\r\n\t\r\n\t/**\r\n\t * @author oosmoxiecode\r\n\t * based on http://code.google.com/p/away3d/source/browse/trunk/fp10/Away3D/src/away3d/primitives/TorusKnot.as?spec=svn2473&r=2473\r\n\t */\r\n\t\r\n\tTHREE.TorusKnotGeometry = function ( radius, tube, radialSegments, tubularSegments, p, q, heightScale ) {\r\n\t\r\n\t\tTHREE.Geometry.call( this );\r\n\t\r\n\t\tthis.type = 'TorusKnotGeometry';\r\n\t\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\ttube: tube,\r\n\t\t\tradialSegments: radialSegments,\r\n\t\t\ttubularSegments: tubularSegments,\r\n\t\t\tp: p,\r\n\t\t\tq: q,\r\n\t\t\theightScale: heightScale\r\n\t\t};\r\n\t\r\n\t\tradius = radius || 100;\r\n\t\ttube = tube || 40;\r\n\t\tradialSegments = radialSegments || 64;\r\n\t\ttubularSegments = tubularSegments || 8;\r\n\t\tp = p || 2;\r\n\t\tq = q || 3;\r\n\t\theightScale = heightScale || 1;\r\n\t\r\n\t\tvar grid = new Array( radialSegments );\r\n\t\tvar tang = new THREE.Vector3();\r\n\t\tvar n = new THREE.Vector3();\r\n\t\tvar bitan = new THREE.Vector3();\r\n\t\r\n\t\tfor ( var i = 0; i < radialSegments; ++ i ) {\r\n\t\r\n\t\t\tgrid[ i ] = new Array( tubularSegments );\r\n\t\t\tvar u = i / radialSegments * 2 * p * Math.PI;\r\n\t\t\tvar p1 = getPos( u, q, p, radius, heightScale );\r\n\t\t\tvar p2 = getPos( u + 0.01, q, p, radius, heightScale );\r\n\t\t\ttang.subVectors( p2, p1 );\r\n\t\t\tn.addVectors( p2, p1 );\r\n\t\r\n\t\t\tbitan.crossVectors( tang, n );\r\n\t\t\tn.crossVectors( bitan, tang );\r\n\t\t\tbitan.normalize();\r\n\t\t\tn.normalize();\r\n\t\r\n\t\t\tfor ( var j = 0; j < tubularSegments; ++ j ) {\r\n\t\r\n\t\t\t\tvar v = j / tubularSegments * 2 * Math.PI;\r\n\t\t\t\tvar cx = - tube * Math.cos( v ); // TODO: Hack: Negating it so it faces outside.\r\n\t\t\t\tvar cy = tube * Math.sin( v );\r\n\t\r\n\t\t\t\tvar pos = new THREE.Vector3();\r\n\t\t\t\tpos.x = p1.x + cx * n.x + cy * bitan.x;\r\n\t\t\t\tpos.y = p1.y + cx * n.y + cy * bitan.y;\r\n\t\t\t\tpos.z = p1.z + cx * n.z + cy * bitan.z;\r\n\t\r\n\t\t\t\tgrid[ i ][ j ] = this.vertices.push( pos ) - 1;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfor ( var i = 0; i < radialSegments; ++ i ) {\r\n\t\r\n\t\t\tfor ( var j = 0; j < tubularSegments; ++ j ) {\r\n\t\r\n\t\t\t\tvar ip = ( i + 1 ) % radialSegments;\r\n\t\t\t\tvar jp = ( j + 1 ) % tubularSegments;\r\n\t\r\n\t\t\t\tvar a = grid[ i ][ j ];\r\n\t\t\t\tvar b = grid[ ip ][ j ];\r\n\t\t\t\tvar c = grid[ ip ][ jp ];\r\n\t\t\t\tvar d = grid[ i ][ jp ];\r\n\t\r\n\t\t\t\tvar uva = new THREE.Vector2( i / radialSegments, j / tubularSegments );\r\n\t\t\t\tvar uvb = new THREE.Vector2( ( i + 1 ) / radialSegments, j / tubularSegments );\r\n\t\t\t\tvar uvc = new THREE.Vector2( ( i + 1 ) / radialSegments, ( j + 1 ) / tubularSegments );\r\n\t\t\t\tvar uvd = new THREE.Vector2( i / radialSegments, ( j + 1 ) / tubularSegments );\r\n\t\r\n\t\t\t\tthis.faces.push( new THREE.Face3( a, b, d ) );\r\n\t\t\t\tthis.faceVertexUvs[ 0 ].push( [ uva, uvb, uvd ] );\r\n\t\r\n\t\t\t\tthis.faces.push( new THREE.Face3( b, c, d ) );\r\n\t\t\t\tthis.faceVertexUvs[ 0 ].push( [ uvb.clone(), uvc, uvd.clone() ] );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tthis.computeFaceNormals();\r\n\t\tthis.computeVertexNormals();\r\n\t\r\n\t\tfunction getPos( u, in_q, in_p, radius, heightScale ) {\r\n\t\r\n\t\t\tvar cu = Math.cos( u );\r\n\t\t\tvar su = Math.sin( u );\r\n\t\t\tvar quOverP = in_q / in_p * u;\r\n\t\t\tvar cs = Math.cos( quOverP );\r\n\t\r\n\t\t\tvar tx = radius * ( 2 + cs ) * 0.5 * cu;\r\n\t\t\tvar ty = radius * ( 2 + cs ) * su * 0.5;\r\n\t\t\tvar tz = heightScale * radius * Math.sin( quOverP ) * 0.5;\r\n\t\r\n\t\t\treturn new THREE.Vector3( tx, ty, tz );\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.TorusKnotGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\n\tTHREE.TorusKnotGeometry.prototype.constructor = THREE.TorusKnotGeometry;\r\n\t\r\n\tTHREE.TorusKnotGeometry.prototype.clone = function () {\r\n\t\r\n\t\tvar parameters = this.parameters;\r\n\t\r\n\t\treturn new THREE.TorusKnotGeometry(\r\n\t\t\tparameters.radius,\r\n\t\t\tparameters.tube,\r\n\t\t\tparameters.radialSegments,\r\n\t\t\tparameters.tubularSegments,\r\n\t\t\tparameters.p,\r\n\t\t\tparameters.q,\r\n\t\t\tparameters.heightScale\r\n\t\t);\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/extras/geometries/TubeGeometry.js\r\n\t\r\n\t/**\r\n\t * @author WestLangley / https://github.com/WestLangley\r\n\t * @author zz85 / https://github.com/zz85\r\n\t * @author miningold / https://github.com/miningold\r\n\t * @author jonobr1 / https://github.com/jonobr1\r\n\t *\r\n\t * Modified from the TorusKnotGeometry by @oosmoxiecode\r\n\t *\r\n\t * Creates a tube which extrudes along a 3d spline\r\n\t *\r\n\t * Uses parallel transport frames as described in\r\n\t * http://www.cs.indiana.edu/pub/techreports/TR425.pdf\r\n\t */\r\n\t\r\n\tTHREE.TubeGeometry = function ( path, segments, radius, radialSegments, closed, taper ) {\r\n\t\r\n\t\tTHREE.Geometry.call( this );\r\n\t\r\n\t\tthis.type = 'TubeGeometry';\r\n\t\r\n\t\tthis.parameters = {\r\n\t\t\tpath: path,\r\n\t\t\tsegments: segments,\r\n\t\t\tradius: radius,\r\n\t\t\tradialSegments: radialSegments,\r\n\t\t\tclosed: closed,\r\n\t\t\ttaper: taper\r\n\t\t};\r\n\t\r\n\t\tsegments = segments || 64;\r\n\t\tradius = radius || 1;\r\n\t\tradialSegments = radialSegments || 8;\r\n\t\tclosed = closed || false;\r\n\t\ttaper = taper || THREE.TubeGeometry.NoTaper;\r\n\t\r\n\t\tvar grid = [];\r\n\t\r\n\t\tvar scope = this,\r\n\t\r\n\t\t\ttangent,\r\n\t\t\tnormal,\r\n\t\t\tbinormal,\r\n\t\r\n\t\t\tnumpoints = segments + 1,\r\n\t\r\n\t\t\tu, v, r,\r\n\t\r\n\t\t\tcx, cy,\r\n\t\t\tpos, pos2 = new THREE.Vector3(),\r\n\t\t\ti, j,\r\n\t\t\tip, jp,\r\n\t\t\ta, b, c, d,\r\n\t\t\tuva, uvb, uvc, uvd;\r\n\t\r\n\t\tvar frames = new THREE.TubeGeometry.FrenetFrames( path, segments, closed ),\r\n\t\t\ttangents = frames.tangents,\r\n\t\t\tnormals = frames.normals,\r\n\t\t\tbinormals = frames.binormals;\r\n\t\r\n\t\t// proxy internals\r\n\t\tthis.tangents = tangents;\r\n\t\tthis.normals = normals;\r\n\t\tthis.binormals = binormals;\r\n\t\r\n\t\tfunction vert( x, y, z ) {\r\n\t\r\n\t\t\treturn scope.vertices.push( new THREE.Vector3( x, y, z ) ) - 1;\r\n\t\r\n\t\t}\r\n\t\r\n\t\t// construct the grid\r\n\t\r\n\t\tfor ( i = 0; i < numpoints; i ++ ) {\r\n\t\r\n\t\t\tgrid[ i ] = [];\r\n\t\r\n\t\t\tu = i / ( numpoints - 1 );\r\n\t\r\n\t\t\tpos = path.getPointAt( u );\r\n\t\r\n\t\t\ttangent = tangents[ i ];\r\n\t\t\tnormal = normals[ i ];\r\n\t\t\tbinormal = binormals[ i ];\r\n\t\r\n\t\t\tr = radius * taper( u );\r\n\t\r\n\t\t\tfor ( j = 0; j < radialSegments; j ++ ) {\r\n\t\r\n\t\t\t\tv = j / radialSegments * 2 * Math.PI;\r\n\t\r\n\t\t\t\tcx = - r * Math.cos( v ); // TODO: Hack: Negating it so it faces outside.\r\n\t\t\t\tcy = r * Math.sin( v );\r\n\t\r\n\t\t\t\tpos2.copy( pos );\r\n\t\t\t\tpos2.x += cx * normal.x + cy * binormal.x;\r\n\t\t\t\tpos2.y += cx * normal.y + cy * binormal.y;\r\n\t\t\t\tpos2.z += cx * normal.z + cy * binormal.z;\r\n\t\r\n\t\t\t\tgrid[ i ][ j ] = vert( pos2.x, pos2.y, pos2.z );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\r\n\t\t// construct the mesh\r\n\t\r\n\t\tfor ( i = 0; i < segments; i ++ ) {\r\n\t\r\n\t\t\tfor ( j = 0; j < radialSegments; j ++ ) {\r\n\t\r\n\t\t\t\tip = ( closed ) ? ( i + 1 ) % segments : i + 1;\r\n\t\t\t\tjp = ( j + 1 ) % radialSegments;\r\n\t\r\n\t\t\t\ta = grid[ i ][ j ];\t\t// *** NOT NECESSARILY PLANAR ! ***\r\n\t\t\t\tb = grid[ ip ][ j ];\r\n\t\t\t\tc = grid[ ip ][ jp ];\r\n\t\t\t\td = grid[ i ][ jp ];\r\n\t\r\n\t\t\t\tuva = new THREE.Vector2( i / segments, j / radialSegments );\r\n\t\t\t\tuvb = new THREE.Vector2( ( i + 1 ) / segments, j / radialSegments );\r\n\t\t\t\tuvc = new THREE.Vector2( ( i + 1 ) / segments, ( j + 1 ) / radialSegments );\r\n\t\t\t\tuvd = new THREE.Vector2( i / segments, ( j + 1 ) / radialSegments );\r\n\t\r\n\t\t\t\tthis.faces.push( new THREE.Face3( a, b, d ) );\r\n\t\t\t\tthis.faceVertexUvs[ 0 ].push( [ uva, uvb, uvd ] );\r\n\t\r\n\t\t\t\tthis.faces.push( new THREE.Face3( b, c, d ) );\r\n\t\t\t\tthis.faceVertexUvs[ 0 ].push( [ uvb.clone(), uvc, uvd.clone() ] );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tthis.computeFaceNormals();\r\n\t\tthis.computeVertexNormals();\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.TubeGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\n\tTHREE.TubeGeometry.prototype.constructor = THREE.TubeGeometry;\r\n\tTHREE.TubeGeometry.prototype.clone = function() {\r\n\t\r\n\t\treturn new this.constructor( this.parameters.path,\r\n\t\t\tthis.parameters.segments, this.parameters.radius, this.parameters.radialSegments,\r\n\t\t\tthis.parameters.closed, this.parameters.taper\r\n\t\t);\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.TubeGeometry.NoTaper = function ( u ) {\r\n\t\r\n\t\treturn 1;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.TubeGeometry.SinusoidalTaper = function ( u ) {\r\n\t\r\n\t\treturn Math.sin( Math.PI * u );\r\n\t\r\n\t};\r\n\t\r\n\t// For computing of Frenet frames, exposing the tangents, normals and binormals the spline\r\n\tTHREE.TubeGeometry.FrenetFrames = function ( path, segments, closed ) {\r\n\t\r\n\t\tvar\tnormal = new THREE.Vector3(),\r\n\t\r\n\t\t\ttangents = [],\r\n\t\t\tnormals = [],\r\n\t\t\tbinormals = [],\r\n\t\r\n\t\t\tvec = new THREE.Vector3(),\r\n\t\t\tmat = new THREE.Matrix4(),\r\n\t\r\n\t\t\tnumpoints = segments + 1,\r\n\t\t\ttheta,\r\n\t\t\tsmallest,\r\n\t\r\n\t\t\ttx, ty, tz,\r\n\t\t\ti, u;\r\n\t\r\n\t\r\n\t\t// expose internals\r\n\t\tthis.tangents = tangents;\r\n\t\tthis.normals = normals;\r\n\t\tthis.binormals = binormals;\r\n\t\r\n\t\t// compute the tangent vectors for each segment on the path\r\n\t\r\n\t\tfor ( i = 0; i < numpoints; i ++ ) {\r\n\t\r\n\t\t\tu = i / ( numpoints - 1 );\r\n\t\r\n\t\t\ttangents[ i ] = path.getTangentAt( u );\r\n\t\t\ttangents[ i ].normalize();\r\n\t\r\n\t\t}\r\n\t\r\n\t\tinitialNormal3();\r\n\t\r\n\t\t/*\r\n\t\tfunction initialNormal1(lastBinormal) {\r\n\t\t\t// fixed start binormal. Has dangers of 0 vectors\r\n\t\t\tnormals[ 0 ] = new THREE.Vector3();\r\n\t\t\tbinormals[ 0 ] = new THREE.Vector3();\r\n\t\t\tif (lastBinormal===undefined) lastBinormal = new THREE.Vector3( 0, 0, 1 );\r\n\t\t\tnormals[ 0 ].crossVectors( lastBinormal, tangents[ 0 ] ).normalize();\r\n\t\t\tbinormals[ 0 ].crossVectors( tangents[ 0 ], normals[ 0 ] ).normalize();\r\n\t\t}\r\n\t\r\n\t\tfunction initialNormal2() {\r\n\t\r\n\t\t\t// This uses the Frenet-Serret formula for deriving binormal\r\n\t\t\tvar t2 = path.getTangentAt( epsilon );\r\n\t\r\n\t\t\tnormals[ 0 ] = new THREE.Vector3().subVectors( t2, tangents[ 0 ] ).normalize();\r\n\t\t\tbinormals[ 0 ] = new THREE.Vector3().crossVectors( tangents[ 0 ], normals[ 0 ] );\r\n\t\r\n\t\t\tnormals[ 0 ].crossVectors( binormals[ 0 ], tangents[ 0 ] ).normalize(); // last binormal x tangent\r\n\t\t\tbinormals[ 0 ].crossVectors( tangents[ 0 ], normals[ 0 ] ).normalize();\r\n\t\r\n\t\t}\r\n\t\t*/\r\n\t\r\n\t\tfunction initialNormal3() {\r\n\t\r\n\t\t\t// select an initial normal vector perpendicular to the first tangent vector,\r\n\t\t\t// and in the direction of the smallest tangent xyz component\r\n\t\r\n\t\t\tnormals[ 0 ] = new THREE.Vector3();\r\n\t\t\tbinormals[ 0 ] = new THREE.Vector3();\r\n\t\t\tsmallest = Number.MAX_VALUE;\r\n\t\t\ttx = Math.abs( tangents[ 0 ].x );\r\n\t\t\tty = Math.abs( tangents[ 0 ].y );\r\n\t\t\ttz = Math.abs( tangents[ 0 ].z );\r\n\t\r\n\t\t\tif ( tx <= smallest ) {\r\n\t\r\n\t\t\t\tsmallest = tx;\r\n\t\t\t\tnormal.set( 1, 0, 0 );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( ty <= smallest ) {\r\n\t\r\n\t\t\t\tsmallest = ty;\r\n\t\t\t\tnormal.set( 0, 1, 0 );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tif ( tz <= smallest ) {\r\n\t\r\n\t\t\t\tnormal.set( 0, 0, 1 );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvec.crossVectors( tangents[ 0 ], normal ).normalize();\r\n\t\r\n\t\t\tnormals[ 0 ].crossVectors( tangents[ 0 ], vec );\r\n\t\t\tbinormals[ 0 ].crossVectors( tangents[ 0 ], normals[ 0 ] );\r\n\t\r\n\t\t}\r\n\t\r\n\t\r\n\t\t// compute the slowly-varying normal and binormal vectors for each segment on the path\r\n\t\r\n\t\tfor ( i = 1; i < numpoints; i ++ ) {\r\n\t\r\n\t\t\tnormals[ i ] = normals[ i - 1 ].clone();\r\n\t\r\n\t\t\tbinormals[ i ] = binormals[ i - 1 ].clone();\r\n\t\r\n\t\t\tvec.crossVectors( tangents[ i - 1 ], tangents[ i ] );\r\n\t\r\n\t\t\tif ( vec.length() > Number.EPSILON ) {\r\n\t\r\n\t\t\t\tvec.normalize();\r\n\t\r\n\t\t\t\ttheta = Math.acos( THREE.Math.clamp( tangents[ i - 1 ].dot( tangents[ i ] ), - 1, 1 ) ); // clamp for floating pt errors\r\n\t\r\n\t\t\t\tnormals[ i ].applyMatrix4( mat.makeRotationAxis( vec, theta ) );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tbinormals[ i ].crossVectors( tangents[ i ], normals[ i ] );\r\n\t\r\n\t\t}\r\n\t\r\n\t\r\n\t\t// if the curve is closed, postprocess the vectors so the first and last normal vectors are the same\r\n\t\r\n\t\tif ( closed ) {\r\n\t\r\n\t\t\ttheta = Math.acos( THREE.Math.clamp( normals[ 0 ].dot( normals[ numpoints - 1 ] ), - 1, 1 ) );\r\n\t\t\ttheta /= ( numpoints - 1 );\r\n\t\r\n\t\t\tif ( tangents[ 0 ].dot( vec.crossVectors( normals[ 0 ], normals[ numpoints - 1 ] ) ) > 0 ) {\r\n\t\r\n\t\t\t\ttheta = - theta;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tfor ( i = 1; i < numpoints; i ++ ) {\r\n\t\r\n\t\t\t\t// twist a little...\r\n\t\t\t\tnormals[ i ].applyMatrix4( mat.makeRotationAxis( tangents[ i ], theta * i ) );\r\n\t\t\t\tbinormals[ i ].crossVectors( tangents[ i ], normals[ i ] );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/extras/geometries/PolyhedronGeometry.js\r\n\t\r\n\t/**\r\n\t * @author clockworkgeek / https://github.com/clockworkgeek\r\n\t * @author timothypratley / https://github.com/timothypratley\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t*/\r\n\t\r\n\tTHREE.PolyhedronGeometry = function ( vertices, indices, radius, detail ) {\r\n\t\r\n\t\tTHREE.Geometry.call( this );\r\n\t\r\n\t\tthis.type = 'PolyhedronGeometry';\r\n\t\r\n\t\tthis.parameters = {\r\n\t\t\tvertices: vertices,\r\n\t\t\tindices: indices,\r\n\t\t\tradius: radius,\r\n\t\t\tdetail: detail\r\n\t\t};\r\n\t\r\n\t\tradius = radius || 1;\r\n\t\tdetail = detail || 0;\r\n\t\r\n\t\tvar that = this;\r\n\t\r\n\t\tfor ( var i = 0, l = vertices.length; i < l; i += 3 ) {\r\n\t\r\n\t\t\tprepare( new THREE.Vector3( vertices[ i ], vertices[ i + 1 ], vertices[ i + 2 ] ) );\r\n\t\r\n\t\t}\r\n\t\r\n\t\tvar p = this.vertices;\r\n\t\r\n\t\tvar faces = [];\r\n\t\r\n\t\tfor ( var i = 0, j = 0, l = indices.length; i < l; i += 3, j ++ ) {\r\n\t\r\n\t\t\tvar v1 = p[ indices[ i ] ];\r\n\t\t\tvar v2 = p[ indices[ i + 1 ] ];\r\n\t\t\tvar v3 = p[ indices[ i + 2 ] ];\r\n\t\r\n\t\t\tfaces[ j ] = new THREE.Face3( v1.index, v2.index, v3.index, [ v1.clone(), v2.clone(), v3.clone() ], undefined, j );\r\n\t\r\n\t\t}\r\n\t\r\n\t\tvar centroid = new THREE.Vector3();\r\n\t\r\n\t\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\r\n\t\r\n\t\t\tsubdivide( faces[ i ], detail );\r\n\t\r\n\t\t}\r\n\t\r\n\t\r\n\t\t// Handle case when face straddles the seam\r\n\t\r\n\t\tfor ( var i = 0, l = this.faceVertexUvs[ 0 ].length; i < l; i ++ ) {\r\n\t\r\n\t\t\tvar uvs = this.faceVertexUvs[ 0 ][ i ];\r\n\t\r\n\t\t\tvar x0 = uvs[ 0 ].x;\r\n\t\t\tvar x1 = uvs[ 1 ].x;\r\n\t\t\tvar x2 = uvs[ 2 ].x;\r\n\t\r\n\t\t\tvar max = Math.max( x0, x1, x2 );\r\n\t\t\tvar min = Math.min( x0, x1, x2 );\r\n\t\r\n\t\t\tif ( max > 0.9 && min < 0.1 ) {\r\n\t\r\n\t\t\t\t// 0.9 is somewhat arbitrary\r\n\t\r\n\t\t\t\tif ( x0 < 0.2 ) uvs[ 0 ].x += 1;\r\n\t\t\t\tif ( x1 < 0.2 ) uvs[ 1 ].x += 1;\r\n\t\t\t\tif ( x2 < 0.2 ) uvs[ 2 ].x += 1;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\r\n\t\t// Apply radius\r\n\t\r\n\t\tfor ( var i = 0, l = this.vertices.length; i < l; i ++ ) {\r\n\t\r\n\t\t\tthis.vertices[ i ].multiplyScalar( radius );\r\n\t\r\n\t\t}\r\n\t\r\n\t\r\n\t\t// Merge vertices\r\n\t\r\n\t\tthis.mergeVertices();\r\n\t\r\n\t\tthis.computeFaceNormals();\r\n\t\r\n\t\tthis.boundingSphere = new THREE.Sphere( new THREE.Vector3(), radius );\r\n\t\r\n\t\r\n\t\t// Project vector onto sphere's surface\r\n\t\r\n\t\tfunction prepare( vector ) {\r\n\t\r\n\t\t\tvar vertex = vector.normalize().clone();\r\n\t\t\tvertex.index = that.vertices.push( vertex ) - 1;\r\n\t\r\n\t\t\t// Texture coords are equivalent to map coords, calculate angle and convert to fraction of a circle.\r\n\t\r\n\t\t\tvar u = azimuth( vector ) / 2 / Math.PI + 0.5;\r\n\t\t\tvar v = inclination( vector ) / Math.PI + 0.5;\r\n\t\t\tvertex.uv = new THREE.Vector2( u, 1 - v );\r\n\t\r\n\t\t\treturn vertex;\r\n\t\r\n\t\t}\r\n\t\r\n\t\r\n\t\t// Approximate a curved face with recursively sub-divided triangles.\r\n\t\r\n\t\tfunction make( v1, v2, v3, materialIndex ) {\r\n\t\r\n\t\t\tvar face = new THREE.Face3( v1.index, v2.index, v3.index, [ v1.clone(), v2.clone(), v3.clone() ], undefined, materialIndex );\r\n\t\t\tthat.faces.push( face );\r\n\t\r\n\t\t\tcentroid.copy( v1 ).add( v2 ).add( v3 ).divideScalar( 3 );\r\n\t\r\n\t\t\tvar azi = azimuth( centroid );\r\n\t\r\n\t\t\tthat.faceVertexUvs[ 0 ].push( [\r\n\t\t\t\tcorrectUV( v1.uv, v1, azi ),\r\n\t\t\t\tcorrectUV( v2.uv, v2, azi ),\r\n\t\t\t\tcorrectUV( v3.uv, v3, azi )\r\n\t\t\t] );\r\n\t\r\n\t\t}\r\n\t\r\n\t\r\n\t\t// Analytically subdivide a face to the required detail level.\r\n\t\r\n\t\tfunction subdivide( face, detail ) {\r\n\t\r\n\t\t\tvar cols = Math.pow( 2, detail );\r\n\t\t\tvar a = prepare( that.vertices[ face.a ] );\r\n\t\t\tvar b = prepare( that.vertices[ face.b ] );\r\n\t\t\tvar c = prepare( that.vertices[ face.c ] );\r\n\t\t\tvar v = [];\r\n\t\r\n\t\t\tvar materialIndex = face.materialIndex;\r\n\t\r\n\t\t\t// Construct all of the vertices for this subdivision.\r\n\t\r\n\t\t\tfor ( var i = 0 ; i <= cols; i ++ ) {\r\n\t\r\n\t\t\t\tv[ i ] = [];\r\n\t\r\n\t\t\t\tvar aj = prepare( a.clone().lerp( c, i / cols ) );\r\n\t\t\t\tvar bj = prepare( b.clone().lerp( c, i / cols ) );\r\n\t\t\t\tvar rows = cols - i;\r\n\t\r\n\t\t\t\tfor ( var j = 0; j <= rows; j ++ ) {\r\n\t\r\n\t\t\t\t\tif ( j === 0 && i === cols ) {\r\n\t\r\n\t\t\t\t\t\tv[ i ][ j ] = aj;\r\n\t\r\n\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\tv[ i ][ j ] = prepare( aj.clone().lerp( bj, j / rows ) );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\t// Construct all of the faces.\r\n\t\r\n\t\t\tfor ( var i = 0; i < cols ; i ++ ) {\r\n\t\r\n\t\t\t\tfor ( var j = 0; j < 2 * ( cols - i ) - 1; j ++ ) {\r\n\t\r\n\t\t\t\t\tvar k = Math.floor( j / 2 );\r\n\t\r\n\t\t\t\t\tif ( j % 2 === 0 ) {\r\n\t\r\n\t\t\t\t\t\tmake(\r\n\t\t\t\t\t\t\tv[ i ][ k + 1 ],\r\n\t\t\t\t\t\t\tv[ i + 1 ][ k ],\r\n\t\t\t\t\t\t\tv[ i ][ k ],\r\n\t\t\t\t\t\t\tmaterialIndex\r\n\t\t\t\t\t\t);\r\n\t\r\n\t\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\t\tmake(\r\n\t\t\t\t\t\t\tv[ i ][ k + 1 ],\r\n\t\t\t\t\t\t\tv[ i + 1 ][ k + 1 ],\r\n\t\t\t\t\t\t\tv[ i + 1 ][ k ],\r\n\t\t\t\t\t\t\tmaterialIndex\r\n\t\t\t\t\t\t);\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\r\n\t\t// Angle around the Y axis, counter-clockwise when looking from above.\r\n\t\r\n\t\tfunction azimuth( vector ) {\r\n\t\r\n\t\t\treturn Math.atan2( vector.z, - vector.x );\r\n\t\r\n\t\t}\r\n\t\r\n\t\r\n\t\t// Angle above the XZ plane.\r\n\t\r\n\t\tfunction inclination( vector ) {\r\n\t\r\n\t\t\treturn Math.atan2( - vector.y, Math.sqrt( ( vector.x * vector.x ) + ( vector.z * vector.z ) ) );\r\n\t\r\n\t\t}\r\n\t\r\n\t\r\n\t\t// Texture fixing helper. Spheres have some odd behaviours.\r\n\t\r\n\t\tfunction correctUV( uv, vector, azimuth ) {\r\n\t\r\n\t\t\tif ( ( azimuth < 0 ) && ( uv.x === 1 ) ) uv = new THREE.Vector2( uv.x - 1, uv.y );\r\n\t\t\tif ( ( vector.x === 0 ) && ( vector.z === 0 ) ) uv = new THREE.Vector2( azimuth / 2 / Math.PI + 0.5, uv.y );\r\n\t\t\treturn uv.clone();\r\n\t\r\n\t\t}\r\n\t\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.PolyhedronGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\n\tTHREE.PolyhedronGeometry.prototype.constructor = THREE.PolyhedronGeometry;\r\n\t\r\n\tTHREE.PolyhedronGeometry.prototype.clone = function () {\r\n\t\r\n\t\tvar parameters = this.parameters;\r\n\t\r\n\t\treturn new THREE.PolyhedronGeometry(\r\n\t\t\tparameters.vertices,\r\n\t\t\tparameters.indices,\r\n\t\t\tparameters.radius,\r\n\t\t\tparameters.detail\r\n\t\t);\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/extras/geometries/DodecahedronGeometry.js\r\n\t\r\n\t/**\r\n\t * @author Abe Pazos / https://hamoid.com\r\n\t */\r\n\t\r\n\tTHREE.DodecahedronGeometry = function ( radius, detail ) {\r\n\t\r\n\t\tvar t = ( 1 + Math.sqrt( 5 ) ) / 2;\r\n\t\tvar r = 1 / t;\r\n\t\r\n\t\tvar vertices = [\r\n\t\r\n\t\t\t// (1, 1, 1)\r\n\t\t\t- 1, - 1, - 1,    - 1, - 1,  1,\r\n\t\t\t- 1,  1, - 1,    - 1,  1,  1,\r\n\t\t\t 1, - 1, - 1,     1, - 1,  1,\r\n\t\t\t 1,  1, - 1,     1,  1,  1,\r\n\t\r\n\t\t\t// (0, 1/, )\r\n\t\t\t 0, - r, - t,     0, - r,  t,\r\n\t\t\t 0,  r, - t,     0,  r,  t,\r\n\t\r\n\t\t\t// (1/, , 0)\r\n\t\t\t- r, - t,  0,    - r,  t,  0,\r\n\t\t\t r, - t,  0,     r,  t,  0,\r\n\t\r\n\t\t\t// (, 0, 1/)\r\n\t\t\t- t,  0, - r,     t,  0, - r,\r\n\t\t\t- t,  0,  r,     t,  0,  r\r\n\t\t];\r\n\t\r\n\t\tvar indices = [\r\n\t\t\t 3, 11,  7,      3,  7, 15,      3, 15, 13,\r\n\t\t\t 7, 19, 17,      7, 17,  6,      7,  6, 15,\r\n\t\t\t17,  4,  8,     17,  8, 10,     17, 10,  6,\r\n\t\t\t 8,  0, 16,      8, 16,  2,      8,  2, 10,\r\n\t\t\t 0, 12,  1,      0,  1, 18,      0, 18, 16,\r\n\t\t\t 6, 10,  2,      6,  2, 13,      6, 13, 15,\r\n\t\t\t 2, 16, 18,      2, 18,  3,      2,  3, 13,\r\n\t\t\t18,  1,  9,     18,  9, 11,     18, 11,  3,\r\n\t\t\t 4, 14, 12,      4, 12,  0,      4,  0,  8,\r\n\t\t\t11,  9,  5,     11,  5, 19,     11, 19,  7,\r\n\t\t\t19,  5, 14,     19, 14,  4,     19,  4, 17,\r\n\t\t\t 1, 12, 14,      1, 14,  5,      1,  5,  9\r\n\t\t];\r\n\t\r\n\t\tTHREE.PolyhedronGeometry.call( this, vertices, indices, radius, detail );\r\n\t\r\n\t\tthis.type = 'DodecahedronGeometry';\r\n\t\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\tdetail: detail\r\n\t\t};\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.DodecahedronGeometry.prototype = Object.create( THREE.PolyhedronGeometry.prototype );\r\n\tTHREE.DodecahedronGeometry.prototype.constructor = THREE.DodecahedronGeometry;\r\n\t\r\n\tTHREE.DodecahedronGeometry.prototype.clone = function () {\r\n\t\r\n\t\tvar parameters = this.parameters;\r\n\t\r\n\t\treturn new THREE.DodecahedronGeometry(\r\n\t\t\tparameters.radius,\r\n\t\t\tparameters.detail\r\n\t\t);\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/extras/geometries/IcosahedronGeometry.js\r\n\t\r\n\t/**\r\n\t * @author timothypratley / https://github.com/timothypratley\r\n\t */\r\n\t\r\n\tTHREE.IcosahedronGeometry = function ( radius, detail ) {\r\n\t\r\n\t\tvar t = ( 1 + Math.sqrt( 5 ) ) / 2;\r\n\t\r\n\t\tvar vertices = [\r\n\t\t\t- 1,  t,  0,    1,  t,  0,   - 1, - t,  0,    1, - t,  0,\r\n\t\t\t 0, - 1,  t,    0,  1,  t,    0, - 1, - t,    0,  1, - t,\r\n\t\t\t t,  0, - 1,    t,  0,  1,   - t,  0, - 1,   - t,  0,  1\r\n\t\t];\r\n\t\r\n\t\tvar indices = [\r\n\t\t\t 0, 11,  5,    0,  5,  1,    0,  1,  7,    0,  7, 10,    0, 10, 11,\r\n\t\t\t 1,  5,  9,    5, 11,  4,   11, 10,  2,   10,  7,  6,    7,  1,  8,\r\n\t\t\t 3,  9,  4,    3,  4,  2,    3,  2,  6,    3,  6,  8,    3,  8,  9,\r\n\t\t\t 4,  9,  5,    2,  4, 11,    6,  2, 10,    8,  6,  7,    9,  8,  1\r\n\t\t];\r\n\t\r\n\t\tTHREE.PolyhedronGeometry.call( this, vertices, indices, radius, detail );\r\n\t\r\n\t\tthis.type = 'IcosahedronGeometry';\r\n\t\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\tdetail: detail\r\n\t\t};\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.IcosahedronGeometry.prototype = Object.create( THREE.PolyhedronGeometry.prototype );\r\n\tTHREE.IcosahedronGeometry.prototype.constructor = THREE.IcosahedronGeometry;\r\n\t\r\n\tTHREE.IcosahedronGeometry.prototype.clone = function () {\r\n\t\r\n\t\tvar parameters = this.parameters;\r\n\t\r\n\t\treturn new THREE.IcosahedronGeometry(\r\n\t\t\tparameters.radius,\r\n\t\t\tparameters.detail\r\n\t\t);\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/extras/geometries/OctahedronGeometry.js\r\n\t\r\n\t/**\r\n\t * @author timothypratley / https://github.com/timothypratley\r\n\t */\r\n\t\r\n\tTHREE.OctahedronGeometry = function ( radius, detail ) {\r\n\t\r\n\t\tvar vertices = [\r\n\t\t\t1, 0, 0,   - 1, 0, 0,    0, 1, 0,    0, - 1, 0,    0, 0, 1,    0, 0, - 1\r\n\t\t];\r\n\t\r\n\t\tvar indices = [\r\n\t\t\t0, 2, 4,    0, 4, 3,    0, 3, 5,    0, 5, 2,    1, 2, 5,    1, 5, 3,    1, 3, 4,    1, 4, 2\r\n\t\t];\r\n\t\r\n\t\tTHREE.PolyhedronGeometry.call( this, vertices, indices, radius, detail );\r\n\t\r\n\t\tthis.type = 'OctahedronGeometry';\r\n\t\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\tdetail: detail\r\n\t\t};\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.OctahedronGeometry.prototype = Object.create( THREE.PolyhedronGeometry.prototype );\r\n\tTHREE.OctahedronGeometry.prototype.constructor = THREE.OctahedronGeometry;\r\n\t\r\n\tTHREE.OctahedronGeometry.prototype.clone = function () {\r\n\t\r\n\t\tvar parameters = this.parameters;\r\n\t\r\n\t\treturn new THREE.OctahedronGeometry(\r\n\t\t\tparameters.radius,\r\n\t\t\tparameters.detail\r\n\t\t);\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/extras/geometries/TetrahedronGeometry.js\r\n\t\r\n\t/**\r\n\t * @author timothypratley / https://github.com/timothypratley\r\n\t */\r\n\t\r\n\tTHREE.TetrahedronGeometry = function ( radius, detail ) {\r\n\t\r\n\t\tvar vertices = [\r\n\t\t\t 1,  1,  1,   - 1, - 1,  1,   - 1,  1, - 1,    1, - 1, - 1\r\n\t\t];\r\n\t\r\n\t\tvar indices = [\r\n\t\t\t 2,  1,  0,    0,  3,  2,    1,  3,  0,    2,  3,  1\r\n\t\t];\r\n\t\r\n\t\tTHREE.PolyhedronGeometry.call( this, vertices, indices, radius, detail );\r\n\t\r\n\t\tthis.type = 'TetrahedronGeometry';\r\n\t\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\tdetail: detail\r\n\t\t};\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.TetrahedronGeometry.prototype = Object.create( THREE.PolyhedronGeometry.prototype );\r\n\tTHREE.TetrahedronGeometry.prototype.constructor = THREE.TetrahedronGeometry;\r\n\t\r\n\tTHREE.TetrahedronGeometry.prototype.clone = function () {\r\n\t\r\n\t\tvar parameters = this.parameters;\r\n\t\r\n\t\treturn new THREE.TetrahedronGeometry(\r\n\t\t\tparameters.radius,\r\n\t\t\tparameters.detail\r\n\t\t);\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/extras/geometries/ParametricGeometry.js\r\n\t\r\n\t/**\r\n\t * @author zz85 / https://github.com/zz85\r\n\t * Parametric Surfaces Geometry\r\n\t * based on the brilliant article by @prideout http://prideout.net/blog/?p=44\r\n\t *\r\n\t * new THREE.ParametricGeometry( parametricFunction, uSegments, ySegements );\r\n\t *\r\n\t */\r\n\t\r\n\tTHREE.ParametricGeometry = function ( func, slices, stacks ) {\r\n\t\r\n\t\tTHREE.Geometry.call( this );\r\n\t\r\n\t\tthis.type = 'ParametricGeometry';\r\n\t\r\n\t\tthis.parameters = {\r\n\t\t\tfunc: func,\r\n\t\t\tslices: slices,\r\n\t\t\tstacks: stacks\r\n\t\t};\r\n\t\r\n\t\tvar verts = this.vertices;\r\n\t\tvar faces = this.faces;\r\n\t\tvar uvs = this.faceVertexUvs[ 0 ];\r\n\t\r\n\t\tvar i, j, p;\r\n\t\tvar u, v;\r\n\t\r\n\t\tvar sliceCount = slices + 1;\r\n\t\r\n\t\tfor ( i = 0; i <= stacks; i ++ ) {\r\n\t\r\n\t\t\tv = i / stacks;\r\n\t\r\n\t\t\tfor ( j = 0; j <= slices; j ++ ) {\r\n\t\r\n\t\t\t\tu = j / slices;\r\n\t\r\n\t\t\t\tp = func( u, v );\r\n\t\t\t\tverts.push( p );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tvar a, b, c, d;\r\n\t\tvar uva, uvb, uvc, uvd;\r\n\t\r\n\t\tfor ( i = 0; i < stacks; i ++ ) {\r\n\t\r\n\t\t\tfor ( j = 0; j < slices; j ++ ) {\r\n\t\r\n\t\t\t\ta = i * sliceCount + j;\r\n\t\t\t\tb = i * sliceCount + j + 1;\r\n\t\t\t\tc = ( i + 1 ) * sliceCount + j + 1;\r\n\t\t\t\td = ( i + 1 ) * sliceCount + j;\r\n\t\r\n\t\t\t\tuva = new THREE.Vector2( j / slices, i / stacks );\r\n\t\t\t\tuvb = new THREE.Vector2( ( j + 1 ) / slices, i / stacks );\r\n\t\t\t\tuvc = new THREE.Vector2( ( j + 1 ) / slices, ( i + 1 ) / stacks );\r\n\t\t\t\tuvd = new THREE.Vector2( j / slices, ( i + 1 ) / stacks );\r\n\t\r\n\t\t\t\tfaces.push( new THREE.Face3( a, b, d ) );\r\n\t\t\t\tuvs.push( [ uva, uvb, uvd ] );\r\n\t\r\n\t\t\t\tfaces.push( new THREE.Face3( b, c, d ) );\r\n\t\t\t\tuvs.push( [ uvb.clone(), uvc, uvd.clone() ] );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\t// console.log(this);\r\n\t\r\n\t\t// magic bullet\r\n\t\t// var diff = this.mergeVertices();\r\n\t\t// console.log('removed ', diff, ' vertices by merging');\r\n\t\r\n\t\tthis.computeFaceNormals();\r\n\t\tthis.computeVertexNormals();\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.ParametricGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\n\tTHREE.ParametricGeometry.prototype.constructor = THREE.ParametricGeometry;\r\n\t\r\n\t// File:src/extras/geometries/WireframeGeometry.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.WireframeGeometry = function ( geometry ) {\r\n\t\r\n\t\tTHREE.BufferGeometry.call( this );\r\n\t\r\n\t\tvar edge = [ 0, 0 ], hash = {};\r\n\t\r\n\t\tfunction sortFunction( a, b ) {\r\n\t\r\n\t\t\treturn a - b;\r\n\t\r\n\t\t}\r\n\t\r\n\t\tvar keys = [ 'a', 'b', 'c' ];\r\n\t\r\n\t\tif ( geometry instanceof THREE.Geometry ) {\r\n\t\r\n\t\t\tvar vertices = geometry.vertices;\r\n\t\t\tvar faces = geometry.faces;\r\n\t\t\tvar numEdges = 0;\r\n\t\r\n\t\t\t// allocate maximal size\r\n\t\t\tvar edges = new Uint32Array( 6 * faces.length );\r\n\t\r\n\t\t\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\tvar face = faces[ i ];\r\n\t\r\n\t\t\t\tfor ( var j = 0; j < 3; j ++ ) {\r\n\t\r\n\t\t\t\t\tedge[ 0 ] = face[ keys[ j ] ];\r\n\t\t\t\t\tedge[ 1 ] = face[ keys[ ( j + 1 ) % 3 ] ];\r\n\t\t\t\t\tedge.sort( sortFunction );\r\n\t\r\n\t\t\t\t\tvar key = edge.toString();\r\n\t\r\n\t\t\t\t\tif ( hash[ key ] === undefined ) {\r\n\t\r\n\t\t\t\t\t\tedges[ 2 * numEdges ] = edge[ 0 ];\r\n\t\t\t\t\t\tedges[ 2 * numEdges + 1 ] = edge[ 1 ];\r\n\t\t\t\t\t\thash[ key ] = true;\r\n\t\t\t\t\t\tnumEdges ++;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar coords = new Float32Array( numEdges * 2 * 3 );\r\n\t\r\n\t\t\tfor ( var i = 0, l = numEdges; i < l; i ++ ) {\r\n\t\r\n\t\t\t\tfor ( var j = 0; j < 2; j ++ ) {\r\n\t\r\n\t\t\t\t\tvar vertex = vertices[ edges [ 2 * i + j ] ];\r\n\t\r\n\t\t\t\t\tvar index = 6 * i + 3 * j;\r\n\t\t\t\t\tcoords[ index + 0 ] = vertex.x;\r\n\t\t\t\t\tcoords[ index + 1 ] = vertex.y;\r\n\t\t\t\t\tcoords[ index + 2 ] = vertex.z;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tthis.addAttribute( 'position', new THREE.BufferAttribute( coords, 3 ) );\r\n\t\r\n\t\t} else if ( geometry instanceof THREE.BufferGeometry ) {\r\n\t\r\n\t\t\tif ( geometry.index !== null ) {\r\n\t\r\n\t\t\t\t// Indexed BufferGeometry\r\n\t\r\n\t\t\t\tvar indices = geometry.index.array;\r\n\t\t\t\tvar vertices = geometry.attributes.position;\r\n\t\t\t\tvar drawcalls = geometry.drawcalls;\r\n\t\t\t\tvar numEdges = 0;\r\n\t\r\n\t\t\t\tif ( drawcalls.length === 0 ) {\r\n\t\r\n\t\t\t\t\tgeometry.addGroup( 0, indices.length );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\t// allocate maximal size\r\n\t\t\t\tvar edges = new Uint32Array( 2 * indices.length );\r\n\t\r\n\t\t\t\tfor ( var o = 0, ol = drawcalls.length; o < ol; ++ o ) {\r\n\t\r\n\t\t\t\t\tvar drawcall = drawcalls[ o ];\r\n\t\r\n\t\t\t\t\tvar start = drawcall.start;\r\n\t\t\t\t\tvar count = drawcall.count;\r\n\t\r\n\t\t\t\t\tfor ( var i = start, il = start + count; i < il; i += 3 ) {\r\n\t\r\n\t\t\t\t\t\tfor ( var j = 0; j < 3; j ++ ) {\r\n\t\r\n\t\t\t\t\t\t\tedge[ 0 ] = indices[ i + j ];\r\n\t\t\t\t\t\t\tedge[ 1 ] = indices[ i + ( j + 1 ) % 3 ];\r\n\t\t\t\t\t\t\tedge.sort( sortFunction );\r\n\t\r\n\t\t\t\t\t\t\tvar key = edge.toString();\r\n\t\r\n\t\t\t\t\t\t\tif ( hash[ key ] === undefined ) {\r\n\t\r\n\t\t\t\t\t\t\t\tedges[ 2 * numEdges ] = edge[ 0 ];\r\n\t\t\t\t\t\t\t\tedges[ 2 * numEdges + 1 ] = edge[ 1 ];\r\n\t\t\t\t\t\t\t\thash[ key ] = true;\r\n\t\t\t\t\t\t\t\tnumEdges ++;\r\n\t\r\n\t\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tvar coords = new Float32Array( numEdges * 2 * 3 );\r\n\t\r\n\t\t\t\tfor ( var i = 0, l = numEdges; i < l; i ++ ) {\r\n\t\r\n\t\t\t\t\tfor ( var j = 0; j < 2; j ++ ) {\r\n\t\r\n\t\t\t\t\t\tvar index = 6 * i + 3 * j;\r\n\t\t\t\t\t\tvar index2 = edges[ 2 * i + j ];\r\n\t\r\n\t\t\t\t\t\tcoords[ index + 0 ] = vertices.getX( index2 );\r\n\t\t\t\t\t\tcoords[ index + 1 ] = vertices.getY( index2 );\r\n\t\t\t\t\t\tcoords[ index + 2 ] = vertices.getZ( index2 );\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tthis.addAttribute( 'position', new THREE.BufferAttribute( coords, 3 ) );\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\t// non-indexed BufferGeometry\r\n\t\r\n\t\t\t\tvar vertices = geometry.attributes.position.array;\r\n\t\t\t\tvar numEdges = vertices.length / 3;\r\n\t\t\t\tvar numTris = numEdges / 3;\r\n\t\r\n\t\t\t\tvar coords = new Float32Array( numEdges * 2 * 3 );\r\n\t\r\n\t\t\t\tfor ( var i = 0, l = numTris; i < l; i ++ ) {\r\n\t\r\n\t\t\t\t\tfor ( var j = 0; j < 3; j ++ ) {\r\n\t\r\n\t\t\t\t\t\tvar index = 18 * i + 6 * j;\r\n\t\r\n\t\t\t\t\t\tvar index1 = 9 * i + 3 * j;\r\n\t\t\t\t\t\tcoords[ index + 0 ] = vertices[ index1 ];\r\n\t\t\t\t\t\tcoords[ index + 1 ] = vertices[ index1 + 1 ];\r\n\t\t\t\t\t\tcoords[ index + 2 ] = vertices[ index1 + 2 ];\r\n\t\r\n\t\t\t\t\t\tvar index2 = 9 * i + 3 * ( ( j + 1 ) % 3 );\r\n\t\t\t\t\t\tcoords[ index + 3 ] = vertices[ index2 ];\r\n\t\t\t\t\t\tcoords[ index + 4 ] = vertices[ index2 + 1 ];\r\n\t\t\t\t\t\tcoords[ index + 5 ] = vertices[ index2 + 2 ];\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tthis.addAttribute( 'position', new THREE.BufferAttribute( coords, 3 ) );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.WireframeGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\r\n\tTHREE.WireframeGeometry.prototype.constructor = THREE.WireframeGeometry;\r\n\t\r\n\t// File:src/extras/helpers/AxisHelper.js\r\n\t\r\n\t/**\r\n\t * @author sroucheray / http://sroucheray.org/\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.AxisHelper = function ( size ) {\r\n\t\r\n\t\tsize = size || 1;\r\n\t\r\n\t\tvar vertices = new Float32Array( [\r\n\t\t\t0, 0, 0,  size, 0, 0,\r\n\t\t\t0, 0, 0,  0, size, 0,\r\n\t\t\t0, 0, 0,  0, 0, size\r\n\t\t] );\r\n\t\r\n\t\tvar colors = new Float32Array( [\r\n\t\t\t1, 0, 0,  1, 0.6, 0,\r\n\t\t\t0, 1, 0,  0.6, 1, 0,\r\n\t\t\t0, 0, 1,  0, 0.6, 1\r\n\t\t] );\r\n\t\r\n\t\tvar geometry = new THREE.BufferGeometry();\r\n\t\tgeometry.addAttribute( 'position', new THREE.BufferAttribute( vertices, 3 ) );\r\n\t\tgeometry.addAttribute( 'color', new THREE.BufferAttribute( colors, 3 ) );\r\n\t\r\n\t\tvar material = new THREE.LineBasicMaterial( { vertexColors: THREE.VertexColors } );\r\n\t\r\n\t\tTHREE.LineSegments.call( this, geometry, material );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.AxisHelper.prototype = Object.create( THREE.LineSegments.prototype );\r\n\tTHREE.AxisHelper.prototype.constructor = THREE.AxisHelper;\r\n\t\r\n\t// File:src/extras/helpers/ArrowHelper.js\r\n\t\r\n\t/**\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t * @author zz85 / http://github.com/zz85\r\n\t * @author bhouston / http://clara.io\r\n\t *\r\n\t * Creates an arrow for visualizing directions\r\n\t *\r\n\t * Parameters:\r\n\t *  dir - Vector3\r\n\t *  origin - Vector3\r\n\t *  length - Number\r\n\t *  color - color in hex value\r\n\t *  headLength - Number\r\n\t *  headWidth - Number\r\n\t */\r\n\t\r\n\tTHREE.ArrowHelper = ( function () {\r\n\t\r\n\t\tvar lineGeometry = new THREE.Geometry();\r\n\t\tlineGeometry.vertices.push( new THREE.Vector3( 0, 0, 0 ), new THREE.Vector3( 0, 1, 0 ) );\r\n\t\r\n\t\tvar coneGeometry = new THREE.CylinderGeometry( 0, 0.5, 1, 5, 1 );\r\n\t\tconeGeometry.translate( 0, - 0.5, 0 );\r\n\t\r\n\t\treturn function ArrowHelper( dir, origin, length, color, headLength, headWidth ) {\r\n\t\r\n\t\t\t// dir is assumed to be normalized\r\n\t\r\n\t\t\tTHREE.Object3D.call( this );\r\n\t\r\n\t\t\tif ( color === undefined ) color = 0xffff00;\r\n\t\t\tif ( length === undefined ) length = 1;\r\n\t\t\tif ( headLength === undefined ) headLength = 0.2 * length;\r\n\t\t\tif ( headWidth === undefined ) headWidth = 0.2 * headLength;\r\n\t\r\n\t\t\tthis.position.copy( origin );\r\n\t\t\t\r\n\t\t\tif ( headLength < length ) {\r\n\t\t\t\tthis.line = new THREE.Line( lineGeometry, new THREE.LineBasicMaterial( { color: color } ) );\r\n\t\t\t\tthis.line.matrixAutoUpdate = false;\r\n\t\t\t\tthis.add( this.line );\r\n\t\t\t}\r\n\t\r\n\t\t\tthis.cone = new THREE.Mesh( coneGeometry, new THREE.MeshBasicMaterial( { color: color } ) );\r\n\t\t\tthis.cone.matrixAutoUpdate = false;\r\n\t\t\tthis.add( this.cone );\r\n\t\r\n\t\t\tthis.setDirection( dir );\r\n\t\t\tthis.setLength( length, headLength, headWidth );\r\n\t\r\n\t\t}\r\n\t\r\n\t}() );\r\n\t\r\n\tTHREE.ArrowHelper.prototype = Object.create( THREE.Object3D.prototype );\r\n\tTHREE.ArrowHelper.prototype.constructor = THREE.ArrowHelper;\r\n\t\r\n\tTHREE.ArrowHelper.prototype.setDirection = ( function () {\r\n\t\r\n\t\tvar axis = new THREE.Vector3();\r\n\t\tvar radians;\r\n\t\r\n\t\treturn function setDirection( dir ) {\r\n\t\r\n\t\t\t// dir is assumed to be normalized\r\n\t\r\n\t\t\tif ( dir.y > 0.99999 ) {\r\n\t\r\n\t\t\t\tthis.quaternion.set( 0, 0, 0, 1 );\r\n\t\r\n\t\t\t} else if ( dir.y < - 0.99999 ) {\r\n\t\r\n\t\t\t\tthis.quaternion.set( 1, 0, 0, 0 );\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\taxis.set( dir.z, 0, - dir.x ).normalize();\r\n\t\r\n\t\t\t\tradians = Math.acos( dir.y );\r\n\t\r\n\t\t\t\tthis.quaternion.setFromAxisAngle( axis, radians );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t};\r\n\t\r\n\t}() );\r\n\t\r\n\tTHREE.ArrowHelper.prototype.setLength = function ( length, headLength, headWidth ) {\r\n\t\r\n\t\tif ( headLength === undefined ) headLength = 0.2 * length;\r\n\t\tif ( headWidth === undefined ) headWidth = 0.2 * headLength;\r\n\t\r\n\t\tif ( headLength < length ){\r\n\t\t\tthis.line.scale.set( 1, length - headLength, 1 );\r\n\t\t\tthis.line.updateMatrix();\r\n\t\t}\r\n\t\r\n\t\tthis.cone.scale.set( headWidth, headLength, headWidth );\r\n\t\tthis.cone.position.y = length;\r\n\t\tthis.cone.updateMatrix();\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.ArrowHelper.prototype.setColor = function ( color ) {\r\n\t\r\n\t\tif ( this.line !== undefined ) this.line.material.color.set( color );\r\n\t\tthis.cone.material.color.set( color );\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/extras/helpers/BoxHelper.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.BoxHelper = function ( object ) {\r\n\t\r\n\t\tvar indices = new Uint16Array( [ 0, 1, 1, 2, 2, 3, 3, 0, 4, 5, 5, 6, 6, 7, 7, 4, 0, 4, 1, 5, 2, 6, 3, 7 ] );\r\n\t\tvar positions = new Float32Array( 8 * 3 );\r\n\t\r\n\t\tvar geometry = new THREE.BufferGeometry();\r\n\t\tgeometry.setIndex( new THREE.BufferAttribute( indices, 1 ) );\r\n\t\tgeometry.addAttribute( 'position', new THREE.BufferAttribute( positions, 3 ) );\r\n\t\r\n\t\tTHREE.LineSegments.call( this, geometry, new THREE.LineBasicMaterial( { color: 0xffff00 } ) );\r\n\t\r\n\t\tif ( object !== undefined ) {\r\n\t\r\n\t\t\tthis.update( object );\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.BoxHelper.prototype = Object.create( THREE.LineSegments.prototype );\r\n\tTHREE.BoxHelper.prototype.constructor = THREE.BoxHelper;\r\n\t\r\n\tTHREE.BoxHelper.prototype.update = ( function () {\r\n\t\r\n\t\tvar box = new THREE.Box3();\r\n\t\r\n\t\treturn function ( object ) {\r\n\t\r\n\t\t\tbox.setFromObject( object );\r\n\t\r\n\t\t\tif ( box.empty() ) return;\r\n\t\r\n\t\t\tvar min = box.min;\r\n\t\t\tvar max = box.max;\r\n\t\r\n\t\t\t/*\r\n\t\t\t  5____4\r\n\t\t\t1/___0/|\r\n\t\t\t| 6__|_7\r\n\t\t\t2/___3/\r\n\t\r\n\t\t\t0: max.x, max.y, max.z\r\n\t\t\t1: min.x, max.y, max.z\r\n\t\t\t2: min.x, min.y, max.z\r\n\t\t\t3: max.x, min.y, max.z\r\n\t\t\t4: max.x, max.y, min.z\r\n\t\t\t5: min.x, max.y, min.z\r\n\t\t\t6: min.x, min.y, min.z\r\n\t\t\t7: max.x, min.y, min.z\r\n\t\t\t*/\r\n\t\r\n\t\t\tvar position = this.geometry.attributes.position;\r\n\t\t\tvar array = position.array;\r\n\t\r\n\t\t\tarray[  0 ] = max.x; array[  1 ] = max.y; array[  2 ] = max.z;\r\n\t\t\tarray[  3 ] = min.x; array[  4 ] = max.y; array[  5 ] = max.z;\r\n\t\t\tarray[  6 ] = min.x; array[  7 ] = min.y; array[  8 ] = max.z;\r\n\t\t\tarray[  9 ] = max.x; array[ 10 ] = min.y; array[ 11 ] = max.z;\r\n\t\t\tarray[ 12 ] = max.x; array[ 13 ] = max.y; array[ 14 ] = min.z;\r\n\t\t\tarray[ 15 ] = min.x; array[ 16 ] = max.y; array[ 17 ] = min.z;\r\n\t\t\tarray[ 18 ] = min.x; array[ 19 ] = min.y; array[ 20 ] = min.z;\r\n\t\t\tarray[ 21 ] = max.x; array[ 22 ] = min.y; array[ 23 ] = min.z;\r\n\t\r\n\t\t\tposition.needsUpdate = true;\r\n\t\r\n\t\t\tthis.geometry.computeBoundingSphere();\r\n\t\r\n\t\t}\r\n\t\r\n\t} )();\r\n\t\r\n\t// File:src/extras/helpers/BoundingBoxHelper.js\r\n\t\r\n\t/**\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t */\r\n\t\r\n\t// a helper to show the world-axis-aligned bounding box for an object\r\n\t\r\n\tTHREE.BoundingBoxHelper = function ( object, hex ) {\r\n\t\r\n\t\tvar color = ( hex !== undefined ) ? hex : 0x888888;\r\n\t\r\n\t\tthis.object = object;\r\n\t\r\n\t\tthis.box = new THREE.Box3();\r\n\t\r\n\t\tTHREE.Mesh.call( this, new THREE.BoxGeometry( 1, 1, 1 ), new THREE.MeshBasicMaterial( { color: color, wireframe: true } ) );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.BoundingBoxHelper.prototype = Object.create( THREE.Mesh.prototype );\r\n\tTHREE.BoundingBoxHelper.prototype.constructor = THREE.BoundingBoxHelper;\r\n\t\r\n\tTHREE.BoundingBoxHelper.prototype.update = function () {\r\n\t\r\n\t\tthis.box.setFromObject( this.object );\r\n\t\r\n\t\tthis.box.size( this.scale );\r\n\t\r\n\t\tthis.box.center( this.position );\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/extras/helpers/CameraHelper.js\r\n\t\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t *\r\n\t *\t- shows frustum, line of sight and up of the camera\r\n\t *\t- suitable for fast updates\r\n\t * \t- based on frustum visualization in lightgl.js shadowmap example\r\n\t *\t\thttp://evanw.github.com/lightgl.js/tests/shadowmap.html\r\n\t */\r\n\t\r\n\tTHREE.CameraHelper = function ( camera ) {\r\n\t\r\n\t\tvar geometry = new THREE.Geometry();\r\n\t\tvar material = new THREE.LineBasicMaterial( { color: 0xffffff, vertexColors: THREE.FaceColors } );\r\n\t\r\n\t\tvar pointMap = {};\r\n\t\r\n\t\t// colors\r\n\t\r\n\t\tvar hexFrustum = 0xffaa00;\r\n\t\tvar hexCone = 0xff0000;\r\n\t\tvar hexUp = 0x00aaff;\r\n\t\tvar hexTarget = 0xffffff;\r\n\t\tvar hexCross = 0x333333;\r\n\t\r\n\t\t// near\r\n\t\r\n\t\taddLine( \"n1\", \"n2\", hexFrustum );\r\n\t\taddLine( \"n2\", \"n4\", hexFrustum );\r\n\t\taddLine( \"n4\", \"n3\", hexFrustum );\r\n\t\taddLine( \"n3\", \"n1\", hexFrustum );\r\n\t\r\n\t\t// far\r\n\t\r\n\t\taddLine( \"f1\", \"f2\", hexFrustum );\r\n\t\taddLine( \"f2\", \"f4\", hexFrustum );\r\n\t\taddLine( \"f4\", \"f3\", hexFrustum );\r\n\t\taddLine( \"f3\", \"f1\", hexFrustum );\r\n\t\r\n\t\t// sides\r\n\t\r\n\t\taddLine( \"n1\", \"f1\", hexFrustum );\r\n\t\taddLine( \"n2\", \"f2\", hexFrustum );\r\n\t\taddLine( \"n3\", \"f3\", hexFrustum );\r\n\t\taddLine( \"n4\", \"f4\", hexFrustum );\r\n\t\r\n\t\t// cone\r\n\t\r\n\t\taddLine( \"p\", \"n1\", hexCone );\r\n\t\taddLine( \"p\", \"n2\", hexCone );\r\n\t\taddLine( \"p\", \"n3\", hexCone );\r\n\t\taddLine( \"p\", \"n4\", hexCone );\r\n\t\r\n\t\t// up\r\n\t\r\n\t\taddLine( \"u1\", \"u2\", hexUp );\r\n\t\taddLine( \"u2\", \"u3\", hexUp );\r\n\t\taddLine( \"u3\", \"u1\", hexUp );\r\n\t\r\n\t\t// target\r\n\t\r\n\t\taddLine( \"c\", \"t\", hexTarget );\r\n\t\taddLine( \"p\", \"c\", hexCross );\r\n\t\r\n\t\t// cross\r\n\t\r\n\t\taddLine( \"cn1\", \"cn2\", hexCross );\r\n\t\taddLine( \"cn3\", \"cn4\", hexCross );\r\n\t\r\n\t\taddLine( \"cf1\", \"cf2\", hexCross );\r\n\t\taddLine( \"cf3\", \"cf4\", hexCross );\r\n\t\r\n\t\tfunction addLine( a, b, hex ) {\r\n\t\r\n\t\t\taddPoint( a, hex );\r\n\t\t\taddPoint( b, hex );\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfunction addPoint( id, hex ) {\r\n\t\r\n\t\t\tgeometry.vertices.push( new THREE.Vector3() );\r\n\t\t\tgeometry.colors.push( new THREE.Color( hex ) );\r\n\t\r\n\t\t\tif ( pointMap[ id ] === undefined ) {\r\n\t\r\n\t\t\t\tpointMap[ id ] = [];\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tpointMap[ id ].push( geometry.vertices.length - 1 );\r\n\t\r\n\t\t}\r\n\t\r\n\t\tTHREE.LineSegments.call( this, geometry, material );\r\n\t\r\n\t\tthis.camera = camera;\r\n\t\tthis.camera.updateProjectionMatrix();\r\n\t\r\n\t\tthis.matrix = camera.matrixWorld;\r\n\t\tthis.matrixAutoUpdate = false;\r\n\t\r\n\t\tthis.pointMap = pointMap;\r\n\t\r\n\t\tthis.update();\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.CameraHelper.prototype = Object.create( THREE.LineSegments.prototype );\r\n\tTHREE.CameraHelper.prototype.constructor = THREE.CameraHelper;\r\n\t\r\n\tTHREE.CameraHelper.prototype.update = function () {\r\n\t\r\n\t\tvar geometry, pointMap;\r\n\t\r\n\t\tvar vector = new THREE.Vector3();\r\n\t\tvar camera = new THREE.Camera();\r\n\t\r\n\t\tfunction setPoint( point, x, y, z ) {\r\n\t\r\n\t\t\tvector.set( x, y, z ).unproject( camera );\r\n\t\r\n\t\t\tvar points = pointMap[ point ];\r\n\t\r\n\t\t\tif ( points !== undefined ) {\r\n\t\r\n\t\t\t\tfor ( var i = 0, il = points.length; i < il; i ++ ) {\r\n\t\r\n\t\t\t\t\tgeometry.vertices[ points[ i ] ].copy( vector );\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\treturn function () {\r\n\t\r\n\t\t\tgeometry = this.geometry;\r\n\t\t\tpointMap = this.pointMap;\r\n\t\r\n\t\t\tvar w = 1, h = 1;\r\n\t\r\n\t\t\t// we need just camera projection matrix\r\n\t\t\t// world matrix must be identity\r\n\t\r\n\t\t\tcamera.projectionMatrix.copy( this.camera.projectionMatrix );\r\n\t\r\n\t\t\t// center / target\r\n\t\r\n\t\t\tsetPoint( \"c\", 0, 0, - 1 );\r\n\t\t\tsetPoint( \"t\", 0, 0,  1 );\r\n\t\r\n\t\t\t// near\r\n\t\r\n\t\t\tsetPoint( \"n1\", - w, - h, - 1 );\r\n\t\t\tsetPoint( \"n2\",   w, - h, - 1 );\r\n\t\t\tsetPoint( \"n3\", - w,   h, - 1 );\r\n\t\t\tsetPoint( \"n4\",   w,   h, - 1 );\r\n\t\r\n\t\t\t// far\r\n\t\r\n\t\t\tsetPoint( \"f1\", - w, - h, 1 );\r\n\t\t\tsetPoint( \"f2\",   w, - h, 1 );\r\n\t\t\tsetPoint( \"f3\", - w,   h, 1 );\r\n\t\t\tsetPoint( \"f4\",   w,   h, 1 );\r\n\t\r\n\t\t\t// up\r\n\t\r\n\t\t\tsetPoint( \"u1\",   w * 0.7, h * 1.1, - 1 );\r\n\t\t\tsetPoint( \"u2\", - w * 0.7, h * 1.1, - 1 );\r\n\t\t\tsetPoint( \"u3\",         0, h * 2,   - 1 );\r\n\t\r\n\t\t\t// cross\r\n\t\r\n\t\t\tsetPoint( \"cf1\", - w,   0, 1 );\r\n\t\t\tsetPoint( \"cf2\",   w,   0, 1 );\r\n\t\t\tsetPoint( \"cf3\",   0, - h, 1 );\r\n\t\t\tsetPoint( \"cf4\",   0,   h, 1 );\r\n\t\r\n\t\t\tsetPoint( \"cn1\", - w,   0, - 1 );\r\n\t\t\tsetPoint( \"cn2\",   w,   0, - 1 );\r\n\t\t\tsetPoint( \"cn3\",   0, - h, - 1 );\r\n\t\t\tsetPoint( \"cn4\",   0,   h, - 1 );\r\n\t\r\n\t\t\tgeometry.verticesNeedUpdate = true;\r\n\t\r\n\t\t};\r\n\t\r\n\t}();\r\n\t\r\n\t// File:src/extras/helpers/DirectionalLightHelper.js\r\n\t\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t */\r\n\t\r\n\tTHREE.DirectionalLightHelper = function ( light, size ) {\r\n\t\r\n\t\tTHREE.Object3D.call( this );\r\n\t\r\n\t\tthis.light = light;\r\n\t\tthis.light.updateMatrixWorld();\r\n\t\r\n\t\tthis.matrix = light.matrixWorld;\r\n\t\tthis.matrixAutoUpdate = false;\r\n\t\r\n\t\tsize = size || 1;\r\n\t\r\n\t\tvar geometry = new THREE.Geometry();\r\n\t\tgeometry.vertices.push(\r\n\t\t\tnew THREE.Vector3( - size,   size, 0 ),\r\n\t\t\tnew THREE.Vector3(   size,   size, 0 ),\r\n\t\t\tnew THREE.Vector3(   size, - size, 0 ),\r\n\t\t\tnew THREE.Vector3( - size, - size, 0 ),\r\n\t\t\tnew THREE.Vector3( - size,   size, 0 )\r\n\t\t);\r\n\t\r\n\t\tvar material = new THREE.LineBasicMaterial( { fog: false } );\r\n\t\tmaterial.color.copy( this.light.color ).multiplyScalar( this.light.intensity );\r\n\t\r\n\t\tthis.lightPlane = new THREE.Line( geometry, material );\r\n\t\tthis.add( this.lightPlane );\r\n\t\r\n\t\tgeometry = new THREE.Geometry();\r\n\t\tgeometry.vertices.push(\r\n\t\t\tnew THREE.Vector3(),\r\n\t\t\tnew THREE.Vector3()\r\n\t\t);\r\n\t\r\n\t\tmaterial = new THREE.LineBasicMaterial( { fog: false } );\r\n\t\tmaterial.color.copy( this.light.color ).multiplyScalar( this.light.intensity );\r\n\t\r\n\t\tthis.targetLine = new THREE.Line( geometry, material );\r\n\t\tthis.add( this.targetLine );\r\n\t\r\n\t\tthis.update();\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.DirectionalLightHelper.prototype = Object.create( THREE.Object3D.prototype );\r\n\tTHREE.DirectionalLightHelper.prototype.constructor = THREE.DirectionalLightHelper;\r\n\t\r\n\tTHREE.DirectionalLightHelper.prototype.dispose = function () {\r\n\t\r\n\t\tthis.lightPlane.geometry.dispose();\r\n\t\tthis.lightPlane.material.dispose();\r\n\t\tthis.targetLine.geometry.dispose();\r\n\t\tthis.targetLine.material.dispose();\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.DirectionalLightHelper.prototype.update = function () {\r\n\t\r\n\t\tvar v1 = new THREE.Vector3();\r\n\t\tvar v2 = new THREE.Vector3();\r\n\t\tvar v3 = new THREE.Vector3();\r\n\t\r\n\t\treturn function () {\r\n\t\r\n\t\t\tv1.setFromMatrixPosition( this.light.matrixWorld );\r\n\t\t\tv2.setFromMatrixPosition( this.light.target.matrixWorld );\r\n\t\t\tv3.subVectors( v2, v1 );\r\n\t\r\n\t\t\tthis.lightPlane.lookAt( v3 );\r\n\t\t\tthis.lightPlane.material.color.copy( this.light.color ).multiplyScalar( this.light.intensity );\r\n\t\r\n\t\t\tthis.targetLine.geometry.vertices[ 1 ].copy( v3 );\r\n\t\t\tthis.targetLine.geometry.verticesNeedUpdate = true;\r\n\t\t\tthis.targetLine.material.color.copy( this.lightPlane.material.color );\r\n\t\r\n\t\t};\r\n\t\r\n\t}();\r\n\t\r\n\t// File:src/extras/helpers/EdgesHelper.js\r\n\t\r\n\t/**\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t * @param object THREE.Mesh whose geometry will be used\r\n\t * @param hex line color\r\n\t * @param thresholdAngle the minimum angle (in degrees),\r\n\t * between the face normals of adjacent faces,\r\n\t * that is required to render an edge. A value of 10 means\r\n\t * an edge is only rendered if the angle is at least 10 degrees.\r\n\t */\r\n\t\r\n\tTHREE.EdgesHelper = function ( object, hex, thresholdAngle ) {\r\n\t\r\n\t\tvar color = ( hex !== undefined ) ? hex : 0xffffff;\r\n\t\r\n\t\tTHREE.LineSegments.call( this, new THREE.EdgesGeometry( object.geometry, thresholdAngle ), new THREE.LineBasicMaterial( { color: color } ) );\r\n\t\r\n\t\tthis.matrix = object.matrixWorld;\r\n\t\tthis.matrixAutoUpdate = false;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.EdgesHelper.prototype = Object.create( THREE.LineSegments.prototype );\r\n\tTHREE.EdgesHelper.prototype.constructor = THREE.EdgesHelper;\r\n\t\r\n\t// File:src/extras/helpers/FaceNormalsHelper.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t*/\r\n\t\r\n\tTHREE.FaceNormalsHelper = function ( object, size, hex, linewidth ) {\r\n\t\r\n\t\t// FaceNormalsHelper only supports THREE.Geometry\r\n\t\r\n\t\tthis.object = object;\r\n\t\r\n\t\tthis.size = ( size !== undefined ) ? size : 1;\r\n\t\r\n\t\tvar color = ( hex !== undefined ) ? hex : 0xffff00;\r\n\t\r\n\t\tvar width = ( linewidth !== undefined ) ? linewidth : 1;\r\n\t\r\n\t\t//\r\n\t\r\n\t\tvar nNormals = 0;\r\n\t\r\n\t\tvar objGeometry = this.object.geometry;\r\n\t\r\n\t\tif ( objGeometry instanceof THREE.Geometry ) {\r\n\t\r\n\t\t\tnNormals = objGeometry.faces.length;\r\n\t\r\n\t\t} else {\r\n\t\r\n\t\t\tconsole.warn( 'THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.' );\r\n\t\r\n\t\t}\r\n\t\r\n\t\t//\r\n\t\r\n\t\tvar geometry = new THREE.BufferGeometry();\r\n\t\r\n\t\tvar positions = new THREE.Float32Attribute( nNormals * 2 * 3, 3 );\r\n\t\r\n\t\tgeometry.addAttribute( 'position', positions );\r\n\t\r\n\t\tTHREE.LineSegments.call( this, geometry, new THREE.LineBasicMaterial( { color: color, linewidth: width } ) );\r\n\t\r\n\t\t//\r\n\t\r\n\t\tthis.matrixAutoUpdate = false;\r\n\t\tthis.update();\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.FaceNormalsHelper.prototype = Object.create( THREE.LineSegments.prototype );\r\n\tTHREE.FaceNormalsHelper.prototype.constructor = THREE.FaceNormalsHelper;\r\n\t\r\n\tTHREE.FaceNormalsHelper.prototype.update = ( function () {\r\n\t\r\n\t\tvar v1 = new THREE.Vector3();\r\n\t\tvar v2 = new THREE.Vector3();\r\n\t\tvar normalMatrix = new THREE.Matrix3();\r\n\t\r\n\t\treturn function update() {\r\n\t\r\n\t\t\tthis.object.updateMatrixWorld( true );\r\n\t\r\n\t\t\tnormalMatrix.getNormalMatrix( this.object.matrixWorld );\r\n\t\r\n\t\t\tvar matrixWorld = this.object.matrixWorld;\r\n\t\r\n\t\t\tvar position = this.geometry.attributes.position;\r\n\t\r\n\t\t\t//\r\n\t\r\n\t\t\tvar objGeometry = this.object.geometry;\r\n\t\r\n\t\t\tvar vertices = objGeometry.vertices;\r\n\t\r\n\t\t\tvar faces = objGeometry.faces;\r\n\t\r\n\t\t\tvar idx = 0;\r\n\t\r\n\t\t\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\tvar face = faces[ i ];\r\n\t\r\n\t\t\t\tvar normal = face.normal;\r\n\t\r\n\t\t\t\tv1.copy( vertices[ face.a ] )\r\n\t\t\t\t\t.add( vertices[ face.b ] )\r\n\t\t\t\t\t.add( vertices[ face.c ] )\r\n\t\t\t\t\t.divideScalar( 3 )\r\n\t\t\t\t\t.applyMatrix4( matrixWorld );\r\n\t\r\n\t\t\t\tv2.copy( normal ).applyMatrix3( normalMatrix ).normalize().multiplyScalar( this.size ).add( v1 );\r\n\t\r\n\t\t\t\tposition.setXYZ( idx, v1.x, v1.y, v1.z );\r\n\t\r\n\t\t\t\tidx = idx + 1;\r\n\t\r\n\t\t\t\tposition.setXYZ( idx, v2.x, v2.y, v2.z );\r\n\t\r\n\t\t\t\tidx = idx + 1;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tposition.needsUpdate = true;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t}\r\n\t\r\n\t}() );\r\n\t\r\n\t// File:src/extras/helpers/GridHelper.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.GridHelper = function ( size, step ) {\r\n\t\r\n\t\tvar geometry = new THREE.Geometry();\r\n\t\tvar material = new THREE.LineBasicMaterial( { vertexColors: THREE.VertexColors } );\r\n\t\r\n\t\tthis.color1 = new THREE.Color( 0x444444 );\r\n\t\tthis.color2 = new THREE.Color( 0x888888 );\r\n\t\r\n\t\tfor ( var i = - size; i <= size; i += step ) {\r\n\t\r\n\t\t\tgeometry.vertices.push(\r\n\t\t\t\tnew THREE.Vector3( - size, 0, i ), new THREE.Vector3( size, 0, i ),\r\n\t\t\t\tnew THREE.Vector3( i, 0, - size ), new THREE.Vector3( i, 0, size )\r\n\t\t\t);\r\n\t\r\n\t\t\tvar color = i === 0 ? this.color1 : this.color2;\r\n\t\r\n\t\t\tgeometry.colors.push( color, color, color, color );\r\n\t\r\n\t\t}\r\n\t\r\n\t\tTHREE.LineSegments.call( this, geometry, material );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.GridHelper.prototype = Object.create( THREE.LineSegments.prototype );\r\n\tTHREE.GridHelper.prototype.constructor = THREE.GridHelper;\r\n\t\r\n\tTHREE.GridHelper.prototype.setColors = function( colorCenterLine, colorGrid ) {\r\n\t\r\n\t\tthis.color1.set( colorCenterLine );\r\n\t\tthis.color2.set( colorGrid );\r\n\t\r\n\t\tthis.geometry.colorsNeedUpdate = true;\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/extras/helpers/HemisphereLightHelper.js\r\n\t\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.HemisphereLightHelper = function ( light, sphereSize ) {\r\n\t\r\n\t\tTHREE.Object3D.call( this );\r\n\t\r\n\t\tthis.light = light;\r\n\t\tthis.light.updateMatrixWorld();\r\n\t\r\n\t\tthis.matrix = light.matrixWorld;\r\n\t\tthis.matrixAutoUpdate = false;\r\n\t\r\n\t\tthis.colors = [ new THREE.Color(), new THREE.Color() ];\r\n\t\r\n\t\tvar geometry = new THREE.SphereGeometry( sphereSize, 4, 2 );\r\n\t\tgeometry.rotateX( - Math.PI / 2 );\r\n\t\r\n\t\tfor ( var i = 0, il = 8; i < il; i ++ ) {\r\n\t\r\n\t\t\tgeometry.faces[ i ].color = this.colors[ i < 4 ? 0 : 1 ];\r\n\t\r\n\t\t}\r\n\t\r\n\t\tvar material = new THREE.MeshBasicMaterial( { vertexColors: THREE.FaceColors, wireframe: true } );\r\n\t\r\n\t\tthis.lightSphere = new THREE.Mesh( geometry, material );\r\n\t\tthis.add( this.lightSphere );\r\n\t\r\n\t\tthis.update();\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.HemisphereLightHelper.prototype = Object.create( THREE.Object3D.prototype );\r\n\tTHREE.HemisphereLightHelper.prototype.constructor = THREE.HemisphereLightHelper;\r\n\t\r\n\tTHREE.HemisphereLightHelper.prototype.dispose = function () {\r\n\t\r\n\t\tthis.lightSphere.geometry.dispose();\r\n\t\tthis.lightSphere.material.dispose();\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.HemisphereLightHelper.prototype.update = function () {\r\n\t\r\n\t\tvar vector = new THREE.Vector3();\r\n\t\r\n\t\treturn function () {\r\n\t\r\n\t\t\tthis.colors[ 0 ].copy( this.light.color ).multiplyScalar( this.light.intensity );\r\n\t\t\tthis.colors[ 1 ].copy( this.light.groundColor ).multiplyScalar( this.light.intensity );\r\n\t\r\n\t\t\tthis.lightSphere.lookAt( vector.setFromMatrixPosition( this.light.matrixWorld ).negate() );\r\n\t\t\tthis.lightSphere.geometry.colorsNeedUpdate = true;\r\n\t\r\n\t\t}\r\n\t\r\n\t}();\r\n\t\r\n\t// File:src/extras/helpers/PointLightHelper.js\r\n\t\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.PointLightHelper = function ( light, sphereSize ) {\r\n\t\r\n\t\tthis.light = light;\r\n\t\tthis.light.updateMatrixWorld();\r\n\t\r\n\t\tvar geometry = new THREE.SphereGeometry( sphereSize, 4, 2 );\r\n\t\tvar material = new THREE.MeshBasicMaterial( { wireframe: true, fog: false } );\r\n\t\tmaterial.color.copy( this.light.color ).multiplyScalar( this.light.intensity );\r\n\t\r\n\t\tTHREE.Mesh.call( this, geometry, material );\r\n\t\r\n\t\tthis.matrix = this.light.matrixWorld;\r\n\t\tthis.matrixAutoUpdate = false;\r\n\t\r\n\t\t/*\r\n\t\tvar distanceGeometry = new THREE.IcosahedronGeometry( 1, 2 );\r\n\t\tvar distanceMaterial = new THREE.MeshBasicMaterial( { color: hexColor, fog: false, wireframe: true, opacity: 0.1, transparent: true } );\r\n\t\r\n\t\tthis.lightSphere = new THREE.Mesh( bulbGeometry, bulbMaterial );\r\n\t\tthis.lightDistance = new THREE.Mesh( distanceGeometry, distanceMaterial );\r\n\t\r\n\t\tvar d = light.distance;\r\n\t\r\n\t\tif ( d === 0.0 ) {\r\n\t\r\n\t\t\tthis.lightDistance.visible = false;\r\n\t\r\n\t\t} else {\r\n\t\r\n\t\t\tthis.lightDistance.scale.set( d, d, d );\r\n\t\r\n\t\t}\r\n\t\r\n\t\tthis.add( this.lightDistance );\r\n\t\t*/\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.PointLightHelper.prototype = Object.create( THREE.Mesh.prototype );\r\n\tTHREE.PointLightHelper.prototype.constructor = THREE.PointLightHelper;\r\n\t\r\n\tTHREE.PointLightHelper.prototype.dispose = function () {\r\n\t\r\n\t\tthis.geometry.dispose();\r\n\t\tthis.material.dispose();\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.PointLightHelper.prototype.update = function () {\r\n\t\r\n\t\tthis.material.color.copy( this.light.color ).multiplyScalar( this.light.intensity );\r\n\t\r\n\t\t/*\r\n\t\tvar d = this.light.distance;\r\n\t\r\n\t\tif ( d === 0.0 ) {\r\n\t\r\n\t\t\tthis.lightDistance.visible = false;\r\n\t\r\n\t\t} else {\r\n\t\r\n\t\t\tthis.lightDistance.visible = true;\r\n\t\t\tthis.lightDistance.scale.set( d, d, d );\r\n\t\r\n\t\t}\r\n\t\t*/\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/extras/helpers/SkeletonHelper.js\r\n\t\r\n\t/**\r\n\t * @author Sean Griffin / http://twitter.com/sgrif\r\n\t * @author Michael Guerrero / http://realitymeltdown.com\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author ikerr / http://verold.com\r\n\t */\r\n\t\r\n\tTHREE.SkeletonHelper = function ( object ) {\r\n\t\r\n\t\tthis.bones = this.getBoneList( object );\r\n\t\r\n\t\tvar geometry = new THREE.Geometry();\r\n\t\r\n\t\tfor ( var i = 0; i < this.bones.length; i ++ ) {\r\n\t\r\n\t\t\tvar bone = this.bones[ i ];\r\n\t\r\n\t\t\tif ( bone.parent instanceof THREE.Bone ) {\r\n\t\r\n\t\t\t\tgeometry.vertices.push( new THREE.Vector3() );\r\n\t\t\t\tgeometry.vertices.push( new THREE.Vector3() );\r\n\t\t\t\tgeometry.colors.push( new THREE.Color( 0, 0, 1 ) );\r\n\t\t\t\tgeometry.colors.push( new THREE.Color( 0, 1, 0 ) );\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tgeometry.dynamic = true;\r\n\t\r\n\t\tvar material = new THREE.LineBasicMaterial( { vertexColors: THREE.VertexColors, depthTest: false, depthWrite: false, transparent: true } );\r\n\t\r\n\t\tTHREE.LineSegments.call( this, geometry, material );\r\n\t\r\n\t\tthis.root = object;\r\n\t\r\n\t\tthis.matrix = object.matrixWorld;\r\n\t\tthis.matrixAutoUpdate = false;\r\n\t\r\n\t\tthis.update();\r\n\t\r\n\t};\r\n\t\r\n\t\r\n\tTHREE.SkeletonHelper.prototype = Object.create( THREE.LineSegments.prototype );\r\n\tTHREE.SkeletonHelper.prototype.constructor = THREE.SkeletonHelper;\r\n\t\r\n\tTHREE.SkeletonHelper.prototype.getBoneList = function( object ) {\r\n\t\r\n\t\tvar boneList = [];\r\n\t\r\n\t\tif ( object instanceof THREE.Bone ) {\r\n\t\r\n\t\t\tboneList.push( object );\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfor ( var i = 0; i < object.children.length; i ++ ) {\r\n\t\r\n\t\t\tboneList.push.apply( boneList, this.getBoneList( object.children[ i ] ) );\r\n\t\r\n\t\t}\r\n\t\r\n\t\treturn boneList;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.SkeletonHelper.prototype.update = function () {\r\n\t\r\n\t\tvar geometry = this.geometry;\r\n\t\r\n\t\tvar matrixWorldInv = new THREE.Matrix4().getInverse( this.root.matrixWorld );\r\n\t\r\n\t\tvar boneMatrix = new THREE.Matrix4();\r\n\t\r\n\t\tvar j = 0;\r\n\t\r\n\t\tfor ( var i = 0; i < this.bones.length; i ++ ) {\r\n\t\r\n\t\t\tvar bone = this.bones[ i ];\r\n\t\r\n\t\t\tif ( bone.parent instanceof THREE.Bone ) {\r\n\t\r\n\t\t\t\tboneMatrix.multiplyMatrices( matrixWorldInv, bone.matrixWorld );\r\n\t\t\t\tgeometry.vertices[ j ].setFromMatrixPosition( boneMatrix );\r\n\t\r\n\t\t\t\tboneMatrix.multiplyMatrices( matrixWorldInv, bone.parent.matrixWorld );\r\n\t\t\t\tgeometry.vertices[ j + 1 ].setFromMatrixPosition( boneMatrix );\r\n\t\r\n\t\t\t\tj += 2;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tgeometry.verticesNeedUpdate = true;\r\n\t\r\n\t\tgeometry.computeBoundingSphere();\r\n\t\r\n\t};\r\n\t\r\n\t// File:src/extras/helpers/SpotLightHelper.js\r\n\t\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t*/\r\n\t\r\n\tTHREE.SpotLightHelper = function ( light ) {\r\n\t\r\n\t\tTHREE.Object3D.call( this );\r\n\t\r\n\t\tthis.light = light;\r\n\t\tthis.light.updateMatrixWorld();\r\n\t\r\n\t\tthis.matrix = light.matrixWorld;\r\n\t\tthis.matrixAutoUpdate = false;\r\n\t\r\n\t\tvar geometry = new THREE.CylinderGeometry( 0, 1, 1, 8, 1, true );\r\n\t\r\n\t\tgeometry.translate( 0, - 0.5, 0 );\r\n\t\tgeometry.rotateX( - Math.PI / 2 );\r\n\t\r\n\t\tvar material = new THREE.MeshBasicMaterial( { wireframe: true, fog: false } );\r\n\t\r\n\t\tthis.cone = new THREE.Mesh( geometry, material );\r\n\t\tthis.add( this.cone );\r\n\t\r\n\t\tthis.update();\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.SpotLightHelper.prototype = Object.create( THREE.Object3D.prototype );\r\n\tTHREE.SpotLightHelper.prototype.constructor = THREE.SpotLightHelper;\r\n\t\r\n\tTHREE.SpotLightHelper.prototype.dispose = function () {\r\n\t\r\n\t\tthis.cone.geometry.dispose();\r\n\t\tthis.cone.material.dispose();\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.SpotLightHelper.prototype.update = function () {\r\n\t\r\n\t\tvar vector = new THREE.Vector3();\r\n\t\tvar vector2 = new THREE.Vector3();\r\n\t\r\n\t\treturn function () {\r\n\t\r\n\t\t\tvar coneLength = this.light.distance ? this.light.distance : 10000;\r\n\t\t\tvar coneWidth = coneLength * Math.tan( this.light.angle );\r\n\t\r\n\t\t\tthis.cone.scale.set( coneWidth, coneWidth, coneLength );\r\n\t\r\n\t\t\tvector.setFromMatrixPosition( this.light.matrixWorld );\r\n\t\t\tvector2.setFromMatrixPosition( this.light.target.matrixWorld );\r\n\t\r\n\t\t\tthis.cone.lookAt( vector2.sub( vector ) );\r\n\t\r\n\t\t\tthis.cone.material.color.copy( this.light.color ).multiplyScalar( this.light.intensity );\r\n\t\r\n\t\t};\r\n\t\r\n\t}();\r\n\t\r\n\t// File:src/extras/helpers/VertexNormalsHelper.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t*/\r\n\t\r\n\tTHREE.VertexNormalsHelper = function ( object, size, hex, linewidth ) {\r\n\t\r\n\t\tthis.object = object;\r\n\t\r\n\t\tthis.size = ( size !== undefined ) ? size : 1;\r\n\t\r\n\t\tvar color = ( hex !== undefined ) ? hex : 0xff0000;\r\n\t\r\n\t\tvar width = ( linewidth !== undefined ) ? linewidth : 1;\r\n\t\r\n\t\t//\r\n\t\r\n\t\tvar nNormals = 0;\r\n\t\r\n\t\tvar objGeometry = this.object.geometry;\r\n\t\r\n\t\tif ( objGeometry instanceof THREE.Geometry ) {\r\n\t\r\n\t\t\tnNormals = objGeometry.faces.length * 3;\r\n\t\r\n\t\t} else if ( objGeometry instanceof THREE.BufferGeometry ) {\r\n\t\r\n\t\t\tnNormals = objGeometry.attributes.normal.count\r\n\t\r\n\t\t}\r\n\t\r\n\t\t//\r\n\t\r\n\t\tvar geometry = new THREE.BufferGeometry();\r\n\t\r\n\t\tvar positions = new THREE.Float32Attribute( nNormals * 2 * 3, 3 );\r\n\t\r\n\t\tgeometry.addAttribute( 'position', positions );\r\n\t\r\n\t\tTHREE.LineSegments.call( this, geometry, new THREE.LineBasicMaterial( { color: color, linewidth: width } ) );\r\n\t\r\n\t\t//\r\n\t\r\n\t\tthis.matrixAutoUpdate = false;\r\n\t\r\n\t\tthis.update();\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.VertexNormalsHelper.prototype = Object.create( THREE.LineSegments.prototype );\r\n\tTHREE.VertexNormalsHelper.prototype.constructor = THREE.VertexNormalsHelper;\r\n\t\r\n\tTHREE.VertexNormalsHelper.prototype.update = ( function () {\r\n\t\r\n\t\tvar v1 = new THREE.Vector3();\r\n\t\tvar v2 = new THREE.Vector3();\r\n\t\tvar normalMatrix = new THREE.Matrix3();\r\n\t\r\n\t\treturn function update() {\r\n\t\r\n\t\t\tvar keys = [ 'a', 'b', 'c' ];\r\n\t\r\n\t\t\tthis.object.updateMatrixWorld( true );\r\n\t\r\n\t\t\tnormalMatrix.getNormalMatrix( this.object.matrixWorld );\r\n\t\r\n\t\t\tvar matrixWorld = this.object.matrixWorld;\r\n\t\r\n\t\t\tvar position = this.geometry.attributes.position;\r\n\t\r\n\t\t\t//\r\n\t\r\n\t\t\tvar objGeometry = this.object.geometry;\r\n\t\r\n\t\t\tif ( objGeometry instanceof THREE.Geometry ) {\r\n\t\r\n\t\t\t\tvar vertices = objGeometry.vertices;\r\n\t\r\n\t\t\t\tvar faces = objGeometry.faces;\r\n\t\r\n\t\t\t\tvar idx = 0;\r\n\t\r\n\t\t\t\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\r\n\t\r\n\t\t\t\t\tvar face = faces[ i ];\r\n\t\r\n\t\t\t\t\tfor ( var j = 0, jl = face.vertexNormals.length; j < jl; j ++ ) {\r\n\t\r\n\t\t\t\t\t\tvar vertex = vertices[ face[ keys[ j ] ] ];\r\n\t\r\n\t\t\t\t\t\tvar normal = face.vertexNormals[ j ];\r\n\t\r\n\t\t\t\t\t\tv1.copy( vertex ).applyMatrix4( matrixWorld );\r\n\t\r\n\t\t\t\t\t\tv2.copy( normal ).applyMatrix3( normalMatrix ).normalize().multiplyScalar( this.size ).add( v1 );\r\n\t\r\n\t\t\t\t\t\tposition.setXYZ( idx, v1.x, v1.y, v1.z );\r\n\t\r\n\t\t\t\t\t\tidx = idx + 1;\r\n\t\r\n\t\t\t\t\t\tposition.setXYZ( idx, v2.x, v2.y, v2.z );\r\n\t\r\n\t\t\t\t\t\tidx = idx + 1;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t} else if ( objGeometry instanceof THREE.BufferGeometry ) {\r\n\t\r\n\t\t\t\tvar objPos = objGeometry.attributes.position;\r\n\t\r\n\t\t\t\tvar objNorm = objGeometry.attributes.normal;\r\n\t\r\n\t\t\t\tvar idx = 0;\r\n\t\r\n\t\t\t\t// for simplicity, ignore index and drawcalls, and render every normal\r\n\t\r\n\t\t\t\tfor ( var j = 0, jl = objPos.count; j < jl; j ++ ) {\r\n\t\r\n\t\t\t\t\tv1.set( objPos.getX( j ), objPos.getY( j ), objPos.getZ( j ) ).applyMatrix4( matrixWorld );\r\n\t\r\n\t\t\t\t\tv2.set( objNorm.getX( j ), objNorm.getY( j ), objNorm.getZ( j ) );\r\n\t\r\n\t\t\t\t\tv2.applyMatrix3( normalMatrix ).normalize().multiplyScalar( this.size ).add( v1 );\r\n\t\r\n\t\t\t\t\tposition.setXYZ( idx, v1.x, v1.y, v1.z );\r\n\t\r\n\t\t\t\t\tidx = idx + 1;\r\n\t\r\n\t\t\t\t\tposition.setXYZ( idx, v2.x, v2.y, v2.z );\r\n\t\r\n\t\t\t\t\tidx = idx + 1;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tposition.needsUpdate = true;\r\n\t\r\n\t\t\treturn this;\r\n\t\r\n\t\t}\r\n\t\r\n\t}() );\r\n\t\r\n\t// File:src/extras/helpers/WireframeHelper.js\r\n\t\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\t\r\n\tTHREE.WireframeHelper = function ( object, hex ) {\r\n\t\r\n\t\tvar color = ( hex !== undefined ) ? hex : 0xffffff;\r\n\t\r\n\t\tTHREE.LineSegments.call( this, new THREE.WireframeGeometry( object.geometry ), new THREE.LineBasicMaterial( { color: color } ) );\r\n\t\r\n\t\tthis.matrix = object.matrixWorld;\r\n\t\tthis.matrixAutoUpdate = false;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.WireframeHelper.prototype = Object.create( THREE.LineSegments.prototype );\r\n\tTHREE.WireframeHelper.prototype.constructor = THREE.WireframeHelper;\r\n\t\r\n\t// File:src/extras/objects/ImmediateRenderObject.js\r\n\t\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\t\r\n\tTHREE.ImmediateRenderObject = function ( material ) {\r\n\t\r\n\t\tTHREE.Object3D.call( this );\r\n\t\r\n\t\tthis.material = material;\r\n\t\tthis.render = function ( renderCallback ) {};\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.ImmediateRenderObject.prototype = Object.create( THREE.Object3D.prototype );\r\n\tTHREE.ImmediateRenderObject.prototype.constructor = THREE.ImmediateRenderObject;\r\n\t\r\n\t// File:src/extras/objects/MorphBlendMesh.js\r\n\t\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\t\r\n\tTHREE.MorphBlendMesh = function( geometry, material ) {\r\n\t\r\n\t\tTHREE.Mesh.call( this, geometry, material );\r\n\t\r\n\t\tthis.animationsMap = {};\r\n\t\tthis.animationsList = [];\r\n\t\r\n\t\t// prepare default animation\r\n\t\t// (all frames played together in 1 second)\r\n\t\r\n\t\tvar numFrames = this.geometry.morphTargets.length;\r\n\t\r\n\t\tvar name = \"__default\";\r\n\t\r\n\t\tvar startFrame = 0;\r\n\t\tvar endFrame = numFrames - 1;\r\n\t\r\n\t\tvar fps = numFrames / 1;\r\n\t\r\n\t\tthis.createAnimation( name, startFrame, endFrame, fps );\r\n\t\tthis.setAnimationWeight( name, 1 );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.MorphBlendMesh.prototype = Object.create( THREE.Mesh.prototype );\r\n\tTHREE.MorphBlendMesh.prototype.constructor = THREE.MorphBlendMesh;\r\n\t\r\n\tTHREE.MorphBlendMesh.prototype.createAnimation = function ( name, start, end, fps ) {\r\n\t\r\n\t\tvar animation = {\r\n\t\r\n\t\t\tstart: start,\r\n\t\t\tend: end,\r\n\t\r\n\t\t\tlength: end - start + 1,\r\n\t\r\n\t\t\tfps: fps,\r\n\t\t\tduration: ( end - start ) / fps,\r\n\t\r\n\t\t\tlastFrame: 0,\r\n\t\t\tcurrentFrame: 0,\r\n\t\r\n\t\t\tactive: false,\r\n\t\r\n\t\t\ttime: 0,\r\n\t\t\tdirection: 1,\r\n\t\t\tweight: 1,\r\n\t\r\n\t\t\tdirectionBackwards: false,\r\n\t\t\tmirroredLoop: false\r\n\t\r\n\t\t};\r\n\t\r\n\t\tthis.animationsMap[ name ] = animation;\r\n\t\tthis.animationsList.push( animation );\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.MorphBlendMesh.prototype.autoCreateAnimations = function ( fps ) {\r\n\t\r\n\t\tvar pattern = /([a-z]+)_?(\\d+)/;\r\n\t\r\n\t\tvar firstAnimation, frameRanges = {};\r\n\t\r\n\t\tvar geometry = this.geometry;\r\n\t\r\n\t\tfor ( var i = 0, il = geometry.morphTargets.length; i < il; i ++ ) {\r\n\t\r\n\t\t\tvar morph = geometry.morphTargets[ i ];\r\n\t\t\tvar chunks = morph.name.match( pattern );\r\n\t\r\n\t\t\tif ( chunks && chunks.length > 1 ) {\r\n\t\r\n\t\t\t\tvar name = chunks[ 1 ];\r\n\t\r\n\t\t\t\tif ( ! frameRanges[ name ] ) frameRanges[ name ] = { start: Infinity, end: - Infinity };\r\n\t\r\n\t\t\t\tvar range = frameRanges[ name ];\r\n\t\r\n\t\t\t\tif ( i < range.start ) range.start = i;\r\n\t\t\t\tif ( i > range.end ) range.end = i;\r\n\t\r\n\t\t\t\tif ( ! firstAnimation ) firstAnimation = name;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t\tfor ( var name in frameRanges ) {\r\n\t\r\n\t\t\tvar range = frameRanges[ name ];\r\n\t\t\tthis.createAnimation( name, range.start, range.end, fps );\r\n\t\r\n\t\t}\r\n\t\r\n\t\tthis.firstAnimation = firstAnimation;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.MorphBlendMesh.prototype.setAnimationDirectionForward = function ( name ) {\r\n\t\r\n\t\tvar animation = this.animationsMap[ name ];\r\n\t\r\n\t\tif ( animation ) {\r\n\t\r\n\t\t\tanimation.direction = 1;\r\n\t\t\tanimation.directionBackwards = false;\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.MorphBlendMesh.prototype.setAnimationDirectionBackward = function ( name ) {\r\n\t\r\n\t\tvar animation = this.animationsMap[ name ];\r\n\t\r\n\t\tif ( animation ) {\r\n\t\r\n\t\t\tanimation.direction = - 1;\r\n\t\t\tanimation.directionBackwards = true;\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.MorphBlendMesh.prototype.setAnimationFPS = function ( name, fps ) {\r\n\t\r\n\t\tvar animation = this.animationsMap[ name ];\r\n\t\r\n\t\tif ( animation ) {\r\n\t\r\n\t\t\tanimation.fps = fps;\r\n\t\t\tanimation.duration = ( animation.end - animation.start ) / animation.fps;\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.MorphBlendMesh.prototype.setAnimationDuration = function ( name, duration ) {\r\n\t\r\n\t\tvar animation = this.animationsMap[ name ];\r\n\t\r\n\t\tif ( animation ) {\r\n\t\r\n\t\t\tanimation.duration = duration;\r\n\t\t\tanimation.fps = ( animation.end - animation.start ) / animation.duration;\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.MorphBlendMesh.prototype.setAnimationWeight = function ( name, weight ) {\r\n\t\r\n\t\tvar animation = this.animationsMap[ name ];\r\n\t\r\n\t\tif ( animation ) {\r\n\t\r\n\t\t\tanimation.weight = weight;\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.MorphBlendMesh.prototype.setAnimationTime = function ( name, time ) {\r\n\t\r\n\t\tvar animation = this.animationsMap[ name ];\r\n\t\r\n\t\tif ( animation ) {\r\n\t\r\n\t\t\tanimation.time = time;\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.MorphBlendMesh.prototype.getAnimationTime = function ( name ) {\r\n\t\r\n\t\tvar time = 0;\r\n\t\r\n\t\tvar animation = this.animationsMap[ name ];\r\n\t\r\n\t\tif ( animation ) {\r\n\t\r\n\t\t\ttime = animation.time;\r\n\t\r\n\t\t}\r\n\t\r\n\t\treturn time;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.MorphBlendMesh.prototype.getAnimationDuration = function ( name ) {\r\n\t\r\n\t\tvar duration = - 1;\r\n\t\r\n\t\tvar animation = this.animationsMap[ name ];\r\n\t\r\n\t\tif ( animation ) {\r\n\t\r\n\t\t\tduration = animation.duration;\r\n\t\r\n\t\t}\r\n\t\r\n\t\treturn duration;\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.MorphBlendMesh.prototype.playAnimation = function ( name ) {\r\n\t\r\n\t\tvar animation = this.animationsMap[ name ];\r\n\t\r\n\t\tif ( animation ) {\r\n\t\r\n\t\t\tanimation.time = 0;\r\n\t\t\tanimation.active = true;\r\n\t\r\n\t\t} else {\r\n\t\r\n\t\t\tconsole.warn( \"THREE.MorphBlendMesh: animation[\" + name + \"] undefined in .playAnimation()\" );\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.MorphBlendMesh.prototype.stopAnimation = function ( name ) {\r\n\t\r\n\t\tvar animation = this.animationsMap[ name ];\r\n\t\r\n\t\tif ( animation ) {\r\n\t\r\n\t\t\tanimation.active = false;\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\tTHREE.MorphBlendMesh.prototype.update = function ( delta ) {\r\n\t\r\n\t\tfor ( var i = 0, il = this.animationsList.length; i < il; i ++ ) {\r\n\t\r\n\t\t\tvar animation = this.animationsList[ i ];\r\n\t\r\n\t\t\tif ( ! animation.active ) continue;\r\n\t\r\n\t\t\tvar frameTime = animation.duration / animation.length;\r\n\t\r\n\t\t\tanimation.time += animation.direction * delta;\r\n\t\r\n\t\t\tif ( animation.mirroredLoop ) {\r\n\t\r\n\t\t\t\tif ( animation.time > animation.duration || animation.time < 0 ) {\r\n\t\r\n\t\t\t\t\tanimation.direction *= - 1;\r\n\t\r\n\t\t\t\t\tif ( animation.time > animation.duration ) {\r\n\t\r\n\t\t\t\t\t\tanimation.time = animation.duration;\r\n\t\t\t\t\t\tanimation.directionBackwards = true;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tif ( animation.time < 0 ) {\r\n\t\r\n\t\t\t\t\t\tanimation.time = 0;\r\n\t\t\t\t\t\tanimation.directionBackwards = false;\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\tanimation.time = animation.time % animation.duration;\r\n\t\r\n\t\t\t\tif ( animation.time < 0 ) animation.time += animation.duration;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar keyframe = animation.start + THREE.Math.clamp( Math.floor( animation.time / frameTime ), 0, animation.length - 1 );\r\n\t\t\tvar weight = animation.weight;\r\n\t\r\n\t\t\tif ( keyframe !== animation.currentFrame ) {\r\n\t\r\n\t\t\t\tthis.morphTargetInfluences[ animation.lastFrame ] = 0;\r\n\t\t\t\tthis.morphTargetInfluences[ animation.currentFrame ] = 1 * weight;\r\n\t\r\n\t\t\t\tthis.morphTargetInfluences[ keyframe ] = 0;\r\n\t\r\n\t\t\t\tanimation.lastFrame = animation.currentFrame;\r\n\t\t\t\tanimation.currentFrame = keyframe;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvar mix = ( animation.time % frameTime ) / frameTime;\r\n\t\r\n\t\t\tif ( animation.directionBackwards ) mix = 1 - mix;\r\n\t\r\n\t\t\tif ( animation.currentFrame !== animation.lastFrame ) {\r\n\t\r\n\t\t\t\tthis.morphTargetInfluences[ animation.currentFrame ] = mix * weight;\r\n\t\t\t\tthis.morphTargetInfluences[ animation.lastFrame ] = ( 1 - mix ) * weight;\r\n\t\r\n\t\t\t} else {\r\n\t\r\n\t\t\t\tthis.morphTargetInfluences[ animation.currentFrame ] = weight;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\r\n\t};\r\n\t\r\n\t\r\n\t// Export the THREE object for **Node.js**, with\r\n\t// backwards-compatibility for the old `require()` API. If we're in\r\n\t// the browser, add `_` as a global object via a string identifier,\r\n\t// for Closure Compiler \"advanced\" mode.\r\n\tif (true) {\r\n\t  if (typeof module !== 'undefined' && module.exports) {\r\n\t    exports = module.exports = THREE;\r\n\t  }\r\n\t  exports.THREE = THREE;\r\n\t} else {\r\n\t  this['THREE'] = THREE;\r\n\t}\r\n\n\n/***/ },\n/* 10 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/**\n\t * lodash 3.0.3 (Custom Build) <https://lodash.com/>\n\t * Build: `lodash modern modularize exports=\"npm\" -o ./`\n\t * Copyright 2012-2015 The Dojo Foundation <http://dojofoundation.org/>\n\t * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n\t * Copyright 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n\t * Available under MIT license <https://lodash.com/license>\n\t */\n\tvar arrayEach = __webpack_require__(11),\n\t    baseEach = __webpack_require__(12),\n\t    bindCallback = __webpack_require__(17),\n\t    isArray = __webpack_require__(16);\n\t\n\t/**\n\t * Creates a function for `_.forEach` or `_.forEachRight`.\n\t *\n\t * @private\n\t * @param {Function} arrayFunc The function to iterate over an array.\n\t * @param {Function} eachFunc The function to iterate over a collection.\n\t * @returns {Function} Returns the new each function.\n\t */\n\tfunction createForEach(arrayFunc, eachFunc) {\n\t  return function(collection, iteratee, thisArg) {\n\t    return (typeof iteratee == 'function' && thisArg === undefined && isArray(collection))\n\t      ? arrayFunc(collection, iteratee)\n\t      : eachFunc(collection, bindCallback(iteratee, thisArg, 3));\n\t  };\n\t}\n\t\n\t/**\n\t * Iterates over elements of `collection` invoking `iteratee` for each element.\n\t * The `iteratee` is bound to `thisArg` and invoked with three arguments:\n\t * (value, index|key, collection). Iteratee functions may exit iteration early\n\t * by explicitly returning `false`.\n\t *\n\t * **Note:** As with other \"Collections\" methods, objects with a \"length\" property\n\t * are iterated like arrays. To avoid this behavior `_.forIn` or `_.forOwn`\n\t * may be used for object iteration.\n\t *\n\t * @static\n\t * @memberOf _\n\t * @alias each\n\t * @category Collection\n\t * @param {Array|Object|string} collection The collection to iterate over.\n\t * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n\t * @param {*} [thisArg] The `this` binding of `iteratee`.\n\t * @returns {Array|Object|string} Returns `collection`.\n\t * @example\n\t *\n\t * _([1, 2]).forEach(function(n) {\n\t *   console.log(n);\n\t * }).value();\n\t * // => logs each value from left to right and returns the array\n\t *\n\t * _.forEach({ 'a': 1, 'b': 2 }, function(n, key) {\n\t *   console.log(n, key);\n\t * });\n\t * // => logs each value-key pair and returns the object (iteration order is not guaranteed)\n\t */\n\tvar forEach = createForEach(arrayEach, baseEach);\n\t\n\tmodule.exports = forEach;\n\n\n/***/ },\n/* 11 */\n/***/ function(module, exports) {\n\n\t/**\n\t * lodash 3.0.0 (Custom Build) <https://lodash.com/>\n\t * Build: `lodash modern modularize exports=\"npm\" -o ./`\n\t * Copyright 2012-2015 The Dojo Foundation <http://dojofoundation.org/>\n\t * Based on Underscore.js 1.7.0 <http://underscorejs.org/LICENSE>\n\t * Copyright 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n\t * Available under MIT license <https://lodash.com/license>\n\t */\n\t\n\t/**\n\t * A specialized version of `_.forEach` for arrays without support for callback\n\t * shorthands or `this` binding.\n\t *\n\t * @private\n\t * @param {Array} array The array to iterate over.\n\t * @param {Function} iteratee The function invoked per iteration.\n\t * @returns {Array} Returns `array`.\n\t */\n\tfunction arrayEach(array, iteratee) {\n\t  var index = -1,\n\t      length = array.length;\n\t\n\t  while (++index < length) {\n\t    if (iteratee(array[index], index, array) === false) {\n\t      break;\n\t    }\n\t  }\n\t  return array;\n\t}\n\t\n\tmodule.exports = arrayEach;\n\n\n/***/ },\n/* 12 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/**\n\t * lodash 3.0.4 (Custom Build) <https://lodash.com/>\n\t * Build: `lodash modern modularize exports=\"npm\" -o ./`\n\t * Copyright 2012-2015 The Dojo Foundation <http://dojofoundation.org/>\n\t * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n\t * Copyright 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n\t * Available under MIT license <https://lodash.com/license>\n\t */\n\tvar keys = __webpack_require__(13);\n\t\n\t/**\n\t * Used as the [maximum length](https://people.mozilla.org/~jorendorff/es6-draft.html#sec-number.max_safe_integer)\n\t * of an array-like value.\n\t */\n\tvar MAX_SAFE_INTEGER = 9007199254740991;\n\t\n\t/**\n\t * The base implementation of `_.forEach` without support for callback\n\t * shorthands and `this` binding.\n\t *\n\t * @private\n\t * @param {Array|Object|string} collection The collection to iterate over.\n\t * @param {Function} iteratee The function invoked per iteration.\n\t * @returns {Array|Object|string} Returns `collection`.\n\t */\n\tvar baseEach = createBaseEach(baseForOwn);\n\t\n\t/**\n\t * The base implementation of `baseForIn` and `baseForOwn` which iterates\n\t * over `object` properties returned by `keysFunc` invoking `iteratee` for\n\t * each property. Iteratee functions may exit iteration early by explicitly\n\t * returning `false`.\n\t *\n\t * @private\n\t * @param {Object} object The object to iterate over.\n\t * @param {Function} iteratee The function invoked per iteration.\n\t * @param {Function} keysFunc The function to get the keys of `object`.\n\t * @returns {Object} Returns `object`.\n\t */\n\tvar baseFor = createBaseFor();\n\t\n\t/**\n\t * The base implementation of `_.forOwn` without support for callback\n\t * shorthands and `this` binding.\n\t *\n\t * @private\n\t * @param {Object} object The object to iterate over.\n\t * @param {Function} iteratee The function invoked per iteration.\n\t * @returns {Object} Returns `object`.\n\t */\n\tfunction baseForOwn(object, iteratee) {\n\t  return baseFor(object, iteratee, keys);\n\t}\n\t\n\t/**\n\t * The base implementation of `_.property` without support for deep paths.\n\t *\n\t * @private\n\t * @param {string} key The key of the property to get.\n\t * @returns {Function} Returns the new function.\n\t */\n\tfunction baseProperty(key) {\n\t  return function(object) {\n\t    return object == null ? undefined : object[key];\n\t  };\n\t}\n\t\n\t/**\n\t * Creates a `baseEach` or `baseEachRight` function.\n\t *\n\t * @private\n\t * @param {Function} eachFunc The function to iterate over a collection.\n\t * @param {boolean} [fromRight] Specify iterating from right to left.\n\t * @returns {Function} Returns the new base function.\n\t */\n\tfunction createBaseEach(eachFunc, fromRight) {\n\t  return function(collection, iteratee) {\n\t    var length = collection ? getLength(collection) : 0;\n\t    if (!isLength(length)) {\n\t      return eachFunc(collection, iteratee);\n\t    }\n\t    var index = fromRight ? length : -1,\n\t        iterable = toObject(collection);\n\t\n\t    while ((fromRight ? index-- : ++index < length)) {\n\t      if (iteratee(iterable[index], index, iterable) === false) {\n\t        break;\n\t      }\n\t    }\n\t    return collection;\n\t  };\n\t}\n\t\n\t/**\n\t * Creates a base function for `_.forIn` or `_.forInRight`.\n\t *\n\t * @private\n\t * @param {boolean} [fromRight] Specify iterating from right to left.\n\t * @returns {Function} Returns the new base function.\n\t */\n\tfunction createBaseFor(fromRight) {\n\t  return function(object, iteratee, keysFunc) {\n\t    var iterable = toObject(object),\n\t        props = keysFunc(object),\n\t        length = props.length,\n\t        index = fromRight ? length : -1;\n\t\n\t    while ((fromRight ? index-- : ++index < length)) {\n\t      var key = props[index];\n\t      if (iteratee(iterable[key], key, iterable) === false) {\n\t        break;\n\t      }\n\t    }\n\t    return object;\n\t  };\n\t}\n\t\n\t/**\n\t * Gets the \"length\" property value of `object`.\n\t *\n\t * **Note:** This function is used to avoid a [JIT bug](https://bugs.webkit.org/show_bug.cgi?id=142792)\n\t * that affects Safari on at least iOS 8.1-8.3 ARM64.\n\t *\n\t * @private\n\t * @param {Object} object The object to query.\n\t * @returns {*} Returns the \"length\" value.\n\t */\n\tvar getLength = baseProperty('length');\n\t\n\t/**\n\t * Checks if `value` is a valid array-like length.\n\t *\n\t * **Note:** This function is based on [`ToLength`](https://people.mozilla.org/~jorendorff/es6-draft.html#sec-tolength).\n\t *\n\t * @private\n\t * @param {*} value The value to check.\n\t * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n\t */\n\tfunction isLength(value) {\n\t  return typeof value == 'number' && value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n\t}\n\t\n\t/**\n\t * Converts `value` to an object if it's not one.\n\t *\n\t * @private\n\t * @param {*} value The value to process.\n\t * @returns {Object} Returns the object.\n\t */\n\tfunction toObject(value) {\n\t  return isObject(value) ? value : Object(value);\n\t}\n\t\n\t/**\n\t * Checks if `value` is the [language type](https://es5.github.io/#x8) of `Object`.\n\t * (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n\t *\n\t * @static\n\t * @memberOf _\n\t * @category Lang\n\t * @param {*} value The value to check.\n\t * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n\t * @example\n\t *\n\t * _.isObject({});\n\t * // => true\n\t *\n\t * _.isObject([1, 2, 3]);\n\t * // => true\n\t *\n\t * _.isObject(1);\n\t * // => false\n\t */\n\tfunction isObject(value) {\n\t  // Avoid a V8 JIT bug in Chrome 19-20.\n\t  // See https://code.google.com/p/v8/issues/detail?id=2291 for more details.\n\t  var type = typeof value;\n\t  return !!value && (type == 'object' || type == 'function');\n\t}\n\t\n\tmodule.exports = baseEach;\n\n\n/***/ },\n/* 13 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/**\n\t * lodash 3.1.2 (Custom Build) <https://lodash.com/>\n\t * Build: `lodash modern modularize exports=\"npm\" -o ./`\n\t * Copyright 2012-2015 The Dojo Foundation <http://dojofoundation.org/>\n\t * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n\t * Copyright 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n\t * Available under MIT license <https://lodash.com/license>\n\t */\n\tvar getNative = __webpack_require__(14),\n\t    isArguments = __webpack_require__(15),\n\t    isArray = __webpack_require__(16);\n\t\n\t/** Used to detect unsigned integer values. */\n\tvar reIsUint = /^\\d+$/;\n\t\n\t/** Used for native method references. */\n\tvar objectProto = Object.prototype;\n\t\n\t/** Used to check objects for own properties. */\n\tvar hasOwnProperty = objectProto.hasOwnProperty;\n\t\n\t/* Native method references for those with the same name as other `lodash` methods. */\n\tvar nativeKeys = getNative(Object, 'keys');\n\t\n\t/**\n\t * Used as the [maximum length](http://ecma-international.org/ecma-262/6.0/#sec-number.max_safe_integer)\n\t * of an array-like value.\n\t */\n\tvar MAX_SAFE_INTEGER = 9007199254740991;\n\t\n\t/**\n\t * The base implementation of `_.property` without support for deep paths.\n\t *\n\t * @private\n\t * @param {string} key The key of the property to get.\n\t * @returns {Function} Returns the new function.\n\t */\n\tfunction baseProperty(key) {\n\t  return function(object) {\n\t    return object == null ? undefined : object[key];\n\t  };\n\t}\n\t\n\t/**\n\t * Gets the \"length\" property value of `object`.\n\t *\n\t * **Note:** This function is used to avoid a [JIT bug](https://bugs.webkit.org/show_bug.cgi?id=142792)\n\t * that affects Safari on at least iOS 8.1-8.3 ARM64.\n\t *\n\t * @private\n\t * @param {Object} object The object to query.\n\t * @returns {*} Returns the \"length\" value.\n\t */\n\tvar getLength = baseProperty('length');\n\t\n\t/**\n\t * Checks if `value` is array-like.\n\t *\n\t * @private\n\t * @param {*} value The value to check.\n\t * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n\t */\n\tfunction isArrayLike(value) {\n\t  return value != null && isLength(getLength(value));\n\t}\n\t\n\t/**\n\t * Checks if `value` is a valid array-like index.\n\t *\n\t * @private\n\t * @param {*} value The value to check.\n\t * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n\t * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n\t */\n\tfunction isIndex(value, length) {\n\t  value = (typeof value == 'number' || reIsUint.test(value)) ? +value : -1;\n\t  length = length == null ? MAX_SAFE_INTEGER : length;\n\t  return value > -1 && value % 1 == 0 && value < length;\n\t}\n\t\n\t/**\n\t * Checks if `value` is a valid array-like length.\n\t *\n\t * **Note:** This function is based on [`ToLength`](http://ecma-international.org/ecma-262/6.0/#sec-tolength).\n\t *\n\t * @private\n\t * @param {*} value The value to check.\n\t * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n\t */\n\tfunction isLength(value) {\n\t  return typeof value == 'number' && value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n\t}\n\t\n\t/**\n\t * A fallback implementation of `Object.keys` which creates an array of the\n\t * own enumerable property names of `object`.\n\t *\n\t * @private\n\t * @param {Object} object The object to query.\n\t * @returns {Array} Returns the array of property names.\n\t */\n\tfunction shimKeys(object) {\n\t  var props = keysIn(object),\n\t      propsLength = props.length,\n\t      length = propsLength && object.length;\n\t\n\t  var allowIndexes = !!length && isLength(length) &&\n\t    (isArray(object) || isArguments(object));\n\t\n\t  var index = -1,\n\t      result = [];\n\t\n\t  while (++index < propsLength) {\n\t    var key = props[index];\n\t    if ((allowIndexes && isIndex(key, length)) || hasOwnProperty.call(object, key)) {\n\t      result.push(key);\n\t    }\n\t  }\n\t  return result;\n\t}\n\t\n\t/**\n\t * Checks if `value` is the [language type](https://es5.github.io/#x8) of `Object`.\n\t * (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n\t *\n\t * @static\n\t * @memberOf _\n\t * @category Lang\n\t * @param {*} value The value to check.\n\t * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n\t * @example\n\t *\n\t * _.isObject({});\n\t * // => true\n\t *\n\t * _.isObject([1, 2, 3]);\n\t * // => true\n\t *\n\t * _.isObject(1);\n\t * // => false\n\t */\n\tfunction isObject(value) {\n\t  // Avoid a V8 JIT bug in Chrome 19-20.\n\t  // See https://code.google.com/p/v8/issues/detail?id=2291 for more details.\n\t  var type = typeof value;\n\t  return !!value && (type == 'object' || type == 'function');\n\t}\n\t\n\t/**\n\t * Creates an array of the own enumerable property names of `object`.\n\t *\n\t * **Note:** Non-object values are coerced to objects. See the\n\t * [ES spec](http://ecma-international.org/ecma-262/6.0/#sec-object.keys)\n\t * for more details.\n\t *\n\t * @static\n\t * @memberOf _\n\t * @category Object\n\t * @param {Object} object The object to query.\n\t * @returns {Array} Returns the array of property names.\n\t * @example\n\t *\n\t * function Foo() {\n\t *   this.a = 1;\n\t *   this.b = 2;\n\t * }\n\t *\n\t * Foo.prototype.c = 3;\n\t *\n\t * _.keys(new Foo);\n\t * // => ['a', 'b'] (iteration order is not guaranteed)\n\t *\n\t * _.keys('hi');\n\t * // => ['0', '1']\n\t */\n\tvar keys = !nativeKeys ? shimKeys : function(object) {\n\t  var Ctor = object == null ? undefined : object.constructor;\n\t  if ((typeof Ctor == 'function' && Ctor.prototype === object) ||\n\t      (typeof object != 'function' && isArrayLike(object))) {\n\t    return shimKeys(object);\n\t  }\n\t  return isObject(object) ? nativeKeys(object) : [];\n\t};\n\t\n\t/**\n\t * Creates an array of the own and inherited enumerable property names of `object`.\n\t *\n\t * **Note:** Non-object values are coerced to objects.\n\t *\n\t * @static\n\t * @memberOf _\n\t * @category Object\n\t * @param {Object} object The object to query.\n\t * @returns {Array} Returns the array of property names.\n\t * @example\n\t *\n\t * function Foo() {\n\t *   this.a = 1;\n\t *   this.b = 2;\n\t * }\n\t *\n\t * Foo.prototype.c = 3;\n\t *\n\t * _.keysIn(new Foo);\n\t * // => ['a', 'b', 'c'] (iteration order is not guaranteed)\n\t */\n\tfunction keysIn(object) {\n\t  if (object == null) {\n\t    return [];\n\t  }\n\t  if (!isObject(object)) {\n\t    object = Object(object);\n\t  }\n\t  var length = object.length;\n\t  length = (length && isLength(length) &&\n\t    (isArray(object) || isArguments(object)) && length) || 0;\n\t\n\t  var Ctor = object.constructor,\n\t      index = -1,\n\t      isProto = typeof Ctor == 'function' && Ctor.prototype === object,\n\t      result = Array(length),\n\t      skipIndexes = length > 0;\n\t\n\t  while (++index < length) {\n\t    result[index] = (index + '');\n\t  }\n\t  for (var key in object) {\n\t    if (!(skipIndexes && isIndex(key, length)) &&\n\t        !(key == 'constructor' && (isProto || !hasOwnProperty.call(object, key)))) {\n\t      result.push(key);\n\t    }\n\t  }\n\t  return result;\n\t}\n\t\n\tmodule.exports = keys;\n\n\n/***/ },\n/* 14 */\n/***/ function(module, exports) {\n\n\t/**\n\t * lodash 3.9.1 (Custom Build) <https://lodash.com/>\n\t * Build: `lodash modern modularize exports=\"npm\" -o ./`\n\t * Copyright 2012-2015 The Dojo Foundation <http://dojofoundation.org/>\n\t * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n\t * Copyright 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n\t * Available under MIT license <https://lodash.com/license>\n\t */\n\t\n\t/** `Object#toString` result references. */\n\tvar funcTag = '[object Function]';\n\t\n\t/** Used to detect host constructors (Safari > 5). */\n\tvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\t\n\t/**\n\t * Checks if `value` is object-like.\n\t *\n\t * @private\n\t * @param {*} value The value to check.\n\t * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n\t */\n\tfunction isObjectLike(value) {\n\t  return !!value && typeof value == 'object';\n\t}\n\t\n\t/** Used for native method references. */\n\tvar objectProto = Object.prototype;\n\t\n\t/** Used to resolve the decompiled source of functions. */\n\tvar fnToString = Function.prototype.toString;\n\t\n\t/** Used to check objects for own properties. */\n\tvar hasOwnProperty = objectProto.hasOwnProperty;\n\t\n\t/**\n\t * Used to resolve the [`toStringTag`](http://ecma-international.org/ecma-262/6.0/#sec-object.prototype.tostring)\n\t * of values.\n\t */\n\tvar objToString = objectProto.toString;\n\t\n\t/** Used to detect if a method is native. */\n\tvar reIsNative = RegExp('^' +\n\t  fnToString.call(hasOwnProperty).replace(/[\\\\^$.*+?()[\\]{}|]/g, '\\\\$&')\n\t  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n\t);\n\t\n\t/**\n\t * Gets the native function at `key` of `object`.\n\t *\n\t * @private\n\t * @param {Object} object The object to query.\n\t * @param {string} key The key of the method to get.\n\t * @returns {*} Returns the function if it's native, else `undefined`.\n\t */\n\tfunction getNative(object, key) {\n\t  var value = object == null ? undefined : object[key];\n\t  return isNative(value) ? value : undefined;\n\t}\n\t\n\t/**\n\t * Checks if `value` is classified as a `Function` object.\n\t *\n\t * @static\n\t * @memberOf _\n\t * @category Lang\n\t * @param {*} value The value to check.\n\t * @returns {boolean} Returns `true` if `value` is correctly classified, else `false`.\n\t * @example\n\t *\n\t * _.isFunction(_);\n\t * // => true\n\t *\n\t * _.isFunction(/abc/);\n\t * // => false\n\t */\n\tfunction isFunction(value) {\n\t  // The use of `Object#toString` avoids issues with the `typeof` operator\n\t  // in older versions of Chrome and Safari which return 'function' for regexes\n\t  // and Safari 8 equivalents which return 'object' for typed array constructors.\n\t  return isObject(value) && objToString.call(value) == funcTag;\n\t}\n\t\n\t/**\n\t * Checks if `value` is the [language type](https://es5.github.io/#x8) of `Object`.\n\t * (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n\t *\n\t * @static\n\t * @memberOf _\n\t * @category Lang\n\t * @param {*} value The value to check.\n\t * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n\t * @example\n\t *\n\t * _.isObject({});\n\t * // => true\n\t *\n\t * _.isObject([1, 2, 3]);\n\t * // => true\n\t *\n\t * _.isObject(1);\n\t * // => false\n\t */\n\tfunction isObject(value) {\n\t  // Avoid a V8 JIT bug in Chrome 19-20.\n\t  // See https://code.google.com/p/v8/issues/detail?id=2291 for more details.\n\t  var type = typeof value;\n\t  return !!value && (type == 'object' || type == 'function');\n\t}\n\t\n\t/**\n\t * Checks if `value` is a native function.\n\t *\n\t * @static\n\t * @memberOf _\n\t * @category Lang\n\t * @param {*} value The value to check.\n\t * @returns {boolean} Returns `true` if `value` is a native function, else `false`.\n\t * @example\n\t *\n\t * _.isNative(Array.prototype.push);\n\t * // => true\n\t *\n\t * _.isNative(_);\n\t * // => false\n\t */\n\tfunction isNative(value) {\n\t  if (value == null) {\n\t    return false;\n\t  }\n\t  if (isFunction(value)) {\n\t    return reIsNative.test(fnToString.call(value));\n\t  }\n\t  return isObjectLike(value) && reIsHostCtor.test(value);\n\t}\n\t\n\tmodule.exports = getNative;\n\n\n/***/ },\n/* 15 */\n/***/ function(module, exports) {\n\n\t/**\n\t * lodash 3.0.4 (Custom Build) <https://lodash.com/>\n\t * Build: `lodash modern modularize exports=\"npm\" -o ./`\n\t * Copyright 2012-2015 The Dojo Foundation <http://dojofoundation.org/>\n\t * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n\t * Copyright 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n\t * Available under MIT license <https://lodash.com/license>\n\t */\n\t\n\t/**\n\t * Checks if `value` is object-like.\n\t *\n\t * @private\n\t * @param {*} value The value to check.\n\t * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n\t */\n\tfunction isObjectLike(value) {\n\t  return !!value && typeof value == 'object';\n\t}\n\t\n\t/** Used for native method references. */\n\tvar objectProto = Object.prototype;\n\t\n\t/** Used to check objects for own properties. */\n\tvar hasOwnProperty = objectProto.hasOwnProperty;\n\t\n\t/** Native method references. */\n\tvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\t\n\t/**\n\t * Used as the [maximum length](http://ecma-international.org/ecma-262/6.0/#sec-number.max_safe_integer)\n\t * of an array-like value.\n\t */\n\tvar MAX_SAFE_INTEGER = 9007199254740991;\n\t\n\t/**\n\t * The base implementation of `_.property` without support for deep paths.\n\t *\n\t * @private\n\t * @param {string} key The key of the property to get.\n\t * @returns {Function} Returns the new function.\n\t */\n\tfunction baseProperty(key) {\n\t  return function(object) {\n\t    return object == null ? undefined : object[key];\n\t  };\n\t}\n\t\n\t/**\n\t * Gets the \"length\" property value of `object`.\n\t *\n\t * **Note:** This function is used to avoid a [JIT bug](https://bugs.webkit.org/show_bug.cgi?id=142792)\n\t * that affects Safari on at least iOS 8.1-8.3 ARM64.\n\t *\n\t * @private\n\t * @param {Object} object The object to query.\n\t * @returns {*} Returns the \"length\" value.\n\t */\n\tvar getLength = baseProperty('length');\n\t\n\t/**\n\t * Checks if `value` is array-like.\n\t *\n\t * @private\n\t * @param {*} value The value to check.\n\t * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n\t */\n\tfunction isArrayLike(value) {\n\t  return value != null && isLength(getLength(value));\n\t}\n\t\n\t/**\n\t * Checks if `value` is a valid array-like length.\n\t *\n\t * **Note:** This function is based on [`ToLength`](http://ecma-international.org/ecma-262/6.0/#sec-tolength).\n\t *\n\t * @private\n\t * @param {*} value The value to check.\n\t * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n\t */\n\tfunction isLength(value) {\n\t  return typeof value == 'number' && value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n\t}\n\t\n\t/**\n\t * Checks if `value` is classified as an `arguments` object.\n\t *\n\t * @static\n\t * @memberOf _\n\t * @category Lang\n\t * @param {*} value The value to check.\n\t * @returns {boolean} Returns `true` if `value` is correctly classified, else `false`.\n\t * @example\n\t *\n\t * _.isArguments(function() { return arguments; }());\n\t * // => true\n\t *\n\t * _.isArguments([1, 2, 3]);\n\t * // => false\n\t */\n\tfunction isArguments(value) {\n\t  return isObjectLike(value) && isArrayLike(value) &&\n\t    hasOwnProperty.call(value, 'callee') && !propertyIsEnumerable.call(value, 'callee');\n\t}\n\t\n\tmodule.exports = isArguments;\n\n\n/***/ },\n/* 16 */\n/***/ function(module, exports) {\n\n\t/**\n\t * lodash 3.0.4 (Custom Build) <https://lodash.com/>\n\t * Build: `lodash modern modularize exports=\"npm\" -o ./`\n\t * Copyright 2012-2015 The Dojo Foundation <http://dojofoundation.org/>\n\t * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n\t * Copyright 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n\t * Available under MIT license <https://lodash.com/license>\n\t */\n\t\n\t/** `Object#toString` result references. */\n\tvar arrayTag = '[object Array]',\n\t    funcTag = '[object Function]';\n\t\n\t/** Used to detect host constructors (Safari > 5). */\n\tvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\t\n\t/**\n\t * Checks if `value` is object-like.\n\t *\n\t * @private\n\t * @param {*} value The value to check.\n\t * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n\t */\n\tfunction isObjectLike(value) {\n\t  return !!value && typeof value == 'object';\n\t}\n\t\n\t/** Used for native method references. */\n\tvar objectProto = Object.prototype;\n\t\n\t/** Used to resolve the decompiled source of functions. */\n\tvar fnToString = Function.prototype.toString;\n\t\n\t/** Used to check objects for own properties. */\n\tvar hasOwnProperty = objectProto.hasOwnProperty;\n\t\n\t/**\n\t * Used to resolve the [`toStringTag`](http://ecma-international.org/ecma-262/6.0/#sec-object.prototype.tostring)\n\t * of values.\n\t */\n\tvar objToString = objectProto.toString;\n\t\n\t/** Used to detect if a method is native. */\n\tvar reIsNative = RegExp('^' +\n\t  fnToString.call(hasOwnProperty).replace(/[\\\\^$.*+?()[\\]{}|]/g, '\\\\$&')\n\t  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n\t);\n\t\n\t/* Native method references for those with the same name as other `lodash` methods. */\n\tvar nativeIsArray = getNative(Array, 'isArray');\n\t\n\t/**\n\t * Used as the [maximum length](http://ecma-international.org/ecma-262/6.0/#sec-number.max_safe_integer)\n\t * of an array-like value.\n\t */\n\tvar MAX_SAFE_INTEGER = 9007199254740991;\n\t\n\t/**\n\t * Gets the native function at `key` of `object`.\n\t *\n\t * @private\n\t * @param {Object} object The object to query.\n\t * @param {string} key The key of the method to get.\n\t * @returns {*} Returns the function if it's native, else `undefined`.\n\t */\n\tfunction getNative(object, key) {\n\t  var value = object == null ? undefined : object[key];\n\t  return isNative(value) ? value : undefined;\n\t}\n\t\n\t/**\n\t * Checks if `value` is a valid array-like length.\n\t *\n\t * **Note:** This function is based on [`ToLength`](http://ecma-international.org/ecma-262/6.0/#sec-tolength).\n\t *\n\t * @private\n\t * @param {*} value The value to check.\n\t * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n\t */\n\tfunction isLength(value) {\n\t  return typeof value == 'number' && value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n\t}\n\t\n\t/**\n\t * Checks if `value` is classified as an `Array` object.\n\t *\n\t * @static\n\t * @memberOf _\n\t * @category Lang\n\t * @param {*} value The value to check.\n\t * @returns {boolean} Returns `true` if `value` is correctly classified, else `false`.\n\t * @example\n\t *\n\t * _.isArray([1, 2, 3]);\n\t * // => true\n\t *\n\t * _.isArray(function() { return arguments; }());\n\t * // => false\n\t */\n\tvar isArray = nativeIsArray || function(value) {\n\t  return isObjectLike(value) && isLength(value.length) && objToString.call(value) == arrayTag;\n\t};\n\t\n\t/**\n\t * Checks if `value` is classified as a `Function` object.\n\t *\n\t * @static\n\t * @memberOf _\n\t * @category Lang\n\t * @param {*} value The value to check.\n\t * @returns {boolean} Returns `true` if `value` is correctly classified, else `false`.\n\t * @example\n\t *\n\t * _.isFunction(_);\n\t * // => true\n\t *\n\t * _.isFunction(/abc/);\n\t * // => false\n\t */\n\tfunction isFunction(value) {\n\t  // The use of `Object#toString` avoids issues with the `typeof` operator\n\t  // in older versions of Chrome and Safari which return 'function' for regexes\n\t  // and Safari 8 equivalents which return 'object' for typed array constructors.\n\t  return isObject(value) && objToString.call(value) == funcTag;\n\t}\n\t\n\t/**\n\t * Checks if `value` is the [language type](https://es5.github.io/#x8) of `Object`.\n\t * (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n\t *\n\t * @static\n\t * @memberOf _\n\t * @category Lang\n\t * @param {*} value The value to check.\n\t * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n\t * @example\n\t *\n\t * _.isObject({});\n\t * // => true\n\t *\n\t * _.isObject([1, 2, 3]);\n\t * // => true\n\t *\n\t * _.isObject(1);\n\t * // => false\n\t */\n\tfunction isObject(value) {\n\t  // Avoid a V8 JIT bug in Chrome 19-20.\n\t  // See https://code.google.com/p/v8/issues/detail?id=2291 for more details.\n\t  var type = typeof value;\n\t  return !!value && (type == 'object' || type == 'function');\n\t}\n\t\n\t/**\n\t * Checks if `value` is a native function.\n\t *\n\t * @static\n\t * @memberOf _\n\t * @category Lang\n\t * @param {*} value The value to check.\n\t * @returns {boolean} Returns `true` if `value` is a native function, else `false`.\n\t * @example\n\t *\n\t * _.isNative(Array.prototype.push);\n\t * // => true\n\t *\n\t * _.isNative(_);\n\t * // => false\n\t */\n\tfunction isNative(value) {\n\t  if (value == null) {\n\t    return false;\n\t  }\n\t  if (isFunction(value)) {\n\t    return reIsNative.test(fnToString.call(value));\n\t  }\n\t  return isObjectLike(value) && reIsHostCtor.test(value);\n\t}\n\t\n\tmodule.exports = isArray;\n\n\n/***/ },\n/* 17 */\n/***/ function(module, exports) {\n\n\t/**\n\t * lodash 3.0.1 (Custom Build) <https://lodash.com/>\n\t * Build: `lodash modern modularize exports=\"npm\" -o ./`\n\t * Copyright 2012-2015 The Dojo Foundation <http://dojofoundation.org/>\n\t * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n\t * Copyright 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n\t * Available under MIT license <https://lodash.com/license>\n\t */\n\t\n\t/**\n\t * A specialized version of `baseCallback` which only supports `this` binding\n\t * and specifying the number of arguments to provide to `func`.\n\t *\n\t * @private\n\t * @param {Function} func The function to bind.\n\t * @param {*} thisArg The `this` binding of `func`.\n\t * @param {number} [argCount] The number of arguments to provide to `func`.\n\t * @returns {Function} Returns the callback.\n\t */\n\tfunction bindCallback(func, thisArg, argCount) {\n\t  if (typeof func != 'function') {\n\t    return identity;\n\t  }\n\t  if (thisArg === undefined) {\n\t    return func;\n\t  }\n\t  switch (argCount) {\n\t    case 1: return function(value) {\n\t      return func.call(thisArg, value);\n\t    };\n\t    case 3: return function(value, index, collection) {\n\t      return func.call(thisArg, value, index, collection);\n\t    };\n\t    case 4: return function(accumulator, value, index, collection) {\n\t      return func.call(thisArg, accumulator, value, index, collection);\n\t    };\n\t    case 5: return function(value, other, key, object, source) {\n\t      return func.call(thisArg, value, other, key, object, source);\n\t    };\n\t  }\n\t  return function() {\n\t    return func.apply(thisArg, arguments);\n\t  };\n\t}\n\t\n\t/**\n\t * This method returns the first argument provided to it.\n\t *\n\t * @static\n\t * @memberOf _\n\t * @category Utility\n\t * @param {*} value Any value.\n\t * @returns {*} Returns `value`.\n\t * @example\n\t *\n\t * var object = { 'user': 'fred' };\n\t *\n\t * _.identity(object) === object;\n\t * // => true\n\t */\n\tfunction identity(value) {\n\t  return value;\n\t}\n\t\n\tmodule.exports = bindCallback;\n\n\n/***/ },\n/* 18 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/**\n\t * lodash 3.2.0 (Custom Build) <https://lodash.com/>\n\t * Build: `lodash modern modularize exports=\"npm\" -o ./`\n\t * Copyright 2012-2015 The Dojo Foundation <http://dojofoundation.org/>\n\t * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n\t * Copyright 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n\t * Available under MIT license <https://lodash.com/license>\n\t */\n\tvar baseAssign = __webpack_require__(19),\n\t    createAssigner = __webpack_require__(21),\n\t    keys = __webpack_require__(13);\n\t\n\t/**\n\t * A specialized version of `_.assign` for customizing assigned values without\n\t * support for argument juggling, multiple sources, and `this` binding `customizer`\n\t * functions.\n\t *\n\t * @private\n\t * @param {Object} object The destination object.\n\t * @param {Object} source The source object.\n\t * @param {Function} customizer The function to customize assigned values.\n\t * @returns {Object} Returns `object`.\n\t */\n\tfunction assignWith(object, source, customizer) {\n\t  var index = -1,\n\t      props = keys(source),\n\t      length = props.length;\n\t\n\t  while (++index < length) {\n\t    var key = props[index],\n\t        value = object[key],\n\t        result = customizer(value, source[key], key, object, source);\n\t\n\t    if ((result === result ? (result !== value) : (value === value)) ||\n\t        (value === undefined && !(key in object))) {\n\t      object[key] = result;\n\t    }\n\t  }\n\t  return object;\n\t}\n\t\n\t/**\n\t * Assigns own enumerable properties of source object(s) to the destination\n\t * object. Subsequent sources overwrite property assignments of previous sources.\n\t * If `customizer` is provided it is invoked to produce the assigned values.\n\t * The `customizer` is bound to `thisArg` and invoked with five arguments:\n\t * (objectValue, sourceValue, key, object, source).\n\t *\n\t * **Note:** This method mutates `object` and is based on\n\t * [`Object.assign`](https://people.mozilla.org/~jorendorff/es6-draft.html#sec-object.assign).\n\t *\n\t * @static\n\t * @memberOf _\n\t * @alias extend\n\t * @category Object\n\t * @param {Object} object The destination object.\n\t * @param {...Object} [sources] The source objects.\n\t * @param {Function} [customizer] The function to customize assigned values.\n\t * @param {*} [thisArg] The `this` binding of `customizer`.\n\t * @returns {Object} Returns `object`.\n\t * @example\n\t *\n\t * _.assign({ 'user': 'barney' }, { 'age': 40 }, { 'user': 'fred' });\n\t * // => { 'user': 'fred', 'age': 40 }\n\t *\n\t * // using a customizer callback\n\t * var defaults = _.partialRight(_.assign, function(value, other) {\n\t *   return _.isUndefined(value) ? other : value;\n\t * });\n\t *\n\t * defaults({ 'user': 'barney' }, { 'age': 36 }, { 'user': 'fred' });\n\t * // => { 'user': 'barney', 'age': 36 }\n\t */\n\tvar assign = createAssigner(function(object, source, customizer) {\n\t  return customizer\n\t    ? assignWith(object, source, customizer)\n\t    : baseAssign(object, source);\n\t});\n\t\n\tmodule.exports = assign;\n\n\n/***/ },\n/* 19 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/**\n\t * lodash 3.2.0 (Custom Build) <https://lodash.com/>\n\t * Build: `lodash modern modularize exports=\"npm\" -o ./`\n\t * Copyright 2012-2015 The Dojo Foundation <http://dojofoundation.org/>\n\t * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n\t * Copyright 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n\t * Available under MIT license <https://lodash.com/license>\n\t */\n\tvar baseCopy = __webpack_require__(20),\n\t    keys = __webpack_require__(13);\n\t\n\t/**\n\t * The base implementation of `_.assign` without support for argument juggling,\n\t * multiple sources, and `customizer` functions.\n\t *\n\t * @private\n\t * @param {Object} object The destination object.\n\t * @param {Object} source The source object.\n\t * @returns {Object} Returns `object`.\n\t */\n\tfunction baseAssign(object, source) {\n\t  return source == null\n\t    ? object\n\t    : baseCopy(source, keys(source), object);\n\t}\n\t\n\tmodule.exports = baseAssign;\n\n\n/***/ },\n/* 20 */\n/***/ function(module, exports) {\n\n\t/**\n\t * lodash 3.0.1 (Custom Build) <https://lodash.com/>\n\t * Build: `lodash modern modularize exports=\"npm\" -o ./`\n\t * Copyright 2012-2015 The Dojo Foundation <http://dojofoundation.org/>\n\t * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n\t * Copyright 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n\t * Available under MIT license <https://lodash.com/license>\n\t */\n\t\n\t/**\n\t * Copies properties of `source` to `object`.\n\t *\n\t * @private\n\t * @param {Object} source The object to copy properties from.\n\t * @param {Array} props The property names to copy.\n\t * @param {Object} [object={}] The object to copy properties to.\n\t * @returns {Object} Returns `object`.\n\t */\n\tfunction baseCopy(source, props, object) {\n\t  object || (object = {});\n\t\n\t  var index = -1,\n\t      length = props.length;\n\t\n\t  while (++index < length) {\n\t    var key = props[index];\n\t    object[key] = source[key];\n\t  }\n\t  return object;\n\t}\n\t\n\tmodule.exports = baseCopy;\n\n\n/***/ },\n/* 21 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/**\n\t * lodash 3.1.1 (Custom Build) <https://lodash.com/>\n\t * Build: `lodash modern modularize exports=\"npm\" -o ./`\n\t * Copyright 2012-2015 The Dojo Foundation <http://dojofoundation.org/>\n\t * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n\t * Copyright 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n\t * Available under MIT license <https://lodash.com/license>\n\t */\n\tvar bindCallback = __webpack_require__(17),\n\t    isIterateeCall = __webpack_require__(22),\n\t    restParam = __webpack_require__(23);\n\t\n\t/**\n\t * Creates a function that assigns properties of source object(s) to a given\n\t * destination object.\n\t *\n\t * **Note:** This function is used to create `_.assign`, `_.defaults`, and `_.merge`.\n\t *\n\t * @private\n\t * @param {Function} assigner The function to assign values.\n\t * @returns {Function} Returns the new assigner function.\n\t */\n\tfunction createAssigner(assigner) {\n\t  return restParam(function(object, sources) {\n\t    var index = -1,\n\t        length = object == null ? 0 : sources.length,\n\t        customizer = length > 2 ? sources[length - 2] : undefined,\n\t        guard = length > 2 ? sources[2] : undefined,\n\t        thisArg = length > 1 ? sources[length - 1] : undefined;\n\t\n\t    if (typeof customizer == 'function') {\n\t      customizer = bindCallback(customizer, thisArg, 5);\n\t      length -= 2;\n\t    } else {\n\t      customizer = typeof thisArg == 'function' ? thisArg : undefined;\n\t      length -= (customizer ? 1 : 0);\n\t    }\n\t    if (guard && isIterateeCall(sources[0], sources[1], guard)) {\n\t      customizer = length < 3 ? undefined : customizer;\n\t      length = 1;\n\t    }\n\t    while (++index < length) {\n\t      var source = sources[index];\n\t      if (source) {\n\t        assigner(object, source, customizer);\n\t      }\n\t    }\n\t    return object;\n\t  });\n\t}\n\t\n\tmodule.exports = createAssigner;\n\n\n/***/ },\n/* 22 */\n/***/ function(module, exports) {\n\n\t/**\n\t * lodash 3.0.9 (Custom Build) <https://lodash.com/>\n\t * Build: `lodash modern modularize exports=\"npm\" -o ./`\n\t * Copyright 2012-2015 The Dojo Foundation <http://dojofoundation.org/>\n\t * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n\t * Copyright 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n\t * Available under MIT license <https://lodash.com/license>\n\t */\n\t\n\t/** Used to detect unsigned integer values. */\n\tvar reIsUint = /^\\d+$/;\n\t\n\t/**\n\t * Used as the [maximum length](https://people.mozilla.org/~jorendorff/es6-draft.html#sec-number.max_safe_integer)\n\t * of an array-like value.\n\t */\n\tvar MAX_SAFE_INTEGER = 9007199254740991;\n\t\n\t/**\n\t * The base implementation of `_.property` without support for deep paths.\n\t *\n\t * @private\n\t * @param {string} key The key of the property to get.\n\t * @returns {Function} Returns the new function.\n\t */\n\tfunction baseProperty(key) {\n\t  return function(object) {\n\t    return object == null ? undefined : object[key];\n\t  };\n\t}\n\t\n\t/**\n\t * Gets the \"length\" property value of `object`.\n\t *\n\t * **Note:** This function is used to avoid a [JIT bug](https://bugs.webkit.org/show_bug.cgi?id=142792)\n\t * that affects Safari on at least iOS 8.1-8.3 ARM64.\n\t *\n\t * @private\n\t * @param {Object} object The object to query.\n\t * @returns {*} Returns the \"length\" value.\n\t */\n\tvar getLength = baseProperty('length');\n\t\n\t/**\n\t * Checks if `value` is array-like.\n\t *\n\t * @private\n\t * @param {*} value The value to check.\n\t * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n\t */\n\tfunction isArrayLike(value) {\n\t  return value != null && isLength(getLength(value));\n\t}\n\t\n\t/**\n\t * Checks if `value` is a valid array-like index.\n\t *\n\t * @private\n\t * @param {*} value The value to check.\n\t * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n\t * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n\t */\n\tfunction isIndex(value, length) {\n\t  value = (typeof value == 'number' || reIsUint.test(value)) ? +value : -1;\n\t  length = length == null ? MAX_SAFE_INTEGER : length;\n\t  return value > -1 && value % 1 == 0 && value < length;\n\t}\n\t\n\t/**\n\t * Checks if the provided arguments are from an iteratee call.\n\t *\n\t * @private\n\t * @param {*} value The potential iteratee value argument.\n\t * @param {*} index The potential iteratee index or key argument.\n\t * @param {*} object The potential iteratee object argument.\n\t * @returns {boolean} Returns `true` if the arguments are from an iteratee call, else `false`.\n\t */\n\tfunction isIterateeCall(value, index, object) {\n\t  if (!isObject(object)) {\n\t    return false;\n\t  }\n\t  var type = typeof index;\n\t  if (type == 'number'\n\t      ? (isArrayLike(object) && isIndex(index, object.length))\n\t      : (type == 'string' && index in object)) {\n\t    var other = object[index];\n\t    return value === value ? (value === other) : (other !== other);\n\t  }\n\t  return false;\n\t}\n\t\n\t/**\n\t * Checks if `value` is a valid array-like length.\n\t *\n\t * **Note:** This function is based on [`ToLength`](https://people.mozilla.org/~jorendorff/es6-draft.html#sec-tolength).\n\t *\n\t * @private\n\t * @param {*} value The value to check.\n\t * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n\t */\n\tfunction isLength(value) {\n\t  return typeof value == 'number' && value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n\t}\n\t\n\t/**\n\t * Checks if `value` is the [language type](https://es5.github.io/#x8) of `Object`.\n\t * (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n\t *\n\t * @static\n\t * @memberOf _\n\t * @category Lang\n\t * @param {*} value The value to check.\n\t * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n\t * @example\n\t *\n\t * _.isObject({});\n\t * // => true\n\t *\n\t * _.isObject([1, 2, 3]);\n\t * // => true\n\t *\n\t * _.isObject(1);\n\t * // => false\n\t */\n\tfunction isObject(value) {\n\t  // Avoid a V8 JIT bug in Chrome 19-20.\n\t  // See https://code.google.com/p/v8/issues/detail?id=2291 for more details.\n\t  var type = typeof value;\n\t  return !!value && (type == 'object' || type == 'function');\n\t}\n\t\n\tmodule.exports = isIterateeCall;\n\n\n/***/ },\n/* 23 */\n/***/ function(module, exports) {\n\n\t/**\n\t * lodash 3.6.1 (Custom Build) <https://lodash.com/>\n\t * Build: `lodash modern modularize exports=\"npm\" -o ./`\n\t * Copyright 2012-2015 The Dojo Foundation <http://dojofoundation.org/>\n\t * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n\t * Copyright 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n\t * Available under MIT license <https://lodash.com/license>\n\t */\n\t\n\t/** Used as the `TypeError` message for \"Functions\" methods. */\n\tvar FUNC_ERROR_TEXT = 'Expected a function';\n\t\n\t/* Native method references for those with the same name as other `lodash` methods. */\n\tvar nativeMax = Math.max;\n\t\n\t/**\n\t * Creates a function that invokes `func` with the `this` binding of the\n\t * created function and arguments from `start` and beyond provided as an array.\n\t *\n\t * **Note:** This method is based on the [rest parameter](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/rest_parameters).\n\t *\n\t * @static\n\t * @memberOf _\n\t * @category Function\n\t * @param {Function} func The function to apply a rest parameter to.\n\t * @param {number} [start=func.length-1] The start position of the rest parameter.\n\t * @returns {Function} Returns the new function.\n\t * @example\n\t *\n\t * var say = _.restParam(function(what, names) {\n\t *   return what + ' ' + _.initial(names).join(', ') +\n\t *     (_.size(names) > 1 ? ', & ' : '') + _.last(names);\n\t * });\n\t *\n\t * say('hello', 'fred', 'barney', 'pebbles');\n\t * // => 'hello fred, barney, & pebbles'\n\t */\n\tfunction restParam(func, start) {\n\t  if (typeof func != 'function') {\n\t    throw new TypeError(FUNC_ERROR_TEXT);\n\t  }\n\t  start = nativeMax(start === undefined ? (func.length - 1) : (+start || 0), 0);\n\t  return function() {\n\t    var args = arguments,\n\t        index = -1,\n\t        length = nativeMax(args.length - start, 0),\n\t        rest = Array(length);\n\t\n\t    while (++index < length) {\n\t      rest[index] = args[start + index];\n\t    }\n\t    switch (start) {\n\t      case 0: return func.call(this, rest);\n\t      case 1: return func.call(this, args[0], rest);\n\t      case 2: return func.call(this, args[0], args[1], rest);\n\t    }\n\t    var otherArgs = Array(start + 1);\n\t    index = -1;\n\t    while (++index < start) {\n\t      otherArgs[index] = args[index];\n\t    }\n\t    otherArgs[start] = rest;\n\t    return func.apply(this, otherArgs);\n\t  };\n\t}\n\t\n\tmodule.exports = restParam;\n\n\n/***/ },\n/* 24 */\n/***/ function(module, exports) {\n\n\tmodule.exports = new RegExp(\n\t\t'^' +\n\t\n\t\t// protocol identifier\n\t\t'(?:(?:(?:https?):)?//)' +\n\t\n\t\t// user:pass authentication\n\t\t'(?:\\\\S+(?::\\\\S*)?@)?' +\n\t\t'(?:' +\n\t\n\t\t// IP address exclusion\n\t\t// private & local networks\n\t\t'(' +\n\t\t'(?!(?:10|127)(?:\\\\.\\\\d{1,3}){3})' +\n\t\t'(?!(?:169\\\\.254|192\\\\.168)(?:\\\\.\\\\d{1,3}){2})' +\n\t\t'(?!172\\\\.(?:1[6-9]|2\\\\d|3[0-1])(?:\\\\.\\\\d{1,3}){2})' +\n\t\n\t\t// IP address dotted notation octets\n\t\t// excludes loopback network 0.0.0.0\n\t\t// excludes reserved space >= 224.0.0.0\n\t\t// excludes network & broacast addresses\n\t\t// (first & last IP address of each class)\n\t\t'(?:[1-9]\\\\d?|1\\\\d\\\\d|2[01]\\\\d|22[0-3])' +\n\t\t'(?:\\\\.(?:1?\\\\d{1,2}|2[0-4]\\\\d|25[0-5])){2}' +\n\t\t'(?:\\\\.(?:[1-9]\\\\d?|1\\\\d\\\\d|2[0-4]\\\\d|25[0-4]))' +\n\t\t'|' +\n\t\n\t\t// host name\n\t\t'(?:(?:[a-z\\\\u00a1-\\\\uffff0-9]-*)*[a-z\\\\u00a1-\\\\uffff0-9]+)' +\n\t\n\t\t// domain name\n\t\t'(?:\\\\.(?:[a-z\\\\u00a1-\\\\uffff0-9]-*)*[a-z\\\\u00a1-\\\\uffff0-9]+)*' +\n\t\n\t\t// TLD identifier\n\t\t'(?:\\\\.(?:[a-z\\\\u00a1-\\\\uffff]{2,}))?' +\n\t\t')' +\n\t\n\t\t')' +\n\t\n\t\t// port number\n\t\t'(?::(\\\\d{2,5}))?' +\n\t\n\t\t// resource path\n\t\t'(?:/\\\\S*)?' +\n\t\t'$', 'i'\n\t);\n\n\n/***/ },\n/* 25 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar map = {\n\t\t\"./asphalt.jpg\": 26,\n\t\t\"./brick-tiles.jpg\": 27,\n\t\t\"./bricks-normal.jpg\": 28,\n\t\t\"./bricks-specular.jpg\": 29,\n\t\t\"./bricks.jpg\": 30,\n\t\t\"./checkerboard.png\": 31,\n\t\t\"./grass.jpg\": 32,\n\t\t\"./metal-floor.jpg\": 33,\n\t\t\"./metal.jpg\": 34,\n\t\t\"./stone.jpg\": 35,\n\t\t\"./tiles.jpg\": 36,\n\t\t\"./weathered-wood.jpg\": 37,\n\t\t\"./wood.jpg\": 38\n\t};\n\tfunction webpackContext(req) {\n\t\treturn __webpack_require__(webpackContextResolve(req));\n\t};\n\tfunction webpackContextResolve(req) {\n\t\treturn map[req] || (function() { throw new Error(\"Cannot find module '\" + req + \"'.\") }());\n\t};\n\twebpackContext.keys = function webpackContextKeys() {\n\t\treturn Object.keys(map);\n\t};\n\twebpackContext.resolve = webpackContextResolve;\n\tmodule.exports = webpackContext;\n\twebpackContext.id = 25;\n\n\n/***/ },\n/* 26 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__.p + \"image/asphalt.jpg\"\n\n/***/ },\n/* 27 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__.p + \"image/brick-tiles.jpg\"\n\n/***/ },\n/* 28 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__.p + \"image/bricks-normal.jpg\"\n\n/***/ },\n/* 29 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__.p + \"image/bricks-specular.jpg\"\n\n/***/ },\n/* 30 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__.p + \"image/bricks.jpg\"\n\n/***/ },\n/* 31 */\n/***/ function(module, exports) {\n\n\tmodule.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEAAQMAAABmvDolAAAABlBMVEUsLCzp6enLhVdXAAAAAWJLR0QAiAUdSAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB94KFBIOCP7R3TQAAAA4SURBVGje7dAhEgAACMOw/f/T4Gc5XKqjmlRTBQAAAAAAAAAAAAAA4AiMAQAAAAAAAAAAAADgGSyKafDiEFszywAAAABJRU5ErkJggg==\"\n\n/***/ },\n/* 32 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__.p + \"image/grass.jpg\"\n\n/***/ },\n/* 33 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__.p + \"image/metal-floor.jpg\"\n\n/***/ },\n/* 34 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__.p + \"image/metal.jpg\"\n\n/***/ },\n/* 35 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__.p + \"image/stone.jpg\"\n\n/***/ },\n/* 36 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__.p + \"image/tiles.jpg\"\n\n/***/ },\n/* 37 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__.p + \"image/weathered-wood.jpg\"\n\n/***/ },\n/* 38 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__.p + \"image/wood.jpg\"\n\n/***/ },\n/* 39 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = (function () {\n\t\t'use strict';\n\t\n\t\tvar\tNEAR_DISTANCE = 3,\n\t\t\tmaterials = __webpack_require__(8),\n\t\t\tTHREE = __webpack_require__(9),\n\t\t\teventEmitter = __webpack_require__(40),\n\t\n\t\t\txAxis = new THREE.Vector3(1, 0, 0),\n\t\t\tyAxis = new THREE.Vector3(0, 1, 0),\n\t\t\tzAxis = new THREE.Vector3(0, 0, 1),\n\t\n\t\t\tscratchVector1 = new THREE.Vector3(),\n\t\t\tscratchVector2 = new THREE.Vector3(),\n\t\n\t\t\tallObjects = window.WeakMap ? new window.WeakMap() : {};\n\t\n\t\tfunction distance(object, origin) {\n\t\t\tvar geometry;\n\t\n\t\t\tgeometry = object.geometry;\n\t\n\t\t\t//assumes object world matrix has been updated\n\t\t\tscratchVector1.setFromMatrixPosition(origin.matrixWorld);\n\t\n\t\t\tif (!geometry) {\n\t\t\t\t//first convert to world coordinate\n\t\t\t\tscratchVector2.setFromMatrixPosition(object.matrixWorld);\n\t\t\t\treturn scratchVector2.distanceTo(scratchVector1);\n\t\t\t}\n\t\n\t\t\tobject.worldToLocal(scratchVector1);\n\t\t\treturn object.geometry.boundingBox.distanceToPoint(scratchVector1);\n\t\t}\n\t\n\t\tfunction VRObject(parent, creator, body, options) {\n\t\t\tvar material,\n\t\t\t\tobject,\n\t\t\t\tself = this,\n\t\n\t\t\t\tisNear = false,\n\t\t\t\tisTarget = false,\n\t\n\t\t\t\tcamera = body && (function () {\n\t\t\t\t\tvar i,\n\t\t\t\t\t\tc;\n\t\t\t\t\tfor (i = 0; i < body.children.length; i++) {\n\t\t\t\t\t\tc = body.children[i];\n\t\t\t\t\t\tif (c instanceof THREE.PerspectiveCamera) {\n\t\t\t\t\t\t\treturn c;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}()),\n\t\t\t\tfrustum,\n\t\t\t\tcameraViewProjectionMatrix,\n\t\n\t\t\t\traycaster;\n\t\n\t\t\toptions = options || {};\n\t\n\t\t\teventEmitter(this);\n\t\n\t\t\tif (body) {\n\t\t\t\t// raycaster = new THREE.Raycaster();\n\t\n\t\t\t\tthis.update = function () {\n\t\t\t\t\tvar wasNear = isNear,\n\t\t\t\t\t\twasTarget = isTarget,\n\t\n\t\t\t\t\t\tintersects, intersect, i;\n\t\n\t\t\t\t\tisNear = self.distance < NEAR_DISTANCE;\n\t\t\t\t\tif (isNear !== wasNear) {\n\t\t\t\t\t\tif (isNear) {\n\t\t\t\t\t\t\tself.emit('near', self);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tself.emit('far', self);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t\t/*\n\t\t\t\t\traycaster.ray.origin.copy(origin);\n\t\t\t\t\traycaster.ray.direction.set(0, 0, 0.5).unproject(camera).sub(origin).normalize();\n\t\n\t\t\t\t\t//todo: consider whether this needs to be recursive. maybe a different event\n\t\t\t\t\tintersects = raycaster.intersectObject(object);\n\t\t\t\t\tif (intersects.length) {\n\t\t\t\t\t\tisTarget = true;\n\t\t\t\t\t\tif (!wasTarget) {\n\t\t\t\t\t\t\tself.emit('target-on', intersects[0]);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (wasTarget) {\n\t\t\t\t\t\tself.emit('target-off');\n\t\t\t\t\t}\n\t\t\t\t\t*/\n\t\t\t\t};\n\t\t\t}\n\t\n\t\t\t//todo: get material from options\n\t\t\tthis.object = object = creator.call(this, parent, options);\n\t\t\tthis.parent = this.object.parent || parent;\n\t\n\t\t\tif (object instanceof THREE.Mesh) {\n\t\t\t\tif (options.castShadow !== false) {\n\t\t\t\t\tobject.castShadow = true;\n\t\t\t\t}\n\t\t\t\tif (options.receiveShadow !== false) {\n\t\t\t\t\tobject.receiveShadow = true;\n\t\t\t\t}\n\t\n\t\t\t\tif (object.geometry) {\n\t\t\t\t\tobject.geometry.computeBoundingBox();\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tif (options.name !== undefined) {\n\t\t\t\tobject.name = options.name;\n\t\t\t}\n\t\t\tself.name = object.name;\n\t\n\t\t\tif (allObjects.set) {\n\t\t\t\tallObjects.set(object, this);\n\t\t\t} else {\n\t\t\t\tallObjects[object.id] = this;\n\t\t\t}\n\t\n\t\t\tobject.position.set(\n\t\t\t\tparseFloat(options.x) || 0,\n\t\t\t\tparseFloat(options.y) || 0,\n\t\t\t\tparseFloat(options.z) || 0\n\t\t\t);\n\t\n\t\t\tthis.setMaterial(options.material);\n\t\n\t\t\tif (options.color) {\n\t\t\t\tmaterial = object.material;\n\t\t\t\tmaterial.color = new THREE.Color(options.color);\n\t\t\t\tmaterial.ambient = material.color;\n\t\t\t}\n\t\n\t\t\t['position', 'scale', 'rotation', 'quaternion', 'material'].forEach(function (prop) {\n\t\t\t\tif (prop in object && !self[prop]) {\n\t\t\t\t\tself[prop] = object[prop];\n\t\t\t\t}\n\t\t\t});\n\t\n\t\t\tObject.defineProperty(this, 'visible', {\n\t\t\t\tset: function (val) {\n\t\t\t\t\tself.object.visible = !!val;\n\t\t\t\t},\n\t\t\t\tget: function () {\n\t\t\t\t\treturn self.object.visible;\n\t\t\t\t}\n\t\t\t});\n\t\n\t\t\tObject.defineProperty(this, 'distance', {\n\t\t\t\tget: function () {\n\t\t\t\t\treturn distance(self.object, body || parent);\n\t\t\t\t}\n\t\t\t});\n\t\n\t\t\tif (camera) {\n\t\t\t\tfrustum = new THREE.Frustum();\n\t\t\t\tcameraViewProjectionMatrix = new THREE.Matrix4();\n\t\t\t\tObject.defineProperty(this, 'inView', {\n\t\t\t\t\tget: function () {\n\t\t\t\t\t\tcamera.updateMatrixWorld(); // make sure the camera matrix is updated\n\t\t\t\t\t\tcamera.matrixWorldInverse.getInverse(camera.matrixWorld);\n\t\t\t\t\t\tcameraViewProjectionMatrix.multiplyMatrices(camera.projectionMatrix, camera.matrixWorldInverse);\n\t\t\t\t\t\tfrustum.setFromMatrix(cameraViewProjectionMatrix);\n\t\t\t\t\t\treturn frustum.intersectsObject(self.object);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\n\t\tVRObject.prototype.hide = function () {\n\t\t\tthis.object.visible = false;\n\t\t\treturn this;\n\t\t};\n\t\n\t\tVRObject.prototype.show = function () {\n\t\t\tthis.object.visible = true;\n\t\t\treturn this;\n\t\t};\n\t\n\t\tVRObject.prototype.moveTo = function (x, y, z) {\n\t\t\tvar position = this.object.position;\n\t\n\t\t\tx = !isNaN(x) ? x : position.x;\n\t\t\ty = !isNaN(y) ? y : position.y;\n\t\t\tz = !isNaN(z) ? z : position.z;\n\t\n\t\t\tposition.set(x, y, z);\n\t\n\t\t\treturn this;\n\t\t};\n\t\n\t\tVRObject.prototype.moveX = function (distance) {\n\t\t\tthis.object.translateX(distance);\n\t\t\treturn this;\n\t\t};\n\t\n\t\tVRObject.prototype.moveY = function (distance) {\n\t\t\tthis.object.translateY(distance);\n\t\t\treturn this;\n\t\t};\n\t\tVRObject.prototype.moveUp = VRObject.prototype.moveY;\n\t\tVRObject.prototype.moveDown = function (distance) {\n\t\t\tthis.moveY(-distance);\n\t\t\treturn this;\n\t\t};\n\t\n\t\tVRObject.prototype.moveZ = function (distance) {\n\t\t\tthis.object.translateZ(distance);\n\t\t\treturn this;\n\t\t};\n\t\n\t\tVRObject.prototype.rotateX = function (angle) {\n\t\t\tthis.object.rotateOnAxis(xAxis, angle);\n\t\t\treturn this;\n\t\t};\n\t\n\t\tVRObject.prototype.rotateY = function (angle) {\n\t\t\tthis.object.rotateOnAxis(yAxis, angle);\n\t\t\treturn this;\n\t\t};\n\t\n\t\tVRObject.prototype.rotateZ = function (angle) {\n\t\t\tthis.object.rotateOnAxis(zAxis, angle);\n\t\t\treturn this;\n\t\t};\n\t\n\t\tVRObject.prototype.setScale = function (x, y, z) {\n\t\t\tvar scale = this.object.scale;\n\t\n\t\t\tif (x !== undefined && !isNaN(x)) {\n\t\t\t\tif (y === undefined && z === undefined) {\n\t\t\t\t\ty = z = x;\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tx = !isNaN(x) ? x : scale.x;\n\t\t\ty = !isNaN(y) ? y : scale.y;\n\t\t\tz = !isNaN(z) ? z : scale.z;\n\t\n\t\t\tscale.set(x, y, z);\n\t\n\t\t\treturn this;\n\t\t};\n\t\n\t\tVRObject.prototype.setMaterial = function (material, options) {\n\t\t\tif (material && this.object instanceof THREE.Mesh) {\n\t\t\t\tif (typeof material === 'function') {\n\t\t\t\t\tmaterial = material();\n\t\t\t\t} else if (typeof material === 'string' && materials[material]) {\n\t\t\t\t\tmaterial = materials[material](options);\n\t\t\t\t} else if (material && !(material instanceof THREE.Material) && typeof material !== 'number') {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tmaterial = materials.material(material);\n\t\t\t\t\t} catch (e) {}\n\t\t\t\t}\n\t\n\t\t\t\tif (material instanceof THREE.Material) {\n\t\t\t\t\tthis.object.material = material;\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\treturn this;\n\t\t};\n\t\n\t\tVRObject.prototype.update = function () {};\n\t\n\t\tVRObject.prototype.raycastable = true;\n\t\n\t\tVRObject.repeat = function (count, options) {\n\t\t\tvar i,\n\t\t\t\tchange = false,\n\t\t\t\tlastObject = this,\n\t\t\t\tcurrentPosition = new THREE.Vector3(),\n\t\t\t\tdeltaPosition = new THREE.Vector3(),\n\t\t\t\tcurrentQuaternion = new THREE.Quaternion(),\n\t\t\t\tdeltaQuaternion = new THREE.Quaternion();\n\t\n\t\t\tif (!options) {\n\t\t\t\treturn;\n\t\t\t}\n\t\n\t\t\tif (options.offset) {}\n\t\n\t\t\tfor (i = 0; i < count; i++) {\n\t\n\t\t\t}\n\t\t};\n\t\n\t\tVRObject.findObject = function (object) {\n\t\t\tif (object instanceof VRObject) {\n\t\t\t\treturn object;\n\t\t\t}\n\t\n\t\t\tif (object && object instanceof THREE.Object3D) {\n\t\t\t\tif (allObjects.get) {\n\t\t\t\t\treturn allObjects.get(object);\n\t\t\t\t}\n\t\n\t\t\t\treturn allObjects[object.id];\n\t\t\t}\n\t\n\t\t\t// if (typeof object === 'number') {\n\t\t\t// \treturn allObjects[object];\n\t\t\t// }\n\t\t};\n\t\n\t\treturn VRObject;\n\t\n\t}());\n\n/***/ },\n/* 40 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar d        = __webpack_require__(41)\n\t  , callable = __webpack_require__(54)\n\t\n\t  , apply = Function.prototype.apply, call = Function.prototype.call\n\t  , create = Object.create, defineProperty = Object.defineProperty\n\t  , defineProperties = Object.defineProperties\n\t  , hasOwnProperty = Object.prototype.hasOwnProperty\n\t  , descriptor = { configurable: true, enumerable: false, writable: true }\n\t\n\t  , on, once, off, emit, methods, descriptors, base;\n\t\n\ton = function (type, listener) {\n\t\tvar data;\n\t\n\t\tcallable(listener);\n\t\n\t\tif (!hasOwnProperty.call(this, '__ee__')) {\n\t\t\tdata = descriptor.value = create(null);\n\t\t\tdefineProperty(this, '__ee__', descriptor);\n\t\t\tdescriptor.value = null;\n\t\t} else {\n\t\t\tdata = this.__ee__;\n\t\t}\n\t\tif (!data[type]) data[type] = listener;\n\t\telse if (typeof data[type] === 'object') data[type].push(listener);\n\t\telse data[type] = [data[type], listener];\n\t\n\t\treturn this;\n\t};\n\t\n\tonce = function (type, listener) {\n\t\tvar once, self;\n\t\n\t\tcallable(listener);\n\t\tself = this;\n\t\ton.call(this, type, once = function () {\n\t\t\toff.call(self, type, once);\n\t\t\tapply.call(listener, this, arguments);\n\t\t});\n\t\n\t\tonce.__eeOnceListener__ = listener;\n\t\treturn this;\n\t};\n\t\n\toff = function (type, listener) {\n\t\tvar data, listeners, candidate, i;\n\t\n\t\tcallable(listener);\n\t\n\t\tif (!hasOwnProperty.call(this, '__ee__')) return this;\n\t\tdata = this.__ee__;\n\t\tif (!data[type]) return this;\n\t\tlisteners = data[type];\n\t\n\t\tif (typeof listeners === 'object') {\n\t\t\tfor (i = 0; (candidate = listeners[i]); ++i) {\n\t\t\t\tif ((candidate === listener) ||\n\t\t\t\t\t\t(candidate.__eeOnceListener__ === listener)) {\n\t\t\t\t\tif (listeners.length === 2) data[type] = listeners[i ? 0 : 1];\n\t\t\t\t\telse listeners.splice(i, 1);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif ((listeners === listener) ||\n\t\t\t\t\t(listeners.__eeOnceListener__ === listener)) {\n\t\t\t\tdelete data[type];\n\t\t\t}\n\t\t}\n\t\n\t\treturn this;\n\t};\n\t\n\temit = function (type) {\n\t\tvar i, l, listener, listeners, args;\n\t\n\t\tif (!hasOwnProperty.call(this, '__ee__')) return;\n\t\tlisteners = this.__ee__[type];\n\t\tif (!listeners) return;\n\t\n\t\tif (typeof listeners === 'object') {\n\t\t\tl = arguments.length;\n\t\t\targs = new Array(l - 1);\n\t\t\tfor (i = 1; i < l; ++i) args[i - 1] = arguments[i];\n\t\n\t\t\tlisteners = listeners.slice();\n\t\t\tfor (i = 0; (listener = listeners[i]); ++i) {\n\t\t\t\tapply.call(listener, this, args);\n\t\t\t}\n\t\t} else {\n\t\t\tswitch (arguments.length) {\n\t\t\tcase 1:\n\t\t\t\tcall.call(listeners, this);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tcall.call(listeners, this, arguments[1]);\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\tcall.call(listeners, this, arguments[1], arguments[2]);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tl = arguments.length;\n\t\t\t\targs = new Array(l - 1);\n\t\t\t\tfor (i = 1; i < l; ++i) {\n\t\t\t\t\targs[i - 1] = arguments[i];\n\t\t\t\t}\n\t\t\t\tapply.call(listeners, this, args);\n\t\t\t}\n\t\t}\n\t};\n\t\n\tmethods = {\n\t\ton: on,\n\t\tonce: once,\n\t\toff: off,\n\t\temit: emit\n\t};\n\t\n\tdescriptors = {\n\t\ton: d(on),\n\t\tonce: d(once),\n\t\toff: d(off),\n\t\temit: d(emit)\n\t};\n\t\n\tbase = defineProperties({}, descriptors);\n\t\n\tmodule.exports = exports = function (o) {\n\t\treturn (o == null) ? create(base) : defineProperties(Object(o), descriptors);\n\t};\n\texports.methods = methods;\n\n\n/***/ },\n/* 41 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar assign        = __webpack_require__(42)\n\t  , normalizeOpts = __webpack_require__(49)\n\t  , isCallable    = __webpack_require__(50)\n\t  , contains      = __webpack_require__(51)\n\t\n\t  , d;\n\t\n\td = module.exports = function (dscr, value/*, options*/) {\n\t\tvar c, e, w, options, desc;\n\t\tif ((arguments.length < 2) || (typeof dscr !== 'string')) {\n\t\t\toptions = value;\n\t\t\tvalue = dscr;\n\t\t\tdscr = null;\n\t\t} else {\n\t\t\toptions = arguments[2];\n\t\t}\n\t\tif (dscr == null) {\n\t\t\tc = w = true;\n\t\t\te = false;\n\t\t} else {\n\t\t\tc = contains.call(dscr, 'c');\n\t\t\te = contains.call(dscr, 'e');\n\t\t\tw = contains.call(dscr, 'w');\n\t\t}\n\t\n\t\tdesc = { value: value, configurable: c, enumerable: e, writable: w };\n\t\treturn !options ? desc : assign(normalizeOpts(options), desc);\n\t};\n\t\n\td.gs = function (dscr, get, set/*, options*/) {\n\t\tvar c, e, options, desc;\n\t\tif (typeof dscr !== 'string') {\n\t\t\toptions = set;\n\t\t\tset = get;\n\t\t\tget = dscr;\n\t\t\tdscr = null;\n\t\t} else {\n\t\t\toptions = arguments[3];\n\t\t}\n\t\tif (get == null) {\n\t\t\tget = undefined;\n\t\t} else if (!isCallable(get)) {\n\t\t\toptions = get;\n\t\t\tget = set = undefined;\n\t\t} else if (set == null) {\n\t\t\tset = undefined;\n\t\t} else if (!isCallable(set)) {\n\t\t\toptions = set;\n\t\t\tset = undefined;\n\t\t}\n\t\tif (dscr == null) {\n\t\t\tc = true;\n\t\t\te = false;\n\t\t} else {\n\t\t\tc = contains.call(dscr, 'c');\n\t\t\te = contains.call(dscr, 'e');\n\t\t}\n\t\n\t\tdesc = { get: get, set: set, configurable: c, enumerable: e };\n\t\treturn !options ? desc : assign(normalizeOpts(options), desc);\n\t};\n\n\n/***/ },\n/* 42 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tmodule.exports = __webpack_require__(43)()\n\t\t? Object.assign\n\t\t: __webpack_require__(44);\n\n\n/***/ },\n/* 43 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tmodule.exports = function () {\n\t\tvar assign = Object.assign, obj;\n\t\tif (typeof assign !== 'function') return false;\n\t\tobj = { foo: 'raz' };\n\t\tassign(obj, { bar: 'dwa' }, { trzy: 'trzy' });\n\t\treturn (obj.foo + obj.bar + obj.trzy) === 'razdwatrzy';\n\t};\n\n\n/***/ },\n/* 44 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar keys  = __webpack_require__(45)\n\t  , value = __webpack_require__(48)\n\t\n\t  , max = Math.max;\n\t\n\tmodule.exports = function (dest, src/*, srcn*/) {\n\t\tvar error, i, l = max(arguments.length, 2), assign;\n\t\tdest = Object(value(dest));\n\t\tassign = function (key) {\n\t\t\ttry { dest[key] = src[key]; } catch (e) {\n\t\t\t\tif (!error) error = e;\n\t\t\t}\n\t\t};\n\t\tfor (i = 1; i < l; ++i) {\n\t\t\tsrc = arguments[i];\n\t\t\tkeys(src).forEach(assign);\n\t\t}\n\t\tif (error !== undefined) throw error;\n\t\treturn dest;\n\t};\n\n\n/***/ },\n/* 45 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tmodule.exports = __webpack_require__(46)()\n\t\t? Object.keys\n\t\t: __webpack_require__(47);\n\n\n/***/ },\n/* 46 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tmodule.exports = function () {\n\t\ttry {\n\t\t\tObject.keys('primitive');\n\t\t\treturn true;\n\t\t} catch (e) { return false; }\n\t};\n\n\n/***/ },\n/* 47 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tvar keys = Object.keys;\n\t\n\tmodule.exports = function (object) {\n\t\treturn keys(object == null ? object : Object(object));\n\t};\n\n\n/***/ },\n/* 48 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tmodule.exports = function (value) {\n\t\tif (value == null) throw new TypeError(\"Cannot use null or undefined\");\n\t\treturn value;\n\t};\n\n\n/***/ },\n/* 49 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tvar forEach = Array.prototype.forEach, create = Object.create;\n\t\n\tvar process = function (src, obj) {\n\t\tvar key;\n\t\tfor (key in src) obj[key] = src[key];\n\t};\n\t\n\tmodule.exports = function (options/*, options*/) {\n\t\tvar result = create(null);\n\t\tforEach.call(arguments, function (options) {\n\t\t\tif (options == null) return;\n\t\t\tprocess(Object(options), result);\n\t\t});\n\t\treturn result;\n\t};\n\n\n/***/ },\n/* 50 */\n/***/ function(module, exports) {\n\n\t// Deprecated\n\t\n\t'use strict';\n\t\n\tmodule.exports = function (obj) { return typeof obj === 'function'; };\n\n\n/***/ },\n/* 51 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tmodule.exports = __webpack_require__(52)()\n\t\t? String.prototype.contains\n\t\t: __webpack_require__(53);\n\n\n/***/ },\n/* 52 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tvar str = 'razdwatrzy';\n\t\n\tmodule.exports = function () {\n\t\tif (typeof str.contains !== 'function') return false;\n\t\treturn ((str.contains('dwa') === true) && (str.contains('foo') === false));\n\t};\n\n\n/***/ },\n/* 53 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tvar indexOf = String.prototype.indexOf;\n\t\n\tmodule.exports = function (searchString/*, position*/) {\n\t\treturn indexOf.call(this, searchString, arguments[1]) > -1;\n\t};\n\n\n/***/ },\n/* 54 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tmodule.exports = function (fn) {\n\t\tif (typeof fn !== 'function') throw new TypeError(fn + \" is not a function\");\n\t\treturn fn;\n\t};\n\n\n/***/ },\n/* 55 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = (function () {\n\t\t'use strict';\n\t\n\t\tvar materials = __webpack_require__(8),\n\t\t\tTHREE = __webpack_require__(9);\n\t\n\t\treturn function empty(parent, options) {\n\t\t\tvar obj = new THREE.Object3D();\n\t\n\t\t\tobj.name = 'empty';\n\t\n\t\t\tparent.add(obj);\n\t\n\t\t\treturn obj;\n\t\t};\n\t}());\n\n/***/ },\n/* 56 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/*** IMPORTS FROM imports-loader ***/\n\tvar THREE = __webpack_require__(9);\n\t\n\t/**\n\t * @author richt / http://richt.me\n\t * @author WestLangley / http://github.com/WestLangley\n\t *\n\t * W3C Device Orientation control (http://w3c.github.io/deviceorientation/spec-source-orientation.html)\n\t */\n\t\n\tTHREE.DeviceOrientationControls = function ( object ) {\n\t\n\t\tvar scope = this;\n\t\n\t\tthis.object = object;\n\t\tthis.object.rotation.reorder( \"YXZ\" );\n\t\n\t\tthis.enabled = true;\n\t\n\t\tthis.deviceOrientation = {};\n\t\tthis.screenOrientation = 0;\n\t\n\t\tvar onDeviceOrientationChangeEvent = function ( event ) {\n\t\n\t\t\tscope.deviceOrientation = event;\n\t\n\t\t};\n\t\n\t\tvar onScreenOrientationChangeEvent = function () {\n\t\n\t\t\tscope.screenOrientation = window.orientation || 0;\n\t\n\t\t};\n\t\n\t\t// The angles alpha, beta and gamma form a set of intrinsic Tait-Bryan angles of type Z-X'-Y''\n\t\n\t\tvar setObjectQuaternion = function () {\n\t\n\t\t\tvar zee = new THREE.Vector3( 0, 0, 1 );\n\t\n\t\t\tvar euler = new THREE.Euler();\n\t\n\t\t\tvar q0 = new THREE.Quaternion();\n\t\n\t\t\tvar q1 = new THREE.Quaternion( - Math.sqrt( 0.5 ), 0, 0, Math.sqrt( 0.5 ) ); // - PI/2 around the x-axis\n\t\n\t\t\treturn function ( quaternion, alpha, beta, gamma, orient ) {\n\t\n\t\t\t\teuler.set( beta, alpha, - gamma, 'YXZ' );                       // 'ZXY' for the device, but 'YXZ' for us\n\t\n\t\t\t\tquaternion.setFromEuler( euler );                               // orient the device\n\t\n\t\t\t\tquaternion.multiply( q1 );                                      // camera looks out the back of the device, not the top\n\t\n\t\t\t\tquaternion.multiply( q0.setFromAxisAngle( zee, - orient ) );    // adjust for screen orientation\n\t\n\t\t\t}\n\t\n\t\t}();\n\t\n\t\tthis.connect = function() {\n\t\n\t\t\tonScreenOrientationChangeEvent(); // run once on load\n\t\n\t\t\twindow.addEventListener( 'orientationchange', onScreenOrientationChangeEvent, false );\n\t\t\twindow.addEventListener( 'deviceorientation', onDeviceOrientationChangeEvent, false );\n\t\n\t\t\tscope.enabled = true;\n\t\n\t\t};\n\t\n\t\tthis.disconnect = function() {\n\t\n\t\t\twindow.removeEventListener( 'orientationchange', onScreenOrientationChangeEvent, false );\n\t\t\twindow.removeEventListener( 'deviceorientation', onDeviceOrientationChangeEvent, false );\n\t\n\t\t\tscope.enabled = false;\n\t\n\t\t};\n\t\n\t\tthis.update = function () {\n\t\n\t\t\tif ( scope.enabled === false ) return;\n\t\n\t\t\tvar alpha  = scope.deviceOrientation.alpha ? THREE.Math.degToRad( scope.deviceOrientation.alpha ) : 0; // Z\n\t\t\tvar beta   = scope.deviceOrientation.beta  ? THREE.Math.degToRad( scope.deviceOrientation.beta  ) : 0; // X'\n\t\t\tvar gamma  = scope.deviceOrientation.gamma ? THREE.Math.degToRad( scope.deviceOrientation.gamma ) : 0; // Y''\n\t\t\tvar orient = scope.screenOrientation       ? THREE.Math.degToRad( scope.screenOrientation       ) : 0; // O\n\t\n\t\t\tsetObjectQuaternion( scope.object.quaternion, alpha, beta, gamma, orient );\n\t\n\t\t};\n\t\n\t\tthis.connect();\n\t\n\t};\n\t\n\n\n/***/ },\n/* 57 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/*** IMPORTS FROM imports-loader ***/\n\tvar THREE = __webpack_require__(9);\n\t\n\t/**\n\t * @author qiao / https://github.com/qiao\n\t * @author mrdoob / http://mrdoob.com\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author WestLangley / http://github.com/WestLangley\n\t * @author erich666 / http://erichaines.com\n\t */\n\t/*global THREE, console */\n\t\n\t// This set of controls performs orbiting, dollying (zooming), and panning. It maintains\n\t// the \"up\" direction as +Y, unlike the TrackballControls. Touch on tablet and phones is\n\t// supported.\n\t//\n\t//    Orbit - left mouse / touch: one finger move\n\t//    Zoom - middle mouse, or mousewheel / touch: two finger spread or squish\n\t//    Pan - right mouse, or arrow keys / touch: three finter swipe\n\t//\n\t// This is a drop-in replacement for (most) TrackballControls used in examples.\n\t// That is, include this js file and wherever you see:\n\t//    \tcontrols = new THREE.TrackballControls( camera );\n\t//      controls.target.z = 150;\n\t// Simple substitute \"OrbitControls\" and the control should work as-is.\n\t\n\tTHREE.OrbitControls = function ( object, domElement ) {\n\t\n\t\tthis.object = object;\n\t\tthis.domElement = ( domElement !== undefined ) ? domElement : document;\n\t\n\t\t// API\n\t\n\t\t// Set to false to disable this control\n\t\tthis.enabled = true;\n\t\n\t\t// \"target\" sets the location of focus, where the control orbits around\n\t\t// and where it pans with respect to.\n\t\tthis.target = new THREE.Vector3();\n\t\n\t\t// center is old, deprecated; use \"target\" instead\n\t\tthis.center = this.target;\n\t\n\t\t// This option actually enables dollying in and out; left as \"zoom\" for\n\t\t// backwards compatibility\n\t\tthis.noZoom = false;\n\t\tthis.zoomSpeed = 1.0;\n\t\n\t\t// Limits to how far you can dolly in and out\n\t\tthis.minDistance = 0;\n\t\tthis.maxDistance = Infinity;\n\t\n\t\t// Set to true to disable this control\n\t\tthis.noRotate = false;\n\t\tthis.rotateSpeed = 1.0;\n\t\n\t\t// Set to true to disable this control\n\t\tthis.noPan = false;\n\t\tthis.keyPanSpeed = 7.0;\t// pixels moved per arrow key push\n\t\n\t\t// Set to true to automatically rotate around the target\n\t\tthis.autoRotate = false;\n\t\tthis.autoRotateSpeed = 2.0; // 30 seconds per round when fps is 60\n\t\n\t\t// How far you can orbit vertically, upper and lower limits.\n\t\t// Range is 0 to Math.PI radians.\n\t\tthis.minPolarAngle = 0; // radians\n\t\tthis.maxPolarAngle = Math.PI; // radians\n\t\n\t\t// How far you can orbit horizontally, upper and lower limits.\n\t\t// If set, must be a sub-interval of the interval [ - Math.PI, Math.PI ].\n\t\tthis.minAzimuthAngle = - Infinity; // radians\n\t\tthis.maxAzimuthAngle = Infinity; // radians\n\t\n\t\t// Set to true to disable use of the keys\n\t\tthis.noKeys = false;\n\t\n\t\t// The four arrow keys\n\t\tthis.keys = { LEFT: 37, UP: 38, RIGHT: 39, BOTTOM: 40 };\n\t\n\t\t// Mouse buttons\n\t\tthis.mouseButtons = { ORBIT: THREE.MOUSE.LEFT, ZOOM: THREE.MOUSE.MIDDLE, PAN: THREE.MOUSE.RIGHT };\n\t\n\t\t////////////\n\t\t// internals\n\t\n\t\tvar scope = this;\n\t\n\t\tvar EPS = 0.000001;\n\t\n\t\tvar rotateStart = new THREE.Vector2();\n\t\tvar rotateEnd = new THREE.Vector2();\n\t\tvar rotateDelta = new THREE.Vector2();\n\t\n\t\tvar panStart = new THREE.Vector2();\n\t\tvar panEnd = new THREE.Vector2();\n\t\tvar panDelta = new THREE.Vector2();\n\t\tvar panOffset = new THREE.Vector3();\n\t\n\t\tvar offset = new THREE.Vector3();\n\t\n\t\tvar dollyStart = new THREE.Vector2();\n\t\tvar dollyEnd = new THREE.Vector2();\n\t\tvar dollyDelta = new THREE.Vector2();\n\t\n\t\tvar theta;\n\t\tvar phi;\n\t\tvar phiDelta = 0;\n\t\tvar thetaDelta = 0;\n\t\tvar scale = 1;\n\t\tvar pan = new THREE.Vector3();\n\t\n\t\tvar lastPosition = new THREE.Vector3();\n\t\tvar lastQuaternion = new THREE.Quaternion();\n\t\n\t\tvar STATE = { NONE : -1, ROTATE : 0, DOLLY : 1, PAN : 2, TOUCH_ROTATE : 3, TOUCH_DOLLY : 4, TOUCH_PAN : 5 };\n\t\n\t\tvar state = STATE.NONE;\n\t\n\t\t// for reset\n\t\n\t\tthis.target0 = this.target.clone();\n\t\tthis.position0 = this.object.position.clone();\n\t\n\t\t// so camera.up is the orbit axis\n\t\n\t\tvar quat = new THREE.Quaternion().setFromUnitVectors( object.up, new THREE.Vector3( 0, 1, 0 ) );\n\t\tvar quatInverse = quat.clone().inverse();\n\t\n\t\t// events\n\t\n\t\tvar changeEvent = { type: 'change' };\n\t\tvar startEvent = { type: 'start'};\n\t\tvar endEvent = { type: 'end'};\n\t\n\t\tthis.rotateLeft = function ( angle ) {\n\t\n\t\t\tif ( angle === undefined ) {\n\t\n\t\t\t\tangle = getAutoRotationAngle();\n\t\n\t\t\t}\n\t\n\t\t\tthetaDelta -= angle;\n\t\n\t\t};\n\t\n\t\tthis.rotateUp = function ( angle ) {\n\t\n\t\t\tif ( angle === undefined ) {\n\t\n\t\t\t\tangle = getAutoRotationAngle();\n\t\n\t\t\t}\n\t\n\t\t\tphiDelta -= angle;\n\t\n\t\t};\n\t\n\t\t// pass in distance in world space to move left\n\t\tthis.panLeft = function ( distance ) {\n\t\n\t\t\tvar te = this.object.matrix.elements;\n\t\n\t\t\t// get X column of matrix\n\t\t\tpanOffset.set( te[ 0 ], te[ 1 ], te[ 2 ] );\n\t\t\tpanOffset.multiplyScalar( - distance );\n\t\n\t\t\tpan.add( panOffset );\n\t\n\t\t};\n\t\n\t\t// pass in distance in world space to move up\n\t\tthis.panUp = function ( distance ) {\n\t\n\t\t\tvar te = this.object.matrix.elements;\n\t\n\t\t\t// get Y column of matrix\n\t\t\tpanOffset.set( te[ 4 ], te[ 5 ], te[ 6 ] );\n\t\t\tpanOffset.multiplyScalar( distance );\n\t\n\t\t\tpan.add( panOffset );\n\t\n\t\t};\n\t\n\t\t// pass in x,y of change desired in pixel space,\n\t\t// right and down are positive\n\t\tthis.pan = function ( deltaX, deltaY ) {\n\t\n\t\t\tvar element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\t\n\t\t\tif ( scope.object.fov !== undefined ) {\n\t\n\t\t\t\t// perspective\n\t\t\t\tvar position = scope.object.position;\n\t\t\t\tvar offset = position.clone().sub( scope.target );\n\t\t\t\tvar targetDistance = offset.length();\n\t\n\t\t\t\t// half of the fov is center to top of screen\n\t\t\t\ttargetDistance *= Math.tan( ( scope.object.fov / 2 ) * Math.PI / 180.0 );\n\t\n\t\t\t\t// we actually don't use screenWidth, since perspective camera is fixed to screen height\n\t\t\t\tscope.panLeft( 2 * deltaX * targetDistance / element.clientHeight );\n\t\t\t\tscope.panUp( 2 * deltaY * targetDistance / element.clientHeight );\n\t\n\t\t\t} else if ( scope.object.top !== undefined ) {\n\t\n\t\t\t\t// orthographic\n\t\t\t\tscope.panLeft( deltaX * (scope.object.right - scope.object.left) / element.clientWidth );\n\t\t\t\tscope.panUp( deltaY * (scope.object.top - scope.object.bottom) / element.clientHeight );\n\t\n\t\t\t} else {\n\t\n\t\t\t\t// camera neither orthographic or perspective\n\t\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.' );\n\t\n\t\t\t}\n\t\n\t\t};\n\t\n\t\tthis.dollyIn = function ( dollyScale ) {\n\t\n\t\t\tif ( dollyScale === undefined ) {\n\t\n\t\t\t\tdollyScale = getZoomScale();\n\t\n\t\t\t}\n\t\n\t\t\tscale /= dollyScale;\n\t\n\t\t};\n\t\n\t\tthis.dollyOut = function ( dollyScale ) {\n\t\n\t\t\tif ( dollyScale === undefined ) {\n\t\n\t\t\t\tdollyScale = getZoomScale();\n\t\n\t\t\t}\n\t\n\t\t\tscale *= dollyScale;\n\t\n\t\t};\n\t\n\t\tthis.update = function () {\n\t\n\t\t\tvar position = this.object.position;\n\t\n\t\t\toffset.copy( position ).sub( this.target );\n\t\n\t\t\t// rotate offset to \"y-axis-is-up\" space\n\t\t\toffset.applyQuaternion( quat );\n\t\n\t\t\t// angle from z-axis around y-axis\n\t\n\t\t\ttheta = Math.atan2( offset.x, offset.z );\n\t\n\t\t\t// angle from y-axis\n\t\n\t\t\tphi = Math.atan2( Math.sqrt( offset.x * offset.x + offset.z * offset.z ), offset.y );\n\t\n\t\t\tif ( this.autoRotate && state === STATE.NONE ) {\n\t\n\t\t\t\tthis.rotateLeft( getAutoRotationAngle() );\n\t\n\t\t\t}\n\t\n\t\t\ttheta += thetaDelta;\n\t\t\tphi += phiDelta;\n\t\n\t\t\t// restrict theta to be between desired limits\n\t\t\ttheta = Math.max( this.minAzimuthAngle, Math.min( this.maxAzimuthAngle, theta ) );\n\t\n\t\t\t// restrict phi to be between desired limits\n\t\t\tphi = Math.max( this.minPolarAngle, Math.min( this.maxPolarAngle, phi ) );\n\t\n\t\t\t// restrict phi to be betwee EPS and PI-EPS\n\t\t\tphi = Math.max( EPS, Math.min( Math.PI - EPS, phi ) );\n\t\n\t\t\tvar radius = offset.length() * scale;\n\t\n\t\t\t// restrict radius to be between desired limits\n\t\t\tradius = Math.max( this.minDistance, Math.min( this.maxDistance, radius ) );\n\t\n\t\t\t// move target to panned location\n\t\t\tthis.target.add( pan );\n\t\n\t\t\toffset.x = radius * Math.sin( phi ) * Math.sin( theta );\n\t\t\toffset.y = radius * Math.cos( phi );\n\t\t\toffset.z = radius * Math.sin( phi ) * Math.cos( theta );\n\t\n\t\t\t// rotate offset back to \"camera-up-vector-is-up\" space\n\t\t\toffset.applyQuaternion( quatInverse );\n\t\n\t\t\tposition.copy( this.target ).add( offset );\n\t\n\t\t\tthis.object.lookAt( this.target );\n\t\n\t\t\tthetaDelta = 0;\n\t\t\tphiDelta = 0;\n\t\t\tscale = 1;\n\t\t\tpan.set( 0, 0, 0 );\n\t\n\t\t\t// update condition is:\n\t\t\t// min(camera displacement, camera rotation in radians)^2 > EPS\n\t\t\t// using small-angle approximation cos(x/2) = 1 - x^2 / 8\n\t\n\t\t\tif ( lastPosition.distanceToSquared( this.object.position ) > EPS\n\t\t\t    || 8 * (1 - lastQuaternion.dot(this.object.quaternion)) > EPS ) {\n\t\n\t\t\t\tthis.dispatchEvent( changeEvent );\n\t\n\t\t\t\tlastPosition.copy( this.object.position );\n\t\t\t\tlastQuaternion.copy (this.object.quaternion );\n\t\n\t\t\t}\n\t\n\t\t};\n\t\n\t\n\t\tthis.reset = function () {\n\t\n\t\t\tstate = STATE.NONE;\n\t\n\t\t\tthis.target.copy( this.target0 );\n\t\t\tthis.object.position.copy( this.position0 );\n\t\n\t\t\tthis.update();\n\t\n\t\t};\n\t\n\t\tthis.getPolarAngle = function () {\n\t\n\t\t\treturn phi;\n\t\n\t\t};\n\t\n\t\tthis.getAzimuthalAngle = function () {\n\t\n\t\t\treturn theta\n\t\n\t\t};\n\t\n\t\tfunction getAutoRotationAngle() {\n\t\n\t\t\treturn 2 * Math.PI / 60 / 60 * scope.autoRotateSpeed;\n\t\n\t\t}\n\t\n\t\tfunction getZoomScale() {\n\t\n\t\t\treturn Math.pow( 0.95, scope.zoomSpeed );\n\t\n\t\t}\n\t\n\t\tfunction onMouseDown( event ) {\n\t\n\t\t\tif ( scope.enabled === false ) return;\n\t\t\tevent.preventDefault();\n\t\n\t\t\tif ( event.button === scope.mouseButtons.ORBIT ) {\n\t\t\t\tif ( scope.noRotate === true ) return;\n\t\n\t\t\t\tstate = STATE.ROTATE;\n\t\n\t\t\t\trotateStart.set( event.clientX, event.clientY );\n\t\n\t\t\t} else if ( event.button === scope.mouseButtons.ZOOM ) {\n\t\t\t\tif ( scope.noZoom === true ) return;\n\t\n\t\t\t\tstate = STATE.DOLLY;\n\t\n\t\t\t\tdollyStart.set( event.clientX, event.clientY );\n\t\n\t\t\t} else if ( event.button === scope.mouseButtons.PAN ) {\n\t\t\t\tif ( scope.noPan === true ) return;\n\t\n\t\t\t\tstate = STATE.PAN;\n\t\n\t\t\t\tpanStart.set( event.clientX, event.clientY );\n\t\n\t\t\t}\n\t\n\t\t\tif ( state !== STATE.NONE ) {\n\t\t\t\tdocument.addEventListener( 'mousemove', onMouseMove, false );\n\t\t\t\tdocument.addEventListener( 'mouseup', onMouseUp, false );\n\t\t\t\tscope.dispatchEvent( startEvent );\n\t\t\t}\n\t\n\t\t}\n\t\n\t\tfunction onMouseMove( event ) {\n\t\n\t\t\tif ( scope.enabled === false ) return;\n\t\n\t\t\tevent.preventDefault();\n\t\n\t\t\tvar element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\t\n\t\t\tif ( state === STATE.ROTATE ) {\n\t\n\t\t\t\tif ( scope.noRotate === true ) return;\n\t\n\t\t\t\trotateEnd.set( event.clientX, event.clientY );\n\t\t\t\trotateDelta.subVectors( rotateEnd, rotateStart );\n\t\n\t\t\t\t// rotating across whole screen goes 360 degrees around\n\t\t\t\tscope.rotateLeft( 2 * Math.PI * rotateDelta.x / element.clientWidth * scope.rotateSpeed );\n\t\n\t\t\t\t// rotating up and down along whole screen attempts to go 360, but limited to 180\n\t\t\t\tscope.rotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight * scope.rotateSpeed );\n\t\n\t\t\t\trotateStart.copy( rotateEnd );\n\t\n\t\t\t} else if ( state === STATE.DOLLY ) {\n\t\n\t\t\t\tif ( scope.noZoom === true ) return;\n\t\n\t\t\t\tdollyEnd.set( event.clientX, event.clientY );\n\t\t\t\tdollyDelta.subVectors( dollyEnd, dollyStart );\n\t\n\t\t\t\tif ( dollyDelta.y > 0 ) {\n\t\n\t\t\t\t\tscope.dollyIn();\n\t\n\t\t\t\t} else {\n\t\n\t\t\t\t\tscope.dollyOut();\n\t\n\t\t\t\t}\n\t\n\t\t\t\tdollyStart.copy( dollyEnd );\n\t\n\t\t\t} else if ( state === STATE.PAN ) {\n\t\n\t\t\t\tif ( scope.noPan === true ) return;\n\t\n\t\t\t\tpanEnd.set( event.clientX, event.clientY );\n\t\t\t\tpanDelta.subVectors( panEnd, panStart );\n\t\n\t\t\t\tscope.pan( panDelta.x, panDelta.y );\n\t\n\t\t\t\tpanStart.copy( panEnd );\n\t\n\t\t\t}\n\t\n\t\t\tif ( state !== STATE.NONE ) scope.update();\n\t\n\t\t}\n\t\n\t\tfunction onMouseUp( /* event */ ) {\n\t\n\t\t\tif ( scope.enabled === false ) return;\n\t\n\t\t\tdocument.removeEventListener( 'mousemove', onMouseMove, false );\n\t\t\tdocument.removeEventListener( 'mouseup', onMouseUp, false );\n\t\t\tscope.dispatchEvent( endEvent );\n\t\t\tstate = STATE.NONE;\n\t\n\t\t}\n\t\n\t\tfunction onMouseWheel( event ) {\n\t\n\t\t\tif ( scope.enabled === false || scope.noZoom === true || state !== STATE.NONE ) return;\n\t\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopPropagation();\n\t\n\t\t\tvar delta = 0;\n\t\n\t\t\tif ( event.wheelDelta !== undefined ) { // WebKit / Opera / Explorer 9\n\t\n\t\t\t\tdelta = event.wheelDelta;\n\t\n\t\t\t} else if ( event.detail !== undefined ) { // Firefox\n\t\n\t\t\t\tdelta = - event.detail;\n\t\n\t\t\t}\n\t\n\t\t\tif ( delta > 0 ) {\n\t\n\t\t\t\tscope.dollyOut();\n\t\n\t\t\t} else {\n\t\n\t\t\t\tscope.dollyIn();\n\t\n\t\t\t}\n\t\n\t\t\tscope.update();\n\t\t\tscope.dispatchEvent( startEvent );\n\t\t\tscope.dispatchEvent( endEvent );\n\t\n\t\t}\n\t\n\t\tfunction onKeyDown( event ) {\n\t\n\t\t\tif ( scope.enabled === false || scope.noKeys === true || scope.noPan === true ) return;\n\t\n\t\t\tswitch ( event.keyCode ) {\n\t\n\t\t\t\tcase scope.keys.UP:\n\t\t\t\t\tscope.pan( 0, scope.keyPanSpeed );\n\t\t\t\t\tscope.update();\n\t\t\t\t\tbreak;\n\t\n\t\t\t\tcase scope.keys.BOTTOM:\n\t\t\t\t\tscope.pan( 0, - scope.keyPanSpeed );\n\t\t\t\t\tscope.update();\n\t\t\t\t\tbreak;\n\t\n\t\t\t\tcase scope.keys.LEFT:\n\t\t\t\t\tscope.pan( scope.keyPanSpeed, 0 );\n\t\t\t\t\tscope.update();\n\t\t\t\t\tbreak;\n\t\n\t\t\t\tcase scope.keys.RIGHT:\n\t\t\t\t\tscope.pan( - scope.keyPanSpeed, 0 );\n\t\t\t\t\tscope.update();\n\t\t\t\t\tbreak;\n\t\n\t\t\t}\n\t\n\t\t}\n\t\n\t\tfunction touchstart( event ) {\n\t\n\t\t\tif ( scope.enabled === false ) return;\n\t\n\t\t\tswitch ( event.touches.length ) {\n\t\n\t\t\t\tcase 1:\t// one-fingered touch: rotate\n\t\n\t\t\t\t\tif ( scope.noRotate === true ) return;\n\t\n\t\t\t\t\tstate = STATE.TOUCH_ROTATE;\n\t\n\t\t\t\t\trotateStart.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\t\t\t\t\tbreak;\n\t\n\t\t\t\tcase 2:\t// two-fingered touch: dolly\n\t\n\t\t\t\t\tif ( scope.noZoom === true ) return;\n\t\n\t\t\t\t\tstate = STATE.TOUCH_DOLLY;\n\t\n\t\t\t\t\tvar dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\n\t\t\t\t\tvar dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\n\t\t\t\t\tvar distance = Math.sqrt( dx * dx + dy * dy );\n\t\t\t\t\tdollyStart.set( 0, distance );\n\t\t\t\t\tbreak;\n\t\n\t\t\t\tcase 3: // three-fingered touch: pan\n\t\n\t\t\t\t\tif ( scope.noPan === true ) return;\n\t\n\t\t\t\t\tstate = STATE.TOUCH_PAN;\n\t\n\t\t\t\t\tpanStart.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\t\t\t\t\tbreak;\n\t\n\t\t\t\tdefault:\n\t\n\t\t\t\t\tstate = STATE.NONE;\n\t\n\t\t\t}\n\t\n\t\t\tif ( state !== STATE.NONE ) scope.dispatchEvent( startEvent );\n\t\n\t\t}\n\t\n\t\tfunction touchmove( event ) {\n\t\n\t\t\tif ( scope.enabled === false ) return;\n\t\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopPropagation();\n\t\n\t\t\tvar element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\t\n\t\t\tswitch ( event.touches.length ) {\n\t\n\t\t\t\tcase 1: // one-fingered touch: rotate\n\t\n\t\t\t\t\tif ( scope.noRotate === true ) return;\n\t\t\t\t\tif ( state !== STATE.TOUCH_ROTATE ) return;\n\t\n\t\t\t\t\trotateEnd.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\t\t\t\t\trotateDelta.subVectors( rotateEnd, rotateStart );\n\t\n\t\t\t\t\t// rotating across whole screen goes 360 degrees around\n\t\t\t\t\tscope.rotateLeft( 2 * Math.PI * rotateDelta.x / element.clientWidth * scope.rotateSpeed );\n\t\t\t\t\t// rotating up and down along whole screen attempts to go 360, but limited to 180\n\t\t\t\t\tscope.rotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight * scope.rotateSpeed );\n\t\n\t\t\t\t\trotateStart.copy( rotateEnd );\n\t\n\t\t\t\t\tscope.update();\n\t\t\t\t\tbreak;\n\t\n\t\t\t\tcase 2: // two-fingered touch: dolly\n\t\n\t\t\t\t\tif ( scope.noZoom === true ) return;\n\t\t\t\t\tif ( state !== STATE.TOUCH_DOLLY ) return;\n\t\n\t\t\t\t\tvar dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\n\t\t\t\t\tvar dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\n\t\t\t\t\tvar distance = Math.sqrt( dx * dx + dy * dy );\n\t\n\t\t\t\t\tdollyEnd.set( 0, distance );\n\t\t\t\t\tdollyDelta.subVectors( dollyEnd, dollyStart );\n\t\n\t\t\t\t\tif ( dollyDelta.y > 0 ) {\n\t\n\t\t\t\t\t\tscope.dollyOut();\n\t\n\t\t\t\t\t} else {\n\t\n\t\t\t\t\t\tscope.dollyIn();\n\t\n\t\t\t\t\t}\n\t\n\t\t\t\t\tdollyStart.copy( dollyEnd );\n\t\n\t\t\t\t\tscope.update();\n\t\t\t\t\tbreak;\n\t\n\t\t\t\tcase 3: // three-fingered touch: pan\n\t\n\t\t\t\t\tif ( scope.noPan === true ) return;\n\t\t\t\t\tif ( state !== STATE.TOUCH_PAN ) return;\n\t\n\t\t\t\t\tpanEnd.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\t\t\t\t\tpanDelta.subVectors( panEnd, panStart );\n\t\n\t\t\t\t\tscope.pan( panDelta.x, panDelta.y );\n\t\n\t\t\t\t\tpanStart.copy( panEnd );\n\t\n\t\t\t\t\tscope.update();\n\t\t\t\t\tbreak;\n\t\n\t\t\t\tdefault:\n\t\n\t\t\t\t\tstate = STATE.NONE;\n\t\n\t\t\t}\n\t\n\t\t}\n\t\n\t\tfunction touchend( /* event */ ) {\n\t\n\t\t\tif ( scope.enabled === false ) return;\n\t\n\t\t\tscope.dispatchEvent( endEvent );\n\t\t\tstate = STATE.NONE;\n\t\n\t\t}\n\t\n\t\tthis.domElement.addEventListener( 'contextmenu', function ( event ) { event.preventDefault(); }, false );\n\t\tthis.domElement.addEventListener( 'mousedown', onMouseDown, false );\n\t\tthis.domElement.addEventListener( 'mousewheel', onMouseWheel, false );\n\t\tthis.domElement.addEventListener( 'DOMMouseScroll', onMouseWheel, false ); // firefox\n\t\n\t\tthis.domElement.addEventListener( 'touchstart', touchstart, false );\n\t\tthis.domElement.addEventListener( 'touchend', touchend, false );\n\t\tthis.domElement.addEventListener( 'touchmove', touchmove, false );\n\t\n\t\twindow.addEventListener( 'keydown', onKeyDown, false );\n\t\n\t\t// force an update at start\n\t\tthis.update();\n\t\n\t};\n\t\n\tTHREE.OrbitControls.prototype = Object.create( THREE.EventDispatcher.prototype );\n\tTHREE.OrbitControls.prototype.constructor = THREE.OrbitControls;\n\t\n\n\n/***/ },\n/* 58 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/*** IMPORTS FROM imports-loader ***/\n\tvar THREE = __webpack_require__(9);\n\t\n\t( function() {\n\t\n\t\tvar _oldConsole = console.log;\n\t\n\t\tvar supportedTypes = [];\n\t\n\t\tfunction addSupportedType( type, format ) {\n\t\n\t\t\tsupportedTypes.push( {\n\t\t\t\ttype: type,\n\t\t\t\tformat: format\n\t\t\t} );\n\t\n\t\t}\n\t\n\t\taddSupportedType( THREE.Matrix4, function( v ) {\n\t\n\t\t\tvar e = v.elements;\n\t\t\t\t\t\n\t\t\treturn [\n\t\t\t\t[ e[ 0 ], e[ 1 ], e[ 2 ], e[ 3 ] ],\n\t\t\t\t[ e[ 4 ], e[ 5 ], e[ 6 ], e[ 7 ] ],\n\t\t\t\t[ e[ 8 ], e[ 9 ], e[ 10 ], e[ 11 ] ],\n\t\t\t\t[ e[ 12 ], e[ 13 ], e[ 14 ], e[ 15 ] ]\n\t\t\t];\n\t\n\t\t} );\n\t\n\t\taddSupportedType( THREE.Matrix3, function( v ) {\n\t\n\t\t\tvar e = v.elements;\n\t\t\t\t\t\n\t\t\treturn [\n\t\t\t\t[ e[ 0 ], e[ 1 ], e[ 2 ] ],\n\t\t\t\t[ e[ 3 ], e[ 4 ], e[ 5 ] ],\n\t\t\t\t[ e[ 6 ], e[ 7 ], e[ 8 ] ]\n\t\t\t];\n\t\n\t\t} );\n\t\n\t\taddSupportedType( THREE.Vector2, function( v ) {\n\t\n\t\t\treturn {\n\t\t\t\tVector2: { x: v.x, y: v.y }\n\t\t\t};\n\t\n\t\t} );\n\t\n\t\taddSupportedType( THREE.Vector3, function( v ) {\n\t\n\t\t\treturn {\n\t\t\t\tVector3: { x: v.x, y: v.y, z: v.z }\n\t\t\t};\n\t\n\t\t} );\n\t\n\t\taddSupportedType( THREE.Vector4, function( v ) {\n\t\n\t\t\treturn {\n\t\t\t\tVector4: { x: v.x, y: v.y, z: v.z, w: v.w }\n\t\t\t};\n\t\n\t\t} );\n\t\n\t\taddSupportedType( THREE.Euler, function( v ) {\n\t\n\t\t\treturn {\n\t\t\t\tVector4: { x: v.x, y: v.y, z: v.z, order: v.order }\n\t\t\t};\n\t\n\t\t} );\n\t\n\t\taddSupportedType( THREE.Ray, function( v ) {\n\t\n\t\t\treturn { \n\t\t\t\t'Ray origin': { x: v.origin.x, y: v.origin.y, z: v.origin.z },\n\t\t\t\t'Ray direction': { x: v.direction.x, y: v.direction.y, z: v.direction.z }\n\t\t\t};\n\t\n\t\t} );\n\t\n\t\tconsole.log = function() {\n\t\n\t\t\tvar special = false;\n\t\n\t\t\t[].forEach.call( arguments, function( a ) { \n\t\t\t\tsupportedTypes.forEach( function( t ) {\n\t\t\t\t\tif( a instanceof t.type ) special = true;;\n\t\t\t\t} );\n\t\t\t} );\n\t\n\t\t\tif( special ) {\n\t\n\t\t\t\t[].forEach.call( arguments, function( a ) { \n\t\t\t\t\n\t\t\t\t\t_oldConsole.apply( console, [ a ] );\n\t\n\t\t\t\t\tsupportedTypes.forEach( function( t ) {\n\t\n\t\t\t\t\t\tif( a instanceof t.type ) {\n\t\n\t\t\t\t\t\t\tconsole.table( t.format( a ) );\n\t\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t} );\n\t\n\t\t\t\t} );\n\t\n\t\t\t} else {\n\t\n\t\t\t\t_oldConsole.apply( console, arguments );\n\t\n\t\t\t}\n\t\n\t\t}\n\t\n\t} )();\n\n\n/***/ },\n/* 59 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/*** IMPORTS FROM imports-loader ***/\n\tvar THREE = __webpack_require__(9);\n\t\n\t/**\n\t * @author bchirls / http://bchirls.com/\n\t */\n\t\n\tTHREE.VRStereoEffect = function ( renderer, fullScreenElement, options ) {\n\t\n\t\t// internals\n\t\tvar self = this;\n\t\tvar width = 0, height = 0;\n\t\tvar hmdWidth, hmdHeight;\n\t\n\t\tvar hmdDevice;\n\t\tvar vrMode;\n\t\tvar vrPreview = false;\n\t\tvar eyeOffsetLeft = new THREE.Vector3();\n\t\tvar eyeOffsetRight = new THREE.Vector3();\n\t\n\t\tvar position = new THREE.Vector3();\n\t\tvar quaternion = new THREE.Quaternion();\n\t\tvar scale = new THREE.Vector3();\n\t\n\t\tvar cameraLeft = new THREE.PerspectiveCamera();\n\t\tvar cameraRight = new THREE.PerspectiveCamera();\n\t\tvar leftRenderRect = {\n\t\t\tx: 0, y: 0, width: 0, height: 0\n\t\t};\n\t\tvar rightRenderRect = {\n\t\t\tx: 0, y: 0, width: 0, height: 0\n\t\t};\n\t\n\t\tvar near = 2;\n\t\tvar far = 40000;\n\t\n\t\tvar requestFullscreen;\n\t\tvar fullScreenParam = {\n\t\t\tvrDisplay: null\n\t\t};\n\t\tvar fovScale;\n\t\n\t\tvar RADIANS = Math.PI / 180;\n\t\n\t\tvar poll = options && options.poll || 1000;\n\t\tvar pollTimeout;\n\t\n\t\tfunction perspectiveMatrixFromVRFieldOfView(fov, zNear, zFar) {\n\t\t\tvar outMat = new THREE.Matrix4(),\n\t\t\t\tout = outMat.elements,\n\t\t\t\tupTan = Math.tan(fov.upDegrees * RADIANS),\n\t\t\t\tdownTan = Math.tan(fov.downDegrees * RADIANS),\n\t\t\t\tleftTan = Math.tan(fov.leftDegrees * RADIANS),\n\t\t\t\trightTan = Math.tan(fov.rightDegrees * RADIANS),\n\t\n\t\t\t\txScale = 2 / (leftTan + rightTan),\n\t\t\t\tyScale = 2 / (upTan + downTan);\n\t\n\t\t\tout[0] = xScale;\n\t\t\tout[4] = 0;\n\t\t\tout[8] = -((leftTan - rightTan) * xScale * 0.5);\n\t\t\tout[12] = 0;\n\t\n\t\t\tout[1] = 0;\n\t\t\tout[5] = yScale;\n\t\t\tout[9] = ((upTan - downTan) * yScale * 0.5);\n\t\t\tout[13] = 0;\n\t\n\t\t\tout[2] = 0;\n\t\t\tout[6] = 0;\n\t\t\tout[10] = zFar / (zNear - zFar);\n\t\t\tout[14] = (zFar * zNear) / (zNear - zFar);\n\t\n\t\t\tout[3] = 0;\n\t\t\tout[7] = 0;\n\t\t\tout[11] = -1;\n\t\t\tout[15] = 0;\n\t\n\t\t\treturn outMat;\n\t\t}\n\t\n\t\tfunction resize() {\n\t\t\tvar w, h;\n\t\n\t\t\tif (hmdDevice && vrMode) {\n\t\t\t\tw = hmdWidth;// / Math.pow(window.devicePixelRatio || 1, 2);\n\t\t\t\th = hmdHeight;// / Math.pow(window.devicePixelRatio || 1, 2);\n\t\t\t} else {\n\t\t\t\tw = width || renderer.domElement.offsetWidth || window.innerWidth;\n\t\t\t\th = height || renderer.domElement.offsetHeight || window.innerHeight;\n\t\t\t}\n\t\n\t\t\trenderer.setSize(w, h);\n\t\t}\n\t\n\t\tfunction updateProjection() {\n\t\t\tvar fovLeft,\n\t\t\t\tfovRight,\n\t\n\t\t\t\tleftEyeParams,\n\t\t\t\trightEyeParams,\n\t\t\t\tleftEyeRect,\n\t\t\t\trightEyeRect,\n\t\n\t\t\t\tleftEyeViewport,\n\t\t\t\trightEyeViewport;\n\t\n\t\t\tif (!hmdDevice) {\n\t\t\t\tcameraLeft.fov = 80;\n\t\t\t\tcameraRight.fov = 80;\n\t\t\t\treturn;\n\t\t\t}\n\t\n\t\t\t// if (amount && hmdDevice.setFieldOfView) {\n\t\t\t// \tfovScale += amount;\n\t\t\t// \tfovScale = Math.max(0.1, fovScale);\n\t\n\t\t\t// \tfovLeft = hmdDevice.getRecommendedEyeFieldOfView('left');\n\t\n\t\t\t// \tfovLeft.upDegrees *= fovScale;\n\t\t\t// \tfovLeft.downDegrees *= fovScale;\n\t\t\t// \tfovLeft.leftDegrees *= fovScale;\n\t\t\t// \tfovLeft.rightDegrees *= fovScale;\n\t\n\t\t\t// \tfovRight = hmdDevice.getRecommendedEyeFieldOfView('right');\n\t\t\t// \tfovRight.upDegrees *= fovScale;\n\t\t\t// \tfovRight.downDegrees *= fovScale;\n\t\t\t// \tfovRight.leftDegrees *= fovScale;\n\t\t\t// \tfovRight.rightDegrees *= fovScale;\n\t\n\t\t\t// \thmdDevice.setFieldOfView(fovLeft, fovRight);\n\t\t\t// }\n\t\n\t\t\tif (hmdDevice.getEyeParameters) {\n\t\t\t\tleftEyeParams = hmdDevice.getEyeParameters('left');\n\t\t\t\trightEyeParams = hmdDevice.getEyeParameters('right');\n\t\t\t\tleftEyeRect = leftEyeParams.renderRect;\n\t\t\t\trightEyeRect = rightEyeParams.renderRect;\n\t\n\t\t\t\thmdWidth = rightEyeRect.x + rightEyeRect.width;\n\t\t\t\thmdHeight = Math.max(leftEyeRect.y + leftEyeRect.height, rightEyeRect.y + rightEyeRect.height);\n\t\n\t\t\t\tfovLeft = leftEyeParams.currentFieldOfView;\n\t\t\t\tfovRight = rightEyeParams.currentFieldOfView;\n\t\n\t\t\t\thmdDevice.setFieldOfView(fovLeft, fovRight, near, far);\n\t\n\t\t\t\teyeOffsetLeft.copy(leftEyeParams.eyeTranslation);\n\t\t\t\teyeOffsetRight.copy(rightEyeParams.eyeTranslation);\n\t\n\t\t\t\tleftRenderRect = leftEyeParams.renderRect;\n\t\t\t\trightRenderRect = rightEyeParams.renderRect;\n\t\t\t} else if (hmdDevice.getRecommendedEyeRenderRect) {\n\t\t\t\tleftEyeViewport = hmdDevice.getRecommendedEyeRenderRect('left');\n\t\t\t\trightEyeViewport = hmdDevice.getRecommendedEyeRenderRect('right');\n\t\n\t\t\t\thmdWidth = leftEyeViewport.width + rightEyeViewport.width;\n\t\t\t\thmdHeight = Math.max(leftEyeViewport.height, rightEyeViewport.height);\n\t\n\t\t\t\tif (hmdDevice.getCurrentEyeFieldOfView) {\n\t\t\t\t\tfovLeft = hmdDevice.getCurrentEyeFieldOfView('left');\n\t\t\t\t\tfovRight = hmdDevice.getCurrentEyeFieldOfView('right');\n\t\t\t\t} else {\n\t\t\t\t\tfovLeft = hmdDevice.getRecommendedEyeFieldOfView('left');\n\t\t\t\t\tfovRight = hmdDevice.getRecommendedEyeFieldOfView('right');\n\t\t\t\t}\n\t\n\t\t\t\teyeOffsetLeft.copy(hmdDevice.getEyeTranslation('left'));\n\t\t\t\teyeOffsetRight.copy(hmdDevice.getEyeTranslation('right'));\n\t\n\t\t\t\tleftRenderRect.x = leftEyeViewport.left;\n\t\t\t\tleftRenderRect.y = leftEyeViewport.top;\n\t\t\t\tleftRenderRect.width = leftEyeViewport.width;\n\t\t\t\tleftRenderRect.height = leftEyeViewport.height;\n\t\n\t\t\t\trightRenderRect.x = rightEyeViewport.left;\n\t\t\t\trightRenderRect.y = rightEyeViewport.top;\n\t\t\t\trightRenderRect.width = rightEyeViewport.width;\n\t\t\t\trightRenderRect.height = rightEyeViewport.height;\n\t\t\t}\n\t\n\t\t\tresize();\n\t\n\t\t\tcameraLeft.projectionMatrix = perspectiveMatrixFromVRFieldOfView(fovLeft, near, far);\n\t\t\tcameraRight.projectionMatrix = perspectiveMatrixFromVRFieldOfView(fovRight, near, far);\n\t\t}\n\t\n\t\tfunction gotVRDevices(devices) {\n\t\t\tvar i,\n\t\t\t\tdevice;\n\t\n\t\t\tfor (i = 0; i < devices.length; i++) {\n\t\t\t\tdevice = devices[i];\n\t\t\t\tif ( device instanceof HMDVRDevice ) {\n\t\n\t\t\t\t\tif ( hmdDevice && device.hardwareUnitId === hmdDevice.hardwareUnitId ) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\n\t\t\t\t\thmdDevice = device;\n\t\t\t\t\tconsole.log('Using HMD Device:', hmdDevice.deviceName);\n\t\n\t\t\t\t\tif (hmdDevice.setTimewarp) {\n\t\t\t\t\t\t//hmdDevice.setTimewarp(false);\n\t\t\t\t\t}\n\t\n\t\t\t\t\tupdateProjection();\n\t\n\t\t\t\t\tfullScreenParam.vrDisplay = hmdDevice;\n\t\n\t\t\t\t\tself.dispatchEvent( {\n\t\t\t\t\t\ttype: \"devicechange\"\n\t\t\t\t\t} );\n\t\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tif (poll) {\n\t\t\t\tclearTimeout(pollTimeout);\n\t\t\t\tsetTimeout(self.scan, poll);\n\t\t\t}\n\t\t}\n\t\n\t\tfunction onFullscreenChange() {\n\t\t\tif (!document.webkitFullscreenElement &&\n\t\t\t\t\t!document.mozFullScreenElement &&\n\t\t\t\t\t!document.msFullscreenElement) {\n\t\t\t\tvrMode = false;\n\t\t\t}\n\t\n\t\t\tupdateProjection();\n\t\n\t\t\tself.dispatchEvent( {\n\t\t\t\ttype: \"fullscreenchange\"\n\t\t\t} );\n\t\t}\n\t\n\t\t// API\n\t\n\t\tthis.separation = 0.01;\n\t\n\t\t// initialization\n\t\n\t\trenderer.autoClear = false;\n\t\n\t\tif (!fullScreenElement) {\n\t\t\tfullScreenElement = renderer.domElement;\n\t\t}\n\t\trequestFullscreen = fullScreenElement.webkitRequestFullscreen ||\n\t\t\tfullScreenElement.mozRequestFullScreen ||\n\t\t\tfullScreenElement.msRequestFullscreen;\n\t\tif (requestFullscreen) {\n\t\t\trequestFullscreen = requestFullscreen.bind(fullScreenElement, fullScreenParam);\n\t\t}\n\t\n\t\tdocument.addEventListener('fullscreenchange', onFullscreenChange, false);\n\t\tdocument.addEventListener('webkitfullscreenchange', onFullscreenChange, false);\n\t\tdocument.addEventListener('mozfullscreenchange', onFullscreenChange, false);\n\t\tdocument.addEventListener('MSFullscreenChange', onFullscreenChange, false);\n\t\n\t\t//todo: method for adjusting HMD FOV\n\t\n\t\tthis.scan = function () {\n\t\t\tif (navigator.getVRDevices) {\n\t\t\t\tnavigator.getVRDevices().then(gotVRDevices);\n\t\t\t} else if (navigator.mozGetVRDevices) {\n\t\t\t\tnavigator.mozGetVRDevices(gotVRDevices);\n\t\t\t}\n\t\t};\n\t\n\t\tthis.requestFullScreen = function () {\n\t\t\tvrMode = true;\n\t\t\trequestFullscreen();\n\t\t};\n\t\n\t\tthis.exit = function () {\n\t\t\tvrMode = false;\n\t\t\tvrPreview = false;\n\t\t};\n\t\n\t\tthis.setSize = function ( w, h ) {\n\t\t\twidth = w;\n\t\t\theight = h;\n\t\n\t\t\tresize();\n\t\t};\n\t\n\t\tthis.vrPreview = function (val) {\n\t\t\tif (val !== undefined) {\n\t\t\t\tvrPreview = !!val;\n\t\t\t}\n\t\t\treturn vrPreview;\n\t\t};\n\t\n\t\tthis.isFullscreen = function () {\n\t\t\treturn vrMode;\n\t\t};\n\t\n\t\tthis.hmd = function () {\n\t\t\treturn hmdDevice;\n\t\t};\n\t\n\t\tthis.render = function ( leftScene, rightScene, camera, renderTarget, forceClear ) {\n\t\t\tvar w, h;\n\t\n\t\t\tif ( rightScene && rightScene instanceof THREE.Scene ) {\n\t\t\t\t//rightScene.updateMatrixWorld();\n\t\t\t} else {\n\t\t\t\tif ( (!camera || camera instanceof THREE.WebGLRenderTarget) && rightScene instanceof THREE.Camera ) {\n\t\t\t\t\tforceClear = renderTarget;\n\t\t\t\t\trenderTarget = camera;\n\t\t\t\t\tcamera = rightScene;\n\t\t\t\t}\n\t\t\t\trightScene = leftScene;\n\t\t\t}\n\t\n\t\t\t//leftScene.updateMatrixWorld();\n\t\n\t\t\tif ( camera.parent === undefined ) {\n\t\t\t\tcamera.updateMatrixWorld();\n\t\t\t}\n\t\n\t\t\tw = width || renderer.domElement.width;\n\t\t\th = height || renderer.domElement.height;\n\t\t\t// w /= window.devicePixelRatio || 1;\n\t\t\t// h /= window.devicePixelRatio || 1;\n\t\n\t\t\t/*\n\t\t\ttodo: make this work when CSS VR Rendering is fixed\n\t\t\thttp://blog.bitops.com/blog/2014/08/20/updated-firefox-vr-builds/\n\t\t\tif (renderer instanceof THREE.CSS3DRenderer) {\n\t\t\t\trenderer.render( leftScene, camera );\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t*/\n\t\n\t\t\tif (!vrMode && !vrPreview) {\n\t\t\t\trenderer.enableScissorTest( false );\n\t\t\t\trenderer.setViewport( 0, 0, w, h );\n\t\t\t\trenderer.render( leftScene, camera, renderTarget, true );\n\t\t\t\treturn;\n\t\t\t}\n\t\n\t\t\tcamera.matrixWorld.decompose( position, quaternion, scale );\n\t\n\t\t\tif (!hmdDevice) {\n\t\t\t\t// left\n\t\t\t\t//cameraLeft.fov = camera.fov;\n\t\t\t\tcameraLeft.aspect = 0.5 * camera.aspect;\n\t\t\t\tcameraLeft.near = camera.near;\n\t\t\t\tcameraLeft.far = camera.far;\n\t\t\t\tcameraLeft.updateProjectionMatrix();\n\t\n\t\t\t\t// right\n\t\n\t\t\t\t// cameraRight.fov = camera.fov;\n\t\t\t\tcameraRight.aspect = 0.5 * camera.aspect;\n\t\t\t\tcameraRight.near = camera.near;\n\t\t\t\tcameraRight.far = camera.far;\n\t\t\t\tcameraRight.updateProjectionMatrix();\n\t\t\t}\n\t\n\t\t\tcameraLeft.position.copy( position );\n\t\t\tcameraLeft.quaternion.copy( quaternion );\n\t\n\t\t\tcameraRight.position.copy( position );\n\t\t\tcameraRight.quaternion.copy( quaternion );\n\t\n\t\t\tif (hmdDevice) {\n\t\t\t\tcameraLeft.position.add( eyeOffsetLeft ) ;\n\t\t\t\tcameraRight.position.add( eyeOffsetRight );\n\t\t\t} else {\n\t\t\t\tcameraLeft.translateX( - this.separation );\n\t\t\t\tcameraRight.translateX( this.separation );\n\t\t\t}\n\t\n\t\t\tcameraLeft.updateMatrixWorld();\n\t\t\tcameraRight.updateMatrixWorld();\n\t\n\t\t\t//\n\t\n\t\t\trenderer.enableScissorTest(true);\n\t\n\t\t\tw = renderer.context.drawingBufferWidth / 2;\n\t\n\t\t\tif (renderTarget) {\n\t\t\t\trenderer.setRenderTarget(renderTarget);\n\t\t\t}\n\t\n\t\t\trightScene.traverseVisible(function (obj) {\n\t\t\t\tif (obj.material && obj.material.map) {\n\t\t\t\t\tif (obj.userData.stereo === 'vertical') {\n\t\t\t\t\t\tobj.material.map.offset.set(0, 0.5);\n\t\t\t\t\t} else if (obj.userData.stereo) {\n\t\t\t\t\t\tobj.material.map.offset.set(0.5, 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\trenderer.setScissor( w, 0, w, h );\n\t\t\trenderer.setViewport( w, 0, w, h );\n\t\t\trenderer.render( rightScene, cameraRight, renderTarget, forceClear );\n\t\n\t\t\tleftScene.traverseVisible(function (obj) {\n\t\t\t\tif (obj.userData.stereo && obj.material && obj.material.map) {\n\t\t\t\t\tobj.material.map.offset.set(0, 0);\n\t\t\t\t}\n\t\t\t});\n\t\t\trenderer.setScissor( 0, 0, w, h );\n\t\t\trenderer.setViewport( 0, 0, w, h );\n\t\t\trenderer.render( leftScene, cameraLeft, renderTarget, forceClear );\n\t\n\t\t\t//reset viewport, scissor\n\t\t\tw *= 2;\n\t\t\trenderer.setViewport( 0, 0, w, h );\n\t\t\trenderer.setScissor( 0, 0, w, h );\n\t\t\trenderer.enableScissorTest( false );\n\t\t};\n\t\n\t\tObject.defineProperty(this, 'near', {\n\t\t\tget: function () {\n\t\t\t\treturn near;\n\t\t\t},\n\t\t\tset: function (val) {\n\t\t\t\tval = parseFloat(val);\n\t\t\t\tif (val && !isNaN(val)) {\n\t\t\t\t\tnear = Math.max(0, val);\n\t\t\t\t\tupdateProjection();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\n\t\tObject.defineProperty(this, 'far', {\n\t\t\tget: function () {\n\t\t\t\treturn far;\n\t\t\t},\n\t\t\tset: function (val) {\n\t\t\t\tval = parseFloat(val);\n\t\t\t\tif (val && !isNaN(val)) {\n\t\t\t\t\tfar = Math.max(0, val);\n\t\t\t\t\tupdateProjection();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\n\t\tthis.scan();\n\t\tresize();\n\t};\n\t\n\tTHREE.VRStereoEffect.prototype = Object.create( THREE.EventDispatcher.prototype );\n\t\n\n\n/***/ },\n/* 60 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/*** IMPORTS FROM imports-loader ***/\n\tvar THREE = __webpack_require__(9);\n\t\n\tTHREE.VRControls = function ( object, options ) {\n\t\n\t\tvar self = this;\n\t\n\t\t//HMD sensor stuff\n\t\tvar sensorDevice;\n\t\tvar vrState;\n\t\n\t\t//device orientation stuff\n\t\tvar deviceControls;\n\t\tvar zeroAngle = 0;\n\t\n\t\tvar mode = '';\n\t\n\t\tvar vrBrowser = navigator.getVRDevices || navigator.mozGetVRDevices;\n\t\n\t\tvar poll = options && options.poll || 1000;\n\t\tvar pollTimeout;\n\t\n\t\tfunction gotVRDevices( devices ) {\n\t\t\tvar i,\n\t\t\t\tdevice;\n\t\n\t\t\tfor ( i = 0; i < devices.length; ++i ) {\n\t\t\t\tdevice = devices[i];\n\t\t\t\tif ( devices[i] instanceof PositionSensorVRDevice ) {\n\t\n\t\t\t\t\tif ( sensorDevice && devices[i].hardwareUnitId === sensorDevice.hardwareUnitId ) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\n\t\t\t\t\tsensorDevice = device;\n\t\t\t\t\tconsole.log('Using Sensor Device:', sensorDevice.deviceName);\n\t\n\t\t\t\t\tif ( sensorDevice.zeroSensor ) {\n\t\t\t\t\t\tself.zeroSensor = sensorDevice.zeroSensor.bind(sensorDevice);\n\t\t\t\t\t} else if ( sensorDevice.resetSensor ) {\n\t\t\t\t\t\tself.zeroSensor = sensorDevice.resetSensor.bind(sensorDevice);\n\t\t\t\t\t}\n\t\t\t\t\tself.zeroSensor();\n\t\n\t\t\t\t\tmode = 'hmd';\n\t\n\t\t\t\t\tself.dispatchEvent( {\n\t\t\t\t\t\ttype: \"devicechange\"\n\t\t\t\t\t} );\n\t\n\t\t\t\t\tbreak; // We keep the first we encounter\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tif (poll) {\n\t\t\t\tclearTimeout(pollTimeout);\n\t\t\t\tsetTimeout(self.scan, poll);\n\t\t\t}\n\t\t}\n\t\n\t\tfunction deviceOrientationChange( event ) {\n\t\t\tif ( typeof event.gamma === 'number' ) {\n\t\t\t\tmode = 'deviceorientation';\n\t\t\t\twindow.removeEventListener( 'deviceorientation', deviceOrientationChange, false );\n\t\t\t\tdeviceControls = new THREE.DeviceOrientationControls( object );\n\t\t\t\tdeviceControls.connect();\n\t\t\t\tif (!this.freeze) {\n\t\t\t\t\tdeviceControls.update();\n\t\t\t\t}\n\t\n\t\t\t\tself.dispatchEvent( {\n\t\t\t\t\ttype: \"devicechange\"\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\t\n\t\tthis.update = function() {\n\t\t\t// Applies head rotation from sensor data.\n\t\t\tif (self.freeze) {\n\t\t\t\treturn;\n\t\t\t}\n\t\n\t\t\tif ( sensorDevice ) {\n\t\t\t\tvrState = sensorDevice.getState();\n\t\t\t\tif ( vrState ) {\n\t\t\t\t\tif ( vrState.orientation && vrState.hasOrientation !== false ) {\n\t\t\t\t\t\tobject.quaternion.copy( vrState.orientation );\n\t\t\t\t\t}\n\t\n\t\t\t\t\tif ( vrState.position && vrState.hasPosition !== false ) {\n\t\t\t\t\t\t// vrState.position is null if using DK1 or if DK2 camera is not plugged in\n\t\t\t\t\t\tobject.position.copy( vrState.position );\n\t\t\t\t\t}\n\t\n\t\t\t\t\tobject.updateMatrixWorld();\n\t\t\t\t}\n\t\t\t} else if (deviceControls && deviceControls.deviceOrientation.gamma !== undefined) {\n\t\t\t\tdeviceControls.update();\n\t\t\t\tobject.rotateY(-zeroAngle);\n\t\t\t\tobject.updateMatrixWorld();\n\t\t\t}\n\t\t};\n\t\n\t\t//only useful when frozen\n\t\tthis.reset = function () {\n\t\t\tif ( object ) {\n\t\t\t\tobject.quaternion.set( 0, 0, 0, 1 );\n\t\t\t\tobject.position.set( 0, 0, 0 );\n\t\t\t}\n\t\t};\n\t\n\t\t//zeros only rotation on Y axis\n\t\t//todo: find out if it zeros out position. need a DK2 to test\n\t\tthis.zeroSensor = function () {\n\t\t\tif (sensorDevice && sensorDevice.zeroSensor) {\n\t\t\t\tsensorDevice.zeroSensor();\n\t\t\t}\n\t\t\tzeroAngle = object.rotation.y;\n\t\t\tself.update();\n\t\t};\n\t\n\t\tthis.freeze = false;\n\t\n\t\t//method to query which tech we're using\n\t\tthis.mode = function () {\n\t\t\treturn mode;\n\t\t};\n\t\n\t\tthis.scan = function () {\n\t\t\tif ( navigator.getVRDevices ) {\n\t\t\t\tnavigator.getVRDevices().then( gotVRDevices );\n\t\t\t} else if ( navigator.mozGetVRDevices ) {\n\t\t\t\tnavigator.mozGetVRDevices( gotVRDevices );\n\t\t\t}\n\t\t};\n\t\n\t\t//todo: connect/disconnect methods\n\t\t//todo: method to query orientation/position without changing object\n\t\t//todo: work without an object\n\t\n\t\tif ( vrBrowser ) {\n\t\t\tthis.scan();\n\t\t} else if ( \"DeviceOrientationEvent\" in window && THREE.DeviceOrientationControls) {\n\t\t\t//device orientation\n\t\t\twindow.addEventListener( \"deviceorientation\", deviceOrientationChange, false );\n\t\t}\n\t};\n\t\n\tTHREE.VRControls.prototype = Object.create( THREE.EventDispatcher.prototype );\n\t\n\n\n/***/ },\n/* 61 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar map = {\n\t\t\"./box\": 62,\n\t\t\"./box.js\": 62,\n\t\t\"./cylinder\": 63,\n\t\t\"./cylinder.js\": 63,\n\t\t\"./empty\": 55,\n\t\t\"./empty.js\": 55,\n\t\t\"./floor\": 64,\n\t\t\"./floor.js\": 64,\n\t\t\"./grid\": 65,\n\t\t\"./grid.js\": 65,\n\t\t\"./image\": 66,\n\t\t\"./image.js\": 66,\n\t\t\"./panorama\": 67,\n\t\t\"./panorama.js\": 67,\n\t\t\"./sky\": 68,\n\t\t\"./sky.js\": 68,\n\t\t\"./sound\": 70,\n\t\t\"./sound.js\": 70,\n\t\t\"./sphere\": 72,\n\t\t\"./sphere.js\": 72,\n\t\t\"./text\": 73,\n\t\t\"./text.js\": 73,\n\t\t\"./torus\": 74,\n\t\t\"./torus.js\": 74,\n\t\t\"./video\": 75,\n\t\t\"./video.js\": 75\n\t};\n\tfunction webpackContext(req) {\n\t\treturn __webpack_require__(webpackContextResolve(req));\n\t};\n\tfunction webpackContextResolve(req) {\n\t\treturn map[req] || (function() { throw new Error(\"Cannot find module '\" + req + \"'.\") }());\n\t};\n\twebpackContext.keys = function webpackContextKeys() {\n\t\treturn Object.keys(map);\n\t};\n\twebpackContext.resolve = webpackContextResolve;\n\tmodule.exports = webpackContext;\n\twebpackContext.id = 61;\n\n\n/***/ },\n/* 62 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = (function () {\n\t\t'use strict';\n\t\n\t\tvar materials = __webpack_require__(8),\n\t\t\tTHREE = __webpack_require__(9),\n\t\t\tgeometry = new THREE.BoxGeometry( 1, 1, 1 );\n\t\n\t\treturn function box(parent, options) {\n\t\t\tvar mesh;\n\t\n\t\t\tmesh = new THREE.Mesh(geometry, materials.standard());\n\t\t\tmesh.name = 'box';\n\t\n\t\t\tparent.add(mesh);\n\t\n\t\t\treturn mesh;\n\t\t};\n\t}());\n\n/***/ },\n/* 63 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = (function () {\n\t\t'use strict';\n\t\n\t\tvar materials = __webpack_require__(8),\n\t\t\tTHREE = __webpack_require__(9);\n\t\n\t\tfunction cylinder(parent, options) {\n\t\t\tvar geometry,\n\t\t\t\tmesh;\n\t\n\t\t\tgeometry = new THREE.CylinderGeometry(\n\t\t\t\toptions.radiusTop === undefined ? 0.5 : options.radiusTop,\n\t\t\t\toptions.radiusBottom === undefined ? 0.5 : options.radiusBottom,\n\t\t\t\toptions.height === undefined ? 1 : options.height,\n\t\t\t\toptions.radiusSegments === undefined ? 16 : options.radiusSegments,\n\t\t\t\toptions.heightSegments,\n\t\t\t\toptions.openEnded\n\t\t\t);\n\t\t\tmesh = new THREE.Mesh(geometry, materials.standard());\n\t\t\tmesh.name = 'cylinder';\n\t\n\t\t\tparent.add(mesh);\n\t\n\t\t\treturn mesh;\n\t\t}\n\t\n\t\treturn cylinder;\n\t}());\n\n/***/ },\n/* 64 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = (function () {\n\t\t'use strict';\n\t\n\t\tvar materials = __webpack_require__(8),\n\t\t\tTHREE = __webpack_require__(9);\n\t\n\t\tfunction floor(parent, options) {\n\t\t\tvar obj,\n\t\t\t\tgeometry;\n\t\n\t\t\tgeometry = new THREE.CircleGeometry( options.radius || 100, options.segments || 16 );\n\t\t\tgeometry.applyMatrix( new THREE.Matrix4().makeRotationX(-Math.PI / 2));\n\t\n\t\t\tobj = new THREE.Mesh(\n\t\t\t\tgeometry,\n\t\t\t\tmaterials.checkerboard({\n\t\t\t\t\trepeat: 100\n\t\t\t\t})\n\t\t\t);\n\t\t\tobj.name = 'floor';\n\t\n\t\t\tobj.receiveShadow = true;\n\t\n\t\t\tparent.add(obj);\n\t\n\t\t\treturn obj;\n\t\t}\n\t\n\t\treturn floor;\n\t}());\n\n/***/ },\n/* 65 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = (function () {\n\t\t'use strict';\n\t\n\t\tvar THREE = __webpack_require__(9);\n\t\n\t\treturn function box(parent, options) {\n\t\t\tvar obj,\n\t\t\t\tsize = options && options.size || 10,\n\t\t\t\tstep = options && options.step || 1;\n\t\n\t\t\tobj = new THREE.GridHelper(size, step);\n\t\t\tobj.name = 'grid';\n\t\t\tif (options) {\n\t\t\t\tobj.setColors(options.colorCenterLine || obj.color1, options.colorGrid || obj.color2);\n\t\t\t}\n\t\t\tobj.geometry.computeBoundingBox();\n\t\n\t\t\tparent.add(obj);\n\t\n\t\t\treturn obj;\n\t\t};\n\t}());\n\n/***/ },\n/* 66 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = (function () {\n\t\t'use strict';\n\t\n\t\tvar materials = __webpack_require__(8),\n\t\t\tTHREE = __webpack_require__(9);\n\t\n\t\treturn function image(parent, options) {\n\t\t\tvar geometry,\n\t\t\t\tmaterial,\n\t\t\t\tmesh,\n\t\t\t\tsrc,\n\t\t\t\ttex,\n\t\t\t\tself = this;\n\t\n\t\t\tif (typeof options === 'string') {\n\t\t\t\tsrc = options;\n\t\t\t} else if (options) {\n\t\t\t\tsrc = options.src;\n\t\t\t}\n\t\n\t\t\tif (src) {\n\t\t\t\ttex = materials.imageTexture(src, THREE.UVMapping, function (t, image) {\n\t\t\t\t\t//todo: don't do any of this if object has been deleted\n\t\t\t\t\tgeometry.applyMatrix(new THREE.Matrix4().makeScale(1, image.naturalHeight / image.naturalWidth, 1));\n\t\t\t\t\tmaterial.map = tex;\n\t\t\t\t\tmaterial.visible = true;\n\t\t\t\t\tmesh.visible = true;\n\t\t\t\t\tparent.add(mesh);\n\t\n\t\t\t\t\tself.emit('loaded');\n\t\t\t\t});\n\t\t\t}\n\t\n\t\t\tgeometry = new THREE.PlaneBufferGeometry(1, 1, 8);\n\t\n\t\t\tmaterial = new THREE.MeshBasicMaterial({\n\t\t\t\tside: THREE.DoubleSide,\n\t\t\t\ttransparent: true,\n\t\t\t\tmap: tex\n\t\t\t});\n\t\n\t\t\tmesh = new THREE.Mesh( geometry, material );\n\t\n\t\t\tmesh.visible = false;\n\t\n\t\t\tparent.add(mesh);\n\t\n\t\t\treturn mesh;\n\t\t};\n\t}());\n\n/***/ },\n/* 67 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = (function () {\n\t\t'use strict';\n\t\n\t\tvar materials = __webpack_require__(8),\n\t\t\tTHREE = __webpack_require__(9),\n\t\t\tgeometry = new THREE.SphereGeometry(1000, 60, 60);\n\t\n\t\tgeometry.applyMatrix(new THREE.Matrix4().makeScale(-1, 1, 1));\n\t\tgeometry.applyMatrix(new THREE.Matrix4().makeRotationY(- Math.PI / 2));\n\t\n\t\treturn function panorama(parent, options) {\n\t\t\tvar material,\n\t\t\t\tmesh,\n\t\t\t\tsrc,\n\t\t\t\ttex,\n\t\t\t\tself = this;\n\t\n\t\t\tif (typeof options === 'string') {\n\t\t\t\tsrc = options;\n\t\t\t} else if (options) {\n\t\t\t\tsrc = options.src;\n\t\t\t}\n\t\n\t\t\tif (src) {\n\t\t\t\ttex = materials.imageTexture(src, THREE.UVMapping, function () {\n\t\t\t\t\tself.emit('loaded');\n\t\t\t\t});\n\t\t\t}\n\t\n\t\t\tmaterial = new THREE.MeshBasicMaterial({\n\t\t\t\ttransparent: true,\n\t\t\t\tmap: tex\n\t\t\t});\n\t\n\t\t\tmesh = new THREE.Mesh(geometry, material);\n\t\n\t\t\tif (options && options.stereo) {\n\t\t\t\tif (options.stereo === 'vertical') {\n\t\t\t\t\ttex.repeat.y = 0.5;\n\t\t\t\t} else {\n\t\t\t\t\ttex.repeat.x = 0.5;\n\t\t\t\t}\n\t\t\t\tmesh.userData.stereo = options.stereo;\n\t\t\t}\n\t\n\t\t\tmesh.name = 'panorama';\n\t\n\t\t\tparent.add(mesh);\n\t\n\t\t\tthis.raycastable = false;\n\t\n\t\t\treturn mesh;\n\t\t};\n\t}());\n\n/***/ },\n/* 68 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = (function () {\n\t\t'use strict';\n\t\n\t\tvar materials = __webpack_require__(8),\n\t\t\tTHREE = __webpack_require__(9),\n\t\t\tTAU = Math.PI * 2,\n\t\t\tHALF_PI = Math.PI / 2,\n\t\n\t\t\tdistance = 400000,\n\t\t\tscratchVector = new THREE.Vector3(),\n\t\n\t\t\tparams = [\n\t\t\t\t'luminance',\n\t\t\t\t'turbidity',\n\t\t\t\t'reileigh',\n\t\t\t\t'mieCoefficient',\n\t\t\t\t'mieDirectionalG'\n\t\t\t];\n\t\n\t\t__webpack_require__(69);\n\t\n\t\treturn function sky(parent, options) {\n\t\t\tvar obj = new THREE.Sky(),\n\t\t\t\tself = this,\n\t\t\t\tscene = parent,\n\t\t\t\tlight,\n\t\t\t\tsunPosition,\n\t\t\t\tazimuth = Math.PI / 6,\n\t\t\t\taltitude = Math.PI / 6;\n\t\n\t\t\tfunction mod(x, y) {\n\t\t\t\treturn x - y * Math.floor(x / y);\n\t\t\t}\n\t\n\t\t\tfunction update() {\n\t\t\t\tvar sinTheta,\n\t\t\t\t\tcosTheta,\n\t\t\t\t\tphi,\n\t\t\t\t\tsinPhi,\n\t\t\t\t\tcosPhi;\n\t\n\t\t\t\tsinTheta = Math.sin(altitude);\n\t\t\t\tcosTheta = Math.cos(altitude);\n\t\t\t\tphi = -HALF_PI - azimuth;\n\t\t\t\tsinPhi = Math.sin(phi);\n\t\t\t\tcosPhi = Math.cos(phi);\n\t\n\t\t\t\tsunPosition.set(\n\t\t\t\t\tdistance * cosPhi * cosTheta,\n\t\t\t\t\tdistance * sinTheta,\n\t\t\t\t\tdistance * sinPhi * cosTheta\n\t\t\t\t);\n\t\n\t\t\t\tif (light) {\n\t\t\t\t\tlight.intensity = 1.5 * Math.max(0.0, 1.0 - Math.exp(-((Math.PI / 1.95 - Math.abs(HALF_PI - altitude)) / 1.5)));\n\t\t\t\t\tlight.position.copy(sunPosition).normalize().multiplyScalar(100);\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tobj.mesh.name = 'sky';\n\t\n\t\t\tparent.add(obj.mesh);\n\t\n\t\t\twhile (!(scene instanceof THREE.Scene) && scene.parent) {\n\t\t\t\tscene = scene.parent;\n\t\t\t}\n\t\t\tlight = scene.getObjectByName('directional-light');\n\t\n\t\t\tthis.setOptions = function (options) {\n\t\t\t\tvar needUpdate = false,\n\t\t\t\t\taltitude,\n\t\t\t\t\tazimuth;\n\t\n\t\t\t\tif (options) {\n\t\t\t\t\tparams.forEach(function (param) {\n\t\t\t\t\t\tvar val = options[param];\n\t\t\t\t\t\tif (val !== undefined) {\n\t\t\t\t\t\t\tval = parseFloat(val);\n\t\t\t\t\t\t\tif (!isNaN(val)) {\n\t\t\t\t\t\t\t\tobj.uniforms[param].value = val;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\n\t\t\t\t\tif (options.sunPosition instanceof THREE.Vector3) {\n\t\t\t\t\t\tobj.uniforms.sunPosition.value.copy(options.sunPosition);\n\t\t\t\t\t} else if (Array.isArray(options.sunPosition)) {\n\t\t\t\t\t\tobj.uniforms.sunPosition.value.set(obj.uniforms.sunPosition.value, options.sunPosition);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tself.altitude = options.altitude;\n\t\t\t\t\t\tself.azimuth = options.azimuth;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t\tObject.defineProperty(this, 'azimuth', {\n\t\t\t\tset: function (val) {\n\t\t\t\t\tval = mod(parseFloat(val), TAU);\n\t\t\t\t\tif (!isNaN(val) && val !== azimuth) {\n\t\t\t\t\t\tazimuth = val;\n\t\t\t\t\t\tupdate();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tget: function () {\n\t\t\t\t\treturn azimuth;\n\t\t\t\t}\n\t\t\t});\n\t\n\t\t\tObject.defineProperty(this, 'altitude', {\n\t\t\t\tset: function (val) {\n\t\t\t\t\tval = mod(parseFloat(val), TAU);\n\t\t\t\t\tif (!isNaN(val) && val !== altitude) {\n\t\t\t\t\t\taltitude = val;\n\t\t\t\t\t\tupdate();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tget: function() {\n\t\t\t\t\treturn altitude;\n\t\t\t\t}\n\t\t\t});\n\t\n\t\t\tthis.setAltitude = function (val) {\n\t\t\t\tself.altitude = val;\n\t\t\t\treturn this;\n\t\t\t};\n\t\n\t\t\tthis.setAzimuth = function (val) {\n\t\t\t\tself.azimuth = val;\n\t\t\t\treturn this;\n\t\t\t};\n\t\n\t\t\tsunPosition = obj.uniforms.sunPosition.value;\n\t\t\tupdate();\n\t\n\t\t\tthis.setOptions(options);\n\t\n\t\t\tthis.raycastable = false;\n\t\n\t\t\treturn obj.mesh;\n\t\t};\n\t}());\n\n/***/ },\n/* 69 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/*** IMPORTS FROM imports-loader ***/\n\tvar THREE = __webpack_require__(9);\n\t\n\t/**\n\t * @author zz85 / https://github.com/zz85\n\t * \n\t * Based on \"A Practical Analytic Model for Daylight\" \n\t * aka The Preetham Model, the de facto standard analytic skydome model\n\t * http://www.cs.utah.edu/~shirley/papers/sunsky/sunsky.pdf\n\t * \n\t * First implemented by Simon Wallner\n\t * http://www.simonwallner.at/projects/atmospheric-scattering\n\t * \n\t * Improved by Martin Upitis\n\t * http://blenderartists.org/forum/showthread.php?245954-preethams-sky-impementation-HDR\n\t * \n\t * Three.js integration by zz85 http://twitter.com/blurspline\n\t*/\n\t\n\tTHREE.ShaderLib['sky'] = {\n\t\n\t\tuniforms: {\n\t\n\t\t\tluminance:\t { type: \"f\", value:1 },\n\t\t\tturbidity:\t { type: \"f\", value:2 },\n\t\t\treileigh:\t { type: \"f\", value:1 },\n\t\t\tmieCoefficient:\t { type: \"f\", value:0.005 },\n\t\t\tmieDirectionalG: { type: \"f\", value:0.8 },\n\t\t\tsunPosition: \t { type: \"v3\", value: new THREE.Vector3() }\n\t\n\t\t},\n\t\n\t\tvertexShader: [\n\t\n\t\t\t\"varying vec3 vWorldPosition;\",\n\t\t\t\"varying vec2 vUv;\",\n\t\n\t\t\t\"void main() {\",\n\t\n\t\t\t\t\"vec4 worldPosition = modelMatrix * vec4( position, 1.0 );\",\n\t\t\t\t\"vWorldPosition = worldPosition.xyz;\",\n\t\t\t\t\"vUv = uv;\",\n\t\n\t\t\t\t\"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\n\t\n\t\t\t\"}\",\n\t\n\t\t].join(\"\\n\"),\n\t\n\t\tfragmentShader: [\n\t\n\t\n\t\t\t\"uniform sampler2D skySampler;\",\n\t\t\t\"uniform vec3 sunPosition;\",\n\t\t\t\"varying vec3 vWorldPosition;\",\n\t\t\t\"varying vec2 vUv;\",\n\t\n\t\n\t\t\t\"vec3 cameraPos = vec3(0., 0., 0.);\",\n\t\t\t\"// uniform sampler2D sDiffuse;\",\n\t\t\t\"// const float turbidity = 10.0; //\",\n\t\t\t\"// const float reileigh = 2.; //\",\n\t\t\t\"// const float luminance = 1.0; //\",\n\t\t\t\"// const float mieCoefficient = 0.005;\",\n\t\t\t\"// const float mieDirectionalG = 0.8;\",\n\t\n\t\t\t\"uniform float luminance;\",\n\t\t\t\"uniform float turbidity;\",\n\t\t\t\"uniform float reileigh;\",\n\t\t\t\"uniform float mieCoefficient;\",\n\t\t\t\"uniform float mieDirectionalG;\",\n\t\n\t\n\t\t\t\"vec3 sunDirection = normalize(sunPosition);\",\n\t\t\t\"float reileighCoefficient = reileigh;\",\n\t\n\t\t\t\"// constants for atmospheric scattering\",\n\t\t\t\"const float e = 2.71828182845904523536028747135266249775724709369995957;\",\n\t\t\t\"const float pi = 3.141592653589793238462643383279502884197169;\",\n\t\n\t\t\t\"const float n = 1.0003; // refractive index of air\",\n\t\t\t\"const float N = 2.545E25; // number of molecules per unit volume for air at\",\n\t\t\t\t\t\t\t\t\t\"// 288.15K and 1013mb (sea level -45 celsius)\",\n\t\t\t\"const float pn = 0.035;\t// depolatization factor for standard air\",\n\t\n\t\t\t\"// wavelength of used primaries, according to preetham\",\n\t\t\t\"const vec3 lambda = vec3(680E-9, 550E-9, 450E-9);\",\n\t\n\t\t\t\"// mie stuff\",\n\t\t\t\"// K coefficient for the primaries\",\n\t\t\t\"const vec3 K = vec3(0.686, 0.678, 0.666);\",\n\t\t\t\"const float v = 4.0;\",\n\t\n\t\t\t\"// optical length at zenith for molecules\",\n\t\t\t\"const float rayleighZenithLength = 8.4E3;\",\n\t\t\t\"const float mieZenithLength = 1.25E3;\",\n\t\t\t\"const vec3 up = vec3(0.0, 1.0, 0.0);\",\n\t\n\t\t\t\"const float EE = 1000.0;\",\n\t\t\t\"const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;\",\n\t\t\t\"// 66 arc seconds -> degrees, and the cosine of that\",\n\t\n\t\t\t\"// earth shadow hack\",\n\t\t\t\"const float cutoffAngle = pi/1.95;\",\n\t\t\t\"const float steepness = 1.5;\",\n\t\n\t\n\t\t\t\"vec3 totalRayleigh(vec3 lambda)\",\n\t\t\t\"{\",\n\t\t\t\t\"return (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn));\",\n\t\t\t\"}\",\n\t\n\t\t\t// see http://blenderartists.org/forum/showthread.php?321110-Shaders-and-Skybox-madness\n\t\t\t\"// A simplied version of the total Reayleigh scattering to works on browsers that use ANGLE\",\n\t\t\t\"vec3 simplifiedRayleigh()\",\n\t\t\t\"{\",\n\t\t\t\t\"return 0.0005 / vec3(94, 40, 18);\",\n\t\t\t\t// return 0.00054532832366 / (3.0 * 2.545E25 * pow(vec3(680E-9, 550E-9, 450E-9), vec3(4.0)) * 6.245);\n\t\t\t\"}\",\n\t\n\t\t\t\"float rayleighPhase(float cosTheta)\",\n\t\t\t\"{\t \",\n\t\t\t\t\"return (3.0 / (16.0*pi)) * (1.0 + pow(cosTheta, 2.0));\",\n\t\t\t\"//\treturn (1.0 / (3.0*pi)) * (1.0 + pow(cosTheta, 2.0));\",\n\t\t\t\"//\treturn (3.0 / 4.0) * (1.0 + pow(cosTheta, 2.0));\",\n\t\t\t\"}\",\n\t\n\t\t\t\"vec3 totalMie(vec3 lambda, vec3 K, float T)\",\n\t\t\t\"{\",\n\t\t\t\t\"float c = (0.2 * T ) * 10E-18;\",\n\t\t\t\t\"return 0.434 * c * pi * pow((2.0 * pi) / lambda, vec3(v - 2.0)) * K;\",\n\t\t\t\"}\",\n\t\n\t\t\t\"float hgPhase(float cosTheta, float g)\",\n\t\t\t\"{\",\n\t\t\t\t\"return (1.0 / (4.0*pi)) * ((1.0 - pow(g, 2.0)) / pow(1.0 - 2.0*g*cosTheta + pow(g, 2.0), 1.5));\",\n\t\t\t\"}\",\n\t\n\t\t\t\"float sunIntensity(float zenithAngleCos)\",\n\t\t\t\"{\",\n\t\t\t\t\"return EE * max(0.0, 1.0 - exp(-((cutoffAngle - acos(zenithAngleCos))/steepness)));\",\n\t\t\t\"}\",\n\t\n\t\t\t\"// float logLuminance(vec3 c)\",\n\t\t\t\"// {\",\n\t\t\t\"// \treturn log(c.r * 0.2126 + c.g * 0.7152 + c.b * 0.0722);\",\n\t\t\t\"// }\",\n\t\n\t\t\t\"// Filmic ToneMapping http://filmicgames.com/archives/75\",\n\t\t\t\"float A = 0.15;\",\n\t\t\t\"float B = 0.50;\",\n\t\t\t\"float C = 0.10;\",\n\t\t\t\"float D = 0.20;\",\n\t\t\t\"float E = 0.02;\",\n\t\t\t\"float F = 0.30;\",\n\t\t\t\"float W = 1000.0;\",\n\t\n\t\t\t\"vec3 Uncharted2Tonemap(vec3 x)\",\n\t\t\t\"{\",\n\t\t\t   \"return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;\",\n\t\t\t\"}\",\n\t\n\t\n\t\t\t\"void main() \",\n\t\t\t\"{\",\n\t\t\t\t\"float sunfade = 1.0-clamp(1.0-exp((sunPosition.y/450000.0)),0.0,1.0);\",\n\t\n\t\t\t\t\"// luminance =  1.0 ;// vWorldPosition.y / 450000. + 0.5; //sunPosition.y / 450000. * 1. + 0.5;\",\n\t\n\t\t\t\t \"// gl_FragColor = vec4(sunfade, sunfade, sunfade, 1.0);\",\n\t\t\t\t\n\t\t\t\t\"reileighCoefficient = reileighCoefficient - (1.0* (1.0-sunfade));\",\n\t\t\t\t\n\t\t\t\t\"float sunE = sunIntensity(dot(sunDirection, up));\",\n\t\n\t\t\t\t\"// extinction (absorbtion + out scattering) \",\n\t\t\t\t\"// rayleigh coefficients\",\n\t\n\t\t\t\t// \"vec3 betaR = totalRayleigh(lambda) * reileighCoefficient;\",\n\t\t\t\t\"vec3 betaR = simplifiedRayleigh() * reileighCoefficient;\",\n\t\n\t\t\t\t\"// mie coefficients\",\n\t\t\t\t\"vec3 betaM = totalMie(lambda, K, turbidity) * mieCoefficient;\",\n\t\n\t\t\t\t\"// optical length\",\n\t\t\t\t\"// cutoff angle at 90 to avoid singularity in next formula.\",\n\t\t\t\t\"float zenithAngle = acos(max(0.0, dot(up, normalize(vWorldPosition - cameraPos))));\",\n\t\t\t\t\"float sR = rayleighZenithLength / (cos(zenithAngle) + 0.15 * pow(93.885 - ((zenithAngle * 180.0) / pi), -1.253));\",\n\t\t\t\t\"float sM = mieZenithLength / (cos(zenithAngle) + 0.15 * pow(93.885 - ((zenithAngle * 180.0) / pi), -1.253));\",\n\t\n\t\n\t\n\t\t\t\t\"// combined extinction factor\t\",\n\t\t\t\t\"vec3 Fex = exp(-(betaR * sR + betaM * sM));\",\n\t\n\t\t\t\t\"// in scattering\",\n\t\t\t\t\"float cosTheta = dot(normalize(vWorldPosition - cameraPos), sunDirection);\",\n\t\n\t\t\t\t\"float rPhase = rayleighPhase(cosTheta*0.5+0.5);\",\n\t\t\t\t\"vec3 betaRTheta = betaR * rPhase;\",\n\t\n\t\t\t\t\"float mPhase = hgPhase(cosTheta, mieDirectionalG);\",\n\t\t\t\t\"vec3 betaMTheta = betaM * mPhase;\",\n\t\n\t\n\t\t\t\t\"vec3 Lin = pow(sunE * ((betaRTheta + betaMTheta) / (betaR + betaM)) * (1.0 - Fex),vec3(1.5));\",\n\t\t\t\t\"Lin *= mix(vec3(1.0),pow(sunE * ((betaRTheta + betaMTheta) / (betaR + betaM)) * Fex,vec3(1.0/2.0)),clamp(pow(1.0-dot(up, sunDirection),5.0),0.0,1.0));\",\n\t\n\t\t\t\t\"//nightsky\",\n\t\t\t\t\"vec3 direction = normalize(vWorldPosition - cameraPos);\",\n\t\t\t\t\"float theta = acos(direction.y); // elevation --> y-axis, [-pi/2, pi/2]\",\n\t\t\t\t\"float phi = atan(direction.z, direction.x); // azimuth --> x-axis [-pi/2, pi/2]\",\n\t\t\t\t\"vec2 uv = vec2(phi, theta) / vec2(2.0*pi, pi) + vec2(0.5, 0.0);\",\n\t\t\t\t\"// vec3 L0 = texture2D(skySampler, uv).rgb+0.1 * Fex;\",\n\t\t\t\t\"vec3 L0 = vec3(0.1) * Fex;\",\n\t\t\t\t\n\t\t\t\t\"// composition + solar disc\",\n\t\t\t\t\"//if (cosTheta > sunAngularDiameterCos)\",\n\t\t\t\t\"float sundisk = smoothstep(sunAngularDiameterCos,sunAngularDiameterCos+0.00002,cosTheta);\",\n\t\t\t\t\"// if (normalize(vWorldPosition - cameraPos).y>0.0)\",\n\t\t\t\t\"L0 += (sunE * 19000.0 * Fex)*sundisk;\",\n\t\n\t\n\t\t\t\t\"vec3 whiteScale = 1.0/Uncharted2Tonemap(vec3(W));\",\n\t\t\t\t\n\t\t\t\t\"vec3 texColor = (Lin+L0);   \",\n\t\t\t\t\"texColor *= 0.04 ;\",\n\t\t\t\t\"texColor += vec3(0.0,0.001,0.0025)*0.3;\",\n\t\t\t\t\n\t\t\t\t\"float g_fMaxLuminance = 1.0;\",\n\t\t\t\t\"float fLumScaled = 0.1 / luminance;     \",\n\t\t\t\t\"float fLumCompressed = (fLumScaled * (1.0 + (fLumScaled / (g_fMaxLuminance * g_fMaxLuminance)))) / (1.0 + fLumScaled); \",\n\t\n\t\t\t\t\"float ExposureBias = fLumCompressed;\",\n\t\t\t   \n\t\t\t\t\"vec3 curr = Uncharted2Tonemap((log2(2.0/pow(luminance,4.0)))*texColor);\",\n\t\t\t\t\"vec3 color = curr*whiteScale;\",\n\t\n\t\t\t\t\"vec3 retColor = pow(color,vec3(1.0/(1.2+(1.2*sunfade))));\",\n\t\n\t\t\t\t\n\t\t\t\t\"gl_FragColor.rgb = retColor;\",\n\t\t\t\t\t\n\t\t\t\t\"gl_FragColor.a = 1.0;\",\n\t\t\t\"}\",\n\t\n\t\t].join(\"\\n\")\n\t\n\t};\n\t\n\tTHREE.Sky = function () {\n\t\n\t\tvar skyShader = THREE.ShaderLib[ \"sky\" ];\n\t\tvar skyUniforms = THREE.UniformsUtils.clone( skyShader.uniforms );\n\t\n\t\tvar skyMat = new THREE.ShaderMaterial( { \n\t\t\tfragmentShader: skyShader.fragmentShader, \n\t\t\tvertexShader: skyShader.vertexShader, \n\t\t\tuniforms: skyUniforms,\n\t\t\tside: THREE.BackSide\n\t\t} );\n\t\n\t\tvar skyGeo = new THREE.SphereGeometry( 450000, 32, 15 );\n\t\tvar skyMesh = new THREE.Mesh( skyGeo, skyMat );\n\t\n\t\n\t\t// Expose variables\n\t\tthis.mesh = skyMesh;\n\t\tthis.uniforms = skyUniforms;\n\t\n\t\n\t};\n\t\n\n\n/***/ },\n/* 70 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = (function () {\n\t\t'use strict';\n\t\n\t\tvar materials = __webpack_require__(8),\n\t\t\tTHREE = __webpack_require__(9);\n\t\n\t\t__webpack_require__(71);\n\t\n\t\treturn function sound(parent, options) {\n\t\t\tvar obj,\n\t\t\t\tsrc,\n\t\t\t\tlistener,\n\t\t\t\tscene = parent;\n\t\n\t\t\tif (typeof options === 'string' || Array.isArray(options)) {\n\t\t\t\tsrc = options;\n\t\t\t} else if (options) {\n\t\t\t\tsrc = options.src;\n\t\t\t}\n\t\n\t\t\twhile (!(scene instanceof THREE.Scene) && scene.parent) {\n\t\t\t\tscene = scene.parent;\n\t\t\t}\n\t\n\t\t\tlistener = scene.getObjectByName('audio-listener');\n\t\t\tobj = new THREE.Audio(listener);\n\t\t\t// obj.setLoop(true);\n\t\t\tobj.load(src);\n\t\n\t\t\tthis.start = obj.start.bind(obj);\n\t\t\tthis.volume = obj.volume.bind(obj);\n\t\n\t\t\tparent.add(obj);\n\t\n\t\t\treturn obj;\n\t\t};\n\t}());\n\n/***/ },\n/* 71 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/*** IMPORTS FROM imports-loader ***/\n\tvar THREE = __webpack_require__(9);\n\t\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\t\n\tTHREE.Audio = function ( listener ) {\n\t\n\t\tTHREE.Object3D.call( this );\n\t\n\t\tthis.type = 'Audio';\n\t\tthis.started = false;\n\t\n\t\tif (listener.context) {\n\t\n\t\t\tthis.context = listener.context;\n\t\t\t// this.source = this.context.createBufferSource();\n\t\n\t\t\tthis.gain = this.context.createGain();\n\t\t\tthis.gain.connect( listener.input );\n\t\n\t\t\tthis.panner = this.context.createPanner();\n\t\t\tthis.panner.connect( this.gain );\n\t\n\t\t} else {\n\t\n\t\t\tthis.source = new Audio();\n\t\n\t\t}\n\t};\n\t\n\tTHREE.Audio.prototype = Object.create( THREE.Object3D.prototype );\n\t\n\tTHREE.Audio.prototype.load = function ( sources ) {\n\t\t//todo: support multiple sources for different audio formats\n\t\n\t\tvar scope = this;\n\t\tvar file;\n\t\tvar i;\n\t\tvar match;\n\t\tvar element = this.source instanceof window.HTMLAudioElement ? this.source : new Audio();\n\t\n\t\tif (typeof sources === 'string') {\n\t\t\tsources = [sources];\n\t\t}\n\t\n\t\tfor (i = 0; i < sources.length; i++) {\n\t\t\tfile = sources[i];\n\t\t\tmatch = /\\.([a-z0-9]+)$/i.exec(file);\n\t\t\tif (match && element.canPlayType('audio/' + match[1])) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\n\t\tif (this.context) {\n\t\t\tvar request = new XMLHttpRequest();\n\t\t\trequest.open( 'GET', file, true );\n\t\t\trequest.responseType = 'arraybuffer';\n\t\t\trequest.onload = function ( e ) {\n\t\t\t\tconsole.log('audio buffer loaded. decoding...', e );\n\t\t\t\tscope.context.decodeAudioData( this.response, function ( buffer ) {\n\t\n\t\t\t\t\tscope.buffer = buffer;\n\t\t\t\t\tif (scope.started) {\n\t\t\t\t\t\tscope.start();\n\t\t\t\t\t}\n\t\n\t\t\t\t}, function onFailure(e) {\n\t\t\t\t\tconsole.log('Decoding the audio buffer failed', e);\n\t\t\t\t} );\n\t\n\t\t\t};\n\t\n\t\t\trequest.onerror = function ( e ) {\n\t\t\t\tconsole.log('error', e);\n\t\t\t};\n\t\n\t\t\trequest.send();\n\t\n\t\t} else {\n\t\n\t\t\tthis.source.src = file;\n\t\t\tthis.source.play();\n\t\n\t\t}\n\t\n\t\treturn this;\n\t};\n\t\n\tTHREE.Audio.prototype.stop = function ( value ) {\n\t\n\t\tif (this.context) {\n\t\t\tthis.source.stop();\n\t\t\tthis.source.disconnect( this.panner );\n\t\t\tthis.source = null;\n\t\t} else {\n\t\t\tthis.source.pause();\n\t\t\tthis.source.currentTime = 0;\n\t\t}\n\t\tthis.started = false;\n\t};\n\t\n\tTHREE.Audio.prototype.start = function ( value ) {\n\t\n\t\tthis.started = true;\n\t\tif (this.context) {\n\t\t\tif (this.source) {\n\t\t\t\tthis.source.disconnect( this.panner );\n\t\t\t}\n\t\n\t\t\tif (this.buffer) {\n\t\t\t\tthis.source = this.context.createBufferSource();\n\t\t\t\tthis.source.buffer = this.buffer;\n\t\t\t\tthis.source.connect( this.panner );\n\t\t\t\tthis.source.start( 0 );\n\t\t\t}\n\t\t} else {\n\t\t\tthis.source.currentTime = 0;\n\t\t\tthis.source.play();\n\t\t}\n\t\n\t};\n\t\n\tTHREE.Audio.prototype.setLoop = function ( value ) {\n\t\n\t\tthis.source.loop = value;\n\t\n\t};\n\t\n\tTHREE.Audio.prototype.setRefDistance = function ( value ) {\n\t\n\t\tif ( this.panner ) {\n\t\n\t\t\tthis.panner.refDistance = value;\n\t\n\t\t}\n\t\n\t};\n\t\n\tTHREE.Audio.prototype.setRolloffFactor = function ( value ) {\n\t\n\t\tif ( this.panner ) {\n\t\n\t\t\tthis.panner.rolloffFactor = value;\n\t\n\t\t}\n\t\n\t};\n\t\n\tTHREE.Audio.prototype.volume = function ( volume, time ) {\n\t\n\t\tif ( this.gain ) {\n\t\n\t\t\tif ( volume !== undefined ) {\n\t\t\t\tthis.gain.gain.linearRampToValueAtTime( volume, this.context.currentTime + (time || 0));\n\t\t\t}\n\t\n\t\t\treturn this.gain.gain.value;\n\t\t}\n\t\n\t\tif ( volume !== undefined ) {\n\t\t\tthis.source.volume = volume;\n\t\t}\n\t\n\t\treturn this.source.volume;\n\t};\n\t\n\tTHREE.Audio.prototype.updateMatrixWorld = ( function () {\n\t\n\t\tvar position = new THREE.Vector3();\n\t\n\t\treturn function ( force ) {\n\t\n\t\t\tTHREE.Object3D.prototype.updateMatrixWorld.call( this, force );\n\t\n\t\t\tposition.setFromMatrixPosition( this.matrixWorld );\n\t\n\t\t\tif (this.panner) {\n\t\n\t\t\t\tthis.panner.setPosition( position.x, position.y, position.z );\n\t\n\t\t\t}\n\t\n\t\t};\n\t\n\t} )();\n\t\n\t// File:src/extras/audio/AudioListener.js\n\t\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\t\n\tTHREE.AudioListener = function () {\n\t\tvar AudioContext = window.AudioContext || window.webkitAudioContext;\n\t\n\t\tTHREE.Object3D.call( this );\n\t\n\t\tthis.type = 'AudioListener';\n\t\n\t\tif (AudioContext) {\n\t\t\tthis.context = new AudioContext();\n\t\t\tthis.input = this.context.createGain();\n\t\n\t\t\tthis.input.connect( this.context.destination );\n\t\t}\n\t};\n\t\n\tTHREE.AudioListener.prototype = Object.create( THREE.Object3D.prototype );\n\t\n\tTHREE.AudioListener.prototype.volume = function (val) {\n\t\tif (this.input) {\n\t\t\tval = val !== undefined && parseFloat(val);\n\t\t\tif (!isNaN(val)) {\n\t\t\t\tthis.input.gain.value = val;\n\t\t\t}\n\t\n\t\t\treturn this.input.gain.value;\n\t\t}\n\t};\n\t\n\tTHREE.AudioListener.prototype.updateMatrixWorld = ( function () {\n\t\n\t\tvar position = new THREE.Vector3();\n\t\tvar quaternion = new THREE.Quaternion();\n\t\tvar scale = new THREE.Vector3();\n\t\n\t\tvar orientation = new THREE.Vector3();\n\t\n\t\treturn function ( force ) {\n\t\n\t\t\tTHREE.Object3D.prototype.updateMatrixWorld.call( this, force );\n\t\n\t\t\tvar listener;\n\t\n\t\t\tif (this.context) {\n\t\t\t\tlistener = this.context.listener;\n\t\n\t\t\t\tthis.matrixWorld.decompose( position, quaternion, scale );\n\t\n\t\t\t\torientation.set( 0, 0, -1 ).applyQuaternion( quaternion );\n\t\n\t\t\t\tlistener.setPosition( position.x, position.y, position.z );\n\t\t\t\tlistener.setOrientation( orientation.x, orientation.y, orientation.z, this.up.x, this.up.y, this.up.z );\n\t\n\t\t\t}\n\t\t};\n\t\n\t} ());\n\t\n\t\n\n\n/***/ },\n/* 72 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = (function () {\n\t\t'use strict';\n\t\n\t\tvar materials = __webpack_require__(8),\n\t\t\tTHREE = __webpack_require__(9);\n\t\n\t\treturn function box(parent, options) {\n\t\t\tvar geometry,\n\t\t\t\tmesh;\n\t\n\t\t\tgeometry = new THREE.SphereGeometry(\n\t\t\t\toptions.radius === undefined ? 0.5 : options.radius,\n\t\t\t\toptions.widthSegments === undefined ? 16 : options.widthSegments,\n\t\t\t\toptions.heightSegments === undefined ? 12 : options.heightSegments,\n\t\t\t\toptions.phiStart,\n\t\t\t\toptions.phiLength,\n\t\t\t\toptions.thetaStart,\n\t\t\t\toptions.thetaLength\n\t\t\t);\n\t\t\tmesh = new THREE.Mesh(geometry, materials.standard());\n\t\t\tmesh.name = 'sphere';\n\t\n\t\t\tparent.add(mesh);\n\t\n\t\t\treturn mesh;\n\t\t};\n\t}());\n\n/***/ },\n/* 73 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = (function () {\n\t\t'use strict';\n\t\n\t\tvar THREE = __webpack_require__(9),\n\t\t\tfontSizeRegex = /(\\d+)px/i,\n\t\t\tnewLineRegex = /[\\n\\r]/,\n\t\t\tspaceRegex = /[\\t ]/,\n\t\t\tlog2 = Math.log(2),\n\t\t\tgeometry = new THREE.PlaneBufferGeometry(1, 1);\n\t\n\t\treturn function text(parent, options) {\n\t\t\tvar self = this,\n\t\t\t\tmaterial,\n\t\t\t\tcanvas,\n\t\t\t\tctx,\n\t\t\t\tmesh,\n\t\t\t\tcontainer,\n\t\t\t\tsrc,\n\t\t\t\ttextWidth = 0,\n\t\t\t\ttextHeight = 0,\n\t\t\t\tprops = {\n\t\t\t\t\ttext: '',\n\t\t\t\t\tfont: '80px sans-serif',\n\t\t\t\t\ttextAlign: 'center',\n\t\t\t\t\ttextBaseline: '',\n\t\t\t\t\tdirection: '',\n\t\t\t\t\tfillStyle: 'white',\n\t\t\t\t\tresolution: 256, //pixels per meter\n\t\t\t\t\twrap: 5 //in meters\n\t\t\t\t},\n\t\t\t\ttex;\n\t\n\t\t\tfunction nextPowerOfTwo(n) {\n\t\t\t\treturn Math.pow(2, Math.ceil(Math.log(n) / log2));\n\t\t\t}\n\t\n\t\t\tfunction Line(word) {\n\t\t\t\tthis.spaceWidth = ctx.measureText(' ').width;\n\t\t\t\tthis.totalWidth = 0;\n\t\t\t\tthis.wordsWidth = 0;\n\t\t\t\tthis.words = [];\n\t\t\t\tthis.wrap = false;\n\t\t\t\tif (word) {\n\t\t\t\t\tthis.add(word);\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tLine.prototype.text = function () {\n\t\t\t\treturn this.words.join(' ');\n\t\t\t};\n\t\n\t\t\tLine.prototype.add = function(word) {\n\t\t\t\tvar wordWidth;\n\t\t\t\tif (this.words.length) {\n\t\t\t\t\tthis.totalWidth += this.spaceWidth;\n\t\t\t\t}\n\t\t\t\tthis.words.push(word);\n\t\t\t\twordWidth = Line.measure(word);\n\t\t\t\tthis.totalWidth += wordWidth;\n\t\t\t\tthis.wordsWidth += wordWidth;\n\t\t\t};\n\t\n\t\t\tLine.prototype.measure = function(word) {\n\t\t\t\tvar width = this.totalWidth;\n\t\t\t\tif (word) {\n\t\t\t\t\twidth += Line.measure(word);\n\t\t\t\t\tif (this.words.length) {\n\t\t\t\t\t\twidth += this.spaceWidth;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn width;\n\t\t\t};\n\t\n\t\t\tLine.measure = function(word) {\n\t\t\t\treturn ctx.measureText(word).width;\n\t\t\t};\n\t\n\t\t\tfunction update() {\n\t\t\t\t//text stuffs\n\t\t\t\tvar text,\n\t\t\t\t\tword = '',\n\t\t\t\t\tletter,\n\t\t\t\t\tisSpace,\n\t\t\t\t\tline,\n\t\t\t\t\tlines = [],\n\t\t\t\t\tparse,\n\t\n\t\t\t\t\t//layout\n\t\t\t\t\tdirection = getComputedStyle(document.body).direction,\n\t\t\t\t\tinherit,\n\t\t\t\t\tresolution = parseFloat(props.resolution) || 256,\n\t\t\t\t\twrap,\n\t\t\t\t\twrapped = false,\n\t\t\t\t\tfontSize,\n\t\t\t\t\tpadding,\n\t\n\t\t\t\t\t//measurements\n\t\t\t\t\tlineHeight,\n\t\t\t\t\ti, start, y, measure,\n\t\t\t\t\twidth,\n\t\t\t\t\theight = 0;\n\t\n\t\t\t\twrap = parseFloat(props.wrap);\n\t\t\t\tif (isNaN(wrap) || wrap < 0) {\n\t\t\t\t\twrap = 5;\n\t\t\t\t}\n\t\t\t\twidth = resolution * wrap;\n\t\n\t\t\t\tctx.font = props.font;\n\t\t\t\tparse = fontSizeRegex.exec(ctx.font);\n\t\t\t\tfontSize = parseFloat(parse && parse[1]) || 50;\n\t\n\t\t\t\tlineHeight = fontSize * 1.5;\n\t\n\t\t\t\tline = new Line();\n\t\n\t\t\t\ttext = props.text === 0 ? '0' : String(props.text || '');\n\t\t\t\tif (wrap) {\n\t\t\t\t\ttext = text.trim() + ' ';\n\t\t\t\t\tfor (i = 0; i < text.length; i++) {\n\t\t\t\t\t\tletter = text.charAt(i);\n\t\t\t\t\t\tif (newLineRegex.test(letter)) {\n\t\t\t\t\t\t\tline.add(word);\n\t\t\t\t\t\t\tlines.push(line);\n\t\t\t\t\t\t\tword = '';\n\t\t\t\t\t\t\tline = new Line();\n\t\t\t\t\t\t} else if (spaceRegex.test(letter)) {\n\t\t\t\t\t\t\tmeasure = line.measure(word);\n\t\t\t\t\t\t\tif (measure < width) {\n\t\t\t\t\t\t\t\tif (line) {\n\t\t\t\t\t\t\t\t\tline.add(word);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tline = new Line(word);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else if (!line && Line.measure(word) >= width) {\n\t\t\t\t\t\t\t\t//one very long word\n\t\t\t\t\t\t\t\tlines.push(new Line(word));\n\t\t\t\t\t\t\t\tword = '';\n\t\t\t\t\t\t\t\tline = new Line();\n\t\t\t\t\t\t\t\twrapped = true;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tline.wrap = true;\n\t\t\t\t\t\t\t\tlines.push(line);\n\t\t\t\t\t\t\t\tline = new Line(word);\n\t\t\t\t\t\t\t\twrapped = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tword = '';\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tword += letter;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (line) {\n\t\t\t\t\t\tlines.push(line);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tlines.push(new Line(text));\n\t\t\t\t}\n\t\n\t\t\t\tif (!width || !wrapped) {\n\t\t\t\t\twidth = lines.reduce(function (previous, line) {\n\t\t\t\t\t\treturn Math.max(previous, line.totalWidth);\n\t\t\t\t\t}, 0);\n\t\t\t\t}\n\t\t\t\twidth = Math.min(width, 2048);\n\t\n\t\t\t\theight = lines.length * lineHeight;\n\t\n\t\t\t\tif (options && options.mipmap === false) {\n\t\t\t\t\tcanvas.width = width;\n\t\t\t\t\tcanvas.height = height;\n\t\t\t\t} else {\n\t\t\t\t\tcanvas.width = nextPowerOfTwo(width);\n\t\t\t\t\tcanvas.height = nextPowerOfTwo(height);\n\t\t\t\t}\n\t\n\t\t\t\tmesh.scale.set(canvas.width / resolution, canvas.height / resolution, 1);\n\t\n\t\t\t\t//debug\n\t\t\t\t// ctx.fillStyle = 'rgba(100, 100, 100, 0.5)';\n\t\t\t\t// ctx.fillRect(0, 0, canvas.width, canvas.height);\n\t\t\t\t// document.body.appendChild(canvas);\n\t\t\t\t// canvas.style.cssText = 'position: absolute; width: auto !important; height: auto !important; max-width: 80%';\n\t\n\t\t\t\t/*\n\t\t\t\tset all these properties again because they get reset\n\t\t\t\twhen you resize the canvas\n\t\t\t\t*/\n\t\t\t\tctx.font = props.font;\n\t\t\t\tctx.textAlign = props.textAlign;\n\t\t\t\tctx.textBaseline = props.textBaseline;\n\t\t\t\tctx.direction = props.direction;\n\t\t\t\tctx.fillStyle = props.fillStyle;\n\t\t\t\t//todo: add maxWidth?\n\t\n\t\t\t\tpadding = (canvas.width - width) / 2;\n\t\t\t\ty = (canvas.height - height) / 2 + lineHeight / 2;\n\t\n\t\t\t\tinherit = (ctx.direction === '' || ctx.direction === 'inherit');\n\t\t\t\tif (ctx.textAlign === 'center') {\n\t\t\t\t\tstart = canvas.width / 2;\n\t\t\t\t} else if (ctx.textAlign === 'right' ||\n\t\t\t\t\tctx.textAlign === 'end' && (ctx.direction === 'ltr' || inherit && direction === 'ltr') ||\n\t\t\t\t\tctx.textAlign === 'start' && (ctx.direction === 'rtl' || inherit && direction === 'rtl')) {\n\t\n\t\t\t\t\tstart = canvas.width - padding;\n\t\t\t\t} else {\n\t\t\t\t\tstart = padding;\n\t\t\t\t}\n\t\n\t\t\t\tlines.forEach(function (line) {\n\t\t\t\t\tvar x,\n\t\t\t\t\t\tspace;\n\t\t\t\t\tif (props.textAlign === 'justify' && line.wrap && line.words.length > 1) {\n\t\t\t\t\t\tx = start;\n\t\t\t\t\t\tspace = (width - line.wordsWidth) / (line.words.length - 1);\n\t\t\t\t\t\tline.words.forEach(function (word) {\n\t\t\t\t\t\t\tctx.fillText(word, x, y);\n\t\t\t\t\t\t\tx += space + Line.measure(word);\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tctx.fillText(line.text(), start, y);\n\t\t\t\t\t}\n\t\t\t\t\ty += lineHeight;\n\t\t\t\t});\n\t\n\t\t\t\ttextWidth = width / resolution;\n\t\t\t\ttextHeight = lines.length * lineHeight / resolution;\n\t\n\t\t\t\ttex.needsUpdate = true;\n\t\n\t\t\t\tmesh.name = text.trim();\n\t\t\t}\n\t\n\t\t\tcanvas = document.createElement('canvas');\n\t\t\tctx = canvas.getContext('2d');\n\t\t\ttex = new THREE.Texture(canvas);\n\t\n\t\t\tif (canvas.width === nextPowerOfTwo(canvas.width) &&\n\t\t\t\tcanvas.height === nextPowerOfTwo(canvas.height)) {\n\t\n\t\t\t\ttex.minFilter = THREE.LinearMipMapLinearFilter;\n\t\t\t\ttex.generateMipmaps = true;\n\t\t\t}\n\t\n\t\t\tmaterial = new THREE.MeshBasicMaterial({\n\t\t\t\tside: THREE.DoubleSide,\n\t\t\t\ttransparent: true,\n\t\t\t\tmap: tex\n\t\t\t});\n\t\n\t\t\tmesh = new THREE.Mesh(geometry, material);\n\t\n\t\t\tcontainer = new THREE.Object3D();\n\t\t\tcontainer.name = 'text';\n\t\t\tcontainer.add(mesh);\n\t\t\tparent.add(container);\n\t\n\t\t\tif (typeof options === 'string') {\n\t\t\t\tprops.text = options;\n\t\t\t} else if (options) {\n\t\t\t\tObject.keys(props).forEach(function (key) {\n\t\t\t\t\tprops[key] = options[key] || props[key];\n\t\t\t\t});\n\t\t\t}\n\t\t\tupdate();\n\t\n\t\t\tObject.keys(props).forEach(function (key) {\n\t\t\t\tObject.defineProperty(self, key, {\n\t\t\t\t\tget: function () {\n\t\t\t\t\t\treturn props[key];\n\t\t\t\t\t},\n\t\t\t\t\tset: function (val) {\n\t\t\t\t\t\tprops[key] = val;\n\t\t\t\t\t\tupdate();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\n\t\t\tObject.defineProperty(self, 'width', {\n\t\t\t\tget: function () {\n\t\t\t\t\treturn textWidth;\n\t\t\t\t}\n\t\t\t});\n\t\n\t\t\tObject.defineProperty(self, 'height', {\n\t\t\t\tget: function () {\n\t\t\t\t\treturn textHeight;\n\t\t\t\t}\n\t\t\t});\n\t\n\t\t\tthis.material = material;\n\t\n\t\t\treturn container;\n\t\t};\n\t}());\n\n/***/ },\n/* 74 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = (function () {\n\t\t'use strict';\n\t\n\t\tvar materials = __webpack_require__(8),\n\t\t\tTHREE = __webpack_require__(9);\n\t\n\t\treturn function torus(parent, options) {\n\t\t\tvar geometry,\n\t\t\t\tmesh;\n\t\n\t\t\tgeometry = new THREE.TorusGeometry(\n\t\t\t\toptions.radius === undefined ? 0.5 : options.radius,\n\t\t\t\toptions.tube === undefined ? 0.125 : options.tube,\n\t\t\t\toptions.radialSegments === undefined ? 12 : options.radialSegments,\n\t\t\t\toptions.tubularSegments === undefined ? 16 : options.tubularSegments,\n\t\t\t\toptions.arc\n\t\t\t);\n\t\t\tmesh = new THREE.Mesh(geometry, materials.standard());\n\t\t\tmesh.name = 'torus';\n\t\n\t\t\tparent.add(mesh);\n\t\n\t\t\treturn mesh;\n\t\t};\n\t}());\n\n/***/ },\n/* 75 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = (function () {\n\t\t'use strict';\n\t\n\t\tvar THREE = __webpack_require__(9),\n\t\t\turlRegex = __webpack_require__(24),\n\t\t\textRegex = /\\.(webm|ogg|ogv|m4v|mp4|mov)/i,\n\t\t\tvideo;\n\t\n\t\tvideo = function (parent, options) {\n\t\t\tvar geometry,\n\t\t\t\tmaterial,\n\t\t\t\tmesh,\n\t\t\t\tvid,\n\t\t\t\ttex,\n\t\t\t\taspectRatio = 1,\n\t\t\t\tplaying = false,\n\t\t\t\tself = this;\n\t\n\t\t\tfunction isPowerOfTwo(num) {\n\t\t\t\treturn num > 0 && (num & (num-1)) === 0; // jshint ignore:line\n\t\t\t}\n\t\n\t\t\tfunction loadedMetadata() {\n\t\t\t\t//todo: don't do any of this if object has been deleted\n\t\n\t\t\t\tvar newAspectRatio = vid.videoWidth / vid.videoHeight;\n\t\t\t\tif (!options || !options.sphere) {\n\t\t\t\t\tgeometry.applyMatrix(new THREE.Matrix4().makeScale(1, aspectRatio / newAspectRatio, 1));\n\t\t\t\t}\n\t\t\t\taspectRatio = newAspectRatio;\n\t\n\t\t\t\tif (vid.videoWidth === vid.videoHeight &&\n\t\t\t\t\t\tisPowerOfTwo(vid.videoWidth) && isPowerOfTwo(vid.videoHeight)) {\n\t\n\t\t\t\t\ttex.minFilter = THREE.LinearMipMapLinearFilter;\n\t\t\t\t\ttex.generateMipmaps = true;\n\t\t\t\t} else {\n\t\t\t\t\ttex.minFilter = THREE.LinearFilter;\n\t\t\t\t\ttex.generateMipmaps = false;\n\t\t\t\t}\n\t\n\t\t\t\tmaterial.map = tex;\n\t\t\t\tmaterial.visible = true;\n\t\n\t\t\t\tif (playing) {\n\t\t\t\t\tvid.play();\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tfunction setSource(sources) {\n\t\t\t\tsources.forEach(function (src) {\n\t\t\t\t\tvar parse,\n\t\t\t\t\t\text,\n\t\t\t\t\t\tsource;\n\t\n\t\t\t\t\tif (!src) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\n\t\t\t\t\tparse = urlRegex.exec(src);\n\t\t\t\t\tif (parse &&\n\t\t\t\t\t\t\t(parse[1] && parse[1] !== window.location.host ||\n\t\t\t\t\t\t\t\tparse[2] && parse[2] !== window.location.port)) {\n\t\n\t\t\t\t\t\tif (vid.crossOrigin !== undefined) {\n\t\t\t\t\t\t\tvid.crossOrigin = 'anonymous';\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconsole.warn('Browser does not support cross-origin video');\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tsource = document.createElement('source');\n\t\t\t\t\tsource.src = src;\n\t\n\t\t\t\t\text = extRegex.exec(src);\n\t\t\t\t\tif (!ext || vid.canPlayType('video/' + ext[1])) {\n\t\t\t\t\t\tvid.appendChild(source);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\n\t\t\t/*\n\t\t\tPause the video when this browser tab is in the background or minimized.\n\t\t\tResume when it comes back in focus, but only if the user didn't pause manually.\n\t\t\t*/\n\t\t\tfunction visibilityChange() {\n\t\t\t\tif (document.hidden || document.mozHidden || document.msHidden || document.webkitHidden) {\n\t\t\t\t\tvid.pause();\n\t\t\t\t} else if (playing) {\n\t\t\t\t\tvid.play();\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tvid = document.createElement('video');\n\t\t\tvid.loop = true;\n\t\t\tvid.addEventListener('loadedmetadata', loadedMetadata, false);\n\t\n\t\t\tif (Array.isArray(options)) {\n\t\t\t\tsetSource(options);\n\t\t\t} if (typeof options === 'string') {\n\t\t\t\tsetSource([options]);\n\t\t\t} else if (typeof options.src === 'string') {\n\t\t\t\tsetSource([options.src]);\n\t\t\t} else if (Array.isArray(options.src)) {\n\t\t\t\tsetSource(options.src);\n\t\t\t}\n\t\n\t\t\tvid.load();\n\t\n\t\t\ttex = new THREE.VideoTexture(vid, THREE.UVMapping);\n\t\t\ttex.format = THREE.RGBFormat;\n\t\n\t\t\tif (options && options.sphere) {\n\t\t\t\tgeometry = new THREE.SphereGeometry(\n\t\t\t\t\t994, //radius\n\t\t\t\t\t60, //widthSegments\n\t\t\t\t\t60, //heightSegments\n\t\t\t\t\t(parseFloat(options.phiStart) || 0) * Math.PI * 2,\n\t\t\t\t\t(parseFloat(options.phiLength) || 1) * Math.PI * 2,\n\t\t\t\t\t(parseFloat(options.thetaStart) || 0) * Math.PI,\n\t\t\t\t\t(parseFloat(options.thetaLength) || 1) * Math.PI\n\t\t\t\t);\n\t\t\t\tgeometry.applyMatrix(new THREE.Matrix4().makeScale(-1, 1, 1));\n\t\t\t\tgeometry.applyMatrix(new THREE.Matrix4().makeRotationY(- Math.PI / 2));\n\t\t\t} else {\n\t\t\t\tgeometry = new THREE.PlaneBufferGeometry(1, 1, 8);\n\t\t\t}\n\t\n\t\t\tmaterial = new THREE.MeshBasicMaterial({\n\t\t\t\tside: THREE.DoubleSide,\n\t\t\t\tmap: tex,\n\t\t\t\tvisible: false\n\t\t\t});\n\t\n\t\t\tmesh = new THREE.Mesh(geometry, material);\n\t\n\t\t\tif (options && options.stereo) {\n\t\t\t\tif (options.stereo === 'vertical') {\n\t\t\t\t\ttex.repeat.y = 0.5;\n\t\t\t\t} else {\n\t\t\t\t\ttex.repeat.x = 0.5;\n\t\t\t\t}\n\t\t\t\tmesh.userData.stereo = options.stereo;\n\t\t\t}\n\t\n\t\t\tif (vid.readyState) {\n\t\t\t\tloadedMetadata();\n\t\t\t}\n\t\n\t\t\tthis.play = function play() {\n\t\t\t\tplaying = true;\n\t\t\t\tvid.play();\n\t\t\t\treturn this;\n\t\t\t};\n\t\n\t\t\tthis.pause = function pause() {\n\t\t\t\tplaying = false;\n\t\t\t\tvid.pause();\n\t\t\t\treturn this;\n\t\t\t};\n\t\n\t\t\tthis.canPlayType = video.canPlayType;\n\t\n\t\t\tObject.defineProperty(this, 'width', {\n\t\t\t\tget: function () {\n\t\t\t\t\treturn vid.videoWidth;\n\t\t\t\t}\n\t\t\t});\n\t\n\t\t\tObject.defineProperty(this, 'height', {\n\t\t\t\tget: function () {\n\t\t\t\t\treturn vid.videoHeight;\n\t\t\t\t}\n\t\t\t});\n\t\n\t\t\tObject.defineProperty(this, 'paused', {\n\t\t\t\tget: function () {\n\t\t\t\t\treturn !playing;\n\t\t\t\t}\n\t\t\t});\n\t\n\t\t\tObject.defineProperty(this, 'volume', {\n\t\t\t\tget: function () {\n\t\t\t\t\treturn vid.volume;\n\t\t\t\t},\n\t\t\t\tset: function (vol) {\n\t\t\t\t\tvid.volume = vol;\n\t\t\t\t}\n\t\t\t});\n\t\n\t\t\tObject.defineProperty(this, 'muted', {\n\t\t\t\tget: function () {\n\t\t\t\t\treturn vid.muted;\n\t\t\t\t},\n\t\t\t\tset: function (muted) {\n\t\t\t\t\tvid.muted = muted;\n\t\t\t\t}\n\t\t\t});\n\t\n\t\t\tObject.defineProperty(this, 'duration', {\n\t\t\t\tget: function () {\n\t\t\t\t\treturn vid.duration || 0;\n\t\t\t\t}\n\t\t\t});\n\t\n\t\t\tObject.defineProperty(this, 'currentTime', {\n\t\t\t\tget: function () {\n\t\t\t\t\treturn vid.currentTime;\n\t\t\t\t},\n\t\t\t\tset: function (currentTime) {\n\t\t\t\t\tif (vid.readyState && currentTime < vid.duration && currentTime >= 0) {\n\t\t\t\t\t\tvid.currentTime = currentTime;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\n\t\t\t[\n\t\t\t\t'loadedmetadata',\n\t\t\t\t'play',\n\t\t\t\t'pause',\n\t\t\t\t'playing',\n\t\t\t\t'progress'\n\t\t\t].forEach(function registerMediaEvent(event) {\n\t\t\t\tvid.addEventListener(event, self.emit.bind(self, event));\n\t\t\t});\n\t\n\t\t\t//sometimes video fails to play because it's too big. remove it and try again\n\t\t\tvid.addEventListener('error', function (evt) {\n\t\t\t\tif (vid.error.code === window.MediaError.MEDIA_ERR_DECODE && vid.childNodes.length > 1) {\n\t\t\t\t\tmaterial.visible = false;\n\t\t\t\t\tvid.removeChild(vid.firstChild);\n\t\t\t\t\tvid.load();\n\t\t\t\t}\n\t\n\t\t\t\tself.emit(event, evt);\n\t\t\t}, true);\n\t\n\t\t\tthis.element = vid;\n\t\n\t\t\twindow.addEventListener('touchstart', function touchStart() {\n\t\t\t\tif (playing) {\n\t\t\t\t\tvid.play();\n\t\t\t\t} else {\n\t\t\t\t\tvid.load();\n\t\t\t\t}\n\t\t\t\twindow.removeEventListener('touchstart', touchStart, true);\n\t\t\t}, true);\n\t\n\t\t\t//pause when window is hidden\n\t\t\tdocument.addEventListener('visibilitychange', visibilityChange);\n\t\t\tdocument.addEventListener('mozvisibilitychange', visibilityChange);\n\t\t\tdocument.addEventListener('msvisibilitychange', visibilityChange);\n\t\t\tdocument.addEventListener('webkitvisibilitychange', visibilityChange);\n\t\n\t\t\tmesh.name = 'video';\n\t\t\tthis.raycastable = !(options && options.sphere);\n\t\t\tparent.add(mesh);\n\t\n\t\t\treturn mesh;\n\t\t};\n\t\n\t\tvideo.canPlayType = function canPlayType(type) {\n\t\t\tvar element = document.createElement('video');\n\t\t\treturn element.canPlayType(type);\n\t\t};\n\t\n\t\treturn video;\n\t}());\n\n/***/ },\n/* 76 */\n/***/ function(module, exports) {\n\n\tmodule.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"8\\\" height=\\\"8\\\" viewBox=\\\"0 0 8 8\\\">\\n  <path d=\\\"M0 0v4l1.5-1.5 1.5 1.5 1-1-1.5-1.5 1.5-1.5h-4zm5 4l-1 1 1.5 1.5-1.5 1.5h4v-4l-1.5 1.5-1.5-1.5z\\\" />\\n</svg>\"\n\n/***/ },\n/* 77 */\n/***/ function(module, exports) {\n\n\tmodule.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"8\\\" height=\\\"8\\\" viewBox=\\\"0 0 8 8\\\">\\n  <path d=\\\"M1 0l-1 1 1.5 1.5-1.5 1.5h4v-4l-1.5 1.5-1.5-1.5zm3 4v4l1.5-1.5 1.5 1.5 1-1-1.5-1.5 1.5-1.5h-4z\\\" />\\n</svg>\"\n\n/***/ },\n/* 78 */\n/***/ function(module, exports) {\n\n\tmodule.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"8\\\" height=\\\"8\\\" viewBox=\\\"0 0 8 8\\\">\\n  <path d=\\\"M4.03 0c-2.53 0-4.03 3-4.03 3s1.5 3 4.03 3c2.47 0 3.97-3 3.97-3s-1.5-3-3.97-3zm-.03 1c1.11 0 2 .9 2 2 0 1.11-.89 2-2 2-1.1 0-2-.89-2-2 0-1.1.9-2 2-2zm0 1c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1c0-.1-.04-.19-.06-.28-.08.16-.24.28-.44.28-.28 0-.5-.22-.5-.5 0-.2.12-.36.28-.44-.09-.03-.18-.06-.28-.06z\\\"\\n  transform=\\\"translate(0 1)\\\" />\\n</svg>\"\n\n/***/ },\n/* 79 */\n/***/ function(module, exports) {\n\n\tmodule.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"8\\\" height=\\\"8\\\" viewBox=\\\"0 0 8 8\\\">\\n  <path d=\\\"M4 0c-2.2 0-4 1.8-4 4s1.8 4 4 4 4-1.8 4-4-1.8-4-4-4zm0 1c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm2 1l-3 1-1 3 3-1 1-3zm-2 1.5c.28 0 .5.22.5.5s-.22.5-.5.5-.5-.22-.5-.5.22-.5.5-.5z\\\" />\\n</svg>\"\n\n/***/ }\n/******/ ]);\n\n\n/** WEBPACK FOOTER **\n ** vr.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 46cd3bd8cb2399238d75\n **/","(function () {\n\t'use strict';\n\n\t//global-ish declarations\n\tvar VR,\n\t\tNoSleep = require('nosleep').NoSleep,\n\t\tisMobile = require('ismobilejs');\n\n\tfunction initRequirements() {\n\t\t//load styles\n\t\trequire('!style!css!./css/style.css');\n\n\t\tVR = require('./vr');\n\t}\n\n\tfunction initUI() {\n\t\tvar container,\n\t\t\tenableFullscreen,\n\t\t\tdisableFullscreen,\n\t\t\tvrButton,\n\t\t\torientationButton,\n\t\t\telement,\n\n\t\t\tnoSleep = new NoSleep(),\n\n\t\t\tfullScreenElement = document.body,\n\n\t\t\tfullscreenEnabled = document.fullscreenEnabled ||\n\t\t\t\tdocument.webkitFullscreenEnabled ||\n\t\t\t\tdocument.mozFullScreenEnabled ||\n\t\t\t\tdocument.msFullscreenEnabled,\n\n\t\t\trequestFullscreen = fullScreenElement.webkitRequestFullscreen ||\n\t\t\t\tfullScreenElement.mozRequestFullScreen ||\n\t\t\t\tfullScreenElement.msRequestFullscreen;\n\n\t\tfunction svgButton(source, id) {\n\t\t\tvar span = document.createElement('span'),\n\t\t\t\tsvg;\n\n\t\t\tspan.innerHTML = source;\n\t\t\tspan.id = id;\n\n\t\t\tsvg = span.firstChild;\n\t\t\tsvg.setAttribute('width', 18);\n\t\t\tsvg.setAttribute('height', 18);\n\n\t\t\tcontainer.appendChild(span);\n\n\t\t\treturn span;\n\t\t}\n\n\t\tfunction toggleOrientation() {\n\t\t\tif (VR.orientationEnabled()) {\n\t\t\t\tVR.disableOrientation();\n\t\t\t} else {\n\t\t\t\tVR.enableOrientation();\n\t\t\t}\n\t\t}\n\n\t\tfunction deviceChange() {\n\t\t\tif (VR.controlMode()) {\n\t\t\t\tvrButton.classList.remove('unsupported');\n\t\t\t\torientationButton.classList.remove('unsupported');\n\t\t\t}\n\n\t\t\t//todo: enable this\n\t\t\t//info.innerHTML = hmd && hmd.deviceName ? 'HMD: ' + hmd.deviceName : '';\n\t\t\t//info.className = hmd && hmd.deviceId !== 'debug-0' ? 'has-hmd' : '';\n\t\t}\n\n\t\t//set up meta viewport tag for mobile devices\n\t\telement = document.createElement('meta');\n\t\telement.setAttribute('name', 'viewport');\n\t\telement.setAttribute('content', 'width=device-width, initial-scale=1, user-scalable=no');\n\t\tdocument.head.appendChild(element);\n\n\t\tcontainer = document.createElement('div');\n\t\tcontainer.id = 'buttons';\n\t\tdocument.body.appendChild(container);\n\n\t\t//todo: use icons instead of text\n\t\tif (requestFullscreen && fullscreenEnabled) {\n\t\t\tenableFullscreen = svgButton(require('raw!open-iconic/svg/fullscreen-enter.svg'), 'fs-enable');\n\t\t\tenableFullscreen.setAttribute('title', 'Enable Full Screen');\n\t\t\tenableFullscreen.addEventListener('click', requestFullscreen.bind(fullScreenElement), false);\n\n\t\t\tdisableFullscreen = svgButton(require('raw!open-iconic/svg/fullscreen-exit.svg'), 'fs-disable');\n\t\t\tdisableFullscreen.setAttribute('title', 'Exit Full Screen');\n\t\t\tdisableFullscreen.addEventListener('click', VR.exitFullscreen, false);\n\t\t}\n\n\t\tVR.on('fullscreenchange', function () {\n\t\t\tif (VR.isFullscreen()) {\n\t\t\t\tdisableFullscreen.style.display = 'inline-block';\n\t\t\t\tenableFullscreen.style.display = 'none';\n\t\t\t} else {\n\t\t\t\tdisableFullscreen.style.display = '';\n\t\t\t\tenableFullscreen.style.display = '';\n\t\t\t}\n\n\t\t\t//disable sleep on mobile devices in VR mode\n\t\t\tif (VR.vrMode()) {\n\t\t\t\tnoSleep.enable();\n\t\t\t} else {\n\t\t\t\tnoSleep.disable();\n\t\t\t}\n\t\t});\n\n\t\tvrButton = svgButton(require('raw!open-iconic/svg/eye.svg'), 'vr');\n\t\tvrButton.setAttribute('title', 'Toggle Virtual Reality');\n\t\tvrButton.className = 'unsupported';\n\t\tvrButton.addEventListener('click', VR.requestVR, false);\n\n\t\torientationButton = svgButton(require('raw!open-iconic/svg/compass.svg'), 'orientation-button');\n\t\torientationButton.setAttribute('title', 'Toggle Orientation');\n\t\torientationButton.className = 'unsupported';\n\t\torientationButton.addEventListener('click', toggleOrientation, false);\n\n\t\t//report on HMD\n\t\tVR.on('devicechange', deviceChange);\n\t\tdeviceChange();\n\n\t\t//keyboard shortcuts for making life a little easier\n\t\twindow.addEventListener('keydown', function (evt) {\n\t\t\tif (evt.keyCode === 'Z'.charCodeAt(0)) {\n\t\t\t\tVR.zeroSensor();\n\t\t\t} else if (evt.keyCode === 'O'.charCodeAt(0)) {\n\t\t\t\tVR.enableOrientation();\n\t\t\t} else if (evt.keyCode === 13) {\n\t\t\t\tVR.requestVR();\n\t\t\t}\n\t\t}, false);\n\n\t\tVR.resize();\n\t}\n\n\tfunction initialize() {\n\t\tinitRequirements();\n\n\t\t//todo: set up button/info elements\n\n\t\tVR.init();\n\n\t\tif (document.body) {\n\t\t\tinitUI();\n\t\t} else {\n\t\t\twindow.addEventListener('load', initUI, false);\n\t\t}\n\n\t\twindow.addEventListener('resize', VR.resize, false);\n\n\t\tif (!isMobile.any) {\n\t\t\tVR.disableOrientation();\n\t\t}\n\n\t\t/*\n\t\texport global things\n\t\t*/\n\t\twindow.VR = VR;\n\t\twindow.THREE = VR.THREE;\n\t}\n\n\tinitialize();\n\tVR.start();\n}());\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/entry.js\n ** module id = 0\n ** module chunks = 0\n **/","/**\n * NoSleep.js v0.5.0 - git.io/vfn01\n * Rich Tibbett\n * MIT license\n **/\n(function(root) {\n  // UA matching\n  var ua = {\n    Android: /Android/ig.test(navigator.userAgent),\n    iOS: /AppleWebKit/.test(navigator.userAgent) && /Mobile\\/\\w+/.test(navigator.userAgent)\n  };\n\n  var media = {\n    WebM: \"data:video/webm;base64,GkXfo0AgQoaBAUL3gQFC8oEEQvOBCEKCQAR3ZWJtQoeBAkKFgQIYU4BnQI0VSalmQCgq17FAAw9CQE2AQAZ3aGFtbXlXQUAGd2hhbW15RIlACECPQAAAAAAAFlSua0AxrkAu14EBY8WBAZyBACK1nEADdW5khkAFVl9WUDglhohAA1ZQOIOBAeBABrCBCLqBCB9DtnVAIueBAKNAHIEAAIAwAQCdASoIAAgAAUAmJaQAA3AA/vz0AAA=\",\n    MP4: \"data:video/mp4;base64,AAAAHGZ0eXBpc29tAAACAGlzb21pc28ybXA0MQAAAAhmcmVlAAAAG21kYXQAAAGzABAHAAABthADAowdbb9/AAAC6W1vb3YAAABsbXZoZAAAAAB8JbCAfCWwgAAAA+gAAAAAAAEAAAEAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAIVdHJhawAAAFx0a2hkAAAAD3wlsIB8JbCAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAIAAAACAAAAAABsW1kaWEAAAAgbWRoZAAAAAB8JbCAfCWwgAAAA+gAAAAAVcQAAAAAAC1oZGxyAAAAAAAAAAB2aWRlAAAAAAAAAAAAAAAAVmlkZW9IYW5kbGVyAAAAAVxtaW5mAAAAFHZtaGQAAAABAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAAEcc3RibAAAALhzdHNkAAAAAAAAAAEAAACobXA0dgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAIAAgASAAAAEgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABj//wAAAFJlc2RzAAAAAANEAAEABDwgEQAAAAADDUAAAAAABS0AAAGwAQAAAbWJEwAAAQAAAAEgAMSNiB9FAEQBFGMAAAGyTGF2YzUyLjg3LjQGAQIAAAAYc3R0cwAAAAAAAAABAAAAAQAAAAAAAAAcc3RzYwAAAAAAAAABAAAAAQAAAAEAAAABAAAAFHN0c3oAAAAAAAAAEwAAAAEAAAAUc3RjbwAAAAAAAAABAAAALAAAAGB1ZHRhAAAAWG1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAAK2lsc3QAAAAjqXRvbwAAABtkYXRhAAAAAQAAAABMYXZmNTIuNzguMw==\"\n  };\n\n  function addSourceToVideo(element, type, dataURI) {\n    var source = document.createElement('source');\n    source.src = dataURI;\n    source.type = \"video/\" + type;\n    element.appendChild(source);\n  }\n\n  // NoSleep instance constructor\n  var NoSleep = function() {\n    if (ua.iOS) {\n      this.noSleepTimer = null;\n    } else if (ua.Android) {\n      // Set up no sleep video element\n      this.noSleepVideo = document.createElement('video');\n      this.noSleepVideo.setAttribute(\"loop\", \"\");\n\n      // Append nosleep video sources\n      addSourceToVideo(this.noSleepVideo, \"webm\", media.WebM);\n      addSourceToVideo(this.noSleepVideo, \"mp4\", media.MP4);\n    }\n\n    return this;\n  };\n\n  // Enable NoSleep instance\n  NoSleep.prototype.enable = function(duration) {\n    if (ua.iOS) {\n      this.disable();\n      this.noSleepTimer = window.setInterval(function() {\n        window.location = window.location;\n        window.setTimeout(window.stop, 0);\n      }, duration || 15000);\n    } else if (ua.Android) {\n      this.noSleepVideo.play();\n    }\n  };\n\n  // Disable NoSleep instance\n  NoSleep.prototype.disable = function() {\n    if (ua.iOS) {\n      if (this.noSleepTimer) {\n        window.clearInterval(this.noSleepTimer);\n        this.noSleepTimer = null;\n      }\n    } else if (ua.Android) {\n      this.noSleepVideo.pause();\n    }\n  };\n\n  // Append NoSleep API to root object\n  root.NoSleep = NoSleep;\n})(this);\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./bower_components/nosleep/NoSleep.js\n ** module id = 1\n ** module chunks = 0\n **/","/**\n * isMobile.js v0.3.9\n *\n * A simple library to detect Apple phones and tablets,\n * Android phones and tablets, other mobile devices (like blackberry, mini-opera and windows phone),\n * and any kind of seven inch device, via user agent sniffing.\n *\n * @author: Kai Mallea (kmallea@gmail.com)\n *\n * @license: http://creativecommons.org/publicdomain/zero/1.0/\n */\n(function (global) {\n\n    var apple_phone         = /iPhone/i,\n        apple_ipod          = /iPod/i,\n        apple_tablet        = /iPad/i,\n        android_phone       = /(?=.*\\bAndroid\\b)(?=.*\\bMobile\\b)/i, // Match 'Android' AND 'Mobile'\n        android_tablet      = /Android/i,\n        amazon_phone        = /(?=.*\\bAndroid\\b)(?=.*\\bSD4930UR\\b)/i,\n        amazon_tablet       = /(?=.*\\bAndroid\\b)(?=.*\\b(?:KFOT|KFTT|KFJWI|KFJWA|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|KFARWI|KFASWI|KFSAWI|KFSAWA)\\b)/i,\n        windows_phone       = /IEMobile/i,\n        windows_tablet      = /(?=.*\\bWindows\\b)(?=.*\\bARM\\b)/i, // Match 'Windows' AND 'ARM'\n        other_blackberry    = /BlackBerry/i,\n        other_blackberry_10 = /BB10/i,\n        other_opera         = /Opera Mini/i,\n        other_chrome        = /(CriOS|Chrome)(?=.*\\bMobile\\b)/i,\n        other_firefox       = /(?=.*\\bFirefox\\b)(?=.*\\bMobile\\b)/i, // Match 'Firefox' AND 'Mobile'\n        seven_inch = new RegExp(\n            '(?:' +         // Non-capturing group\n\n            'Nexus 7' +     // Nexus 7\n\n            '|' +           // OR\n\n            'BNTV250' +     // B&N Nook Tablet 7 inch\n\n            '|' +           // OR\n\n            'Kindle Fire' + // Kindle Fire\n\n            '|' +           // OR\n\n            'Silk' +        // Kindle Fire, Silk Accelerated\n\n            '|' +           // OR\n\n            'GT-P1000' +    // Galaxy Tab 7 inch\n\n            ')',            // End non-capturing group\n\n            'i');           // Case-insensitive matching\n\n    var match = function(regex, userAgent) {\n        return regex.test(userAgent);\n    };\n\n    var IsMobileClass = function(userAgent) {\n        var ua = userAgent || navigator.userAgent;\n        // Facebook mobile app's integrated browser adds a bunch of strings that\n        // match everything. Strip it out if it exists.\n        var tmp = ua.split('[FBAN');\n        if (typeof tmp[1] !== 'undefined') {\n            ua = tmp[0];\n        }\n\n        this.apple = {\n            phone:  match(apple_phone, ua),\n            ipod:   match(apple_ipod, ua),\n            tablet: !match(apple_phone, ua) && match(apple_tablet, ua),\n            device: match(apple_phone, ua) || match(apple_ipod, ua) || match(apple_tablet, ua)\n        };\n        this.amazon = {\n            phone:  match(amazon_phone, ua),\n            tablet: !match(amazon_phone, ua) && match(amazon_tablet, ua),\n            device: match(amazon_phone, ua) || match(amazon_tablet, ua)\n        };\n        this.android = {\n            phone:  match(amazon_phone, ua) || match(android_phone, ua),\n            tablet: !match(amazon_phone, ua) && !match(android_phone, ua) && (match(amazon_tablet, ua) || match(android_tablet, ua)),\n            device: match(amazon_phone, ua) || match(amazon_tablet, ua) || match(android_phone, ua) || match(android_tablet, ua)\n        };\n        this.windows = {\n            phone:  match(windows_phone, ua),\n            tablet: match(windows_tablet, ua),\n            device: match(windows_phone, ua) || match(windows_tablet, ua)\n        };\n        this.other = {\n            blackberry:   match(other_blackberry, ua),\n            blackberry10: match(other_blackberry_10, ua),\n            opera:        match(other_opera, ua),\n            firefox:      match(other_firefox, ua),\n            chrome:       match(other_chrome, ua),\n            device:       match(other_blackberry, ua) || match(other_blackberry_10, ua) || match(other_opera, ua) || match(other_firefox, ua) || match(other_chrome, ua)\n        };\n        this.seven_inch = match(seven_inch, ua);\n        this.any = this.apple.device || this.android.device || this.windows.device || this.other.device || this.seven_inch;\n        // excludes 'other' devices and ipods, targeting touchscreen phones\n        this.phone = this.apple.phone || this.android.phone || this.windows.phone;\n        // excludes 7 inch devices, classifying as phone or tablet is left to the user\n        this.tablet = this.apple.tablet || this.android.tablet || this.windows.tablet;\n\n        if (typeof window === 'undefined') {\n            return this;\n        }\n    };\n\n    var instantiate = function() {\n        var IM = new IsMobileClass();\n        IM.Class = IsMobileClass;\n        return IM;\n    };\n\n    if (typeof module != 'undefined' && module.exports && typeof window === 'undefined') {\n        //node\n        module.exports = IsMobileClass;\n    } else if (typeof module != 'undefined' && module.exports && typeof window !== 'undefined') {\n        //browserify\n        module.exports = instantiate();\n    } else if (typeof define === 'function' && define.amd) {\n        //AMD\n        define('isMobile', [], global.isMobile = instantiate());\n    } else {\n        global.isMobile = instantiate();\n    }\n\n})(this);\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/ismobilejs/isMobile.js\n ** module id = 2\n ** module chunks = 0\n **/","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!./../../node_modules/css-loader/index.js!./style.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// add the styles to the DOM\nvar update = require(\"!./../../node_modules/style-loader/addStyles.js\")(content, {});\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!./../../node_modules/css-loader/index.js!./style.css\", function() {\n\t\t\tvar newContent = require(\"!!./../../node_modules/css-loader/index.js!./style.css\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/style-loader!./~/css-loader!./src/css/style.css\n ** module id = 3\n ** module chunks = 0\n **/","exports = module.exports = require(\"./../../node_modules/css-loader/lib/css-base.js\")();\n// imports\n\n\n// module\nexports.push([module.id, \"body{font-family:Helvetica Neue,Helvetica,Arial,sans-serif;color:#eee;overflow:hidden;background:#282828;height:100%;width:100%;margin:0;padding:0}canvas{width:100%!important;height:100%!important;top:0;left:0}#buttons{position:absolute;bottom:0;left:0;padding:12px;margin:8px;border-radius:8px;background-color:hsla(0,0%,50%,.6)}#buttons>*{margin:0 10px;display:inline-block;width:18px;height:18px;cursor:pointer}#buttons>:first-child{margin-left:0}#buttons>.unsupported,#fs-disable{display:none}\", \"\"]);\n\n// exports\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/css-loader!./src/css/style.css\n ** module id = 4\n ** module chunks = 0\n **/","/*\r\n\tMIT License http://www.opensource.org/licenses/mit-license.php\r\n\tAuthor Tobias Koppers @sokra\r\n*/\r\n// css base code, injected by the css-loader\r\nmodule.exports = function() {\r\n\tvar list = [];\r\n\r\n\t// return the list of modules as css string\r\n\tlist.toString = function toString() {\r\n\t\tvar result = [];\r\n\t\tfor(var i = 0; i < this.length; i++) {\r\n\t\t\tvar item = this[i];\r\n\t\t\tif(item[2]) {\r\n\t\t\t\tresult.push(\"@media \" + item[2] + \"{\" + item[1] + \"}\");\r\n\t\t\t} else {\r\n\t\t\t\tresult.push(item[1]);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result.join(\"\");\r\n\t};\r\n\r\n\t// import a list of modules into the list\r\n\tlist.i = function(modules, mediaQuery) {\r\n\t\tif(typeof modules === \"string\")\r\n\t\t\tmodules = [[null, modules, \"\"]];\r\n\t\tvar alreadyImportedModules = {};\r\n\t\tfor(var i = 0; i < this.length; i++) {\r\n\t\t\tvar id = this[i][0];\r\n\t\t\tif(typeof id === \"number\")\r\n\t\t\t\talreadyImportedModules[id] = true;\r\n\t\t}\r\n\t\tfor(i = 0; i < modules.length; i++) {\r\n\t\t\tvar item = modules[i];\r\n\t\t\t// skip already imported module\r\n\t\t\t// this implementation is not 100% perfect for weird media query combinations\r\n\t\t\t//  when a module is imported multiple times with different media queries.\r\n\t\t\t//  I hope this will never occur (Hey this way we have smaller bundles)\r\n\t\t\tif(typeof item[0] !== \"number\" || !alreadyImportedModules[item[0]]) {\r\n\t\t\t\tif(mediaQuery && !item[2]) {\r\n\t\t\t\t\titem[2] = mediaQuery;\r\n\t\t\t\t} else if(mediaQuery) {\r\n\t\t\t\t\titem[2] = \"(\" + item[2] + \") and (\" + mediaQuery + \")\";\r\n\t\t\t\t}\r\n\t\t\t\tlist.push(item);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\treturn list;\r\n};\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/css-loader/lib/css-base.js\n ** module id = 5\n ** module chunks = 0\n **/","/*\r\n\tMIT License http://www.opensource.org/licenses/mit-license.php\r\n\tAuthor Tobias Koppers @sokra\r\n*/\r\nvar stylesInDom = {},\r\n\tmemoize = function(fn) {\r\n\t\tvar memo;\r\n\t\treturn function () {\r\n\t\t\tif (typeof memo === \"undefined\") memo = fn.apply(this, arguments);\r\n\t\t\treturn memo;\r\n\t\t};\r\n\t},\r\n\tisOldIE = memoize(function() {\r\n\t\treturn /msie [6-9]\\b/.test(window.navigator.userAgent.toLowerCase());\r\n\t}),\r\n\tgetHeadElement = memoize(function () {\r\n\t\treturn document.head || document.getElementsByTagName(\"head\")[0];\r\n\t}),\r\n\tsingletonElement = null,\r\n\tsingletonCounter = 0,\r\n\tstyleElementsInsertedAtTop = [];\r\n\r\nmodule.exports = function(list, options) {\r\n\tif(typeof DEBUG !== \"undefined\" && DEBUG) {\r\n\t\tif(typeof document !== \"object\") throw new Error(\"The style-loader cannot be used in a non-browser environment\");\r\n\t}\r\n\r\n\toptions = options || {};\r\n\t// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\r\n\t// tags it will allow on a page\r\n\tif (typeof options.singleton === \"undefined\") options.singleton = isOldIE();\r\n\r\n\t// By default, add <style> tags to the bottom of <head>.\r\n\tif (typeof options.insertAt === \"undefined\") options.insertAt = \"bottom\";\r\n\r\n\tvar styles = listToStyles(list);\r\n\taddStylesToDom(styles, options);\r\n\r\n\treturn function update(newList) {\r\n\t\tvar mayRemove = [];\r\n\t\tfor(var i = 0; i < styles.length; i++) {\r\n\t\t\tvar item = styles[i];\r\n\t\t\tvar domStyle = stylesInDom[item.id];\r\n\t\t\tdomStyle.refs--;\r\n\t\t\tmayRemove.push(domStyle);\r\n\t\t}\r\n\t\tif(newList) {\r\n\t\t\tvar newStyles = listToStyles(newList);\r\n\t\t\taddStylesToDom(newStyles, options);\r\n\t\t}\r\n\t\tfor(var i = 0; i < mayRemove.length; i++) {\r\n\t\t\tvar domStyle = mayRemove[i];\r\n\t\t\tif(domStyle.refs === 0) {\r\n\t\t\t\tfor(var j = 0; j < domStyle.parts.length; j++)\r\n\t\t\t\t\tdomStyle.parts[j]();\r\n\t\t\t\tdelete stylesInDom[domStyle.id];\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n}\r\n\r\nfunction addStylesToDom(styles, options) {\r\n\tfor(var i = 0; i < styles.length; i++) {\r\n\t\tvar item = styles[i];\r\n\t\tvar domStyle = stylesInDom[item.id];\r\n\t\tif(domStyle) {\r\n\t\t\tdomStyle.refs++;\r\n\t\t\tfor(var j = 0; j < domStyle.parts.length; j++) {\r\n\t\t\t\tdomStyle.parts[j](item.parts[j]);\r\n\t\t\t}\r\n\t\t\tfor(; j < item.parts.length; j++) {\r\n\t\t\t\tdomStyle.parts.push(addStyle(item.parts[j], options));\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tvar parts = [];\r\n\t\t\tfor(var j = 0; j < item.parts.length; j++) {\r\n\t\t\t\tparts.push(addStyle(item.parts[j], options));\r\n\t\t\t}\r\n\t\t\tstylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction listToStyles(list) {\r\n\tvar styles = [];\r\n\tvar newStyles = {};\r\n\tfor(var i = 0; i < list.length; i++) {\r\n\t\tvar item = list[i];\r\n\t\tvar id = item[0];\r\n\t\tvar css = item[1];\r\n\t\tvar media = item[2];\r\n\t\tvar sourceMap = item[3];\r\n\t\tvar part = {css: css, media: media, sourceMap: sourceMap};\r\n\t\tif(!newStyles[id])\r\n\t\t\tstyles.push(newStyles[id] = {id: id, parts: [part]});\r\n\t\telse\r\n\t\t\tnewStyles[id].parts.push(part);\r\n\t}\r\n\treturn styles;\r\n}\r\n\r\nfunction insertStyleElement(options, styleElement) {\r\n\tvar head = getHeadElement();\r\n\tvar lastStyleElementInsertedAtTop = styleElementsInsertedAtTop[styleElementsInsertedAtTop.length - 1];\r\n\tif (options.insertAt === \"top\") {\r\n\t\tif(!lastStyleElementInsertedAtTop) {\r\n\t\t\thead.insertBefore(styleElement, head.firstChild);\r\n\t\t} else if(lastStyleElementInsertedAtTop.nextSibling) {\r\n\t\t\thead.insertBefore(styleElement, lastStyleElementInsertedAtTop.nextSibling);\r\n\t\t} else {\r\n\t\t\thead.appendChild(styleElement);\r\n\t\t}\r\n\t\tstyleElementsInsertedAtTop.push(styleElement);\r\n\t} else if (options.insertAt === \"bottom\") {\r\n\t\thead.appendChild(styleElement);\r\n\t} else {\r\n\t\tthrow new Error(\"Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.\");\r\n\t}\r\n}\r\n\r\nfunction removeStyleElement(styleElement) {\r\n\tstyleElement.parentNode.removeChild(styleElement);\r\n\tvar idx = styleElementsInsertedAtTop.indexOf(styleElement);\r\n\tif(idx >= 0) {\r\n\t\tstyleElementsInsertedAtTop.splice(idx, 1);\r\n\t}\r\n}\r\n\r\nfunction createStyleElement(options) {\r\n\tvar styleElement = document.createElement(\"style\");\r\n\tstyleElement.type = \"text/css\";\r\n\tinsertStyleElement(options, styleElement);\r\n\treturn styleElement;\r\n}\r\n\r\nfunction createLinkElement(options) {\r\n\tvar linkElement = document.createElement(\"link\");\r\n\tlinkElement.rel = \"stylesheet\";\r\n\tinsertStyleElement(options, linkElement);\r\n\treturn linkElement;\r\n}\r\n\r\nfunction addStyle(obj, options) {\r\n\tvar styleElement, update, remove;\r\n\r\n\tif (options.singleton) {\r\n\t\tvar styleIndex = singletonCounter++;\r\n\t\tstyleElement = singletonElement || (singletonElement = createStyleElement(options));\r\n\t\tupdate = applyToSingletonTag.bind(null, styleElement, styleIndex, false);\r\n\t\tremove = applyToSingletonTag.bind(null, styleElement, styleIndex, true);\r\n\t} else if(obj.sourceMap &&\r\n\t\ttypeof URL === \"function\" &&\r\n\t\ttypeof URL.createObjectURL === \"function\" &&\r\n\t\ttypeof URL.revokeObjectURL === \"function\" &&\r\n\t\ttypeof Blob === \"function\" &&\r\n\t\ttypeof btoa === \"function\") {\r\n\t\tstyleElement = createLinkElement(options);\r\n\t\tupdate = updateLink.bind(null, styleElement);\r\n\t\tremove = function() {\r\n\t\t\tremoveStyleElement(styleElement);\r\n\t\t\tif(styleElement.href)\r\n\t\t\t\tURL.revokeObjectURL(styleElement.href);\r\n\t\t};\r\n\t} else {\r\n\t\tstyleElement = createStyleElement(options);\r\n\t\tupdate = applyToTag.bind(null, styleElement);\r\n\t\tremove = function() {\r\n\t\t\tremoveStyleElement(styleElement);\r\n\t\t};\r\n\t}\r\n\r\n\tupdate(obj);\r\n\r\n\treturn function updateStyle(newObj) {\r\n\t\tif(newObj) {\r\n\t\t\tif(newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap)\r\n\t\t\t\treturn;\r\n\t\t\tupdate(obj = newObj);\r\n\t\t} else {\r\n\t\t\tremove();\r\n\t\t}\r\n\t};\r\n}\r\n\r\nvar replaceText = (function () {\r\n\tvar textStore = [];\r\n\r\n\treturn function (index, replacement) {\r\n\t\ttextStore[index] = replacement;\r\n\t\treturn textStore.filter(Boolean).join('\\n');\r\n\t};\r\n})();\r\n\r\nfunction applyToSingletonTag(styleElement, index, remove, obj) {\r\n\tvar css = remove ? \"\" : obj.css;\r\n\r\n\tif (styleElement.styleSheet) {\r\n\t\tstyleElement.styleSheet.cssText = replaceText(index, css);\r\n\t} else {\r\n\t\tvar cssNode = document.createTextNode(css);\r\n\t\tvar childNodes = styleElement.childNodes;\r\n\t\tif (childNodes[index]) styleElement.removeChild(childNodes[index]);\r\n\t\tif (childNodes.length) {\r\n\t\t\tstyleElement.insertBefore(cssNode, childNodes[index]);\r\n\t\t} else {\r\n\t\t\tstyleElement.appendChild(cssNode);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction applyToTag(styleElement, obj) {\r\n\tvar css = obj.css;\r\n\tvar media = obj.media;\r\n\tvar sourceMap = obj.sourceMap;\r\n\r\n\tif(media) {\r\n\t\tstyleElement.setAttribute(\"media\", media)\r\n\t}\r\n\r\n\tif(styleElement.styleSheet) {\r\n\t\tstyleElement.styleSheet.cssText = css;\r\n\t} else {\r\n\t\twhile(styleElement.firstChild) {\r\n\t\t\tstyleElement.removeChild(styleElement.firstChild);\r\n\t\t}\r\n\t\tstyleElement.appendChild(document.createTextNode(css));\r\n\t}\r\n}\r\n\r\nfunction updateLink(linkElement, obj) {\r\n\tvar css = obj.css;\r\n\tvar media = obj.media;\r\n\tvar sourceMap = obj.sourceMap;\r\n\r\n\tif(sourceMap) {\r\n\t\t// http://stackoverflow.com/a/26603875\r\n\t\tcss += \"\\n/*# sourceMappingURL=data:application/json;base64,\" + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + \" */\";\r\n\t}\r\n\r\n\tvar blob = new Blob([css], { type: \"text/css\" });\r\n\r\n\tvar oldSrc = linkElement.href;\r\n\r\n\tlinkElement.href = URL.createObjectURL(blob);\r\n\r\n\tif(oldSrc)\r\n\t\tURL.revokeObjectURL(oldSrc);\r\n}\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/style-loader/addStyles.js\n ** module id = 6\n ** module chunks = 0\n **/","(function () {\n\t'use strict';\n\n\t//constants\n\tvar NEAR = 0.1,\n\t\tFAR = 1000000,\n\n\t//global-ish declarations\n\t\tTHREE,\n\t\teventEmitter,\n\t\tmaterials = require('./materials'),\n\t\tnop = function () {},\n\t\trequestFullscreen = nop,\n\t\texitFullscreen = (\n\t\t\tdocument.exitFullscreen ||\n\t\t\tdocument.mozCancelFullScreen ||\n\t\t\tdocument.webkitExitFullscreen ||\n\t\t\tdocument.msExitFullscreen ||\n\t\t\tnop\n\t\t).bind(document),\n\n\t//scene assets\n\t\tcamera,\n\t\tscene,\n\t\tbody,\n\t\trenderer,\n\t\taudioListener,\n\t\tvrControls,\n\t\tvrEffect,\n\t\tmouseControls,\n\t\traycaster,\n\t\ttarget,\n\n\t\tbodyWrapper,\n\t\tcameraWrapper,\n\n\t\tfloor,\n\n\t//state\n\t\tgoing = false,\n\t\tvrMode = false,\n\t\torientationEnabled,\n\t\torientationPossible = false,\n\n\t//exported object\n\t\tVR,\n\n\t\tVRObject = require('./vr-object'),\n\t\tobjectMethods = [\n\t\t\t'box',\n\t\t\t'cylinder',\n\t\t\t'torus',\n\t\t\t'sphere',\n\t\t\t'empty',\n\t\t\t'sound',\n\t\t\t'floor',\n\t\t\t'sky',\n\t\t\t'panorama',\n\t\t\t'image',\n\t\t\t'video',\n\t\t\t'text',\n\t\t\t'grid'\n\t\t],\n\n\t\t//todo: use a weak map or set instead\n\t\tvrObjects = [],\n\t\traycastable = [],\n\n\t\tlastTick = 0,\n\t\tanimationCallbacks = [];\n\n\tfunction isFullscreen() {\n\t\treturn !!(document.fullscreenElement ||\n\t\t\tdocument.mozFullScreenElement ||\n\t\t\tdocument.webkitFullscreenElement ||\n\t\t\tdocument.msFullscreenElement);\n\t}\n\n\tfunction fullScreenError() {\n\t\tvrMode = false;\n\t\tif (vrEffect) {\n\t\t\tvrEffect.exit();\n\t\t}\n\t}\n\n\tfunction pruneObject(object) {\n\t\tvar i = raycastable.indexOf(object);\n\t\tif (i >= 0) {\n\t\t\traycastable.splice(i, 1);\n\t\t}\n\n\t\ti = vrObjects.indexOf(VRObject.findObject(object));\n\t\tif (i >= 0) {\n\t\t\tvrObjects.splice(i, 1);\n\t\t}\n\n\t\tobject.children.forEach(pruneObject);\n\t}\n\n\tfunction raycast() {\n\t\tvar i,\n\t\t\tintersect,\n\t\t\tobject,\n\t\t\tintersects,\n\t\t\tparent,\n\t\t\tprune = [],\n\t\t\tvrObject;\n\n\t\traycaster.ray.origin.setFromMatrixPosition(camera.matrixWorld); // world position\n\t\traycaster.ray.direction.set(0, 0, 0.5).unproject(camera).sub(raycaster.ray.origin).normalize();\n\n\t\tintersects = raycaster.intersectObjects(raycastable, true);\n\t\tfor (i = 0; i < intersects.length; i++) {\n\t\t\tintersect = intersects[i];\n\n\t\t\t// if object has been removed from scene, remove it from raycastable\n\t\t\tparent = intersect.object;\n\t\t\twhile (parent && parent !== scene) {\n\t\t\t\tif (!parent.parent) {\n\t\t\t\t\tprune.push(parent);\n\t\t\t\t}\n\t\t\t\tparent = parent.parent;\n\t\t\t}\n\n\t\t\tif (parent && intersect.object instanceof THREE.Mesh) {\n\t\t\t\tobject = intersect.object;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tprune.forEach(pruneObject);\n\n\t\tif (target !== object) {\n\t\t\tif (target) {\n\t\t\t\tvrObject = VRObject.findObject(target);\n\t\t\t\tvrObject.emit('lookaway');\n\t\t\t\tVR.emit('lookaway', vrObject);\n\t\t\t}\n\t\t\ttarget = object;\n\t\t\tif (target) {\n\t\t\t\tvrObject = VRObject.findObject(target);\n\t\t\t\twhile (!vrObject && target.parent) {\n\t\t\t\t\ttarget = target.parent;\n\t\t\t\t\tvrObject = VRObject.findObject(target);\n\t\t\t\t}\n\t\t\t\tif (vrObject) {\n\t\t\t\t\tvrObject.emit('lookat', intersect);\n\t\t\t\t\tVR.emit('lookat', vrObject, intersect);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction render() {\n\t\tvar now = Date.now() / 1000,\n\t\t\tdelta = Math.min(1, now - lastTick);\n\n\t\tvrControls.update();\n\n\t\tanimationCallbacks.forEach(function (cb) {\n\t\t\tcb(delta, now);\n\t\t});\n\n\t\tscene.updateMatrixWorld();\n\n\t\tvrObjects.forEach(function (object) {\n\t\t\tobject.update(now);\n\t\t});\n\n\t\traycast();\n\n\t\tvrEffect.render(scene, camera);\n\n\t\tlastTick = now;\n\t}\n\n\tfunction renderLoop() {\n\t\tif (going) {\n\t\t\trender();\n\t\t\trequestAnimationFrame(renderLoop);\n\t\t}\n\t}\n\n\tfunction stop() {\n\t\tgoing = false;\n\t}\n\n\tfunction start() {\n\t\tif (!going) {\n\t\t\tgoing = true;\n\t\t\trenderLoop();\n\t\t}\n\t}\n\n\t/*\n\tMute any sounds when this browser tab is in the background or minimized.\n\t*/\n\tfunction visibilityChange() {\n\t\tif (document.hidden || document.mozHidden || document.msHidden || document.webkitHidden) {\n\t\t\taudioListener.volume(0);\n\t\t} else {\n\t\t\taudioListener.volume(1);\n\t\t}\n\t}\n\n\tfunction resize(width, height) {\n\t\twidth = typeof width === 'number' && width || window.innerWidth;\n\t\theight = typeof height === 'number' && height || window.innerHeight;\n\n\t\tcamera.aspect = width / height;\n\t\tcamera.updateProjectionMatrix();\n\t\trenderer.setSize(width, height);\n\t}\n\n\tfunction initShake() {\n\t\tvar lastTime = 0,\n\t\t\tlastX,\n\t\t\tlastY,\n\t\t\tlastZ,\n\t\t\tthreshold = 15;\n\n\t\twindow.addEventListener('devicemotion', function (evt) {\n\t\t\tvar current = evt.accelerationIncludingGravity,\n\t\t\t\ttime,\n\t\t\t\tdiff,\n\t\t\t\tdeltaX = 0,\n\t\t\t\tdeltaY = 0,\n\t\t\t\tdeltaZ = 0,\n\t\t\t\tdist;\n\n\t\t\tif (lastX !== undefined) {\n\t\t\t\tdeltaX = Math.abs(lastX - current.x);\n\t\t\t\tdeltaY = Math.abs(lastY - current.y);\n\t\t\t\tdeltaZ = Math.abs(lastZ - current.z);\n\n\t\t\t\t// if (deltaX > threshold &&\n\t\t\t\t// \t\t(deltaY > threshold || deltaZ > threshold)\n\t\t\t\t// \t) {\n\t\t\t\tdist = Math.sqrt(deltaX * deltaX + deltaY * deltaY + deltaZ * deltaZ);\n\t\t\t\tif (dist > threshold) {\n\n\t\t\t\t\ttime = Date.now();\n\t\t\t\t\tdiff = time - lastTime;\n\t\t\t\t\tif (diff > 1000) {\n\t\t\t\t\t\tif (navigator.vibrate) {\n\t\t\t\t\t\t\tnavigator.vibrate(100);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlastTime = Date.now();\n\n\t\t\t\t\t\tVR.emit('shake');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlastX = current.x;\n\t\t\tlastY = current.y;\n\t\t\tlastZ = current.z;\n\n\t\t\torientationPossible = true;\n\t\t}, false);\n\t}\n\n\tfunction initScene() {\n\t\tfunction attachCanvas() {\n\t\t\tdocument.body.insertBefore(renderer.domElement, document.body.firstChild || null);\n\t\t\tresize();\n\t\t}\n\n\t\tif (renderer) {\n\t\t\treturn;\n\t\t}\n\n\t\t//create renderer and place in document\n\t\trenderer = new THREE.WebGLRenderer({ antialias: true });\n\t\trenderer.domElement.addEventListener('webglcontextlost', function contextLost(event) {\n\t\t\tconsole.log('lost context', event);\n\t\t});\n\t\t// renderer.shadowMapEnabled = true;\n\t\t// renderer.shadowMapSoft = true;\n\n\t\t//need a scene to put all our objects in\n\t\tscene = new THREE.Scene();\n\n\t\tbodyWrapper = new VRObject(scene, require('./objects/empty'), null, {\n\t\t\tname: 'body'\n\t\t}).moveTo(0, 1.5, 4);\n\t\tbody = bodyWrapper.object;\n\n\t\tcameraWrapper = new VRObject(body, function (parent) {\n\t\t\t//need a camera with which to look at stuff\n\t\t\tcamera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, NEAR, FAR);\n\t\t\tparent.add(camera);\n\n\t\t\treturn camera;\n\t\t})\n\t\t// set camera position so that OrbitControls works properly.\n\t\t\t.moveTo(0, 0.0001, 0.0001);\n\n\t\taudioListener = new THREE.AudioListener();\n\t\taudioListener.name = 'audio-listener';\n\t\tcamera.add(audioListener);\n\n\t\t//VRControls point the camera wherever we're looking\n\t\tvrControls = new THREE.VRControls(camera);\n\t\tvrControls.freeze = !orientationEnabled;\n\n\t\t//render left and right eye\n\t\tvrEffect = new THREE.VRStereoEffect(renderer);\n\t\tvrEffect.near = NEAR;\n\t\tvrEffect.far = FAR;\n\t\tvrEffect.addEventListener('fullscreenchange', function (evt) {\n\t\t\tvar screen;\n\t\t\tif (isFullscreen()) {\n\t\t\t\tif (vrMode) {\n\t\t\t\t\t//no mouse control\n\t\t\t\t\tmouseControls.enabled = false;\n\n\t\t\t\t\tvrControls.freeze = false;\n\t\t\t\t\tvrControls.reset();\n\n\t\t\t\t\tscreen = window.screen;\n\t\t\t\t\tif (screen.lockOrientation) {\n\t\t\t\t\t\tscreen.lockOrientation('landscape-primary');\n\t\t\t\t\t} else if (screen.mozLockOrientation) {\n\t\t\t\t\t\tscreen.mozLockOrientation('landscape-primary');\n\t\t\t\t\t} else if (screen.orientation && screen.orientation.lock) {\n\t\t\t\t\t\tscreen.orientation.lock('landscape-primary');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tVR.exitVR();\n\t\t\t}\n\n\t\t\tcamera.position.set(0, 0.0001, 0.0001);\n\t\t\tcamera.rotation.set(0, 0, 0);\n\n\t\t\tVR.emit('fullscreenchange', evt);\n\t\t});\n\n\t\t//report on HMD\n\t\tvrControls.addEventListener('devicechange', function () {\n\t\t\torientationPossible = true;\n\t\t\tif (orientationEnabled === undefined) {\n\t\t\t\torientationEnabled = vrControls.mode() === 'deviceorientation';\n\t\t\t}\n\n\t\t\tvrControls.freeze = !orientationEnabled && !vrMode;\n\n\t\t\tVR.emit('devicechange', vrControls.mode(), vrEffect.hmd());\n\t\t});\n\n\t\t//mouse control in case got no orientation device\n\t\tmouseControls = new THREE.OrbitControls(camera, renderer.domElement);\n\t\tmouseControls.target0.set(0, 0.0001, 0.000);\n\t\tmouseControls.target.copy(mouseControls.target0);\n\t\tmouseControls.update();\n\n\t\t//todo: remove any default lights once other lights are added\n\t\tvar dLight = new THREE.DirectionalLight(0xffffff, 0.8);\n\t\tdLight.name = 'directional-light';\n\t\tdLight.position.set(20, 100, 100);\n\n\t\tdLight.castShadow = true;\n\t\tdLight.shadowCameraVisible = true;\n\n\t\tdLight.shadowMapWidth = 2048;\n\t\tdLight.shadowMapHeight = 2048;\n\n\t\tdLight.shadowCameraLeft = -10;\n\t\tdLight.shadowCameraRight = 10;\n\t\tdLight.shadowCameraTop = 10;\n\t\tdLight.shadowCameraBottom = -10;\n\n\t\tdLight.shadowCameraFar = 150;\n\t\tdLight.shadowCameraNear = 100;\n\t\tdLight.shadowDarkness = 1;\n\n\t\tscene.add(dLight);\n\n\t\tscene.add(new THREE.AmbientLight(0x444444));\n\n\t\tif (VR) {\n\t\t\tVR.camera = cameraWrapper;\n\t\t\tVR.body = bodyWrapper;\n\t\t\tVR.scene = scene;\n\t\t\tVR.canvas = renderer.domElement;\n\t\t\tVR.renderer = renderer;\n\t\t\tVR.zeroSensor = vrControls.zeroSensor;\n\t\t}\n\n\t\traycaster = new THREE.Raycaster();\n\n\t\tif (document.body) {\n\t\t\tattachCanvas();\n\t\t} else {\n\t\t\twindow.addEventListener('load', attachCanvas, false);\n\t\t}\n\n\t\tVR.canvas.addEventListener('mozfullscreenerror', fullScreenError, false);\n\t\tVR.canvas.addEventListener('webkitfullscreenerror', fullScreenError, false);\n\t\tVR.canvas.addEventListener('fullscreenerror', fullScreenError, false);\n\t}\n\n\tfunction initRequirements() {\n\t\t//load external requirements\n\t\tTHREE = require('three');\n\t\trequire('imports?THREE=three!DeviceOrientationControls');\n\t\trequire('imports?THREE=three!OrbitControls');\n\n\t\t//if (typeof __DEV__ !== 'undefined' && __DEV__) {\n\t\t\trequire('imports?THREE=three!AugmentedConsole');\n\t\t//}\n\n\t\tTHREE.ImageUtils.crossOrigin = '';\n\n\t\teventEmitter = require('event-emitter');\n\n\t\t//my VR stuff. todo: move these to a separate repo or two for easy packaging\n\t\trequire('imports?THREE=three!./lib/VRStereoEffect');\n\t\trequire('imports?THREE=three!./lib/VRControls');\n\t}\n\n\tfunction initialize() {\n\t\t//todo: set up button/info elements\n\n\t\tinitScene();\n\n\t\tinitShake();\n\n\t\tresize();\n\n\t\tdocument.addEventListener('visibilitychange', visibilityChange);\n\t\tdocument.addEventListener('mozvisibilitychange', visibilityChange);\n\t\tdocument.addEventListener('msvisibilitychange', visibilityChange);\n\t\tdocument.addEventListener('webkitvisibilitychange', visibilityChange);\n\t}\n\n\tinitRequirements();\n\n\tmodule.exports = VR = {\n\t\tinit: initialize,\n\t\trender: render,\n\t\tstart: start,\n\t\tstop: stop,\n\t\tresize: resize,\n\n\t\tTHREE: THREE,\n\n\t\tmaterials: materials,\n\n\t\tanimate: function (callback) {\n\t\t\tvar i;\n\t\t\tif (typeof callback === 'function') {\n\t\t\t\ti = animationCallbacks.indexOf(callback);\n\t\t\t\tif (i < 0) {\n\t\t\t\t\tanimationCallbacks.push(callback);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tend: function (callback) {\n\t\t\tvar i;\n\n\t\t\tif (!callback) {\n\t\t\t\tanimationCallbacks.length = 0;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (typeof callback === 'function') {\n\t\t\t\ti = animationCallbacks.indexOf(callback);\n\t\t\t\tif (i >= 0) {\n\t\t\t\t\tanimationCallbacks.splice(i, 1);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\trequestVR: function () {\n\t\t\t//todo: check if it's possible\n\t\t\tif (vrMode || !vrEffect) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvrMode = true;\n\n\t\t\t//full screen and render two eyes\n\t\t\t//always full screen\n\t\t\tvrEffect.requestFullScreen();\n\t\t},\n\n\t\texitVR: function () {\n\t\t\tvrMode = false;\n\t\t\tif (isFullscreen()) {\n\t\t\t\texitFullscreen();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tmouseControls.enabled = true;\n\t\t\tvrControls.freeze = !orientationEnabled;\n\t\t\tcamera.rotation.set(0, 0, 0);\n\t\t},\n\n\t\tvrMode: function () {\n\t\t\treturn vrMode && isFullscreen();\n\t\t},\n\n\t\torientationEnabled: function () {\n\t\t\treturn !!orientationEnabled;\n\t\t},\n\t\tenableOrientation: function () {\n\t\t\torientationEnabled = true;\n\t\t\tif (!vrMode) {\n\t\t\t\tvrControls.freeze = false;\n\t\t\t}\n\t\t},\n\t\tdisableOrientation: function () {\n\t\t\torientationEnabled = false;\n\t\t\tcamera.rotation.set(0, 0, 0);\n\t\t\tvrControls.freeze = !vrMode;\n\t\t},\n\n\t\tisFullscreen: isFullscreen,\n\t\trequestFullscreen: requestFullscreen,\n\t\texitFullscreen: function () {\n\t\t\tif (isFullscreen()) {\n\t\t\t\texitFullscreen();\n\t\t\t}\n\t\t},\n\n\t\tcontrolMode: function () {\n\t\t\treturn vrControls && vrControls.mode();\n\t\t},\n\n\t\tzeroSensor: nop,\n\n\t\tvibrate: navigator.vibrate ? navigator.vibrate.bind(navigator) : nop,\n\n\t\t// Utility\n\t\ttimes: function (n, callback) {\n\t\t\tvar i;\n\n\t\t\tfor (i = 0; i < n; i++) {\n\t\t\t\tcallback(i);\n\t\t\t}\n\t\t},\n\n\t\tcamera: cameraWrapper,\n\t\tbody: bodyWrapper,\n\t\tscene: scene,\n\t\trenderer: renderer || null,\n\t\tcanvas: renderer && renderer.domElement || null\n\t};\n\n\tobjectMethods.forEach(function (method) {\n\t\tvar creator = require('./objects/' + method),\n\t\t\tkey;\n\n\t\tVR[method] = function (options) {\n\t\t\tvar obj = new VRObject(scene, creator, body, options);\n\t\t\tvrObjects.push(obj);\n\t\t\tif (obj.raycastable) {\n\t\t\t\traycastable.push(obj.object);\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\tVRObject.prototype[method] = function (options) {\n\t\t\tvar obj = new VRObject(this.object, creator, body, options);\n\t\t\tvrObjects.push(obj);\n\t\t\tif (obj.raycastable) {\n\t\t\t\traycastable.push(obj.object);\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\tfor (key in creator) {\n\t\t\tif (creator.hasOwnProperty(key) && typeof creator[key] === 'function') {\n\t\t\t\tVR[method][key] = creator[key];\n\t\t\t\tVRObject.prototype[method][key] = creator[key];\n\t\t\t}\n\t\t}\n\t});\n\n\teventEmitter(VR);\n\n\tObject.defineProperty(VR, 'target', {\n\t\tget: function () {\n\t\t\treturn target;\n\t\t}\n\t});\n}());\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/vr.js\n ** module id = 7\n ** module chunks = 0\n **/","module.exports = (function () {\n\t'use strict';\n\n\tvar THREE = require('three'),\n\t\tforEach = require('lodash.foreach'),\n\t\tassign = require('lodash.assign'),\n\n\t\tiOS = navigator.userAgent.match(/(iPad|iPhone|iPod)/g),\n\n\t\t// https://gist.github.com/dperini/729294\n\t\t//urlRegex = /^(?:(?:https?|ftp):\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))(?::\\d{2,5})?(?:\\/\\S*)?$/i,\n\t\turlRegex = require('./utils/urlregex'),\n\n\t\tdataUri = /^data:image\\/(?:png|jpe?g|gif);/,\n\t\tassetPath = __ASSET_PATH__,\n\n\t\timages = {},\n\n\t\tmaterialTypes = {\n\t\t\tlambert: THREE.MeshLambertMaterial,\n\t\t\tbasic: THREE.MeshBasicMaterial,\n\t\t\tphong: THREE.MeshPhongMaterial,\n\t\t\tnormal: THREE.MeshNormalMaterial,\n\t\t\tdepth: THREE.MeshDepthMaterial\n\t\t},\n\t\ttextureFiles = {\n\t\t\t'asphalt': {\n\t\t\t\trepeat: 12\n\t\t\t},\n\t\t\t'brick-tiles': {\n\t\t\t\trepeat: 2\n\t\t\t},\n\t\t\t'bricks': {\n\t\t\t\ttype: 'phong',\n\t\t\t\trepeat: 4,\n\t\t\t\tnormalMap: 'bricks-normal.jpg',\n\t\t\t\tspecularMap: 'bricks-specular.jpg'\n\t\t\t},\n\t\t\t'checkerboard': {\n\t\t\t\trepeat: 10,\n\t\t\t\tmap: 'checkerboard.png'\n\t\t\t},\n\t\t\t'grass': {\n\t\t\t\trepeat: 12\n\t\t\t},\n\t\t\t'metal-floor': {\n\t\t\t\ttype: 'phong',\n\t\t\t\tshininess: 100,\n\n\t\t\t\trepeat: 2\n\t\t\t},\n\t\t\t'metal': {\n\t\t\t\ttype: 'phong',\n\t\t\t\tshininess: 100,\n\t\t\t\tshading: THREE.SmoothShading,\n\n\t\t\t\trepeat: 2\n\t\t\t},\n\t\t\t'stone': {\n\t\t\t\trepeat: 8\n\t\t\t},\n\t\t\t'tiles': {\n\t\t\t\trepeat: 4\n\t\t\t},\n\t\t\t'weathered-wood': {\n\t\t\t\trepeat: 8\n\t\t\t},\n\t\t\t'wood': {\n\t\t\t\trepeat: 4\n\t\t\t}\n\t\t},\n\t\ttextures = {},\n\t\tmaterials;\n\n\tfunction imageTexture(src, mapping, callback) {\n\t\tvar image,\n\t\t\tparse,\n\t\t\ttexture,\n\t\t\tisDataUri;\n\n\t\tfunction imageLoaded() {\n\t\t\tvar scale,\n\t\t\t\tcanvas,\n\t\t\t\tctx,\n\t\t\t\tsmallImage;\n\n\t\t\t/*\n\t\t\tiOS doesn't know how to handle large images. Even though the MAX_TEXTURE_SIZE\n\t\t\tmay be 4096, it still breaks on images that large. So we scale them down.\n\t\t\t*/\n\t\t\tif (iOS && (image.naturalWidth > 2048 || image.naturalHeight > 2048)) {\n\t\t\t\tscale = 2048 / Math.max( image.naturalWidth, image.naturalHeight );\n\n\t\t\t\tcanvas = document.createElement('canvas');\n\t\t\t\tcanvas.width = Math.floor(image.naturalWidth * scale);\n\t\t\t\tcanvas.height = Math.floor(image.naturalHeight * scale);\n\n\t\t\t\tctx = canvas.getContext('2d');\n\t\t\t\tctx.drawImage(image, 0, 0, image.naturalWidth, image.naturalHeight, 0, 0, canvas.width, canvas.height);\n\n\t\t\t\timage = canvas;\n\t\t\t}\n\n\t\t\ttexture.image = image;\n\t\t\ttexture.needsUpdate = true;\n\t\t\tif (typeof callback === 'function') {\n\t\t\t\tsetTimeout(callback.bind(null, texture, image), 1);\n\t\t\t}\n\t\t}\n\n\t\tparse = dataUri.exec(src);\n\t\tisDataUri = !!parse;\n\t\tif (!parse) {\n\t\t\tparse = urlRegex.exec(src);\n\t\t}\n\n\t\t// if (!parse) {\n\t\t// \tconsole.error('Invalid image URL: ' + src);\n\t\t// \treturn;\n\t\t// }\n\n\t\tif (images[src]) {\n\t\t\timage = images[src];\n\t\t} else {\n\t\t\timage = document.createElement('img');\n\t\t\tif (parse && (parse[1] && parse[1] !== window.location.hostname || parse[2] && parse[2] !== window.location.port)) {\n\t\t\t\timage.crossOrigin = 'anonymous';\n\t\t\t}\n\t\t\timage.src = src;\n\t\t\timages[src] = image;\n\t\t}\n\n\t\ttexture = new THREE.Texture(undefined, mapping);\n\n\t\tif (image.naturalWidth || isDataUri) {\n\t\t\tsetTimeout(imageLoaded, 1);\n\t\t} else {\n\t\t\timage.addEventListener('load', imageLoaded);\n\t\t}\n\n\t\treturn texture;\n\t}\n\n\tfunction material(options) {\n\t\tvar opts,\n\t\t\tMaterial = materialTypes[options.type] || THREE.MeshLambertMaterial;\n\n\t\tfunction threeTexture(fn) {\n\t\t\tif (typeof fn === 'string') {\n\t\t\t\tif (urlRegex.test(fn) || dataUri.test(fn)) {\n\t\t\t\t\treturn imageTexture(fn);\n\t\t\t\t}\n\n\t\t\t\tfn = textures[fn];\n\t\t\t}\n\t\t\tif (typeof fn === 'function') {\n\t\t\t\treturn fn(options);\n\t\t\t}\n\n\t\t\treturn fn;\n\t\t}\n\n\t\tif (typeof options === 'string') {\n\t\t\toptions = {\n\t\t\t\tmap: options\n\t\t\t};\n\t\t}\n\n\t\topts = assign({}, options);\n\t\tforEach({\n\t\t\tambient: options.ambient || options.color,\n\t\t\temissive: options.emissive || options.color,\n\t\t\tmap: threeTexture(options.map),\n\t\t\tspecularMap: threeTexture(options.specularMap),\n\t\t\tnormalMap: threeTexture(options.normalMap),\n\t\t\talphaMap: threeTexture(options.alphaMap),\n\t\t\tenvMap: threeTexture(options.envMap),\n\t\t\tlightMap: threeTexture(options.lightMap)\n\t\t}, function (val, key) {\n\t\t\tif (val !== undefined) {\n\t\t\t\topts[key] = val;\n\t\t\t}\n\t\t});\n\n\t\tdelete opts.type;\n\n\t\treturn new Material(opts);\n\t}\n\n\t//figure out if script is loaded relative so we know where to find the images\n\tassetPath = (function () {\n\t\tvar url,\n\t\t\tscripts;\n\n\t\tif (document.currentScript) {\n\t\t\turl = document.currentScript.getAttribute('src');\n\t\t} else {\n\t\t\tscripts = document.getElementsByTagName('script');\n\t\t\turl = scripts[scripts.length - 1].getAttribute('src');\n\t\t}\n\n\t\tif (!urlRegex.test(url)) {\n\t\t\treturn url.replace(/[a-z\\-\\.]+\\.js$/i, '');\n\t\t}\n\n\t\treturn __ASSET_PATH__;\n\t}());\n\n\tmaterials = {\n\t\tstandard: function () {\n\t\t\treturn new THREE.MeshLambertMaterial();\n\t\t},\n\t\ttextures: textures,\n\t\timageTexture: imageTexture,\n\t\tmaterial: material,\n\t\tlibrary: ['standard']\n\t};\n\n\tforEach(textureFiles, function (props, key) {\n\t\tfunction textureFactory(file, options) {\n\t\t\tfunction imagePath(url) {\n\t\t\t\tif ((/^[a-z0-9\\/\\-]+\\.(png|jpg)$/i).test(url)) {\n\t\t\t\t\treturn assetPath + url;\n\t\t\t\t}\n\n\t\t\t\treturn url;\n\t\t\t}\n\n\t\t\toptions = options || {};\n\n\t\t\treturn function (opts) {\n\t\t\t\tvar texture = imageTexture(imagePath(require('./images/' + file)));\n\n\t\t\t\topts = assign({}, options, opts);\n\n\t\t\t\tif (opts.repeat) {\n\t\t\t\t\tif (opts.repeat > 0) {\n\t\t\t\t\t\ttexture.repeat.set(opts.repeat, opts.repeat);\n\t\t\t\t\t} else if (opts.repeat instanceof THREE.Vector2) {\n\t\t\t\t\t\ttexture.repeat.copy(opts.repeat);\n\t\t\t\t\t}\n\t\t\t\t\ttexture.wrapS = texture.wrapT = THREE.RepeatWrapping;\n\t\t\t\t}\n\t\t\t\treturn texture;\n\t\t\t};\n\t\t}\n\n\t\tvar map = textureFactory(props.map || key + '.jpg', props),\n\t\t\tmaterialDef;\n\n\t\tmaterialDef = assign({}, props, {\n\t\t\tmap: map\n\t\t});\n\t\ttextures[key] = map;\n\n\t\tif (props.normalMap) {\n\t\t\tmaterialDef.normalMap = textures[key + '-normal'] = textureFactory(props.normalMap, props);\n\t\t}\n\n\t\tif (props.specularMap) {\n\t\t\tmaterialDef.specularMap = textures[key + '-specular'] = textureFactory(props.specularMap, props);\n\t\t}\n\n\t\tmaterials.library.push(key);\n\t\tmaterials[key] = function (options) {\n\t\t\tvar opts = assign({}, materialDef, options);\n\n\t\t\treturn material(opts);\n\t\t};\n\t});\n\n\treturn materials;\n\n\t//var parse = urlRegex.exec('https://lh5.googleusercontent.com:80/-SNO8rWDqbUM/U085rfOBRuI/AAAAAAAAEdM/nWEWCtNceZ0/w955-h382-no/PANO_20130225_131211.jpg');\n}());\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/materials.js\n ** module id = 8\n ** module chunks = 0\n **/","var self = self || {};// File:src/Three.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nvar THREE = { REVISION: '73' };\r\n\r\n//\r\n\r\nif ( typeof define === 'function' && define.amd ) {\r\n\r\n\t\tdefine( 'three', THREE );\r\n\r\n} else if ( 'undefined' !== typeof exports && 'undefined' !== typeof module ) {\r\n\r\n\t\tmodule.exports = THREE;\r\n\r\n}\r\n\r\n\r\n// polyfills\r\n\r\nif ( self.requestAnimationFrame === undefined || self.cancelAnimationFrame === undefined ) {\r\n\r\n\t// Missing in Android stock browser.\r\n\r\n\t( function () {\r\n\r\n\t\tvar lastTime = 0;\r\n\t\tvar vendors = [ 'ms', 'moz', 'webkit', 'o' ];\r\n\r\n\t\tfor ( var x = 0; x < vendors.length && ! self.requestAnimationFrame; ++ x ) {\r\n\r\n\t\t\tself.requestAnimationFrame = self[ vendors[ x ] + 'RequestAnimationFrame' ];\r\n\t\t\tself.cancelAnimationFrame = self[ vendors[ x ] + 'CancelAnimationFrame' ] || self[ vendors[ x ] + 'CancelRequestAnimationFrame' ];\r\n\r\n\t\t}\r\n\r\n\t\tif ( self.requestAnimationFrame === undefined && self.setTimeout !== undefined ) {\r\n\r\n\t\t\tself.requestAnimationFrame = function ( callback ) {\r\n\r\n\t\t\t\tvar currTime = Date.now(), timeToCall = Math.max( 0, 16 - ( currTime - lastTime ) );\r\n\t\t\t\tvar id = self.setTimeout( function () {\r\n\r\n\t\t\t\t\tcallback( currTime + timeToCall );\r\n\r\n\t\t\t\t}, timeToCall );\r\n\t\t\t\tlastTime = currTime + timeToCall;\r\n\t\t\t\treturn id;\r\n\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t\tif ( self.cancelAnimationFrame === undefined && self.clearTimeout !== undefined ) {\r\n\r\n\t\t\tself.cancelAnimationFrame = function ( id ) {\r\n\r\n\t\t\t\tself.clearTimeout( id );\r\n\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t} )();\r\n\r\n}\r\n\r\n//\r\n\r\nif ( self.performance === undefined ) {\r\n\r\n\tself.performance = {};\r\n\r\n}\r\n\r\nif ( self.performance.now === undefined ) {\r\n\r\n\t( function () {\r\n\r\n\t\tvar start = Date.now();\r\n\r\n\t\tself.performance.now = function () {\r\n\r\n\t\t\treturn Date.now() - start;\r\n\r\n\t\t}\r\n\r\n\t} )();\r\n\r\n}\r\n\r\n//\r\n\r\nif ( Number.EPSILON === undefined ) {\r\n\r\n\tNumber.EPSILON = Math.pow( 2, -52 );\r\n\r\n}\r\n\r\n//\r\n\r\nif ( Math.sign === undefined ) {\r\n\r\n\t// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/sign\r\n\r\n\tMath.sign = function ( x ) {\r\n\r\n\t\treturn ( x < 0 ) ? - 1 : ( x > 0 ) ? 1 : + x;\r\n\r\n\t};\r\n\r\n}\r\n\r\nif ( Function.prototype.name === undefined && Object.defineProperty !== undefined ) {\r\n\r\n\t// Missing in IE9-11.\r\n\t// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/name\r\n\r\n\tObject.defineProperty( Function.prototype, 'name', {\r\n\r\n\t\tget: function () {\r\n\r\n\t\t\treturn this.toString().match( /^\\s*function\\s*(\\S*)\\s*\\(/ )[ 1 ];\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n}\r\n\r\n// https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent.button\r\n\r\nTHREE.MOUSE = { LEFT: 0, MIDDLE: 1, RIGHT: 2 };\r\n\r\n// GL STATE CONSTANTS\r\n\r\nTHREE.CullFaceNone = 0;\r\nTHREE.CullFaceBack = 1;\r\nTHREE.CullFaceFront = 2;\r\nTHREE.CullFaceFrontBack = 3;\r\n\r\nTHREE.FrontFaceDirectionCW = 0;\r\nTHREE.FrontFaceDirectionCCW = 1;\r\n\r\n// SHADOWING TYPES\r\n\r\nTHREE.BasicShadowMap = 0;\r\nTHREE.PCFShadowMap = 1;\r\nTHREE.PCFSoftShadowMap = 2;\r\n\r\n// MATERIAL CONSTANTS\r\n\r\n// side\r\n\r\nTHREE.FrontSide = 0;\r\nTHREE.BackSide = 1;\r\nTHREE.DoubleSide = 2;\r\n\r\n// shading\r\n\r\nTHREE.FlatShading = 1;\r\nTHREE.SmoothShading = 2;\r\n\r\n// colors\r\n\r\nTHREE.NoColors = 0;\r\nTHREE.FaceColors = 1;\r\nTHREE.VertexColors = 2;\r\n\r\n// blending modes\r\n\r\nTHREE.NoBlending = 0;\r\nTHREE.NormalBlending = 1;\r\nTHREE.AdditiveBlending = 2;\r\nTHREE.SubtractiveBlending = 3;\r\nTHREE.MultiplyBlending = 4;\r\nTHREE.CustomBlending = 5;\r\n\r\n// custom blending equations\r\n// (numbers start from 100 not to clash with other\r\n// mappings to OpenGL constants defined in Texture.js)\r\n\r\nTHREE.AddEquation = 100;\r\nTHREE.SubtractEquation = 101;\r\nTHREE.ReverseSubtractEquation = 102;\r\nTHREE.MinEquation = 103;\r\nTHREE.MaxEquation = 104;\r\n\r\n// custom blending destination factors\r\n\r\nTHREE.ZeroFactor = 200;\r\nTHREE.OneFactor = 201;\r\nTHREE.SrcColorFactor = 202;\r\nTHREE.OneMinusSrcColorFactor = 203;\r\nTHREE.SrcAlphaFactor = 204;\r\nTHREE.OneMinusSrcAlphaFactor = 205;\r\nTHREE.DstAlphaFactor = 206;\r\nTHREE.OneMinusDstAlphaFactor = 207;\r\n\r\n// custom blending source factors\r\n\r\n//THREE.ZeroFactor = 200;\r\n//THREE.OneFactor = 201;\r\n//THREE.SrcAlphaFactor = 204;\r\n//THREE.OneMinusSrcAlphaFactor = 205;\r\n//THREE.DstAlphaFactor = 206;\r\n//THREE.OneMinusDstAlphaFactor = 207;\r\nTHREE.DstColorFactor = 208;\r\nTHREE.OneMinusDstColorFactor = 209;\r\nTHREE.SrcAlphaSaturateFactor = 210;\r\n\r\n// depth modes\r\n\r\nTHREE.NeverDepth = 0;\r\nTHREE.AlwaysDepth = 1;\r\nTHREE.LessDepth = 2;\r\nTHREE.LessEqualDepth = 3;\r\nTHREE.EqualDepth = 4;\r\nTHREE.GreaterEqualDepth = 5;\r\nTHREE.GreaterDepth = 6;\r\nTHREE.NotEqualDepth = 7;\r\n\r\n\r\n// TEXTURE CONSTANTS\r\n\r\nTHREE.MultiplyOperation = 0;\r\nTHREE.MixOperation = 1;\r\nTHREE.AddOperation = 2;\r\n\r\n// Mapping modes\r\n\r\nTHREE.UVMapping = 300;\r\n\r\nTHREE.CubeReflectionMapping = 301;\r\nTHREE.CubeRefractionMapping = 302;\r\n\r\nTHREE.EquirectangularReflectionMapping = 303;\r\nTHREE.EquirectangularRefractionMapping = 304;\r\n\r\nTHREE.SphericalReflectionMapping = 305;\r\n\r\n// Wrapping modes\r\n\r\nTHREE.RepeatWrapping = 1000;\r\nTHREE.ClampToEdgeWrapping = 1001;\r\nTHREE.MirroredRepeatWrapping = 1002;\r\n\r\n// Filters\r\n\r\nTHREE.NearestFilter = 1003;\r\nTHREE.NearestMipMapNearestFilter = 1004;\r\nTHREE.NearestMipMapLinearFilter = 1005;\r\nTHREE.LinearFilter = 1006;\r\nTHREE.LinearMipMapNearestFilter = 1007;\r\nTHREE.LinearMipMapLinearFilter = 1008;\r\n\r\n// Data types\r\n\r\nTHREE.UnsignedByteType = 1009;\r\nTHREE.ByteType = 1010;\r\nTHREE.ShortType = 1011;\r\nTHREE.UnsignedShortType = 1012;\r\nTHREE.IntType = 1013;\r\nTHREE.UnsignedIntType = 1014;\r\nTHREE.FloatType = 1015;\r\nTHREE.HalfFloatType = 1025;\r\n\r\n// Pixel types\r\n\r\n//THREE.UnsignedByteType = 1009;\r\nTHREE.UnsignedShort4444Type = 1016;\r\nTHREE.UnsignedShort5551Type = 1017;\r\nTHREE.UnsignedShort565Type = 1018;\r\n\r\n// Pixel formats\r\n\r\nTHREE.AlphaFormat = 1019;\r\nTHREE.RGBFormat = 1020;\r\nTHREE.RGBAFormat = 1021;\r\nTHREE.LuminanceFormat = 1022;\r\nTHREE.LuminanceAlphaFormat = 1023;\r\n// THREE.RGBEFormat handled as THREE.RGBAFormat in shaders\r\nTHREE.RGBEFormat = THREE.RGBAFormat; //1024;\r\n\r\n// DDS / ST3C Compressed texture formats\r\n\r\nTHREE.RGB_S3TC_DXT1_Format = 2001;\r\nTHREE.RGBA_S3TC_DXT1_Format = 2002;\r\nTHREE.RGBA_S3TC_DXT3_Format = 2003;\r\nTHREE.RGBA_S3TC_DXT5_Format = 2004;\r\n\r\n\r\n// PVRTC compressed texture formats\r\n\r\nTHREE.RGB_PVRTC_4BPPV1_Format = 2100;\r\nTHREE.RGB_PVRTC_2BPPV1_Format = 2101;\r\nTHREE.RGBA_PVRTC_4BPPV1_Format = 2102;\r\nTHREE.RGBA_PVRTC_2BPPV1_Format = 2103;\r\n\r\n// Loop styles for AnimationAction\r\n\r\nTHREE.LoopOnce = 2200;\r\nTHREE.LoopRepeat = 2201;\r\nTHREE.LoopPingPong = 2202;\r\n\r\n// DEPRECATED\r\n\r\nTHREE.Projector = function () {\r\n\r\n\tconsole.error( 'THREE.Projector has been moved to /examples/js/renderers/Projector.js.' );\r\n\r\n\tthis.projectVector = function ( vector, camera ) {\r\n\r\n\t\tconsole.warn( 'THREE.Projector: .projectVector() is now vector.project().' );\r\n\t\tvector.project( camera );\r\n\r\n\t};\r\n\r\n\tthis.unprojectVector = function ( vector, camera ) {\r\n\r\n\t\tconsole.warn( 'THREE.Projector: .unprojectVector() is now vector.unproject().' );\r\n\t\tvector.unproject( camera );\r\n\r\n\t};\r\n\r\n\tthis.pickingRay = function ( vector, camera ) {\r\n\r\n\t\tconsole.error( 'THREE.Projector: .pickingRay() is now raycaster.setFromCamera().' );\r\n\r\n\t};\r\n\r\n};\r\n\r\nTHREE.CanvasRenderer = function () {\r\n\r\n\tconsole.error( 'THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js' );\r\n\r\n\tthis.domElement = document.createElement( 'canvas' );\r\n\tthis.clear = function () {};\r\n\tthis.render = function () {};\r\n\tthis.setClearColor = function () {};\r\n\tthis.setSize = function () {};\r\n\r\n};\r\n\r\n// File:src/math/Color.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Color = function ( color ) {\r\n\r\n\tif ( arguments.length === 3 ) {\r\n\r\n\t\treturn this.fromArray( arguments );\r\n\r\n\t}\r\n\r\n\treturn this.set( color );\r\n\r\n};\r\n\r\nTHREE.Color.prototype = {\r\n\r\n\tconstructor: THREE.Color,\r\n\r\n\tr: 1, g: 1, b: 1,\r\n\r\n\tset: function ( value ) {\r\n\r\n\t\tif ( value instanceof THREE.Color ) {\r\n\r\n\t\t\tthis.copy( value );\r\n\r\n\t\t} else if ( typeof value === 'number' ) {\r\n\r\n\t\t\tthis.setHex( value );\r\n\r\n\t\t} else if ( typeof value === 'string' ) {\r\n\r\n\t\t\tthis.setStyle( value );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetHex: function ( hex ) {\r\n\r\n\t\thex = Math.floor( hex );\r\n\r\n\t\tthis.r = ( hex >> 16 & 255 ) / 255;\r\n\t\tthis.g = ( hex >> 8 & 255 ) / 255;\r\n\t\tthis.b = ( hex & 255 ) / 255;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetRGB: function ( r, g, b ) {\r\n\r\n\t\tthis.r = r;\r\n\t\tthis.g = g;\r\n\t\tthis.b = b;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetHSL: function () {\r\n\r\n\t\tfunction hue2rgb( p, q, t ) {\r\n\r\n\t\t\tif ( t < 0 ) t += 1;\r\n\t\t\tif ( t > 1 ) t -= 1;\r\n\t\t\tif ( t < 1 / 6 ) return p + ( q - p ) * 6 * t;\r\n\t\t\tif ( t < 1 / 2 ) return q;\r\n\t\t\tif ( t < 2 / 3 ) return p + ( q - p ) * 6 * ( 2 / 3 - t );\r\n\t\t\treturn p;\r\n\r\n\t\t}\r\n\r\n\t\treturn function ( h, s, l ) {\r\n\r\n\t\t\t// h,s,l ranges are in 0.0 - 1.0\r\n\t\t\th = THREE.Math.euclideanModulo( h, 1 );\r\n\t\t\ts = THREE.Math.clamp( s, 0, 1 );\r\n\t\t\tl = THREE.Math.clamp( l, 0, 1 );\r\n\r\n\t\t\tif ( s === 0 ) {\r\n\r\n\t\t\t\tthis.r = this.g = this.b = l;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvar p = l <= 0.5 ? l * ( 1 + s ) : l + s - ( l * s );\r\n\t\t\t\tvar q = ( 2 * l ) - p;\r\n\r\n\t\t\t\tthis.r = hue2rgb( q, p, h + 1 / 3 );\r\n\t\t\t\tthis.g = hue2rgb( q, p, h );\r\n\t\t\t\tthis.b = hue2rgb( q, p, h - 1 / 3 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tsetStyle: function ( style ) {\r\n\r\n\t\tfunction handleAlpha( string ) {\r\n\r\n\t\t\tif ( string === undefined ) return;\r\n\r\n\t\t\tif ( parseFloat( string ) < 1 ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Color: Alpha component of ' + style + ' will be ignored.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\r\n\t\tvar m;\r\n\r\n\t\tif ( m = /^((?:rgb|hsl)a?)\\(\\s*([^\\)]*)\\)/.exec( style ) ) {\r\n\r\n\t\t\t// rgb / hsl\r\n\r\n\t\t\tvar color;\r\n\t\t\tvar name = m[ 1 ];\r\n\t\t\tvar components = m[ 2 ];\r\n\r\n\t\t\tswitch ( name ) {\r\n\r\n\t\t\t\tcase 'rgb':\r\n\t\t\t\tcase 'rgba':\r\n\r\n\t\t\t\t\tif ( color = /^(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*(,\\s*([0-9]*\\.?[0-9]+)\\s*)?$/.exec( components ) ) {\r\n\r\n\t\t\t\t\t\t// rgb(255,0,0) rgba(255,0,0,0.5)\r\n\t\t\t\t\t\tthis.r = Math.min( 255, parseInt( color[ 1 ], 10 ) ) / 255;\r\n\t\t\t\t\t\tthis.g = Math.min( 255, parseInt( color[ 2 ], 10 ) ) / 255;\r\n\t\t\t\t\t\tthis.b = Math.min( 255, parseInt( color[ 3 ], 10 ) ) / 255;\r\n\r\n\t\t\t\t\t\thandleAlpha( color[ 5 ] );\r\n\r\n\t\t\t\t\t\treturn this;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( color = /^(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*(,\\s*([0-9]*\\.?[0-9]+)\\s*)?$/.exec( components ) ) {\r\n\r\n\t\t\t\t\t\t// rgb(100%,0%,0%) rgba(100%,0%,0%,0.5)\r\n\t\t\t\t\t\tthis.r = Math.min( 100, parseInt( color[ 1 ], 10 ) ) / 100;\r\n\t\t\t\t\t\tthis.g = Math.min( 100, parseInt( color[ 2 ], 10 ) ) / 100;\r\n\t\t\t\t\t\tthis.b = Math.min( 100, parseInt( color[ 3 ], 10 ) ) / 100;\r\n\r\n\t\t\t\t\t\thandleAlpha( color[ 5 ] );\r\n\r\n\t\t\t\t\t\treturn this;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'hsl':\r\n\t\t\t\tcase 'hsla':\r\n\r\n\t\t\t\t\tif ( color = /^([0-9]*\\.?[0-9]+)\\s*,\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*(,\\s*([0-9]*\\.?[0-9]+)\\s*)?$/.exec( components ) ) {\r\n\r\n\t\t\t\t\t\t// hsl(120,50%,50%) hsla(120,50%,50%,0.5)\r\n\t\t\t\t\t\tvar h = parseFloat( color[ 1 ] ) / 360;\r\n\t\t\t\t\t\tvar s = parseInt( color[ 2 ], 10 ) / 100;\r\n\t\t\t\t\t\tvar l = parseInt( color[ 3 ], 10 ) / 100;\r\n\r\n\t\t\t\t\t\thandleAlpha( color[ 5 ] );\r\n\r\n\t\t\t\t\t\treturn this.setHSL( h, s, l );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( m = /^\\#([A-Fa-f0-9]+)$/.exec( style ) ) {\r\n\r\n\t\t\t// hex color\r\n\r\n\t\t\tvar hex = m[ 1 ];\r\n\t\t\tvar size = hex.length;\r\n\r\n\t\t\tif ( size === 3 ) {\r\n\r\n\t\t\t\t// #ff0\r\n\t\t\t\tthis.r = parseInt( hex.charAt( 0 ) + hex.charAt( 0 ), 16 ) / 255;\r\n\t\t\t\tthis.g = parseInt( hex.charAt( 1 ) + hex.charAt( 1 ), 16 ) / 255;\r\n\t\t\t\tthis.b = parseInt( hex.charAt( 2 ) + hex.charAt( 2 ), 16 ) / 255;\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t} else if ( size === 6 ) {\r\n\r\n\t\t\t\t// #ff0000\r\n\t\t\t\tthis.r = parseInt( hex.charAt( 0 ) + hex.charAt( 1 ), 16 ) / 255;\r\n\t\t\t\tthis.g = parseInt( hex.charAt( 2 ) + hex.charAt( 3 ), 16 ) / 255;\r\n\t\t\t\tthis.b = parseInt( hex.charAt( 4 ) + hex.charAt( 5 ), 16 ) / 255;\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( style && style.length > 0 ) {\r\n\r\n\t\t\t// color keywords\r\n\t\t\tvar hex = THREE.ColorKeywords[ style ];\r\n\r\n\t\t\tif ( hex !== undefined ) {\r\n\r\n\t\t\t\t// red\r\n\t\t\t\tthis.setHex( hex );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// unknown color\r\n\t\t\t\tconsole.warn( 'THREE.Color: Unknown color ' + style );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor( this.r, this.g, this.b );\r\n\r\n\t},\r\n\r\n\tcopy: function ( color ) {\r\n\r\n\t\tthis.r = color.r;\r\n\t\tthis.g = color.g;\r\n\t\tthis.b = color.b;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopyGammaToLinear: function ( color, gammaFactor ) {\r\n\r\n\t\tif ( gammaFactor === undefined ) gammaFactor = 2.0;\r\n\r\n\t\tthis.r = Math.pow( color.r, gammaFactor );\r\n\t\tthis.g = Math.pow( color.g, gammaFactor );\r\n\t\tthis.b = Math.pow( color.b, gammaFactor );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopyLinearToGamma: function ( color, gammaFactor ) {\r\n\r\n\t\tif ( gammaFactor === undefined ) gammaFactor = 2.0;\r\n\r\n\t\tvar safeInverse = ( gammaFactor > 0 ) ? ( 1.0 / gammaFactor ) : 1.0;\r\n\r\n\t\tthis.r = Math.pow( color.r, safeInverse );\r\n\t\tthis.g = Math.pow( color.g, safeInverse );\r\n\t\tthis.b = Math.pow( color.b, safeInverse );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tconvertGammaToLinear: function () {\r\n\r\n\t\tvar r = this.r, g = this.g, b = this.b;\r\n\r\n\t\tthis.r = r * r;\r\n\t\tthis.g = g * g;\r\n\t\tthis.b = b * b;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tconvertLinearToGamma: function () {\r\n\r\n\t\tthis.r = Math.sqrt( this.r );\r\n\t\tthis.g = Math.sqrt( this.g );\r\n\t\tthis.b = Math.sqrt( this.b );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tgetHex: function () {\r\n\r\n\t\treturn ( this.r * 255 ) << 16 ^ ( this.g * 255 ) << 8 ^ ( this.b * 255 ) << 0;\r\n\r\n\t},\r\n\r\n\tgetHexString: function () {\r\n\r\n\t\treturn ( '000000' + this.getHex().toString( 16 ) ).slice( - 6 );\r\n\r\n\t},\r\n\r\n\tgetHSL: function ( optionalTarget ) {\r\n\r\n\t\t// h,s,l ranges are in 0.0 - 1.0\r\n\r\n\t\tvar hsl = optionalTarget || { h: 0, s: 0, l: 0 };\r\n\r\n\t\tvar r = this.r, g = this.g, b = this.b;\r\n\r\n\t\tvar max = Math.max( r, g, b );\r\n\t\tvar min = Math.min( r, g, b );\r\n\r\n\t\tvar hue, saturation;\r\n\t\tvar lightness = ( min + max ) / 2.0;\r\n\r\n\t\tif ( min === max ) {\r\n\r\n\t\t\thue = 0;\r\n\t\t\tsaturation = 0;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tvar delta = max - min;\r\n\r\n\t\t\tsaturation = lightness <= 0.5 ? delta / ( max + min ) : delta / ( 2 - max - min );\r\n\r\n\t\t\tswitch ( max ) {\r\n\r\n\t\t\t\tcase r: hue = ( g - b ) / delta + ( g < b ? 6 : 0 ); break;\r\n\t\t\t\tcase g: hue = ( b - r ) / delta + 2; break;\r\n\t\t\t\tcase b: hue = ( r - g ) / delta + 4; break;\r\n\r\n\t\t\t}\r\n\r\n\t\t\thue /= 6;\r\n\r\n\t\t}\r\n\r\n\t\thsl.h = hue;\r\n\t\thsl.s = saturation;\r\n\t\thsl.l = lightness;\r\n\r\n\t\treturn hsl;\r\n\r\n\t},\r\n\r\n\tgetStyle: function () {\r\n\r\n\t\treturn 'rgb(' + ( ( this.r * 255 ) | 0 ) + ',' + ( ( this.g * 255 ) | 0 ) + ',' + ( ( this.b * 255 ) | 0 ) + ')';\r\n\r\n\t},\r\n\r\n\toffsetHSL: function ( h, s, l ) {\r\n\r\n\t\tvar hsl = this.getHSL();\r\n\r\n\t\thsl.h += h; hsl.s += s; hsl.l += l;\r\n\r\n\t\tthis.setHSL( hsl.h, hsl.s, hsl.l );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tadd: function ( color ) {\r\n\r\n\t\tthis.r += color.r;\r\n\t\tthis.g += color.g;\r\n\t\tthis.b += color.b;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddColors: function ( color1, color2 ) {\r\n\r\n\t\tthis.r = color1.r + color2.r;\r\n\t\tthis.g = color1.g + color2.g;\r\n\t\tthis.b = color1.b + color2.b;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddScalar: function ( s ) {\r\n\r\n\t\tthis.r += s;\r\n\t\tthis.g += s;\r\n\t\tthis.b += s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiply: function ( color ) {\r\n\r\n\t\tthis.r *= color.r;\r\n\t\tthis.g *= color.g;\r\n\t\tthis.b *= color.b;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiplyScalar: function ( s ) {\r\n\r\n\t\tthis.r *= s;\r\n\t\tthis.g *= s;\r\n\t\tthis.b *= s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tlerp: function ( color, alpha ) {\r\n\r\n\t\tthis.r += ( color.r - this.r ) * alpha;\r\n\t\tthis.g += ( color.g - this.g ) * alpha;\r\n\t\tthis.b += ( color.b - this.b ) * alpha;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( c ) {\r\n\r\n\t\treturn ( c.r === this.r ) && ( c.g === this.g ) && ( c.b === this.b );\r\n\r\n\t},\r\n\r\n\tfromArray: function ( array, offset ) {\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tthis.r = array[ offset ];\r\n\t\tthis.g = array[ offset + 1 ];\r\n\t\tthis.b = array[ offset + 2 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttoArray: function ( array, offset ) {\r\n\r\n\t\tif ( array === undefined ) array = [];\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tarray[ offset ] = this.r;\r\n\t\tarray[ offset + 1 ] = this.g;\r\n\t\tarray[ offset + 2 ] = this.b;\r\n\r\n\t\treturn array;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.ColorKeywords = { 'aliceblue': 0xF0F8FF, 'antiquewhite': 0xFAEBD7, 'aqua': 0x00FFFF, 'aquamarine': 0x7FFFD4, 'azure': 0xF0FFFF,\r\n'beige': 0xF5F5DC, 'bisque': 0xFFE4C4, 'black': 0x000000, 'blanchedalmond': 0xFFEBCD, 'blue': 0x0000FF, 'blueviolet': 0x8A2BE2,\r\n'brown': 0xA52A2A, 'burlywood': 0xDEB887, 'cadetblue': 0x5F9EA0, 'chartreuse': 0x7FFF00, 'chocolate': 0xD2691E, 'coral': 0xFF7F50,\r\n'cornflowerblue': 0x6495ED, 'cornsilk': 0xFFF8DC, 'crimson': 0xDC143C, 'cyan': 0x00FFFF, 'darkblue': 0x00008B, 'darkcyan': 0x008B8B,\r\n'darkgoldenrod': 0xB8860B, 'darkgray': 0xA9A9A9, 'darkgreen': 0x006400, 'darkgrey': 0xA9A9A9, 'darkkhaki': 0xBDB76B, 'darkmagenta': 0x8B008B,\r\n'darkolivegreen': 0x556B2F, 'darkorange': 0xFF8C00, 'darkorchid': 0x9932CC, 'darkred': 0x8B0000, 'darksalmon': 0xE9967A, 'darkseagreen': 0x8FBC8F,\r\n'darkslateblue': 0x483D8B, 'darkslategray': 0x2F4F4F, 'darkslategrey': 0x2F4F4F, 'darkturquoise': 0x00CED1, 'darkviolet': 0x9400D3,\r\n'deeppink': 0xFF1493, 'deepskyblue': 0x00BFFF, 'dimgray': 0x696969, 'dimgrey': 0x696969, 'dodgerblue': 0x1E90FF, 'firebrick': 0xB22222,\r\n'floralwhite': 0xFFFAF0, 'forestgreen': 0x228B22, 'fuchsia': 0xFF00FF, 'gainsboro': 0xDCDCDC, 'ghostwhite': 0xF8F8FF, 'gold': 0xFFD700,\r\n'goldenrod': 0xDAA520, 'gray': 0x808080, 'green': 0x008000, 'greenyellow': 0xADFF2F, 'grey': 0x808080, 'honeydew': 0xF0FFF0, 'hotpink': 0xFF69B4,\r\n'indianred': 0xCD5C5C, 'indigo': 0x4B0082, 'ivory': 0xFFFFF0, 'khaki': 0xF0E68C, 'lavender': 0xE6E6FA, 'lavenderblush': 0xFFF0F5, 'lawngreen': 0x7CFC00,\r\n'lemonchiffon': 0xFFFACD, 'lightblue': 0xADD8E6, 'lightcoral': 0xF08080, 'lightcyan': 0xE0FFFF, 'lightgoldenrodyellow': 0xFAFAD2, 'lightgray': 0xD3D3D3,\r\n'lightgreen': 0x90EE90, 'lightgrey': 0xD3D3D3, 'lightpink': 0xFFB6C1, 'lightsalmon': 0xFFA07A, 'lightseagreen': 0x20B2AA, 'lightskyblue': 0x87CEFA,\r\n'lightslategray': 0x778899, 'lightslategrey': 0x778899, 'lightsteelblue': 0xB0C4DE, 'lightyellow': 0xFFFFE0, 'lime': 0x00FF00, 'limegreen': 0x32CD32,\r\n'linen': 0xFAF0E6, 'magenta': 0xFF00FF, 'maroon': 0x800000, 'mediumaquamarine': 0x66CDAA, 'mediumblue': 0x0000CD, 'mediumorchid': 0xBA55D3,\r\n'mediumpurple': 0x9370DB, 'mediumseagreen': 0x3CB371, 'mediumslateblue': 0x7B68EE, 'mediumspringgreen': 0x00FA9A, 'mediumturquoise': 0x48D1CC,\r\n'mediumvioletred': 0xC71585, 'midnightblue': 0x191970, 'mintcream': 0xF5FFFA, 'mistyrose': 0xFFE4E1, 'moccasin': 0xFFE4B5, 'navajowhite': 0xFFDEAD,\r\n'navy': 0x000080, 'oldlace': 0xFDF5E6, 'olive': 0x808000, 'olivedrab': 0x6B8E23, 'orange': 0xFFA500, 'orangered': 0xFF4500, 'orchid': 0xDA70D6,\r\n'palegoldenrod': 0xEEE8AA, 'palegreen': 0x98FB98, 'paleturquoise': 0xAFEEEE, 'palevioletred': 0xDB7093, 'papayawhip': 0xFFEFD5, 'peachpuff': 0xFFDAB9,\r\n'peru': 0xCD853F, 'pink': 0xFFC0CB, 'plum': 0xDDA0DD, 'powderblue': 0xB0E0E6, 'purple': 0x800080, 'red': 0xFF0000, 'rosybrown': 0xBC8F8F,\r\n'royalblue': 0x4169E1, 'saddlebrown': 0x8B4513, 'salmon': 0xFA8072, 'sandybrown': 0xF4A460, 'seagreen': 0x2E8B57, 'seashell': 0xFFF5EE,\r\n'sienna': 0xA0522D, 'silver': 0xC0C0C0, 'skyblue': 0x87CEEB, 'slateblue': 0x6A5ACD, 'slategray': 0x708090, 'slategrey': 0x708090, 'snow': 0xFFFAFA,\r\n'springgreen': 0x00FF7F, 'steelblue': 0x4682B4, 'tan': 0xD2B48C, 'teal': 0x008080, 'thistle': 0xD8BFD8, 'tomato': 0xFF6347, 'turquoise': 0x40E0D0,\r\n'violet': 0xEE82EE, 'wheat': 0xF5DEB3, 'white': 0xFFFFFF, 'whitesmoke': 0xF5F5F5, 'yellow': 0xFFFF00, 'yellowgreen': 0x9ACD32 };\r\n\r\n// File:src/math/Quaternion.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n * @author bhouston / http://clara.io\r\n */\r\n\r\nTHREE.Quaternion = function ( x, y, z, w ) {\r\n\r\n\tthis._x = x || 0;\r\n\tthis._y = y || 0;\r\n\tthis._z = z || 0;\r\n\tthis._w = ( w !== undefined ) ? w : 1;\r\n\r\n};\r\n\r\nTHREE.Quaternion.prototype = {\r\n\r\n\tconstructor: THREE.Quaternion,\r\n\r\n\tget x () {\r\n\r\n\t\treturn this._x;\r\n\r\n\t},\r\n\r\n\tset x ( value ) {\r\n\r\n\t\tthis._x = value;\r\n\t\tthis.onChangeCallback();\r\n\r\n\t},\r\n\r\n\tget y () {\r\n\r\n\t\treturn this._y;\r\n\r\n\t},\r\n\r\n\tset y ( value ) {\r\n\r\n\t\tthis._y = value;\r\n\t\tthis.onChangeCallback();\r\n\r\n\t},\r\n\r\n\tget z () {\r\n\r\n\t\treturn this._z;\r\n\r\n\t},\r\n\r\n\tset z ( value ) {\r\n\r\n\t\tthis._z = value;\r\n\t\tthis.onChangeCallback();\r\n\r\n\t},\r\n\r\n\tget w () {\r\n\r\n\t\treturn this._w;\r\n\r\n\t},\r\n\r\n\tset w ( value ) {\r\n\r\n\t\tthis._w = value;\r\n\t\tthis.onChangeCallback();\r\n\r\n\t},\r\n\r\n\tset: function ( x, y, z, w ) {\r\n\r\n\t\tthis._x = x;\r\n\t\tthis._y = y;\r\n\t\tthis._z = z;\r\n\t\tthis._w = w;\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor( this._x, this._y, this._z, this._w );\r\n\r\n\t},\r\n\r\n\tcopy: function ( quaternion ) {\r\n\r\n\t\tthis._x = quaternion.x;\r\n\t\tthis._y = quaternion.y;\r\n\t\tthis._z = quaternion.z;\r\n\t\tthis._w = quaternion.w;\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromEuler: function ( euler, update ) {\r\n\r\n\t\tif ( euler instanceof THREE.Euler === false ) {\r\n\r\n\t\t\tthrow new Error( 'THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.' );\r\n\r\n\t\t}\r\n\r\n\t\t// http://www.mathworks.com/matlabcentral/fileexchange/\r\n\t\t// \t20696-function-to-convert-between-dcm-euler-angles-quaternions-and-euler-vectors/\r\n\t\t//\tcontent/SpinCalc.m\r\n\r\n\t\tvar c1 = Math.cos( euler._x / 2 );\r\n\t\tvar c2 = Math.cos( euler._y / 2 );\r\n\t\tvar c3 = Math.cos( euler._z / 2 );\r\n\t\tvar s1 = Math.sin( euler._x / 2 );\r\n\t\tvar s2 = Math.sin( euler._y / 2 );\r\n\t\tvar s3 = Math.sin( euler._z / 2 );\r\n\r\n\t\tvar order = euler.order;\r\n\r\n\t\tif ( order === 'XYZ' ) {\r\n\r\n\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\r\n\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\r\n\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\r\n\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\r\n\r\n\t\t} else if ( order === 'YXZ' ) {\r\n\r\n\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\r\n\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\r\n\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\r\n\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\r\n\r\n\t\t} else if ( order === 'ZXY' ) {\r\n\r\n\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\r\n\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\r\n\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\r\n\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\r\n\r\n\t\t} else if ( order === 'ZYX' ) {\r\n\r\n\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\r\n\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\r\n\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\r\n\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\r\n\r\n\t\t} else if ( order === 'YZX' ) {\r\n\r\n\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\r\n\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\r\n\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\r\n\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\r\n\r\n\t\t} else if ( order === 'XZY' ) {\r\n\r\n\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\r\n\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\r\n\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\r\n\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\r\n\r\n\t\t}\r\n\r\n\t\tif ( update !== false ) this.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromAxisAngle: function ( axis, angle ) {\r\n\r\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/angleToQuaternion/index.htm\r\n\r\n\t\t// assumes axis is normalized\r\n\r\n\t\tvar halfAngle = angle / 2, s = Math.sin( halfAngle );\r\n\r\n\t\tthis._x = axis.x * s;\r\n\t\tthis._y = axis.y * s;\r\n\t\tthis._z = axis.z * s;\r\n\t\tthis._w = Math.cos( halfAngle );\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromRotationMatrix: function ( m ) {\r\n\r\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToQuaternion/index.htm\r\n\r\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\r\n\t\tvar te = m.elements,\r\n\r\n\t\t\tm11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ],\r\n\t\t\tm21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ],\r\n\t\t\tm31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ],\r\n\r\n\t\t\ttrace = m11 + m22 + m33,\r\n\t\t\ts;\r\n\r\n\t\tif ( trace > 0 ) {\r\n\r\n\t\t\ts = 0.5 / Math.sqrt( trace + 1.0 );\r\n\r\n\t\t\tthis._w = 0.25 / s;\r\n\t\t\tthis._x = ( m32 - m23 ) * s;\r\n\t\t\tthis._y = ( m13 - m31 ) * s;\r\n\t\t\tthis._z = ( m21 - m12 ) * s;\r\n\r\n\t\t} else if ( m11 > m22 && m11 > m33 ) {\r\n\r\n\t\t\ts = 2.0 * Math.sqrt( 1.0 + m11 - m22 - m33 );\r\n\r\n\t\t\tthis._w = ( m32 - m23 ) / s;\r\n\t\t\tthis._x = 0.25 * s;\r\n\t\t\tthis._y = ( m12 + m21 ) / s;\r\n\t\t\tthis._z = ( m13 + m31 ) / s;\r\n\r\n\t\t} else if ( m22 > m33 ) {\r\n\r\n\t\t\ts = 2.0 * Math.sqrt( 1.0 + m22 - m11 - m33 );\r\n\r\n\t\t\tthis._w = ( m13 - m31 ) / s;\r\n\t\t\tthis._x = ( m12 + m21 ) / s;\r\n\t\t\tthis._y = 0.25 * s;\r\n\t\t\tthis._z = ( m23 + m32 ) / s;\r\n\r\n\t\t} else {\r\n\r\n\t\t\ts = 2.0 * Math.sqrt( 1.0 + m33 - m11 - m22 );\r\n\r\n\t\t\tthis._w = ( m21 - m12 ) / s;\r\n\t\t\tthis._x = ( m13 + m31 ) / s;\r\n\t\t\tthis._y = ( m23 + m32 ) / s;\r\n\t\t\tthis._z = 0.25 * s;\r\n\r\n\t\t}\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromUnitVectors: function () {\r\n\r\n\t\t// http://lolengine.net/blog/2014/02/24/quaternion-from-two-vectors-final\r\n\r\n\t\t// assumes direction vectors vFrom and vTo are normalized\r\n\r\n\t\tvar v1, r;\r\n\r\n\t\tvar EPS = 0.000001;\r\n\r\n\t\treturn function ( vFrom, vTo ) {\r\n\r\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\r\n\t\t\tr = vFrom.dot( vTo ) + 1;\r\n\r\n\t\t\tif ( r < EPS ) {\r\n\r\n\t\t\t\tr = 0;\r\n\r\n\t\t\t\tif ( Math.abs( vFrom.x ) > Math.abs( vFrom.z ) ) {\r\n\r\n\t\t\t\t\tv1.set( - vFrom.y, vFrom.x, 0 );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tv1.set( 0, - vFrom.z, vFrom.y );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tv1.crossVectors( vFrom, vTo );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis._x = v1.x;\r\n\t\t\tthis._y = v1.y;\r\n\t\t\tthis._z = v1.z;\r\n\t\t\tthis._w = r;\r\n\r\n\t\t\tthis.normalize();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t}(),\r\n\r\n\tinverse: function () {\r\n\r\n\t\tthis.conjugate().normalize();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tconjugate: function () {\r\n\r\n\t\tthis._x *= - 1;\r\n\t\tthis._y *= - 1;\r\n\t\tthis._z *= - 1;\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdot: function ( v ) {\r\n\r\n\t\treturn this._x * v._x + this._y * v._y + this._z * v._z + this._w * v._w;\r\n\r\n\t},\r\n\r\n\tlengthSq: function () {\r\n\r\n\t\treturn this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w;\r\n\r\n\t},\r\n\r\n\tlength: function () {\r\n\r\n\t\treturn Math.sqrt( this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w );\r\n\r\n\t},\r\n\r\n\tnormalize: function () {\r\n\r\n\t\tvar l = this.length();\r\n\r\n\t\tif ( l === 0 ) {\r\n\r\n\t\t\tthis._x = 0;\r\n\t\t\tthis._y = 0;\r\n\t\t\tthis._z = 0;\r\n\t\t\tthis._w = 1;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tl = 1 / l;\r\n\r\n\t\t\tthis._x = this._x * l;\r\n\t\t\tthis._y = this._y * l;\r\n\t\t\tthis._z = this._z * l;\r\n\t\t\tthis._w = this._w * l;\r\n\r\n\t\t}\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiply: function ( q, p ) {\r\n\r\n\t\tif ( p !== undefined ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead.' );\r\n\t\t\treturn this.multiplyQuaternions( q, p );\r\n\r\n\t\t}\r\n\r\n\t\treturn this.multiplyQuaternions( this, q );\r\n\r\n\t},\r\n\r\n\tmultiplyQuaternions: function ( a, b ) {\r\n\r\n\t\t// from http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/code/index.htm\r\n\r\n\t\tvar qax = a._x, qay = a._y, qaz = a._z, qaw = a._w;\r\n\t\tvar qbx = b._x, qby = b._y, qbz = b._z, qbw = b._w;\r\n\r\n\t\tthis._x = qax * qbw + qaw * qbx + qay * qbz - qaz * qby;\r\n\t\tthis._y = qay * qbw + qaw * qby + qaz * qbx - qax * qbz;\r\n\t\tthis._z = qaz * qbw + qaw * qbz + qax * qby - qay * qbx;\r\n\t\tthis._w = qaw * qbw - qax * qbx - qay * qby - qaz * qbz;\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiplyVector3: function ( vector ) {\r\n\r\n\t\tconsole.warn( 'THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.' );\r\n\t\treturn vector.applyQuaternion( this );\r\n\r\n\t},\r\n\r\n\tslerp: function ( qb, t ) {\r\n\r\n\t\tif ( t === 0 ) return this;\r\n\t\tif ( t === 1 ) return this.copy( qb );\r\n\r\n\t\tvar x = this._x, y = this._y, z = this._z, w = this._w;\r\n\r\n\t\t// http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/slerp/\r\n\r\n\t\tvar cosHalfTheta = w * qb._w + x * qb._x + y * qb._y + z * qb._z;\r\n\r\n\t\tif ( cosHalfTheta < 0 ) {\r\n\r\n\t\t\tthis._w = - qb._w;\r\n\t\t\tthis._x = - qb._x;\r\n\t\t\tthis._y = - qb._y;\r\n\t\t\tthis._z = - qb._z;\r\n\r\n\t\t\tcosHalfTheta = - cosHalfTheta;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.copy( qb );\r\n\r\n\t\t}\r\n\r\n\t\tif ( cosHalfTheta >= 1.0 ) {\r\n\r\n\t\t\tthis._w = w;\r\n\t\t\tthis._x = x;\r\n\t\t\tthis._y = y;\r\n\t\t\tthis._z = z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t\tvar halfTheta = Math.acos( cosHalfTheta );\r\n\t\tvar sinHalfTheta = Math.sqrt( 1.0 - cosHalfTheta * cosHalfTheta );\r\n\r\n\t\tif ( Math.abs( sinHalfTheta ) < 0.001 ) {\r\n\r\n\t\t\tthis._w = 0.5 * ( w + this._w );\r\n\t\t\tthis._x = 0.5 * ( x + this._x );\r\n\t\t\tthis._y = 0.5 * ( y + this._y );\r\n\t\t\tthis._z = 0.5 * ( z + this._z );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t\tvar ratioA = Math.sin( ( 1 - t ) * halfTheta ) / sinHalfTheta,\r\n\t\tratioB = Math.sin( t * halfTheta ) / sinHalfTheta;\r\n\r\n\t\tthis._w = ( w * ratioA + this._w * ratioB );\r\n\t\tthis._x = ( x * ratioA + this._x * ratioB );\r\n\t\tthis._y = ( y * ratioA + this._y * ratioB );\r\n\t\tthis._z = ( z * ratioA + this._z * ratioB );\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( quaternion ) {\r\n\r\n\t\treturn ( quaternion._x === this._x ) && ( quaternion._y === this._y ) && ( quaternion._z === this._z ) && ( quaternion._w === this._w );\r\n\r\n\t},\r\n\r\n\tfromArray: function ( array, offset ) {\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tthis._x = array[ offset ];\r\n\t\tthis._y = array[ offset + 1 ];\r\n\t\tthis._z = array[ offset + 2 ];\r\n\t\tthis._w = array[ offset + 3 ];\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttoArray: function ( array, offset ) {\r\n\r\n\t\tif ( array === undefined ) array = [];\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tarray[ offset ] = this._x;\r\n\t\tarray[ offset + 1 ] = this._y;\r\n\t\tarray[ offset + 2 ] = this._z;\r\n\t\tarray[ offset + 3 ] = this._w;\r\n\r\n\t\treturn array;\r\n\r\n\t},\r\n\r\n\tonChange: function ( callback ) {\r\n\r\n\t\tthis.onChangeCallback = callback;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tonChangeCallback: function () {}\r\n\r\n};\r\n\r\nTHREE.Quaternion.slerp = function ( qa, qb, qm, t ) {\r\n\r\n\treturn qm.copy( qa ).slerp( qb, t );\r\n\r\n};\r\n\r\n// File:src/math/Vector2.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author philogb / http://blog.thejit.org/\r\n * @author egraether / http://egraether.com/\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n */\r\n\r\nTHREE.Vector2 = function ( x, y ) {\r\n\r\n\tthis.x = x || 0;\r\n\tthis.y = y || 0;\r\n\r\n};\r\n\r\nTHREE.Vector2.prototype = {\r\n\r\n\tconstructor: THREE.Vector2,\r\n\r\n\tget width() { return this.x },\r\n\tset width( value ) { this.x = value },\r\n\r\n\tget height() { return this.y },\r\n\tset height( value ) { this.y = value },\r\n\r\n\t//\r\n\r\n\tset: function ( x, y ) {\r\n\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetX: function ( x ) {\r\n\r\n\t\tthis.x = x;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetY: function ( y ) {\r\n\r\n\t\tthis.y = y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetComponent: function ( index, value ) {\r\n\r\n\t\tswitch ( index ) {\r\n\r\n\t\t\tcase 0: this.x = value; break;\r\n\t\t\tcase 1: this.y = value; break;\r\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tgetComponent: function ( index ) {\r\n\r\n\t\tswitch ( index ) {\r\n\r\n\t\t\tcase 0: return this.x;\r\n\t\t\tcase 1: return this.y;\r\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor( this.x, this.y );\r\n\r\n\t},\r\n\r\n\tcopy: function ( v ) {\r\n\r\n\t\tthis.x = v.x;\r\n\t\tthis.y = v.y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tadd: function ( v, w ) {\r\n\r\n\t\tif ( w !== undefined ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead.' );\r\n\t\t\treturn this.addVectors( v, w );\r\n\r\n\t\t}\r\n\r\n\t\tthis.x += v.x;\r\n\t\tthis.y += v.y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddScalar: function ( s ) {\r\n\r\n\t\tthis.x += s;\r\n\t\tthis.y += s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddVectors: function ( a, b ) {\r\n\r\n\t\tthis.x = a.x + b.x;\r\n\t\tthis.y = a.y + b.y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddScaledVector: function ( v, s ) {\r\n\r\n\t\tthis.x += v.x * s;\r\n\t\tthis.y += v.y * s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsub: function ( v, w ) {\r\n\r\n\t\tif ( w !== undefined ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.' );\r\n\t\t\treturn this.subVectors( v, w );\r\n\r\n\t\t}\r\n\r\n\t\tthis.x -= v.x;\r\n\t\tthis.y -= v.y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsubScalar: function ( s ) {\r\n\r\n\t\tthis.x -= s;\r\n\t\tthis.y -= s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsubVectors: function ( a, b ) {\r\n\r\n\t\tthis.x = a.x - b.x;\r\n\t\tthis.y = a.y - b.y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiply: function ( v ) {\r\n\r\n\t\tthis.x *= v.x;\r\n\t\tthis.y *= v.y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiplyScalar: function ( scalar ) {\r\n\r\n\t\tif ( isFinite( scalar ) ) {\r\n\t\t\tthis.x *= scalar;\r\n\t\t\tthis.y *= scalar;\r\n\t\t} else {\r\n\t\t\tthis.x = 0;\r\n\t\t\tthis.y = 0;\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdivide: function ( v ) {\r\n\r\n\t\tthis.x /= v.x;\r\n\t\tthis.y /= v.y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdivideScalar: function ( scalar ) {\r\n\r\n\t\treturn this.multiplyScalar( 1 / scalar );\r\n\r\n\t},\r\n\r\n\tmin: function ( v ) {\r\n\r\n\t\tthis.x = Math.min( this.x, v.x );\r\n\t\tthis.y = Math.min( this.y, v.y );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmax: function ( v ) {\r\n\r\n\t\tthis.x = Math.max( this.x, v.x );\r\n\t\tthis.y = Math.max( this.y, v.y );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclamp: function ( min, max ) {\r\n\r\n\t\t// This function assumes min < max, if this assumption isn't true it will not operate correctly\r\n\r\n\t\tthis.x = Math.max( min.x, Math.min( max.x, this.x ) );\r\n\t\tthis.y = Math.max( min.y, Math.min( max.y, this.y ) );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclampScalar: function () {\r\n\r\n\t\tvar min, max;\r\n\r\n\t\treturn function clampScalar( minVal, maxVal ) {\r\n\r\n\t\t\tif ( min === undefined ) {\r\n\r\n\t\t\t\tmin = new THREE.Vector2();\r\n\t\t\t\tmax = new THREE.Vector2();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tmin.set( minVal, minVal );\r\n\t\t\tmax.set( maxVal, maxVal );\r\n\r\n\t\t\treturn this.clamp( min, max );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tclampLength: function ( min, max ) {\r\n\r\n\t\tvar length = this.length();\r\n\r\n\t\tthis.multiplyScalar( Math.max( min, Math.min( max, length ) ) / length );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tfloor: function () {\r\n\r\n\t\tthis.x = Math.floor( this.x );\r\n\t\tthis.y = Math.floor( this.y );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tceil: function () {\r\n\r\n\t\tthis.x = Math.ceil( this.x );\r\n\t\tthis.y = Math.ceil( this.y );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tround: function () {\r\n\r\n\t\tthis.x = Math.round( this.x );\r\n\t\tthis.y = Math.round( this.y );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\troundToZero: function () {\r\n\r\n\t\tthis.x = ( this.x < 0 ) ? Math.ceil( this.x ) : Math.floor( this.x );\r\n\t\tthis.y = ( this.y < 0 ) ? Math.ceil( this.y ) : Math.floor( this.y );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tnegate: function () {\r\n\r\n\t\tthis.x = - this.x;\r\n\t\tthis.y = - this.y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdot: function ( v ) {\r\n\r\n\t\treturn this.x * v.x + this.y * v.y;\r\n\r\n\t},\r\n\r\n\tlengthSq: function () {\r\n\r\n\t\treturn this.x * this.x + this.y * this.y;\r\n\r\n\t},\r\n\r\n\tlength: function () {\r\n\r\n\t\treturn Math.sqrt( this.x * this.x + this.y * this.y );\r\n\r\n\t},\r\n\r\n\tlengthManhattan: function() {\r\n\r\n\t\treturn Math.abs( this.x ) + Math.abs( this.y );\r\n\r\n\t},\r\n\r\n\tnormalize: function () {\r\n\r\n\t\treturn this.divideScalar( this.length() );\r\n\r\n\t},\r\n\r\n\tdistanceTo: function ( v ) {\r\n\r\n\t\treturn Math.sqrt( this.distanceToSquared( v ) );\r\n\r\n\t},\r\n\r\n\tdistanceToSquared: function ( v ) {\r\n\r\n\t\tvar dx = this.x - v.x, dy = this.y - v.y;\r\n\t\treturn dx * dx + dy * dy;\r\n\r\n\t},\r\n\r\n\tsetLength: function ( length ) {\r\n\r\n\t\treturn this.multiplyScalar( length / this.length() );\r\n\r\n\t},\r\n\r\n\tlerp: function ( v, alpha ) {\r\n\r\n\t\tthis.x += ( v.x - this.x ) * alpha;\r\n\t\tthis.y += ( v.y - this.y ) * alpha;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tlerpVectors: function ( v1, v2, alpha ) {\r\n\r\n\t\tthis.subVectors( v2, v1 ).multiplyScalar( alpha ).add( v1 );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( v ) {\r\n\r\n\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) );\r\n\r\n\t},\r\n\r\n\tfromArray: function ( array, offset ) {\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tthis.x = array[ offset ];\r\n\t\tthis.y = array[ offset + 1 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttoArray: function ( array, offset ) {\r\n\r\n\t\tif ( array === undefined ) array = [];\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tarray[ offset ] = this.x;\r\n\t\tarray[ offset + 1 ] = this.y;\r\n\r\n\t\treturn array;\r\n\r\n\t},\r\n\r\n\tfromAttribute: function ( attribute, index, offset ) {\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tindex = index * attribute.itemSize + offset;\r\n\r\n\t\tthis.x = attribute.array[ index ];\r\n\t\tthis.y = attribute.array[ index + 1 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\trotateAround: function ( center, angle ) {\r\n\r\n\t\tvar c = Math.cos( angle ), s = Math.sin( angle );\r\n\r\n\t\tvar x = this.x - center.x;\r\n\t\tvar y = this.y - center.y;\r\n\r\n\t\tthis.x = x * c - y * s + center.x;\r\n\t\tthis.y = x * s + y * c + center.y;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Vector3.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author *kile / http://kile.stravaganza.org/\r\n * @author philogb / http://blog.thejit.org/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author egraether / http://egraether.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.Vector3 = function ( x, y, z ) {\r\n\r\n\tthis.x = x || 0;\r\n\tthis.y = y || 0;\r\n\tthis.z = z || 0;\r\n\r\n};\r\n\r\nTHREE.Vector3.prototype = {\r\n\r\n\tconstructor: THREE.Vector3,\r\n\r\n\tset: function ( x, y, z ) {\r\n\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t\tthis.z = z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetX: function ( x ) {\r\n\r\n\t\tthis.x = x;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetY: function ( y ) {\r\n\r\n\t\tthis.y = y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetZ: function ( z ) {\r\n\r\n\t\tthis.z = z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetComponent: function ( index, value ) {\r\n\r\n\t\tswitch ( index ) {\r\n\r\n\t\t\tcase 0: this.x = value; break;\r\n\t\t\tcase 1: this.y = value; break;\r\n\t\t\tcase 2: this.z = value; break;\r\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tgetComponent: function ( index ) {\r\n\r\n\t\tswitch ( index ) {\r\n\r\n\t\t\tcase 0: return this.x;\r\n\t\t\tcase 1: return this.y;\r\n\t\t\tcase 2: return this.z;\r\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor( this.x, this.y, this.z );\r\n\r\n\t},\r\n\r\n\tcopy: function ( v ) {\r\n\r\n\t\tthis.x = v.x;\r\n\t\tthis.y = v.y;\r\n\t\tthis.z = v.z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tadd: function ( v, w ) {\r\n\r\n\t\tif ( w !== undefined ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead.' );\r\n\t\t\treturn this.addVectors( v, w );\r\n\r\n\t\t}\r\n\r\n\t\tthis.x += v.x;\r\n\t\tthis.y += v.y;\r\n\t\tthis.z += v.z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddScalar: function ( s ) {\r\n\r\n\t\tthis.x += s;\r\n\t\tthis.y += s;\r\n\t\tthis.z += s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddVectors: function ( a, b ) {\r\n\r\n\t\tthis.x = a.x + b.x;\r\n\t\tthis.y = a.y + b.y;\r\n\t\tthis.z = a.z + b.z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddScaledVector: function ( v, s ) {\r\n\r\n\t\tthis.x += v.x * s;\r\n\t\tthis.y += v.y * s;\r\n\t\tthis.z += v.z * s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsub: function ( v, w ) {\r\n\r\n\t\tif ( w !== undefined ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.' );\r\n\t\t\treturn this.subVectors( v, w );\r\n\r\n\t\t}\r\n\r\n\t\tthis.x -= v.x;\r\n\t\tthis.y -= v.y;\r\n\t\tthis.z -= v.z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsubScalar: function ( s ) {\r\n\r\n\t\tthis.x -= s;\r\n\t\tthis.y -= s;\r\n\t\tthis.z -= s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsubVectors: function ( a, b ) {\r\n\r\n\t\tthis.x = a.x - b.x;\r\n\t\tthis.y = a.y - b.y;\r\n\t\tthis.z = a.z - b.z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiply: function ( v, w ) {\r\n\r\n\t\tif ( w !== undefined ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead.' );\r\n\t\t\treturn this.multiplyVectors( v, w );\r\n\r\n\t\t}\r\n\r\n\t\tthis.x *= v.x;\r\n\t\tthis.y *= v.y;\r\n\t\tthis.z *= v.z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiplyScalar: function ( scalar ) {\r\n\r\n\t\tif ( isFinite( scalar ) ) {\r\n\t\t\tthis.x *= scalar;\r\n\t\t\tthis.y *= scalar;\r\n\t\t\tthis.z *= scalar;\r\n\t\t} else {\r\n\t\t\tthis.x = 0;\r\n\t\t\tthis.y = 0;\r\n\t\t\tthis.z = 0;\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiplyVectors: function ( a, b ) {\r\n\r\n\t\tthis.x = a.x * b.x;\r\n\t\tthis.y = a.y * b.y;\r\n\t\tthis.z = a.z * b.z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tapplyEuler: function () {\r\n\r\n\t\tvar quaternion;\r\n\r\n\t\treturn function applyEuler( euler ) {\r\n\r\n\t\t\tif ( euler instanceof THREE.Euler === false ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.Vector3: .applyEuler() now expects a Euler rotation rather than a Vector3 and order.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( quaternion === undefined ) quaternion = new THREE.Quaternion();\r\n\r\n\t\t\tthis.applyQuaternion( quaternion.setFromEuler( euler ) );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tapplyAxisAngle: function () {\r\n\r\n\t\tvar quaternion;\r\n\r\n\t\treturn function applyAxisAngle( axis, angle ) {\r\n\r\n\t\t\tif ( quaternion === undefined ) quaternion = new THREE.Quaternion();\r\n\r\n\t\t\tthis.applyQuaternion( quaternion.setFromAxisAngle( axis, angle ) );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tapplyMatrix3: function ( m ) {\r\n\r\n\t\tvar x = this.x;\r\n\t\tvar y = this.y;\r\n\t\tvar z = this.z;\r\n\r\n\t\tvar e = m.elements;\r\n\r\n\t\tthis.x = e[ 0 ] * x + e[ 3 ] * y + e[ 6 ] * z;\r\n\t\tthis.y = e[ 1 ] * x + e[ 4 ] * y + e[ 7 ] * z;\r\n\t\tthis.z = e[ 2 ] * x + e[ 5 ] * y + e[ 8 ] * z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tapplyMatrix4: function ( m ) {\r\n\r\n\t\t// input: THREE.Matrix4 affine matrix\r\n\r\n\t\tvar x = this.x, y = this.y, z = this.z;\r\n\r\n\t\tvar e = m.elements;\r\n\r\n\t\tthis.x = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ]  * z + e[ 12 ];\r\n\t\tthis.y = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ]  * z + e[ 13 ];\r\n\t\tthis.z = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z + e[ 14 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tapplyProjection: function ( m ) {\r\n\r\n\t\t// input: THREE.Matrix4 projection matrix\r\n\r\n\t\tvar x = this.x, y = this.y, z = this.z;\r\n\r\n\t\tvar e = m.elements;\r\n\t\tvar d = 1 / ( e[ 3 ] * x + e[ 7 ] * y + e[ 11 ] * z + e[ 15 ] ); // perspective divide\r\n\r\n\t\tthis.x = ( e[ 0 ] * x + e[ 4 ] * y + e[ 8 ]  * z + e[ 12 ] ) * d;\r\n\t\tthis.y = ( e[ 1 ] * x + e[ 5 ] * y + e[ 9 ]  * z + e[ 13 ] ) * d;\r\n\t\tthis.z = ( e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z + e[ 14 ] ) * d;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tapplyQuaternion: function ( q ) {\r\n\r\n\t\tvar x = this.x;\r\n\t\tvar y = this.y;\r\n\t\tvar z = this.z;\r\n\r\n\t\tvar qx = q.x;\r\n\t\tvar qy = q.y;\r\n\t\tvar qz = q.z;\r\n\t\tvar qw = q.w;\r\n\r\n\t\t// calculate quat * vector\r\n\r\n\t\tvar ix =  qw * x + qy * z - qz * y;\r\n\t\tvar iy =  qw * y + qz * x - qx * z;\r\n\t\tvar iz =  qw * z + qx * y - qy * x;\r\n\t\tvar iw = - qx * x - qy * y - qz * z;\r\n\r\n\t\t// calculate result * inverse quat\r\n\r\n\t\tthis.x = ix * qw + iw * - qx + iy * - qz - iz * - qy;\r\n\t\tthis.y = iy * qw + iw * - qy + iz * - qx - ix * - qz;\r\n\t\tthis.z = iz * qw + iw * - qz + ix * - qy - iy * - qx;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tproject: function () {\r\n\r\n\t\tvar matrix;\r\n\r\n\t\treturn function project( camera ) {\r\n\r\n\t\t\tif ( matrix === undefined ) matrix = new THREE.Matrix4();\r\n\r\n\t\t\tmatrix.multiplyMatrices( camera.projectionMatrix, matrix.getInverse( camera.matrixWorld ) );\r\n\t\t\treturn this.applyProjection( matrix );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tunproject: function () {\r\n\r\n\t\tvar matrix;\r\n\r\n\t\treturn function unproject( camera ) {\r\n\r\n\t\t\tif ( matrix === undefined ) matrix = new THREE.Matrix4();\r\n\r\n\t\t\tmatrix.multiplyMatrices( camera.matrixWorld, matrix.getInverse( camera.projectionMatrix ) );\r\n\t\t\treturn this.applyProjection( matrix );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\ttransformDirection: function ( m ) {\r\n\r\n\t\t// input: THREE.Matrix4 affine matrix\r\n\t\t// vector interpreted as a direction\r\n\r\n\t\tvar x = this.x, y = this.y, z = this.z;\r\n\r\n\t\tvar e = m.elements;\r\n\r\n\t\tthis.x = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ]  * z;\r\n\t\tthis.y = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ]  * z;\r\n\t\tthis.z = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z;\r\n\r\n\t\tthis.normalize();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdivide: function ( v ) {\r\n\r\n\t\tthis.x /= v.x;\r\n\t\tthis.y /= v.y;\r\n\t\tthis.z /= v.z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdivideScalar: function ( scalar ) {\r\n\r\n\t\treturn this.multiplyScalar( 1 / scalar );\r\n\r\n\t},\r\n\r\n\tmin: function ( v ) {\r\n\r\n\t\tthis.x = Math.min( this.x, v.x );\r\n\t\tthis.y = Math.min( this.y, v.y );\r\n\t\tthis.z = Math.min( this.z, v.z );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmax: function ( v ) {\r\n\r\n\t\tthis.x = Math.max( this.x, v.x );\r\n\t\tthis.y = Math.max( this.y, v.y );\r\n\t\tthis.z = Math.max( this.z, v.z );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclamp: function ( min, max ) {\r\n\r\n\t\t// This function assumes min < max, if this assumption isn't true it will not operate correctly\r\n\r\n\t\tthis.x = Math.max( min.x, Math.min( max.x, this.x ) );\r\n\t\tthis.y = Math.max( min.y, Math.min( max.y, this.y ) );\r\n\t\tthis.z = Math.max( min.z, Math.min( max.z, this.z ) );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclampScalar: function () {\r\n\r\n\t\tvar min, max;\r\n\r\n\t\treturn function clampScalar( minVal, maxVal ) {\r\n\r\n\t\t\tif ( min === undefined ) {\r\n\r\n\t\t\t\tmin = new THREE.Vector3();\r\n\t\t\t\tmax = new THREE.Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tmin.set( minVal, minVal, minVal );\r\n\t\t\tmax.set( maxVal, maxVal, maxVal );\r\n\r\n\t\t\treturn this.clamp( min, max );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tclampLength: function ( min, max ) {\r\n\r\n\t\tvar length = this.length();\r\n\r\n\t\tthis.multiplyScalar( Math.max( min, Math.min( max, length ) ) / length );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tfloor: function () {\r\n\r\n\t\tthis.x = Math.floor( this.x );\r\n\t\tthis.y = Math.floor( this.y );\r\n\t\tthis.z = Math.floor( this.z );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tceil: function () {\r\n\r\n\t\tthis.x = Math.ceil( this.x );\r\n\t\tthis.y = Math.ceil( this.y );\r\n\t\tthis.z = Math.ceil( this.z );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tround: function () {\r\n\r\n\t\tthis.x = Math.round( this.x );\r\n\t\tthis.y = Math.round( this.y );\r\n\t\tthis.z = Math.round( this.z );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\troundToZero: function () {\r\n\r\n\t\tthis.x = ( this.x < 0 ) ? Math.ceil( this.x ) : Math.floor( this.x );\r\n\t\tthis.y = ( this.y < 0 ) ? Math.ceil( this.y ) : Math.floor( this.y );\r\n\t\tthis.z = ( this.z < 0 ) ? Math.ceil( this.z ) : Math.floor( this.z );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tnegate: function () {\r\n\r\n\t\tthis.x = - this.x;\r\n\t\tthis.y = - this.y;\r\n\t\tthis.z = - this.z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdot: function ( v ) {\r\n\r\n\t\treturn this.x * v.x + this.y * v.y + this.z * v.z;\r\n\r\n\t},\r\n\r\n\tlengthSq: function () {\r\n\r\n\t\treturn this.x * this.x + this.y * this.y + this.z * this.z;\r\n\r\n\t},\r\n\r\n\tlength: function () {\r\n\r\n\t\treturn Math.sqrt( this.x * this.x + this.y * this.y + this.z * this.z );\r\n\r\n\t},\r\n\r\n\tlengthManhattan: function () {\r\n\r\n\t\treturn Math.abs( this.x ) + Math.abs( this.y ) + Math.abs( this.z );\r\n\r\n\t},\r\n\r\n\tnormalize: function () {\r\n\r\n\t\treturn this.divideScalar( this.length() );\r\n\r\n\t},\r\n\r\n\tsetLength: function ( length ) {\r\n\r\n\t\treturn this.multiplyScalar( length / this.length() );\r\n\r\n\t},\r\n\r\n\tlerp: function ( v, alpha ) {\r\n\r\n\t\tthis.x += ( v.x - this.x ) * alpha;\r\n\t\tthis.y += ( v.y - this.y ) * alpha;\r\n\t\tthis.z += ( v.z - this.z ) * alpha;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tlerpVectors: function ( v1, v2, alpha ) {\r\n\r\n\t\tthis.subVectors( v2, v1 ).multiplyScalar( alpha ).add( v1 );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcross: function ( v, w ) {\r\n\r\n\t\tif ( w !== undefined ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead.' );\r\n\t\t\treturn this.crossVectors( v, w );\r\n\r\n\t\t}\r\n\r\n\t\tvar x = this.x, y = this.y, z = this.z;\r\n\r\n\t\tthis.x = y * v.z - z * v.y;\r\n\t\tthis.y = z * v.x - x * v.z;\r\n\t\tthis.z = x * v.y - y * v.x;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcrossVectors: function ( a, b ) {\r\n\r\n\t\tvar ax = a.x, ay = a.y, az = a.z;\r\n\t\tvar bx = b.x, by = b.y, bz = b.z;\r\n\r\n\t\tthis.x = ay * bz - az * by;\r\n\t\tthis.y = az * bx - ax * bz;\r\n\t\tthis.z = ax * by - ay * bx;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tprojectOnVector: function () {\r\n\r\n\t\tvar v1, dot;\r\n\r\n\t\treturn function projectOnVector( vector ) {\r\n\r\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\r\n\t\t\tv1.copy( vector ).normalize();\r\n\r\n\t\t\tdot = this.dot( v1 );\r\n\r\n\t\t\treturn this.copy( v1 ).multiplyScalar( dot );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tprojectOnPlane: function () {\r\n\r\n\t\tvar v1;\r\n\r\n\t\treturn function projectOnPlane( planeNormal ) {\r\n\r\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\r\n\t\t\tv1.copy( this ).projectOnVector( planeNormal );\r\n\r\n\t\t\treturn this.sub( v1 );\r\n\r\n\t\t}\r\n\r\n\t}(),\r\n\r\n\treflect: function () {\r\n\r\n\t\t// reflect incident vector off plane orthogonal to normal\r\n\t\t// normal is assumed to have unit length\r\n\r\n\t\tvar v1;\r\n\r\n\t\treturn function reflect( normal ) {\r\n\r\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\r\n\t\t\treturn this.sub( v1.copy( normal ).multiplyScalar( 2 * this.dot( normal ) ) );\r\n\r\n\t\t}\r\n\r\n\t}(),\r\n\r\n\tangleTo: function ( v ) {\r\n\r\n\t\tvar theta = this.dot( v ) / ( this.length() * v.length() );\r\n\r\n\t\t// clamp, to handle numerical problems\r\n\r\n\t\treturn Math.acos( THREE.Math.clamp( theta, - 1, 1 ) );\r\n\r\n\t},\r\n\r\n\tdistanceTo: function ( v ) {\r\n\r\n\t\treturn Math.sqrt( this.distanceToSquared( v ) );\r\n\r\n\t},\r\n\r\n\tdistanceToSquared: function ( v ) {\r\n\r\n\t\tvar dx = this.x - v.x;\r\n\t\tvar dy = this.y - v.y;\r\n\t\tvar dz = this.z - v.z;\r\n\r\n\t\treturn dx * dx + dy * dy + dz * dz;\r\n\r\n\t},\r\n\r\n\tsetEulerFromRotationMatrix: function ( m, order ) {\r\n\r\n\t\tconsole.error( 'THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.' );\r\n\r\n\t},\r\n\r\n\tsetEulerFromQuaternion: function ( q, order ) {\r\n\r\n\t\tconsole.error( 'THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.' );\r\n\r\n\t},\r\n\r\n\tgetPositionFromMatrix: function ( m ) {\r\n\r\n\t\tconsole.warn( 'THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition().' );\r\n\r\n\t\treturn this.setFromMatrixPosition( m );\r\n\r\n\t},\r\n\r\n\tgetScaleFromMatrix: function ( m ) {\r\n\r\n\t\tconsole.warn( 'THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale().' );\r\n\r\n\t\treturn this.setFromMatrixScale( m );\r\n\r\n\t},\r\n\r\n\tgetColumnFromMatrix: function ( index, matrix ) {\r\n\r\n\t\tconsole.warn( 'THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn().' );\r\n\r\n\t\treturn this.setFromMatrixColumn( index, matrix );\r\n\r\n\t},\r\n\r\n\tsetFromMatrixPosition: function ( m ) {\r\n\r\n\t\tthis.x = m.elements[ 12 ];\r\n\t\tthis.y = m.elements[ 13 ];\r\n\t\tthis.z = m.elements[ 14 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromMatrixScale: function ( m ) {\r\n\r\n\t\tvar sx = this.set( m.elements[ 0 ], m.elements[ 1 ], m.elements[ 2 ] ).length();\r\n\t\tvar sy = this.set( m.elements[ 4 ], m.elements[ 5 ], m.elements[ 6 ] ).length();\r\n\t\tvar sz = this.set( m.elements[ 8 ], m.elements[ 9 ], m.elements[ 10 ] ).length();\r\n\r\n\t\tthis.x = sx;\r\n\t\tthis.y = sy;\r\n\t\tthis.z = sz;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromMatrixColumn: function ( index, matrix ) {\r\n\r\n\t\tvar offset = index * 4;\r\n\r\n\t\tvar me = matrix.elements;\r\n\r\n\t\tthis.x = me[ offset ];\r\n\t\tthis.y = me[ offset + 1 ];\r\n\t\tthis.z = me[ offset + 2 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( v ) {\r\n\r\n\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) && ( v.z === this.z ) );\r\n\r\n\t},\r\n\r\n\tfromArray: function ( array, offset ) {\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tthis.x = array[ offset ];\r\n\t\tthis.y = array[ offset + 1 ];\r\n\t\tthis.z = array[ offset + 2 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttoArray: function ( array, offset ) {\r\n\r\n\t\tif ( array === undefined ) array = [];\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tarray[ offset ] = this.x;\r\n\t\tarray[ offset + 1 ] = this.y;\r\n\t\tarray[ offset + 2 ] = this.z;\r\n\r\n\t\treturn array;\r\n\r\n\t},\r\n\r\n\tfromAttribute: function ( attribute, index, offset ) {\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tindex = index * attribute.itemSize + offset;\r\n\r\n\t\tthis.x = attribute.array[ index ];\r\n\t\tthis.y = attribute.array[ index + 1 ];\r\n\t\tthis.z = attribute.array[ index + 2 ];\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Vector4.js\r\n\r\n/**\r\n * @author supereggbert / http://www.paulbrunt.co.uk/\r\n * @author philogb / http://blog.thejit.org/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author egraether / http://egraether.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.Vector4 = function ( x, y, z, w ) {\r\n\r\n\tthis.x = x || 0;\r\n\tthis.y = y || 0;\r\n\tthis.z = z || 0;\r\n\tthis.w = ( w !== undefined ) ? w : 1;\r\n\r\n};\r\n\r\nTHREE.Vector4.prototype = {\r\n\r\n\tconstructor: THREE.Vector4,\r\n\r\n\tset: function ( x, y, z, w ) {\r\n\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t\tthis.z = z;\r\n\t\tthis.w = w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetX: function ( x ) {\r\n\r\n\t\tthis.x = x;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetY: function ( y ) {\r\n\r\n\t\tthis.y = y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetZ: function ( z ) {\r\n\r\n\t\tthis.z = z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetW: function ( w ) {\r\n\r\n\t\tthis.w = w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetComponent: function ( index, value ) {\r\n\r\n\t\tswitch ( index ) {\r\n\r\n\t\t\tcase 0: this.x = value; break;\r\n\t\t\tcase 1: this.y = value; break;\r\n\t\t\tcase 2: this.z = value; break;\r\n\t\t\tcase 3: this.w = value; break;\r\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tgetComponent: function ( index ) {\r\n\r\n\t\tswitch ( index ) {\r\n\r\n\t\t\tcase 0: return this.x;\r\n\t\t\tcase 1: return this.y;\r\n\t\t\tcase 2: return this.z;\r\n\t\t\tcase 3: return this.w;\r\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor( this.x, this.y, this.z, this.w );\r\n\r\n\t},\r\n\r\n\tcopy: function ( v ) {\r\n\r\n\t\tthis.x = v.x;\r\n\t\tthis.y = v.y;\r\n\t\tthis.z = v.z;\r\n\t\tthis.w = ( v.w !== undefined ) ? v.w : 1;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tadd: function ( v, w ) {\r\n\r\n\t\tif ( w !== undefined ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead.' );\r\n\t\t\treturn this.addVectors( v, w );\r\n\r\n\t\t}\r\n\r\n\t\tthis.x += v.x;\r\n\t\tthis.y += v.y;\r\n\t\tthis.z += v.z;\r\n\t\tthis.w += v.w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddScalar: function ( s ) {\r\n\r\n\t\tthis.x += s;\r\n\t\tthis.y += s;\r\n\t\tthis.z += s;\r\n\t\tthis.w += s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddVectors: function ( a, b ) {\r\n\r\n\t\tthis.x = a.x + b.x;\r\n\t\tthis.y = a.y + b.y;\r\n\t\tthis.z = a.z + b.z;\r\n\t\tthis.w = a.w + b.w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddScaledVector: function ( v, s ) {\r\n\r\n\t\tthis.x += v.x * s;\r\n\t\tthis.y += v.y * s;\r\n\t\tthis.z += v.z * s;\r\n\t\tthis.w += v.w * s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsub: function ( v, w ) {\r\n\r\n\t\tif ( w !== undefined ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.' );\r\n\t\t\treturn this.subVectors( v, w );\r\n\r\n\t\t}\r\n\r\n\t\tthis.x -= v.x;\r\n\t\tthis.y -= v.y;\r\n\t\tthis.z -= v.z;\r\n\t\tthis.w -= v.w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsubScalar: function ( s ) {\r\n\r\n\t\tthis.x -= s;\r\n\t\tthis.y -= s;\r\n\t\tthis.z -= s;\r\n\t\tthis.w -= s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsubVectors: function ( a, b ) {\r\n\r\n\t\tthis.x = a.x - b.x;\r\n\t\tthis.y = a.y - b.y;\r\n\t\tthis.z = a.z - b.z;\r\n\t\tthis.w = a.w - b.w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiplyScalar: function ( scalar ) {\r\n\r\n\t\tif ( isFinite( scalar ) ) {\r\n\t\t\tthis.x *= scalar;\r\n\t\t\tthis.y *= scalar;\r\n\t\t\tthis.z *= scalar;\r\n\t\t\tthis.w *= scalar;\r\n\t\t} else {\r\n\t\t\tthis.x = 0;\r\n\t\t\tthis.y = 0;\r\n\t\t\tthis.z = 0;\r\n\t\t\tthis.w = 0;\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tapplyMatrix4: function ( m ) {\r\n\r\n\t\tvar x = this.x;\r\n\t\tvar y = this.y;\r\n\t\tvar z = this.z;\r\n\t\tvar w = this.w;\r\n\r\n\t\tvar e = m.elements;\r\n\r\n\t\tthis.x = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ] * z + e[ 12 ] * w;\r\n\t\tthis.y = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ] * z + e[ 13 ] * w;\r\n\t\tthis.z = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z + e[ 14 ] * w;\r\n\t\tthis.w = e[ 3 ] * x + e[ 7 ] * y + e[ 11 ] * z + e[ 15 ] * w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdivideScalar: function ( scalar ) {\r\n\r\n\t\treturn this.multiplyScalar( 1 / scalar );\r\n\r\n\t},\r\n\r\n\tsetAxisAngleFromQuaternion: function ( q ) {\r\n\r\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/quaternionToAngle/index.htm\r\n\r\n\t\t// q is assumed to be normalized\r\n\r\n\t\tthis.w = 2 * Math.acos( q.w );\r\n\r\n\t\tvar s = Math.sqrt( 1 - q.w * q.w );\r\n\r\n\t\tif ( s < 0.0001 ) {\r\n\r\n\t\t\t this.x = 1;\r\n\t\t\t this.y = 0;\r\n\t\t\t this.z = 0;\r\n\r\n\t\t} else {\r\n\r\n\t\t\t this.x = q.x / s;\r\n\t\t\t this.y = q.y / s;\r\n\t\t\t this.z = q.z / s;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetAxisAngleFromRotationMatrix: function ( m ) {\r\n\r\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToAngle/index.htm\r\n\r\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\r\n\t\tvar angle, x, y, z,\t\t// variables for result\r\n\t\t\tepsilon = 0.01,\t\t// margin to allow for rounding errors\r\n\t\t\tepsilon2 = 0.1,\t\t// margin to distinguish between 0 and 180 degrees\r\n\r\n\t\t\tte = m.elements,\r\n\r\n\t\t\tm11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ],\r\n\t\t\tm21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ],\r\n\t\t\tm31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ];\r\n\r\n\t\tif ( ( Math.abs( m12 - m21 ) < epsilon )\r\n\t\t   && ( Math.abs( m13 - m31 ) < epsilon )\r\n\t\t   && ( Math.abs( m23 - m32 ) < epsilon ) ) {\r\n\r\n\t\t\t// singularity found\r\n\t\t\t// first check for identity matrix which must have +1 for all terms\r\n\t\t\t// in leading diagonal and zero in other terms\r\n\r\n\t\t\tif ( ( Math.abs( m12 + m21 ) < epsilon2 )\r\n\t\t\t   && ( Math.abs( m13 + m31 ) < epsilon2 )\r\n\t\t\t   && ( Math.abs( m23 + m32 ) < epsilon2 )\r\n\t\t\t   && ( Math.abs( m11 + m22 + m33 - 3 ) < epsilon2 ) ) {\r\n\r\n\t\t\t\t// this singularity is identity matrix so angle = 0\r\n\r\n\t\t\t\tthis.set( 1, 0, 0, 0 );\r\n\r\n\t\t\t\treturn this; // zero angle, arbitrary axis\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// otherwise this singularity is angle = 180\r\n\r\n\t\t\tangle = Math.PI;\r\n\r\n\t\t\tvar xx = ( m11 + 1 ) / 2;\r\n\t\t\tvar yy = ( m22 + 1 ) / 2;\r\n\t\t\tvar zz = ( m33 + 1 ) / 2;\r\n\t\t\tvar xy = ( m12 + m21 ) / 4;\r\n\t\t\tvar xz = ( m13 + m31 ) / 4;\r\n\t\t\tvar yz = ( m23 + m32 ) / 4;\r\n\r\n\t\t\tif ( ( xx > yy ) && ( xx > zz ) ) {\r\n\r\n\t\t\t\t// m11 is the largest diagonal term\r\n\r\n\t\t\t\tif ( xx < epsilon ) {\r\n\r\n\t\t\t\t\tx = 0;\r\n\t\t\t\t\ty = 0.707106781;\r\n\t\t\t\t\tz = 0.707106781;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tx = Math.sqrt( xx );\r\n\t\t\t\t\ty = xy / x;\r\n\t\t\t\t\tz = xz / x;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( yy > zz ) {\r\n\r\n\t\t\t\t// m22 is the largest diagonal term\r\n\r\n\t\t\t\tif ( yy < epsilon ) {\r\n\r\n\t\t\t\t\tx = 0.707106781;\r\n\t\t\t\t\ty = 0;\r\n\t\t\t\t\tz = 0.707106781;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\ty = Math.sqrt( yy );\r\n\t\t\t\t\tx = xy / y;\r\n\t\t\t\t\tz = yz / y;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// m33 is the largest diagonal term so base result on this\r\n\r\n\t\t\t\tif ( zz < epsilon ) {\r\n\r\n\t\t\t\t\tx = 0.707106781;\r\n\t\t\t\t\ty = 0.707106781;\r\n\t\t\t\t\tz = 0;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tz = Math.sqrt( zz );\r\n\t\t\t\t\tx = xz / z;\r\n\t\t\t\t\ty = yz / z;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.set( x, y, z, angle );\r\n\r\n\t\t\treturn this; // return 180 deg rotation\r\n\r\n\t\t}\r\n\r\n\t\t// as we have reached here there are no singularities so we can handle normally\r\n\r\n\t\tvar s = Math.sqrt( ( m32 - m23 ) * ( m32 - m23 )\r\n\t\t\t\t\t\t  + ( m13 - m31 ) * ( m13 - m31 )\r\n\t\t\t\t\t\t  + ( m21 - m12 ) * ( m21 - m12 ) ); // used to normalize\r\n\r\n\t\tif ( Math.abs( s ) < 0.001 ) s = 1;\r\n\r\n\t\t// prevent divide by zero, should not happen if matrix is orthogonal and should be\r\n\t\t// caught by singularity test above, but I've left it in just in case\r\n\r\n\t\tthis.x = ( m32 - m23 ) / s;\r\n\t\tthis.y = ( m13 - m31 ) / s;\r\n\t\tthis.z = ( m21 - m12 ) / s;\r\n\t\tthis.w = Math.acos( ( m11 + m22 + m33 - 1 ) / 2 );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmin: function ( v ) {\r\n\r\n\t\tthis.x = Math.min( this.x, v.x );\r\n\t\tthis.y = Math.min( this.y, v.y );\r\n\t\tthis.z = Math.min( this.z, v.z );\r\n\t\tthis.w = Math.min( this.w, v.w );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmax: function ( v ) {\r\n\r\n\t\tthis.x = Math.max( this.x, v.x );\r\n\t\tthis.y = Math.max( this.y, v.y );\r\n\t\tthis.z = Math.max( this.z, v.z );\r\n\t\tthis.w = Math.max( this.w, v.w );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclamp: function ( min, max ) {\r\n\r\n\t\t// This function assumes min < max, if this assumption isn't true it will not operate correctly\r\n\r\n\t\tthis.x = Math.max( min.x, Math.min( max.x, this.x ) );\r\n\t\tthis.y = Math.max( min.y, Math.min( max.y, this.y ) );\r\n\t\tthis.z = Math.max( min.z, Math.min( max.z, this.z ) );\r\n\t\tthis.w = Math.max( min.w, Math.min( max.w, this.w ) );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclampScalar: function () {\r\n\r\n\t\tvar min, max;\r\n\r\n\t\treturn function clampScalar( minVal, maxVal ) {\r\n\r\n\t\t\tif ( min === undefined ) {\r\n\r\n\t\t\t\tmin = new THREE.Vector4();\r\n\t\t\t\tmax = new THREE.Vector4();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tmin.set( minVal, minVal, minVal, minVal );\r\n\t\t\tmax.set( maxVal, maxVal, maxVal, maxVal );\r\n\r\n\t\t\treturn this.clamp( min, max );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tfloor: function () {\r\n\r\n\t\tthis.x = Math.floor( this.x );\r\n\t\tthis.y = Math.floor( this.y );\r\n\t\tthis.z = Math.floor( this.z );\r\n\t\tthis.w = Math.floor( this.w );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tceil: function () {\r\n\r\n\t\tthis.x = Math.ceil( this.x );\r\n\t\tthis.y = Math.ceil( this.y );\r\n\t\tthis.z = Math.ceil( this.z );\r\n\t\tthis.w = Math.ceil( this.w );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tround: function () {\r\n\r\n\t\tthis.x = Math.round( this.x );\r\n\t\tthis.y = Math.round( this.y );\r\n\t\tthis.z = Math.round( this.z );\r\n\t\tthis.w = Math.round( this.w );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\troundToZero: function () {\r\n\r\n\t\tthis.x = ( this.x < 0 ) ? Math.ceil( this.x ) : Math.floor( this.x );\r\n\t\tthis.y = ( this.y < 0 ) ? Math.ceil( this.y ) : Math.floor( this.y );\r\n\t\tthis.z = ( this.z < 0 ) ? Math.ceil( this.z ) : Math.floor( this.z );\r\n\t\tthis.w = ( this.w < 0 ) ? Math.ceil( this.w ) : Math.floor( this.w );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tnegate: function () {\r\n\r\n\t\tthis.x = - this.x;\r\n\t\tthis.y = - this.y;\r\n\t\tthis.z = - this.z;\r\n\t\tthis.w = - this.w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdot: function ( v ) {\r\n\r\n\t\treturn this.x * v.x + this.y * v.y + this.z * v.z + this.w * v.w;\r\n\r\n\t},\r\n\r\n\tlengthSq: function () {\r\n\r\n\t\treturn this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w;\r\n\r\n\t},\r\n\r\n\tlength: function () {\r\n\r\n\t\treturn Math.sqrt( this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w );\r\n\r\n\t},\r\n\r\n\tlengthManhattan: function () {\r\n\r\n\t\treturn Math.abs( this.x ) + Math.abs( this.y ) + Math.abs( this.z ) + Math.abs( this.w );\r\n\r\n\t},\r\n\r\n\tnormalize: function () {\r\n\r\n\t\treturn this.divideScalar( this.length() );\r\n\r\n\t},\r\n\r\n\tsetLength: function ( length ) {\r\n\r\n\t\treturn this.multiplyScalar( length / this.length() );\r\n\r\n\t},\r\n\r\n\tlerp: function ( v, alpha ) {\r\n\r\n\t\tthis.x += ( v.x - this.x ) * alpha;\r\n\t\tthis.y += ( v.y - this.y ) * alpha;\r\n\t\tthis.z += ( v.z - this.z ) * alpha;\r\n\t\tthis.w += ( v.w - this.w ) * alpha;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tlerpVectors: function ( v1, v2, alpha ) {\r\n\r\n\t\tthis.subVectors( v2, v1 ).multiplyScalar( alpha ).add( v1 );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( v ) {\r\n\r\n\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) && ( v.z === this.z ) && ( v.w === this.w ) );\r\n\r\n\t},\r\n\r\n\tfromArray: function ( array, offset ) {\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tthis.x = array[ offset ];\r\n\t\tthis.y = array[ offset + 1 ];\r\n\t\tthis.z = array[ offset + 2 ];\r\n\t\tthis.w = array[ offset + 3 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttoArray: function ( array, offset ) {\r\n\r\n\t\tif ( array === undefined ) array = [];\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tarray[ offset ] = this.x;\r\n\t\tarray[ offset + 1 ] = this.y;\r\n\t\tarray[ offset + 2 ] = this.z;\r\n\t\tarray[ offset + 3 ] = this.w;\r\n\r\n\t\treturn array;\r\n\r\n\t},\r\n\r\n\tfromAttribute: function ( attribute, index, offset ) {\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tindex = index * attribute.itemSize + offset;\r\n\r\n\t\tthis.x = attribute.array[ index ];\r\n\t\tthis.y = attribute.array[ index + 1 ];\r\n\t\tthis.z = attribute.array[ index + 2 ];\r\n\t\tthis.w = attribute.array[ index + 3 ];\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Euler.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n * @author bhouston / http://clara.io\r\n */\r\n\r\nTHREE.Euler = function ( x, y, z, order ) {\r\n\r\n\tthis._x = x || 0;\r\n\tthis._y = y || 0;\r\n\tthis._z = z || 0;\r\n\tthis._order = order || THREE.Euler.DefaultOrder;\r\n\r\n};\r\n\r\nTHREE.Euler.RotationOrders = [ 'XYZ', 'YZX', 'ZXY', 'XZY', 'YXZ', 'ZYX' ];\r\n\r\nTHREE.Euler.DefaultOrder = 'XYZ';\r\n\r\nTHREE.Euler.prototype = {\r\n\r\n\tconstructor: THREE.Euler,\r\n\r\n\tget x () {\r\n\r\n\t\treturn this._x;\r\n\r\n\t},\r\n\r\n\tset x ( value ) {\r\n\r\n\t\tthis._x = value;\r\n\t\tthis.onChangeCallback();\r\n\r\n\t},\r\n\r\n\tget y () {\r\n\r\n\t\treturn this._y;\r\n\r\n\t},\r\n\r\n\tset y ( value ) {\r\n\r\n\t\tthis._y = value;\r\n\t\tthis.onChangeCallback();\r\n\r\n\t},\r\n\r\n\tget z () {\r\n\r\n\t\treturn this._z;\r\n\r\n\t},\r\n\r\n\tset z ( value ) {\r\n\r\n\t\tthis._z = value;\r\n\t\tthis.onChangeCallback();\r\n\r\n\t},\r\n\r\n\tget order () {\r\n\r\n\t\treturn this._order;\r\n\r\n\t},\r\n\r\n\tset order ( value ) {\r\n\r\n\t\tthis._order = value;\r\n\t\tthis.onChangeCallback();\r\n\r\n\t},\r\n\r\n\tset: function ( x, y, z, order ) {\r\n\r\n\t\tthis._x = x;\r\n\t\tthis._y = y;\r\n\t\tthis._z = z;\r\n\t\tthis._order = order || this._order;\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor( this._x, this._y, this._z, this._order);\r\n\r\n\t},\r\n\r\n\tcopy: function ( euler ) {\r\n\r\n\t\tthis._x = euler._x;\r\n\t\tthis._y = euler._y;\r\n\t\tthis._z = euler._z;\r\n\t\tthis._order = euler._order;\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromRotationMatrix: function ( m, order, update ) {\r\n\r\n\t\tvar clamp = THREE.Math.clamp;\r\n\r\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\r\n\t\tvar te = m.elements;\r\n\t\tvar m11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ];\r\n\t\tvar m21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ];\r\n\t\tvar m31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ];\r\n\r\n\t\torder = order || this._order;\r\n\r\n\t\tif ( order === 'XYZ' ) {\r\n\r\n\t\t\tthis._y = Math.asin( clamp( m13, - 1, 1 ) );\r\n\r\n\t\t\tif ( Math.abs( m13 ) < 0.99999 ) {\r\n\r\n\t\t\t\tthis._x = Math.atan2( - m23, m33 );\r\n\t\t\t\tthis._z = Math.atan2( - m12, m11 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis._x = Math.atan2( m32, m22 );\r\n\t\t\t\tthis._z = 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( order === 'YXZ' ) {\r\n\r\n\t\t\tthis._x = Math.asin( - clamp( m23, - 1, 1 ) );\r\n\r\n\t\t\tif ( Math.abs( m23 ) < 0.99999 ) {\r\n\r\n\t\t\t\tthis._y = Math.atan2( m13, m33 );\r\n\t\t\t\tthis._z = Math.atan2( m21, m22 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis._y = Math.atan2( - m31, m11 );\r\n\t\t\t\tthis._z = 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( order === 'ZXY' ) {\r\n\r\n\t\t\tthis._x = Math.asin( clamp( m32, - 1, 1 ) );\r\n\r\n\t\t\tif ( Math.abs( m32 ) < 0.99999 ) {\r\n\r\n\t\t\t\tthis._y = Math.atan2( - m31, m33 );\r\n\t\t\t\tthis._z = Math.atan2( - m12, m22 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis._y = 0;\r\n\t\t\t\tthis._z = Math.atan2( m21, m11 );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( order === 'ZYX' ) {\r\n\r\n\t\t\tthis._y = Math.asin( - clamp( m31, - 1, 1 ) );\r\n\r\n\t\t\tif ( Math.abs( m31 ) < 0.99999 ) {\r\n\r\n\t\t\t\tthis._x = Math.atan2( m32, m33 );\r\n\t\t\t\tthis._z = Math.atan2( m21, m11 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis._x = 0;\r\n\t\t\t\tthis._z = Math.atan2( - m12, m22 );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( order === 'YZX' ) {\r\n\r\n\t\t\tthis._z = Math.asin( clamp( m21, - 1, 1 ) );\r\n\r\n\t\t\tif ( Math.abs( m21 ) < 0.99999 ) {\r\n\r\n\t\t\t\tthis._x = Math.atan2( - m23, m22 );\r\n\t\t\t\tthis._y = Math.atan2( - m31, m11 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis._x = 0;\r\n\t\t\t\tthis._y = Math.atan2( m13, m33 );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( order === 'XZY' ) {\r\n\r\n\t\t\tthis._z = Math.asin( - clamp( m12, - 1, 1 ) );\r\n\r\n\t\t\tif ( Math.abs( m12 ) < 0.99999 ) {\r\n\r\n\t\t\t\tthis._x = Math.atan2( m32, m22 );\r\n\t\t\t\tthis._y = Math.atan2( m13, m11 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis._x = Math.atan2( - m23, m33 );\r\n\t\t\t\tthis._y = 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tconsole.warn( 'THREE.Euler: .setFromRotationMatrix() given unsupported order: ' + order )\r\n\r\n\t\t}\r\n\r\n\t\tthis._order = order;\r\n\r\n\t\tif ( update !== false ) this.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromQuaternion: function () {\r\n\r\n\t\tvar matrix;\r\n\r\n\t\treturn function ( q, order, update ) {\r\n\r\n\t\t\tif ( matrix === undefined ) matrix = new THREE.Matrix4();\r\n\t\t\tmatrix.makeRotationFromQuaternion( q );\r\n\t\t\tthis.setFromRotationMatrix( matrix, order, update );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tsetFromVector3: function ( v, order ) {\r\n\r\n\t\treturn this.set( v.x, v.y, v.z, order || this._order );\r\n\r\n\t},\r\n\r\n\treorder: function () {\r\n\r\n\t\t// WARNING: this discards revolution information -bhouston\r\n\r\n\t\tvar q = new THREE.Quaternion();\r\n\r\n\t\treturn function ( newOrder ) {\r\n\r\n\t\t\tq.setFromEuler( this );\r\n\t\t\tthis.setFromQuaternion( q, newOrder );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tequals: function ( euler ) {\r\n\r\n\t\treturn ( euler._x === this._x ) && ( euler._y === this._y ) && ( euler._z === this._z ) && ( euler._order === this._order );\r\n\r\n\t},\r\n\r\n\tfromArray: function ( array ) {\r\n\r\n\t\tthis._x = array[ 0 ];\r\n\t\tthis._y = array[ 1 ];\r\n\t\tthis._z = array[ 2 ];\r\n\t\tif ( array[ 3 ] !== undefined ) this._order = array[ 3 ];\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttoArray: function ( array, offset ) {\r\n\r\n\t\tif ( array === undefined ) array = [];\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tarray[ offset ] = this._x;\r\n\t\tarray[ offset + 1 ] = this._y;\r\n\t\tarray[ offset + 2 ] = this._z;\r\n\t\tarray[ offset + 3 ] = this._order;\r\n\r\n\t\treturn array;\r\n\r\n\t},\r\n\r\n\ttoVector3: function ( optionalResult ) {\r\n\r\n\t\tif ( optionalResult ) {\r\n\r\n\t\t\treturn optionalResult.set( this._x, this._y, this._z );\r\n\r\n\t\t} else {\r\n\r\n\t\t\treturn new THREE.Vector3( this._x, this._y, this._z );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tonChange: function ( callback ) {\r\n\r\n\t\tthis.onChangeCallback = callback;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tonChangeCallback: function () {}\r\n\r\n};\r\n\r\n// File:src/math/Line3.js\r\n\r\n/**\r\n * @author bhouston / http://clara.io\r\n */\r\n\r\nTHREE.Line3 = function ( start, end ) {\r\n\r\n\tthis.start = ( start !== undefined ) ? start : new THREE.Vector3();\r\n\tthis.end = ( end !== undefined ) ? end : new THREE.Vector3();\r\n\r\n};\r\n\r\nTHREE.Line3.prototype = {\r\n\r\n\tconstructor: THREE.Line3,\r\n\r\n\tset: function ( start, end ) {\r\n\r\n\t\tthis.start.copy( start );\r\n\t\tthis.end.copy( end );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( line ) {\r\n\r\n\t\tthis.start.copy( line.start );\r\n\t\tthis.end.copy( line.end );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcenter: function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\treturn result.addVectors( this.start, this.end ).multiplyScalar( 0.5 );\r\n\r\n\t},\r\n\r\n\tdelta: function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\treturn result.subVectors( this.end, this.start );\r\n\r\n\t},\r\n\r\n\tdistanceSq: function () {\r\n\r\n\t\treturn this.start.distanceToSquared( this.end );\r\n\r\n\t},\r\n\r\n\tdistance: function () {\r\n\r\n\t\treturn this.start.distanceTo( this.end );\r\n\r\n\t},\r\n\r\n\tat: function ( t, optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\treturn this.delta( result ).multiplyScalar( t ).add( this.start );\r\n\r\n\t},\r\n\r\n\tclosestPointToPointParameter: function () {\r\n\r\n\t\tvar startP = new THREE.Vector3();\r\n\t\tvar startEnd = new THREE.Vector3();\r\n\r\n\t\treturn function ( point, clampToLine ) {\r\n\r\n\t\t\tstartP.subVectors( point, this.start );\r\n\t\t\tstartEnd.subVectors( this.end, this.start );\r\n\r\n\t\t\tvar startEnd2 = startEnd.dot( startEnd );\r\n\t\t\tvar startEnd_startP = startEnd.dot( startP );\r\n\r\n\t\t\tvar t = startEnd_startP / startEnd2;\r\n\r\n\t\t\tif ( clampToLine ) {\r\n\r\n\t\t\t\tt = THREE.Math.clamp( t, 0, 1 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn t;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tclosestPointToPoint: function ( point, clampToLine, optionalTarget ) {\r\n\r\n\t\tvar t = this.closestPointToPointParameter( point, clampToLine );\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\treturn this.delta( result ).multiplyScalar( t ).add( this.start );\r\n\r\n\t},\r\n\r\n\tapplyMatrix4: function ( matrix ) {\r\n\r\n\t\tthis.start.applyMatrix4( matrix );\r\n\t\tthis.end.applyMatrix4( matrix );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( line ) {\r\n\r\n\t\treturn line.start.equals( this.start ) && line.end.equals( this.end );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Box2.js\r\n\r\n/**\r\n * @author bhouston / http://clara.io\r\n */\r\n\r\nTHREE.Box2 = function ( min, max ) {\r\n\r\n\tthis.min = ( min !== undefined ) ? min : new THREE.Vector2( Infinity, Infinity );\r\n\tthis.max = ( max !== undefined ) ? max : new THREE.Vector2( - Infinity, - Infinity );\r\n\r\n};\r\n\r\nTHREE.Box2.prototype = {\r\n\r\n\tconstructor: THREE.Box2,\r\n\r\n\tset: function ( min, max ) {\r\n\r\n\t\tthis.min.copy( min );\r\n\t\tthis.max.copy( max );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromPoints: function ( points ) {\r\n\r\n\t\tthis.makeEmpty();\r\n\r\n\t\tfor ( var i = 0, il = points.length; i < il; i ++ ) {\r\n\r\n\t\t\tthis.expandByPoint( points[ i ] )\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromCenterAndSize: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector2();\r\n\r\n\t\treturn function ( center, size ) {\r\n\r\n\t\t\tvar halfSize = v1.copy( size ).multiplyScalar( 0.5 );\r\n\t\t\tthis.min.copy( center ).sub( halfSize );\r\n\t\t\tthis.max.copy( center ).add( halfSize );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\t\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( box ) {\r\n\r\n\t\tthis.min.copy( box.min );\r\n\t\tthis.max.copy( box.max );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmakeEmpty: function () {\r\n\r\n\t\tthis.min.x = this.min.y = Infinity;\r\n\t\tthis.max.x = this.max.y = - Infinity;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tempty: function () {\r\n\r\n\t\t// this is a more robust check for empty than ( volume <= 0 ) because volume can get positive with two negative axes\r\n\r\n\t\treturn ( this.max.x < this.min.x ) || ( this.max.y < this.min.y );\r\n\r\n\t},\r\n\r\n\tcenter: function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector2();\r\n\t\treturn result.addVectors( this.min, this.max ).multiplyScalar( 0.5 );\r\n\r\n\t},\r\n\r\n\tsize: function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector2();\r\n\t\treturn result.subVectors( this.max, this.min );\r\n\r\n\t},\r\n\r\n\texpandByPoint: function ( point ) {\r\n\r\n\t\tthis.min.min( point );\r\n\t\tthis.max.max( point );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\texpandByVector: function ( vector ) {\r\n\r\n\t\tthis.min.sub( vector );\r\n\t\tthis.max.add( vector );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\texpandByScalar: function ( scalar ) {\r\n\r\n\t\tthis.min.addScalar( - scalar );\r\n\t\tthis.max.addScalar( scalar );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcontainsPoint: function ( point ) {\r\n\r\n\t\tif ( point.x < this.min.x || point.x > this.max.x ||\r\n\t\t     point.y < this.min.y || point.y > this.max.y ) {\r\n\r\n\t\t\treturn false;\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t},\r\n\r\n\tcontainsBox: function ( box ) {\r\n\r\n\t\tif ( ( this.min.x <= box.min.x ) && ( box.max.x <= this.max.x ) &&\r\n\t\t     ( this.min.y <= box.min.y ) && ( box.max.y <= this.max.y ) ) {\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\r\n\t},\r\n\r\n\tgetParameter: function ( point, optionalTarget ) {\r\n\r\n\t\t// This can potentially have a divide by zero if the box\r\n\t\t// has a size dimension of 0.\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector2();\r\n\r\n\t\treturn result.set(\r\n\t\t\t( point.x - this.min.x ) / ( this.max.x - this.min.x ),\r\n\t\t\t( point.y - this.min.y ) / ( this.max.y - this.min.y )\r\n\t\t);\r\n\r\n\t},\r\n\r\n\tisIntersectionBox: function ( box ) {\r\n\r\n\t\t// using 6 splitting planes to rule out intersections.\r\n\r\n\t\tif ( box.max.x < this.min.x || box.min.x > this.max.x ||\r\n\t\t     box.max.y < this.min.y || box.min.y > this.max.y ) {\r\n\r\n\t\t\treturn false;\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t},\r\n\r\n\tclampPoint: function ( point, optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector2();\r\n\t\treturn result.copy( point ).clamp( this.min, this.max );\r\n\r\n\t},\r\n\r\n\tdistanceToPoint: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector2();\r\n\r\n\t\treturn function ( point ) {\r\n\r\n\t\t\tvar clampedPoint = v1.copy( point ).clamp( this.min, this.max );\r\n\t\t\treturn clampedPoint.sub( point ).length();\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tintersect: function ( box ) {\r\n\r\n\t\tthis.min.max( box.min );\r\n\t\tthis.max.min( box.max );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tunion: function ( box ) {\r\n\r\n\t\tthis.min.min( box.min );\r\n\t\tthis.max.max( box.max );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttranslate: function ( offset ) {\r\n\r\n\t\tthis.min.add( offset );\r\n\t\tthis.max.add( offset );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( box ) {\r\n\r\n\t\treturn box.min.equals( this.min ) && box.max.equals( this.max );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Box3.js\r\n\r\n/**\r\n * @author bhouston / http://clara.io\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.Box3 = function ( min, max ) {\r\n\r\n\tthis.min = ( min !== undefined ) ? min : new THREE.Vector3( Infinity, Infinity, Infinity );\r\n\tthis.max = ( max !== undefined ) ? max : new THREE.Vector3( - Infinity, - Infinity, - Infinity );\r\n\r\n};\r\n\r\nTHREE.Box3.prototype = {\r\n\r\n\tconstructor: THREE.Box3,\r\n\r\n\tset: function ( min, max ) {\r\n\r\n\t\tthis.min.copy( min );\r\n\t\tthis.max.copy( max );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromPoints: function ( points ) {\r\n\r\n\t\tthis.makeEmpty();\r\n\r\n\t\tfor ( var i = 0, il = points.length; i < il; i ++ ) {\r\n\r\n\t\t\tthis.expandByPoint( points[ i ] );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromCenterAndSize: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function ( center, size ) {\r\n\r\n\t\t\tvar halfSize = v1.copy( size ).multiplyScalar( 0.5 );\r\n\r\n\t\t\tthis.min.copy( center ).sub( halfSize );\r\n\t\t\tthis.max.copy( center ).add( halfSize );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tsetFromObject: function () {\r\n\r\n\t\t// Computes the world-axis-aligned bounding box of an object (including its children),\r\n\t\t// accounting for both the object's, and children's, world transforms\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function ( object ) {\r\n\r\n\t\t\tvar scope = this;\r\n\r\n\t\t\tobject.updateMatrixWorld( true );\r\n\r\n\t\t\tthis.makeEmpty();\r\n\r\n\t\t\tobject.traverse( function ( node ) {\r\n\r\n\t\t\t\tvar geometry = node.geometry;\r\n\r\n\t\t\t\tif ( geometry !== undefined ) {\r\n\r\n\t\t\t\t\tif ( geometry instanceof THREE.Geometry ) {\r\n\r\n\t\t\t\t\t\tvar vertices = geometry.vertices;\r\n\r\n\t\t\t\t\t\tfor ( var i = 0, il = vertices.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tv1.copy( vertices[ i ] );\r\n\r\n\t\t\t\t\t\t\tv1.applyMatrix4( node.matrixWorld );\r\n\r\n\t\t\t\t\t\t\tscope.expandByPoint( v1 );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else if ( geometry instanceof THREE.BufferGeometry && geometry.attributes[ 'position' ] !== undefined ) {\r\n\r\n\t\t\t\t\t\tvar positions = geometry.attributes[ 'position' ].array;\r\n\r\n\t\t\t\t\t\tfor ( var i = 0, il = positions.length; i < il; i += 3 ) {\r\n\r\n\t\t\t\t\t\t\tv1.set( positions[ i ], positions[ i + 1 ], positions[ i + 2 ] );\r\n\r\n\t\t\t\t\t\t\tv1.applyMatrix4( node.matrixWorld );\r\n\r\n\t\t\t\t\t\t\tscope.expandByPoint( v1 );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( box ) {\r\n\r\n\t\tthis.min.copy( box.min );\r\n\t\tthis.max.copy( box.max );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmakeEmpty: function () {\r\n\r\n\t\tthis.min.x = this.min.y = this.min.z = Infinity;\r\n\t\tthis.max.x = this.max.y = this.max.z = - Infinity;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tempty: function () {\r\n\r\n\t\t// this is a more robust check for empty than ( volume <= 0 ) because volume can get positive with two negative axes\r\n\r\n\t\treturn ( this.max.x < this.min.x ) || ( this.max.y < this.min.y ) || ( this.max.z < this.min.z );\r\n\r\n\t},\r\n\r\n\tcenter: function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\treturn result.addVectors( this.min, this.max ).multiplyScalar( 0.5 );\r\n\r\n\t},\r\n\r\n\tsize: function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\treturn result.subVectors( this.max, this.min );\r\n\r\n\t},\r\n\r\n\texpandByPoint: function ( point ) {\r\n\r\n\t\tthis.min.min( point );\r\n\t\tthis.max.max( point );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\texpandByVector: function ( vector ) {\r\n\r\n\t\tthis.min.sub( vector );\r\n\t\tthis.max.add( vector );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\texpandByScalar: function ( scalar ) {\r\n\r\n\t\tthis.min.addScalar( - scalar );\r\n\t\tthis.max.addScalar( scalar );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcontainsPoint: function ( point ) {\r\n\r\n\t\tif ( point.x < this.min.x || point.x > this.max.x ||\r\n\t\t     point.y < this.min.y || point.y > this.max.y ||\r\n\t\t     point.z < this.min.z || point.z > this.max.z ) {\r\n\r\n\t\t\treturn false;\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t},\r\n\r\n\tcontainsBox: function ( box ) {\r\n\r\n\t\tif ( ( this.min.x <= box.min.x ) && ( box.max.x <= this.max.x ) &&\r\n\t\t\t ( this.min.y <= box.min.y ) && ( box.max.y <= this.max.y ) &&\r\n\t\t\t ( this.min.z <= box.min.z ) && ( box.max.z <= this.max.z ) ) {\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\r\n\t},\r\n\r\n\tgetParameter: function ( point, optionalTarget ) {\r\n\r\n\t\t// This can potentially have a divide by zero if the box\r\n\t\t// has a size dimension of 0.\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\treturn result.set(\r\n\t\t\t( point.x - this.min.x ) / ( this.max.x - this.min.x ),\r\n\t\t\t( point.y - this.min.y ) / ( this.max.y - this.min.y ),\r\n\t\t\t( point.z - this.min.z ) / ( this.max.z - this.min.z )\r\n\t\t);\r\n\r\n\t},\r\n\r\n\tisIntersectionBox: function ( box ) {\r\n\r\n\t\t// using 6 splitting planes to rule out intersections.\r\n\r\n\t\tif ( box.max.x < this.min.x || box.min.x > this.max.x ||\r\n\t\t     box.max.y < this.min.y || box.min.y > this.max.y ||\r\n\t\t     box.max.z < this.min.z || box.min.z > this.max.z ) {\r\n\r\n\t\t\treturn false;\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t},\r\n\r\n\tclampPoint: function ( point, optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\treturn result.copy( point ).clamp( this.min, this.max );\r\n\r\n\t},\r\n\r\n\tdistanceToPoint: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function ( point ) {\r\n\r\n\t\t\tvar clampedPoint = v1.copy( point ).clamp( this.min, this.max );\r\n\t\t\treturn clampedPoint.sub( point ).length();\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tgetBoundingSphere: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function ( optionalTarget ) {\r\n\r\n\t\t\tvar result = optionalTarget || new THREE.Sphere();\r\n\r\n\t\t\tresult.center = this.center();\r\n\t\t\tresult.radius = this.size( v1 ).length() * 0.5;\r\n\r\n\t\t\treturn result;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tintersect: function ( box ) {\r\n\r\n\t\tthis.min.max( box.min );\r\n\t\tthis.max.min( box.max );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tunion: function ( box ) {\r\n\r\n\t\tthis.min.min( box.min );\r\n\t\tthis.max.max( box.max );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tapplyMatrix4: function () {\r\n\r\n\t\tvar points = [\r\n\t\t\tnew THREE.Vector3(),\r\n\t\t\tnew THREE.Vector3(),\r\n\t\t\tnew THREE.Vector3(),\r\n\t\t\tnew THREE.Vector3(),\r\n\t\t\tnew THREE.Vector3(),\r\n\t\t\tnew THREE.Vector3(),\r\n\t\t\tnew THREE.Vector3(),\r\n\t\t\tnew THREE.Vector3()\r\n\t\t];\r\n\r\n\t\treturn function ( matrix ) {\r\n\r\n\t\t\t// NOTE: I am using a binary pattern to specify all 2^3 combinations below\r\n\t\t\tpoints[ 0 ].set( this.min.x, this.min.y, this.min.z ).applyMatrix4( matrix ); // 000\r\n\t\t\tpoints[ 1 ].set( this.min.x, this.min.y, this.max.z ).applyMatrix4( matrix ); // 001\r\n\t\t\tpoints[ 2 ].set( this.min.x, this.max.y, this.min.z ).applyMatrix4( matrix ); // 010\r\n\t\t\tpoints[ 3 ].set( this.min.x, this.max.y, this.max.z ).applyMatrix4( matrix ); // 011\r\n\t\t\tpoints[ 4 ].set( this.max.x, this.min.y, this.min.z ).applyMatrix4( matrix ); // 100\r\n\t\t\tpoints[ 5 ].set( this.max.x, this.min.y, this.max.z ).applyMatrix4( matrix ); // 101\r\n\t\t\tpoints[ 6 ].set( this.max.x, this.max.y, this.min.z ).applyMatrix4( matrix ); // 110\r\n\t\t\tpoints[ 7 ].set( this.max.x, this.max.y, this.max.z ).applyMatrix4( matrix );  // 111\r\n\r\n\t\t\tthis.makeEmpty();\r\n\t\t\tthis.setFromPoints( points );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\ttranslate: function ( offset ) {\r\n\r\n\t\tthis.min.add( offset );\r\n\t\tthis.max.add( offset );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( box ) {\r\n\r\n\t\treturn box.min.equals( this.min ) && box.max.equals( this.max );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Matrix3.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n * @author bhouston / http://clara.io\r\n */\r\n\r\nTHREE.Matrix3 = function () {\r\n\r\n\tthis.elements = new Float32Array( [\r\n\r\n\t\t1, 0, 0,\r\n\t\t0, 1, 0,\r\n\t\t0, 0, 1\r\n\r\n\t] );\r\n\r\n\tif ( arguments.length > 0 ) {\r\n\r\n\t\tconsole.error( 'THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.' );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.Matrix3.prototype = {\r\n\r\n\tconstructor: THREE.Matrix3,\r\n\r\n\tset: function ( n11, n12, n13, n21, n22, n23, n31, n32, n33 ) {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tte[ 0 ] = n11; te[ 3 ] = n12; te[ 6 ] = n13;\r\n\t\tte[ 1 ] = n21; te[ 4 ] = n22; te[ 7 ] = n23;\r\n\t\tte[ 2 ] = n31; te[ 5 ] = n32; te[ 8 ] = n33;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tidentity: function () {\r\n\r\n\t\tthis.set(\r\n\r\n\t\t\t1, 0, 0,\r\n\t\t\t0, 1, 0,\r\n\t\t\t0, 0, 1\r\n\r\n\t\t);\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().fromArray( this.elements );\r\n\r\n\t},\r\n\r\n\tcopy: function ( m ) {\r\n\r\n\t\tvar me = m.elements;\r\n\r\n\t\tthis.set(\r\n\r\n\t\t\tme[ 0 ], me[ 3 ], me[ 6 ],\r\n\t\t\tme[ 1 ], me[ 4 ], me[ 7 ],\r\n\t\t\tme[ 2 ], me[ 5 ], me[ 8 ]\r\n\r\n\t\t);\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiplyVector3: function ( vector ) {\r\n\r\n\t\tconsole.warn( 'THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.' );\r\n\t\treturn vector.applyMatrix3( this );\r\n\r\n\t},\r\n\r\n\tmultiplyVector3Array: function ( a ) {\r\n\r\n\t\tconsole.warn( 'THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.' );\r\n\t\treturn this.applyToVector3Array( a );\r\n\r\n\t},\r\n\r\n\tapplyToVector3Array: function () {\r\n\r\n\t\tvar v1;\r\n\r\n\t\treturn function ( array, offset, length ) {\r\n\r\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\t\t\tif ( length === undefined ) length = array.length;\r\n\r\n\t\t\tfor ( var i = 0, j = offset; i < length; i += 3, j += 3 ) {\r\n\r\n\t\t\t\tv1.fromArray( array, j );\r\n\t\t\t\tv1.applyMatrix3( this );\r\n\t\t\t\tv1.toArray( array, j );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn array;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tapplyToBuffer: function () {\r\n\r\n\t\tvar v1;\r\n\r\n\t\treturn function applyToBuffer( buffer, offset, length ) {\r\n\r\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\t\t\tif ( length === undefined ) length = buffer.length / buffer.itemSize;\r\n\r\n\t\t\tfor ( var i = 0, j = offset; i < length; i ++, j ++ ) {\r\n\r\n\t\t\t\tv1.x = buffer.getX( j );\r\n\t\t\t\tv1.y = buffer.getY( j );\r\n\t\t\t\tv1.z = buffer.getZ( j );\r\n\r\n\t\t\t\tv1.applyMatrix3( this );\r\n\r\n\t\t\t\tbuffer.setXYZ( v1.x, v1.y, v1.z );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn buffer;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tmultiplyScalar: function ( s ) {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tte[ 0 ] *= s; te[ 3 ] *= s; te[ 6 ] *= s;\r\n\t\tte[ 1 ] *= s; te[ 4 ] *= s; te[ 7 ] *= s;\r\n\t\tte[ 2 ] *= s; te[ 5 ] *= s; te[ 8 ] *= s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdeterminant: function () {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tvar a = te[ 0 ], b = te[ 1 ], c = te[ 2 ],\r\n\t\t\td = te[ 3 ], e = te[ 4 ], f = te[ 5 ],\r\n\t\t\tg = te[ 6 ], h = te[ 7 ], i = te[ 8 ];\r\n\r\n\t\treturn a * e * i - a * f * h - b * d * i + b * f * g + c * d * h - c * e * g;\r\n\r\n\t},\r\n\r\n\tgetInverse: function ( matrix, throwOnInvertible ) {\r\n\r\n\t\t// input: THREE.Matrix4\r\n\t\t// ( based on http://code.google.com/p/webgl-mjs/ )\r\n\r\n\t\tvar me = matrix.elements;\r\n\t\tvar te = this.elements;\r\n\r\n\t\tte[ 0 ] =   me[ 10 ] * me[ 5 ] - me[ 6 ] * me[ 9 ];\r\n\t\tte[ 1 ] = - me[ 10 ] * me[ 1 ] + me[ 2 ] * me[ 9 ];\r\n\t\tte[ 2 ] =   me[ 6 ] * me[ 1 ] - me[ 2 ] * me[ 5 ];\r\n\t\tte[ 3 ] = - me[ 10 ] * me[ 4 ] + me[ 6 ] * me[ 8 ];\r\n\t\tte[ 4 ] =   me[ 10 ] * me[ 0 ] - me[ 2 ] * me[ 8 ];\r\n\t\tte[ 5 ] = - me[ 6 ] * me[ 0 ] + me[ 2 ] * me[ 4 ];\r\n\t\tte[ 6 ] =   me[ 9 ] * me[ 4 ] - me[ 5 ] * me[ 8 ];\r\n\t\tte[ 7 ] = - me[ 9 ] * me[ 0 ] + me[ 1 ] * me[ 8 ];\r\n\t\tte[ 8 ] =   me[ 5 ] * me[ 0 ] - me[ 1 ] * me[ 4 ];\r\n\r\n\t\tvar det = me[ 0 ] * te[ 0 ] + me[ 1 ] * te[ 3 ] + me[ 2 ] * te[ 6 ];\r\n\r\n\t\t// no inverse\r\n\r\n\t\tif ( det === 0 ) {\r\n\r\n\t\t\tvar msg = \"Matrix3.getInverse(): can't invert matrix, determinant is 0\";\r\n\r\n\t\t\tif ( throwOnInvertible || false ) {\r\n\r\n\t\t\t\tthrow new Error( msg );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tconsole.warn( msg );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.identity();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t\tthis.multiplyScalar( 1.0 / det );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttranspose: function () {\r\n\r\n\t\tvar tmp, m = this.elements;\r\n\r\n\t\ttmp = m[ 1 ]; m[ 1 ] = m[ 3 ]; m[ 3 ] = tmp;\r\n\t\ttmp = m[ 2 ]; m[ 2 ] = m[ 6 ]; m[ 6 ] = tmp;\r\n\t\ttmp = m[ 5 ]; m[ 5 ] = m[ 7 ]; m[ 7 ] = tmp;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tflattenToArrayOffset: function ( array, offset ) {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tarray[ offset ] = te[ 0 ];\r\n\t\tarray[ offset + 1 ] = te[ 1 ];\r\n\t\tarray[ offset + 2 ] = te[ 2 ];\r\n\r\n\t\tarray[ offset + 3 ] = te[ 3 ];\r\n\t\tarray[ offset + 4 ] = te[ 4 ];\r\n\t\tarray[ offset + 5 ] = te[ 5 ];\r\n\r\n\t\tarray[ offset + 6 ] = te[ 6 ];\r\n\t\tarray[ offset + 7 ] = te[ 7 ];\r\n\t\tarray[ offset + 8 ]  = te[ 8 ];\r\n\r\n\t\treturn array;\r\n\r\n\t},\r\n\r\n\tgetNormalMatrix: function ( m ) {\r\n\r\n\t\t// input: THREE.Matrix4\r\n\r\n\t\tthis.getInverse( m ).transpose();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttransposeIntoArray: function ( r ) {\r\n\r\n\t\tvar m = this.elements;\r\n\r\n\t\tr[ 0 ] = m[ 0 ];\r\n\t\tr[ 1 ] = m[ 3 ];\r\n\t\tr[ 2 ] = m[ 6 ];\r\n\t\tr[ 3 ] = m[ 1 ];\r\n\t\tr[ 4 ] = m[ 4 ];\r\n\t\tr[ 5 ] = m[ 7 ];\r\n\t\tr[ 6 ] = m[ 2 ];\r\n\t\tr[ 7 ] = m[ 5 ];\r\n\t\tr[ 8 ] = m[ 8 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tfromArray: function ( array ) {\r\n\r\n\t\tthis.elements.set( array );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttoArray: function () {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\treturn [\r\n\t\t\tte[ 0 ], te[ 1 ], te[ 2 ],\r\n\t\t\tte[ 3 ], te[ 4 ], te[ 5 ],\r\n\t\t\tte[ 6 ], te[ 7 ], te[ 8 ]\r\n\t\t];\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Matrix4.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author supereggbert / http://www.paulbrunt.co.uk/\r\n * @author philogb / http://blog.thejit.org/\r\n * @author jordi_ros / http://plattsoft.com\r\n * @author D1plo1d / http://github.com/D1plo1d\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author timknip / http://www.floorplanner.com/\r\n * @author bhouston / http://clara.io\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.Matrix4 = function () {\r\n\r\n\tthis.elements = new Float32Array( [\r\n\r\n\t\t1, 0, 0, 0,\r\n\t\t0, 1, 0, 0,\r\n\t\t0, 0, 1, 0,\r\n\t\t0, 0, 0, 1\r\n\r\n\t] );\r\n\r\n\tif ( arguments.length > 0 ) {\r\n\r\n\t\tconsole.error( 'THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.' );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.Matrix4.prototype = {\r\n\r\n\tconstructor: THREE.Matrix4,\r\n\r\n\tset: function ( n11, n12, n13, n14, n21, n22, n23, n24, n31, n32, n33, n34, n41, n42, n43, n44 ) {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tte[ 0 ] = n11; te[ 4 ] = n12; te[ 8 ] = n13; te[ 12 ] = n14;\r\n\t\tte[ 1 ] = n21; te[ 5 ] = n22; te[ 9 ] = n23; te[ 13 ] = n24;\r\n\t\tte[ 2 ] = n31; te[ 6 ] = n32; te[ 10 ] = n33; te[ 14 ] = n34;\r\n\t\tte[ 3 ] = n41; te[ 7 ] = n42; te[ 11 ] = n43; te[ 15 ] = n44;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tidentity: function () {\r\n\r\n\t\tthis.set(\r\n\r\n\t\t\t1, 0, 0, 0,\r\n\t\t\t0, 1, 0, 0,\r\n\t\t\t0, 0, 1, 0,\r\n\t\t\t0, 0, 0, 1\r\n\r\n\t\t);\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new THREE.Matrix4().fromArray( this.elements );\r\n\r\n\t},\r\n\r\n\tcopy: function ( m ) {\r\n\r\n\t\tthis.elements.set( m.elements );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\textractPosition: function ( m ) {\r\n\r\n\t\tconsole.warn( 'THREE.Matrix4: .extractPosition() has been renamed to .copyPosition().' );\r\n\t\treturn this.copyPosition( m );\r\n\r\n\t},\r\n\r\n\tcopyPosition: function ( m ) {\r\n\r\n\t\tvar te = this.elements;\r\n\t\tvar me = m.elements;\r\n\r\n\t\tte[ 12 ] = me[ 12 ];\r\n\t\tte[ 13 ] = me[ 13 ];\r\n\t\tte[ 14 ] = me[ 14 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\textractBasis: function ( xAxis, yAxis, zAxis ) {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\txAxis.set( te[ 0 ], te[ 1 ], te[ 2 ] );\r\n\t\tyAxis.set( te[ 4 ], te[ 5 ], te[ 6 ] );\r\n\t\tzAxis.set( te[ 8 ], te[ 9 ], te[ 10 ] );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmakeBasis: function ( xAxis, yAxis, zAxis ) {\r\n\r\n\t\tthis.set(\r\n\t\t\txAxis.x, yAxis.x, zAxis.x, 0,\r\n\t\t\txAxis.y, yAxis.y, zAxis.y, 0,\r\n\t\t\txAxis.z, yAxis.z, zAxis.z, 0,\r\n\t\t\t0,       0,       0,       1\r\n\t\t);\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\textractRotation: function () {\r\n\r\n\t\tvar v1;\r\n\r\n\t\treturn function ( m ) {\r\n\r\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\r\n\t\t\tvar te = this.elements;\r\n\t\t\tvar me = m.elements;\r\n\r\n\t\t\tvar scaleX = 1 / v1.set( me[ 0 ], me[ 1 ], me[ 2 ] ).length();\r\n\t\t\tvar scaleY = 1 / v1.set( me[ 4 ], me[ 5 ], me[ 6 ] ).length();\r\n\t\t\tvar scaleZ = 1 / v1.set( me[ 8 ], me[ 9 ], me[ 10 ] ).length();\r\n\r\n\t\t\tte[ 0 ] = me[ 0 ] * scaleX;\r\n\t\t\tte[ 1 ] = me[ 1 ] * scaleX;\r\n\t\t\tte[ 2 ] = me[ 2 ] * scaleX;\r\n\r\n\t\t\tte[ 4 ] = me[ 4 ] * scaleY;\r\n\t\t\tte[ 5 ] = me[ 5 ] * scaleY;\r\n\t\t\tte[ 6 ] = me[ 6 ] * scaleY;\r\n\r\n\t\t\tte[ 8 ] = me[ 8 ] * scaleZ;\r\n\t\t\tte[ 9 ] = me[ 9 ] * scaleZ;\r\n\t\t\tte[ 10 ] = me[ 10 ] * scaleZ;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tmakeRotationFromEuler: function ( euler ) {\r\n\r\n\t\tif ( euler instanceof THREE.Euler === false ) {\r\n\r\n\t\t\tconsole.error( 'THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.' );\r\n\r\n\t\t}\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tvar x = euler.x, y = euler.y, z = euler.z;\r\n\t\tvar a = Math.cos( x ), b = Math.sin( x );\r\n\t\tvar c = Math.cos( y ), d = Math.sin( y );\r\n\t\tvar e = Math.cos( z ), f = Math.sin( z );\r\n\r\n\t\tif ( euler.order === 'XYZ' ) {\r\n\r\n\t\t\tvar ae = a * e, af = a * f, be = b * e, bf = b * f;\r\n\r\n\t\t\tte[ 0 ] = c * e;\r\n\t\t\tte[ 4 ] = - c * f;\r\n\t\t\tte[ 8 ] = d;\r\n\r\n\t\t\tte[ 1 ] = af + be * d;\r\n\t\t\tte[ 5 ] = ae - bf * d;\r\n\t\t\tte[ 9 ] = - b * c;\r\n\r\n\t\t\tte[ 2 ] = bf - ae * d;\r\n\t\t\tte[ 6 ] = be + af * d;\r\n\t\t\tte[ 10 ] = a * c;\r\n\r\n\t\t} else if ( euler.order === 'YXZ' ) {\r\n\r\n\t\t\tvar ce = c * e, cf = c * f, de = d * e, df = d * f;\r\n\r\n\t\t\tte[ 0 ] = ce + df * b;\r\n\t\t\tte[ 4 ] = de * b - cf;\r\n\t\t\tte[ 8 ] = a * d;\r\n\r\n\t\t\tte[ 1 ] = a * f;\r\n\t\t\tte[ 5 ] = a * e;\r\n\t\t\tte[ 9 ] = - b;\r\n\r\n\t\t\tte[ 2 ] = cf * b - de;\r\n\t\t\tte[ 6 ] = df + ce * b;\r\n\t\t\tte[ 10 ] = a * c;\r\n\r\n\t\t} else if ( euler.order === 'ZXY' ) {\r\n\r\n\t\t\tvar ce = c * e, cf = c * f, de = d * e, df = d * f;\r\n\r\n\t\t\tte[ 0 ] = ce - df * b;\r\n\t\t\tte[ 4 ] = - a * f;\r\n\t\t\tte[ 8 ] = de + cf * b;\r\n\r\n\t\t\tte[ 1 ] = cf + de * b;\r\n\t\t\tte[ 5 ] = a * e;\r\n\t\t\tte[ 9 ] = df - ce * b;\r\n\r\n\t\t\tte[ 2 ] = - a * d;\r\n\t\t\tte[ 6 ] = b;\r\n\t\t\tte[ 10 ] = a * c;\r\n\r\n\t\t} else if ( euler.order === 'ZYX' ) {\r\n\r\n\t\t\tvar ae = a * e, af = a * f, be = b * e, bf = b * f;\r\n\r\n\t\t\tte[ 0 ] = c * e;\r\n\t\t\tte[ 4 ] = be * d - af;\r\n\t\t\tte[ 8 ] = ae * d + bf;\r\n\r\n\t\t\tte[ 1 ] = c * f;\r\n\t\t\tte[ 5 ] = bf * d + ae;\r\n\t\t\tte[ 9 ] = af * d - be;\r\n\r\n\t\t\tte[ 2 ] = - d;\r\n\t\t\tte[ 6 ] = b * c;\r\n\t\t\tte[ 10 ] = a * c;\r\n\r\n\t\t} else if ( euler.order === 'YZX' ) {\r\n\r\n\t\t\tvar ac = a * c, ad = a * d, bc = b * c, bd = b * d;\r\n\r\n\t\t\tte[ 0 ] = c * e;\r\n\t\t\tte[ 4 ] = bd - ac * f;\r\n\t\t\tte[ 8 ] = bc * f + ad;\r\n\r\n\t\t\tte[ 1 ] = f;\r\n\t\t\tte[ 5 ] = a * e;\r\n\t\t\tte[ 9 ] = - b * e;\r\n\r\n\t\t\tte[ 2 ] = - d * e;\r\n\t\t\tte[ 6 ] = ad * f + bc;\r\n\t\t\tte[ 10 ] = ac - bd * f;\r\n\r\n\t\t} else if ( euler.order === 'XZY' ) {\r\n\r\n\t\t\tvar ac = a * c, ad = a * d, bc = b * c, bd = b * d;\r\n\r\n\t\t\tte[ 0 ] = c * e;\r\n\t\t\tte[ 4 ] = - f;\r\n\t\t\tte[ 8 ] = d * e;\r\n\r\n\t\t\tte[ 1 ] = ac * f + bd;\r\n\t\t\tte[ 5 ] = a * e;\r\n\t\t\tte[ 9 ] = ad * f - bc;\r\n\r\n\t\t\tte[ 2 ] = bc * f - ad;\r\n\t\t\tte[ 6 ] = b * e;\r\n\t\t\tte[ 10 ] = bd * f + ac;\r\n\r\n\t\t}\r\n\r\n\t\t// last column\r\n\t\tte[ 3 ] = 0;\r\n\t\tte[ 7 ] = 0;\r\n\t\tte[ 11 ] = 0;\r\n\r\n\t\t// bottom row\r\n\t\tte[ 12 ] = 0;\r\n\t\tte[ 13 ] = 0;\r\n\t\tte[ 14 ] = 0;\r\n\t\tte[ 15 ] = 1;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetRotationFromQuaternion: function ( q ) {\r\n\r\n\t\tconsole.warn( 'THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion().' );\r\n\r\n\t\treturn this.makeRotationFromQuaternion( q );\r\n\r\n\t},\r\n\r\n\tmakeRotationFromQuaternion: function ( q ) {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tvar x = q.x, y = q.y, z = q.z, w = q.w;\r\n\t\tvar x2 = x + x, y2 = y + y, z2 = z + z;\r\n\t\tvar xx = x * x2, xy = x * y2, xz = x * z2;\r\n\t\tvar yy = y * y2, yz = y * z2, zz = z * z2;\r\n\t\tvar wx = w * x2, wy = w * y2, wz = w * z2;\r\n\r\n\t\tte[ 0 ] = 1 - ( yy + zz );\r\n\t\tte[ 4 ] = xy - wz;\r\n\t\tte[ 8 ] = xz + wy;\r\n\r\n\t\tte[ 1 ] = xy + wz;\r\n\t\tte[ 5 ] = 1 - ( xx + zz );\r\n\t\tte[ 9 ] = yz - wx;\r\n\r\n\t\tte[ 2 ] = xz - wy;\r\n\t\tte[ 6 ] = yz + wx;\r\n\t\tte[ 10 ] = 1 - ( xx + yy );\r\n\r\n\t\t// last column\r\n\t\tte[ 3 ] = 0;\r\n\t\tte[ 7 ] = 0;\r\n\t\tte[ 11 ] = 0;\r\n\r\n\t\t// bottom row\r\n\t\tte[ 12 ] = 0;\r\n\t\tte[ 13 ] = 0;\r\n\t\tte[ 14 ] = 0;\r\n\t\tte[ 15 ] = 1;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tlookAt: function () {\r\n\r\n\t\tvar x, y, z;\r\n\r\n\t\treturn function ( eye, target, up ) {\r\n\r\n\t\t\tif ( x === undefined ) x = new THREE.Vector3();\r\n\t\t\tif ( y === undefined ) y = new THREE.Vector3();\r\n\t\t\tif ( z === undefined ) z = new THREE.Vector3();\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tz.subVectors( eye, target ).normalize();\r\n\r\n\t\t\tif ( z.lengthSq() === 0 ) {\r\n\r\n\t\t\t\tz.z = 1;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tx.crossVectors( up, z ).normalize();\r\n\r\n\t\t\tif ( x.lengthSq() === 0 ) {\r\n\r\n\t\t\t\tz.x += 0.0001;\r\n\t\t\t\tx.crossVectors( up, z ).normalize();\r\n\r\n\t\t\t}\r\n\r\n\t\t\ty.crossVectors( z, x );\r\n\r\n\r\n\t\t\tte[ 0 ] = x.x; te[ 4 ] = y.x; te[ 8 ] = z.x;\r\n\t\t\tte[ 1 ] = x.y; te[ 5 ] = y.y; te[ 9 ] = z.y;\r\n\t\t\tte[ 2 ] = x.z; te[ 6 ] = y.z; te[ 10 ] = z.z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tmultiply: function ( m, n ) {\r\n\r\n\t\tif ( n !== undefined ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead.' );\r\n\t\t\treturn this.multiplyMatrices( m, n );\r\n\r\n\t\t}\r\n\r\n\t\treturn this.multiplyMatrices( this, m );\r\n\r\n\t},\r\n\r\n\tmultiplyMatrices: function ( a, b ) {\r\n\r\n\t\tvar ae = a.elements;\r\n\t\tvar be = b.elements;\r\n\t\tvar te = this.elements;\r\n\r\n\t\tvar a11 = ae[ 0 ], a12 = ae[ 4 ], a13 = ae[ 8 ], a14 = ae[ 12 ];\r\n\t\tvar a21 = ae[ 1 ], a22 = ae[ 5 ], a23 = ae[ 9 ], a24 = ae[ 13 ];\r\n\t\tvar a31 = ae[ 2 ], a32 = ae[ 6 ], a33 = ae[ 10 ], a34 = ae[ 14 ];\r\n\t\tvar a41 = ae[ 3 ], a42 = ae[ 7 ], a43 = ae[ 11 ], a44 = ae[ 15 ];\r\n\r\n\t\tvar b11 = be[ 0 ], b12 = be[ 4 ], b13 = be[ 8 ], b14 = be[ 12 ];\r\n\t\tvar b21 = be[ 1 ], b22 = be[ 5 ], b23 = be[ 9 ], b24 = be[ 13 ];\r\n\t\tvar b31 = be[ 2 ], b32 = be[ 6 ], b33 = be[ 10 ], b34 = be[ 14 ];\r\n\t\tvar b41 = be[ 3 ], b42 = be[ 7 ], b43 = be[ 11 ], b44 = be[ 15 ];\r\n\r\n\t\tte[ 0 ] = a11 * b11 + a12 * b21 + a13 * b31 + a14 * b41;\r\n\t\tte[ 4 ] = a11 * b12 + a12 * b22 + a13 * b32 + a14 * b42;\r\n\t\tte[ 8 ] = a11 * b13 + a12 * b23 + a13 * b33 + a14 * b43;\r\n\t\tte[ 12 ] = a11 * b14 + a12 * b24 + a13 * b34 + a14 * b44;\r\n\r\n\t\tte[ 1 ] = a21 * b11 + a22 * b21 + a23 * b31 + a24 * b41;\r\n\t\tte[ 5 ] = a21 * b12 + a22 * b22 + a23 * b32 + a24 * b42;\r\n\t\tte[ 9 ] = a21 * b13 + a22 * b23 + a23 * b33 + a24 * b43;\r\n\t\tte[ 13 ] = a21 * b14 + a22 * b24 + a23 * b34 + a24 * b44;\r\n\r\n\t\tte[ 2 ] = a31 * b11 + a32 * b21 + a33 * b31 + a34 * b41;\r\n\t\tte[ 6 ] = a31 * b12 + a32 * b22 + a33 * b32 + a34 * b42;\r\n\t\tte[ 10 ] = a31 * b13 + a32 * b23 + a33 * b33 + a34 * b43;\r\n\t\tte[ 14 ] = a31 * b14 + a32 * b24 + a33 * b34 + a34 * b44;\r\n\r\n\t\tte[ 3 ] = a41 * b11 + a42 * b21 + a43 * b31 + a44 * b41;\r\n\t\tte[ 7 ] = a41 * b12 + a42 * b22 + a43 * b32 + a44 * b42;\r\n\t\tte[ 11 ] = a41 * b13 + a42 * b23 + a43 * b33 + a44 * b43;\r\n\t\tte[ 15 ] = a41 * b14 + a42 * b24 + a43 * b34 + a44 * b44;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiplyToArray: function ( a, b, r ) {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tthis.multiplyMatrices( a, b );\r\n\r\n\t\tr[ 0 ] = te[ 0 ]; r[ 1 ] = te[ 1 ]; r[ 2 ] = te[ 2 ]; r[ 3 ] = te[ 3 ];\r\n\t\tr[ 4 ] = te[ 4 ]; r[ 5 ] = te[ 5 ]; r[ 6 ] = te[ 6 ]; r[ 7 ] = te[ 7 ];\r\n\t\tr[ 8 ]  = te[ 8 ]; r[ 9 ]  = te[ 9 ]; r[ 10 ] = te[ 10 ]; r[ 11 ] = te[ 11 ];\r\n\t\tr[ 12 ] = te[ 12 ]; r[ 13 ] = te[ 13 ]; r[ 14 ] = te[ 14 ]; r[ 15 ] = te[ 15 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiplyScalar: function ( s ) {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tte[ 0 ] *= s; te[ 4 ] *= s; te[ 8 ] *= s; te[ 12 ] *= s;\r\n\t\tte[ 1 ] *= s; te[ 5 ] *= s; te[ 9 ] *= s; te[ 13 ] *= s;\r\n\t\tte[ 2 ] *= s; te[ 6 ] *= s; te[ 10 ] *= s; te[ 14 ] *= s;\r\n\t\tte[ 3 ] *= s; te[ 7 ] *= s; te[ 11 ] *= s; te[ 15 ] *= s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiplyVector3: function ( vector ) {\r\n\r\n\t\tconsole.warn( 'THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead.' );\r\n\t\treturn vector.applyProjection( this );\r\n\r\n\t},\r\n\r\n\tmultiplyVector4: function ( vector ) {\r\n\r\n\t\tconsole.warn( 'THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.' );\r\n\t\treturn vector.applyMatrix4( this );\r\n\r\n\t},\r\n\r\n\tmultiplyVector3Array: function ( a ) {\r\n\r\n\t\tconsole.warn( 'THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.' );\r\n\t\treturn this.applyToVector3Array( a );\r\n\r\n\t},\r\n\r\n\tapplyToVector3Array: function () {\r\n\r\n\t\tvar v1;\r\n\r\n\t\treturn function ( array, offset, length ) {\r\n\r\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\t\t\tif ( length === undefined ) length = array.length;\r\n\r\n\t\t\tfor ( var i = 0, j = offset; i < length; i += 3, j += 3 ) {\r\n\r\n\t\t\t\tv1.fromArray( array, j );\r\n\t\t\t\tv1.applyMatrix4( this );\r\n\t\t\t\tv1.toArray( array, j );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn array;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tapplyToBuffer: function () {\r\n\r\n\t\tvar v1;\r\n\r\n\t\treturn function applyToBuffer( buffer, offset, length ) {\r\n\r\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\t\t\tif ( length === undefined ) length = buffer.length / buffer.itemSize;\r\n\r\n\t\t\tfor ( var i = 0, j = offset; i < length; i ++, j ++ ) {\r\n\r\n\t\t\t\tv1.x = buffer.getX( j );\r\n\t\t\t\tv1.y = buffer.getY( j );\r\n\t\t\t\tv1.z = buffer.getZ( j );\r\n\r\n\t\t\t\tv1.applyMatrix4( this );\r\n\r\n\t\t\t\tbuffer.setXYZ( v1.x, v1.y, v1.z );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn buffer;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\trotateAxis: function ( v ) {\r\n\r\n\t\tconsole.warn( 'THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.' );\r\n\r\n\t\tv.transformDirection( this );\r\n\r\n\t},\r\n\r\n\tcrossVector: function ( vector ) {\r\n\r\n\t\tconsole.warn( 'THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.' );\r\n\t\treturn vector.applyMatrix4( this );\r\n\r\n\t},\r\n\r\n\tdeterminant: function () {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tvar n11 = te[ 0 ], n12 = te[ 4 ], n13 = te[ 8 ], n14 = te[ 12 ];\r\n\t\tvar n21 = te[ 1 ], n22 = te[ 5 ], n23 = te[ 9 ], n24 = te[ 13 ];\r\n\t\tvar n31 = te[ 2 ], n32 = te[ 6 ], n33 = te[ 10 ], n34 = te[ 14 ];\r\n\t\tvar n41 = te[ 3 ], n42 = te[ 7 ], n43 = te[ 11 ], n44 = te[ 15 ];\r\n\r\n\t\t//TODO: make this more efficient\r\n\t\t//( based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm )\r\n\r\n\t\treturn (\r\n\t\t\tn41 * (\r\n\t\t\t\t+ n14 * n23 * n32\r\n\t\t\t\t - n13 * n24 * n32\r\n\t\t\t\t - n14 * n22 * n33\r\n\t\t\t\t + n12 * n24 * n33\r\n\t\t\t\t + n13 * n22 * n34\r\n\t\t\t\t - n12 * n23 * n34\r\n\t\t\t) +\r\n\t\t\tn42 * (\r\n\t\t\t\t+ n11 * n23 * n34\r\n\t\t\t\t - n11 * n24 * n33\r\n\t\t\t\t + n14 * n21 * n33\r\n\t\t\t\t - n13 * n21 * n34\r\n\t\t\t\t + n13 * n24 * n31\r\n\t\t\t\t - n14 * n23 * n31\r\n\t\t\t) +\r\n\t\t\tn43 * (\r\n\t\t\t\t+ n11 * n24 * n32\r\n\t\t\t\t - n11 * n22 * n34\r\n\t\t\t\t - n14 * n21 * n32\r\n\t\t\t\t + n12 * n21 * n34\r\n\t\t\t\t + n14 * n22 * n31\r\n\t\t\t\t - n12 * n24 * n31\r\n\t\t\t) +\r\n\t\t\tn44 * (\r\n\t\t\t\t- n13 * n22 * n31\r\n\t\t\t\t - n11 * n23 * n32\r\n\t\t\t\t + n11 * n22 * n33\r\n\t\t\t\t + n13 * n21 * n32\r\n\t\t\t\t - n12 * n21 * n33\r\n\t\t\t\t + n12 * n23 * n31\r\n\t\t\t)\r\n\r\n\t\t);\r\n\r\n\t},\r\n\r\n\ttranspose: function () {\r\n\r\n\t\tvar te = this.elements;\r\n\t\tvar tmp;\r\n\r\n\t\ttmp = te[ 1 ]; te[ 1 ] = te[ 4 ]; te[ 4 ] = tmp;\r\n\t\ttmp = te[ 2 ]; te[ 2 ] = te[ 8 ]; te[ 8 ] = tmp;\r\n\t\ttmp = te[ 6 ]; te[ 6 ] = te[ 9 ]; te[ 9 ] = tmp;\r\n\r\n\t\ttmp = te[ 3 ]; te[ 3 ] = te[ 12 ]; te[ 12 ] = tmp;\r\n\t\ttmp = te[ 7 ]; te[ 7 ] = te[ 13 ]; te[ 13 ] = tmp;\r\n\t\ttmp = te[ 11 ]; te[ 11 ] = te[ 14 ]; te[ 14 ] = tmp;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tflattenToArrayOffset: function ( array, offset ) {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tarray[ offset ] = te[ 0 ];\r\n\t\tarray[ offset + 1 ] = te[ 1 ];\r\n\t\tarray[ offset + 2 ] = te[ 2 ];\r\n\t\tarray[ offset + 3 ] = te[ 3 ];\r\n\r\n\t\tarray[ offset + 4 ] = te[ 4 ];\r\n\t\tarray[ offset + 5 ] = te[ 5 ];\r\n\t\tarray[ offset + 6 ] = te[ 6 ];\r\n\t\tarray[ offset + 7 ] = te[ 7 ];\r\n\r\n\t\tarray[ offset + 8 ]  = te[ 8 ];\r\n\t\tarray[ offset + 9 ]  = te[ 9 ];\r\n\t\tarray[ offset + 10 ] = te[ 10 ];\r\n\t\tarray[ offset + 11 ] = te[ 11 ];\r\n\r\n\t\tarray[ offset + 12 ] = te[ 12 ];\r\n\t\tarray[ offset + 13 ] = te[ 13 ];\r\n\t\tarray[ offset + 14 ] = te[ 14 ];\r\n\t\tarray[ offset + 15 ] = te[ 15 ];\r\n\r\n\t\treturn array;\r\n\r\n\t},\r\n\r\n\tgetPosition: function () {\r\n\r\n\t\tvar v1;\r\n\r\n\t\treturn function () {\r\n\r\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\t\t\tconsole.warn( 'THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.' );\r\n\r\n\t\t\tvar te = this.elements;\r\n\t\t\treturn v1.set( te[ 12 ], te[ 13 ], te[ 14 ] );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tsetPosition: function ( v ) {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tte[ 12 ] = v.x;\r\n\t\tte[ 13 ] = v.y;\r\n\t\tte[ 14 ] = v.z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tgetInverse: function ( m, throwOnInvertible ) {\r\n\r\n\t\t// based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm\r\n\t\tvar te = this.elements;\r\n\t\tvar me = m.elements;\r\n\r\n\t\tvar n11 = me[ 0 ], n12 = me[ 4 ], n13 = me[ 8 ], n14 = me[ 12 ];\r\n\t\tvar n21 = me[ 1 ], n22 = me[ 5 ], n23 = me[ 9 ], n24 = me[ 13 ];\r\n\t\tvar n31 = me[ 2 ], n32 = me[ 6 ], n33 = me[ 10 ], n34 = me[ 14 ];\r\n\t\tvar n41 = me[ 3 ], n42 = me[ 7 ], n43 = me[ 11 ], n44 = me[ 15 ];\r\n\r\n\t\tte[ 0 ] = n23 * n34 * n42 - n24 * n33 * n42 + n24 * n32 * n43 - n22 * n34 * n43 - n23 * n32 * n44 + n22 * n33 * n44;\r\n\t\tte[ 4 ] = n14 * n33 * n42 - n13 * n34 * n42 - n14 * n32 * n43 + n12 * n34 * n43 + n13 * n32 * n44 - n12 * n33 * n44;\r\n\t\tte[ 8 ] = n13 * n24 * n42 - n14 * n23 * n42 + n14 * n22 * n43 - n12 * n24 * n43 - n13 * n22 * n44 + n12 * n23 * n44;\r\n\t\tte[ 12 ] = n14 * n23 * n32 - n13 * n24 * n32 - n14 * n22 * n33 + n12 * n24 * n33 + n13 * n22 * n34 - n12 * n23 * n34;\r\n\t\tte[ 1 ] = n24 * n33 * n41 - n23 * n34 * n41 - n24 * n31 * n43 + n21 * n34 * n43 + n23 * n31 * n44 - n21 * n33 * n44;\r\n\t\tte[ 5 ] = n13 * n34 * n41 - n14 * n33 * n41 + n14 * n31 * n43 - n11 * n34 * n43 - n13 * n31 * n44 + n11 * n33 * n44;\r\n\t\tte[ 9 ] = n14 * n23 * n41 - n13 * n24 * n41 - n14 * n21 * n43 + n11 * n24 * n43 + n13 * n21 * n44 - n11 * n23 * n44;\r\n\t\tte[ 13 ] = n13 * n24 * n31 - n14 * n23 * n31 + n14 * n21 * n33 - n11 * n24 * n33 - n13 * n21 * n34 + n11 * n23 * n34;\r\n\t\tte[ 2 ] = n22 * n34 * n41 - n24 * n32 * n41 + n24 * n31 * n42 - n21 * n34 * n42 - n22 * n31 * n44 + n21 * n32 * n44;\r\n\t\tte[ 6 ] = n14 * n32 * n41 - n12 * n34 * n41 - n14 * n31 * n42 + n11 * n34 * n42 + n12 * n31 * n44 - n11 * n32 * n44;\r\n\t\tte[ 10 ] = n12 * n24 * n41 - n14 * n22 * n41 + n14 * n21 * n42 - n11 * n24 * n42 - n12 * n21 * n44 + n11 * n22 * n44;\r\n\t\tte[ 14 ] = n14 * n22 * n31 - n12 * n24 * n31 - n14 * n21 * n32 + n11 * n24 * n32 + n12 * n21 * n34 - n11 * n22 * n34;\r\n\t\tte[ 3 ] = n23 * n32 * n41 - n22 * n33 * n41 - n23 * n31 * n42 + n21 * n33 * n42 + n22 * n31 * n43 - n21 * n32 * n43;\r\n\t\tte[ 7 ] = n12 * n33 * n41 - n13 * n32 * n41 + n13 * n31 * n42 - n11 * n33 * n42 - n12 * n31 * n43 + n11 * n32 * n43;\r\n\t\tte[ 11 ] = n13 * n22 * n41 - n12 * n23 * n41 - n13 * n21 * n42 + n11 * n23 * n42 + n12 * n21 * n43 - n11 * n22 * n43;\r\n\t\tte[ 15 ] = n12 * n23 * n31 - n13 * n22 * n31 + n13 * n21 * n32 - n11 * n23 * n32 - n12 * n21 * n33 + n11 * n22 * n33;\r\n\r\n\t\tvar det = n11 * te[ 0 ] + n21 * te[ 4 ] + n31 * te[ 8 ] + n41 * te[ 12 ];\r\n\r\n\t\tif ( det === 0 ) {\r\n\r\n\t\t\tvar msg = \"THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0\";\r\n\r\n\t\t\tif ( throwOnInvertible || false ) {\r\n\r\n\t\t\t\tthrow new Error( msg );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tconsole.warn( msg );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.identity();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t\tthis.multiplyScalar( 1 / det );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttranslate: function ( v ) {\r\n\r\n\t\tconsole.error( 'THREE.Matrix4: .translate() has been removed.' );\r\n\r\n\t},\r\n\r\n\trotateX: function ( angle ) {\r\n\r\n\t\tconsole.error( 'THREE.Matrix4: .rotateX() has been removed.' );\r\n\r\n\t},\r\n\r\n\trotateY: function ( angle ) {\r\n\r\n\t\tconsole.error( 'THREE.Matrix4: .rotateY() has been removed.' );\r\n\r\n\t},\r\n\r\n\trotateZ: function ( angle ) {\r\n\r\n\t\tconsole.error( 'THREE.Matrix4: .rotateZ() has been removed.' );\r\n\r\n\t},\r\n\r\n\trotateByAxis: function ( axis, angle ) {\r\n\r\n\t\tconsole.error( 'THREE.Matrix4: .rotateByAxis() has been removed.' );\r\n\r\n\t},\r\n\r\n\tscale: function ( v ) {\r\n\r\n\t\tvar te = this.elements;\r\n\t\tvar x = v.x, y = v.y, z = v.z;\r\n\r\n\t\tte[ 0 ] *= x; te[ 4 ] *= y; te[ 8 ] *= z;\r\n\t\tte[ 1 ] *= x; te[ 5 ] *= y; te[ 9 ] *= z;\r\n\t\tte[ 2 ] *= x; te[ 6 ] *= y; te[ 10 ] *= z;\r\n\t\tte[ 3 ] *= x; te[ 7 ] *= y; te[ 11 ] *= z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tgetMaxScaleOnAxis: function () {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tvar scaleXSq = te[ 0 ] * te[ 0 ] + te[ 1 ] * te[ 1 ] + te[ 2 ] * te[ 2 ];\r\n\t\tvar scaleYSq = te[ 4 ] * te[ 4 ] + te[ 5 ] * te[ 5 ] + te[ 6 ] * te[ 6 ];\r\n\t\tvar scaleZSq = te[ 8 ] * te[ 8 ] + te[ 9 ] * te[ 9 ] + te[ 10 ] * te[ 10 ];\r\n\r\n\t\treturn Math.sqrt( Math.max( scaleXSq, scaleYSq, scaleZSq ) );\r\n\r\n\t},\r\n\r\n\tmakeTranslation: function ( x, y, z ) {\r\n\r\n\t\tthis.set(\r\n\r\n\t\t\t1, 0, 0, x,\r\n\t\t\t0, 1, 0, y,\r\n\t\t\t0, 0, 1, z,\r\n\t\t\t0, 0, 0, 1\r\n\r\n\t\t);\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmakeRotationX: function ( theta ) {\r\n\r\n\t\tvar c = Math.cos( theta ), s = Math.sin( theta );\r\n\r\n\t\tthis.set(\r\n\r\n\t\t\t1, 0,  0, 0,\r\n\t\t\t0, c, - s, 0,\r\n\t\t\t0, s,  c, 0,\r\n\t\t\t0, 0,  0, 1\r\n\r\n\t\t);\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmakeRotationY: function ( theta ) {\r\n\r\n\t\tvar c = Math.cos( theta ), s = Math.sin( theta );\r\n\r\n\t\tthis.set(\r\n\r\n\t\t\t c, 0, s, 0,\r\n\t\t\t 0, 1, 0, 0,\r\n\t\t\t- s, 0, c, 0,\r\n\t\t\t 0, 0, 0, 1\r\n\r\n\t\t);\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmakeRotationZ: function ( theta ) {\r\n\r\n\t\tvar c = Math.cos( theta ), s = Math.sin( theta );\r\n\r\n\t\tthis.set(\r\n\r\n\t\t\tc, - s, 0, 0,\r\n\t\t\ts,  c, 0, 0,\r\n\t\t\t0,  0, 1, 0,\r\n\t\t\t0,  0, 0, 1\r\n\r\n\t\t);\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmakeRotationAxis: function ( axis, angle ) {\r\n\r\n\t\t// Based on http://www.gamedev.net/reference/articles/article1199.asp\r\n\r\n\t\tvar c = Math.cos( angle );\r\n\t\tvar s = Math.sin( angle );\r\n\t\tvar t = 1 - c;\r\n\t\tvar x = axis.x, y = axis.y, z = axis.z;\r\n\t\tvar tx = t * x, ty = t * y;\r\n\r\n\t\tthis.set(\r\n\r\n\t\t\ttx * x + c, tx * y - s * z, tx * z + s * y, 0,\r\n\t\t\ttx * y + s * z, ty * y + c, ty * z - s * x, 0,\r\n\t\t\ttx * z - s * y, ty * z + s * x, t * z * z + c, 0,\r\n\t\t\t0, 0, 0, 1\r\n\r\n\t\t);\r\n\r\n\t\t return this;\r\n\r\n\t},\r\n\r\n\tmakeScale: function ( x, y, z ) {\r\n\r\n\t\tthis.set(\r\n\r\n\t\t\tx, 0, 0, 0,\r\n\t\t\t0, y, 0, 0,\r\n\t\t\t0, 0, z, 0,\r\n\t\t\t0, 0, 0, 1\r\n\r\n\t\t);\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcompose: function ( position, quaternion, scale ) {\r\n\r\n\t\tthis.makeRotationFromQuaternion( quaternion );\r\n\t\tthis.scale( scale );\r\n\t\tthis.setPosition( position );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdecompose: function () {\r\n\r\n\t\tvar vector, matrix;\r\n\r\n\t\treturn function ( position, quaternion, scale ) {\r\n\r\n\t\t\tif ( vector === undefined ) vector = new THREE.Vector3();\r\n\t\t\tif ( matrix === undefined ) matrix = new THREE.Matrix4();\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tvar sx = vector.set( te[ 0 ], te[ 1 ], te[ 2 ] ).length();\r\n\t\t\tvar sy = vector.set( te[ 4 ], te[ 5 ], te[ 6 ] ).length();\r\n\t\t\tvar sz = vector.set( te[ 8 ], te[ 9 ], te[ 10 ] ).length();\r\n\r\n\t\t\t// if determine is negative, we need to invert one scale\r\n\t\t\tvar det = this.determinant();\r\n\t\t\tif ( det < 0 ) {\r\n\r\n\t\t\t\tsx = - sx;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tposition.x = te[ 12 ];\r\n\t\t\tposition.y = te[ 13 ];\r\n\t\t\tposition.z = te[ 14 ];\r\n\r\n\t\t\t// scale the rotation part\r\n\r\n\t\t\tmatrix.elements.set( this.elements ); // at this point matrix is incomplete so we can't use .copy()\r\n\r\n\t\t\tvar invSX = 1 / sx;\r\n\t\t\tvar invSY = 1 / sy;\r\n\t\t\tvar invSZ = 1 / sz;\r\n\r\n\t\t\tmatrix.elements[ 0 ] *= invSX;\r\n\t\t\tmatrix.elements[ 1 ] *= invSX;\r\n\t\t\tmatrix.elements[ 2 ] *= invSX;\r\n\r\n\t\t\tmatrix.elements[ 4 ] *= invSY;\r\n\t\t\tmatrix.elements[ 5 ] *= invSY;\r\n\t\t\tmatrix.elements[ 6 ] *= invSY;\r\n\r\n\t\t\tmatrix.elements[ 8 ] *= invSZ;\r\n\t\t\tmatrix.elements[ 9 ] *= invSZ;\r\n\t\t\tmatrix.elements[ 10 ] *= invSZ;\r\n\r\n\t\t\tquaternion.setFromRotationMatrix( matrix );\r\n\r\n\t\t\tscale.x = sx;\r\n\t\t\tscale.y = sy;\r\n\t\t\tscale.z = sz;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tmakeFrustum: function ( left, right, bottom, top, near, far ) {\r\n\r\n\t\tvar te = this.elements;\r\n\t\tvar x = 2 * near / ( right - left );\r\n\t\tvar y = 2 * near / ( top - bottom );\r\n\r\n\t\tvar a = ( right + left ) / ( right - left );\r\n\t\tvar b = ( top + bottom ) / ( top - bottom );\r\n\t\tvar c = - ( far + near ) / ( far - near );\r\n\t\tvar d = - 2 * far * near / ( far - near );\r\n\r\n\t\tte[ 0 ] = x;\tte[ 4 ] = 0;\tte[ 8 ] = a;\tte[ 12 ] = 0;\r\n\t\tte[ 1 ] = 0;\tte[ 5 ] = y;\tte[ 9 ] = b;\tte[ 13 ] = 0;\r\n\t\tte[ 2 ] = 0;\tte[ 6 ] = 0;\tte[ 10 ] = c;\tte[ 14 ] = d;\r\n\t\tte[ 3 ] = 0;\tte[ 7 ] = 0;\tte[ 11 ] = - 1;\tte[ 15 ] = 0;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmakePerspective: function ( fov, aspect, near, far ) {\r\n\r\n\t\tvar ymax = near * Math.tan( THREE.Math.degToRad( fov * 0.5 ) );\r\n\t\tvar ymin = - ymax;\r\n\t\tvar xmin = ymin * aspect;\r\n\t\tvar xmax = ymax * aspect;\r\n\r\n\t\treturn this.makeFrustum( xmin, xmax, ymin, ymax, near, far );\r\n\r\n\t},\r\n\r\n\tmakeOrthographic: function ( left, right, top, bottom, near, far ) {\r\n\r\n\t\tvar te = this.elements;\r\n\t\tvar w = right - left;\r\n\t\tvar h = top - bottom;\r\n\t\tvar p = far - near;\r\n\r\n\t\tvar x = ( right + left ) / w;\r\n\t\tvar y = ( top + bottom ) / h;\r\n\t\tvar z = ( far + near ) / p;\r\n\r\n\t\tte[ 0 ] = 2 / w;\tte[ 4 ] = 0;\tte[ 8 ] = 0;\tte[ 12 ] = - x;\r\n\t\tte[ 1 ] = 0;\tte[ 5 ] = 2 / h;\tte[ 9 ] = 0;\tte[ 13 ] = - y;\r\n\t\tte[ 2 ] = 0;\tte[ 6 ] = 0;\tte[ 10 ] = - 2 / p;\tte[ 14 ] = - z;\r\n\t\tte[ 3 ] = 0;\tte[ 7 ] = 0;\tte[ 11 ] = 0;\tte[ 15 ] = 1;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( matrix ) {\r\n\r\n\t\tvar te = this.elements;\r\n\t\tvar me = matrix.elements;\r\n\r\n\t\tfor ( var i = 0; i < 16; i ++ ) {\r\n\r\n\t\t\tif ( te[ i ] !== me[ i ] ) return false;\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t},\r\n\r\n\tfromArray: function ( array ) {\r\n\r\n\t\tthis.elements.set( array );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttoArray: function () {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\treturn [\r\n\t\t\tte[ 0 ], te[ 1 ], te[ 2 ], te[ 3 ],\r\n\t\t\tte[ 4 ], te[ 5 ], te[ 6 ], te[ 7 ],\r\n\t\t\tte[ 8 ], te[ 9 ], te[ 10 ], te[ 11 ],\r\n\t\t\tte[ 12 ], te[ 13 ], te[ 14 ], te[ 15 ]\r\n\t\t];\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Ray.js\r\n\r\n/**\r\n * @author bhouston / http://clara.io\r\n */\r\n\r\nTHREE.Ray = function ( origin, direction ) {\r\n\r\n\tthis.origin = ( origin !== undefined ) ? origin : new THREE.Vector3();\r\n\tthis.direction = ( direction !== undefined ) ? direction : new THREE.Vector3();\r\n\r\n};\r\n\r\nTHREE.Ray.prototype = {\r\n\r\n\tconstructor: THREE.Ray,\r\n\r\n\tset: function ( origin, direction ) {\r\n\r\n\t\tthis.origin.copy( origin );\r\n\t\tthis.direction.copy( direction );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( ray ) {\r\n\r\n\t\tthis.origin.copy( ray.origin );\r\n\t\tthis.direction.copy( ray.direction );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tat: function ( t, optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\treturn result.copy( this.direction ).multiplyScalar( t ).add( this.origin );\r\n\r\n\t},\r\n\r\n\trecast: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function ( t ) {\r\n\r\n\t\t\tthis.origin.copy( this.at( t, v1 ) );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tclosestPointToPoint: function ( point, optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\tresult.subVectors( point, this.origin );\r\n\t\tvar directionDistance = result.dot( this.direction );\r\n\r\n\t\tif ( directionDistance < 0 ) {\r\n\r\n\t\t\treturn result.copy( this.origin );\r\n\r\n\t\t}\r\n\r\n\t\treturn result.copy( this.direction ).multiplyScalar( directionDistance ).add( this.origin );\r\n\r\n\t},\r\n\r\n\tdistanceToPoint: function ( point ) {\r\n\r\n\t\treturn Math.sqrt( this.distanceSqToPoint( point ) );\r\n\r\n\t},\r\n\r\n\tdistanceSqToPoint: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function ( point ) {\r\n\r\n\t\t\tvar directionDistance = v1.subVectors( point, this.origin ).dot( this.direction );\r\n\r\n\t\t\t// point behind the ray\r\n\r\n\t\t\tif ( directionDistance < 0 ) {\r\n\r\n\t\t\t\treturn this.origin.distanceToSquared( point );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tv1.copy( this.direction ).multiplyScalar( directionDistance ).add( this.origin );\r\n\r\n\t\t\treturn v1.distanceToSquared( point );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tdistanceSqToSegment: function () {\r\n\r\n\t\tvar segCenter = new THREE.Vector3();\r\n\t\tvar segDir = new THREE.Vector3();\r\n\t\tvar diff = new THREE.Vector3();\r\n\r\n\t\treturn function ( v0, v1, optionalPointOnRay, optionalPointOnSegment ) {\r\n\r\n\t\t\t// from http://www.geometrictools.com/LibMathematics/Distance/Wm5DistRay3Segment3.cpp\r\n\t\t\t// It returns the min distance between the ray and the segment\r\n\t\t\t// defined by v0 and v1\r\n\t\t\t// It can also set two optional targets :\r\n\t\t\t// - The closest point on the ray\r\n\t\t\t// - The closest point on the segment\r\n\r\n\t\t\tsegCenter.copy( v0 ).add( v1 ).multiplyScalar( 0.5 );\r\n\t\t\tsegDir.copy( v1 ).sub( v0 ).normalize();\r\n\t\t\tdiff.copy( this.origin ).sub( segCenter );\r\n\r\n\t\t\tvar segExtent = v0.distanceTo( v1 ) * 0.5;\r\n\t\t\tvar a01 = - this.direction.dot( segDir );\r\n\t\t\tvar b0 = diff.dot( this.direction );\r\n\t\t\tvar b1 = - diff.dot( segDir );\r\n\t\t\tvar c = diff.lengthSq();\r\n\t\t\tvar det = Math.abs( 1 - a01 * a01 );\r\n\t\t\tvar s0, s1, sqrDist, extDet;\r\n\r\n\t\t\tif ( det > 0 ) {\r\n\r\n\t\t\t\t// The ray and segment are not parallel.\r\n\r\n\t\t\t\ts0 = a01 * b1 - b0;\r\n\t\t\t\ts1 = a01 * b0 - b1;\r\n\t\t\t\textDet = segExtent * det;\r\n\r\n\t\t\t\tif ( s0 >= 0 ) {\r\n\r\n\t\t\t\t\tif ( s1 >= - extDet ) {\r\n\r\n\t\t\t\t\t\tif ( s1 <= extDet ) {\r\n\r\n\t\t\t\t\t\t\t// region 0\r\n\t\t\t\t\t\t\t// Minimum at interior points of ray and segment.\r\n\r\n\t\t\t\t\t\t\tvar invDet = 1 / det;\r\n\t\t\t\t\t\t\ts0 *= invDet;\r\n\t\t\t\t\t\t\ts1 *= invDet;\r\n\t\t\t\t\t\t\tsqrDist = s0 * ( s0 + a01 * s1 + 2 * b0 ) + s1 * ( a01 * s0 + s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t// region 1\r\n\r\n\t\t\t\t\t\t\ts1 = segExtent;\r\n\t\t\t\t\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\r\n\t\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t// region 5\r\n\r\n\t\t\t\t\t\ts1 = - segExtent;\r\n\t\t\t\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\r\n\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tif ( s1 <= - extDet ) {\r\n\r\n\t\t\t\t\t\t// region 4\r\n\r\n\t\t\t\t\t\ts0 = Math.max( 0, - ( - a01 * segExtent + b0 ) );\r\n\t\t\t\t\t\ts1 = ( s0 > 0 ) ? - segExtent : Math.min( Math.max( - segExtent, - b1 ), segExtent );\r\n\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t\t\t} else if ( s1 <= extDet ) {\r\n\r\n\t\t\t\t\t\t// region 3\r\n\r\n\t\t\t\t\t\ts0 = 0;\r\n\t\t\t\t\t\ts1 = Math.min( Math.max( - segExtent, - b1 ), segExtent );\r\n\t\t\t\t\t\tsqrDist = s1 * ( s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t// region 2\r\n\r\n\t\t\t\t\t\ts0 = Math.max( 0, - ( a01 * segExtent + b0 ) );\r\n\t\t\t\t\t\ts1 = ( s0 > 0 ) ? segExtent : Math.min( Math.max( - segExtent, - b1 ), segExtent );\r\n\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// Ray and segment are parallel.\r\n\r\n\t\t\t\ts1 = ( a01 > 0 ) ? - segExtent : segExtent;\r\n\t\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\r\n\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( optionalPointOnRay ) {\r\n\r\n\t\t\t\toptionalPointOnRay.copy( this.direction ).multiplyScalar( s0 ).add( this.origin );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( optionalPointOnSegment ) {\r\n\r\n\t\t\t\toptionalPointOnSegment.copy( segDir ).multiplyScalar( s1 ).add( segCenter );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn sqrDist;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\r\n\tisIntersectionSphere: function ( sphere ) {\r\n\r\n\t\treturn this.distanceToPoint( sphere.center ) <= sphere.radius;\r\n\r\n\t},\r\n\r\n\tintersectSphere: function () {\r\n\r\n\t\t// from http://www.scratchapixel.com/lessons/3d-basic-lessons/lesson-7-intersecting-simple-shapes/ray-sphere-intersection/\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function ( sphere, optionalTarget ) {\r\n\r\n\t\t\tv1.subVectors( sphere.center, this.origin );\r\n\r\n\t\t\tvar tca = v1.dot( this.direction );\r\n\r\n\t\t\tvar d2 = v1.dot( v1 ) - tca * tca;\r\n\r\n\t\t\tvar radius2 = sphere.radius * sphere.radius;\r\n\r\n\t\t\tif ( d2 > radius2 ) return null;\r\n\r\n\t\t\tvar thc = Math.sqrt( radius2 - d2 );\r\n\r\n\t\t\t// t0 = first intersect point - entrance on front of sphere\r\n\t\t\tvar t0 = tca - thc;\r\n\r\n\t\t\t// t1 = second intersect point - exit point on back of sphere\r\n\t\t\tvar t1 = tca + thc;\r\n\r\n\t\t\t// test to see if both t0 and t1 are behind the ray - if so, return null\r\n\t\t\tif ( t0 < 0 && t1 < 0 ) return null;\r\n\r\n\t\t\t// test to see if t0 is behind the ray:\r\n\t\t\t// if it is, the ray is inside the sphere, so return the second exit point scaled by t1,\r\n\t\t\t// in order to always return an intersect point that is in front of the ray.\r\n\t\t\tif ( t0 < 0 ) return this.at( t1, optionalTarget );\r\n\r\n\t\t\t// else t0 is in front of the ray, so return the first collision point scaled by t0\r\n\t\t\treturn this.at( t0, optionalTarget );\r\n\r\n\t\t}\r\n\r\n\t}(),\r\n\r\n\tisIntersectionPlane: function ( plane ) {\r\n\r\n\t\t// check if the ray lies on the plane first\r\n\r\n\t\tvar distToPoint = plane.distanceToPoint( this.origin );\r\n\r\n\t\tif ( distToPoint === 0 ) {\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t}\r\n\r\n\t\tvar denominator = plane.normal.dot( this.direction );\r\n\r\n\t\tif ( denominator * distToPoint < 0 ) {\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t}\r\n\r\n\t\t// ray origin is behind the plane (and is pointing behind it)\r\n\r\n\t\treturn false;\r\n\r\n\t},\r\n\r\n\tdistanceToPlane: function ( plane ) {\r\n\r\n\t\tvar denominator = plane.normal.dot( this.direction );\r\n\t\tif ( denominator === 0 ) {\r\n\r\n\t\t\t// line is coplanar, return origin\r\n\t\t\tif ( plane.distanceToPoint( this.origin ) === 0 ) {\r\n\r\n\t\t\t\treturn 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Null is preferable to undefined since undefined means.... it is undefined\r\n\r\n\t\t\treturn null;\r\n\r\n\t\t}\r\n\r\n\t\tvar t = - ( this.origin.dot( plane.normal ) + plane.constant ) / denominator;\r\n\r\n\t\t// Return if the ray never intersects the plane\r\n\r\n\t\treturn t >= 0 ? t :  null;\r\n\r\n\t},\r\n\r\n\tintersectPlane: function ( plane, optionalTarget ) {\r\n\r\n\t\tvar t = this.distanceToPlane( plane );\r\n\r\n\t\tif ( t === null ) {\r\n\r\n\t\t\treturn null;\r\n\r\n\t\t}\r\n\r\n\t\treturn this.at( t, optionalTarget );\r\n\r\n\t},\r\n\r\n\tisIntersectionBox: function () {\r\n\r\n\t\tvar v = new THREE.Vector3();\r\n\r\n\t\treturn function ( box ) {\r\n\r\n\t\t\treturn this.intersectBox( box, v ) !== null;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tintersectBox: function ( box, optionalTarget ) {\r\n\r\n\t\t// http://www.scratchapixel.com/lessons/3d-basic-lessons/lesson-7-intersecting-simple-shapes/ray-box-intersection/\r\n\r\n\t\tvar tmin, tmax, tymin, tymax, tzmin, tzmax;\r\n\r\n\t\tvar invdirx = 1 / this.direction.x,\r\n\t\t\tinvdiry = 1 / this.direction.y,\r\n\t\t\tinvdirz = 1 / this.direction.z;\r\n\r\n\t\tvar origin = this.origin;\r\n\r\n\t\tif ( invdirx >= 0 ) {\r\n\r\n\t\t\ttmin = ( box.min.x - origin.x ) * invdirx;\r\n\t\t\ttmax = ( box.max.x - origin.x ) * invdirx;\r\n\r\n\t\t} else {\r\n\r\n\t\t\ttmin = ( box.max.x - origin.x ) * invdirx;\r\n\t\t\ttmax = ( box.min.x - origin.x ) * invdirx;\r\n\r\n\t\t}\r\n\r\n\t\tif ( invdiry >= 0 ) {\r\n\r\n\t\t\ttymin = ( box.min.y - origin.y ) * invdiry;\r\n\t\t\ttymax = ( box.max.y - origin.y ) * invdiry;\r\n\r\n\t\t} else {\r\n\r\n\t\t\ttymin = ( box.max.y - origin.y ) * invdiry;\r\n\t\t\ttymax = ( box.min.y - origin.y ) * invdiry;\r\n\r\n\t\t}\r\n\r\n\t\tif ( ( tmin > tymax ) || ( tymin > tmax ) ) return null;\r\n\r\n\t\t// These lines also handle the case where tmin or tmax is NaN\r\n\t\t// (result of 0 * Infinity). x !== x returns true if x is NaN\r\n\r\n\t\tif ( tymin > tmin || tmin !== tmin ) tmin = tymin;\r\n\r\n\t\tif ( tymax < tmax || tmax !== tmax ) tmax = tymax;\r\n\r\n\t\tif ( invdirz >= 0 ) {\r\n\r\n\t\t\ttzmin = ( box.min.z - origin.z ) * invdirz;\r\n\t\t\ttzmax = ( box.max.z - origin.z ) * invdirz;\r\n\r\n\t\t} else {\r\n\r\n\t\t\ttzmin = ( box.max.z - origin.z ) * invdirz;\r\n\t\t\ttzmax = ( box.min.z - origin.z ) * invdirz;\r\n\r\n\t\t}\r\n\r\n\t\tif ( ( tmin > tzmax ) || ( tzmin > tmax ) ) return null;\r\n\r\n\t\tif ( tzmin > tmin || tmin !== tmin ) tmin = tzmin;\r\n\r\n\t\tif ( tzmax < tmax || tmax !== tmax ) tmax = tzmax;\r\n\r\n\t\t//return point closest to the ray (positive side)\r\n\r\n\t\tif ( tmax < 0 ) return null;\r\n\r\n\t\treturn this.at( tmin >= 0 ? tmin : tmax, optionalTarget );\r\n\r\n\t},\r\n\r\n\tintersectTriangle: function () {\r\n\r\n\t\t// Compute the offset origin, edges, and normal.\r\n\t\tvar diff = new THREE.Vector3();\r\n\t\tvar edge1 = new THREE.Vector3();\r\n\t\tvar edge2 = new THREE.Vector3();\r\n\t\tvar normal = new THREE.Vector3();\r\n\r\n\t\treturn function ( a, b, c, backfaceCulling, optionalTarget ) {\r\n\r\n\t\t\t// from http://www.geometrictools.com/LibMathematics/Intersection/Wm5IntrRay3Triangle3.cpp\r\n\r\n\t\t\tedge1.subVectors( b, a );\r\n\t\t\tedge2.subVectors( c, a );\r\n\t\t\tnormal.crossVectors( edge1, edge2 );\r\n\r\n\t\t\t// Solve Q + t*D = b1*E1 + b2*E2 (Q = kDiff, D = ray direction,\r\n\t\t\t// E1 = kEdge1, E2 = kEdge2, N = Cross(E1,E2)) by\r\n\t\t\t//   |Dot(D,N)|*b1 = sign(Dot(D,N))*Dot(D,Cross(Q,E2))\r\n\t\t\t//   |Dot(D,N)|*b2 = sign(Dot(D,N))*Dot(D,Cross(E1,Q))\r\n\t\t\t//   |Dot(D,N)|*t = -sign(Dot(D,N))*Dot(Q,N)\r\n\t\t\tvar DdN = this.direction.dot( normal );\r\n\t\t\tvar sign;\r\n\r\n\t\t\tif ( DdN > 0 ) {\r\n\r\n\t\t\t\tif ( backfaceCulling ) return null;\r\n\t\t\t\tsign = 1;\r\n\r\n\t\t\t} else if ( DdN < 0 ) {\r\n\r\n\t\t\t\tsign = - 1;\r\n\t\t\t\tDdN = - DdN;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\treturn null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tdiff.subVectors( this.origin, a );\r\n\t\t\tvar DdQxE2 = sign * this.direction.dot( edge2.crossVectors( diff, edge2 ) );\r\n\r\n\t\t\t// b1 < 0, no intersection\r\n\t\t\tif ( DdQxE2 < 0 ) {\r\n\r\n\t\t\t\treturn null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar DdE1xQ = sign * this.direction.dot( edge1.cross( diff ) );\r\n\r\n\t\t\t// b2 < 0, no intersection\r\n\t\t\tif ( DdE1xQ < 0 ) {\r\n\r\n\t\t\t\treturn null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// b1+b2 > 1, no intersection\r\n\t\t\tif ( DdQxE2 + DdE1xQ > DdN ) {\r\n\r\n\t\t\t\treturn null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Line intersects triangle, check if ray does.\r\n\t\t\tvar QdN = - sign * diff.dot( normal );\r\n\r\n\t\t\t// t < 0, no intersection\r\n\t\t\tif ( QdN < 0 ) {\r\n\r\n\t\t\t\treturn null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Ray intersects triangle.\r\n\t\t\treturn this.at( QdN / DdN, optionalTarget );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tapplyMatrix4: function ( matrix4 ) {\r\n\r\n\t\tthis.direction.add( this.origin ).applyMatrix4( matrix4 );\r\n\t\tthis.origin.applyMatrix4( matrix4 );\r\n\t\tthis.direction.sub( this.origin );\r\n\t\tthis.direction.normalize();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( ray ) {\r\n\r\n\t\treturn ray.origin.equals( this.origin ) && ray.direction.equals( this.direction );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Sphere.js\r\n\r\n/**\r\n * @author bhouston / http://clara.io\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Sphere = function ( center, radius ) {\r\n\r\n\tthis.center = ( center !== undefined ) ? center : new THREE.Vector3();\r\n\tthis.radius = ( radius !== undefined ) ? radius : 0;\r\n\r\n};\r\n\r\nTHREE.Sphere.prototype = {\r\n\r\n\tconstructor: THREE.Sphere,\r\n\r\n\tset: function ( center, radius ) {\r\n\r\n\t\tthis.center.copy( center );\r\n\t\tthis.radius = radius;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromPoints: function () {\r\n\r\n\t\tvar box = new THREE.Box3();\r\n\r\n\t\treturn function ( points, optionalCenter ) {\r\n\r\n\t\t\tvar center = this.center;\r\n\r\n\t\t\tif ( optionalCenter !== undefined ) {\r\n\r\n\t\t\t\tcenter.copy( optionalCenter );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tbox.setFromPoints( points ).center( center );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar maxRadiusSq = 0;\r\n\r\n\t\t\tfor ( var i = 0, il = points.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( points[ i ] ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.radius = Math.sqrt( maxRadiusSq );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( sphere ) {\r\n\r\n\t\tthis.center.copy( sphere.center );\r\n\t\tthis.radius = sphere.radius;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tempty: function () {\r\n\r\n\t\treturn ( this.radius <= 0 );\r\n\r\n\t},\r\n\r\n\tcontainsPoint: function ( point ) {\r\n\r\n\t\treturn ( point.distanceToSquared( this.center ) <= ( this.radius * this.radius ) );\r\n\r\n\t},\r\n\r\n\tdistanceToPoint: function ( point ) {\r\n\r\n\t\treturn ( point.distanceTo( this.center ) - this.radius );\r\n\r\n\t},\r\n\r\n\tintersectsSphere: function ( sphere ) {\r\n\r\n\t\tvar radiusSum = this.radius + sphere.radius;\r\n\r\n\t\treturn sphere.center.distanceToSquared( this.center ) <= ( radiusSum * radiusSum );\r\n\r\n\t},\r\n\r\n\tclampPoint: function ( point, optionalTarget ) {\r\n\r\n\t\tvar deltaLengthSq = this.center.distanceToSquared( point );\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\tresult.copy( point );\r\n\r\n\t\tif ( deltaLengthSq > ( this.radius * this.radius ) ) {\r\n\r\n\t\t\tresult.sub( this.center ).normalize();\r\n\t\t\tresult.multiplyScalar( this.radius ).add( this.center );\r\n\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\r\n\t},\r\n\r\n\tgetBoundingBox: function ( optionalTarget ) {\r\n\r\n\t\tvar box = optionalTarget || new THREE.Box3();\r\n\r\n\t\tbox.set( this.center, this.center );\r\n\t\tbox.expandByScalar( this.radius );\r\n\r\n\t\treturn box;\r\n\r\n\t},\r\n\r\n\tapplyMatrix4: function ( matrix ) {\r\n\r\n\t\tthis.center.applyMatrix4( matrix );\r\n\t\tthis.radius = this.radius * matrix.getMaxScaleOnAxis();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttranslate: function ( offset ) {\r\n\r\n\t\tthis.center.add( offset );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( sphere ) {\r\n\r\n\t\treturn sphere.center.equals( this.center ) && ( sphere.radius === this.radius );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Frustum.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author bhouston / http://clara.io\r\n */\r\n\r\nTHREE.Frustum = function ( p0, p1, p2, p3, p4, p5 ) {\r\n\r\n\tthis.planes = [\r\n\r\n\t\t( p0 !== undefined ) ? p0 : new THREE.Plane(),\r\n\t\t( p1 !== undefined ) ? p1 : new THREE.Plane(),\r\n\t\t( p2 !== undefined ) ? p2 : new THREE.Plane(),\r\n\t\t( p3 !== undefined ) ? p3 : new THREE.Plane(),\r\n\t\t( p4 !== undefined ) ? p4 : new THREE.Plane(),\r\n\t\t( p5 !== undefined ) ? p5 : new THREE.Plane()\r\n\r\n\t];\r\n\r\n};\r\n\r\nTHREE.Frustum.prototype = {\r\n\r\n\tconstructor: THREE.Frustum,\r\n\r\n\tset: function ( p0, p1, p2, p3, p4, p5 ) {\r\n\r\n\t\tvar planes = this.planes;\r\n\r\n\t\tplanes[ 0 ].copy( p0 );\r\n\t\tplanes[ 1 ].copy( p1 );\r\n\t\tplanes[ 2 ].copy( p2 );\r\n\t\tplanes[ 3 ].copy( p3 );\r\n\t\tplanes[ 4 ].copy( p4 );\r\n\t\tplanes[ 5 ].copy( p5 );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( frustum ) {\r\n\r\n\t\tvar planes = this.planes;\r\n\r\n\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\tplanes[ i ].copy( frustum.planes[ i ] );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromMatrix: function ( m ) {\r\n\r\n\t\tvar planes = this.planes;\r\n\t\tvar me = m.elements;\r\n\t\tvar me0 = me[ 0 ], me1 = me[ 1 ], me2 = me[ 2 ], me3 = me[ 3 ];\r\n\t\tvar me4 = me[ 4 ], me5 = me[ 5 ], me6 = me[ 6 ], me7 = me[ 7 ];\r\n\t\tvar me8 = me[ 8 ], me9 = me[ 9 ], me10 = me[ 10 ], me11 = me[ 11 ];\r\n\t\tvar me12 = me[ 12 ], me13 = me[ 13 ], me14 = me[ 14 ], me15 = me[ 15 ];\r\n\r\n\t\tplanes[ 0 ].setComponents( me3 - me0, me7 - me4, me11 - me8, me15 - me12 ).normalize();\r\n\t\tplanes[ 1 ].setComponents( me3 + me0, me7 + me4, me11 + me8, me15 + me12 ).normalize();\r\n\t\tplanes[ 2 ].setComponents( me3 + me1, me7 + me5, me11 + me9, me15 + me13 ).normalize();\r\n\t\tplanes[ 3 ].setComponents( me3 - me1, me7 - me5, me11 - me9, me15 - me13 ).normalize();\r\n\t\tplanes[ 4 ].setComponents( me3 - me2, me7 - me6, me11 - me10, me15 - me14 ).normalize();\r\n\t\tplanes[ 5 ].setComponents( me3 + me2, me7 + me6, me11 + me10, me15 + me14 ).normalize();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tintersectsObject: function () {\r\n\r\n\t\tvar sphere = new THREE.Sphere();\r\n\r\n\t\treturn function ( object ) {\r\n\r\n\t\t\tvar geometry = object.geometry;\r\n\r\n\t\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\r\n\r\n\t\t\tsphere.copy( geometry.boundingSphere );\r\n\t\t\tsphere.applyMatrix4( object.matrixWorld );\r\n\r\n\t\t\treturn this.intersectsSphere( sphere );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tintersectsSphere: function ( sphere ) {\r\n\r\n\t\tvar planes = this.planes;\r\n\t\tvar center = sphere.center;\r\n\t\tvar negRadius = - sphere.radius;\r\n\r\n\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\tvar distance = planes[ i ].distanceToPoint( center );\r\n\r\n\t\t\tif ( distance < negRadius ) {\r\n\r\n\t\t\t\treturn false;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t},\r\n\r\n\tintersectsBox: function () {\r\n\r\n\t\tvar p1 = new THREE.Vector3(),\r\n\t\t\tp2 = new THREE.Vector3();\r\n\r\n\t\treturn function ( box ) {\r\n\r\n\t\t\tvar planes = this.planes;\r\n\r\n\t\t\tfor ( var i = 0; i < 6 ; i ++ ) {\r\n\r\n\t\t\t\tvar plane = planes[ i ];\r\n\r\n\t\t\t\tp1.x = plane.normal.x > 0 ? box.min.x : box.max.x;\r\n\t\t\t\tp2.x = plane.normal.x > 0 ? box.max.x : box.min.x;\r\n\t\t\t\tp1.y = plane.normal.y > 0 ? box.min.y : box.max.y;\r\n\t\t\t\tp2.y = plane.normal.y > 0 ? box.max.y : box.min.y;\r\n\t\t\t\tp1.z = plane.normal.z > 0 ? box.min.z : box.max.z;\r\n\t\t\t\tp2.z = plane.normal.z > 0 ? box.max.z : box.min.z;\r\n\r\n\t\t\t\tvar d1 = plane.distanceToPoint( p1 );\r\n\t\t\t\tvar d2 = plane.distanceToPoint( p2 );\r\n\r\n\t\t\t\t// if both outside plane, no intersection\r\n\r\n\t\t\t\tif ( d1 < 0 && d2 < 0 ) {\r\n\r\n\t\t\t\t\treturn false;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\r\n\tcontainsPoint: function ( point ) {\r\n\r\n\t\tvar planes = this.planes;\r\n\r\n\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\tif ( planes[ i ].distanceToPoint( point ) < 0 ) {\r\n\r\n\t\t\t\treturn false;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Plane.js\r\n\r\n/**\r\n * @author bhouston / http://clara.io\r\n */\r\n\r\nTHREE.Plane = function ( normal, constant ) {\r\n\r\n\tthis.normal = ( normal !== undefined ) ? normal : new THREE.Vector3( 1, 0, 0 );\r\n\tthis.constant = ( constant !== undefined ) ? constant : 0;\r\n\r\n};\r\n\r\nTHREE.Plane.prototype = {\r\n\r\n\tconstructor: THREE.Plane,\r\n\r\n\tset: function ( normal, constant ) {\r\n\r\n\t\tthis.normal.copy( normal );\r\n\t\tthis.constant = constant;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetComponents: function ( x, y, z, w ) {\r\n\r\n\t\tthis.normal.set( x, y, z );\r\n\t\tthis.constant = w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromNormalAndCoplanarPoint: function ( normal, point ) {\r\n\r\n\t\tthis.normal.copy( normal );\r\n\t\tthis.constant = - point.dot( this.normal );\t// must be this.normal, not normal, as this.normal is normalized\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromCoplanarPoints: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\t\tvar v2 = new THREE.Vector3();\r\n\r\n\t\treturn function ( a, b, c ) {\r\n\r\n\t\t\tvar normal = v1.subVectors( c, b ).cross( v2.subVectors( a, b ) ).normalize();\r\n\r\n\t\t\t// Q: should an error be thrown if normal is zero (e.g. degenerate plane)?\r\n\r\n\t\t\tthis.setFromNormalAndCoplanarPoint( normal, a );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( plane ) {\r\n\r\n\t\tthis.normal.copy( plane.normal );\r\n\t\tthis.constant = plane.constant;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tnormalize: function () {\r\n\r\n\t\t// Note: will lead to a divide by zero if the plane is invalid.\r\n\r\n\t\tvar inverseNormalLength = 1.0 / this.normal.length();\r\n\t\tthis.normal.multiplyScalar( inverseNormalLength );\r\n\t\tthis.constant *= inverseNormalLength;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tnegate: function () {\r\n\r\n\t\tthis.constant *= - 1;\r\n\t\tthis.normal.negate();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdistanceToPoint: function ( point ) {\r\n\r\n\t\treturn this.normal.dot( point ) + this.constant;\r\n\r\n\t},\r\n\r\n\tdistanceToSphere: function ( sphere ) {\r\n\r\n\t\treturn this.distanceToPoint( sphere.center ) - sphere.radius;\r\n\r\n\t},\r\n\r\n\tprojectPoint: function ( point, optionalTarget ) {\r\n\r\n\t\treturn this.orthoPoint( point, optionalTarget ).sub( point ).negate();\r\n\r\n\t},\r\n\r\n\torthoPoint: function ( point, optionalTarget ) {\r\n\r\n\t\tvar perpendicularMagnitude = this.distanceToPoint( point );\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\treturn result.copy( this.normal ).multiplyScalar( perpendicularMagnitude );\r\n\r\n\t},\r\n\r\n\tisIntersectionLine: function ( line ) {\r\n\r\n\t\t// Note: this tests if a line intersects the plane, not whether it (or its end-points) are coplanar with it.\r\n\r\n\t\tvar startSign = this.distanceToPoint( line.start );\r\n\t\tvar endSign = this.distanceToPoint( line.end );\r\n\r\n\t\treturn ( startSign < 0 && endSign > 0 ) || ( endSign < 0 && startSign > 0 );\r\n\r\n\t},\r\n\r\n\tintersectLine: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function ( line, optionalTarget ) {\r\n\r\n\t\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\t\tvar direction = line.delta( v1 );\r\n\r\n\t\t\tvar denominator = this.normal.dot( direction );\r\n\r\n\t\t\tif ( denominator === 0 ) {\r\n\r\n\t\t\t\t// line is coplanar, return origin\r\n\t\t\t\tif ( this.distanceToPoint( line.start ) === 0 ) {\r\n\r\n\t\t\t\t\treturn result.copy( line.start );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Unsure if this is the correct method to handle this case.\r\n\t\t\t\treturn undefined;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar t = - ( line.start.dot( this.normal ) + this.constant ) / denominator;\r\n\r\n\t\t\tif ( t < 0 || t > 1 ) {\r\n\r\n\t\t\t\treturn undefined;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn result.copy( direction ).multiplyScalar( t ).add( line.start );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\r\n\tcoplanarPoint: function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\treturn result.copy( this.normal ).multiplyScalar( - this.constant );\r\n\r\n\t},\r\n\r\n\tapplyMatrix4: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\t\tvar v2 = new THREE.Vector3();\r\n\t\tvar m1 = new THREE.Matrix3();\r\n\r\n\t\treturn function ( matrix, optionalNormalMatrix ) {\r\n\r\n\t\t\t// compute new normal based on theory here:\r\n\t\t\t// http://www.songho.ca/opengl/gl_normaltransform.html\r\n\t\t\tvar normalMatrix = optionalNormalMatrix || m1.getNormalMatrix( matrix );\r\n\t\t\tvar newNormal = v1.copy( this.normal ).applyMatrix3( normalMatrix );\r\n\r\n\t\t\tvar newCoplanarPoint = this.coplanarPoint( v2 );\r\n\t\t\tnewCoplanarPoint.applyMatrix4( matrix );\r\n\r\n\t\t\tthis.setFromNormalAndCoplanarPoint( newNormal, newCoplanarPoint );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\ttranslate: function ( offset ) {\r\n\r\n\t\tthis.constant = this.constant - offset.dot( this.normal );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( plane ) {\r\n\r\n\t\treturn plane.normal.equals( this.normal ) && ( plane.constant === this.constant );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Math.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Math = {\r\n\r\n\tgenerateUUID: function () {\r\n\r\n\t\t// http://www.broofa.com/Tools/Math.uuid.htm\r\n\r\n\t\tvar chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.split( '' );\r\n\t\tvar uuid = new Array( 36 );\r\n\t\tvar rnd = 0, r;\r\n\r\n\t\treturn function () {\r\n\r\n\t\t\tfor ( var i = 0; i < 36; i ++ ) {\r\n\r\n\t\t\t\tif ( i === 8 || i === 13 || i === 18 || i === 23 ) {\r\n\r\n\t\t\t\t\tuuid[ i ] = '-';\r\n\r\n\t\t\t\t} else if ( i === 14 ) {\r\n\r\n\t\t\t\t\tuuid[ i ] = '4';\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tif ( rnd <= 0x02 ) rnd = 0x2000000 + ( Math.random() * 0x1000000 ) | 0;\r\n\t\t\t\t\tr = rnd & 0xf;\r\n\t\t\t\t\trnd = rnd >> 4;\r\n\t\t\t\t\tuuid[ i ] = chars[ ( i === 19 ) ? ( r & 0x3 ) | 0x8 : r ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn uuid.join( '' );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tclamp: function ( value, min, max ) {\r\n\r\n\t\treturn Math.max( min, Math.min( max, value ) );\r\n\r\n\t},\r\n\r\n\t// compute euclidian modulo of m % n\r\n\t// https://en.wikipedia.org/wiki/Modulo_operation\r\n\r\n\teuclideanModulo: function ( n, m ) {\r\n\r\n\t\treturn ( ( n % m ) + m ) % m;\r\n\r\n\t},\r\n\r\n\t// Linear mapping from range <a1, a2> to range <b1, b2>\r\n\r\n\tmapLinear: function ( x, a1, a2, b1, b2 ) {\r\n\r\n\t\treturn b1 + ( x - a1 ) * ( b2 - b1 ) / ( a2 - a1 );\r\n\r\n\t},\r\n\r\n\t// http://en.wikipedia.org/wiki/Smoothstep\r\n\r\n\tsmoothstep: function ( x, min, max ) {\r\n\r\n\t\tif ( x <= min ) return 0;\r\n\t\tif ( x >= max ) return 1;\r\n\r\n\t\tx = ( x - min ) / ( max - min );\r\n\r\n\t\treturn x * x * ( 3 - 2 * x );\r\n\r\n\t},\r\n\r\n\tsmootherstep: function ( x, min, max ) {\r\n\r\n\t\tif ( x <= min ) return 0;\r\n\t\tif ( x >= max ) return 1;\r\n\r\n\t\tx = ( x - min ) / ( max - min );\r\n\r\n\t\treturn x * x * x * ( x * ( x * 6 - 15 ) + 10 );\r\n\r\n\t},\r\n\r\n\t// Random float from <0, 1> with 16 bits of randomness\r\n\t// (standard Math.random() creates repetitive patterns when applied over larger space)\r\n\r\n\trandom16: function () {\r\n\r\n\t\treturn ( 65280 * Math.random() + 255 * Math.random() ) / 65535;\r\n\r\n\t},\r\n\r\n\t// Random integer from <low, high> interval\r\n\r\n\trandInt: function ( low, high ) {\r\n\r\n\t\treturn low + Math.floor( Math.random() * ( high - low + 1 ) );\r\n\r\n\t},\r\n\r\n\t// Random float from <low, high> interval\r\n\r\n\trandFloat: function ( low, high ) {\r\n\r\n\t\treturn low + Math.random() * ( high - low );\r\n\r\n\t},\r\n\r\n\t// Random float from <-range/2, range/2> interval\r\n\r\n\trandFloatSpread: function ( range ) {\r\n\r\n\t\treturn range * ( 0.5 - Math.random() );\r\n\r\n\t},\r\n\r\n\tdegToRad: function () {\r\n\r\n\t\tvar degreeToRadiansFactor = Math.PI / 180;\r\n\r\n\t\treturn function ( degrees ) {\r\n\r\n\t\t\treturn degrees * degreeToRadiansFactor;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tradToDeg: function () {\r\n\r\n\t\tvar radianToDegreesFactor = 180 / Math.PI;\r\n\r\n\t\treturn function ( radians ) {\r\n\r\n\t\t\treturn radians * radianToDegreesFactor;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tisPowerOfTwo: function ( value ) {\r\n\r\n\t\treturn ( value & ( value - 1 ) ) === 0 && value !== 0;\r\n\r\n\t},\r\n\r\n\tnearestPowerOfTwo: function ( value ) {\r\n\r\n\t\treturn Math.pow( 2, Math.round( Math.log( value ) / Math.LN2 ) );\r\n\r\n\t},\r\n\r\n\tnextPowerOfTwo: function ( value ) {\r\n\r\n\t\tvalue --;\r\n\t\tvalue |= value >> 1;\r\n\t\tvalue |= value >> 2;\r\n\t\tvalue |= value >> 4;\r\n\t\tvalue |= value >> 8;\r\n\t\tvalue |= value >> 16;\r\n\t\tvalue ++;\r\n\r\n\t\treturn value;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Spline.js\r\n\r\n/**\r\n * Spline from Tween.js, slightly optimized (and trashed)\r\n * http://sole.github.com/tween.js/examples/05_spline.html\r\n *\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Spline = function ( points ) {\r\n\r\n\tthis.points = points;\r\n\r\n\tvar c = [], v3 = { x: 0, y: 0, z: 0 },\r\n\tpoint, intPoint, weight, w2, w3,\r\n\tpa, pb, pc, pd;\r\n\r\n\tthis.initFromArray = function ( a ) {\r\n\r\n\t\tthis.points = [];\r\n\r\n\t\tfor ( var i = 0; i < a.length; i ++ ) {\r\n\r\n\t\t\tthis.points[ i ] = { x: a[ i ][ 0 ], y: a[ i ][ 1 ], z: a[ i ][ 2 ] };\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.getPoint = function ( k ) {\r\n\r\n\t\tpoint = ( this.points.length - 1 ) * k;\r\n\t\tintPoint = Math.floor( point );\r\n\t\tweight = point - intPoint;\r\n\r\n\t\tc[ 0 ] = intPoint === 0 ? intPoint : intPoint - 1;\r\n\t\tc[ 1 ] = intPoint;\r\n\t\tc[ 2 ] = intPoint  > this.points.length - 2 ? this.points.length - 1 : intPoint + 1;\r\n\t\tc[ 3 ] = intPoint  > this.points.length - 3 ? this.points.length - 1 : intPoint + 2;\r\n\r\n\t\tpa = this.points[ c[ 0 ] ];\r\n\t\tpb = this.points[ c[ 1 ] ];\r\n\t\tpc = this.points[ c[ 2 ] ];\r\n\t\tpd = this.points[ c[ 3 ] ];\r\n\r\n\t\tw2 = weight * weight;\r\n\t\tw3 = weight * w2;\r\n\r\n\t\tv3.x = interpolate( pa.x, pb.x, pc.x, pd.x, weight, w2, w3 );\r\n\t\tv3.y = interpolate( pa.y, pb.y, pc.y, pd.y, weight, w2, w3 );\r\n\t\tv3.z = interpolate( pa.z, pb.z, pc.z, pd.z, weight, w2, w3 );\r\n\r\n\t\treturn v3;\r\n\r\n\t};\r\n\r\n\tthis.getControlPointsArray = function () {\r\n\r\n\t\tvar i, p, l = this.points.length,\r\n\t\t\tcoords = [];\r\n\r\n\t\tfor ( i = 0; i < l; i ++ ) {\r\n\r\n\t\t\tp = this.points[ i ];\r\n\t\t\tcoords[ i ] = [ p.x, p.y, p.z ];\r\n\r\n\t\t}\r\n\r\n\t\treturn coords;\r\n\r\n\t};\r\n\r\n\t// approximate length by summing linear segments\r\n\r\n\tthis.getLength = function ( nSubDivisions ) {\r\n\r\n\t\tvar i, index, nSamples, position,\r\n\t\t\tpoint = 0, intPoint = 0, oldIntPoint = 0,\r\n\t\t\toldPosition = new THREE.Vector3(),\r\n\t\t\ttmpVec = new THREE.Vector3(),\r\n\t\t\tchunkLengths = [],\r\n\t\t\ttotalLength = 0;\r\n\r\n\t\t// first point has 0 length\r\n\r\n\t\tchunkLengths[ 0 ] = 0;\r\n\r\n\t\tif ( ! nSubDivisions ) nSubDivisions = 100;\r\n\r\n\t\tnSamples = this.points.length * nSubDivisions;\r\n\r\n\t\toldPosition.copy( this.points[ 0 ] );\r\n\r\n\t\tfor ( i = 1; i < nSamples; i ++ ) {\r\n\r\n\t\t\tindex = i / nSamples;\r\n\r\n\t\t\tposition = this.getPoint( index );\r\n\t\t\ttmpVec.copy( position );\r\n\r\n\t\t\ttotalLength += tmpVec.distanceTo( oldPosition );\r\n\r\n\t\t\toldPosition.copy( position );\r\n\r\n\t\t\tpoint = ( this.points.length - 1 ) * index;\r\n\t\t\tintPoint = Math.floor( point );\r\n\r\n\t\t\tif ( intPoint !== oldIntPoint ) {\r\n\r\n\t\t\t\tchunkLengths[ intPoint ] = totalLength;\r\n\t\t\t\toldIntPoint = intPoint;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// last point ends with total length\r\n\r\n\t\tchunkLengths[ chunkLengths.length ] = totalLength;\r\n\r\n\t\treturn { chunks: chunkLengths, total: totalLength };\r\n\r\n\t};\r\n\r\n\tthis.reparametrizeByArcLength = function ( samplingCoef ) {\r\n\r\n\t\tvar i, j,\r\n\t\t\tindex, indexCurrent, indexNext,\r\n\t\t\trealDistance,\r\n\t\t\tsampling, position,\r\n\t\t\tnewpoints = [],\r\n\t\t\ttmpVec = new THREE.Vector3(),\r\n\t\t\tsl = this.getLength();\r\n\r\n\t\tnewpoints.push( tmpVec.copy( this.points[ 0 ] ).clone() );\r\n\r\n\t\tfor ( i = 1; i < this.points.length; i ++ ) {\r\n\r\n\t\t\t//tmpVec.copy( this.points[ i - 1 ] );\r\n\t\t\t//linearDistance = tmpVec.distanceTo( this.points[ i ] );\r\n\r\n\t\t\trealDistance = sl.chunks[ i ] - sl.chunks[ i - 1 ];\r\n\r\n\t\t\tsampling = Math.ceil( samplingCoef * realDistance / sl.total );\r\n\r\n\t\t\tindexCurrent = ( i - 1 ) / ( this.points.length - 1 );\r\n\t\t\tindexNext = i / ( this.points.length - 1 );\r\n\r\n\t\t\tfor ( j = 1; j < sampling - 1; j ++ ) {\r\n\r\n\t\t\t\tindex = indexCurrent + j * ( 1 / sampling ) * ( indexNext - indexCurrent );\r\n\r\n\t\t\t\tposition = this.getPoint( index );\r\n\t\t\t\tnewpoints.push( tmpVec.copy( position ).clone() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tnewpoints.push( tmpVec.copy( this.points[ i ] ).clone() );\r\n\r\n\t\t}\r\n\r\n\t\tthis.points = newpoints;\r\n\r\n\t};\r\n\r\n\t// Catmull-Rom\r\n\r\n\tfunction interpolate( p0, p1, p2, p3, t, t2, t3 ) {\r\n\r\n\t\tvar v0 = ( p2 - p0 ) * 0.5,\r\n\t\t\tv1 = ( p3 - p1 ) * 0.5;\r\n\r\n\t\treturn ( 2 * ( p1 - p2 ) + v0 + v1 ) * t3 + ( - 3 * ( p1 - p2 ) - 2 * v0 - v1 ) * t2 + v0 * t + p1;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Triangle.js\r\n\r\n/**\r\n * @author bhouston / http://clara.io\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Triangle = function ( a, b, c ) {\r\n\r\n\tthis.a = ( a !== undefined ) ? a : new THREE.Vector3();\r\n\tthis.b = ( b !== undefined ) ? b : new THREE.Vector3();\r\n\tthis.c = ( c !== undefined ) ? c : new THREE.Vector3();\r\n\r\n};\r\n\r\nTHREE.Triangle.normal = function () {\r\n\r\n\tvar v0 = new THREE.Vector3();\r\n\r\n\treturn function ( a, b, c, optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\tresult.subVectors( c, b );\r\n\t\tv0.subVectors( a, b );\r\n\t\tresult.cross( v0 );\r\n\r\n\t\tvar resultLengthSq = result.lengthSq();\r\n\t\tif ( resultLengthSq > 0 ) {\r\n\r\n\t\t\treturn result.multiplyScalar( 1 / Math.sqrt( resultLengthSq ) );\r\n\r\n\t\t}\r\n\r\n\t\treturn result.set( 0, 0, 0 );\r\n\r\n\t};\r\n\r\n}();\r\n\r\n// static/instance method to calculate barycentric coordinates\r\n// based on: http://www.blackpawn.com/texts/pointinpoly/default.html\r\nTHREE.Triangle.barycoordFromPoint = function () {\r\n\r\n\tvar v0 = new THREE.Vector3();\r\n\tvar v1 = new THREE.Vector3();\r\n\tvar v2 = new THREE.Vector3();\r\n\r\n\treturn function ( point, a, b, c, optionalTarget ) {\r\n\r\n\t\tv0.subVectors( c, a );\r\n\t\tv1.subVectors( b, a );\r\n\t\tv2.subVectors( point, a );\r\n\r\n\t\tvar dot00 = v0.dot( v0 );\r\n\t\tvar dot01 = v0.dot( v1 );\r\n\t\tvar dot02 = v0.dot( v2 );\r\n\t\tvar dot11 = v1.dot( v1 );\r\n\t\tvar dot12 = v1.dot( v2 );\r\n\r\n\t\tvar denom = ( dot00 * dot11 - dot01 * dot01 );\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\t// collinear or singular triangle\r\n\t\tif ( denom === 0 ) {\r\n\r\n\t\t\t// arbitrary location outside of triangle?\r\n\t\t\t// not sure if this is the best idea, maybe should be returning undefined\r\n\t\t\treturn result.set( - 2, - 1, - 1 );\r\n\r\n\t\t}\r\n\r\n\t\tvar invDenom = 1 / denom;\r\n\t\tvar u = ( dot11 * dot02 - dot01 * dot12 ) * invDenom;\r\n\t\tvar v = ( dot00 * dot12 - dot01 * dot02 ) * invDenom;\r\n\r\n\t\t// barycentric coordinates must always sum to 1\r\n\t\treturn result.set( 1 - u - v, v, u );\r\n\r\n\t};\r\n\r\n}();\r\n\r\nTHREE.Triangle.containsPoint = function () {\r\n\r\n\tvar v1 = new THREE.Vector3();\r\n\r\n\treturn function ( point, a, b, c ) {\r\n\r\n\t\tvar result = THREE.Triangle.barycoordFromPoint( point, a, b, c, v1 );\r\n\r\n\t\treturn ( result.x >= 0 ) && ( result.y >= 0 ) && ( ( result.x + result.y ) <= 1 );\r\n\r\n\t};\r\n\r\n}();\r\n\r\nTHREE.Triangle.prototype = {\r\n\r\n\tconstructor: THREE.Triangle,\r\n\r\n\tset: function ( a, b, c ) {\r\n\r\n\t\tthis.a.copy( a );\r\n\t\tthis.b.copy( b );\r\n\t\tthis.c.copy( c );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromPointsAndIndices: function ( points, i0, i1, i2 ) {\r\n\r\n\t\tthis.a.copy( points[ i0 ] );\r\n\t\tthis.b.copy( points[ i1 ] );\r\n\t\tthis.c.copy( points[ i2 ] );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( triangle ) {\r\n\r\n\t\tthis.a.copy( triangle.a );\r\n\t\tthis.b.copy( triangle.b );\r\n\t\tthis.c.copy( triangle.c );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tarea: function () {\r\n\r\n\t\tvar v0 = new THREE.Vector3();\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function () {\r\n\r\n\t\t\tv0.subVectors( this.c, this.b );\r\n\t\t\tv1.subVectors( this.a, this.b );\r\n\r\n\t\t\treturn v0.cross( v1 ).length() * 0.5;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tmidpoint: function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\treturn result.addVectors( this.a, this.b ).add( this.c ).multiplyScalar( 1 / 3 );\r\n\r\n\t},\r\n\r\n\tnormal: function ( optionalTarget ) {\r\n\r\n\t\treturn THREE.Triangle.normal( this.a, this.b, this.c, optionalTarget );\r\n\r\n\t},\r\n\r\n\tplane: function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Plane();\r\n\r\n\t\treturn result.setFromCoplanarPoints( this.a, this.b, this.c );\r\n\r\n\t},\r\n\r\n\tbarycoordFromPoint: function ( point, optionalTarget ) {\r\n\r\n\t\treturn THREE.Triangle.barycoordFromPoint( point, this.a, this.b, this.c, optionalTarget );\r\n\r\n\t},\r\n\r\n\tcontainsPoint: function ( point ) {\r\n\r\n\t\treturn THREE.Triangle.containsPoint( point, this.a, this.b, this.c );\r\n\r\n\t},\r\n\r\n\tequals: function ( triangle ) {\r\n\r\n\t\treturn triangle.a.equals( this.a ) && triangle.b.equals( this.b ) && triangle.c.equals( this.c );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/core/Channels.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Channels = function () {\r\n\r\n\tthis.mask = 1;\r\n\r\n};\r\n\r\nTHREE.Channels.prototype = {\r\n\r\n\tconstructor: THREE.Channels,\r\n\r\n\tset: function ( channel ) {\r\n\r\n\t\tthis.mask = 1 << channel;\r\n\r\n\t},\r\n\r\n\tenable: function ( channel ) {\r\n\r\n\t\tthis.mask |= 1 << channel;\r\n\r\n\t},\r\n\r\n\ttoggle: function ( channel ) {\r\n\r\n\t\tthis.mask ^= 1 << channel;\r\n\r\n\t},\r\n\r\n\tdisable: function ( channel ) {\r\n\r\n\t\tthis.mask &= ~ ( 1 << channel );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/core/Clock.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Clock = function ( autoStart ) {\r\n\r\n\tthis.autoStart = ( autoStart !== undefined ) ? autoStart : true;\r\n\r\n\tthis.startTime = 0;\r\n\tthis.oldTime = 0;\r\n\tthis.elapsedTime = 0;\r\n\r\n\tthis.running = false;\r\n\r\n};\r\n\r\nTHREE.Clock.prototype = {\r\n\r\n\tconstructor: THREE.Clock,\r\n\r\n\tstart: function () {\r\n\r\n\t\tthis.startTime = self.performance.now();\r\n\r\n\t\tthis.oldTime = this.startTime;\r\n\t\tthis.running = true;\r\n\r\n\t},\r\n\r\n\tstop: function () {\r\n\r\n\t\tthis.getElapsedTime();\r\n\t\tthis.running = false;\r\n\r\n\t},\r\n\r\n\tgetElapsedTime: function () {\r\n\r\n\t\tthis.getDelta();\r\n\t\treturn this.elapsedTime;\r\n\r\n\t},\r\n\r\n\tgetDelta: function () {\r\n\r\n\t\tvar diff = 0;\r\n\r\n\t\tif ( this.autoStart && ! this.running ) {\r\n\r\n\t\t\tthis.start();\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.running ) {\r\n\r\n\t\t\tvar newTime = self.performance.now();\r\n\r\n\t\t\tdiff = 0.001 * ( newTime - this.oldTime );\r\n\t\t\tthis.oldTime = newTime;\r\n\r\n\t\t\tthis.elapsedTime += diff;\r\n\r\n\t\t}\r\n\r\n\t\treturn diff;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/core/EventDispatcher.js\r\n\r\n/**\r\n * https://github.com/mrdoob/eventdispatcher.js/\r\n */\r\n\r\nTHREE.EventDispatcher = function () {};\r\n\r\nTHREE.EventDispatcher.prototype = {\r\n\r\n\tconstructor: THREE.EventDispatcher,\r\n\r\n\tapply: function ( object ) {\r\n\r\n\t\tobject.addEventListener = THREE.EventDispatcher.prototype.addEventListener;\r\n\t\tobject.hasEventListener = THREE.EventDispatcher.prototype.hasEventListener;\r\n\t\tobject.removeEventListener = THREE.EventDispatcher.prototype.removeEventListener;\r\n\t\tobject.dispatchEvent = THREE.EventDispatcher.prototype.dispatchEvent;\r\n\r\n\t},\r\n\r\n\taddEventListener: function ( type, listener ) {\r\n\r\n\t\tif ( this._listeners === undefined ) this._listeners = {};\r\n\r\n\t\tvar listeners = this._listeners;\r\n\r\n\t\tif ( listeners[ type ] === undefined ) {\r\n\r\n\t\t\tlisteners[ type ] = [];\r\n\r\n\t\t}\r\n\r\n\t\tif ( listeners[ type ].indexOf( listener ) === - 1 ) {\r\n\r\n\t\t\tlisteners[ type ].push( listener );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\thasEventListener: function ( type, listener ) {\r\n\r\n\t\tif ( this._listeners === undefined ) return false;\r\n\r\n\t\tvar listeners = this._listeners;\r\n\r\n\t\tif ( listeners[ type ] !== undefined && listeners[ type ].indexOf( listener ) !== - 1 ) {\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\r\n\t},\r\n\r\n\tremoveEventListener: function ( type, listener ) {\r\n\r\n\t\tif ( this._listeners === undefined ) return;\r\n\r\n\t\tvar listeners = this._listeners;\r\n\t\tvar listenerArray = listeners[ type ];\r\n\r\n\t\tif ( listenerArray !== undefined ) {\r\n\r\n\t\t\tvar index = listenerArray.indexOf( listener );\r\n\r\n\t\t\tif ( index !== - 1 ) {\r\n\r\n\t\t\t\tlistenerArray.splice( index, 1 );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tdispatchEvent: function ( event ) {\r\n\r\n\t\tif ( this._listeners === undefined ) return;\r\n\r\n\t\tvar listeners = this._listeners;\r\n\t\tvar listenerArray = listeners[ event.type ];\r\n\r\n\t\tif ( listenerArray !== undefined ) {\r\n\r\n\t\t\tevent.target = this;\r\n\r\n\t\t\tvar array = [];\r\n\t\t\tvar length = listenerArray.length;\r\n\r\n\t\t\tfor ( var i = 0; i < length; i ++ ) {\r\n\r\n\t\t\t\tarray[ i ] = listenerArray[ i ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var i = 0; i < length; i ++ ) {\r\n\r\n\t\t\t\tarray[ i ].call( this, event );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/core/Raycaster.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author bhouston / http://clara.io/\r\n * @author stephomi / http://stephaneginier.com/\r\n */\r\n\r\n( function ( THREE ) {\r\n\r\n\tTHREE.Raycaster = function ( origin, direction, near, far ) {\r\n\r\n\t\tthis.ray = new THREE.Ray( origin, direction );\r\n\t\t// direction is assumed to be normalized (for accurate distance calculations)\r\n\r\n\t\tthis.near = near || 0;\r\n\t\tthis.far = far || Infinity;\r\n\r\n\t\tthis.params = {\r\n\t\t\tMesh: {},\r\n\t\t\tLine: {},\r\n\t\t\tLOD: {},\r\n\t\t\tPoints: { threshold: 1 },\r\n\t\t\tSprite: {}\r\n\t\t};\r\n\r\n\t\tObject.defineProperties( this.params, {\r\n\t\t\tPointCloud: {\r\n\t\t\t\tget: function () {\r\n\t\t\t\t\tconsole.warn( 'THREE.Raycaster: params.PointCloud has been renamed to params.Points.' );\r\n\t\t\t\t\treturn this.Points;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} );\r\n\r\n\t};\r\n\r\n\tfunction descSort( a, b ) {\r\n\r\n\t\treturn a.distance - b.distance;\r\n\r\n\t}\r\n\r\n\tfunction intersectObject( object, raycaster, intersects, recursive ) {\r\n\r\n\t\tif ( object.visible === false ) return;\r\n\r\n\t\tobject.raycast( raycaster, intersects );\r\n\r\n\t\tif ( recursive === true ) {\r\n\r\n\t\t\tvar children = object.children;\r\n\r\n\t\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tintersectObject( children[ i ], raycaster, intersects, true );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tTHREE.Raycaster.prototype = {\r\n\r\n\t\tconstructor: THREE.Raycaster,\r\n\r\n\t\tlinePrecision: 1,\r\n\r\n\t\tset: function ( origin, direction ) {\r\n\r\n\t\t\t// direction is assumed to be normalized (for accurate distance calculations)\r\n\r\n\t\t\tthis.ray.set( origin, direction );\r\n\r\n\t\t},\r\n\r\n\t\tsetFromCamera: function ( coords, camera ) {\r\n\r\n\t\t\tif ( camera instanceof THREE.PerspectiveCamera ) {\r\n\r\n\t\t\t\tthis.ray.origin.setFromMatrixPosition( camera.matrixWorld );\r\n\t\t\t\tthis.ray.direction.set( coords.x, coords.y, 0.5 ).unproject( camera ).sub( this.ray.origin ).normalize();\r\n\r\n\t\t\t} else if ( camera instanceof THREE.OrthographicCamera ) {\r\n\r\n\t\t\t\tthis.ray.origin.set( coords.x, coords.y, - 1 ).unproject( camera );\r\n\t\t\t\tthis.ray.direction.set( 0, 0, - 1 ).transformDirection( camera.matrixWorld );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tconsole.error( 'THREE.Raycaster: Unsupported camera type.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tintersectObject: function ( object, recursive ) {\r\n\r\n\t\t\tvar intersects = [];\r\n\r\n\t\t\tintersectObject( object, this, intersects, recursive );\r\n\r\n\t\t\tintersects.sort( descSort );\r\n\r\n\t\t\treturn intersects;\r\n\r\n\t\t},\r\n\r\n\t\tintersectObjects: function ( objects, recursive ) {\r\n\r\n\t\t\tvar intersects = [];\r\n\r\n\t\t\tif ( Array.isArray( objects ) === false ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Raycaster.intersectObjects: objects is not an Array.' );\r\n\t\t\t\treturn intersects;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var i = 0, l = objects.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tintersectObject( objects[ i ], this, intersects, recursive );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tintersects.sort( descSort );\r\n\r\n\t\t\treturn intersects;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n}( THREE ) );\r\n\r\n// File:src/core/Object3D.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n * @author elephantatwork / www.elephantatwork.ch\r\n */\r\n\r\nTHREE.Object3D = function () {\r\n\r\n\tObject.defineProperty( this, 'id', { value: THREE.Object3DIdCount ++ } );\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\tthis.name = '';\r\n\tthis.type = 'Object3D';\r\n\r\n\tthis.parent = null;\r\n\tthis.channels = new THREE.Channels();\r\n\tthis.children = [];\r\n\r\n\tthis.up = THREE.Object3D.DefaultUp.clone();\r\n\r\n\tvar position = new THREE.Vector3();\r\n\tvar rotation = new THREE.Euler();\r\n\tvar quaternion = new THREE.Quaternion();\r\n\tvar scale = new THREE.Vector3( 1, 1, 1 );\r\n\r\n\tfunction onRotationChange() {\r\n\r\n\t\tquaternion.setFromEuler( rotation, false );\r\n\r\n\t}\r\n\r\n\tfunction onQuaternionChange() {\r\n\r\n\t\trotation.setFromQuaternion( quaternion, undefined, false );\r\n\r\n\t}\r\n\r\n\trotation.onChange( onRotationChange );\r\n\tquaternion.onChange( onQuaternionChange );\r\n\r\n\tObject.defineProperties( this, {\r\n\t\tposition: {\r\n\t\t\tenumerable: true,\r\n\t\t\tvalue: position\r\n\t\t},\r\n\t\trotation: {\r\n\t\t\tenumerable: true,\r\n\t\t\tvalue: rotation\r\n\t\t},\r\n\t\tquaternion: {\r\n\t\t\tenumerable: true,\r\n\t\t\tvalue: quaternion\r\n\t\t},\r\n\t\tscale: {\r\n\t\t\tenumerable: true,\r\n\t\t\tvalue: scale\r\n\t\t},\r\n\t\tmodelViewMatrix: {\r\n\t\t\tvalue: new THREE.Matrix4()\r\n\t\t},\r\n\t\tnormalMatrix: {\r\n\t\t\tvalue: new THREE.Matrix3()\r\n\t\t}\r\n\t} );\r\n\r\n\tthis.rotationAutoUpdate = true;\r\n\r\n\tthis.matrix = new THREE.Matrix4();\r\n\tthis.matrixWorld = new THREE.Matrix4();\r\n\r\n\tthis.matrixAutoUpdate = THREE.Object3D.DefaultMatrixAutoUpdate;\r\n\tthis.matrixWorldNeedsUpdate = false;\r\n\r\n\tthis.visible = true;\r\n\r\n\tthis.castShadow = false;\r\n\tthis.receiveShadow = false;\r\n\r\n\tthis.frustumCulled = true;\r\n\tthis.renderOrder = 0;\r\n\r\n\tthis.userData = {};\r\n\r\n};\r\n\r\nTHREE.Object3D.DefaultUp = new THREE.Vector3( 0, 1, 0 );\r\nTHREE.Object3D.DefaultMatrixAutoUpdate = true;\r\n\r\nTHREE.Object3D.prototype = {\r\n\r\n\tconstructor: THREE.Object3D,\r\n\r\n\tget eulerOrder () {\r\n\r\n\t\tconsole.warn( 'THREE.Object3D: .eulerOrder is now .rotation.order.' );\r\n\r\n\t\treturn this.rotation.order;\r\n\r\n\t},\r\n\r\n\tset eulerOrder ( value ) {\r\n\r\n\t\tconsole.warn( 'THREE.Object3D: .eulerOrder is now .rotation.order.' );\r\n\r\n\t\tthis.rotation.order = value;\r\n\r\n\t},\r\n\r\n\tget useQuaternion () {\r\n\r\n\t\tconsole.warn( 'THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.' );\r\n\r\n\t},\r\n\r\n\tset useQuaternion ( value ) {\r\n\r\n\t\tconsole.warn( 'THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.' );\r\n\r\n\t},\r\n\r\n\tset renderDepth ( value ) {\r\n\r\n\t\tconsole.warn( 'THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.' );\r\n\r\n\t},\r\n\r\n\t//\r\n\r\n\tapplyMatrix: function ( matrix ) {\r\n\r\n\t\tthis.matrix.multiplyMatrices( matrix, this.matrix );\r\n\r\n\t\tthis.matrix.decompose( this.position, this.quaternion, this.scale );\r\n\r\n\t},\r\n\r\n\tsetRotationFromAxisAngle: function ( axis, angle ) {\r\n\r\n\t\t// assumes axis is normalized\r\n\r\n\t\tthis.quaternion.setFromAxisAngle( axis, angle );\r\n\r\n\t},\r\n\r\n\tsetRotationFromEuler: function ( euler ) {\r\n\r\n\t\tthis.quaternion.setFromEuler( euler, true );\r\n\r\n\t},\r\n\r\n\tsetRotationFromMatrix: function ( m ) {\r\n\r\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\r\n\t\tthis.quaternion.setFromRotationMatrix( m );\r\n\r\n\t},\r\n\r\n\tsetRotationFromQuaternion: function ( q ) {\r\n\r\n\t\t// assumes q is normalized\r\n\r\n\t\tthis.quaternion.copy( q );\r\n\r\n\t},\r\n\r\n\trotateOnAxis: function () {\r\n\r\n\t\t// rotate object on axis in object space\r\n\t\t// axis is assumed to be normalized\r\n\r\n\t\tvar q1 = new THREE.Quaternion();\r\n\r\n\t\treturn function ( axis, angle ) {\r\n\r\n\t\t\tq1.setFromAxisAngle( axis, angle );\r\n\r\n\t\t\tthis.quaternion.multiply( q1 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\trotateX: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3( 1, 0, 0 );\r\n\r\n\t\treturn function ( angle ) {\r\n\r\n\t\t\treturn this.rotateOnAxis( v1, angle );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\trotateY: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3( 0, 1, 0 );\r\n\r\n\t\treturn function ( angle ) {\r\n\r\n\t\t\treturn this.rotateOnAxis( v1, angle );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\trotateZ: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3( 0, 0, 1 );\r\n\r\n\t\treturn function ( angle ) {\r\n\r\n\t\t\treturn this.rotateOnAxis( v1, angle );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\ttranslateOnAxis: function () {\r\n\r\n\t\t// translate object by distance along axis in object space\r\n\t\t// axis is assumed to be normalized\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function ( axis, distance ) {\r\n\r\n\t\t\tv1.copy( axis ).applyQuaternion( this.quaternion );\r\n\r\n\t\t\tthis.position.add( v1.multiplyScalar( distance ) );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\ttranslate: function ( distance, axis ) {\r\n\r\n\t\tconsole.warn( 'THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead.' );\r\n\t\treturn this.translateOnAxis( axis, distance );\r\n\r\n\t},\r\n\r\n\ttranslateX: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3( 1, 0, 0 );\r\n\r\n\t\treturn function ( distance ) {\r\n\r\n\t\t\treturn this.translateOnAxis( v1, distance );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\ttranslateY: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3( 0, 1, 0 );\r\n\r\n\t\treturn function ( distance ) {\r\n\r\n\t\t\treturn this.translateOnAxis( v1, distance );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\ttranslateZ: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3( 0, 0, 1 );\r\n\r\n\t\treturn function ( distance ) {\r\n\r\n\t\t\treturn this.translateOnAxis( v1, distance );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tlocalToWorld: function ( vector ) {\r\n\r\n\t\treturn vector.applyMatrix4( this.matrixWorld );\r\n\r\n\t},\r\n\r\n\tworldToLocal: function () {\r\n\r\n\t\tvar m1 = new THREE.Matrix4();\r\n\r\n\t\treturn function ( vector ) {\r\n\r\n\t\t\treturn vector.applyMatrix4( m1.getInverse( this.matrixWorld ) );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tlookAt: function () {\r\n\r\n\t\t// This routine does not support objects with rotated and/or translated parent(s)\r\n\r\n\t\tvar m1 = new THREE.Matrix4();\r\n\r\n\t\treturn function ( vector ) {\r\n\r\n\t\t\tm1.lookAt( vector, this.position, this.up );\r\n\r\n\t\t\tthis.quaternion.setFromRotationMatrix( m1 );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tadd: function ( object ) {\r\n\r\n\t\tif ( arguments.length > 1 ) {\r\n\r\n\t\t\tfor ( var i = 0; i < arguments.length; i ++ ) {\r\n\r\n\t\t\t\tthis.add( arguments[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t\tif ( object === this ) {\r\n\r\n\t\t\tconsole.error( \"THREE.Object3D.add: object can't be added as a child of itself.\", object );\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t\tif ( object instanceof THREE.Object3D ) {\r\n\r\n\t\t\tif ( object.parent !== null ) {\r\n\r\n\t\t\t\tobject.parent.remove( object );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tobject.parent = this;\r\n\t\t\tobject.dispatchEvent( { type: 'added' } );\r\n\r\n\t\t\tthis.children.push( object );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tconsole.error( \"THREE.Object3D.add: object not an instance of THREE.Object3D.\", object );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tremove: function ( object ) {\r\n\r\n\t\tif ( arguments.length > 1 ) {\r\n\r\n\t\t\tfor ( var i = 0; i < arguments.length; i ++ ) {\r\n\r\n\t\t\t\tthis.remove( arguments[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar index = this.children.indexOf( object );\r\n\r\n\t\tif ( index !== - 1 ) {\r\n\r\n\t\t\tobject.parent = null;\r\n\r\n\t\t\tobject.dispatchEvent( { type: 'removed' } );\r\n\r\n\t\t\tthis.children.splice( index, 1 );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tgetChildByName: function ( name ) {\r\n\r\n\t\tconsole.warn( 'THREE.Object3D: .getChildByName() has been renamed to .getObjectByName().' );\r\n\t\treturn this.getObjectByName( name );\r\n\r\n\t},\r\n\r\n\tgetObjectById: function ( id ) {\r\n\r\n\t\treturn this.getObjectByProperty( 'id', id );\r\n\r\n\t},\r\n\r\n\tgetObjectByName: function ( name ) {\r\n\r\n\t\treturn this.getObjectByProperty( 'name', name );\r\n\r\n\t},\r\n\r\n\tgetObjectByProperty: function ( name, value ) {\r\n\r\n\t\tif ( this[ name ] === value ) return this;\r\n\r\n\t\tfor ( var i = 0, l = this.children.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar child = this.children[ i ];\r\n\t\t\tvar object = child.getObjectByProperty( name, value );\r\n\r\n\t\t\tif ( object !== undefined ) {\r\n\r\n\t\t\t\treturn object;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn undefined;\r\n\r\n\t},\r\n\r\n\tgetWorldPosition: function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\tthis.updateMatrixWorld( true );\r\n\r\n\t\treturn result.setFromMatrixPosition( this.matrixWorld );\r\n\r\n\t},\r\n\r\n\tgetWorldQuaternion: function () {\r\n\r\n\t\tvar position = new THREE.Vector3();\r\n\t\tvar scale = new THREE.Vector3();\r\n\r\n\t\treturn function ( optionalTarget ) {\r\n\r\n\t\t\tvar result = optionalTarget || new THREE.Quaternion();\r\n\r\n\t\t\tthis.updateMatrixWorld( true );\r\n\r\n\t\t\tthis.matrixWorld.decompose( position, result, scale );\r\n\r\n\t\t\treturn result;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tgetWorldRotation: function () {\r\n\r\n\t\tvar quaternion = new THREE.Quaternion();\r\n\r\n\t\treturn function ( optionalTarget ) {\r\n\r\n\t\t\tvar result = optionalTarget || new THREE.Euler();\r\n\r\n\t\t\tthis.getWorldQuaternion( quaternion );\r\n\r\n\t\t\treturn result.setFromQuaternion( quaternion, this.rotation.order, false );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tgetWorldScale: function () {\r\n\r\n\t\tvar position = new THREE.Vector3();\r\n\t\tvar quaternion = new THREE.Quaternion();\r\n\r\n\t\treturn function ( optionalTarget ) {\r\n\r\n\t\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\t\tthis.updateMatrixWorld( true );\r\n\r\n\t\t\tthis.matrixWorld.decompose( position, quaternion, result );\r\n\r\n\t\t\treturn result;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tgetWorldDirection: function () {\r\n\r\n\t\tvar quaternion = new THREE.Quaternion();\r\n\r\n\t\treturn function ( optionalTarget ) {\r\n\r\n\t\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\t\tthis.getWorldQuaternion( quaternion );\r\n\r\n\t\t\treturn result.set( 0, 0, 1 ).applyQuaternion( quaternion );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\traycast: function () {},\r\n\r\n\ttraverse: function ( callback ) {\r\n\r\n\t\tcallback( this );\r\n\r\n\t\tvar children = this.children;\r\n\r\n\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\r\n\r\n\t\t\tchildren[ i ].traverse( callback );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\ttraverseVisible: function ( callback ) {\r\n\r\n\t\tif ( this.visible === false ) return;\r\n\r\n\t\tcallback( this );\r\n\r\n\t\tvar children = this.children;\r\n\r\n\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\r\n\r\n\t\t\tchildren[ i ].traverseVisible( callback );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\ttraverseAncestors: function ( callback ) {\r\n\r\n\t\tvar parent = this.parent;\r\n\r\n\t\tif ( parent !== null ) {\r\n\r\n\t\t\tcallback( parent );\r\n\r\n\t\t\tparent.traverseAncestors( callback );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tupdateMatrix: function () {\r\n\r\n\t\tthis.matrix.compose( this.position, this.quaternion, this.scale );\r\n\r\n\t\tthis.matrixWorldNeedsUpdate = true;\r\n\r\n\t},\r\n\r\n\tupdateMatrixWorld: function ( force ) {\r\n\r\n\t\tif ( this.matrixAutoUpdate === true ) this.updateMatrix();\r\n\r\n\t\tif ( this.matrixWorldNeedsUpdate === true || force === true ) {\r\n\r\n\t\t\tif ( this.parent === null ) {\r\n\r\n\t\t\t\tthis.matrixWorld.copy( this.matrix );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.matrixWorld.multiplyMatrices( this.parent.matrixWorld, this.matrix );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.matrixWorldNeedsUpdate = false;\r\n\r\n\t\t\tforce = true;\r\n\r\n\t\t}\r\n\r\n\t\t// update children\r\n\r\n\t\tfor ( var i = 0, l = this.children.length; i < l; i ++ ) {\r\n\r\n\t\t\tthis.children[ i ].updateMatrixWorld( force );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\ttoJSON: function ( meta ) {\r\n\r\n\t\tvar isRootObject = ( meta === undefined );\r\n\r\n\t\tvar output = {};\r\n\r\n\t\t// meta is a hash used to collect geometries, materials.\r\n\t\t// not providing it implies that this is the root object\r\n\t\t// being serialized.\r\n\t\tif ( isRootObject ) {\r\n\r\n\t\t\t// initialize meta obj\r\n\t\t\tmeta = {\r\n\t\t\t\tgeometries: {},\r\n\t\t\t\tmaterials: {},\r\n\t\t\t\ttextures: {},\r\n\t\t\t\timages: {}\r\n\t\t\t};\r\n\r\n\t\t\toutput.metadata = {\r\n\t\t\t\tversion: 4.4,\r\n\t\t\t\ttype: 'Object',\r\n\t\t\t\tgenerator: 'Object3D.toJSON'\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t\t// standard Object3D serialization\r\n\r\n\t\tvar object = {};\r\n\r\n\t\tobject.uuid = this.uuid;\r\n\t\tobject.type = this.type;\r\n\r\n\t\tif ( this.name !== '' ) object.name = this.name;\r\n\t\tif ( JSON.stringify( this.userData ) !== '{}' ) object.userData = this.userData;\r\n\t\tif ( this.castShadow === true ) object.castShadow = true;\r\n\t\tif ( this.receiveShadow === true ) object.receiveShadow = true;\r\n\t\tif ( this.visible === false ) object.visible = false;\r\n\r\n\t\tobject.matrix = this.matrix.toArray();\r\n\r\n\t\t//\r\n\r\n\t\tif ( this.geometry !== undefined ) {\r\n\r\n\t\t\tif ( meta.geometries[ this.geometry.uuid ] === undefined ) {\r\n\r\n\t\t\t\tmeta.geometries[ this.geometry.uuid ] = this.geometry.toJSON( meta );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tobject.geometry = this.geometry.uuid;\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.material !== undefined ) {\r\n\r\n\t\t\tif ( meta.materials[ this.material.uuid ] === undefined ) {\r\n\r\n\t\t\t\tmeta.materials[ this.material.uuid ] = this.material.toJSON( meta );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tobject.material = this.material.uuid;\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tif ( this.children.length > 0 ) {\r\n\r\n\t\t\tobject.children = [];\r\n\r\n\t\t\tfor ( var i = 0; i < this.children.length; i ++ ) {\r\n\r\n\t\t\t\tobject.children.push( this.children[ i ].toJSON( meta ).object );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( isRootObject ) {\r\n\r\n\t\t\tvar geometries = extractFromCache( meta.geometries );\r\n\t\t\tvar materials = extractFromCache( meta.materials );\r\n\t\t\tvar textures = extractFromCache( meta.textures );\r\n\t\t\tvar images = extractFromCache( meta.images );\r\n\r\n\t\t\tif ( geometries.length > 0 ) output.geometries = geometries;\r\n\t\t\tif ( materials.length > 0 ) output.materials = materials;\r\n\t\t\tif ( textures.length > 0 ) output.textures = textures;\r\n\t\t\tif ( images.length > 0 ) output.images = images;\r\n\r\n\t\t}\r\n\r\n\t\toutput.object = object;\r\n\r\n\t\treturn output;\r\n\r\n\t\t// extract data from the cache hash\r\n\t\t// remove metadata on each item\r\n\t\t// and return as array\r\n\t\tfunction extractFromCache ( cache ) {\r\n\r\n\t\t\tvar values = [];\r\n\t\t\tfor ( var key in cache ) {\r\n\r\n\t\t\t\tvar data = cache[ key ];\r\n\t\t\t\tdelete data.metadata;\r\n\t\t\t\tvalues.push( data );\r\n\r\n\t\t\t}\r\n\t\t\treturn values;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tclone: function ( recursive ) {\r\n\r\n\t\treturn new this.constructor().copy( this, recursive );\r\n\r\n\t},\r\n\r\n\tcopy: function ( source, recursive ) {\r\n\r\n\t\tif ( recursive === undefined ) recursive = true;\r\n\r\n\t\tthis.name = source.name;\r\n\r\n\t\tthis.up.copy( source.up );\r\n\r\n\t\tthis.position.copy( source.position );\r\n\t\tthis.quaternion.copy( source.quaternion );\r\n\t\tthis.scale.copy( source.scale );\r\n\r\n\t\tthis.rotationAutoUpdate = source.rotationAutoUpdate;\r\n\r\n\t\tthis.matrix.copy( source.matrix );\r\n\t\tthis.matrixWorld.copy( source.matrixWorld );\r\n\r\n\t\tthis.matrixAutoUpdate = source.matrixAutoUpdate;\r\n\t\tthis.matrixWorldNeedsUpdate = source.matrixWorldNeedsUpdate;\r\n\r\n\t\tthis.visible = source.visible;\r\n\r\n\t\tthis.castShadow = source.castShadow;\r\n\t\tthis.receiveShadow = source.receiveShadow;\r\n\r\n\t\tthis.frustumCulled = source.frustumCulled;\r\n\t\tthis.renderOrder = source.renderOrder;\r\n\r\n\t\tthis.userData = JSON.parse( JSON.stringify( source.userData ) );\r\n\r\n\t\tif ( recursive === true ) {\r\n\r\n\t\t\tfor ( var i = 0; i < source.children.length; i ++ ) {\r\n\r\n\t\t\t\tvar child = source.children[ i ];\r\n\t\t\t\tthis.add( child.clone() );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply( THREE.Object3D.prototype );\r\n\r\nTHREE.Object3DIdCount = 0;\r\n\r\n// File:src/core/Face3.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Face3 = function ( a, b, c, normal, color, materialIndex ) {\r\n\r\n\tthis.a = a;\r\n\tthis.b = b;\r\n\tthis.c = c;\r\n\r\n\tthis.normal = normal instanceof THREE.Vector3 ? normal : new THREE.Vector3();\r\n\tthis.vertexNormals = Array.isArray( normal ) ? normal : [];\r\n\r\n\tthis.color = color instanceof THREE.Color ? color : new THREE.Color();\r\n\tthis.vertexColors = Array.isArray( color ) ? color : [];\r\n\r\n\tthis.materialIndex = materialIndex !== undefined ? materialIndex : 0;\r\n\r\n};\r\n\r\nTHREE.Face3.prototype = {\r\n\r\n\tconstructor: THREE.Face3,\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( source ) {\r\n\r\n\t\tthis.a = source.a;\r\n\t\tthis.b = source.b;\r\n\t\tthis.c = source.c;\r\n\r\n\t\tthis.normal.copy( source.normal );\r\n\t\tthis.color.copy( source.color );\r\n\r\n\t\tthis.materialIndex = source.materialIndex;\r\n\r\n\t\tfor ( var i = 0, il = source.vertexNormals.length; i < il; i ++ ) {\r\n\r\n\t\t\tthis.vertexNormals[ i ] = source.vertexNormals[ i ].clone();\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0, il = source.vertexColors.length; i < il; i ++ ) {\r\n\r\n\t\t\tthis.vertexColors[ i ] = source.vertexColors[ i ].clone();\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/core/Face4.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Face4 = function ( a, b, c, d, normal, color, materialIndex ) {\r\n\r\n\tconsole.warn( 'THREE.Face4 has been removed. A THREE.Face3 will be created instead.' );\r\n\treturn new THREE.Face3( a, b, c, normal, color, materialIndex );\r\n\r\n};\r\n\r\n// File:src/core/BufferAttribute.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.BufferAttribute = function ( array, itemSize ) {\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\tthis.array = array;\r\n\tthis.itemSize = itemSize;\r\n\r\n\tthis.dynamic = false;\r\n\tthis.updateRange = { offset: 0, count: - 1 };\r\n\r\n\tthis.version = 0;\r\n\r\n};\r\n\r\nTHREE.BufferAttribute.prototype = {\r\n\r\n\tconstructor: THREE.BufferAttribute,\r\n\r\n\tget length() {\r\n\r\n\t\tconsole.warn( 'THREE.BufferAttribute: .length has been deprecated. Please use .count.' );\r\n\t\treturn this.array.length;\r\n\r\n\t},\r\n\r\n\tget count() {\r\n\r\n\t\treturn this.array.length / this.itemSize;\r\n\r\n\t},\r\n\r\n\tset needsUpdate( value ) {\r\n\r\n\t\tif ( value === true ) this.version ++;\r\n\r\n\t},\r\n\r\n\tsetDynamic: function ( value ) {\r\n\r\n\t\tthis.dynamic = value;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopy: function ( source ) {\r\n\r\n\t\tthis.array = new source.array.constructor( source.array );\r\n\t\tthis.itemSize = source.itemSize;\r\n\r\n\t\tthis.dynamic = source.dynamic;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopyAt: function ( index1, attribute, index2 ) {\r\n\r\n\t\tindex1 *= this.itemSize;\r\n\t\tindex2 *= attribute.itemSize;\r\n\r\n\t\tfor ( var i = 0, l = this.itemSize; i < l; i ++ ) {\r\n\r\n\t\t\tthis.array[ index1 + i ] = attribute.array[ index2 + i ];\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopyArray: function ( array ) {\r\n\r\n\t\tthis.array.set( array );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopyColorsArray: function ( colors ) {\r\n\r\n\t\tvar array = this.array, offset = 0;\r\n\r\n\t\tfor ( var i = 0, l = colors.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar color = colors[ i ];\r\n\r\n\t\t\tif ( color === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyColorsArray(): color is undefined', i );\r\n\t\t\t\tcolor = new THREE.Color();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tarray[ offset ++ ] = color.r;\r\n\t\t\tarray[ offset ++ ] = color.g;\r\n\t\t\tarray[ offset ++ ] = color.b;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopyIndicesArray: function ( indices ) {\r\n\r\n\t\tvar array = this.array, offset = 0;\r\n\r\n\t\tfor ( var i = 0, l = indices.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar index = indices[ i ];\r\n\r\n\t\t\tarray[ offset ++ ] = index.a;\r\n\t\t\tarray[ offset ++ ] = index.b;\r\n\t\t\tarray[ offset ++ ] = index.c;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopyVector2sArray: function ( vectors ) {\r\n\r\n\t\tvar array = this.array, offset = 0;\r\n\r\n\t\tfor ( var i = 0, l = vectors.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar vector = vectors[ i ];\r\n\r\n\t\t\tif ( vector === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyVector2sArray(): vector is undefined', i );\r\n\t\t\t\tvector = new THREE.Vector2();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tarray[ offset ++ ] = vector.x;\r\n\t\t\tarray[ offset ++ ] = vector.y;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopyVector3sArray: function ( vectors ) {\r\n\r\n\t\tvar array = this.array, offset = 0;\r\n\r\n\t\tfor ( var i = 0, l = vectors.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar vector = vectors[ i ];\r\n\r\n\t\t\tif ( vector === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyVector3sArray(): vector is undefined', i );\r\n\t\t\t\tvector = new THREE.Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tarray[ offset ++ ] = vector.x;\r\n\t\t\tarray[ offset ++ ] = vector.y;\r\n\t\t\tarray[ offset ++ ] = vector.z;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopyVector4sArray: function ( vectors ) {\r\n\r\n\t\tvar array = this.array, offset = 0;\r\n\r\n\t\tfor ( var i = 0, l = vectors.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar vector = vectors[ i ];\r\n\r\n\t\t\tif ( vector === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyVector4sArray(): vector is undefined', i );\r\n\t\t\t\tvector = new THREE.Vector4();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tarray[ offset ++ ] = vector.x;\r\n\t\t\tarray[ offset ++ ] = vector.y;\r\n\t\t\tarray[ offset ++ ] = vector.z;\r\n\t\t\tarray[ offset ++ ] = vector.w;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tset: function ( value, offset ) {\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tthis.array.set( value, offset );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tgetX: function ( index ) {\r\n\r\n\t\treturn this.array[ index * this.itemSize ];\r\n\r\n\t},\r\n\r\n\tsetX: function ( index, x ) {\r\n\r\n\t\tthis.array[ index * this.itemSize ] = x;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tgetY: function ( index ) {\r\n\r\n\t\treturn this.array[ index * this.itemSize + 1 ];\r\n\r\n\t},\r\n\r\n\tsetY: function ( index, y ) {\r\n\r\n\t\tthis.array[ index * this.itemSize + 1 ] = y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tgetZ: function ( index ) {\r\n\r\n\t\treturn this.array[ index * this.itemSize + 2 ];\r\n\r\n\t},\r\n\r\n\tsetZ: function ( index, z ) {\r\n\r\n\t\tthis.array[ index * this.itemSize + 2 ] = z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tgetW: function ( index ) {\r\n\r\n\t\treturn this.array[ index * this.itemSize + 3 ];\r\n\r\n\t},\r\n\r\n\tsetW: function ( index, w ) {\r\n\r\n\t\tthis.array[ index * this.itemSize + 3 ] = w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetXY: function ( index, x, y ) {\r\n\r\n\t\tindex *= this.itemSize;\r\n\r\n\t\tthis.array[ index + 0 ] = x;\r\n\t\tthis.array[ index + 1 ] = y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetXYZ: function ( index, x, y, z ) {\r\n\r\n\t\tindex *= this.itemSize;\r\n\r\n\t\tthis.array[ index + 0 ] = x;\r\n\t\tthis.array[ index + 1 ] = y;\r\n\t\tthis.array[ index + 2 ] = z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetXYZW: function ( index, x, y, z, w ) {\r\n\r\n\t\tindex *= this.itemSize;\r\n\r\n\t\tthis.array[ index + 0 ] = x;\r\n\t\tthis.array[ index + 1 ] = y;\r\n\t\tthis.array[ index + 2 ] = z;\r\n\t\tthis.array[ index + 3 ] = w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t}\r\n\r\n};\r\n\r\n//\r\n\r\nTHREE.Int8Attribute = function ( array, itemSize ) {\r\n\r\n\treturn new THREE.BufferAttribute( new Int8Array( array ), itemSize );\r\n\r\n};\r\n\r\nTHREE.Uint8Attribute = function ( array, itemSize ) {\r\n\r\n\treturn new THREE.BufferAttribute( new Uint8Array( array ), itemSize );\r\n\r\n};\r\n\r\nTHREE.Uint8ClampedAttribute = function ( array, itemSize ) {\r\n\r\n\treturn new THREE.BufferAttribute( new Uint8ClampedArray( array ), itemSize );\r\n\r\n};\r\n\r\nTHREE.Int16Attribute = function ( array, itemSize ) {\r\n\r\n\treturn new THREE.BufferAttribute( new Int16Array( array ), itemSize );\r\n\r\n};\r\n\r\nTHREE.Uint16Attribute = function ( array, itemSize ) {\r\n\r\n\treturn new THREE.BufferAttribute( new Uint16Array( array ), itemSize );\r\n\r\n};\r\n\r\nTHREE.Int32Attribute = function ( array, itemSize ) {\r\n\r\n\treturn new THREE.BufferAttribute( new Int32Array( array ), itemSize );\r\n\r\n};\r\n\r\nTHREE.Uint32Attribute = function ( array, itemSize ) {\r\n\r\n\treturn new THREE.BufferAttribute( new Uint32Array( array ), itemSize );\r\n\r\n};\r\n\r\nTHREE.Float32Attribute = function ( array, itemSize ) {\r\n\r\n\treturn new THREE.BufferAttribute( new Float32Array( array ), itemSize );\r\n\r\n};\r\n\r\nTHREE.Float64Attribute = function ( array, itemSize ) {\r\n\r\n\treturn new THREE.BufferAttribute( new Float64Array( array ), itemSize );\r\n\r\n};\r\n\r\n\r\n// Deprecated\r\n\r\nTHREE.DynamicBufferAttribute = function ( array, itemSize ) {\r\n\r\n\tconsole.warn( 'THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead.' );\r\n\treturn new THREE.BufferAttribute( array, itemSize ).setDynamic( true );\r\n\r\n};\r\n\r\n// File:src/core/InstancedBufferAttribute.js\r\n\r\n/**\r\n * @author benaadams / https://twitter.com/ben_a_adams\r\n */\r\n\r\nTHREE.InstancedBufferAttribute = function ( array, itemSize, meshPerAttribute ) {\r\n\r\n\tTHREE.BufferAttribute.call( this, array, itemSize );\r\n\r\n\tthis.meshPerAttribute = meshPerAttribute || 1;\r\n\r\n};\r\n\r\nTHREE.InstancedBufferAttribute.prototype = Object.create( THREE.BufferAttribute.prototype );\r\nTHREE.InstancedBufferAttribute.prototype.constructor = THREE.InstancedBufferAttribute;\r\n\r\nTHREE.InstancedBufferAttribute.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.BufferAttribute.prototype.copy.call( this, source );\r\n\r\n\tthis.meshPerAttribute = source.meshPerAttribute;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/core/InterleavedBuffer.js\r\n\r\n/**\r\n * @author benaadams / https://twitter.com/ben_a_adams\r\n */\r\n\r\nTHREE.InterleavedBuffer = function ( array, stride ) {\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\tthis.array = array;\r\n\tthis.stride = stride;\r\n\r\n\tthis.dynamic = false;\r\n\tthis.updateRange = { offset: 0, count: - 1 };\r\n\r\n\tthis.version = 0;\r\n\r\n};\r\n\r\nTHREE.InterleavedBuffer.prototype = {\r\n\r\n\tconstructor: THREE.InterleavedBuffer,\r\n\r\n\tget length () {\r\n\r\n\t\treturn this.array.length;\r\n\r\n\t},\r\n\r\n\tget count () {\r\n\r\n\t\treturn this.array.length / this.stride;\r\n\r\n\t},\r\n\r\n\tset needsUpdate( value ) {\r\n\r\n\t\tif ( value === true ) this.version ++;\r\n\r\n\t},\r\n\r\n\tsetDynamic: function ( value ) {\r\n\r\n\t\tthis.dynamic = value;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopy: function ( source ) {\r\n\r\n\t\tthis.array = new source.array.constructor( source.array );\r\n\t\tthis.stride = source.stride;\r\n\t\tthis.dynamic = source.dynamic;\r\n\r\n\t},\r\n\r\n\tcopyAt: function ( index1, attribute, index2 ) {\r\n\r\n\t\tindex1 *= this.stride;\r\n\t\tindex2 *= attribute.stride;\r\n\r\n\t\tfor ( var i = 0, l = this.stride; i < l; i ++ ) {\r\n\r\n\t\t\tthis.array[ index1 + i ] = attribute.array[ index2 + i ];\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tset: function ( value, offset ) {\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tthis.array.set( value, offset );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/core/InstancedInterleavedBuffer.js\r\n\r\n/**\r\n * @author benaadams / https://twitter.com/ben_a_adams\r\n */\r\n\r\nTHREE.InstancedInterleavedBuffer = function ( array, stride, meshPerAttribute ) {\r\n\r\n\tTHREE.InterleavedBuffer.call( this, array, stride );\r\n\r\n\tthis.meshPerAttribute = meshPerAttribute || 1;\r\n\r\n};\r\n\r\nTHREE.InstancedInterleavedBuffer.prototype = Object.create( THREE.InterleavedBuffer.prototype );\r\nTHREE.InstancedInterleavedBuffer.prototype.constructor = THREE.InstancedInterleavedBuffer;\r\n\r\nTHREE.InstancedInterleavedBuffer.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.InterleavedBuffer.prototype.copy.call( this, source );\r\n\r\n\tthis.meshPerAttribute = source.meshPerAttribute;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/core/InterleavedBufferAttribute.js\r\n\r\n/**\r\n * @author benaadams / https://twitter.com/ben_a_adams\r\n */\r\n\r\nTHREE.InterleavedBufferAttribute = function ( interleavedBuffer, itemSize, offset ) {\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\tthis.data = interleavedBuffer;\r\n\tthis.itemSize = itemSize;\r\n\tthis.offset = offset;\r\n\r\n};\r\n\r\n\r\nTHREE.InterleavedBufferAttribute.prototype = {\r\n\r\n\tconstructor: THREE.InterleavedBufferAttribute,\r\n\r\n\tget length() {\r\n\r\n\t\tconsole.warn( 'THREE.BufferAttribute: .length has been deprecated. Please use .count.' );\r\n\t\treturn this.array.length;\r\n\r\n\t},\r\n\r\n\tget count() {\r\n\r\n\t\treturn this.data.array.length / this.data.stride;\r\n\r\n\t},\r\n\r\n\tsetX: function ( index, x ) {\r\n\r\n\t\tthis.data.array[ index * this.data.stride + this.offset ] = x;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetY: function ( index, y ) {\r\n\r\n\t\tthis.data.array[ index * this.data.stride + this.offset + 1 ] = y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetZ: function ( index, z ) {\r\n\r\n\t\tthis.data.array[ index * this.data.stride + this.offset + 2 ] = z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetW: function ( index, w ) {\r\n\r\n\t\tthis.data.array[ index * this.data.stride + this.offset + 3 ] = w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tgetX: function ( index ) {\r\n\r\n\t\treturn this.data.array[ index * this.data.stride + this.offset ];\r\n\r\n\t},\r\n\r\n\tgetY: function ( index ) {\r\n\r\n\t\treturn this.data.array[ index * this.data.stride + this.offset + 1 ];\r\n\r\n\t},\r\n\r\n\tgetZ: function ( index ) {\r\n\r\n\t\treturn this.data.array[ index * this.data.stride + this.offset + 2 ];\r\n\r\n\t},\r\n\r\n\tgetW: function ( index ) {\r\n\r\n\t\treturn this.data.array[ index * this.data.stride + this.offset + 3 ];\r\n\r\n\t},\r\n\r\n\tsetXY: function ( index, x, y ) {\r\n\r\n\t\tindex = index * this.data.stride + this.offset;\r\n\r\n\t\tthis.data.array[ index + 0 ] = x;\r\n\t\tthis.data.array[ index + 1 ] = y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetXYZ: function ( index, x, y, z ) {\r\n\r\n\t\tindex = index * this.data.stride + this.offset;\r\n\r\n\t\tthis.data.array[ index + 0 ] = x;\r\n\t\tthis.data.array[ index + 1 ] = y;\r\n\t\tthis.data.array[ index + 2 ] = z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetXYZW: function ( index, x, y, z, w ) {\r\n\r\n\t\tindex = index * this.data.stride + this.offset;\r\n\r\n\t\tthis.data.array[ index + 0 ] = x;\r\n\t\tthis.data.array[ index + 1 ] = y;\r\n\t\tthis.data.array[ index + 2 ] = z;\r\n\t\tthis.data.array[ index + 3 ] = w;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/core/Geometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author kile / http://kile.stravaganza.org/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * @author bhouston / http://clara.io\r\n */\r\n\r\nTHREE.Geometry = function () {\r\n\r\n\tObject.defineProperty( this, 'id', { value: THREE.GeometryIdCount ++ } );\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\tthis.name = '';\r\n\tthis.type = 'Geometry';\r\n\r\n\tthis.vertices = [];\r\n\tthis.colors = [];\r\n\tthis.faces = [];\r\n\tthis.faceVertexUvs = [ [] ];\r\n\r\n\tthis.morphTargets = [];\r\n\tthis.morphNormals = [];\r\n\r\n\tthis.skinWeights = [];\r\n\tthis.skinIndices = [];\r\n\r\n\tthis.lineDistances = [];\r\n\r\n\tthis.boundingBox = null;\r\n\tthis.boundingSphere = null;\r\n\r\n\t// update flags\r\n\r\n\tthis.verticesNeedUpdate = false;\r\n\tthis.elementsNeedUpdate = false;\r\n\tthis.uvsNeedUpdate = false;\r\n\tthis.normalsNeedUpdate = false;\r\n\tthis.colorsNeedUpdate = false;\r\n\tthis.lineDistancesNeedUpdate = false;\r\n\tthis.groupsNeedUpdate = false;\r\n\r\n};\r\n\r\nTHREE.Geometry.prototype = {\r\n\r\n\tconstructor: THREE.Geometry,\r\n\r\n\tapplyMatrix: function ( matrix ) {\r\n\r\n\t\tvar normalMatrix = new THREE.Matrix3().getNormalMatrix( matrix );\r\n\r\n\t\tfor ( var i = 0, il = this.vertices.length; i < il; i ++ ) {\r\n\r\n\t\t\tvar vertex = this.vertices[ i ];\r\n\t\t\tvertex.applyMatrix4( matrix );\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0, il = this.faces.length; i < il; i ++ ) {\r\n\r\n\t\t\tvar face = this.faces[ i ];\r\n\t\t\tface.normal.applyMatrix3( normalMatrix ).normalize();\r\n\r\n\t\t\tfor ( var j = 0, jl = face.vertexNormals.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\tface.vertexNormals[ j ].applyMatrix3( normalMatrix ).normalize();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.boundingBox !== null ) {\r\n\r\n\t\t\tthis.computeBoundingBox();\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.boundingSphere !== null ) {\r\n\r\n\t\t\tthis.computeBoundingSphere();\r\n\r\n\t\t}\r\n\r\n\t\tthis.verticesNeedUpdate = true;\r\n\t\tthis.normalsNeedUpdate = true;\r\n\r\n\t},\r\n\r\n\trotateX: function () {\r\n\r\n\t\t// rotate geometry around world x-axis\r\n\r\n\t\tvar m1;\r\n\r\n\t\treturn function rotateX( angle ) {\r\n\r\n\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\r\n\r\n\t\t\tm1.makeRotationX( angle );\r\n\r\n\t\t\tthis.applyMatrix( m1 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\trotateY: function () {\r\n\r\n\t\t// rotate geometry around world y-axis\r\n\r\n\t\tvar m1;\r\n\r\n\t\treturn function rotateY( angle ) {\r\n\r\n\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\r\n\r\n\t\t\tm1.makeRotationY( angle );\r\n\r\n\t\t\tthis.applyMatrix( m1 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\trotateZ: function () {\r\n\r\n\t\t// rotate geometry around world z-axis\r\n\r\n\t\tvar m1;\r\n\r\n\t\treturn function rotateZ( angle ) {\r\n\r\n\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\r\n\r\n\t\t\tm1.makeRotationZ( angle );\r\n\r\n\t\t\tthis.applyMatrix( m1 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\ttranslate: function () {\r\n\r\n\t\t// translate geometry\r\n\r\n\t\tvar m1;\r\n\r\n\t\treturn function translate( x, y, z ) {\r\n\r\n\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\r\n\r\n\t\t\tm1.makeTranslation( x, y, z );\r\n\r\n\t\t\tthis.applyMatrix( m1 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tscale: function () {\r\n\r\n\t\t// scale geometry\r\n\r\n\t\tvar m1;\r\n\r\n\t\treturn function scale( x, y, z ) {\r\n\r\n\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\r\n\r\n\t\t\tm1.makeScale( x, y, z );\r\n\r\n\t\t\tthis.applyMatrix( m1 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tlookAt: function () {\r\n\r\n\t\tvar obj;\r\n\r\n\t\treturn function lookAt( vector ) {\r\n\r\n\t\t\tif ( obj === undefined ) obj = new THREE.Object3D();\r\n\r\n\t\t\tobj.lookAt( vector );\r\n\r\n\t\t\tobj.updateMatrix();\r\n\r\n\t\t\tthis.applyMatrix( obj.matrix );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tfromBufferGeometry: function ( geometry ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar indices = geometry.index !== null ? geometry.index.array : undefined;\r\n\t\tvar attributes = geometry.attributes;\r\n\r\n\t\tvar vertices = attributes.position.array;\r\n\t\tvar normals = attributes.normal !== undefined ? attributes.normal.array : undefined;\r\n\t\tvar colors = attributes.color !== undefined ? attributes.color.array : undefined;\r\n\t\tvar uvs = attributes.uv !== undefined ? attributes.uv.array : undefined;\r\n\t\tvar uvs2 = attributes.uv2 !== undefined ? attributes.uv2.array : undefined;\r\n\r\n\t\tif ( uvs2 !== undefined ) this.faceVertexUvs[ 1 ] = [];\r\n\r\n\t\tvar tempNormals = [];\r\n\t\tvar tempUVs = [];\r\n\t\tvar tempUVs2 = [];\r\n\r\n\t\tfor ( var i = 0, j = 0, k = 0; i < vertices.length; i += 3, j += 2, k += 4 ) {\r\n\r\n\t\t\tscope.vertices.push( new THREE.Vector3( vertices[ i ], vertices[ i + 1 ], vertices[ i + 2 ] ) );\r\n\r\n\t\t\tif ( normals !== undefined ) {\r\n\r\n\t\t\t\ttempNormals.push( new THREE.Vector3( normals[ i ], normals[ i + 1 ], normals[ i + 2 ] ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( colors !== undefined ) {\r\n\r\n\t\t\t\tscope.colors.push( new THREE.Color( colors[ i ], colors[ i + 1 ], colors[ i + 2 ] ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( uvs !== undefined ) {\r\n\r\n\t\t\t\ttempUVs.push( new THREE.Vector2( uvs[ j ], uvs[ j + 1 ] ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( uvs2 !== undefined ) {\r\n\r\n\t\t\t\ttempUVs2.push( new THREE.Vector2( uvs2[ j ], uvs2[ j + 1 ] ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction addFace( a, b, c ) {\r\n\r\n\t\t\tvar vertexNormals = normals !== undefined ? [ tempNormals[ a ].clone(), tempNormals[ b ].clone(), tempNormals[ c ].clone() ] : [];\r\n\t\t\tvar vertexColors = colors !== undefined ? [ scope.colors[ a ].clone(), scope.colors[ b ].clone(), scope.colors[ c ].clone() ] : [];\r\n\r\n\t\t\tvar face = new THREE.Face3( a, b, c, vertexNormals, vertexColors );\r\n\r\n\t\t\tscope.faces.push( face );\r\n\r\n\t\t\tif ( uvs !== undefined ) {\r\n\r\n\t\t\t\tscope.faceVertexUvs[ 0 ].push( [ tempUVs[ a ].clone(), tempUVs[ b ].clone(), tempUVs[ c ].clone() ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( uvs2 !== undefined ) {\r\n\r\n\t\t\t\tscope.faceVertexUvs[ 1 ].push( [ tempUVs2[ a ].clone(), tempUVs2[ b ].clone(), tempUVs2[ c ].clone() ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t\tif ( indices !== undefined ) {\r\n\r\n\t\t\tvar groups = geometry.groups;\r\n\r\n\t\t\tif ( groups.length > 0 ) {\r\n\r\n\t\t\t\tfor ( var i = 0; i < groups.length; i ++ ) {\r\n\r\n\t\t\t\t\tvar group = groups[ i ];\r\n\r\n\t\t\t\t\tvar start = group.start;\r\n\t\t\t\t\tvar count = group.count;\r\n\r\n\t\t\t\t\tfor ( var j = start, jl = start + count; j < jl; j += 3 ) {\r\n\r\n\t\t\t\t\t\taddFace( indices[ j ], indices[ j + 1 ], indices[ j + 2 ] );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tfor ( var i = 0; i < indices.length; i += 3 ) {\r\n\r\n\t\t\t\t\taddFace( indices[ i ], indices[ i + 1 ], indices[ i + 2 ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tfor ( var i = 0; i < vertices.length / 3; i += 3 ) {\r\n\r\n\t\t\t\taddFace( i, i + 1, i + 2 );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tthis.computeFaceNormals();\r\n\r\n\t\tif ( geometry.boundingBox !== null ) {\r\n\r\n\t\t\tthis.boundingBox = geometry.boundingBox.clone();\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry.boundingSphere !== null ) {\r\n\r\n\t\t\tthis.boundingSphere = geometry.boundingSphere.clone();\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcenter: function () {\r\n\r\n\t\tthis.computeBoundingBox();\r\n\r\n\t\tvar offset = this.boundingBox.center().negate();\r\n\r\n\t\tthis.translate( offset.x, offset.y, offset.z );\r\n\r\n\t\treturn offset;\r\n\r\n\t},\r\n\r\n\tnormalize: function () {\r\n\r\n\t\tthis.computeBoundingSphere();\r\n\r\n\t\tvar center = this.boundingSphere.center;\r\n\t\tvar radius = this.boundingSphere.radius;\r\n\r\n\t\tvar s = radius === 0 ? 1 : 1.0 / radius;\r\n\r\n\t\tvar matrix = new THREE.Matrix4();\r\n\t\tmatrix.set(\r\n\t\t\ts, 0, 0, - s * center.x,\r\n\t\t\t0, s, 0, - s * center.y,\r\n\t\t\t0, 0, s, - s * center.z,\r\n\t\t\t0, 0, 0, 1\r\n\t\t);\r\n\r\n\t\tthis.applyMatrix( matrix );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcomputeFaceNormals: function () {\r\n\r\n\t\tvar cb = new THREE.Vector3(), ab = new THREE.Vector3();\r\n\r\n\t\tfor ( var f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\tvar face = this.faces[ f ];\r\n\r\n\t\t\tvar vA = this.vertices[ face.a ];\r\n\t\t\tvar vB = this.vertices[ face.b ];\r\n\t\t\tvar vC = this.vertices[ face.c ];\r\n\r\n\t\t\tcb.subVectors( vC, vB );\r\n\t\t\tab.subVectors( vA, vB );\r\n\t\t\tcb.cross( ab );\r\n\r\n\t\t\tcb.normalize();\r\n\r\n\t\t\tface.normal.copy( cb );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tcomputeVertexNormals: function ( areaWeighted ) {\r\n\r\n\t\tvar v, vl, f, fl, face, vertices;\r\n\r\n\t\tvertices = new Array( this.vertices.length );\r\n\r\n\t\tfor ( v = 0, vl = this.vertices.length; v < vl; v ++ ) {\r\n\r\n\t\t\tvertices[ v ] = new THREE.Vector3();\r\n\r\n\t\t}\r\n\r\n\t\tif ( areaWeighted ) {\r\n\r\n\t\t\t// vertex normals weighted by triangle areas\r\n\t\t\t// http://www.iquilezles.org/www/articles/normals/normals.htm\r\n\r\n\t\t\tvar vA, vB, vC;\r\n\t\t\tvar cb = new THREE.Vector3(), ab = new THREE.Vector3();\r\n\r\n\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\tface = this.faces[ f ];\r\n\r\n\t\t\t\tvA = this.vertices[ face.a ];\r\n\t\t\t\tvB = this.vertices[ face.b ];\r\n\t\t\t\tvC = this.vertices[ face.c ];\r\n\r\n\t\t\t\tcb.subVectors( vC, vB );\r\n\t\t\t\tab.subVectors( vA, vB );\r\n\t\t\t\tcb.cross( ab );\r\n\r\n\t\t\t\tvertices[ face.a ].add( cb );\r\n\t\t\t\tvertices[ face.b ].add( cb );\r\n\t\t\t\tvertices[ face.c ].add( cb );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\tface = this.faces[ f ];\r\n\r\n\t\t\t\tvertices[ face.a ].add( face.normal );\r\n\t\t\t\tvertices[ face.b ].add( face.normal );\r\n\t\t\t\tvertices[ face.c ].add( face.normal );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfor ( v = 0, vl = this.vertices.length; v < vl; v ++ ) {\r\n\r\n\t\t\tvertices[ v ].normalize();\r\n\r\n\t\t}\r\n\r\n\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\tface = this.faces[ f ];\r\n\r\n\t\t\tvar vertexNormals = face.vertexNormals;\r\n\r\n\t\t\tif ( vertexNormals.length === 3 ) {\r\n\r\n\t\t\t\tvertexNormals[ 0 ].copy( vertices[ face.a ] );\r\n\t\t\t\tvertexNormals[ 1 ].copy( vertices[ face.b ] );\r\n\t\t\t\tvertexNormals[ 2 ].copy( vertices[ face.c ] );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvertexNormals[ 0 ] = vertices[ face.a ].clone();\r\n\t\t\t\tvertexNormals[ 1 ] = vertices[ face.b ].clone();\r\n\t\t\t\tvertexNormals[ 2 ] = vertices[ face.c ].clone();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tcomputeMorphNormals: function () {\r\n\r\n\t\tvar i, il, f, fl, face;\r\n\r\n\t\t// save original normals\r\n\t\t// - create temp variables on first access\r\n\t\t//   otherwise just copy (for faster repeated calls)\r\n\r\n\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\tface = this.faces[ f ];\r\n\r\n\t\t\tif ( ! face.__originalFaceNormal ) {\r\n\r\n\t\t\t\tface.__originalFaceNormal = face.normal.clone();\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tface.__originalFaceNormal.copy( face.normal );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( ! face.__originalVertexNormals ) face.__originalVertexNormals = [];\r\n\r\n\t\t\tfor ( i = 0, il = face.vertexNormals.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tif ( ! face.__originalVertexNormals[ i ] ) {\r\n\r\n\t\t\t\t\tface.__originalVertexNormals[ i ] = face.vertexNormals[ i ].clone();\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tface.__originalVertexNormals[ i ].copy( face.vertexNormals[ i ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// use temp geometry to compute face and vertex normals for each morph\r\n\r\n\t\tvar tmpGeo = new THREE.Geometry();\r\n\t\ttmpGeo.faces = this.faces;\r\n\r\n\t\tfor ( i = 0, il = this.morphTargets.length; i < il; i ++ ) {\r\n\r\n\t\t\t// create on first access\r\n\r\n\t\t\tif ( ! this.morphNormals[ i ] ) {\r\n\r\n\t\t\t\tthis.morphNormals[ i ] = {};\r\n\t\t\t\tthis.morphNormals[ i ].faceNormals = [];\r\n\t\t\t\tthis.morphNormals[ i ].vertexNormals = [];\r\n\r\n\t\t\t\tvar dstNormalsFace = this.morphNormals[ i ].faceNormals;\r\n\t\t\t\tvar dstNormalsVertex = this.morphNormals[ i ].vertexNormals;\r\n\r\n\t\t\t\tvar faceNormal, vertexNormals;\r\n\r\n\t\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\t\tfaceNormal = new THREE.Vector3();\r\n\t\t\t\t\tvertexNormals = { a: new THREE.Vector3(), b: new THREE.Vector3(), c: new THREE.Vector3() };\r\n\r\n\t\t\t\t\tdstNormalsFace.push( faceNormal );\r\n\t\t\t\t\tdstNormalsVertex.push( vertexNormals );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar morphNormals = this.morphNormals[ i ];\r\n\r\n\t\t\t// set vertices to morph target\r\n\r\n\t\t\ttmpGeo.vertices = this.morphTargets[ i ].vertices;\r\n\r\n\t\t\t// compute morph normals\r\n\r\n\t\t\ttmpGeo.computeFaceNormals();\r\n\t\t\ttmpGeo.computeVertexNormals();\r\n\r\n\t\t\t// store morph normals\r\n\r\n\t\t\tvar faceNormal, vertexNormals;\r\n\r\n\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\tface = this.faces[ f ];\r\n\r\n\t\t\t\tfaceNormal = morphNormals.faceNormals[ f ];\r\n\t\t\t\tvertexNormals = morphNormals.vertexNormals[ f ];\r\n\r\n\t\t\t\tfaceNormal.copy( face.normal );\r\n\r\n\t\t\t\tvertexNormals.a.copy( face.vertexNormals[ 0 ] );\r\n\t\t\t\tvertexNormals.b.copy( face.vertexNormals[ 1 ] );\r\n\t\t\t\tvertexNormals.c.copy( face.vertexNormals[ 2 ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// restore original normals\r\n\r\n\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\tface = this.faces[ f ];\r\n\r\n\t\t\tface.normal = face.__originalFaceNormal;\r\n\t\t\tface.vertexNormals = face.__originalVertexNormals;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tcomputeTangents: function () {\r\n\r\n\t\tconsole.warn( 'THREE.Geometry: .computeTangents() has been removed.' );\r\n\r\n\t},\r\n\r\n\tcomputeLineDistances: function () {\r\n\r\n\t\tvar d = 0;\r\n\t\tvar vertices = this.vertices;\r\n\r\n\t\tfor ( var i = 0, il = vertices.length; i < il; i ++ ) {\r\n\r\n\t\t\tif ( i > 0 ) {\r\n\r\n\t\t\t\td += vertices[ i ].distanceTo( vertices[ i - 1 ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.lineDistances[ i ] = d;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tcomputeBoundingBox: function () {\r\n\r\n\t\tif ( this.boundingBox === null ) {\r\n\r\n\t\t\tthis.boundingBox = new THREE.Box3();\r\n\r\n\t\t}\r\n\r\n\t\tthis.boundingBox.setFromPoints( this.vertices );\r\n\r\n\t},\r\n\r\n\tcomputeBoundingSphere: function () {\r\n\r\n\t\tif ( this.boundingSphere === null ) {\r\n\r\n\t\t\tthis.boundingSphere = new THREE.Sphere();\r\n\r\n\t\t}\r\n\r\n\t\tthis.boundingSphere.setFromPoints( this.vertices );\r\n\r\n\t},\r\n\r\n\tmerge: function ( geometry, matrix, materialIndexOffset ) {\r\n\r\n\t\tif ( geometry instanceof THREE.Geometry === false ) {\r\n\r\n\t\t\tconsole.error( 'THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.', geometry );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tvar normalMatrix,\r\n\t\tvertexOffset = this.vertices.length,\r\n\t\tvertices1 = this.vertices,\r\n\t\tvertices2 = geometry.vertices,\r\n\t\tfaces1 = this.faces,\r\n\t\tfaces2 = geometry.faces,\r\n\t\tuvs1 = this.faceVertexUvs[ 0 ],\r\n\t\tuvs2 = geometry.faceVertexUvs[ 0 ];\r\n\r\n\t\tif ( materialIndexOffset === undefined ) materialIndexOffset = 0;\r\n\r\n\t\tif ( matrix !== undefined ) {\r\n\r\n\t\t\tnormalMatrix = new THREE.Matrix3().getNormalMatrix( matrix );\r\n\r\n\t\t}\r\n\r\n\t\t// vertices\r\n\r\n\t\tfor ( var i = 0, il = vertices2.length; i < il; i ++ ) {\r\n\r\n\t\t\tvar vertex = vertices2[ i ];\r\n\r\n\t\t\tvar vertexCopy = vertex.clone();\r\n\r\n\t\t\tif ( matrix !== undefined ) vertexCopy.applyMatrix4( matrix );\r\n\r\n\t\t\tvertices1.push( vertexCopy );\r\n\r\n\t\t}\r\n\r\n\t\t// faces\r\n\r\n\t\tfor ( i = 0, il = faces2.length; i < il; i ++ ) {\r\n\r\n\t\t\tvar face = faces2[ i ], faceCopy, normal, color,\r\n\t\t\tfaceVertexNormals = face.vertexNormals,\r\n\t\t\tfaceVertexColors = face.vertexColors;\r\n\r\n\t\t\tfaceCopy = new THREE.Face3( face.a + vertexOffset, face.b + vertexOffset, face.c + vertexOffset );\r\n\t\t\tfaceCopy.normal.copy( face.normal );\r\n\r\n\t\t\tif ( normalMatrix !== undefined ) {\r\n\r\n\t\t\t\tfaceCopy.normal.applyMatrix3( normalMatrix ).normalize();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var j = 0, jl = faceVertexNormals.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\tnormal = faceVertexNormals[ j ].clone();\r\n\r\n\t\t\t\tif ( normalMatrix !== undefined ) {\r\n\r\n\t\t\t\t\tnormal.applyMatrix3( normalMatrix ).normalize();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfaceCopy.vertexNormals.push( normal );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfaceCopy.color.copy( face.color );\r\n\r\n\t\t\tfor ( var j = 0, jl = faceVertexColors.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\tcolor = faceVertexColors[ j ];\r\n\t\t\t\tfaceCopy.vertexColors.push( color.clone() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfaceCopy.materialIndex = face.materialIndex + materialIndexOffset;\r\n\r\n\t\t\tfaces1.push( faceCopy );\r\n\r\n\t\t}\r\n\r\n\t\t// uvs\r\n\r\n\t\tfor ( i = 0, il = uvs2.length; i < il; i ++ ) {\r\n\r\n\t\t\tvar uv = uvs2[ i ], uvCopy = [];\r\n\r\n\t\t\tif ( uv === undefined ) {\r\n\r\n\t\t\t\tcontinue;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var j = 0, jl = uv.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\tuvCopy.push( uv[ j ].clone() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tuvs1.push( uvCopy );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tmergeMesh: function ( mesh ) {\r\n\r\n\t\tif ( mesh instanceof THREE.Mesh === false ) {\r\n\r\n\t\t\tconsole.error( 'THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.', mesh );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tmesh.matrixAutoUpdate && mesh.updateMatrix();\r\n\r\n\t\tthis.merge( mesh.geometry, mesh.matrix );\r\n\r\n\t},\r\n\r\n\t/*\r\n\t * Checks for duplicate vertices with hashmap.\r\n\t * Duplicated vertices are removed\r\n\t * and faces' vertices are updated.\r\n\t */\r\n\r\n\tmergeVertices: function () {\r\n\r\n\t\tvar verticesMap = {}; // Hashmap for looking up vertices by position coordinates (and making sure they are unique)\r\n\t\tvar unique = [], changes = [];\r\n\r\n\t\tvar v, key;\r\n\t\tvar precisionPoints = 4; // number of decimal points, e.g. 4 for epsilon of 0.0001\r\n\t\tvar precision = Math.pow( 10, precisionPoints );\r\n\t\tvar i, il, face;\r\n\t\tvar indices, j, jl;\r\n\r\n\t\tfor ( i = 0, il = this.vertices.length; i < il; i ++ ) {\r\n\r\n\t\t\tv = this.vertices[ i ];\r\n\t\t\tkey = Math.round( v.x * precision ) + '_' + Math.round( v.y * precision ) + '_' + Math.round( v.z * precision );\r\n\r\n\t\t\tif ( verticesMap[ key ] === undefined ) {\r\n\r\n\t\t\t\tverticesMap[ key ] = i;\r\n\t\t\t\tunique.push( this.vertices[ i ] );\r\n\t\t\t\tchanges[ i ] = unique.length - 1;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t//console.log('Duplicate vertex found. ', i, ' could be using ', verticesMap[key]);\r\n\t\t\t\tchanges[ i ] = changes[ verticesMap[ key ] ];\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\r\n\t\t// if faces are completely degenerate after merging vertices, we\r\n\t\t// have to remove them from the geometry.\r\n\t\tvar faceIndicesToRemove = [];\r\n\r\n\t\tfor ( i = 0, il = this.faces.length; i < il; i ++ ) {\r\n\r\n\t\t\tface = this.faces[ i ];\r\n\r\n\t\t\tface.a = changes[ face.a ];\r\n\t\t\tface.b = changes[ face.b ];\r\n\t\t\tface.c = changes[ face.c ];\r\n\r\n\t\t\tindices = [ face.a, face.b, face.c ];\r\n\r\n\t\t\tvar dupIndex = - 1;\r\n\r\n\t\t\t// if any duplicate vertices are found in a Face3\r\n\t\t\t// we have to remove the face as nothing can be saved\r\n\t\t\tfor ( var n = 0; n < 3; n ++ ) {\r\n\r\n\t\t\t\tif ( indices[ n ] === indices[ ( n + 1 ) % 3 ] ) {\r\n\r\n\t\t\t\t\tdupIndex = n;\r\n\t\t\t\t\tfaceIndicesToRemove.push( i );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfor ( i = faceIndicesToRemove.length - 1; i >= 0; i -- ) {\r\n\r\n\t\t\tvar idx = faceIndicesToRemove[ i ];\r\n\r\n\t\t\tthis.faces.splice( idx, 1 );\r\n\r\n\t\t\tfor ( j = 0, jl = this.faceVertexUvs.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\tthis.faceVertexUvs[ j ].splice( idx, 1 );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// Use unique set of vertices\r\n\r\n\t\tvar diff = this.vertices.length - unique.length;\r\n\t\tthis.vertices = unique;\r\n\t\treturn diff;\r\n\r\n\t},\r\n\r\n\tsortFacesByMaterialIndex: function () {\r\n\r\n\t\tvar faces = this.faces;\r\n\t\tvar length = faces.length;\r\n\r\n\t\t// tag faces\r\n\r\n\t\tfor ( var i = 0; i < length; i ++ ) {\r\n\r\n\t\t\tfaces[ i ]._id = i;\r\n\r\n\t\t}\r\n\r\n\t\t// sort faces\r\n\r\n\t\tfunction materialIndexSort( a, b ) {\r\n\r\n\t\t\treturn a.materialIndex - b.materialIndex;\r\n\r\n\t\t}\r\n\r\n\t\tfaces.sort( materialIndexSort );\r\n\r\n\t\t// sort uvs\r\n\r\n\t\tvar uvs1 = this.faceVertexUvs[ 0 ];\r\n\t\tvar uvs2 = this.faceVertexUvs[ 1 ];\r\n\r\n\t\tvar newUvs1, newUvs2;\r\n\r\n\t\tif ( uvs1 && uvs1.length === length ) newUvs1 = [];\r\n\t\tif ( uvs2 && uvs2.length === length ) newUvs2 = [];\r\n\r\n\t\tfor ( var i = 0; i < length; i ++ ) {\r\n\r\n\t\t\tvar id = faces[ i ]._id;\r\n\r\n\t\t\tif ( newUvs1 ) newUvs1.push( uvs1[ id ] );\r\n\t\t\tif ( newUvs2 ) newUvs2.push( uvs2[ id ] );\r\n\r\n\t\t}\r\n\r\n\t\tif ( newUvs1 ) this.faceVertexUvs[ 0 ] = newUvs1;\r\n\t\tif ( newUvs2 ) this.faceVertexUvs[ 1 ] = newUvs2;\r\n\r\n\t},\r\n\r\n\ttoJSON: function () {\r\n\r\n\t\tvar data = {\r\n\t\t\tmetadata: {\r\n\t\t\t\tversion: 4.4,\r\n\t\t\t\ttype: 'Geometry',\r\n\t\t\t\tgenerator: 'Geometry.toJSON'\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t// standard Geometry serialization\r\n\r\n\t\tdata.uuid = this.uuid;\r\n\t\tdata.type = this.type;\r\n\t\tif ( this.name !== '' ) data.name = this.name;\r\n\r\n\t\tif ( this.parameters !== undefined ) {\r\n\r\n\t\t\tvar parameters = this.parameters;\r\n\r\n\t\t\tfor ( var key in parameters ) {\r\n\r\n\t\t\t\tif ( parameters[ key ] !== undefined ) data[ key ] = parameters[ key ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t\tvar vertices = [];\r\n\r\n\t\tfor ( var i = 0; i < this.vertices.length; i ++ ) {\r\n\r\n\t\t\tvar vertex = this.vertices[ i ];\r\n\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t}\r\n\r\n\t\tvar faces = [];\r\n\t\tvar normals = [];\r\n\t\tvar normalsHash = {};\r\n\t\tvar colors = [];\r\n\t\tvar colorsHash = {};\r\n\t\tvar uvs = [];\r\n\t\tvar uvsHash = {};\r\n\r\n\t\tfor ( var i = 0; i < this.faces.length; i ++ ) {\r\n\r\n\t\t\tvar face = this.faces[ i ];\r\n\r\n\t\t\tvar hasMaterial = false; // face.materialIndex !== undefined;\r\n\t\t\tvar hasFaceUv = false; // deprecated\r\n\t\t\tvar hasFaceVertexUv = this.faceVertexUvs[ 0 ][ i ] !== undefined;\r\n\t\t\tvar hasFaceNormal = face.normal.length() > 0;\r\n\t\t\tvar hasFaceVertexNormal = face.vertexNormals.length > 0;\r\n\t\t\tvar hasFaceColor = face.color.r !== 1 || face.color.g !== 1 || face.color.b !== 1;\r\n\t\t\tvar hasFaceVertexColor = face.vertexColors.length > 0;\r\n\r\n\t\t\tvar faceType = 0;\r\n\r\n\t\t\tfaceType = setBit( faceType, 0, 0 );\r\n\t\t\tfaceType = setBit( faceType, 1, hasMaterial );\r\n\t\t\tfaceType = setBit( faceType, 2, hasFaceUv );\r\n\t\t\tfaceType = setBit( faceType, 3, hasFaceVertexUv );\r\n\t\t\tfaceType = setBit( faceType, 4, hasFaceNormal );\r\n\t\t\tfaceType = setBit( faceType, 5, hasFaceVertexNormal );\r\n\t\t\tfaceType = setBit( faceType, 6, hasFaceColor );\r\n\t\t\tfaceType = setBit( faceType, 7, hasFaceVertexColor );\r\n\r\n\t\t\tfaces.push( faceType );\r\n\t\t\tfaces.push( face.a, face.b, face.c );\r\n\r\n\t\t\tif ( hasFaceVertexUv ) {\r\n\r\n\t\t\t\tvar faceVertexUvs = this.faceVertexUvs[ 0 ][ i ];\r\n\r\n\t\t\t\tfaces.push(\r\n\t\t\t\t\tgetUvIndex( faceVertexUvs[ 0 ] ),\r\n\t\t\t\t\tgetUvIndex( faceVertexUvs[ 1 ] ),\r\n\t\t\t\t\tgetUvIndex( faceVertexUvs[ 2 ] )\r\n\t\t\t\t);\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( hasFaceNormal ) {\r\n\r\n\t\t\t\tfaces.push( getNormalIndex( face.normal ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( hasFaceVertexNormal ) {\r\n\r\n\t\t\t\tvar vertexNormals = face.vertexNormals;\r\n\r\n\t\t\t\tfaces.push(\r\n\t\t\t\t\tgetNormalIndex( vertexNormals[ 0 ] ),\r\n\t\t\t\t\tgetNormalIndex( vertexNormals[ 1 ] ),\r\n\t\t\t\t\tgetNormalIndex( vertexNormals[ 2 ] )\r\n\t\t\t\t);\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( hasFaceColor ) {\r\n\r\n\t\t\t\tfaces.push( getColorIndex( face.color ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( hasFaceVertexColor ) {\r\n\r\n\t\t\t\tvar vertexColors = face.vertexColors;\r\n\r\n\t\t\t\tfaces.push(\r\n\t\t\t\t\tgetColorIndex( vertexColors[ 0 ] ),\r\n\t\t\t\t\tgetColorIndex( vertexColors[ 1 ] ),\r\n\t\t\t\t\tgetColorIndex( vertexColors[ 2 ] )\r\n\t\t\t\t);\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction setBit( value, position, enabled ) {\r\n\r\n\t\t\treturn enabled ? value | ( 1 << position ) : value & ( ~ ( 1 << position ) );\r\n\r\n\t\t}\r\n\r\n\t\tfunction getNormalIndex( normal ) {\r\n\r\n\t\t\tvar hash = normal.x.toString() + normal.y.toString() + normal.z.toString();\r\n\r\n\t\t\tif ( normalsHash[ hash ] !== undefined ) {\r\n\r\n\t\t\t\treturn normalsHash[ hash ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tnormalsHash[ hash ] = normals.length / 3;\r\n\t\t\tnormals.push( normal.x, normal.y, normal.z );\r\n\r\n\t\t\treturn normalsHash[ hash ];\r\n\r\n\t\t}\r\n\r\n\t\tfunction getColorIndex( color ) {\r\n\r\n\t\t\tvar hash = color.r.toString() + color.g.toString() + color.b.toString();\r\n\r\n\t\t\tif ( colorsHash[ hash ] !== undefined ) {\r\n\r\n\t\t\t\treturn colorsHash[ hash ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcolorsHash[ hash ] = colors.length;\r\n\t\t\tcolors.push( color.getHex() );\r\n\r\n\t\t\treturn colorsHash[ hash ];\r\n\r\n\t\t}\r\n\r\n\t\tfunction getUvIndex( uv ) {\r\n\r\n\t\t\tvar hash = uv.x.toString() + uv.y.toString();\r\n\r\n\t\t\tif ( uvsHash[ hash ] !== undefined ) {\r\n\r\n\t\t\t\treturn uvsHash[ hash ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tuvsHash[ hash ] = uvs.length / 2;\r\n\t\t\tuvs.push( uv.x, uv.y );\r\n\r\n\t\t\treturn uvsHash[ hash ];\r\n\r\n\t\t}\r\n\r\n\t\tdata.data = {};\r\n\r\n\t\tdata.data.vertices = vertices;\r\n\t\tdata.data.normals = normals;\r\n\t\tif ( colors.length > 0 ) data.data.colors = colors;\r\n\t\tif ( uvs.length > 0 ) data.data.uvs = [ uvs ]; // temporal backward compatibility\r\n\t\tdata.data.faces = faces;\r\n\r\n\t\treturn data;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( source ) {\r\n\r\n\t\tthis.vertices = [];\r\n\t\tthis.faces = [];\r\n\t\tthis.faceVertexUvs = [ [] ];\r\n\r\n\t\tvar vertices = source.vertices;\r\n\r\n\t\tfor ( var i = 0, il = vertices.length; i < il; i ++ ) {\r\n\r\n\t\t\tthis.vertices.push( vertices[ i ].clone() );\r\n\r\n\t\t}\r\n\r\n\t\tvar faces = source.faces;\r\n\r\n\t\tfor ( var i = 0, il = faces.length; i < il; i ++ ) {\r\n\r\n\t\t\tthis.faces.push( faces[ i ].clone() );\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0, il = source.faceVertexUvs.length; i < il; i ++ ) {\r\n\r\n\t\t\tvar faceVertexUvs = source.faceVertexUvs[ i ];\r\n\r\n\t\t\tif ( this.faceVertexUvs[ i ] === undefined ) {\r\n\r\n\t\t\t\tthis.faceVertexUvs[ i ] = [];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var j = 0, jl = faceVertexUvs.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\tvar uvs = faceVertexUvs[ j ], uvsCopy = [];\r\n\r\n\t\t\t\tfor ( var k = 0, kl = uvs.length; k < kl; k ++ ) {\r\n\r\n\t\t\t\t\tvar uv = uvs[ k ];\r\n\r\n\t\t\t\t\tuvsCopy.push( uv.clone() );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.faceVertexUvs[ i ].push( uvsCopy );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdispose: function () {\r\n\r\n\t\tthis.dispatchEvent( { type: 'dispose' } );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply( THREE.Geometry.prototype );\r\n\r\nTHREE.GeometryIdCount = 0;\r\n\r\n// File:src/core/DirectGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.DirectGeometry = function () {\r\n\r\n\tObject.defineProperty( this, 'id', { value: THREE.GeometryIdCount ++ } );\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\tthis.name = '';\r\n\tthis.type = 'DirectGeometry';\r\n\r\n\tthis.indices = [];\r\n\tthis.vertices = [];\r\n\tthis.normals = [];\r\n\tthis.colors = [];\r\n\tthis.uvs = [];\r\n\tthis.uvs2 = [];\r\n\r\n\tthis.groups = [];\r\n\r\n\tthis.morphTargets = {};\r\n\r\n\tthis.skinWeights = [];\r\n\tthis.skinIndices = [];\r\n\r\n\t// this.lineDistances = [];\r\n\r\n\tthis.boundingBox = null;\r\n\tthis.boundingSphere = null;\r\n\r\n\t// update flags\r\n\r\n\tthis.verticesNeedUpdate = false;\r\n\tthis.normalsNeedUpdate = false;\r\n\tthis.colorsNeedUpdate = false;\r\n\tthis.uvsNeedUpdate = false;\r\n\tthis.groupsNeedUpdate = false;\r\n\r\n};\r\n\r\nTHREE.DirectGeometry.prototype = {\r\n\r\n\tconstructor: THREE.DirectGeometry,\r\n\r\n\tcomputeBoundingBox: THREE.Geometry.prototype.computeBoundingBox,\r\n\tcomputeBoundingSphere: THREE.Geometry.prototype.computeBoundingSphere,\r\n\r\n\tcomputeFaceNormals: function () {\r\n\r\n\t\tconsole.warn( 'THREE.DirectGeometry: computeFaceNormals() is not a method of this type of geometry.' );\r\n\r\n\t},\r\n\r\n\tcomputeVertexNormals: function () {\r\n\r\n\t\tconsole.warn( 'THREE.DirectGeometry: computeVertexNormals() is not a method of this type of geometry.' );\r\n\r\n\t},\r\n\r\n\tcomputeGroups: function ( geometry ) {\r\n\r\n\t\tvar group;\r\n\t\tvar groups = [];\r\n\t\tvar materialIndex;\r\n\r\n\t\tvar faces = geometry.faces;\r\n\r\n\t\tfor ( var i = 0; i < faces.length; i ++ ) {\r\n\r\n\t\t\tvar face = faces[ i ];\r\n\r\n\t\t\t// materials\r\n\r\n\t\t\tif ( face.materialIndex !== materialIndex ) {\r\n\r\n\t\t\t\tmaterialIndex = face.materialIndex;\r\n\r\n\t\t\t\tif ( group !== undefined ) {\r\n\r\n\t\t\t\t\tgroup.count = ( i * 3 ) - group.start;\r\n\t\t\t\t\tgroups.push( group );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgroup = {\r\n\t\t\t\t\tstart: i * 3,\r\n\t\t\t\t\tmaterialIndex: materialIndex\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( group !== undefined ) {\r\n\r\n\t\t\tgroup.count = ( i * 3 ) - group.start;\r\n\t\t\tgroups.push( group );\r\n\r\n\t\t}\r\n\r\n\t\tthis.groups = groups;\r\n\r\n\t},\r\n\r\n\tfromGeometry: function ( geometry ) {\r\n\r\n\t\tvar faces = geometry.faces;\r\n\t\tvar vertices = geometry.vertices;\r\n\t\tvar faceVertexUvs = geometry.faceVertexUvs;\r\n\r\n\t\tvar hasFaceVertexUv = faceVertexUvs[ 0 ] && faceVertexUvs[ 0 ].length > 0;\r\n\t\tvar hasFaceVertexUv2 = faceVertexUvs[ 1 ] && faceVertexUvs[ 1 ].length > 0;\r\n\r\n\t\t// morphs\r\n\r\n\t\tvar morphTargets = geometry.morphTargets;\r\n\t\tvar morphTargetsLength = morphTargets.length;\r\n\r\n\t\tif ( morphTargetsLength > 0 ) {\r\n\r\n\t\t\tvar morphTargetsPosition = [];\r\n\r\n\t\t\tfor ( var i = 0; i < morphTargetsLength; i ++ ) {\r\n\r\n\t\t\t\tmorphTargetsPosition[ i ] = [];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.morphTargets.position = morphTargetsPosition;\r\n\r\n\t\t}\r\n\r\n\t\tvar morphNormals = geometry.morphNormals;\r\n\t\tvar morphNormalsLength = morphNormals.length;\r\n\r\n\t\tif ( morphNormalsLength > 0 ) {\r\n\r\n\t\t\tvar morphTargetsNormal = [];\r\n\r\n\t\t\tfor ( var i = 0; i < morphNormalsLength; i ++ ) {\r\n\r\n\t\t\t\tmorphTargetsNormal[ i ] = [];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.morphTargets.normal = morphTargetsNormal;\r\n\r\n\t\t}\r\n\r\n\t\t// skins\r\n\r\n\t\tvar skinIndices = geometry.skinIndices;\r\n\t\tvar skinWeights = geometry.skinWeights;\r\n\r\n\t\tvar hasSkinIndices = skinIndices.length === vertices.length;\r\n\t\tvar hasSkinWeights = skinWeights.length === vertices.length;\r\n\r\n\t\t//\r\n\r\n\t\tfor ( var i = 0; i < faces.length; i ++ ) {\r\n\r\n\t\t\tvar face = faces[ i ];\r\n\r\n\t\t\tthis.vertices.push( vertices[ face.a ], vertices[ face.b ], vertices[ face.c ] );\r\n\r\n\t\t\tvar vertexNormals = face.vertexNormals;\r\n\r\n\t\t\tif ( vertexNormals.length === 3 ) {\r\n\r\n\t\t\t\tthis.normals.push( vertexNormals[ 0 ], vertexNormals[ 1 ], vertexNormals[ 2 ] );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvar normal = face.normal;\r\n\r\n\t\t\t\tthis.normals.push( normal, normal, normal );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar vertexColors = face.vertexColors;\r\n\r\n\t\t\tif ( vertexColors.length === 3 ) {\r\n\r\n\t\t\t\tthis.colors.push( vertexColors[ 0 ], vertexColors[ 1 ], vertexColors[ 2 ] );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvar color = face.color;\r\n\r\n\t\t\t\tthis.colors.push( color, color, color );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( hasFaceVertexUv === true ) {\r\n\r\n\t\t\t\tvar vertexUvs = faceVertexUvs[ 0 ][ i ];\r\n\r\n\t\t\t\tif ( vertexUvs !== undefined ) {\r\n\r\n\t\t\t\t\tthis.uvs.push( vertexUvs[ 0 ], vertexUvs[ 1 ], vertexUvs[ 2 ] );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ', i );\r\n\r\n\t\t\t\t\tthis.uvs.push( new THREE.Vector2(), new THREE.Vector2(), new THREE.Vector2() );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( hasFaceVertexUv2 === true ) {\r\n\r\n\t\t\t\tvar vertexUvs = faceVertexUvs[ 1 ][ i ];\r\n\r\n\t\t\t\tif ( vertexUvs !== undefined ) {\r\n\r\n\t\t\t\t\tthis.uvs2.push( vertexUvs[ 0 ], vertexUvs[ 1 ], vertexUvs[ 2 ] );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ', i );\r\n\r\n\t\t\t\t\tthis.uvs2.push( new THREE.Vector2(), new THREE.Vector2(), new THREE.Vector2() );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// morphs\r\n\r\n\t\t\tfor ( var j = 0; j < morphTargetsLength; j ++ ) {\r\n\r\n\t\t\t\tvar morphTarget = morphTargets[ j ].vertices;\r\n\r\n\t\t\t\tmorphTargetsPosition[ j ].push( morphTarget[ face.a ], morphTarget[ face.b ], morphTarget[ face.c ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var j = 0; j < morphNormalsLength; j ++ ) {\r\n\r\n\t\t\t\tvar morphNormal = morphNormals[ j ].vertexNormals[ i ];\r\n\r\n\t\t\t\tmorphTargetsNormal[ j ].push( morphNormal.a, morphNormal.b, morphNormal.c );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// skins\r\n\r\n\t\t\tif ( hasSkinIndices ) {\r\n\r\n\t\t\t\tthis.skinIndices.push( skinIndices[ face.a ], skinIndices[ face.b ], skinIndices[ face.c ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( hasSkinWeights ) {\r\n\r\n\t\t\t\tthis.skinWeights.push( skinWeights[ face.a ], skinWeights[ face.b ], skinWeights[ face.c ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tthis.computeGroups( geometry );\r\n\r\n\t\tthis.verticesNeedUpdate = geometry.verticesNeedUpdate;\r\n\t\tthis.normalsNeedUpdate = geometry.normalsNeedUpdate;\r\n\t\tthis.colorsNeedUpdate = geometry.colorsNeedUpdate;\r\n\t\tthis.uvsNeedUpdate = geometry.uvsNeedUpdate;\r\n\t\tthis.groupsNeedUpdate = geometry.groupsNeedUpdate;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdispose: function () {\r\n\r\n\t\tthis.dispatchEvent( { type: 'dispose' } );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply( THREE.DirectGeometry.prototype );\r\n\r\n// File:src/core/BufferGeometry.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.BufferGeometry = function () {\r\n\r\n\tObject.defineProperty( this, 'id', { value: THREE.GeometryIdCount ++ } );\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\tthis.name = '';\r\n\tthis.type = 'BufferGeometry';\r\n\r\n\tthis.index = null;\r\n\tthis.attributes = {};\r\n\r\n\tthis.morphAttributes = {};\r\n\r\n\tthis.groups = [];\r\n\r\n\tthis.boundingBox = null;\r\n\tthis.boundingSphere = null;\r\n\r\n\tthis.drawRange = { start: 0, count: Infinity };\r\n\r\n};\r\n\r\nTHREE.BufferGeometry.prototype = {\r\n\r\n\tconstructor: THREE.BufferGeometry,\r\n\r\n\taddIndex: function ( index ) {\r\n\r\n\t\tconsole.warn( 'THREE.BufferGeometry: .addIndex() has been renamed to .setIndex().' );\r\n\t\tthis.setIndex( index );\r\n\r\n\t},\r\n\r\n\tgetIndex: function () {\r\n\r\n\t\treturn this.index;\r\n\r\n\t},\r\n\r\n\tsetIndex: function ( index ) {\r\n\r\n\t\tthis.index = index;\r\n\r\n\t},\r\n\r\n\taddAttribute: function ( name, attribute ) {\r\n\r\n\t\tif ( attribute instanceof THREE.BufferAttribute === false && attribute instanceof THREE.InterleavedBufferAttribute === false ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.BufferGeometry: .addAttribute() now expects ( name, attribute ).' );\r\n\r\n\t\t\tthis.addAttribute( name, new THREE.BufferAttribute( arguments[ 1 ], arguments[ 2 ] ) );\r\n\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tif ( name === 'index' ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute.' );\r\n\t\t\tthis.setIndex( attribute );\r\n\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tthis.attributes[ name ] = attribute;\r\n\r\n\t},\r\n\r\n\tgetAttribute: function ( name ) {\r\n\r\n\t\treturn this.attributes[ name ];\r\n\r\n\t},\r\n\r\n\tremoveAttribute: function ( name ) {\r\n\r\n\t\tdelete this.attributes[ name ];\r\n\r\n\t},\r\n\r\n\tget drawcalls() {\r\n\r\n\t\tconsole.error( 'THREE.BufferGeometry: .drawcalls has been renamed to .groups.' );\r\n\t\treturn this.groups;\r\n\r\n\t},\r\n\r\n\tget offsets() {\r\n\r\n\t\tconsole.warn( 'THREE.BufferGeometry: .offsets has been renamed to .groups.' );\r\n\t\treturn this.groups;\r\n\r\n\t},\r\n\r\n\taddDrawCall: function ( start, count, indexOffset ) {\r\n\r\n\t\tif ( indexOffset !== undefined ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset.' );\r\n\r\n\t\t}\r\n\r\n\t\tconsole.warn( 'THREE.BufferGeometry: .addDrawCall() is now .addGroup().' );\r\n\t\tthis.addGroup( start, count );\r\n\r\n\t},\r\n\r\n\tclearDrawCalls: function () {\r\n\r\n\t\tconsole.warn( 'THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups().' );\r\n\t\tthis.clearGroups();\r\n\r\n\t},\r\n\r\n\taddGroup: function ( start, count, materialIndex ) {\r\n\r\n\t\tthis.groups.push( {\r\n\r\n\t\t\tstart: start,\r\n\t\t\tcount: count,\r\n\t\t\tmaterialIndex: materialIndex !== undefined ? materialIndex : 0\r\n\r\n\t\t} );\r\n\r\n\t},\r\n\r\n\tclearGroups: function () {\r\n\r\n\t\tthis.groups = [];\r\n\r\n\t},\r\n\r\n\tsetDrawRange: function ( start, count ) {\r\n\r\n\t\tthis.drawRange.start = start;\r\n\t\tthis.drawRange.count = count;\r\n\r\n\t},\r\n\r\n\tapplyMatrix: function ( matrix ) {\r\n\r\n\t\tvar position = this.attributes.position;\r\n\r\n\t\tif ( position !== undefined ) {\r\n\r\n\t\t\tmatrix.applyToVector3Array( position.array );\r\n\t\t\tposition.needsUpdate = true;\r\n\r\n\t\t}\r\n\r\n\t\tvar normal = this.attributes.normal;\r\n\r\n\t\tif ( normal !== undefined ) {\r\n\r\n\t\t\tvar normalMatrix = new THREE.Matrix3().getNormalMatrix( matrix );\r\n\r\n\t\t\tnormalMatrix.applyToVector3Array( normal.array );\r\n\t\t\tnormal.needsUpdate = true;\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.boundingBox !== null ) {\r\n\r\n\t\t\tthis.computeBoundingBox();\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.boundingSphere !== null ) {\r\n\r\n\t\t\tthis.computeBoundingSphere();\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\trotateX: function () {\r\n\r\n\t\t// rotate geometry around world x-axis\r\n\r\n\t\tvar m1;\r\n\r\n\t\treturn function rotateX( angle ) {\r\n\r\n\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\r\n\r\n\t\t\tm1.makeRotationX( angle );\r\n\r\n\t\t\tthis.applyMatrix( m1 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\trotateY: function () {\r\n\r\n\t\t// rotate geometry around world y-axis\r\n\r\n\t\tvar m1;\r\n\r\n\t\treturn function rotateY( angle ) {\r\n\r\n\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\r\n\r\n\t\t\tm1.makeRotationY( angle );\r\n\r\n\t\t\tthis.applyMatrix( m1 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\trotateZ: function () {\r\n\r\n\t\t// rotate geometry around world z-axis\r\n\r\n\t\tvar m1;\r\n\r\n\t\treturn function rotateZ( angle ) {\r\n\r\n\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\r\n\r\n\t\t\tm1.makeRotationZ( angle );\r\n\r\n\t\t\tthis.applyMatrix( m1 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\ttranslate: function () {\r\n\r\n\t\t// translate geometry\r\n\r\n\t\tvar m1;\r\n\r\n\t\treturn function translate( x, y, z ) {\r\n\r\n\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\r\n\r\n\t\t\tm1.makeTranslation( x, y, z );\r\n\r\n\t\t\tthis.applyMatrix( m1 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tscale: function () {\r\n\r\n\t\t// scale geometry\r\n\r\n\t\tvar m1;\r\n\r\n\t\treturn function scale( x, y, z ) {\r\n\r\n\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\r\n\r\n\t\t\tm1.makeScale( x, y, z );\r\n\r\n\t\t\tthis.applyMatrix( m1 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tlookAt: function () {\r\n\r\n\t\tvar obj;\r\n\r\n\t\treturn function lookAt( vector ) {\r\n\r\n\t\t\tif ( obj === undefined ) obj = new THREE.Object3D();\r\n\r\n\t\t\tobj.lookAt( vector );\r\n\r\n\t\t\tobj.updateMatrix();\r\n\r\n\t\t\tthis.applyMatrix( obj.matrix );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tcenter: function () {\r\n\r\n\t\tthis.computeBoundingBox();\r\n\r\n\t\tvar offset = this.boundingBox.center().negate();\r\n\r\n\t\tthis.translate( offset.x, offset.y, offset.z );\r\n\r\n\t\treturn offset;\r\n\r\n\t},\r\n\r\n\tsetFromObject: function ( object ) {\r\n\r\n\t\t// console.log( 'THREE.BufferGeometry.setFromObject(). Converting', object, this );\r\n\r\n\t\tvar geometry = object.geometry;\r\n\r\n\t\tif ( object instanceof THREE.Points || object instanceof THREE.Line ) {\r\n\r\n\t\t\tvar positions = new THREE.Float32Attribute( geometry.vertices.length * 3, 3 );\r\n\t\t\tvar colors = new THREE.Float32Attribute( geometry.colors.length * 3, 3 );\r\n\r\n\t\t\tthis.addAttribute( 'position', positions.copyVector3sArray( geometry.vertices ) );\r\n\t\t\tthis.addAttribute( 'color', colors.copyColorsArray( geometry.colors ) );\r\n\r\n\t\t\tif ( geometry.lineDistances && geometry.lineDistances.length === geometry.vertices.length ) {\r\n\r\n\t\t\t\tvar lineDistances = new THREE.Float32Attribute( geometry.lineDistances.length, 1 );\r\n\r\n\t\t\t\tthis.addAttribute( 'lineDistance', lineDistances.copyArray( geometry.lineDistances ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( geometry.boundingSphere !== null ) {\r\n\r\n\t\t\t\tthis.boundingSphere = geometry.boundingSphere.clone();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( geometry.boundingBox !== null ) {\r\n\r\n\t\t\t\tthis.boundingBox = geometry.boundingBox.clone();\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( object instanceof THREE.Mesh ) {\r\n\r\n\t\t\tif ( geometry instanceof THREE.Geometry ) {\r\n\r\n\t\t\t\tthis.fromGeometry( geometry );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tupdateFromObject: function ( object ) {\r\n\r\n\t\tvar geometry = object.geometry;\r\n\r\n\t\tif ( object instanceof THREE.Mesh ) {\r\n\r\n\t\t\tvar direct = geometry.__directGeometry;\r\n\r\n\t\t\tif ( direct === undefined ) {\r\n\r\n\t\t\t\treturn this.fromGeometry( geometry );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tdirect.verticesNeedUpdate = geometry.verticesNeedUpdate;\r\n\t\t\tdirect.normalsNeedUpdate = geometry.normalsNeedUpdate;\r\n\t\t\tdirect.colorsNeedUpdate = geometry.colorsNeedUpdate;\r\n\t\t\tdirect.uvsNeedUpdate = geometry.uvsNeedUpdate;\r\n\t\t\tdirect.groupsNeedUpdate = geometry.groupsNeedUpdate;\r\n\r\n\t\t\tgeometry.verticesNeedUpdate = false;\r\n\t\t\tgeometry.normalsNeedUpdate = false;\r\n\t\t\tgeometry.colorsNeedUpdate = false;\r\n\t\t\tgeometry.uvsNeedUpdate = false;\r\n\t\t\tgeometry.groupsNeedUpdate = false;\r\n\r\n\t\t\tgeometry = direct;\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry.verticesNeedUpdate === true ) {\r\n\r\n\t\t\tvar attribute = this.attributes.position;\r\n\r\n\t\t\tif ( attribute !== undefined ) {\r\n\r\n\t\t\t\tattribute.copyVector3sArray( geometry.vertices );\r\n\t\t\t\tattribute.needsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometry.verticesNeedUpdate = false;\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry.normalsNeedUpdate === true ) {\r\n\r\n\t\t\tvar attribute = this.attributes.normal;\r\n\r\n\t\t\tif ( attribute !== undefined ) {\r\n\r\n\t\t\t\tattribute.copyVector3sArray( geometry.normals );\r\n\t\t\t\tattribute.needsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometry.normalsNeedUpdate = false;\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry.colorsNeedUpdate === true ) {\r\n\r\n\t\t\tvar attribute = this.attributes.color;\r\n\r\n\t\t\tif ( attribute !== undefined ) {\r\n\r\n\t\t\t\tattribute.copyColorsArray( geometry.colors );\r\n\t\t\t\tattribute.needsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometry.colorsNeedUpdate = false;\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry.uvsNeedUpdate ) {\r\n\r\n\t\t\t\tvar attribute = this.attributes.uv;\r\n\r\n\t\t\t\tif ( attribute !== undefined ) {\r\n\r\n\t\t\t\t\t\tattribute.copyVector2sArray( geometry.uvs );\r\n\t\t\t\t\t\tattribute.needsUpdate = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgeometry.uvsNeedUpdate = false;\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry.lineDistancesNeedUpdate ) {\r\n\r\n\t\t\tvar attribute = this.attributes.lineDistance;\r\n\r\n\t\t\tif ( attribute !== undefined ) {\r\n\r\n\t\t\t\tattribute.copyArray( geometry.lineDistances );\r\n\t\t\t\tattribute.needsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometry.lineDistancesNeedUpdate = false;\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry.groupsNeedUpdate ) {\r\n\r\n\t\t\tgeometry.computeGroups( object.geometry );\r\n\t\t\tthis.groups = geometry.groups;\r\n\r\n\t\t\tgeometry.groupsNeedUpdate = false;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tfromGeometry: function ( geometry ) {\r\n\r\n\t\tgeometry.__directGeometry = new THREE.DirectGeometry().fromGeometry( geometry );\r\n\r\n\t\treturn this.fromDirectGeometry( geometry.__directGeometry );\r\n\r\n\t},\r\n\r\n\tfromDirectGeometry: function ( geometry ) {\r\n\r\n\t\tvar positions = new Float32Array( geometry.vertices.length * 3 );\r\n\t\tthis.addAttribute( 'position', new THREE.BufferAttribute( positions, 3 ).copyVector3sArray( geometry.vertices ) );\r\n\r\n\t\tif ( geometry.normals.length > 0 ) {\r\n\r\n\t\t\tvar normals = new Float32Array( geometry.normals.length * 3 );\r\n\t\t\tthis.addAttribute( 'normal', new THREE.BufferAttribute( normals, 3 ).copyVector3sArray( geometry.normals ) );\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry.colors.length > 0 ) {\r\n\r\n\t\t\tvar colors = new Float32Array( geometry.colors.length * 3 );\r\n\t\t\tthis.addAttribute( 'color', new THREE.BufferAttribute( colors, 3 ).copyColorsArray( geometry.colors ) );\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry.uvs.length > 0 ) {\r\n\r\n\t\t\tvar uvs = new Float32Array( geometry.uvs.length * 2 );\r\n\t\t\tthis.addAttribute( 'uv', new THREE.BufferAttribute( uvs, 2 ).copyVector2sArray( geometry.uvs ) );\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry.uvs2.length > 0 ) {\r\n\r\n\t\t\tvar uvs2 = new Float32Array( geometry.uvs2.length * 2 );\r\n\t\t\tthis.addAttribute( 'uv2', new THREE.BufferAttribute( uvs2, 2 ).copyVector2sArray( geometry.uvs2 ) );\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry.indices.length > 0 ) {\r\n\r\n\t\t\tvar TypeArray = geometry.vertices.length > 65535 ? Uint32Array : Uint16Array;\r\n\t\t\tvar indices = new TypeArray( geometry.indices.length * 3 );\r\n\t\t\tthis.setIndex( new THREE.BufferAttribute( indices, 1 ).copyIndicesArray( geometry.indices ) );\r\n\r\n\t\t}\r\n\r\n\t\t// groups\r\n\r\n\t\tthis.groups = geometry.groups;\r\n\r\n\t\t// morphs\r\n\r\n\t\tfor ( var name in geometry.morphTargets ) {\r\n\r\n\t\t\tvar array = [];\r\n\t\t\tvar morphTargets = geometry.morphTargets[ name ];\r\n\r\n\t\t\tfor ( var i = 0, l = morphTargets.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar morphTarget = morphTargets[ i ];\r\n\r\n\t\t\t\tvar attribute = new THREE.Float32Attribute( morphTarget.length * 3, 3 );\r\n\r\n\t\t\t\tarray.push( attribute.copyVector3sArray( morphTarget ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.morphAttributes[ name ] = array;\r\n\r\n\t\t}\r\n\r\n\t\t// skinning\r\n\r\n\t\tif ( geometry.skinIndices.length > 0 ) {\r\n\r\n\t\t\tvar skinIndices = new THREE.Float32Attribute( geometry.skinIndices.length * 4, 4 );\r\n\t\t\tthis.addAttribute( 'skinIndex', skinIndices.copyVector4sArray( geometry.skinIndices ) );\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry.skinWeights.length > 0 ) {\r\n\r\n\t\t\tvar skinWeights = new THREE.Float32Attribute( geometry.skinWeights.length * 4, 4 );\r\n\t\t\tthis.addAttribute( 'skinWeight', skinWeights.copyVector4sArray( geometry.skinWeights ) );\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tif ( geometry.boundingSphere !== null ) {\r\n\r\n\t\t\tthis.boundingSphere = geometry.boundingSphere.clone();\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry.boundingBox !== null ) {\r\n\r\n\t\t\tthis.boundingBox = geometry.boundingBox.clone();\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcomputeBoundingBox: function () {\r\n\r\n\t\tvar vector = new THREE.Vector3();\r\n\r\n\t\treturn function () {\r\n\r\n\t\t\tif ( this.boundingBox === null ) {\r\n\r\n\t\t\t\tthis.boundingBox = new THREE.Box3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar positions = this.attributes.position.array;\r\n\r\n\t\t\tif ( positions ) {\r\n\r\n\t\t\t\tvar bb = this.boundingBox;\r\n\t\t\t\tbb.makeEmpty();\r\n\r\n\t\t\t\tfor ( var i = 0, il = positions.length; i < il; i += 3 ) {\r\n\r\n\t\t\t\t\tvector.fromArray( positions, i );\r\n\t\t\t\t\tbb.expandByPoint( vector );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( positions === undefined || positions.length === 0 ) {\r\n\r\n\t\t\t\tthis.boundingBox.min.set( 0, 0, 0 );\r\n\t\t\t\tthis.boundingBox.max.set( 0, 0, 0 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( isNaN( this.boundingBox.min.x ) || isNaN( this.boundingBox.min.y ) || isNaN( this.boundingBox.min.z ) ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The \"position\" attribute is likely to have NaN values.', this );\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tcomputeBoundingSphere: function () {\r\n\r\n\t\tvar box = new THREE.Box3();\r\n\t\tvar vector = new THREE.Vector3();\r\n\r\n\t\treturn function () {\r\n\r\n\t\t\tif ( this.boundingSphere === null ) {\r\n\r\n\t\t\t\tthis.boundingSphere = new THREE.Sphere();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar positions = this.attributes.position.array;\r\n\r\n\t\t\tif ( positions ) {\r\n\r\n\t\t\t\tbox.makeEmpty();\r\n\r\n\t\t\t\tvar center = this.boundingSphere.center;\r\n\r\n\t\t\t\tfor ( var i = 0, il = positions.length; i < il; i += 3 ) {\r\n\r\n\t\t\t\t\tvector.fromArray( positions, i );\r\n\t\t\t\t\tbox.expandByPoint( vector );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbox.center( center );\r\n\r\n\t\t\t\t// hoping to find a boundingSphere with a radius smaller than the\r\n\t\t\t\t// boundingSphere of the boundingBox: sqrt(3) smaller in the best case\r\n\r\n\t\t\t\tvar maxRadiusSq = 0;\r\n\r\n\t\t\t\tfor ( var i = 0, il = positions.length; i < il; i += 3 ) {\r\n\r\n\t\t\t\t\tvector.fromArray( positions, i );\r\n\t\t\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( vector ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.boundingSphere.radius = Math.sqrt( maxRadiusSq );\r\n\r\n\t\t\t\tif ( isNaN( this.boundingSphere.radius ) ) {\r\n\r\n\t\t\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The \"position\" attribute is likely to have NaN values.', this );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tcomputeFaceNormals: function () {\r\n\r\n\t\t// backwards compatibility\r\n\r\n\t},\r\n\r\n\tcomputeVertexNormals: function () {\r\n\r\n\t\tvar index = this.index;\r\n\t\tvar attributes = this.attributes;\r\n\t\tvar groups = this.groups;\r\n\r\n\t\tif ( attributes.position ) {\r\n\r\n\t\t\tvar positions = attributes.position.array;\r\n\r\n\t\t\tif ( attributes.normal === undefined ) {\r\n\r\n\t\t\t\tthis.addAttribute( 'normal', new THREE.BufferAttribute( new Float32Array( positions.length ), 3 ) );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// reset existing normals to zero\r\n\r\n\t\t\t\tvar normals = attributes.normal.array;\r\n\r\n\t\t\t\tfor ( var i = 0, il = normals.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\tnormals[ i ] = 0;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar normals = attributes.normal.array;\r\n\r\n\t\t\tvar vA, vB, vC,\r\n\r\n\t\t\tpA = new THREE.Vector3(),\r\n\t\t\tpB = new THREE.Vector3(),\r\n\t\t\tpC = new THREE.Vector3(),\r\n\r\n\t\t\tcb = new THREE.Vector3(),\r\n\t\t\tab = new THREE.Vector3();\r\n\r\n\t\t\t// indexed elements\r\n\r\n\t\t\tif ( index ) {\r\n\r\n\t\t\t\tvar indices = index.array;\r\n\r\n\t\t\t\tif ( groups.length === 0 ) {\r\n\r\n\t\t\t\t\tthis.addGroup( 0, indices.length );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor ( var j = 0, jl = groups.length; j < jl; ++ j ) {\r\n\r\n\t\t\t\t\tvar group = groups[ j ];\r\n\r\n\t\t\t\t\tvar start = group.start;\r\n\t\t\t\t\tvar count = group.count;\r\n\r\n\t\t\t\t\tfor ( var i = start, il = start + count; i < il; i += 3 ) {\r\n\r\n\t\t\t\t\t\tvA = indices[ i + 0 ] * 3;\r\n\t\t\t\t\t\tvB = indices[ i + 1 ] * 3;\r\n\t\t\t\t\t\tvC = indices[ i + 2 ] * 3;\r\n\r\n\t\t\t\t\t\tpA.fromArray( positions, vA );\r\n\t\t\t\t\t\tpB.fromArray( positions, vB );\r\n\t\t\t\t\t\tpC.fromArray( positions, vC );\r\n\r\n\t\t\t\t\t\tcb.subVectors( pC, pB );\r\n\t\t\t\t\t\tab.subVectors( pA, pB );\r\n\t\t\t\t\t\tcb.cross( ab );\r\n\r\n\t\t\t\t\t\tnormals[ vA ] += cb.x;\r\n\t\t\t\t\t\tnormals[ vA + 1 ] += cb.y;\r\n\t\t\t\t\t\tnormals[ vA + 2 ] += cb.z;\r\n\r\n\t\t\t\t\t\tnormals[ vB ] += cb.x;\r\n\t\t\t\t\t\tnormals[ vB + 1 ] += cb.y;\r\n\t\t\t\t\t\tnormals[ vB + 2 ] += cb.z;\r\n\r\n\t\t\t\t\t\tnormals[ vC ] += cb.x;\r\n\t\t\t\t\t\tnormals[ vC + 1 ] += cb.y;\r\n\t\t\t\t\t\tnormals[ vC + 2 ] += cb.z;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// non-indexed elements (unconnected triangle soup)\r\n\r\n\t\t\t\tfor ( var i = 0, il = positions.length; i < il; i += 9 ) {\r\n\r\n\t\t\t\t\tpA.fromArray( positions, i );\r\n\t\t\t\t\tpB.fromArray( positions, i + 3 );\r\n\t\t\t\t\tpC.fromArray( positions, i + 6 );\r\n\r\n\t\t\t\t\tcb.subVectors( pC, pB );\r\n\t\t\t\t\tab.subVectors( pA, pB );\r\n\t\t\t\t\tcb.cross( ab );\r\n\r\n\t\t\t\t\tnormals[ i ] = cb.x;\r\n\t\t\t\t\tnormals[ i + 1 ] = cb.y;\r\n\t\t\t\t\tnormals[ i + 2 ] = cb.z;\r\n\r\n\t\t\t\t\tnormals[ i + 3 ] = cb.x;\r\n\t\t\t\t\tnormals[ i + 4 ] = cb.y;\r\n\t\t\t\t\tnormals[ i + 5 ] = cb.z;\r\n\r\n\t\t\t\t\tnormals[ i + 6 ] = cb.x;\r\n\t\t\t\t\tnormals[ i + 7 ] = cb.y;\r\n\t\t\t\t\tnormals[ i + 8 ] = cb.z;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.normalizeNormals();\r\n\r\n\t\t\tattributes.normal.needsUpdate = true;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tcomputeTangents: function () {\r\n\r\n\t\tconsole.warn( 'THREE.BufferGeometry: .computeTangents() has been removed.' );\r\n\r\n\t},\r\n\r\n\tcomputeOffsets: function ( size ) {\r\n\r\n\t\tconsole.warn( 'THREE.BufferGeometry: .computeOffsets() has been removed.')\r\n\r\n\t},\r\n\r\n\tmerge: function ( geometry, offset ) {\r\n\r\n\t\tif ( geometry instanceof THREE.BufferGeometry === false ) {\r\n\r\n\t\t\tconsole.error( 'THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.', geometry );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tvar attributes = this.attributes;\r\n\r\n\t\tfor ( var key in attributes ) {\r\n\r\n\t\t\tif ( geometry.attributes[ key ] === undefined ) continue;\r\n\r\n\t\t\tvar attribute1 = attributes[ key ];\r\n\t\t\tvar attributeArray1 = attribute1.array;\r\n\r\n\t\t\tvar attribute2 = geometry.attributes[ key ];\r\n\t\t\tvar attributeArray2 = attribute2.array;\r\n\r\n\t\t\tvar attributeSize = attribute2.itemSize;\r\n\r\n\t\t\tfor ( var i = 0, j = attributeSize * offset; i < attributeArray2.length; i ++, j ++ ) {\r\n\r\n\t\t\t\tattributeArray1[ j ] = attributeArray2[ i ];\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tnormalizeNormals: function () {\r\n\r\n\t\tvar normals = this.attributes.normal.array;\r\n\r\n\t\tvar x, y, z, n;\r\n\r\n\t\tfor ( var i = 0, il = normals.length; i < il; i += 3 ) {\r\n\r\n\t\t\tx = normals[ i ];\r\n\t\t\ty = normals[ i + 1 ];\r\n\t\t\tz = normals[ i + 2 ];\r\n\r\n\t\t\tn = 1.0 / Math.sqrt( x * x + y * y + z * z );\r\n\r\n\t\t\tnormals[ i ] *= n;\r\n\t\t\tnormals[ i + 1 ] *= n;\r\n\t\t\tnormals[ i + 2 ] *= n;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\ttoJSON: function () {\r\n\r\n\t\tvar data = {\r\n\t\t\tmetadata: {\r\n\t\t\t\tversion: 4.4,\r\n\t\t\t\ttype: 'BufferGeometry',\r\n\t\t\t\tgenerator: 'BufferGeometry.toJSON'\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t// standard BufferGeometry serialization\r\n\r\n\t\tdata.uuid = this.uuid;\r\n\t\tdata.type = this.type;\r\n\t\tif ( this.name !== '' ) data.name = this.name;\r\n\r\n\t\tif ( this.parameters !== undefined ) {\r\n\r\n\t\t\tvar parameters = this.parameters;\r\n\r\n\t\t\tfor ( var key in parameters ) {\r\n\r\n\t\t\t\tif ( parameters[ key ] !== undefined ) data[ key ] = parameters[ key ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t\tdata.data = { attributes: {} };\r\n\r\n\t\tvar index = this.index;\r\n\r\n\t\tif ( index !== null ) {\r\n\r\n\t\t\tvar array = Array.prototype.slice.call( index.array );\r\n\r\n\t\t\tdata.data.index = {\r\n\t\t\t\ttype: index.array.constructor.name,\r\n\t\t\t\tarray: array\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t\tvar attributes = this.attributes;\r\n\r\n\t\tfor ( var key in attributes ) {\r\n\r\n\t\t\tvar attribute = attributes[ key ];\r\n\r\n\t\t\tvar array = Array.prototype.slice.call( attribute.array );\r\n\r\n\t\t\tdata.data.attributes[ key ] = {\r\n\t\t\t\titemSize: attribute.itemSize,\r\n\t\t\t\ttype: attribute.array.constructor.name,\r\n\t\t\t\tarray: array\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t\tvar groups = this.groups;\r\n\r\n\t\tif ( groups.length > 0 ) {\r\n\r\n\t\t\tdata.data.groups = JSON.parse( JSON.stringify( groups ) );\r\n\r\n\t\t}\r\n\r\n\t\tvar boundingSphere = this.boundingSphere;\r\n\r\n\t\tif ( boundingSphere !== null ) {\r\n\r\n\t\t\tdata.data.boundingSphere = {\r\n\t\t\t\tcenter: boundingSphere.center.toArray(),\r\n\t\t\t\tradius: boundingSphere.radius\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t\treturn data;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( source ) {\r\n\r\n\t\tvar index = source.index;\r\n\r\n\t\tif ( index !== null ) {\r\n\r\n\t\t\tthis.setIndex( index.clone() );\r\n\r\n\t\t}\r\n\r\n\t\tvar attributes = source.attributes;\r\n\r\n\t\tfor ( var name in attributes ) {\r\n\r\n\t\t\tvar attribute = attributes[ name ];\r\n\t\t\tthis.addAttribute( name, attribute.clone() );\r\n\r\n\t\t}\r\n\r\n\t\tvar groups = source.groups;\r\n\r\n\t\tfor ( var i = 0, l = groups.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar group = groups[ i ];\r\n\t\t\tthis.addGroup( group.start, group.count );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdispose: function () {\r\n\r\n\t\tthis.dispatchEvent( { type: 'dispose' } );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply( THREE.BufferGeometry.prototype );\r\n\r\nTHREE.BufferGeometry.MaxIndex = 65535;\r\n\r\n// File:src/core/InstancedBufferGeometry.js\r\n\r\n/**\r\n * @author benaadams / https://twitter.com/ben_a_adams\r\n */\r\n\r\nTHREE.InstancedBufferGeometry = function () {\r\n\r\n\tTHREE.BufferGeometry.call( this );\r\n\r\n\tthis.type = 'InstancedBufferGeometry';\r\n\tthis.maxInstancedCount = undefined;\r\n\r\n};\r\n\r\nTHREE.InstancedBufferGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\r\nTHREE.InstancedBufferGeometry.prototype.constructor = THREE.InstancedBufferGeometry;\r\n\r\nTHREE.InstancedBufferGeometry.prototype.addGroup = function ( start, count, instances ) {\r\n\r\n\tthis.groups.push( {\r\n\r\n\t\tstart: start,\r\n\t\tcount: count,\r\n\t\tinstances: instances\r\n\r\n\t} );\r\n\r\n};\r\n\r\nTHREE.InstancedBufferGeometry.prototype.copy = function ( source ) {\r\n\r\n\tvar index = source.index;\r\n\r\n\tif ( index !== null ) {\r\n\r\n\t\tthis.setIndex( index.clone() );\r\n\r\n\t}\r\n\r\n\tvar attributes = source.attributes;\r\n\r\n\tfor ( var name in attributes ) {\r\n\r\n\t\tvar attribute = attributes[ name ];\r\n\t\tthis.addAttribute( name, attribute.clone() );\r\n\r\n\t}\r\n\r\n\tvar groups = source.groups;\r\n\r\n\tfor ( var i = 0, l = groups.length; i < l; i ++ ) {\r\n\r\n\t\tvar group = groups[ i ];\r\n\t\tthis.addGroup( group.start, group.count, group.instances );\r\n\r\n\t}\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply( THREE.InstancedBufferGeometry.prototype );\r\n\r\n// File:src/animation/AnimationAction.js\r\n\r\n/**\r\n *\r\n * A clip that has been explicitly scheduled.\r\n *\r\n * @author Ben Houston / http://clara.io/\r\n * @author David Sarno / http://lighthaus.us/\r\n */\r\n\r\nTHREE.AnimationAction = function ( clip, startTime, timeScale, weight, loop ) {\r\n\r\n\tif ( clip === undefined ) throw new Error( 'clip is null' );\r\n\tthis.clip = clip;\r\n\tthis.localRoot = null;\r\n\tthis.startTime = startTime || 0;\r\n\tthis.timeScale = timeScale || 1;\r\n\tthis.weight = weight || 1;\r\n\tthis.loop = loop || THREE.LoopRepeat;\r\n\tthis.loopCount = 0;\r\n\tthis.enabled = true;\t// allow for easy disabling of the action.\r\n\r\n\tthis.actionTime = - this.startTime;\r\n\tthis.clipTime = 0;\r\n\r\n\tthis.propertyBindings = [];\r\n};\r\n\r\n/*\r\nTHREE.LoopOnce = 2200;\r\nTHREE.LoopRepeat = 2201;\r\nTHREE.LoopPingPing = 2202;\r\n*/\r\n\r\nTHREE.AnimationAction.prototype = {\r\n\r\n\tconstructor: THREE.AnimationAction,\r\n\r\n\tsetLocalRoot: function( localRoot ) {\r\n\r\n\t\tthis.localRoot = localRoot;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tupdateTime: function( clipDeltaTime ) {\r\n\r\n\t\tvar previousClipTime = this.clipTime;\r\n   \t\tvar previousLoopCount = this.loopCount;\r\n   \t\tvar previousActionTime = this.actionTime;\r\n\r\n\t\tvar duration = this.clip.duration;\r\n\r\n\t\tthis.actionTime = this.actionTime + clipDeltaTime;\r\n\r\n\t\tif ( this.loop === THREE.LoopOnce ) {\r\n\r\n\t\t\tthis.loopCount = 0;\r\n\t\t\tthis.clipTime = Math.min( Math.max( this.actionTime, 0 ), duration );\r\n\r\n\t\t\t// if time is changed since last time, see if we have hit a start/end limit\r\n\t\t\tif ( this.clipTime !== previousClipTime ) {\r\n\r\n\t\t\t\tif ( this.clipTime === duration ) {\r\n\r\n\t\t\t\t\tthis.mixer.dispatchEvent( { type: 'finished', action: this, direction: 1 } );\r\n\r\n\t\t\t\t} else if ( this.clipTime === 0 ) {\r\n\r\n\t\t\t\t\tthis.mixer.dispatchEvent( { type: 'finished', action: this, direction: -1 } );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t\treturn this.clipTime;\r\n\r\n\t\t}\r\n\r\n\t\tthis.loopCount = Math.floor( this.actionTime / duration );\r\n\r\n\t\tvar newClipTime = this.actionTime - this.loopCount * duration;\r\n\t\tnewClipTime = newClipTime % duration;\r\n\r\n\t\t// if we are ping pong looping, ensure that we go backwards when appropriate\r\n\t\tif ( this.loop == THREE.LoopPingPong ) {\r\n\r\n\t\t\tif ( Math.abs( this.loopCount % 2 ) === 1 ) {\r\n\r\n\t\t\t\tnewClipTime = duration - newClipTime;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tthis.clipTime = newClipTime;\r\n\r\n\t\tif ( this.loopCount !== previousLoopCount ) {\r\n\r\n   \t\t\tthis.mixer.dispatchEvent( { type: 'loop', action: this, loopDelta: ( this.loopCount - this.loopCount ) } );\r\n\r\n   \t\t}\r\n\r\n\t   \treturn this.clipTime;\r\n\r\n\t},\r\n\r\n\tsyncWith: function( action ) {\r\n\r\n\t\tthis.actionTime = action.actionTime;\r\n\t\tthis.timeScale = action.timeScale;\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\twarpToDuration: function( duration ) {\r\n\r\n\t\tthis.timeScale = this.clip.duration / duration;\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\tinit: function( time ) {\r\n\r\n\t\tthis.clipTime = time - this.startTime;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tupdate: function( clipDeltaTime ) {\r\n\r\n\t\tthis.updateTime( clipDeltaTime );\r\n\r\n\t\tvar clipResults = this.clip.getAt( this.clipTime );\r\n\r\n\t\treturn clipResults;\r\n\r\n\t},\r\n\r\n\tgetTimeScaleAt: function( time ) {\r\n\r\n\t\tif ( this.timeScale.getAt ) {\r\n\t\t\t// pass in time, not clip time, allows for fadein/fadeout across multiple loops of the clip\r\n\t\t\treturn this.timeScale.getAt( time );\r\n\r\n\t\t}\r\n\r\n\t\treturn this.timeScale;\r\n\r\n\t},\r\n\r\n\tgetWeightAt: function( time ) {\r\n\r\n\t\tif ( this.weight.getAt ) {\r\n\t\t\t// pass in time, not clip time, allows for fadein/fadeout across multiple loops of the clip\r\n\t\t\treturn this.weight.getAt( time );\r\n\r\n\t\t}\r\n\r\n\t\treturn this.weight;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/animation/AnimationClip.js\r\n\r\n/**\r\n *\r\n * Reusable set of Tracks that represent an animation.\r\n *\r\n * @author Ben Houston / http://clara.io/\r\n * @author David Sarno / http://lighthaus.us/\r\n */\r\n\r\nTHREE.AnimationClip = function ( name, duration, tracks ) {\r\n\r\n\tthis.name = name;\r\n\tthis.tracks = tracks;\r\n\tthis.duration = ( duration !== undefined ) ? duration : -1;\r\n\r\n\t// this means it should figure out its duration by scanning the tracks\r\n\tif ( this.duration < 0 ) {\r\n\t\tfor ( var i = 0; i < this.tracks.length; i ++ ) {\r\n\t\t\tvar track = this.tracks[i];\r\n\t\t\tthis.duration = Math.max( track.keys[ track.keys.length - 1 ].time );\r\n\t\t}\r\n\t}\r\n\r\n\t// maybe only do these on demand, as doing them here could potentially slow down loading\r\n\t// but leaving these here during development as this ensures a lot of testing of these functions\r\n\tthis.trim();\r\n\tthis.optimize();\r\n\r\n\tthis.results = [];\r\n\r\n};\r\n\r\nTHREE.AnimationClip.prototype = {\r\n\r\n\tconstructor: THREE.AnimationClip,\r\n\r\n\tgetAt: function( clipTime ) {\r\n\r\n\t\tclipTime = Math.max( 0, Math.min( clipTime, this.duration ) );\r\n\r\n\t\tfor ( var i = 0; i < this.tracks.length; i ++ ) {\r\n\r\n\t\t\tvar track = this.tracks[ i ];\r\n\r\n\t\t\tthis.results[ i ] = track.getAt( clipTime );\r\n\r\n\t\t}\r\n\r\n\t\treturn this.results;\r\n\t},\r\n\r\n\ttrim: function() {\r\n\r\n\t\tfor ( var i = 0; i < this.tracks.length; i ++ ) {\r\n\r\n\t\t\tthis.tracks[ i ].trim( 0, this.duration );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\toptimize: function() {\r\n\r\n\t\tfor ( var i = 0; i < this.tracks.length; i ++ ) {\r\n\r\n\t\t\tthis.tracks[ i ].optimize();\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n};\r\n\r\n\r\nTHREE.AnimationClip.CreateFromMorphTargetSequence = function( name, morphTargetSequence, fps ) {\r\n\r\n\r\n\tvar numMorphTargets = morphTargetSequence.length;\r\n\tvar tracks = [];\r\n\r\n\tfor ( var i = 0; i < numMorphTargets; i ++ ) {\r\n\r\n\t\tvar keys = [];\r\n\r\n\t\tkeys.push( { time: ( i + numMorphTargets - 1 ) % numMorphTargets, value: 0 } );\r\n\t\tkeys.push( { time: i, value: 1 } );\r\n\t\tkeys.push( { time: ( i + 1 ) % numMorphTargets, value: 0 } );\r\n\r\n\t\tkeys.sort( THREE.KeyframeTrack.keyComparer );\r\n\r\n\t\t// if there is a key at the first frame, duplicate it as the last frame as well for perfect loop.\r\n\t\tif ( keys[0].time === 0 ) {\r\n\t\t\tkeys.push( {\r\n\t\t\t\ttime: numMorphTargets,\r\n\t\t\t\tvalue: keys[0].value\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\ttracks.push( new THREE.NumberKeyframeTrack( '.morphTargetInfluences[' + morphTargetSequence[i].name + ']', keys ).scale( 1.0 / fps ) );\r\n\t}\r\n\r\n\treturn new THREE.AnimationClip( name, -1, tracks );\r\n\r\n};\r\n\r\nTHREE.AnimationClip.findByName = function( clipArray, name ) {\r\n\r\n\tfor ( var i = 0; i < clipArray.length; i ++ ) {\r\n\r\n\t\tif ( clipArray[i].name === name ) {\r\n\r\n\t\t\treturn clipArray[i];\r\n\r\n\t\t}\r\n\t}\r\n\r\n\treturn null;\r\n\r\n};\r\n\r\nTHREE.AnimationClip.CreateClipsFromMorphTargetSequences = function( morphTargets, fps ) {\r\n\r\n\tvar animationToMorphTargets = {};\r\n\r\n\t// tested with https://regex101.com/ on trick sequences such flamingo_flyA_003, flamingo_run1_003, crdeath0059\r\n\tvar pattern = /^([\\w-]*?)([\\d]+)$/;\r\n\r\n\t// sort morph target names into animation groups based patterns like Walk_001, Walk_002, Run_001, Run_002\r\n\tfor ( var i = 0, il = morphTargets.length; i < il; i ++ ) {\r\n\r\n\t\tvar morphTarget = morphTargets[ i ];\r\n\t\tvar parts = morphTarget.name.match( pattern );\r\n\r\n\t\tif ( parts && parts.length > 1 ) {\r\n\r\n\t\t\tvar name = parts[ 1 ];\r\n\r\n\t\t\tvar animationMorphTargets = animationToMorphTargets[ name ];\r\n\t\t\tif ( ! animationMorphTargets ) {\r\n\t\t\t\tanimationToMorphTargets[ name ] = animationMorphTargets = [];\r\n\t\t\t}\r\n\r\n\t\t\tanimationMorphTargets.push( morphTarget );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tvar clips = [];\r\n\r\n\tfor ( var name in animationToMorphTargets ) {\r\n\r\n\t\tclips.push( THREE.AnimationClip.CreateFromMorphTargetSequence( name, animationToMorphTargets[ name ], fps ) );\r\n\t}\r\n\r\n\treturn clips;\r\n\r\n};\r\n\r\n// parse the standard JSON format for clips\r\nTHREE.AnimationClip.parse = function( json ) {\r\n\r\n\tvar tracks = [];\r\n\r\n\tfor ( var i = 0; i < json.tracks.length; i ++ ) {\r\n\r\n\t\ttracks.push( THREE.KeyframeTrack.parse( json.tracks[i] ).scale( 1.0 / json.fps ) );\r\n\r\n\t}\r\n\r\n\treturn new THREE.AnimationClip( json.name, json.duration, tracks );\r\n\r\n};\r\n\r\n\r\n// parse the animation.hierarchy format\r\nTHREE.AnimationClip.parseAnimation = function( animation, bones, nodeName ) {\r\n\r\n\tif ( ! animation ) {\r\n\t\tconsole.error( \"  no animation in JSONLoader data\" );\r\n\t\treturn null;\r\n\t}\r\n\r\n\tvar convertTrack = function( trackName, animationKeys, propertyName, trackType, animationKeyToValueFunc ) {\r\n\r\n\t\tvar keys = [];\r\n\r\n\t\tfor ( var k = 0; k < animationKeys.length; k ++ ) {\r\n\r\n\t\t\tvar animationKey = animationKeys[k];\r\n\r\n\t\t\tif ( animationKey[propertyName] !== undefined ) {\r\n\r\n\t\t\t\tkeys.push( { time: animationKey.time, value: animationKeyToValueFunc( animationKey ) } );\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// only return track if there are actually keys.\r\n\t\tif ( keys.length > 0 ) {\r\n\r\n\t\t\treturn new trackType( trackName, keys );\r\n\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\r\n\t};\r\n\r\n\tvar tracks = [];\r\n\r\n\tvar clipName = animation.name || 'default';\r\n\tvar duration = animation.length || -1; // automatic length determination in AnimationClip.\r\n\tvar fps = animation.fps || 30;\r\n\r\n\tvar hierarchyTracks = animation.hierarchy || [];\r\n\r\n\tfor ( var h = 0; h < hierarchyTracks.length; h ++ ) {\r\n\r\n\t\tvar animationKeys = hierarchyTracks[ h ].keys;\r\n\r\n\t\t// skip empty tracks\r\n\t\tif ( ! animationKeys || animationKeys.length == 0 ) {\r\n\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\t// process morph targets in a way exactly compatible with AnimationHandler.init( animation )\r\n\t\tif ( animationKeys[0].morphTargets ) {\r\n\r\n\t\t\t// figure out all morph targets used in this track\r\n\t\t\tvar morphTargetNames = {};\r\n\t\t\tfor ( var k = 0; k < animationKeys.length; k ++ ) {\r\n\r\n\t\t\t\tif ( animationKeys[k].morphTargets ) {\r\n\t\t\t\t\tfor ( var m = 0; m < animationKeys[k].morphTargets.length; m ++ ) {\r\n\r\n\t\t\t\t\t\tmorphTargetNames[ animationKeys[k].morphTargets[m] ] = -1;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// create a track for each morph target with all zero morphTargetInfluences except for the keys in which the morphTarget is named.\r\n\t\t\tfor ( var morphTargetName in morphTargetNames ) {\r\n\r\n\t\t\t\tvar keys = [];\r\n\r\n\t\t\t\tfor ( var m = 0; m < animationKeys[k].morphTargets.length; m ++ ) {\r\n\r\n\t\t\t\t\tvar animationKey = animationKeys[k];\r\n\r\n\t\t\t\t\tkeys.push( {\r\n\t\t\t\t\t\t\ttime: animationKey.time,\r\n\t\t\t\t\t\t\tvalue: (( animationKey.morphTarget === morphTargetName ) ? 1 : 0 )\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttracks.push( new THREE.NumberKeyframeTrack( nodeName + '.morphTargetInfluence[' + morphTargetName + ']', keys ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tduration = morphTargetNames.length * ( fps || 1.0 );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tvar boneName = nodeName + '.bones[' + bones[ h ].name + ']';\r\n\r\n\t\t\t// track contains positions...\r\n\t\t\tvar positionTrack = convertTrack( boneName + '.position', animationKeys, 'pos', THREE.VectorKeyframeTrack, function( animationKey ) {\r\n\t\t\t\t\treturn new THREE.Vector3().fromArray( animationKey.pos )\r\n\t\t\t\t} );\r\n\r\n\t\t\tif ( positionTrack ) tracks.push( positionTrack );\r\n\r\n\t\t\t// track contains quaternions...\r\n\t\t\tvar quaternionTrack = convertTrack( boneName + '.quaternion', animationKeys, 'rot', THREE.QuaternionKeyframeTrack, function( animationKey ) {\r\n\t\t\t\t\tif ( animationKey.rot.slerp ) {\r\n\t\t\t\t\t\treturn animationKey.rot.clone();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn new THREE.Quaternion().fromArray( animationKey.rot );\r\n\t\t\t\t\t}\r\n\t\t\t\t} );\r\n\r\n\t\t\tif ( quaternionTrack ) tracks.push( quaternionTrack );\r\n\r\n\t\t\t// track contains quaternions...\r\n\t\t\tvar scaleTrack = convertTrack( boneName + '.scale', animationKeys, 'scl', THREE.VectorKeyframeTrack, function( animationKey ) {\r\n\t\t\t\t\treturn new THREE.Vector3().fromArray( animationKey.scl )\r\n\t\t\t\t} );\r\n\r\n\t\t\tif ( scaleTrack ) tracks.push( scaleTrack );\r\n\r\n\t\t}\r\n\t}\r\n\r\n\tif ( tracks.length === 0 ) {\r\n\r\n\t\treturn null;\r\n\r\n\t}\r\n\r\n\tvar clip = new THREE.AnimationClip( clipName, duration, tracks );\r\n\r\n\treturn clip;\r\n\r\n};\r\n\r\n// File:src/animation/AnimationMixer.js\r\n\r\n/**\r\n *\r\n * Mixes together the AnimationClips scheduled by AnimationActions and applies them to the root and subtree\r\n *\r\n *\r\n * @author Ben Houston / http://clara.io/\r\n * @author David Sarno / http://lighthaus.us/\r\n */\r\n\r\nTHREE.AnimationMixer = function( root ) {\r\n\r\n\tthis.root = root;\r\n\tthis.time = 0;\r\n\tthis.timeScale = 1.0;\r\n\tthis.actions = [];\r\n\tthis.propertyBindingMap = {};\r\n\r\n};\r\n\r\nTHREE.AnimationMixer.prototype = {\r\n\r\n\tconstructor: THREE.AnimationMixer,\r\n\r\n\taddAction: function( action ) {\r\n\r\n\t\t// TODO: check for duplicate action names?  Or provide each action with a UUID?\r\n\r\n\t\tthis.actions.push( action );\r\n\t\taction.init( this.time );\r\n\t\taction.mixer = this;\r\n\r\n\t\tvar tracks = action.clip.tracks;\r\n\r\n\t\tvar root = action.localRoot || this.root;\r\n\r\n\t\tfor ( var i = 0; i < tracks.length; i ++ ) {\r\n\r\n\t\t\tvar track = tracks[ i ];\r\n\r\n\t\t\tvar propertyBindingKey = root.uuid + '-' + track.name;\r\n\t\t\tvar propertyBinding = this.propertyBindingMap[ propertyBindingKey ];\r\n\r\n\t\t\tif ( propertyBinding === undefined ) {\r\n\r\n\t\t\t\tpropertyBinding = new THREE.PropertyBinding( root, track.name );\r\n\t\t\t\tthis.propertyBindingMap[ propertyBindingKey ] = propertyBinding;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// push in the same order as the tracks.\r\n\t\t\taction.propertyBindings.push( propertyBinding );\r\n\r\n\t\t\t// track usages of shared property bindings, because if we leave too many around, the mixer can get slow\r\n\t\t\tpropertyBinding.referenceCount += 1;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tremoveAllActions: function() {\r\n\r\n\t\tfor ( var i = 0; i < this.actions.length; i ++ ) {\r\n\r\n\t\t\tthis.actions[i].mixer = null;\r\n\r\n\t\t}\r\n\r\n\t\t// unbind all property bindings\r\n\t\tfor ( var properyBindingKey in this.propertyBindingMap ) {\r\n\r\n\t\t\tthis.propertyBindingMap[ properyBindingKey ].unbind();\r\n\r\n\t\t}\r\n\r\n\t\tthis.actions = [];\r\n\t\tthis.propertyBindingMap = {};\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tremoveAction: function( action ) {\r\n\r\n\t\tvar index = this.actions.indexOf( action );\r\n\r\n\t\tif ( index !== - 1 ) {\r\n\r\n\t\t\tthis.actions.splice( index, 1 );\r\n\t\t\taction.mixer = null;\r\n\r\n\t\t}\r\n\r\n\r\n\t\t// remove unused property bindings because if we leave them around the mixer can get slow\r\n\t\tvar root = action.localRoot || this.root;\r\n\t\tvar tracks = action.clip.tracks;\r\n\r\n\t\tfor ( var i = 0; i < tracks.length; i ++ ) {\r\n\r\n\t\t\tvar track = tracks[ i ];\r\n\r\n\t\t\tvar propertyBindingKey = root.uuid + '-' + track.name;\r\n\t\t\tvar propertyBinding = this.propertyBindingMap[ propertyBindingKey ];\r\n\r\n\t\t\tpropertyBinding.referenceCount -= 1;\r\n\r\n\t\t\tif ( propertyBinding.referenceCount <= 0 ) {\r\n\r\n\t\t\t\tpropertyBinding.unbind();\r\n\r\n\t\t\t\tdelete this.propertyBindingMap[ propertyBindingKey ];\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\t// can be optimized if needed\r\n\tfindActionByName: function( name ) {\r\n\r\n\t\tfor ( var i = 0; i < this.actions.length; i ++ ) {\r\n\r\n\t\t\tif ( this.actions[i].name === name ) return this.actions[i];\r\n\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\r\n\t},\r\n\r\n\tplay: function( action, optionalFadeInDuration ) {\r\n\r\n\t\taction.startTime = this.time;\r\n\t\tthis.addAction( action );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tfadeOut: function( action, duration ) {\r\n\r\n\t\tvar keys = [];\r\n\r\n\t\tkeys.push( { time: this.time, value: 1 } );\r\n\t\tkeys.push( { time: this.time + duration, value: 0 } );\r\n\r\n\t\taction.weight = new THREE.NumberKeyframeTrack( \"weight\", keys );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tfadeIn: function( action, duration ) {\r\n\r\n\t\tvar keys = [];\r\n\r\n\t\tkeys.push( { time: this.time, value: 0 } );\r\n\t\tkeys.push( { time: this.time + duration, value: 1 } );\r\n\r\n\t\taction.weight = new THREE.NumberKeyframeTrack( \"weight\", keys );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\twarp: function( action, startTimeScale, endTimeScale, duration ) {\r\n\r\n\t\tvar keys = [];\r\n\r\n\t\tkeys.push( { time: this.time, value: startTimeScale } );\r\n\t\tkeys.push( { time: this.time + duration, value: endTimeScale } );\r\n\r\n\t\taction.timeScale = new THREE.NumberKeyframeTrack( \"timeScale\", keys );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcrossFade: function( fadeOutAction, fadeInAction, duration, warp ) {\r\n\r\n\t\tthis.fadeOut( fadeOutAction, duration );\r\n\t\tthis.fadeIn( fadeInAction, duration );\r\n\r\n\t\tif ( warp ) {\r\n\r\n\t\t\tvar startEndRatio = fadeOutAction.clip.duration / fadeInAction.clip.duration;\r\n\t\t\tvar endStartRatio = 1.0 / startEndRatio;\r\n\r\n\t\t\tthis.warp( fadeOutAction, 1.0, startEndRatio, duration );\r\n\t\t\tthis.warp( fadeInAction, endStartRatio, 1.0, duration );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tupdate: function( deltaTime ) {\r\n\r\n\t\tvar mixerDeltaTime = deltaTime * this.timeScale;\r\n\t\tthis.time += mixerDeltaTime;\r\n\r\n\t\tfor ( var i = 0; i < this.actions.length; i ++ ) {\r\n\r\n\t\t\tvar action = this.actions[i];\r\n\r\n\t\t\tvar weight = action.getWeightAt( this.time );\r\n\r\n\t\t\tvar actionTimeScale = action.getTimeScaleAt( this.time );\r\n\t\t\tvar actionDeltaTime = mixerDeltaTime * actionTimeScale;\r\n\r\n\t\t\tvar actionResults = action.update( actionDeltaTime );\r\n\r\n\t\t\tif ( action.weight <= 0 || ! action.enabled ) continue;\r\n\r\n\t\t\tfor ( var j = 0; j < actionResults.length; j ++ ) {\r\n\r\n\t\t\t\tvar name = action.clip.tracks[j].name;\r\n\r\n\t\t\t\taction.propertyBindings[ j ].accumulate( actionResults[j], weight );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// apply to nodes\r\n\t\tfor ( var propertyBindingKey in this.propertyBindingMap ) {\r\n\r\n\t\t\tthis.propertyBindingMap[ propertyBindingKey ].apply();\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply( THREE.AnimationMixer.prototype );\r\n\r\n// File:src/animation/AnimationUtils.js\r\n\r\n/**\r\n * @author Ben Houston / http://clara.io/\r\n * @author David Sarno / http://lighthaus.us/\r\n */\r\n\r\nTHREE.AnimationUtils = {\r\n\r\n\tgetEqualsFunc: function( exemplarValue ) {\r\n\r\n\t\tif ( exemplarValue.equals ) {\r\n\t\t\treturn function equals_object( a, b ) {\r\n\t\t\t\treturn a.equals( b );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn function equals_primitive( a, b ) {\r\n\t\t\treturn ( a === b );\r\n\t\t};\r\n\r\n\t},\r\n\r\n\tclone: function( exemplarValue ) {\r\n\r\n\t\tvar typeName = typeof exemplarValue;\r\n\t\tif ( typeName === \"object\" ) {\r\n\t\t\tif ( exemplarValue.clone ) {\r\n\t\t\t\treturn exemplarValue.clone();\r\n\t\t\t}\r\n\t\t\tconsole.error( \"can not figure out how to copy exemplarValue\", exemplarValue );\r\n\t\t}\r\n\r\n\t\treturn exemplarValue;\r\n\r\n\t},\r\n\r\n\tlerp: function( a, b, alpha, interTrack ) {\r\n\r\n\t\tvar lerpFunc = THREE.AnimationUtils.getLerpFunc( a, interTrack );\r\n\r\n\t\treturn lerpFunc( a, b, alpha );\r\n\r\n\t},\r\n\r\n\tlerp_object: function( a, b, alpha ) {\r\n\t\treturn a.lerp( b, alpha );\r\n\t},\r\n\r\n\tslerp_object: function( a, b, alpha ) {\r\n\t\treturn a.slerp( b, alpha );\r\n\t},\r\n\r\n\tlerp_number: function( a, b, alpha ) {\r\n\t\treturn a * ( 1 - alpha ) + b * alpha;\r\n\t},\r\n\r\n\tlerp_boolean: function( a, b, alpha ) {\r\n\t\treturn ( alpha < 0.5 ) ? a : b;\r\n\t},\r\n\r\n\tlerp_boolean_immediate: function( a, b, alpha ) {\r\n\t\treturn a;\r\n\t},\r\n\r\n\tlerp_string: function( a, b, alpha ) {\r\n\t\treturn ( alpha < 0.5 ) ? a : b;\r\n\t},\r\n\r\n\tlerp_string_immediate: function( a, b, alpha ) {\r\n \t\treturn a;\r\n \t},\r\n\r\n\t// NOTE: this is an accumulator function that modifies the first argument (e.g. a).\tThis is to minimize memory alocations.\r\n\tgetLerpFunc: function( exemplarValue, interTrack ) {\r\n\r\n\t\tif ( exemplarValue === undefined || exemplarValue === null ) throw new Error( \"examplarValue is null\" );\r\n\r\n\t\tvar typeName = typeof exemplarValue;\r\n\r\n\t\tswitch( typeName ) {\r\n\r\n\t\t\tcase \"object\":\r\n\t\t\t\tif ( exemplarValue.lerp ) {\r\n\t\t\t\t\treturn THREE.AnimationUtils.lerp_object;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( exemplarValue.slerp ) {\r\n\t\t\t\t\treturn THREE.AnimationUtils.slerp_object;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase \"number\":\r\n\t\t\t\treturn THREE.AnimationUtils.lerp_number;\r\n\r\n\t\t\tcase \"boolean\":\r\n\t\t\t\tif ( interTrack ) {\r\n\t\t\t\t\treturn THREE.AnimationUtils.lerp_boolean;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn THREE.AnimationUtils.lerp_boolean_immediate;\r\n\t\t\t\t}\r\n\r\n\t\t\tcase \"string\":\r\n\t\t\t\tif ( interTrack ) {\r\n\t\t\t\t\treturn THREE.AnimationUtils.lerp_string;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn THREE.AnimationUtils.lerp_string_immediate;\r\n\t\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/animation/KeyframeTrack.js\r\n\r\n/**\r\n *\r\n * A Track that returns a keyframe interpolated value, currently linearly interpolated\r\n *\r\n * @author Ben Houston / http://clara.io/\r\n * @author David Sarno / http://lighthaus.us/\r\n */\r\n\r\nTHREE.KeyframeTrack = function ( name, keys ) {\r\n\r\n\tif ( name === undefined ) throw new Error( \"track name is undefined\" );\r\n\tif ( keys === undefined || keys.length === 0 ) throw new Error( \"no keys in track named \" + name );\r\n\r\n\tthis.name = name;\r\n\tthis.keys = keys;\t// time in seconds, value as value\r\n\r\n\t// the index of the last result, used as a starting point for local search.\r\n\tthis.lastIndex = 0;\r\n\r\n\tthis.validate();\r\n\tthis.optimize();\r\n\r\n};\r\n\r\nTHREE.KeyframeTrack.prototype = {\r\n\r\n\tconstructor: THREE.KeyframeTrack,\r\n\r\n\tgetAt: function( time ) {\r\n\r\n\r\n\t\t// this can not go higher than this.keys.length.\r\n\t\twhile( ( this.lastIndex < this.keys.length ) && ( time >= this.keys[this.lastIndex].time ) ) {\r\n\t\t\tthis.lastIndex ++;\r\n\t\t};\r\n\r\n\t\t// this can not go lower than 0.\r\n\t\twhile( ( this.lastIndex > 0 ) && ( time < this.keys[this.lastIndex - 1].time ) ) {\r\n\t\t\tthis.lastIndex --;\r\n\t\t}\r\n\r\n\t\tif ( this.lastIndex >= this.keys.length ) {\r\n\r\n\t\t\tthis.setResult( this.keys[ this.keys.length - 1 ].value );\r\n\r\n\t\t\treturn this.result;\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.lastIndex === 0 ) {\r\n\r\n\t\t\tthis.setResult( this.keys[ 0 ].value );\r\n\r\n\t\t\treturn this.result;\r\n\r\n\t\t}\r\n\r\n\t\tvar prevKey = this.keys[ this.lastIndex - 1 ];\r\n\t\tthis.setResult( prevKey.value );\r\n\r\n\t\t// if true, means that prev/current keys are identical, thus no interpolation required.\r\n\t\tif ( prevKey.constantToNext ) {\r\n\r\n\t\t\treturn this.result;\r\n\r\n\t\t}\r\n\r\n\t\t// linear interpolation to start with\r\n\t\tvar currentKey = this.keys[ this.lastIndex ];\r\n\t\tvar alpha = ( time - prevKey.time ) / ( currentKey.time - prevKey.time );\r\n\t\tthis.result = this.lerpValues( this.result, currentKey.value, alpha );\r\n\r\n\t\treturn this.result;\r\n\r\n\t},\r\n\r\n\t// move all keyframes either forwards or backwards in time\r\n\tshift: function( timeOffset ) {\r\n\r\n\t\tif ( timeOffset !== 0.0 ) {\r\n\r\n\t\t\tfor ( var i = 0; i < this.keys.length; i ++ ) {\r\n\t\t\t\tthis.keys[i].time += timeOffset;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\t// scale all keyframe times by a factor (useful for frame <-> seconds conversions)\r\n\tscale: function( timeScale ) {\r\n\r\n\t\tif ( timeScale !== 1.0 ) {\r\n\r\n\t\t\tfor ( var i = 0; i < this.keys.length; i ++ ) {\r\n\t\t\t\tthis.keys[i].time *= timeScale;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\t// removes keyframes before and after animation without changing any values within the range [startTime, endTime].\r\n\t// IMPORTANT: We do not shift around keys to the start of the track time, because for interpolated keys this will change their values\r\n \ttrim: function( startTime, endTime ) {\r\n\r\n\t\tvar firstKeysToRemove = 0;\r\n\t\tfor ( var i = 1; i < this.keys.length; i ++ ) {\r\n\t\t\tif ( this.keys[i] <= startTime ) {\r\n\t\t\t\tfirstKeysToRemove ++;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar lastKeysToRemove = 0;\r\n\t\tfor ( var i = this.keys.length - 2; i > 0; i ++ ) {\r\n\t\t\tif ( this.keys[i] >= endTime ) {\r\n\t\t\t\tlastKeysToRemove ++;\r\n\t\t\t} else {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// remove last keys first because it doesn't affect the position of the first keys (the otherway around doesn't work as easily)\r\n\t\tif ( ( firstKeysToRemove + lastKeysToRemove ) > 0 ) {\r\n\t\t\tthis.keys = this.keys.splice( firstKeysToRemove, this.keys.length - lastKeysToRemove - firstKeysToRemove );;\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\t/* NOTE: This is commented out because we really shouldn't have to handle unsorted key lists\r\n\t         Tracks with out of order keys should be considered to be invalid.  - bhouston\r\n\tsort: function() {\r\n\r\n\t\tthis.keys.sort( THREE.KeyframeTrack.keyComparer );\r\n\r\n\t\treturn this;\r\n\r\n\t},*/\r\n\r\n\t// ensure we do not get a GarbageInGarbageOut situation, make sure tracks are at least minimally viable\r\n\t// One could eventually ensure that all key.values in a track are all of the same type (otherwise interpolation makes no sense.)\r\n\tvalidate: function() {\r\n\r\n\t\tvar prevKey = null;\r\n\r\n\t\tif ( this.keys.length === 0 ) {\r\n\t\t\tconsole.error( \"  track is empty, no keys\", this );\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0; i < this.keys.length; i ++ ) {\r\n\r\n\t\t\tvar currKey = this.keys[i];\r\n\r\n\t\t\tif ( ! currKey ) {\r\n\t\t\t\tconsole.error( \"  key is null in track\", this, i );\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif ( ( typeof currKey.time ) !== 'number' || isNaN( currKey.time ) ) {\r\n\t\t\t\tconsole.error( \"  key.time is not a valid number\", this, i, currKey );\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif ( currKey.value === undefined || currKey.value === null) {\r\n\t\t\t\tconsole.error( \"  key.value is null in track\", this, i, currKey );\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif ( prevKey && prevKey.time > currKey.time ) {\r\n\t\t\t\tconsole.error( \"  key.time is less than previous key time, out of order keys\", this, i, currKey, prevKey );\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tprevKey = currKey;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\t// currently only removes equivalent sequential keys (0,0,0,0,1,1,1,0,0,0,0,0,0,0) --> (0,0,1,1,0,0), which are common in morph target animations\r\n\toptimize: function() {\r\n\r\n\t\tvar newKeys = [];\r\n\t\tvar prevKey = this.keys[0];\r\n\t\tnewKeys.push( prevKey );\r\n\r\n\t\tvar equalsFunc = THREE.AnimationUtils.getEqualsFunc( prevKey.value );\r\n\r\n\t\tfor ( var i = 1; i < this.keys.length - 1; i ++ ) {\r\n\t\t\tvar currKey = this.keys[i];\r\n\t\t\tvar nextKey = this.keys[i+1];\r\n\r\n\t\t\t// if prevKey & currKey are the same time, remove currKey.  If you want immediate adjacent keys, use an epsilon offset\r\n\t\t\t// it is not possible to have two keys at the same time as we sort them.  The sort is not stable on keys with the same time.\r\n\t\t\tif ( ( prevKey.time === currKey.time ) ) {\r\n\r\n\t\t\t\tcontinue;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// remove completely unnecessary keyframes that are the same as their prev and next keys\r\n\t\t\tif ( this.compareValues( prevKey.value, currKey.value ) && this.compareValues( currKey.value, nextKey.value ) ) {\r\n\r\n\t\t\t\tcontinue;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// determine if interpolation is required\r\n\t\t\tprevKey.constantToNext = this.compareValues( prevKey.value, currKey.value );\r\n\r\n\t\t\tnewKeys.push( currKey );\r\n\t\t\tprevKey = currKey;\r\n\t\t}\r\n\t\tnewKeys.push( this.keys[ this.keys.length - 1 ] );\r\n\r\n\t\tthis.keys = newKeys;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.KeyframeTrack.keyComparer = function keyComparator(key0, key1) {\r\n\treturn key0.time - key1.time;\r\n};\r\n\r\nTHREE.KeyframeTrack.parse = function( json ) {\r\n\r\n\tif ( json.type === undefined ) throw new Error( \"track type undefined, can not parse\" );\r\n\r\n\tvar trackType = THREE.KeyframeTrack.GetTrackTypeForTypeName( json.type );\r\n\r\n\treturn trackType.parse( json );\r\n\r\n};\r\n\r\nTHREE.KeyframeTrack.GetTrackTypeForTypeName = function( typeName ) {\r\n\tswitch( typeName.toLowerCase() ) {\r\n\t \tcase \"vector\":\r\n\t \tcase \"vector2\":\r\n\t \tcase \"vector3\":\r\n\t \tcase \"vector4\":\r\n\t\t\treturn THREE.VectorKeyframeTrack;\r\n\r\n\t \tcase \"quaternion\":\r\n\t\t\treturn THREE.QuaternionKeyframeTrack;\r\n\r\n\t \tcase \"integer\":\r\n\t \tcase \"scalar\":\r\n\t \tcase \"double\":\r\n\t \tcase \"float\":\r\n\t \tcase \"number\":\r\n\t\t\treturn THREE.NumberKeyframeTrack;\r\n\r\n\t \tcase \"bool\":\r\n\t \tcase \"boolean\":\r\n\t\t\treturn THREE.BooleanKeyframeTrack;\r\n\r\n\t \tcase \"string\":\r\n\t \t\treturn THREE.StringKeyframeTrack;\r\n\t};\r\n\r\n\tthrow new Error( \"Unsupported typeName: \" + typeName );\r\n};\r\n\r\n// File:src/animation/PropertyBinding.js\r\n\r\n/**\r\n *\r\n * A track bound to a real value in the scene graph.\r\n *\r\n * @author Ben Houston / http://clara.io/\r\n * @author David Sarno / http://lighthaus.us/\r\n */\r\n\r\nTHREE.PropertyBinding = function ( rootNode, trackName ) {\r\n\r\n\tthis.rootNode = rootNode;\r\n\tthis.trackName = trackName;\r\n\tthis.referenceCount = 0;\r\n\tthis.originalValue = null; // the value of the property before it was controlled by this binding\r\n\r\n\tvar parseResults = THREE.PropertyBinding.parseTrackName( trackName );\r\n\r\n\tthis.directoryName = parseResults.directoryName;\r\n\tthis.nodeName = parseResults.nodeName;\r\n\tthis.objectName = parseResults.objectName;\r\n\tthis.objectIndex = parseResults.objectIndex;\r\n\tthis.propertyName = parseResults.propertyName;\r\n\tthis.propertyIndex = parseResults.propertyIndex;\r\n\r\n\tthis.node = THREE.PropertyBinding.findNode( rootNode, this.nodeName ) || rootNode;\r\n\r\n\tthis.cumulativeValue = null;\r\n\tthis.cumulativeWeight = 0;\r\n};\r\n\r\nTHREE.PropertyBinding.prototype = {\r\n\r\n\tconstructor: THREE.PropertyBinding,\r\n\r\n\treset: function() {\r\n\r\n\t\tthis.cumulativeValue = null;\r\n\t\tthis.cumulativeWeight = 0;\r\n\r\n\t},\r\n\r\n\taccumulate: function( value, weight ) {\r\n\r\n\t\tif ( ! this.isBound ) this.bind();\r\n\r\n\t\tif ( this.cumulativeWeight === 0 ) {\r\n\r\n\t\t\tif ( weight > 0 ) {\r\n\r\n\t\t\t\tif ( this.cumulativeValue === null ) {\r\n\t\t\t\t\tthis.cumulativeValue = THREE.AnimationUtils.clone( value );\r\n\t\t\t\t}\r\n\t\t\t\tthis.cumulativeWeight = weight;\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tvar lerpAlpha = weight / ( this.cumulativeWeight + weight );\r\n\t\t\tthis.cumulativeValue = this.lerpValue( this.cumulativeValue, value, lerpAlpha );\r\n\t\t\tthis.cumulativeWeight += weight;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tunbind: function() {\r\n\r\n\t\tif ( ! this.isBound ) return;\r\n\r\n\t\tthis.setValue( this.originalValue );\r\n\r\n\t\tthis.setValue = null;\r\n\t\tthis.getValue = null;\r\n\t\tthis.lerpValue = null;\r\n\t\tthis.equalsValue = null;\r\n\t\tthis.triggerDirty = null;\r\n\t\tthis.isBound = false;\r\n\r\n\t},\r\n\r\n\t// bind to the real property in the scene graph, remember original value, memorize various accessors for speed/inefficiency\r\n\tbind: function() {\r\n\r\n\t\tif ( this.isBound ) return;\r\n\r\n\t\tvar targetObject = this.node;\r\n\r\n \t\t// ensure there is a value node\r\n\t\tif ( ! targetObject ) {\r\n\t\t\tconsole.error( \"  trying to update node for track: \" + this.trackName + \" but it wasn't found.\" );\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif ( this.objectName ) {\r\n\t\t\t// special case were we need to reach deeper into the hierarchy to get the face materials....\r\n\t\t\tif ( this.objectName === \"materials\" ) {\r\n\t\t\t\tif ( ! targetObject.material ) {\r\n\t\t\t\t\tconsole.error( '  can not bind to material as node does not have a material', this );\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif ( ! targetObject.material.materials ) {\r\n\t\t\t\t\tconsole.error( '  can not bind to material.materials as node.material does not have a materials array', this );\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\ttargetObject = targetObject.material.materials;\r\n\t\t\t} else if ( this.objectName === \"bones\" ) {\r\n\t\t\t\tif ( ! targetObject.skeleton ) {\r\n\t\t\t\t\tconsole.error( '  can not bind to bones as node does not have a skeleton', this );\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t// potential future optimization: skip this if propertyIndex is already an integer, and convert the integer string to a true integer.\r\n\r\n\t\t\t\ttargetObject = targetObject.skeleton.bones;\r\n\r\n\t\t\t\t// support resolving morphTarget names into indices.\r\n\t\t\t\tfor ( var i = 0; i < targetObject.length; i ++ ) {\r\n\t\t\t\t\tif ( targetObject[i].name === this.objectIndex ) {\r\n\t\t\t\t\t\tthis.objectIndex = i;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif ( targetObject[ this.objectName ] === undefined ) {\r\n\t\t\t\t\tconsole.error( '  can not bind to objectName of node, undefined', this );\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\ttargetObject = targetObject[ this.objectName ];\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.objectIndex !== undefined ) {\r\n\t\t\t\tif ( targetObject[ this.objectIndex ] === undefined ) {\r\n\t\t\t\t\tconsole.error( \"  trying to bind to objectIndex of objectName, but is undefined:\", this, targetObject );\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttargetObject = targetObject[ this.objectIndex ];\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n \t\t// special case mappings\r\n \t\tvar nodeProperty = targetObject[ this.propertyName ];\r\n\t\tif ( ! nodeProperty ) {\r\n\t\t\tconsole.error( \"  trying to update property for track: \" + this.nodeName + '.' + this.propertyName + \" but it wasn't found.\", targetObject );\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// access a sub element of the property array (only primitives are supported right now)\r\n\t\tif ( this.propertyIndex !== undefined ) {\r\n\r\n\t\t\tif ( this.propertyName === \"morphTargetInfluences\" ) {\r\n\t\t\t\t// potential optimization, skip this if propertyIndex is already an integer, and convert the integer string to a true integer.\r\n\r\n\t\t\t\t// support resolving morphTarget names into indices.\r\n\t\t\t\tif ( ! targetObject.geometry ) {\r\n\t\t\t\t\tconsole.error( '  can not bind to morphTargetInfluences becasuse node does not have a geometry', this );\r\n\t\t\t\t}\r\n\t\t\t\tif ( ! targetObject.geometry.morphTargets ) {\r\n\t\t\t\t\tconsole.error( '  can not bind to morphTargetInfluences becasuse node does not have a geometry.morphTargets', this );\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor ( var i = 0; i < this.node.geometry.morphTargets.length; i ++ ) {\r\n\t\t\t\t\tif ( targetObject.geometry.morphTargets[i].name === this.propertyIndex ) {\r\n\t\t\t\t\t\tthis.propertyIndex = i;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.setValue = function setValue_propertyIndexed( value ) {\r\n\t\t\t\tif ( ! this.equalsValue( nodeProperty[ this.propertyIndex ], value ) ) {\r\n\t\t\t\t\tnodeProperty[ this.propertyIndex ] = value;\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t};\r\n\r\n\t\t\tthis.getValue = function getValue_propertyIndexed() {\r\n\t\t\t\treturn nodeProperty[ this.propertyIndex ];\r\n\t\t\t};\r\n\r\n\t\t}\r\n\t\t// must use copy for Object3D.Euler/Quaternion\r\n\t\telse if ( nodeProperty.copy ) {\r\n\r\n\t\t\tthis.setValue = function setValue_propertyObject( value ) {\r\n\t\t\t\tif ( ! this.equalsValue( nodeProperty, value ) ) {\r\n\t\t\t\t\tnodeProperty.copy( value );\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tthis.getValue = function getValue_propertyObject() {\r\n\t\t\t\treturn nodeProperty;\r\n\t\t\t};\r\n\r\n\t\t}\r\n\t\t// otherwise just set the property directly on the node (do not use nodeProperty as it may not be a reference object)\r\n\t\telse {\r\n\r\n\t\t\tthis.setValue = function setValue_property( value ) {\r\n\t\t\t\tif ( ! this.equalsValue( targetObject[ this.propertyName ], value ) ) {\r\n\t\t\t\t\ttargetObject[ this.propertyName ] = value;\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tthis.getValue = function getValue_property() {\r\n\t\t\t\treturn targetObject[ this.propertyName ];\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t\t// trigger node dirty\r\n\t\tif ( targetObject.needsUpdate !== undefined ) { // material\r\n\r\n\t\t\tthis.triggerDirty = function triggerDirty_needsUpdate() {\r\n\t\t\t\tthis.node.needsUpdate = true;\r\n\t\t\t}\r\n\r\n\t\t} else if ( targetObject.matrixWorldNeedsUpdate !== undefined ) { // node transform\r\n\r\n\t\t\tthis.triggerDirty = function triggerDirty_matrixWorldNeedsUpdate() {\r\n\t\t\t\ttargetObject.matrixWorldNeedsUpdate = true;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tthis.originalValue = this.getValue();\r\n\r\n\t\tthis.equalsValue = THREE.AnimationUtils.getEqualsFunc( this.originalValue );\r\n\t\tthis.lerpValue = THREE.AnimationUtils.getLerpFunc( this.originalValue, true );\r\n\r\n\t\tthis.isBound = true;\r\n\r\n\t},\r\n\r\n\tapply: function() {\r\n\r\n\t\t// for speed capture the setter pattern as a closure (sort of a memoization pattern: https://en.wikipedia.org/wiki/Memoization)\r\n\t\tif ( ! this.isBound ) this.bind();\r\n\r\n\t\t// early exit if there is nothing to apply.\r\n\t\tif ( this.cumulativeWeight > 0 ) {\r\n\r\n\t\t\t// blend with original value\r\n\t\t\tif ( this.cumulativeWeight < 1 ) {\r\n\r\n\t\t\t\tvar remainingWeight = 1 - this.cumulativeWeight;\r\n\t\t\t\tvar lerpAlpha = remainingWeight / ( this.cumulativeWeight + remainingWeight );\r\n\t\t\t\tthis.cumulativeValue = this.lerpValue( this.cumulativeValue, this.originalValue, lerpAlpha );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar valueChanged = this.setValue( this.cumulativeValue );\r\n\r\n\t\t\tif ( valueChanged && this.triggerDirty ) {\r\n\t\t\t\tthis.triggerDirty();\r\n\t\t\t}\r\n\r\n\t\t\t// reset accumulator\r\n\t\t\tthis.cumulativeValue = null;\r\n\t\t\tthis.cumulativeWeight = 0;\r\n\r\n\t\t}\r\n\t}\r\n\r\n};\r\n\r\n\r\nTHREE.PropertyBinding.parseTrackName = function( trackName ) {\r\n\r\n\t// matches strings in the form of:\r\n\t//    nodeName.property\r\n\t//    nodeName.property[accessor]\r\n\t//    nodeName.material.property[accessor]\r\n\t//    uuid.property[accessor]\r\n\t//    uuid.objectName[objectIndex].propertyName[propertyIndex]\r\n\t//    parentName/nodeName.property\r\n\t//    parentName/parentName/nodeName.property[index]\r\n\t//\t  .bone[Armature.DEF_cog].position\r\n\t// created and tested via https://regex101.com/#javascript\r\n\r\n\tvar re = /^(([\\w]+\\/)*)([\\w-\\d]+)?(\\.([\\w]+)(\\[([\\w\\d\\[\\]\\_. ]+)\\])?)?(\\.([\\w.]+)(\\[([\\w\\d\\[\\]\\_. ]+)\\])?)$/;\r\n\tvar matches = re.exec(trackName);\r\n\r\n\tif ( ! matches ) {\r\n\t\tthrow new Error( \"cannot parse trackName at all: \" + trackName );\r\n\t}\r\n\r\n    if (matches.index === re.lastIndex) {\r\n        re.lastIndex++;\r\n    }\r\n\r\n\tvar results = {\r\n\t\tdirectoryName: matches[1],\r\n\t\tnodeName: matches[3], \t// allowed to be null, specified root node.\r\n\t\tobjectName: matches[5],\r\n\t\tobjectIndex: matches[7],\r\n\t\tpropertyName: matches[9],\r\n\t\tpropertyIndex: matches[11]\t// allowed to be null, specifies that the whole property is set.\r\n\t};\r\n\r\n\tif ( results.propertyName === null || results.propertyName.length === 0 ) {\r\n\t\tthrow new Error( \"can not parse propertyName from trackName: \" + trackName );\r\n\t}\r\n\r\n\treturn results;\r\n\r\n};\r\n\r\nTHREE.PropertyBinding.findNode = function( root, nodeName ) {\r\n\r\n\tfunction searchSkeleton( skeleton ) {\r\n\r\n\t\tfor ( var i = 0; i < skeleton.bones.length; i ++ ) {\r\n\r\n\t\t\tvar bone = skeleton.bones[i];\r\n\r\n\t\t\tif ( bone.name === nodeName ) {\r\n\r\n\t\t\t\treturn bone;\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\r\n\t}\r\n\r\n\tfunction searchNodeSubtree( children ) {\r\n\r\n\t\tfor ( var i = 0; i < children.length; i ++ ) {\r\n\r\n\t\t\tvar childNode = children[i];\r\n\r\n\t\t\tif ( childNode.name === nodeName || childNode.uuid === nodeName ) {\r\n\r\n\t\t\t\treturn childNode;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar result = searchNodeSubtree( childNode.children );\r\n\r\n\t\t\tif ( result ) return result;\r\n\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tif ( ! nodeName || nodeName === \"\" || nodeName === \"root\" || nodeName === \".\" || nodeName === -1 || nodeName === root.name || nodeName === root.uuid ) {\r\n\r\n\t\treturn root;\r\n\r\n\t}\r\n\r\n\t// search into skeleton bones.\r\n\tif ( root.skeleton ) {\r\n\r\n\t\tvar bone = searchSkeleton( root.skeleton );\r\n\r\n\t\tif ( bone ) {\r\n\r\n\t\t\treturn bone;\r\n\r\n\t\t}\r\n\t}\r\n\r\n\t// search into node subtree.\r\n\tif ( root.children ) {\r\n\r\n\t\tvar subTreeNode = searchNodeSubtree( root.children );\r\n\r\n\t\tif ( subTreeNode ) {\r\n\r\n\t\t\treturn subTreeNode;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\treturn null;\r\n}\r\n\r\n// File:src/animation/tracks/VectorKeyframeTrack.js\r\n\r\n/**\r\n *\r\n * A Track that interpolates Vectors\r\n *\r\n * @author Ben Houston / http://clara.io/\r\n * @author David Sarno / http://lighthaus.us/\r\n */\r\n\r\nTHREE.VectorKeyframeTrack = function ( name, keys ) {\r\n\r\n\tTHREE.KeyframeTrack.call( this, name, keys );\r\n\r\n\t// local cache of value type to avoid allocations during runtime.\r\n\tthis.result = this.keys[0].value.clone();\r\n\r\n};\r\n\r\nTHREE.VectorKeyframeTrack.prototype = Object.create( THREE.KeyframeTrack.prototype );\r\n\r\nTHREE.VectorKeyframeTrack.prototype.constructor = THREE.VectorKeyframeTrack;\r\n\r\nTHREE.VectorKeyframeTrack.prototype.setResult = function( value ) {\r\n\r\n\tthis.result.copy( value );\r\n\r\n};\r\n\r\n// memoization of the lerp function for speed.\r\n// NOTE: Do not optimize as a prototype initialization closure, as value0 will be different on a per class basis.\r\nTHREE.VectorKeyframeTrack.prototype.lerpValues = function( value0, value1, alpha ) {\r\n\r\n\treturn value0.lerp( value1, alpha );\r\n\r\n};\r\n\r\nTHREE.VectorKeyframeTrack.prototype.compareValues = function( value0, value1 ) {\r\n\r\n\treturn value0.equals( value1 );\r\n\r\n};\r\n\r\nTHREE.VectorKeyframeTrack.prototype.clone = function() {\r\n\r\n\tvar clonedKeys = [];\r\n\r\n\tfor ( var i = 0; i < this.keys.length; i ++ ) {\r\n\r\n\t\tvar key = this.keys[i];\r\n\t\tclonedKeys.push( {\r\n\t\t\ttime: key.time,\r\n\t\t\tvalue: key.value.clone()\r\n\t\t} );\r\n\t}\r\n\r\n\treturn new THREE.VectorKeyframeTrack( this.name, clonedKeys );\r\n\r\n};\r\n\r\nTHREE.VectorKeyframeTrack.parse = function( json ) {\r\n\r\n\tvar elementCount = json.keys[0].value.length;\r\n\tvar valueType = THREE[ 'Vector' + elementCount ];\r\n\r\n\tvar keys = [];\r\n\r\n\tfor ( var i = 0; i < json.keys.length; i ++ ) {\r\n\t\tvar jsonKey = json.keys[i];\r\n\t\tkeys.push( {\r\n\t\t\tvalue: new valueType().fromArray( jsonKey.value ),\r\n\t\t\ttime: jsonKey.time\r\n\t\t} );\r\n\t}\r\n\r\n\treturn new THREE.VectorKeyframeTrack( json.name, keys );\r\n\r\n};\r\n\r\n// File:src/animation/tracks/QuaternionKeyframeTrack.js\r\n\r\n/**\r\n *\r\n * A Track that interpolates Quaternion\r\n *\r\n * @author Ben Houston / http://clara.io/\r\n * @author David Sarno / http://lighthaus.us/\r\n */\r\n\r\nTHREE.QuaternionKeyframeTrack = function ( name, keys ) {\r\n\r\n\tTHREE.KeyframeTrack.call( this, name, keys );\r\n\r\n\t// local cache of value type to avoid allocations during runtime.\r\n\tthis.result = this.keys[0].value.clone();\r\n\r\n};\r\n\r\nTHREE.QuaternionKeyframeTrack.prototype = Object.create( THREE.KeyframeTrack.prototype );\r\n\r\nTHREE.QuaternionKeyframeTrack.prototype.constructor = THREE.QuaternionKeyframeTrack;\r\n\r\nTHREE.QuaternionKeyframeTrack.prototype.setResult = function( value ) {\r\n\r\n\tthis.result.copy( value );\r\n\r\n};\r\n\r\n// memoization of the lerp function for speed.\r\n// NOTE: Do not optimize as a prototype initialization closure, as value0 will be different on a per class basis.\r\nTHREE.QuaternionKeyframeTrack.prototype.lerpValues = function( value0, value1, alpha ) {\r\n\r\n\treturn value0.slerp( value1, alpha );\r\n\r\n};\r\n\r\nTHREE.QuaternionKeyframeTrack.prototype.compareValues = function( value0, value1 ) {\r\n\r\n\treturn value0.equals( value1 );\r\n\r\n};\r\n\r\nTHREE.QuaternionKeyframeTrack.prototype.multiply = function( quat ) {\r\n\r\n\tfor ( var i = 0; i < this.keys.length; i ++ ) {\r\n\r\n\t\tthis.keys[i].value.multiply( quat );\r\n\r\n\t}\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nTHREE.QuaternionKeyframeTrack.prototype.clone = function() {\r\n\r\n\tvar clonedKeys = [];\r\n\r\n\tfor ( var i = 0; i < this.keys.length; i ++ ) {\r\n\r\n\t\tvar key = this.keys[i];\r\n\t\tclonedKeys.push( {\r\n\t\t\ttime: key.time,\r\n\t\t\tvalue: key.value.clone()\r\n\t\t} );\r\n\t}\r\n\r\n\treturn new THREE.QuaternionKeyframeTrack( this.name, clonedKeys );\r\n\r\n};\r\n\r\nTHREE.QuaternionKeyframeTrack.parse = function( json ) {\r\n\r\n\tvar keys = [];\r\n\r\n\tfor ( var i = 0; i < json.keys.length; i ++ ) {\r\n\t\tvar jsonKey = json.keys[i];\r\n\t\tkeys.push( {\r\n\t\t\tvalue: new THREE.Quaternion().fromArray( jsonKey.value ),\r\n\t\t\ttime: jsonKey.time\r\n\t\t} );\r\n\t}\r\n\r\n\treturn new THREE.QuaternionKeyframeTrack( json.name, keys );\r\n\r\n};\r\n\r\n// File:src/animation/tracks/StringKeyframeTrack.js\r\n\r\n/**\r\n *\r\n * A Track that interpolates Strings\r\n *\r\n * @author Ben Houston / http://clara.io/\r\n * @author David Sarno / http://lighthaus.us/\r\n */\r\n\r\nTHREE.StringKeyframeTrack = function ( name, keys ) {\r\n\r\n\tTHREE.KeyframeTrack.call( this, name, keys );\r\n\r\n\t// local cache of value type to avoid allocations during runtime.\r\n\tthis.result = this.keys[0].value;\r\n\r\n};\r\n\r\nTHREE.StringKeyframeTrack.prototype = Object.create( THREE.KeyframeTrack.prototype );\r\n\r\nTHREE.StringKeyframeTrack.prototype.constructor = THREE.StringKeyframeTrack;\r\n\r\nTHREE.StringKeyframeTrack.prototype.setResult = function( value ) {\r\n\r\n\tthis.result = value;\r\n\r\n};\r\n\r\n// memoization of the lerp function for speed.\r\n// NOTE: Do not optimize as a prototype initialization closure, as value0 will be different on a per class basis.\r\nTHREE.StringKeyframeTrack.prototype.lerpValues = function( value0, value1, alpha ) {\r\n\r\n\treturn ( alpha < 1.0 ) ? value0 : value1;\r\n\r\n};\r\n\r\nTHREE.StringKeyframeTrack.prototype.compareValues = function( value0, value1 ) {\r\n\r\n\treturn ( value0 === value1 );\r\n\r\n};\r\n\r\nTHREE.StringKeyframeTrack.prototype.clone = function() {\r\n\r\n\tvar clonedKeys = [];\r\n\r\n\tfor ( var i = 0; i < this.keys.length; i ++ ) {\r\n\r\n\t\tvar key = this.keys[i];\r\n\t\tclonedKeys.push( {\r\n\t\t\ttime: key.time,\r\n\t\t\tvalue: key.value\r\n\t\t} );\r\n\t}\r\n\r\n\treturn new THREE.StringKeyframeTrack( this.name, clonedKeys );\r\n\r\n};\r\n\r\nTHREE.StringKeyframeTrack.parse = function( json ) {\r\n\r\n\treturn new THREE.StringKeyframeTrack( json.name, json.keys );\r\n\r\n};\r\n\r\n// File:src/animation/tracks/BooleanKeyframeTrack.js\r\n\r\n/**\r\n *\r\n * A Track that interpolates Boolean\r\n *\r\n * @author Ben Houston / http://clara.io/\r\n * @author David Sarno / http://lighthaus.us/\r\n */\r\n\r\nTHREE.BooleanKeyframeTrack = function ( name, keys ) {\r\n\r\n\tTHREE.KeyframeTrack.call( this, name, keys );\r\n\r\n\t// local cache of value type to avoid allocations during runtime.\r\n\tthis.result = this.keys[0].value;\r\n\r\n};\r\n\r\nTHREE.BooleanKeyframeTrack.prototype = Object.create( THREE.KeyframeTrack.prototype );\r\n\r\nTHREE.BooleanKeyframeTrack.prototype.constructor = THREE.BooleanKeyframeTrack;\r\n\r\nTHREE.BooleanKeyframeTrack.prototype.setResult = function( value ) {\r\n\r\n\tthis.result = value;\r\n\r\n};\r\n\r\n// memoization of the lerp function for speed.\r\n// NOTE: Do not optimize as a prototype initialization closure, as value0 will be different on a per class basis.\r\nTHREE.BooleanKeyframeTrack.prototype.lerpValues = function( value0, value1, alpha ) {\r\n\r\n\treturn ( alpha < 1.0 ) ? value0 : value1;\r\n\r\n};\r\n\r\nTHREE.BooleanKeyframeTrack.prototype.compareValues = function( value0, value1 ) {\r\n\r\n\treturn ( value0 === value1 );\r\n\r\n};\r\n\r\nTHREE.BooleanKeyframeTrack.prototype.clone = function() {\r\n\r\n\tvar clonedKeys = [];\r\n\r\n\tfor ( var i = 0; i < this.keys.length; i ++ ) {\r\n\r\n\t\tvar key = this.keys[i];\r\n\t\tclonedKeys.push( {\r\n\t\t\ttime: key.time,\r\n\t\t\tvalue: key.value\r\n\t\t} );\r\n\t}\r\n\r\n\treturn new THREE.BooleanKeyframeTrack( this.name, clonedKeys );\r\n\r\n};\r\n\r\nTHREE.BooleanKeyframeTrack.parse = function( json ) {\r\n\r\n\treturn new THREE.BooleanKeyframeTrack( json.name, json.keys );\r\n\r\n};\r\n\r\n// File:src/animation/tracks/NumberKeyframeTrack.js\r\n\r\n/**\r\n *\r\n * A Track that interpolates Numbers\r\n *\r\n * @author Ben Houston / http://clara.io/\r\n * @author David Sarno / http://lighthaus.us/\r\n */\r\n\r\nTHREE.NumberKeyframeTrack = function ( name, keys ) {\r\n\r\n\tTHREE.KeyframeTrack.call( this, name, keys );\r\n\r\n\t// local cache of value type to avoid allocations during runtime.\r\n\tthis.result = this.keys[0].value;\r\n\r\n};\r\n\r\nTHREE.NumberKeyframeTrack.prototype = Object.create( THREE.KeyframeTrack.prototype );\r\n\r\nTHREE.NumberKeyframeTrack.prototype.constructor = THREE.NumberKeyframeTrack;\r\n\r\nTHREE.NumberKeyframeTrack.prototype.setResult = function( value ) {\r\n\r\n\tthis.result = value;\r\n\r\n};\r\n\r\n// memoization of the lerp function for speed.\r\n// NOTE: Do not optimize as a prototype initialization closure, as value0 will be different on a per class basis.\r\nTHREE.NumberKeyframeTrack.prototype.lerpValues = function( value0, value1, alpha ) {\r\n\r\n\treturn value0 * ( 1 - alpha ) + value1 * alpha;\r\n\r\n};\r\n\r\nTHREE.NumberKeyframeTrack.prototype.compareValues = function( value0, value1 ) {\r\n\r\n\treturn ( value0 === value1 );\r\n\r\n};\r\n\r\nTHREE.NumberKeyframeTrack.prototype.clone = function() {\r\n\r\n\tvar clonedKeys = [];\r\n\r\n\tfor ( var i = 0; i < this.keys.length; i ++ ) {\r\n\r\n\t\tvar key = this.keys[i];\r\n\t\tclonedKeys.push( {\r\n\t\t\ttime: key.time,\r\n\t\t\tvalue: key.value\r\n\t\t} );\r\n\t}\r\n\r\n\treturn new THREE.NumberKeyframeTrack( this.name, clonedKeys );\r\n\r\n};\r\n\r\nTHREE.NumberKeyframeTrack.parse = function( json ) {\r\n\r\n\treturn new THREE.NumberKeyframeTrack( json.name, json.keys );\r\n\r\n};\r\n\r\n// File:src/cameras/Camera.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author WestLangley / http://github.com/WestLangley\r\n*/\r\n\r\nTHREE.Camera = function () {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'Camera';\r\n\r\n\tthis.matrixWorldInverse = new THREE.Matrix4();\r\n\tthis.projectionMatrix = new THREE.Matrix4();\r\n\r\n};\r\n\r\nTHREE.Camera.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.Camera.prototype.constructor = THREE.Camera;\r\n\r\nTHREE.Camera.prototype.getWorldDirection = function () {\r\n\r\n\tvar quaternion = new THREE.Quaternion();\r\n\r\n\treturn function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\tthis.getWorldQuaternion( quaternion );\r\n\r\n\t\treturn result.set( 0, 0, - 1 ).applyQuaternion( quaternion );\r\n\r\n\t};\r\n\r\n}();\r\n\r\nTHREE.Camera.prototype.lookAt = function () {\r\n\r\n\t// This routine does not support cameras with rotated and/or translated parent(s)\r\n\r\n\tvar m1 = new THREE.Matrix4();\r\n\r\n\treturn function ( vector ) {\r\n\r\n\t\tm1.lookAt( this.position, vector, this.up );\r\n\r\n\t\tthis.quaternion.setFromRotationMatrix( m1 );\r\n\r\n\t};\r\n\r\n}();\r\n\r\nTHREE.Camera.prototype.clone = function () {\r\n\r\n\treturn new this.constructor().copy( this );\r\n\r\n};\r\n\r\nTHREE.Camera.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Object3D.prototype.copy.call( this, source );\r\n\r\n\tthis.matrixWorldInverse.copy( source.matrixWorldInverse );\r\n\tthis.projectionMatrix.copy( source.projectionMatrix );\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/cameras/CubeCamera.js\r\n\r\n/**\r\n * Camera for rendering cube maps\r\n *\t- renders scene into axis-aligned cube\r\n *\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.CubeCamera = function ( near, far, cubeResolution ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'CubeCamera';\r\n\r\n\tvar fov = 90, aspect = 1;\r\n\r\n\tvar cameraPX = new THREE.PerspectiveCamera( fov, aspect, near, far );\r\n\tcameraPX.up.set( 0, - 1, 0 );\r\n\tcameraPX.lookAt( new THREE.Vector3( 1, 0, 0 ) );\r\n\tthis.add( cameraPX );\r\n\r\n\tvar cameraNX = new THREE.PerspectiveCamera( fov, aspect, near, far );\r\n\tcameraNX.up.set( 0, - 1, 0 );\r\n\tcameraNX.lookAt( new THREE.Vector3( - 1, 0, 0 ) );\r\n\tthis.add( cameraNX );\r\n\r\n\tvar cameraPY = new THREE.PerspectiveCamera( fov, aspect, near, far );\r\n\tcameraPY.up.set( 0, 0, 1 );\r\n\tcameraPY.lookAt( new THREE.Vector3( 0, 1, 0 ) );\r\n\tthis.add( cameraPY );\r\n\r\n\tvar cameraNY = new THREE.PerspectiveCamera( fov, aspect, near, far );\r\n\tcameraNY.up.set( 0, 0, - 1 );\r\n\tcameraNY.lookAt( new THREE.Vector3( 0, - 1, 0 ) );\r\n\tthis.add( cameraNY );\r\n\r\n\tvar cameraPZ = new THREE.PerspectiveCamera( fov, aspect, near, far );\r\n\tcameraPZ.up.set( 0, - 1, 0 );\r\n\tcameraPZ.lookAt( new THREE.Vector3( 0, 0, 1 ) );\r\n\tthis.add( cameraPZ );\r\n\r\n\tvar cameraNZ = new THREE.PerspectiveCamera( fov, aspect, near, far );\r\n\tcameraNZ.up.set( 0, - 1, 0 );\r\n\tcameraNZ.lookAt( new THREE.Vector3( 0, 0, - 1 ) );\r\n\tthis.add( cameraNZ );\r\n\r\n\tthis.renderTarget = new THREE.WebGLRenderTargetCube( cubeResolution, cubeResolution, { format: THREE.RGBFormat, magFilter: THREE.LinearFilter, minFilter: THREE.LinearFilter } );\r\n\r\n\tthis.updateCubeMap = function ( renderer, scene ) {\r\n\r\n\t\tif ( this.parent === null ) this.updateMatrixWorld();\r\n\r\n\t\tvar renderTarget = this.renderTarget;\r\n\t\tvar generateMipmaps = renderTarget.texture.generateMipmaps;\r\n\r\n\t\trenderTarget.texture.generateMipmaps = false;\r\n\r\n\t\trenderTarget.activeCubeFace = 0;\r\n\t\trenderer.render( scene, cameraPX, renderTarget );\r\n\r\n\t\trenderTarget.activeCubeFace = 1;\r\n\t\trenderer.render( scene, cameraNX, renderTarget );\r\n\r\n\t\trenderTarget.activeCubeFace = 2;\r\n\t\trenderer.render( scene, cameraPY, renderTarget );\r\n\r\n\t\trenderTarget.activeCubeFace = 3;\r\n\t\trenderer.render( scene, cameraNY, renderTarget );\r\n\r\n\t\trenderTarget.activeCubeFace = 4;\r\n\t\trenderer.render( scene, cameraPZ, renderTarget );\r\n\r\n\t\trenderTarget.texture.generateMipmaps = generateMipmaps;\r\n\r\n\t\trenderTarget.activeCubeFace = 5;\r\n\t\trenderer.render( scene, cameraNZ, renderTarget );\r\n\r\n\t\trenderer.setRenderTarget( null );\r\n\r\n\t};\r\n\r\n};\r\n\r\nTHREE.CubeCamera.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.CubeCamera.prototype.constructor = THREE.CubeCamera;\r\n\r\n// File:src/cameras/OrthographicCamera.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.OrthographicCamera = function ( left, right, top, bottom, near, far ) {\r\n\r\n\tTHREE.Camera.call( this );\r\n\r\n\tthis.type = 'OrthographicCamera';\r\n\r\n\tthis.zoom = 1;\r\n\r\n\tthis.left = left;\r\n\tthis.right = right;\r\n\tthis.top = top;\r\n\tthis.bottom = bottom;\r\n\r\n\tthis.near = ( near !== undefined ) ? near : 0.1;\r\n\tthis.far = ( far !== undefined ) ? far : 2000;\r\n\r\n\tthis.updateProjectionMatrix();\r\n\r\n};\r\n\r\nTHREE.OrthographicCamera.prototype = Object.create( THREE.Camera.prototype );\r\nTHREE.OrthographicCamera.prototype.constructor = THREE.OrthographicCamera;\r\n\r\nTHREE.OrthographicCamera.prototype.updateProjectionMatrix = function () {\r\n\r\n\tvar dx = ( this.right - this.left ) / ( 2 * this.zoom );\r\n\tvar dy = ( this.top - this.bottom ) / ( 2 * this.zoom );\r\n\tvar cx = ( this.right + this.left ) / 2;\r\n\tvar cy = ( this.top + this.bottom ) / 2;\r\n\r\n\tthis.projectionMatrix.makeOrthographic( cx - dx, cx + dx, cy + dy, cy - dy, this.near, this.far );\r\n\r\n};\r\n\r\nTHREE.OrthographicCamera.prototype.copy = function ( source ) {\r\n\t\r\n\tTHREE.Camera.prototype.copy.call( this, source );\r\n\t\r\n\tthis.left = source.left;\r\n\tthis.right = source.right;\r\n\tthis.top = source.top;\r\n\tthis.bottom = source.bottom;\r\n\tthis.near = source.near;\r\n\tthis.far = source.far;\r\n\t\r\n\tthis.zoom = source.zoom;\r\n\t\r\n\treturn this;\r\n\t\t\r\n};\r\n\r\nTHREE.OrthographicCamera.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = THREE.Object3D.prototype.toJSON.call( this, meta );\r\n\r\n\tdata.object.zoom = this.zoom;\r\n\tdata.object.left = this.left;\r\n\tdata.object.right = this.right;\r\n\tdata.object.top = this.top;\r\n\tdata.object.bottom = this.bottom;\r\n\tdata.object.near = this.near;\r\n\tdata.object.far = this.far;\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\n// File:src/cameras/PerspectiveCamera.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author greggman / http://games.greggman.com/\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n */\r\n\r\nTHREE.PerspectiveCamera = function ( fov, aspect, near, far ) {\r\n\r\n\tTHREE.Camera.call( this );\r\n\r\n\tthis.type = 'PerspectiveCamera';\r\n\r\n\tthis.zoom = 1;\r\n\r\n\tthis.fov = fov !== undefined ? fov : 50;\r\n\tthis.aspect = aspect !== undefined ? aspect : 1;\r\n\tthis.near = near !== undefined ? near : 0.1;\r\n\tthis.far = far !== undefined ? far : 2000;\r\n\r\n\tthis.updateProjectionMatrix();\r\n\r\n};\r\n\r\nTHREE.PerspectiveCamera.prototype = Object.create( THREE.Camera.prototype );\r\nTHREE.PerspectiveCamera.prototype.constructor = THREE.PerspectiveCamera;\r\n\r\n\r\n/**\r\n * Uses Focal Length (in mm) to estimate and set FOV\r\n * 35mm (full-frame) camera is used if frame size is not specified;\r\n * Formula based on http://www.bobatkins.com/photography/technical/field_of_view.html\r\n */\r\n\r\nTHREE.PerspectiveCamera.prototype.setLens = function ( focalLength, frameHeight ) {\r\n\r\n\tif ( frameHeight === undefined ) frameHeight = 24;\r\n\r\n\tthis.fov = 2 * THREE.Math.radToDeg( Math.atan( frameHeight / ( focalLength * 2 ) ) );\r\n\tthis.updateProjectionMatrix();\r\n\r\n};\r\n\r\n\r\n/**\r\n * Sets an offset in a larger frustum. This is useful for multi-window or\r\n * multi-monitor/multi-machine setups.\r\n *\r\n * For example, if you have 3x2 monitors and each monitor is 1920x1080 and\r\n * the monitors are in grid like this\r\n *\r\n *   +---+---+---+\r\n *   | A | B | C |\r\n *   +---+---+---+\r\n *   | D | E | F |\r\n *   +---+---+---+\r\n *\r\n * then for each monitor you would call it like this\r\n *\r\n *   var w = 1920;\r\n *   var h = 1080;\r\n *   var fullWidth = w * 3;\r\n *   var fullHeight = h * 2;\r\n *\r\n *   --A--\r\n *   camera.setOffset( fullWidth, fullHeight, w * 0, h * 0, w, h );\r\n *   --B--\r\n *   camera.setOffset( fullWidth, fullHeight, w * 1, h * 0, w, h );\r\n *   --C--\r\n *   camera.setOffset( fullWidth, fullHeight, w * 2, h * 0, w, h );\r\n *   --D--\r\n *   camera.setOffset( fullWidth, fullHeight, w * 0, h * 1, w, h );\r\n *   --E--\r\n *   camera.setOffset( fullWidth, fullHeight, w * 1, h * 1, w, h );\r\n *   --F--\r\n *   camera.setOffset( fullWidth, fullHeight, w * 2, h * 1, w, h );\r\n *\r\n *   Note there is no reason monitors have to be the same size or in a grid.\r\n */\r\n\r\nTHREE.PerspectiveCamera.prototype.setViewOffset = function ( fullWidth, fullHeight, x, y, width, height ) {\r\n\r\n\tthis.fullWidth = fullWidth;\r\n\tthis.fullHeight = fullHeight;\r\n\tthis.x = x;\r\n\tthis.y = y;\r\n\tthis.width = width;\r\n\tthis.height = height;\r\n\r\n\tthis.updateProjectionMatrix();\r\n\r\n};\r\n\r\n\r\nTHREE.PerspectiveCamera.prototype.updateProjectionMatrix = function () {\r\n\r\n\tvar fov = THREE.Math.radToDeg( 2 * Math.atan( Math.tan( THREE.Math.degToRad( this.fov ) * 0.5 ) / this.zoom ) );\r\n\r\n\tif ( this.fullWidth ) {\r\n\r\n\t\tvar aspect = this.fullWidth / this.fullHeight;\r\n\t\tvar top = Math.tan( THREE.Math.degToRad( fov * 0.5 ) ) * this.near;\r\n\t\tvar bottom = - top;\r\n\t\tvar left = aspect * bottom;\r\n\t\tvar right = aspect * top;\r\n\t\tvar width = Math.abs( right - left );\r\n\t\tvar height = Math.abs( top - bottom );\r\n\r\n\t\tthis.projectionMatrix.makeFrustum(\r\n\t\t\tleft + this.x * width / this.fullWidth,\r\n\t\t\tleft + ( this.x + this.width ) * width / this.fullWidth,\r\n\t\t\ttop - ( this.y + this.height ) * height / this.fullHeight,\r\n\t\t\ttop - this.y * height / this.fullHeight,\r\n\t\t\tthis.near,\r\n\t\t\tthis.far\r\n\t\t);\r\n\r\n\t} else {\r\n\r\n\t\tthis.projectionMatrix.makePerspective( fov, this.aspect, this.near, this.far );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.PerspectiveCamera.prototype.copy = function ( source ) {\r\n\t\r\n\tTHREE.Camera.prototype.copy.call( this, source );\r\n\t\r\n\tthis.fov = source.fov;\r\n\tthis.aspect = source.aspect;\r\n\tthis.near = source.near;\r\n\tthis.far = source.far;\r\n\t\r\n\tthis.zoom = source.zoom;\r\n\t\r\n\treturn this;\r\n\t\t\r\n};\r\n\r\nTHREE.PerspectiveCamera.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = THREE.Object3D.prototype.toJSON.call( this, meta );\r\n\r\n\tdata.object.zoom = this.zoom;\r\n\tdata.object.fov = this.fov;\r\n\tdata.object.aspect = this.aspect;\r\n\tdata.object.near = this.near;\r\n\tdata.object.far = this.far;\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\n// File:src/lights/Light.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Light = function ( color ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'Light';\r\n\r\n\tthis.color = new THREE.Color( color );\r\n\r\n\tthis.receiveShadow = undefined;\r\n\r\n};\r\n\r\nTHREE.Light.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.Light.prototype.constructor = THREE.Light;\r\n\r\nObject.defineProperties( THREE.Light.prototype, {\r\n\tonlyShadow: {\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.Light: .onlyShadow has been removed.' );\r\n\t\t}\r\n\t},\r\n\tshadowCameraFov: {\r\n\t\tset: function ( value ) {\r\n\t\t\tthis.shadow.camera.fov = value;\r\n\t\t}\r\n\t},\r\n\tshadowCameraLeft: {\r\n\t\tset: function ( value ) {\r\n\t\t\tthis.shadow.camera.left = value;\r\n\t\t}\r\n\t},\r\n\tshadowCameraRight: {\r\n\t\tset: function ( value ) {\r\n\t\t\tthis.shadow.camera.right = value;\r\n\t\t}\r\n\t},\r\n\tshadowCameraTop: {\r\n\t\tset: function ( value ) {\r\n\t\t\tthis.shadow.camera.top = value;\r\n\t\t}\r\n\t},\r\n\tshadowCameraBottom: {\r\n\t\tset: function ( value ) {\r\n\t\t\tthis.shadow.camera.bottom = value;\r\n\t\t}\r\n\t},\r\n\tshadowCameraNear: {\r\n\t\tset: function ( value ) {\r\n\t\t\tthis.shadow.camera.near = value;\r\n\t\t}\r\n\t},\r\n\tshadowCameraFar: {\r\n\t\tset: function ( value ) {\r\n\t\t\tthis.shadow.camera.far = value;\r\n\t\t}\r\n\t},\r\n\tshadowCameraVisible: {\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow ) instead.' );\r\n\t\t}\r\n\t},\r\n\tshadowBias: {\r\n\t\tset: function ( value ) {\r\n\t\t\tthis.shadow.bias = value;\r\n\t\t}\r\n\t},\r\n\tshadowDarkness: {\r\n\t\tset: function ( value ) {\r\n\t\t\tthis.shadow.darkness = value;\r\n\t\t}\r\n\t},\r\n\tshadowMapWidth: {\r\n\t\tset: function ( value ) {\r\n\t\t\tthis.shadow.mapSize.width = value;\r\n\t\t}\r\n\t},\r\n\tshadowMapHeight: {\r\n\t\tset: function ( value ) {\r\n\t\t\tthis.shadow.mapSize.height = value;\r\n\t\t}\r\n\t}\r\n} );\r\n\r\nTHREE.Light.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Object3D.prototype.copy.call( this, source );\r\n\r\n\tthis.color.copy( source.color );\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nTHREE.Light.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = THREE.Object3D.prototype.toJSON.call( this, meta );\r\n\r\n\tdata.object.color = this.color.getHex();\r\n\tif ( this.groundColor !== undefined ) data.object.groundColor = this.groundColor.getHex();\r\n\r\n\tif ( this.intensity !== undefined ) data.object.intensity = this.intensity;\r\n\tif ( this.distance !== undefined ) data.object.distance = this.distance;\r\n\tif ( this.angle !== undefined ) data.object.angle = this.angle;\r\n\tif ( this.decay !== undefined ) data.object.decay = this.decay;\r\n\tif ( this.exponent !== undefined ) data.object.exponent = this.exponent;\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\n// File:src/lights/LightShadow.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.LightShadow = function ( camera ) {\r\n\r\n\tthis.camera = camera;\r\n\r\n\tthis.bias = 0;\r\n\tthis.darkness = 1;\r\n\r\n\tthis.mapSize = new THREE.Vector2( 512, 512 );\r\n\r\n\tthis.map = null;\r\n\tthis.matrix = null;\r\n\r\n};\r\n\r\nTHREE.LightShadow.prototype = {\r\n\r\n\tconstructor: THREE.LightShadow,\r\n\r\n\tcopy: function ( source ) {\r\n\r\n\t\tthis.camera = source.camera.clone();\r\n\r\n\t\tthis.bias = source.bias;\r\n\t\tthis.darkness = source.darkness;\r\n\r\n\t\tthis.mapSize.copy( source.mapSize );\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/lights/AmbientLight.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.AmbientLight = function ( color ) {\r\n\r\n\tTHREE.Light.call( this, color );\r\n\r\n\tthis.type = 'AmbientLight';\r\n\r\n\tthis.castShadow = undefined;\r\n\r\n};\r\n\r\nTHREE.AmbientLight.prototype = Object.create( THREE.Light.prototype );\r\nTHREE.AmbientLight.prototype.constructor = THREE.AmbientLight;\r\n\r\n// File:src/lights/DirectionalLight.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.DirectionalLight = function ( color, intensity ) {\r\n\r\n\tTHREE.Light.call( this, color );\r\n\r\n\tthis.type = 'DirectionalLight';\r\n\r\n\tthis.position.set( 0, 1, 0 );\r\n\tthis.updateMatrix();\r\n\r\n\tthis.target = new THREE.Object3D();\r\n\r\n\tthis.intensity = ( intensity !== undefined ) ? intensity : 1;\r\n\r\n\tthis.shadow = new THREE.LightShadow( new THREE.OrthographicCamera( - 500, 500, 500, - 500, 50, 5000 ) );\r\n\r\n};\r\n\r\nTHREE.DirectionalLight.prototype = Object.create( THREE.Light.prototype );\r\nTHREE.DirectionalLight.prototype.constructor = THREE.DirectionalLight;\r\n\r\nTHREE.DirectionalLight.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Light.prototype.copy.call( this, source );\r\n\r\n\tthis.intensity = source.intensity;\r\n\tthis.target = source.target.clone();\r\n\r\n\tthis.shadow = source.shadow.clone();\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/lights/HemisphereLight.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.HemisphereLight = function ( skyColor, groundColor, intensity ) {\r\n\r\n\tTHREE.Light.call( this, skyColor );\r\n\r\n\tthis.type = 'HemisphereLight';\r\n\r\n\tthis.castShadow = undefined;\r\n\r\n\tthis.position.set( 0, 1, 0 );\r\n\tthis.updateMatrix();\r\n\r\n\tthis.groundColor = new THREE.Color( groundColor );\r\n\tthis.intensity = ( intensity !== undefined ) ? intensity : 1;\r\n\r\n};\r\n\r\nTHREE.HemisphereLight.prototype = Object.create( THREE.Light.prototype );\r\nTHREE.HemisphereLight.prototype.constructor = THREE.HemisphereLight;\r\n\r\nTHREE.HemisphereLight.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Light.prototype.copy.call( this, source );\r\n\r\n\tthis.groundColor.copy( source.groundColor );\r\n\tthis.intensity = source.intensity;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/lights/PointLight.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\n\r\nTHREE.PointLight = function ( color, intensity, distance, decay ) {\r\n\r\n\tTHREE.Light.call( this, color );\r\n\r\n\tthis.type = 'PointLight';\r\n\r\n\tthis.intensity = ( intensity !== undefined ) ? intensity : 1;\r\n\tthis.distance = ( distance !== undefined ) ? distance : 0;\r\n\tthis.decay = ( decay !== undefined ) ? decay : 1;\t// for physically correct lights, should be 2.\r\n\r\n\tthis.shadow = new THREE.LightShadow( new THREE.PerspectiveCamera( 90, 1, 1, 500 ) );\r\n\r\n};\r\n\r\nTHREE.PointLight.prototype = Object.create( THREE.Light.prototype );\r\nTHREE.PointLight.prototype.constructor = THREE.PointLight;\r\n\r\nTHREE.PointLight.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Light.prototype.copy.call( this, source );\r\n\r\n\tthis.intensity = source.intensity;\r\n\tthis.distance = source.distance;\r\n\tthis.decay = source.decay;\r\n\r\n\tthis.shadow = source.shadow.clone();\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/lights/SpotLight.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.SpotLight = function ( color, intensity, distance, angle, exponent, decay ) {\r\n\r\n\tTHREE.Light.call( this, color );\r\n\r\n\tthis.type = 'SpotLight';\r\n\r\n\tthis.position.set( 0, 1, 0 );\r\n\tthis.updateMatrix();\r\n\r\n\tthis.target = new THREE.Object3D();\r\n\r\n\tthis.intensity = ( intensity !== undefined ) ? intensity : 1;\r\n\tthis.distance = ( distance !== undefined ) ? distance : 0;\r\n\tthis.angle = ( angle !== undefined ) ? angle : Math.PI / 3;\r\n\tthis.exponent = ( exponent !== undefined ) ? exponent : 10;\r\n\tthis.decay = ( decay !== undefined ) ? decay : 1;\t// for physically correct lights, should be 2.\r\n\r\n\tthis.shadow = new THREE.LightShadow( new THREE.PerspectiveCamera( 50, 1, 50, 5000 ) );\r\n\r\n};\r\n\r\nTHREE.SpotLight.prototype = Object.create( THREE.Light.prototype );\r\nTHREE.SpotLight.prototype.constructor = THREE.SpotLight;\r\n\r\nTHREE.SpotLight.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Light.prototype.copy.call( this, source );\r\n\r\n\tthis.intensity = source.intensity;\r\n\tthis.distance = source.distance;\r\n\tthis.angle = source.angle;\r\n\tthis.exponent = source.exponent;\r\n\tthis.decay = source.decay;\r\n\r\n\tthis.target = source.target.clone();\r\n\r\n\tthis.shadow = source.shadow.clone();\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/loaders/Cache.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Cache = {\r\n\r\n\tenabled: false,\r\n\r\n\tfiles: {},\r\n\r\n\tadd: function ( key, file ) {\r\n\r\n\t\tif ( this.enabled === false ) return;\r\n\r\n\t\t// console.log( 'THREE.Cache', 'Adding key:', key );\r\n\r\n\t\tthis.files[ key ] = file;\r\n\r\n\t},\r\n\r\n\tget: function ( key ) {\r\n\r\n\t\tif ( this.enabled === false ) return;\r\n\r\n\t\t// console.log( 'THREE.Cache', 'Checking key:', key );\r\n\r\n\t\treturn this.files[ key ];\r\n\r\n\t},\r\n\r\n\tremove: function ( key ) {\r\n\r\n\t\tdelete this.files[ key ];\r\n\r\n\t},\r\n\r\n\tclear: function () {\r\n\r\n\t\tthis.files = {};\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/Loader.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Loader = function () {\r\n\r\n\tthis.onLoadStart = function () {};\r\n\tthis.onLoadProgress = function () {};\r\n\tthis.onLoadComplete = function () {};\r\n\r\n};\r\n\r\nTHREE.Loader.prototype = {\r\n\r\n\tconstructor: THREE.Loader,\r\n\r\n\tcrossOrigin: undefined,\r\n\r\n\textractUrlBase: function ( url ) {\r\n\r\n\t\tvar parts = url.split( '/' );\r\n\r\n\t\tif ( parts.length === 1 ) return './';\r\n\r\n\t\tparts.pop();\r\n\r\n\t\treturn parts.join( '/' ) + '/';\r\n\r\n\t},\r\n\r\n\tinitMaterials: function ( materials, texturePath, crossOrigin ) {\r\n\r\n\t\tvar array = [];\r\n\r\n\t\tfor ( var i = 0; i < materials.length; ++ i ) {\r\n\r\n\t\t\tarray[ i ] = this.createMaterial( materials[ i ], texturePath, crossOrigin );\r\n\r\n\t\t}\r\n\r\n\t\treturn array;\r\n\r\n\t},\r\n\r\n\tcreateMaterial: ( function () {\r\n\r\n\t\tvar color, textureLoader, materialLoader;\r\n\r\n\t\treturn function ( m, texturePath, crossOrigin ) {\r\n\r\n\t\t\tif ( color === undefined ) color = new THREE.Color();\r\n\t\t\tif ( textureLoader === undefined ) textureLoader = new THREE.TextureLoader();\r\n\t\t\tif ( materialLoader === undefined ) materialLoader = new THREE.MaterialLoader();\r\n\r\n\t\t\t// convert from old material format\r\n\r\n\t\t\tvar textures = {};\r\n\r\n\t\t\tfunction loadTexture( path, repeat, offset, wrap, anisotropy ) {\r\n\r\n\t\t\t\tvar fullPath = texturePath + path;\r\n\t\t\t\tvar loader = THREE.Loader.Handlers.get( fullPath );\r\n\r\n\t\t\t\tvar texture;\r\n\r\n\t\t\t\tif ( loader !== null ) {\r\n\r\n\t\t\t\t\ttexture = loader.load( fullPath );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\ttextureLoader.setCrossOrigin( crossOrigin );\r\n\t\t\t\t\ttexture = textureLoader.load( fullPath );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( repeat !== undefined ) {\r\n\r\n\t\t\t\t\ttexture.repeat.fromArray( repeat );\r\n\r\n\t\t\t\t\tif ( repeat[ 0 ] !== 1 ) texture.wrapS = THREE.RepeatWrapping;\r\n\t\t\t\t\tif ( repeat[ 1 ] !== 1 ) texture.wrapT = THREE.RepeatWrapping;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( offset !== undefined ) {\r\n\r\n\t\t\t\t\ttexture.offset.fromArray( offset );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( wrap !== undefined ) {\r\n\r\n\t\t\t\t\tif ( wrap[ 0 ] === 'repeat' ) texture.wrapS = THREE.RepeatWrapping;\r\n\t\t\t\t\tif ( wrap[ 0 ] === 'mirror' ) texture.wrapS = THREE.MirroredRepeatWrapping;\r\n\r\n\t\t\t\t\tif ( wrap[ 1 ] === 'repeat' ) texture.wrapT = THREE.RepeatWrapping;\r\n\t\t\t\t\tif ( wrap[ 1 ] === 'mirror' ) texture.wrapT = THREE.MirroredRepeatWrapping;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( anisotropy !== undefined ) {\r\n\r\n\t\t\t\t\ttexture.anisotropy = anisotropy;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar uuid = THREE.Math.generateUUID();\r\n\r\n\t\t\t\ttextures[ uuid ] = texture;\r\n\r\n\t\t\t\treturn uuid;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\r\n\t\t\tvar json = {\r\n\t\t\t\tuuid: THREE.Math.generateUUID(),\r\n\t\t\t\ttype: 'MeshLambertMaterial'\r\n\t\t\t};\r\n\r\n\t\t\tfor ( var name in m ) {\r\n\r\n\t\t\t\tvar value = m[ name ];\r\n\r\n\t\t\t\tswitch ( name ) {\r\n\t\t\t\t\tcase 'DbgColor':\r\n\t\t\t\t\t\tjson.color = value;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'DbgIndex':\r\n\t\t\t\t\tcase 'opticalDensity':\r\n\t\t\t\t\tcase 'illumination':\r\n\t\t\t\t\t\t// These were never supported\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'DbgName':\r\n\t\t\t\t\t\tjson.name = value;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'blending':\r\n\t\t\t\t\t\tjson.blending = THREE[ value ];\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'colorDiffuse':\r\n\t\t\t\t\t\tjson.color = color.fromArray( value ).getHex();\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'colorSpecular':\r\n\t\t\t\t\t\tjson.specular = color.fromArray( value ).getHex();\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'colorEmissive':\r\n\t\t\t\t\t\tjson.emissive = color.fromArray( value ).getHex();\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'specularCoef':\r\n\t\t\t\t\t\tjson.shininess = value;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'shading':\r\n\t\t\t\t\t\tif ( value.toLowerCase() === 'basic' ) json.type = 'MeshBasicMaterial';\r\n\t\t\t\t\t\tif ( value.toLowerCase() === 'phong' ) json.type = 'MeshPhongMaterial';\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapDiffuse':\r\n\t\t\t\t\t\tjson.map = loadTexture( value, m.mapDiffuseRepeat, m.mapDiffuseOffset, m.mapDiffuseWrap, m.mapDiffuseAnisotropy );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapDiffuseRepeat':\r\n\t\t\t\t\tcase 'mapDiffuseOffset':\r\n\t\t\t\t\tcase 'mapDiffuseWrap':\r\n\t\t\t\t\tcase 'mapDiffuseAnisotropy':\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapLight':\r\n\t\t\t\t\t\tjson.lightMap = loadTexture( value, m.mapLightRepeat, m.mapLightOffset, m.mapLightWrap, m.mapLightAnisotropy );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapLightRepeat':\r\n\t\t\t\t\tcase 'mapLightOffset':\r\n\t\t\t\t\tcase 'mapLightWrap':\r\n\t\t\t\t\tcase 'mapLightAnisotropy':\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapAO':\r\n\t\t\t\t\t\tjson.aoMap = loadTexture( value, m.mapAORepeat, m.mapAOOffset, m.mapAOWrap, m.mapAOAnisotropy );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapAORepeat':\r\n\t\t\t\t\tcase 'mapAOOffset':\r\n\t\t\t\t\tcase 'mapAOWrap':\r\n\t\t\t\t\tcase 'mapAOAnisotropy':\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapBump':\r\n\t\t\t\t\t\tjson.bumpMap = loadTexture( value, m.mapBumpRepeat, m.mapBumpOffset, m.mapBumpWrap, m.mapBumpAnisotropy );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapBumpScale':\r\n\t\t\t\t\t\tjson.bumpScale = value;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapBumpRepeat':\r\n\t\t\t\t\tcase 'mapBumpOffset':\r\n\t\t\t\t\tcase 'mapBumpWrap':\r\n\t\t\t\t\tcase 'mapBumpAnisotropy':\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapNormal':\r\n\t\t\t\t\t\tjson.normalMap = loadTexture( value, m.mapNormalRepeat, m.mapNormalOffset, m.mapNormalWrap, m.mapNormalAnisotropy );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapNormalFactor':\r\n\t\t\t\t\t\tjson.normalScale = [ value, value ];\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapNormalRepeat':\r\n\t\t\t\t\tcase 'mapNormalOffset':\r\n\t\t\t\t\tcase 'mapNormalWrap':\r\n\t\t\t\t\tcase 'mapNormalAnisotropy':\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapSpecular':\r\n\t\t\t\t\t\tjson.specularMap = loadTexture( value, m.mapSpecularRepeat, m.mapSpecularOffset, m.mapSpecularWrap, m.mapSpecularAnisotropy );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapSpecularRepeat':\r\n\t\t\t\t\tcase 'mapSpecularOffset':\r\n\t\t\t\t\tcase 'mapSpecularWrap':\r\n\t\t\t\t\tcase 'mapSpecularAnisotropy':\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapAlpha':\r\n\t\t\t\t\t\tjson.alphaMap = loadTexture( value, m.mapAlphaRepeat, m.mapAlphaOffset, m.mapAlphaWrap, m.mapAlphaAnisotropy );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapAlphaRepeat':\r\n\t\t\t\t\tcase 'mapAlphaOffset':\r\n\t\t\t\t\tcase 'mapAlphaWrap':\r\n\t\t\t\t\tcase 'mapAlphaAnisotropy':\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'flipSided':\r\n\t\t\t\t\t\tjson.side = THREE.BackSide;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'doubleSided':\r\n\t\t\t\t\t\tjson.side = THREE.DoubleSide;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'transparency':\r\n\t\t\t\t\t\tconsole.warn( 'THREE.Loader: transparency has been renamed to opacity' );\r\n\t\t\t\t\t\tjson.opacity = value;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'opacity':\r\n\t\t\t\t\tcase 'transparent':\r\n\t\t\t\t\tcase 'depthTest':\r\n\t\t\t\t\tcase 'depthWrite':\r\n\t\t\t\t\tcase 'transparent':\r\n\t\t\t\t\tcase 'visible':\r\n\t\t\t\t\tcase 'wireframe':\r\n\t\t\t\t\t\tjson[ name ] = value;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'vertexColors':\r\n\t\t\t\t\t\tif ( value === true ) json.vertexColors = THREE.VertexColors;\r\n\t\t\t\t\t\tif ( value === 'face' ) json.vertexColors = THREE.FaceColors;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tconsole.error( 'Loader.createMaterial: Unsupported', name, value );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( json.type !== 'MeshPhongMaterial' ) delete json.specular;\r\n\t\t\tif ( json.opacity < 1 ) json.transparent = true;\r\n\r\n\t\t\tmaterialLoader.setTextures( textures );\r\n\r\n\t\t\treturn materialLoader.parse( json );\r\n\r\n\t\t};\r\n\r\n\t} )()\r\n\r\n};\r\n\r\nTHREE.Loader.Handlers = {\r\n\r\n\thandlers: [],\r\n\r\n\tadd: function ( regex, loader ) {\r\n\r\n\t\tthis.handlers.push( regex, loader );\r\n\r\n\t},\r\n\r\n\tget: function ( file ) {\r\n\r\n\t\tvar handlers = this.handlers;\r\n\r\n\t\tfor ( var i = 0, l = handlers.length; i < l; i += 2 ) {\r\n\r\n\t\t\tvar regex = handlers[ i ];\r\n\t\t\tvar loader  = handlers[ i + 1 ];\r\n\r\n\t\t\tif ( regex.test( file ) ) {\r\n\r\n\t\t\t\treturn loader;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/XHRLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.XHRLoader = function ( manager ) {\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\r\n};\r\n\r\nTHREE.XHRLoader.prototype = {\r\n\r\n\tconstructor: THREE.XHRLoader,\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar cached = THREE.Cache.get( url );\r\n\r\n\t\tif ( cached !== undefined ) {\r\n\r\n\t\t\tif ( onLoad ) {\r\n\r\n\t\t\t\tsetTimeout( function () {\r\n\r\n\t\t\t\t\tonLoad( cached );\r\n\r\n\t\t\t\t}, 0 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn cached;\r\n\r\n\t\t}\r\n\r\n\t\tvar request = new XMLHttpRequest();\r\n\t\trequest.open( 'GET', url, true );\r\n\r\n\t\trequest.addEventListener( 'load', function ( event ) {\r\n\r\n\t\t\tvar response = event.target.response;\r\n\r\n\t\t\tTHREE.Cache.add( url, response );\r\n\r\n\t\t\tif ( onLoad ) onLoad( response );\r\n\r\n\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t}, false );\r\n\r\n\t\tif ( onProgress !== undefined ) {\r\n\r\n\t\t\trequest.addEventListener( 'progress', function ( event ) {\r\n\r\n\t\t\t\tonProgress( event );\r\n\r\n\t\t\t}, false );\r\n\r\n\t\t}\r\n\r\n\t\trequest.addEventListener( 'error', function ( event ) {\r\n\r\n\t\t\tif ( onError ) onError( event );\r\n\r\n\t\t\tscope.manager.itemError( url );\r\n\r\n\t\t}, false );\r\n\r\n\t\tif ( this.crossOrigin !== undefined ) request.crossOrigin = this.crossOrigin;\r\n\t\tif ( this.responseType !== undefined ) request.responseType = this.responseType;\r\n\t\tif ( this.withCredentials !== undefined ) request.withCredentials = this.withCredentials;\r\n\r\n\t\trequest.send( null );\r\n\r\n\t\tscope.manager.itemStart( url );\r\n\r\n\t\treturn request;\r\n\r\n\t},\r\n\r\n\tsetResponseType: function ( value ) {\r\n\r\n\t\tthis.responseType = value;\r\n\r\n\t},\r\n\r\n\tsetCrossOrigin: function ( value ) {\r\n\r\n\t\tthis.crossOrigin = value;\r\n\r\n\t},\r\n\r\n\tsetWithCredentials: function ( value ) {\r\n\r\n\t\tthis.withCredentials = value;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/ImageLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.ImageLoader = function ( manager ) {\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\r\n};\r\n\r\nTHREE.ImageLoader.prototype = {\r\n\r\n\tconstructor: THREE.ImageLoader,\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar cached = THREE.Cache.get( url );\r\n\r\n\t\tif ( cached !== undefined ) {\r\n\r\n\t\t\tscope.manager.itemStart( url );\r\n\r\n\t\t\tif ( onLoad ) {\r\n\r\n\t\t\t\tsetTimeout( function () {\r\n\r\n\t\t\t\t\tonLoad( cached );\r\n\r\n\t\t\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t\t\t}, 0 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn cached;\r\n\r\n\t\t}\r\n\r\n\t\tvar image = document.createElement( 'img' );\r\n\r\n\t\timage.addEventListener( 'load', function ( event ) {\r\n\r\n\t\t\tTHREE.Cache.add( url, this );\r\n\r\n\t\t\tif ( onLoad ) onLoad( this );\r\n\r\n\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t}, false );\r\n\r\n\t\tif ( onProgress !== undefined ) {\r\n\r\n\t\t\timage.addEventListener( 'progress', function ( event ) {\r\n\r\n\t\t\t\tonProgress( event );\r\n\r\n\t\t\t}, false );\r\n\r\n\t\t}\r\n\r\n\t\timage.addEventListener( 'error', function ( event ) {\r\n\r\n\t\t\tif ( onError ) onError( event );\r\n\r\n\t\t\tscope.manager.itemError( url );\r\n\r\n\t\t}, false );\r\n\r\n\t\tif ( this.crossOrigin !== undefined ) image.crossOrigin = this.crossOrigin;\r\n\r\n\t\tscope.manager.itemStart( url );\r\n\r\n\t\timage.src = url;\r\n\r\n\t\treturn image;\r\n\r\n\t},\r\n\r\n\tsetCrossOrigin: function ( value ) {\r\n\r\n\t\tthis.crossOrigin = value;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/JSONLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.JSONLoader = function ( manager ) {\r\n\r\n\tif ( typeof manager === 'boolean' ) {\r\n\r\n\t\tconsole.warn( 'THREE.JSONLoader: showStatus parameter has been removed from constructor.' );\r\n\t\tmanager = undefined;\r\n\r\n\t}\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\r\n\tthis.withCredentials = false;\r\n\r\n};\r\n\r\nTHREE.JSONLoader.prototype = {\r\n\r\n\tconstructor: THREE.JSONLoader,\r\n\r\n\t// Deprecated\r\n\r\n\tget statusDomElement () {\r\n\r\n\t\tif ( this._statusDomElement === undefined ) {\r\n\r\n\t\t\tthis._statusDomElement = document.createElement( 'div' );\r\n\r\n\t\t}\r\n\r\n\t\tconsole.warn( 'THREE.JSONLoader: .statusDomElement has been removed.' );\r\n\t\treturn this._statusDomElement;\r\n\r\n\t},\r\n\r\n\tload: function( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar texturePath = this.texturePath && ( typeof this.texturePath === \"string\" ) ? this.texturePath : THREE.Loader.prototype.extractUrlBase( url );\r\n\r\n\t\tvar loader = new THREE.XHRLoader( this.manager );\r\n\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\t\tloader.setWithCredentials( this.withCredentials );\r\n\t\tloader.load( url, function ( text ) {\r\n\r\n\t\t\tvar json = JSON.parse( text );\r\n\t\t\tvar metadata = json.metadata;\r\n\r\n\t\t\tif ( metadata !== undefined ) {\r\n\r\n\t\t\t\tif ( metadata.type === 'object' ) {\r\n\r\n\t\t\t\t\tconsole.error( 'THREE.JSONLoader: ' + url + ' should be loaded with THREE.ObjectLoader instead.' );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( metadata.type === 'scene' ) {\r\n\r\n\t\t\t\t\tconsole.error( 'THREE.JSONLoader: ' + url + ' should be loaded with THREE.SceneLoader instead.' );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar object = scope.parse( json, texturePath );\r\n\t\t\tonLoad( object.geometry, object.materials );\r\n\r\n\t\t} );\r\n\r\n\t},\r\n\r\n\tsetCrossOrigin: function ( value ) {\r\n\r\n\t\tthis.crossOrigin = value;\r\n\r\n\t},\r\n\r\n\tsetTexturePath: function ( value ) {\r\n\r\n\t\tthis.texturePath = value;\r\n\r\n\t},\r\n\r\n\tparse: function ( json, texturePath ) {\r\n\r\n\t\tvar geometry = new THREE.Geometry(),\r\n\t\tscale = ( json.scale !== undefined ) ? 1.0 / json.scale : 1.0;\r\n\r\n\t\tparseModel( scale );\r\n\r\n\t\tparseSkin();\r\n\t\tparseMorphing( scale );\r\n\t\tparseAnimations();\r\n\r\n\t\tgeometry.computeFaceNormals();\r\n\t\tgeometry.computeBoundingSphere();\r\n\r\n\t\tfunction parseModel( scale ) {\r\n\r\n\t\t\tfunction isBitSet( value, position ) {\r\n\r\n\t\t\t\treturn value & ( 1 << position );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar i, j, fi,\r\n\r\n\t\t\toffset, zLength,\r\n\r\n\t\tcolorIndex, normalIndex, uvIndex, materialIndex,\r\n\r\n\t\t\ttype,\r\n\t\t\tisQuad,\r\n\t\t\thasMaterial,\r\n\t\t\thasFaceVertexUv,\r\n\t\t\thasFaceNormal, hasFaceVertexNormal,\r\n\t\t\thasFaceColor, hasFaceVertexColor,\r\n\r\n\t\tvertex, face, faceA, faceB, hex, normal,\r\n\r\n\t\t\tuvLayer, uv, u, v,\r\n\r\n\t\t\tfaces = json.faces,\r\n\t\t\tvertices = json.vertices,\r\n\t\t\tnormals = json.normals,\r\n\t\t\tcolors = json.colors,\r\n\r\n\t\t\tnUvLayers = 0;\r\n\r\n\t\t\tif ( json.uvs !== undefined ) {\r\n\r\n\t\t\t\t// disregard empty arrays\r\n\r\n\t\t\t\tfor ( i = 0; i < json.uvs.length; i ++ ) {\r\n\r\n\t\t\t\t\tif ( json.uvs[ i ].length ) nUvLayers ++;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor ( i = 0; i < nUvLayers; i ++ ) {\r\n\r\n\t\t\t\t\tgeometry.faceVertexUvs[ i ] = [];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\toffset = 0;\r\n\t\t\tzLength = vertices.length;\r\n\r\n\t\t\twhile ( offset < zLength ) {\r\n\r\n\t\t\t\tvertex = new THREE.Vector3();\r\n\r\n\t\t\t\tvertex.x = vertices[ offset ++ ] * scale;\r\n\t\t\t\tvertex.y = vertices[ offset ++ ] * scale;\r\n\t\t\t\tvertex.z = vertices[ offset ++ ] * scale;\r\n\r\n\t\t\t\tgeometry.vertices.push( vertex );\r\n\r\n\t\t\t}\r\n\r\n\t\t\toffset = 0;\r\n\t\t\tzLength = faces.length;\r\n\r\n\t\t\twhile ( offset < zLength ) {\r\n\r\n\t\t\t\ttype = faces[ offset ++ ];\r\n\r\n\r\n\t\t\t\tisQuad              = isBitSet( type, 0 );\r\n\t\t\t\thasMaterial         = isBitSet( type, 1 );\r\n\t\t\t\thasFaceVertexUv     = isBitSet( type, 3 );\r\n\t\t\t\thasFaceNormal       = isBitSet( type, 4 );\r\n\t\t\t\thasFaceVertexNormal = isBitSet( type, 5 );\r\n\t\t\t\thasFaceColor\t     = isBitSet( type, 6 );\r\n\t\t\t\thasFaceVertexColor  = isBitSet( type, 7 );\r\n\r\n\t\t\t\t// console.log(\"type\", type, \"bits\", isQuad, hasMaterial, hasFaceVertexUv, hasFaceNormal, hasFaceVertexNormal, hasFaceColor, hasFaceVertexColor);\r\n\r\n\t\t\t\tif ( isQuad ) {\r\n\r\n\t\t\t\t\tfaceA = new THREE.Face3();\r\n\t\t\t\t\tfaceA.a = faces[ offset ];\r\n\t\t\t\t\tfaceA.b = faces[ offset + 1 ];\r\n\t\t\t\t\tfaceA.c = faces[ offset + 3 ];\r\n\r\n\t\t\t\t\tfaceB = new THREE.Face3();\r\n\t\t\t\t\tfaceB.a = faces[ offset + 1 ];\r\n\t\t\t\t\tfaceB.b = faces[ offset + 2 ];\r\n\t\t\t\t\tfaceB.c = faces[ offset + 3 ];\r\n\r\n\t\t\t\t\toffset += 4;\r\n\r\n\t\t\t\t\tif ( hasMaterial ) {\r\n\r\n\t\t\t\t\t\tmaterialIndex = faces[ offset ++ ];\r\n\t\t\t\t\t\tfaceA.materialIndex = materialIndex;\r\n\t\t\t\t\t\tfaceB.materialIndex = materialIndex;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// to get face <=> uv index correspondence\r\n\r\n\t\t\t\t\tfi = geometry.faces.length;\r\n\r\n\t\t\t\t\tif ( hasFaceVertexUv ) {\r\n\r\n\t\t\t\t\t\tfor ( i = 0; i < nUvLayers; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tuvLayer = json.uvs[ i ];\r\n\r\n\t\t\t\t\t\t\tgeometry.faceVertexUvs[ i ][ fi ] = [];\r\n\t\t\t\t\t\t\tgeometry.faceVertexUvs[ i ][ fi + 1 ] = [];\r\n\r\n\t\t\t\t\t\t\tfor ( j = 0; j < 4; j ++ ) {\r\n\r\n\t\t\t\t\t\t\t\tuvIndex = faces[ offset ++ ];\r\n\r\n\t\t\t\t\t\t\t\tu = uvLayer[ uvIndex * 2 ];\r\n\t\t\t\t\t\t\t\tv = uvLayer[ uvIndex * 2 + 1 ];\r\n\r\n\t\t\t\t\t\t\t\tuv = new THREE.Vector2( u, v );\r\n\r\n\t\t\t\t\t\t\t\tif ( j !== 2 ) geometry.faceVertexUvs[ i ][ fi ].push( uv );\r\n\t\t\t\t\t\t\t\tif ( j !== 0 ) geometry.faceVertexUvs[ i ][ fi + 1 ].push( uv );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( hasFaceNormal ) {\r\n\r\n\t\t\t\t\t\tnormalIndex = faces[ offset ++ ] * 3;\r\n\r\n\t\t\t\t\t\tfaceA.normal.set(\r\n\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\tnormals[ normalIndex ]\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tfaceB.normal.copy( faceA.normal );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( hasFaceVertexNormal ) {\r\n\r\n\t\t\t\t\t\tfor ( i = 0; i < 4; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tnormalIndex = faces[ offset ++ ] * 3;\r\n\r\n\t\t\t\t\t\t\tnormal = new THREE.Vector3(\r\n\t\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\t\tnormals[ normalIndex ]\r\n\t\t\t\t\t\t\t);\r\n\r\n\r\n\t\t\t\t\t\t\tif ( i !== 2 ) faceA.vertexNormals.push( normal );\r\n\t\t\t\t\t\t\tif ( i !== 0 ) faceB.vertexNormals.push( normal );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\tif ( hasFaceColor ) {\r\n\r\n\t\t\t\t\t\tcolorIndex = faces[ offset ++ ];\r\n\t\t\t\t\t\thex = colors[ colorIndex ];\r\n\r\n\t\t\t\t\t\tfaceA.color.setHex( hex );\r\n\t\t\t\t\t\tfaceB.color.setHex( hex );\r\n\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\tif ( hasFaceVertexColor ) {\r\n\r\n\t\t\t\t\t\tfor ( i = 0; i < 4; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tcolorIndex = faces[ offset ++ ];\r\n\t\t\t\t\t\t\thex = colors[ colorIndex ];\r\n\r\n\t\t\t\t\t\t\tif ( i !== 2 ) faceA.vertexColors.push( new THREE.Color( hex ) );\r\n\t\t\t\t\t\t\tif ( i !== 0 ) faceB.vertexColors.push( new THREE.Color( hex ) );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tgeometry.faces.push( faceA );\r\n\t\t\t\t\tgeometry.faces.push( faceB );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tface = new THREE.Face3();\r\n\t\t\t\t\tface.a = faces[ offset ++ ];\r\n\t\t\t\t\tface.b = faces[ offset ++ ];\r\n\t\t\t\t\tface.c = faces[ offset ++ ];\r\n\r\n\t\t\t\t\tif ( hasMaterial ) {\r\n\r\n\t\t\t\t\t\tmaterialIndex = faces[ offset ++ ];\r\n\t\t\t\t\t\tface.materialIndex = materialIndex;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// to get face <=> uv index correspondence\r\n\r\n\t\t\t\t\tfi = geometry.faces.length;\r\n\r\n\t\t\t\t\tif ( hasFaceVertexUv ) {\r\n\r\n\t\t\t\t\t\tfor ( i = 0; i < nUvLayers; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tuvLayer = json.uvs[ i ];\r\n\r\n\t\t\t\t\t\t\tgeometry.faceVertexUvs[ i ][ fi ] = [];\r\n\r\n\t\t\t\t\t\t\tfor ( j = 0; j < 3; j ++ ) {\r\n\r\n\t\t\t\t\t\t\t\tuvIndex = faces[ offset ++ ];\r\n\r\n\t\t\t\t\t\t\t\tu = uvLayer[ uvIndex * 2 ];\r\n\t\t\t\t\t\t\t\tv = uvLayer[ uvIndex * 2 + 1 ];\r\n\r\n\t\t\t\t\t\t\t\tuv = new THREE.Vector2( u, v );\r\n\r\n\t\t\t\t\t\t\t\tgeometry.faceVertexUvs[ i ][ fi ].push( uv );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( hasFaceNormal ) {\r\n\r\n\t\t\t\t\t\tnormalIndex = faces[ offset ++ ] * 3;\r\n\r\n\t\t\t\t\t\tface.normal.set(\r\n\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\tnormals[ normalIndex ]\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( hasFaceVertexNormal ) {\r\n\r\n\t\t\t\t\t\tfor ( i = 0; i < 3; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tnormalIndex = faces[ offset ++ ] * 3;\r\n\r\n\t\t\t\t\t\t\tnormal = new THREE.Vector3(\r\n\t\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\t\tnormals[ normalIndex ]\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tface.vertexNormals.push( normal );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\tif ( hasFaceColor ) {\r\n\r\n\t\t\t\t\t\tcolorIndex = faces[ offset ++ ];\r\n\t\t\t\t\t\tface.color.setHex( colors[ colorIndex ] );\r\n\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\tif ( hasFaceVertexColor ) {\r\n\r\n\t\t\t\t\t\tfor ( i = 0; i < 3; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tcolorIndex = faces[ offset ++ ];\r\n\t\t\t\t\t\t\tface.vertexColors.push( new THREE.Color( colors[ colorIndex ] ) );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tgeometry.faces.push( face );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t\tfunction parseSkin() {\r\n\r\n\t\t\tvar influencesPerVertex = ( json.influencesPerVertex !== undefined ) ? json.influencesPerVertex : 2;\r\n\r\n\t\t\tif ( json.skinWeights ) {\r\n\r\n\t\t\t\tfor ( var i = 0, l = json.skinWeights.length; i < l; i += influencesPerVertex ) {\r\n\r\n\t\t\t\t\tvar x =                               json.skinWeights[ i ];\r\n\t\t\t\t\tvar y = ( influencesPerVertex > 1 ) ? json.skinWeights[ i + 1 ] : 0;\r\n\t\t\t\t\tvar z = ( influencesPerVertex > 2 ) ? json.skinWeights[ i + 2 ] : 0;\r\n\t\t\t\t\tvar w = ( influencesPerVertex > 3 ) ? json.skinWeights[ i + 3 ] : 0;\r\n\r\n\t\t\t\t\tgeometry.skinWeights.push( new THREE.Vector4( x, y, z, w ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( json.skinIndices ) {\r\n\r\n\t\t\t\tfor ( var i = 0, l = json.skinIndices.length; i < l; i += influencesPerVertex ) {\r\n\r\n\t\t\t\t\tvar a =                               json.skinIndices[ i ];\r\n\t\t\t\t\tvar b = ( influencesPerVertex > 1 ) ? json.skinIndices[ i + 1 ] : 0;\r\n\t\t\t\t\tvar c = ( influencesPerVertex > 2 ) ? json.skinIndices[ i + 2 ] : 0;\r\n\t\t\t\t\tvar d = ( influencesPerVertex > 3 ) ? json.skinIndices[ i + 3 ] : 0;\r\n\r\n\t\t\t\t\tgeometry.skinIndices.push( new THREE.Vector4( a, b, c, d ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometry.bones = json.bones;\r\n\r\n\t\t\tif ( geometry.bones && geometry.bones.length > 0 && ( geometry.skinWeights.length !== geometry.skinIndices.length || geometry.skinIndices.length !== geometry.vertices.length ) ) {\r\n\r\n\t\t\t\tconsole.warn( 'When skinning, number of vertices (' + geometry.vertices.length + '), skinIndices (' +\r\n\t\t\t\t\tgeometry.skinIndices.length + '), and skinWeights (' + geometry.skinWeights.length + ') should match.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t\tfunction parseMorphing( scale ) {\r\n\r\n\t\t\tif ( json.morphTargets !== undefined ) {\r\n\r\n\t\t\t\tfor ( var i = 0, l = json.morphTargets.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tgeometry.morphTargets[ i ] = {};\r\n\t\t\t\t\tgeometry.morphTargets[ i ].name = json.morphTargets[ i ].name;\r\n\t\t\t\t\tgeometry.morphTargets[ i ].vertices = [];\r\n\r\n\t\t\t\t\tvar dstVertices = geometry.morphTargets[ i ].vertices;\r\n\t\t\t\t\tvar srcVertices = json.morphTargets[ i ].vertices;\r\n\r\n\t\t\t\t\tfor ( var v = 0, vl = srcVertices.length; v < vl; v += 3 ) {\r\n\r\n\t\t\t\t\t\tvar vertex = new THREE.Vector3();\r\n\t\t\t\t\t\tvertex.x = srcVertices[ v ] * scale;\r\n\t\t\t\t\t\tvertex.y = srcVertices[ v + 1 ] * scale;\r\n\t\t\t\t\t\tvertex.z = srcVertices[ v + 2 ] * scale;\r\n\r\n\t\t\t\t\t\tdstVertices.push( vertex );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( json.morphColors !== undefined && json.morphColors.length > 0 ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.JSONLoader: \"morphColors\" no longer supported. Using them as face colors.' );\r\n\r\n\t\t\t\tvar faces = geometry.faces;\r\n\t\t\t\tvar morphColors = json.morphColors[ 0 ].colors;\r\n\r\n\t\t\t\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tfaces[ i ].color.fromArray( morphColors, i * 3 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseAnimations() {\r\n\r\n\t\t\tvar outputAnimations = [];\r\n\r\n\t\t\t// parse old style Bone/Hierarchy animations\r\n\t\t\tvar animations = [];\r\n\t\t\tif ( json.animation !== undefined ) {\r\n\t\t\t\tanimations.push( json.animation );\r\n\t\t\t}\r\n\t\t\tif ( json.animations !== undefined ) {\r\n\t\t\t\tif ( json.animations.length ) {\r\n\t\t\t\t\tanimations = animations.concat( json.animations );\r\n\t\t\t\t} else {\r\n\t\t\t\t\tanimations.push( json.animations );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var i = 0; i < animations.length; i ++ ) {\r\n\r\n\t\t\t\tvar clip = THREE.AnimationClip.parseAnimation( animations[i], geometry.bones );\r\n\t\t\t\tif ( clip ) outputAnimations.push( clip );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// parse implicit morph animations\r\n\t\t\tif ( geometry.morphTargets ) {\r\n\r\n\t\t\t\t// TODO: Figure out what an appropraite FPS is for morph target animations -- defaulting to 10, but really it is completely arbitrary.\r\n\t\t\t\tvar morphAnimationClips = THREE.AnimationClip.CreateClipsFromMorphTargetSequences( geometry.morphTargets, 10 );\r\n\t\t\t\toutputAnimations = outputAnimations.concat( morphAnimationClips );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( outputAnimations.length > 0 ) geometry.animations = outputAnimations;\r\n\r\n\t\t};\r\n\r\n\t\tif ( json.materials === undefined || json.materials.length === 0 ) {\r\n\r\n\t\t\treturn { geometry: geometry };\r\n\r\n\t\t} else {\r\n\r\n\t\t\tvar materials = THREE.Loader.prototype.initMaterials( json.materials, texturePath, this.crossOrigin );\r\n\r\n\t\t\treturn { geometry: geometry, materials: materials };\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/LoadingManager.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.LoadingManager = function ( onLoad, onProgress, onError ) {\r\n\r\n\tvar scope = this;\r\n\r\n\tvar isLoading = false, itemsLoaded = 0, itemsTotal = 0;\r\n\r\n\tthis.onStart = undefined;\r\n\tthis.onLoad = onLoad;\r\n\tthis.onProgress = onProgress;\r\n\tthis.onError = onError;\r\n\r\n\tthis.itemStart = function ( url ) {\r\n\r\n\t\titemsTotal ++;\r\n\r\n\t\tif ( isLoading === false ) {\r\n\r\n\t\t\tif ( scope.onStart !== undefined ) {\r\n\r\n\t\t\t\tscope.onStart( url, itemsLoaded, itemsTotal );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tisLoading = true;\r\n\r\n\t};\r\n\r\n\tthis.itemEnd = function ( url ) {\r\n\r\n\t\titemsLoaded ++;\r\n\r\n\t\tif ( scope.onProgress !== undefined ) {\r\n\r\n\t\t\tscope.onProgress( url, itemsLoaded, itemsTotal );\r\n\r\n\t\t}\r\n\r\n\t\tif ( itemsLoaded === itemsTotal ) {\r\n\r\n\t\t\tisLoading = false;\r\n\r\n\t\t\tif ( scope.onLoad !== undefined ) {\r\n\r\n\t\t\t\tscope.onLoad();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.itemError = function ( url ) {\r\n\r\n\t\tif ( scope.onError !== undefined ) {\r\n\r\n\t\t\tscope.onError( url );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n};\r\n\r\nTHREE.DefaultLoadingManager = new THREE.LoadingManager();\r\n\r\n// File:src/loaders/BufferGeometryLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.BufferGeometryLoader = function ( manager ) {\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\r\n};\r\n\r\nTHREE.BufferGeometryLoader.prototype = {\r\n\r\n\tconstructor: THREE.BufferGeometryLoader,\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar loader = new THREE.XHRLoader( scope.manager );\r\n\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\t\tloader.load( url, function ( text ) {\r\n\r\n\t\t\tonLoad( scope.parse( JSON.parse( text ) ) );\r\n\r\n\t\t}, onProgress, onError );\r\n\r\n\t},\r\n\r\n\tsetCrossOrigin: function ( value ) {\r\n\r\n\t\tthis.crossOrigin = value;\r\n\r\n\t},\r\n\r\n\tparse: function ( json ) {\r\n\r\n\t\tvar geometry = new THREE.BufferGeometry();\r\n\r\n\t\tvar index = json.data.index;\r\n\r\n\t\tif ( index !== undefined ) {\r\n\r\n\t\t\tvar typedArray = new self[ index.type ]( index.array );\r\n\t\t\tgeometry.setIndex( new THREE.BufferAttribute( typedArray, 1 ) );\r\n\r\n\t\t}\r\n\r\n\t\tvar attributes = json.data.attributes;\r\n\r\n\t\tfor ( var key in attributes ) {\r\n\r\n\t\t\tvar attribute = attributes[ key ];\r\n\t\t\tvar typedArray = new self[ attribute.type ]( attribute.array );\r\n\r\n\t\t\tgeometry.addAttribute( key, new THREE.BufferAttribute( typedArray, attribute.itemSize ) );\r\n\r\n\t\t}\r\n\r\n\t\tvar groups = json.data.groups || json.data.drawcalls || json.data.offsets;\r\n\r\n\t\tif ( groups !== undefined ) {\r\n\r\n\t\t\tfor ( var i = 0, n = groups.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\tvar group = groups[ i ];\r\n\r\n\t\t\t\tgeometry.addGroup( group.start, group.count );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar boundingSphere = json.data.boundingSphere;\r\n\r\n\t\tif ( boundingSphere !== undefined ) {\r\n\r\n\t\t\tvar center = new THREE.Vector3();\r\n\r\n\t\t\tif ( boundingSphere.center !== undefined ) {\r\n\r\n\t\t\t\tcenter.fromArray( boundingSphere.center );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometry.boundingSphere = new THREE.Sphere( center, boundingSphere.radius );\r\n\r\n\t\t}\r\n\r\n\t\treturn geometry;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/MaterialLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.MaterialLoader = function ( manager ) {\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\tthis.textures = {};\r\n\r\n};\r\n\r\nTHREE.MaterialLoader.prototype = {\r\n\r\n\tconstructor: THREE.MaterialLoader,\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar loader = new THREE.XHRLoader( scope.manager );\r\n\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\t\tloader.load( url, function ( text ) {\r\n\r\n\t\t\tonLoad( scope.parse( JSON.parse( text ) ) );\r\n\r\n\t\t}, onProgress, onError );\r\n\r\n\t},\r\n\r\n\tsetCrossOrigin: function ( value ) {\r\n\r\n\t\tthis.crossOrigin = value;\r\n\r\n\t},\r\n\r\n\tsetTextures: function ( value ) {\r\n\r\n\t\tthis.textures = value;\r\n\r\n\t},\r\n\r\n\tgetTexture: function ( name ) {\r\n\r\n\t\tvar textures = this.textures;\r\n\r\n\t\tif ( textures[ name ] === undefined ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.MaterialLoader: Undefined texture', name );\r\n\r\n\t\t}\r\n\r\n\t\treturn textures[ name ];\r\n\r\n\t},\r\n\r\n\tparse: function ( json ) {\r\n\r\n\t\tvar material = new THREE[ json.type ];\r\n\t\tmaterial.uuid = json.uuid;\r\n\r\n\t\tif ( json.name !== undefined ) material.name = json.name;\r\n\t\tif ( json.color !== undefined ) material.color.setHex( json.color );\r\n\t\tif ( json.emissive !== undefined ) material.emissive.setHex( json.emissive );\r\n\t\tif ( json.specular !== undefined ) material.specular.setHex( json.specular );\r\n\t\tif ( json.shininess !== undefined ) material.shininess = json.shininess;\r\n\t\tif ( json.uniforms !== undefined ) material.uniforms = json.uniforms;\r\n\t\tif ( json.vertexShader !== undefined ) material.vertexShader = json.vertexShader;\r\n\t\tif ( json.fragmentShader !== undefined ) material.fragmentShader = json.fragmentShader;\r\n\t\tif ( json.vertexColors !== undefined ) material.vertexColors = json.vertexColors;\r\n\t\tif ( json.shading !== undefined ) material.shading = json.shading;\r\n\t\tif ( json.blending !== undefined ) material.blending = json.blending;\r\n\t\tif ( json.side !== undefined ) material.side = json.side;\r\n\t\tif ( json.opacity !== undefined ) material.opacity = json.opacity;\r\n\t\tif ( json.transparent !== undefined ) material.transparent = json.transparent;\r\n\t\tif ( json.alphaTest !== undefined ) material.alphaTest = json.alphaTest;\r\n\t\tif ( json.depthTest !== undefined ) material.depthTest = json.depthTest;\r\n\t\tif ( json.depthWrite !== undefined ) material.depthWrite = json.depthWrite;\r\n\t\tif ( json.wireframe !== undefined ) material.wireframe = json.wireframe;\r\n\t\tif ( json.wireframeLinewidth !== undefined ) material.wireframeLinewidth = json.wireframeLinewidth;\r\n\r\n\t\t// for PointsMaterial\r\n\t\tif ( json.size !== undefined ) material.size = json.size;\r\n\t\tif ( json.sizeAttenuation !== undefined ) material.sizeAttenuation = json.sizeAttenuation;\r\n\r\n\t\t// maps\r\n\r\n\t\tif ( json.map !== undefined ) material.map = this.getTexture( json.map );\r\n\r\n\t\tif ( json.alphaMap !== undefined ) {\r\n\r\n\t\t\tmaterial.alphaMap = this.getTexture( json.alphaMap );\r\n\t\t\tmaterial.transparent = true;\r\n\r\n\t\t}\r\n\r\n\t\tif ( json.bumpMap !== undefined ) material.bumpMap = this.getTexture( json.bumpMap );\r\n\t\tif ( json.bumpScale !== undefined ) material.bumpScale = json.bumpScale;\r\n\r\n\t\tif ( json.normalMap !== undefined ) material.normalMap = this.getTexture( json.normalMap );\r\n\t\tif ( json.normalScale )\tmaterial.normalScale = new THREE.Vector2( json.normalScale, json.normalScale );\r\n\r\n\t\tif ( json.displacementMap !== undefined ) material.displacementMap = this.getTexture( json.displacementMap );\r\n\t\tif ( json.displacementScale !== undefined ) material.displacementScale = json.displacementScale;\r\n\t\tif ( json.displacementBias !== undefined ) material.displacementBias = json.displacementBias;\r\n\r\n\t\tif ( json.specularMap !== undefined ) material.specularMap = this.getTexture( json.specularMap );\r\n\r\n\t\tif ( json.envMap !== undefined ) {\r\n\r\n\t\t\tmaterial.envMap = this.getTexture( json.envMap );\r\n\t\t\tmaterial.combine = THREE.MultiplyOperation;\r\n\r\n\t\t}\r\n\r\n\t\tif ( json.reflectivity ) material.reflectivity = json.reflectivity;\r\n\r\n\t\tif ( json.lightMap !== undefined ) material.lightMap = this.getTexture( json.lightMap );\r\n\t\tif ( json.lightMapIntensity !== undefined ) material.lightMapIntensity = json.lightMapIntensity;\r\n\r\n\t\tif ( json.aoMap !== undefined ) material.aoMap = this.getTexture( json.aoMap );\r\n\t\tif ( json.aoMapIntensity !== undefined ) material.aoMapIntensity = json.aoMapIntensity;\r\n\r\n\t\t// MeshFaceMaterial\r\n\r\n\t\tif ( json.materials !== undefined ) {\r\n\r\n\t\t\tfor ( var i = 0, l = json.materials.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tmaterial.materials.push( this.parse( json.materials[ i ] ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn material;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/ObjectLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.ObjectLoader = function ( manager ) {\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\tthis.texturePath = '';\r\n\r\n};\r\n\r\nTHREE.ObjectLoader.prototype = {\r\n\r\n\tconstructor: THREE.ObjectLoader,\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tif ( this.texturePath === '' ) {\r\n\r\n\t\t\tthis.texturePath = url.substring( 0, url.lastIndexOf( '/' ) + 1 );\r\n\r\n\t\t}\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar loader = new THREE.XHRLoader( scope.manager );\r\n\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\t\tloader.load( url, function ( text ) {\r\n\r\n\t\t\tscope.parse( JSON.parse( text ), onLoad );\r\n\r\n\t\t}, onProgress, onError );\r\n\r\n\t},\r\n\r\n\tsetTexturePath: function ( value ) {\r\n\r\n\t\tthis.texturePath = value;\r\n\r\n\t},\r\n\r\n\tsetCrossOrigin: function ( value ) {\r\n\r\n\t\tthis.crossOrigin = value;\r\n\r\n\t},\r\n\r\n\tparse: function ( json, onLoad ) {\r\n\r\n\t\tvar geometries = this.parseGeometries( json.geometries );\r\n\r\n\t\tvar images = this.parseImages( json.images, function () {\r\n\r\n\t\t\tif ( onLoad !== undefined ) onLoad( object );\r\n\r\n\t\t} );\r\n\r\n\t\tvar textures  = this.parseTextures( json.textures, images );\r\n\t\tvar materials = this.parseMaterials( json.materials, textures );\r\n\r\n\t\tvar object = this.parseObject( json.object, geometries, materials );\r\n\r\n\t\tif ( json.animations ) {\r\n\r\n\t\t\tobject.animations = this.parseAnimations( json.animations );\r\n\r\n\t\t}\r\n\r\n\t\tif ( json.images === undefined || json.images.length === 0 ) {\r\n\r\n\t\t\tif ( onLoad !== undefined ) onLoad( object );\r\n\r\n\t\t}\r\n\r\n\t\treturn object;\r\n\r\n\t},\r\n\r\n\tparseGeometries: function ( json ) {\r\n\r\n\t\tvar geometries = {};\r\n\r\n\t\tif ( json !== undefined ) {\r\n\r\n\t\t\tvar geometryLoader = new THREE.JSONLoader();\r\n\t\t\tvar bufferGeometryLoader = new THREE.BufferGeometryLoader();\r\n\r\n\t\t\tfor ( var i = 0, l = json.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar geometry;\r\n\t\t\t\tvar data = json[ i ];\r\n\r\n\t\t\t\tswitch ( data.type ) {\r\n\r\n\t\t\t\t\tcase 'PlaneGeometry':\r\n\t\t\t\t\tcase 'PlaneBufferGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE[ data.type ](\r\n\t\t\t\t\t\t\tdata.width,\r\n\t\t\t\t\t\t\tdata.height,\r\n\t\t\t\t\t\t\tdata.widthSegments,\r\n\t\t\t\t\t\t\tdata.heightSegments\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'BoxGeometry':\r\n\t\t\t\t\tcase 'CubeGeometry': // backwards compatible\r\n\r\n\t\t\t\t\t\tgeometry = new THREE.BoxGeometry(\r\n\t\t\t\t\t\t\tdata.width,\r\n\t\t\t\t\t\t\tdata.height,\r\n\t\t\t\t\t\t\tdata.depth,\r\n\t\t\t\t\t\t\tdata.widthSegments,\r\n\t\t\t\t\t\t\tdata.heightSegments,\r\n\t\t\t\t\t\t\tdata.depthSegments\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'CircleBufferGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE.CircleBufferGeometry(\r\n\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\tdata.segments,\r\n\t\t\t\t\t\t\tdata.thetaStart,\r\n\t\t\t\t\t\t\tdata.thetaLength\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'CircleGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE.CircleGeometry(\r\n\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\tdata.segments,\r\n\t\t\t\t\t\t\tdata.thetaStart,\r\n\t\t\t\t\t\t\tdata.thetaLength\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'CylinderGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE.CylinderGeometry(\r\n\t\t\t\t\t\t\tdata.radiusTop,\r\n\t\t\t\t\t\t\tdata.radiusBottom,\r\n\t\t\t\t\t\t\tdata.height,\r\n\t\t\t\t\t\t\tdata.radialSegments,\r\n\t\t\t\t\t\t\tdata.heightSegments,\r\n\t\t\t\t\t\t\tdata.openEnded,\r\n\t\t\t\t\t\t\tdata.thetaStart,\r\n\t\t\t\t\t\t\tdata.thetaLength\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'SphereGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE.SphereGeometry(\r\n\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\tdata.widthSegments,\r\n\t\t\t\t\t\t\tdata.heightSegments,\r\n\t\t\t\t\t\t\tdata.phiStart,\r\n\t\t\t\t\t\t\tdata.phiLength,\r\n\t\t\t\t\t\t\tdata.thetaStart,\r\n\t\t\t\t\t\t\tdata.thetaLength\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'SphereBufferGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE.SphereBufferGeometry(\r\n\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\tdata.widthSegments,\r\n\t\t\t\t\t\t\tdata.heightSegments,\r\n\t\t\t\t\t\t\tdata.phiStart,\r\n\t\t\t\t\t\t\tdata.phiLength,\r\n\t\t\t\t\t\t\tdata.thetaStart,\r\n\t\t\t\t\t\t\tdata.thetaLength\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'DodecahedronGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE.DodecahedronGeometry(\r\n\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\tdata.detail\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'IcosahedronGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE.IcosahedronGeometry(\r\n\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\tdata.detail\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'OctahedronGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE.OctahedronGeometry(\r\n\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\tdata.detail\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'TetrahedronGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE.TetrahedronGeometry(\r\n\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\tdata.detail\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'RingGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE.RingGeometry(\r\n\t\t\t\t\t\t\tdata.innerRadius,\r\n\t\t\t\t\t\t\tdata.outerRadius,\r\n\t\t\t\t\t\t\tdata.thetaSegments,\r\n\t\t\t\t\t\t\tdata.phiSegments,\r\n\t\t\t\t\t\t\tdata.thetaStart,\r\n\t\t\t\t\t\t\tdata.thetaLength\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'TorusGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE.TorusGeometry(\r\n\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\tdata.tube,\r\n\t\t\t\t\t\t\tdata.radialSegments,\r\n\t\t\t\t\t\t\tdata.tubularSegments,\r\n\t\t\t\t\t\t\tdata.arc\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'TorusKnotGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE.TorusKnotGeometry(\r\n\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\tdata.tube,\r\n\t\t\t\t\t\t\tdata.radialSegments,\r\n\t\t\t\t\t\t\tdata.tubularSegments,\r\n\t\t\t\t\t\t\tdata.p,\r\n\t\t\t\t\t\t\tdata.q,\r\n\t\t\t\t\t\t\tdata.heightScale\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'BufferGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = bufferGeometryLoader.parse( data );\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'Geometry':\r\n\r\n\t\t\t\t\t\tgeometry = geometryLoader.parse( data.data, this.texturePath ).geometry;\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault:\r\n\r\n\t\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Unsupported geometry type \"' + data.type + '\"' );\r\n\r\n\t\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgeometry.uuid = data.uuid;\r\n\r\n\t\t\t\tif ( data.name !== undefined ) geometry.name = data.name;\r\n\r\n\t\t\t\tgeometries[ data.uuid ] = geometry;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn geometries;\r\n\r\n\t},\r\n\r\n\tparseMaterials: function ( json, textures ) {\r\n\r\n\t\tvar materials = {};\r\n\r\n\t\tif ( json !== undefined ) {\r\n\r\n\t\t\tvar loader = new THREE.MaterialLoader();\r\n\t\t\tloader.setTextures( textures );\r\n\r\n\t\t\tfor ( var i = 0, l = json.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar material = loader.parse( json[ i ] );\r\n\t\t\t\tmaterials[ material.uuid ] = material;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn materials;\r\n\r\n\t},\r\n\r\n\tparseAnimations: function ( json ) {\r\n\r\n\t\tvar animations = [];\r\n\r\n\t\tfor ( var i = 0; i < json.length; i ++ ) {\r\n\r\n\t\t\tvar clip = THREE.AnimationClip.parse( json[i] );\r\n\r\n\t\t\tanimations.push( clip );\r\n\r\n\t\t}\r\n\r\n\t\treturn animations;\r\n\r\n\t},\r\n\r\n\tparseImages: function ( json, onLoad ) {\r\n\r\n\t\tvar scope = this;\r\n\t\tvar images = {};\r\n\r\n\t\tfunction loadImage( url ) {\r\n\r\n\t\t\tscope.manager.itemStart( url );\r\n\r\n\t\t\treturn loader.load( url, function () {\r\n\r\n\t\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t\t} );\r\n\r\n\t\t}\r\n\r\n\t\tif ( json !== undefined && json.length > 0 ) {\r\n\r\n\t\t\tvar manager = new THREE.LoadingManager( onLoad );\r\n\r\n\t\t\tvar loader = new THREE.ImageLoader( manager );\r\n\t\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\r\n\t\t\tfor ( var i = 0, l = json.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar image = json[ i ];\r\n\t\t\t\tvar path = /^(\\/\\/)|([a-z]+:(\\/\\/)?)/i.test( image.url ) ? image.url : scope.texturePath + image.url;\r\n\r\n\t\t\t\timages[ image.uuid ] = loadImage( path );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn images;\r\n\r\n\t},\r\n\r\n\tparseTextures: function ( json, images ) {\r\n\r\n\t\tfunction parseConstant( value ) {\r\n\r\n\t\t\tif ( typeof( value ) === 'number' ) return value;\r\n\r\n\t\t\tconsole.warn( 'THREE.ObjectLoader.parseTexture: Constant should be in numeric form.', value );\r\n\r\n\t\t\treturn THREE[ value ];\r\n\r\n\t\t}\r\n\r\n\t\tvar textures = {};\r\n\r\n\t\tif ( json !== undefined ) {\r\n\r\n\t\t\tfor ( var i = 0, l = json.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar data = json[ i ];\r\n\r\n\t\t\t\tif ( data.image === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: No \"image\" specified for', data.uuid );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( images[ data.image ] === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined image', data.image );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar texture = new THREE.Texture( images[ data.image ] );\r\n\t\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t\t\ttexture.uuid = data.uuid;\r\n\r\n\t\t\t\tif ( data.name !== undefined ) texture.name = data.name;\r\n\t\t\t\tif ( data.mapping !== undefined ) texture.mapping = parseConstant( data.mapping );\r\n\t\t\t\tif ( data.offset !== undefined ) texture.offset = new THREE.Vector2( data.offset[ 0 ], data.offset[ 1 ] );\r\n\t\t\t\tif ( data.repeat !== undefined ) texture.repeat = new THREE.Vector2( data.repeat[ 0 ], data.repeat[ 1 ] );\r\n\t\t\t\tif ( data.minFilter !== undefined ) texture.minFilter = parseConstant( data.minFilter );\r\n\t\t\t\tif ( data.magFilter !== undefined ) texture.magFilter = parseConstant( data.magFilter );\r\n\t\t\t\tif ( data.anisotropy !== undefined ) texture.anisotropy = data.anisotropy;\r\n\t\t\t\tif ( Array.isArray( data.wrap ) ) {\r\n\r\n\t\t\t\t\ttexture.wrapS = parseConstant( data.wrap[ 0 ] );\r\n\t\t\t\t\ttexture.wrapT = parseConstant( data.wrap[ 1 ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttextures[ data.uuid ] = texture;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn textures;\r\n\r\n\t},\r\n\r\n\tparseObject: function () {\r\n\r\n\t\tvar matrix = new THREE.Matrix4();\r\n\r\n\t\treturn function ( data, geometries, materials ) {\r\n\r\n\t\t\tvar object;\r\n\r\n\t\t\tfunction getGeometry( name ) {\r\n\r\n\t\t\t\tif ( geometries[ name ] === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined geometry', name );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn geometries[ name ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction getMaterial( name ) {\r\n\r\n\t\t\t\tif ( name === undefined ) return undefined;\r\n\r\n\t\t\t\tif ( materials[ name ] === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined material', name );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn materials[ name ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tswitch ( data.type ) {\r\n\r\n\t\t\t\tcase 'Scene':\r\n\r\n\t\t\t\t\tobject = new THREE.Scene();\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'PerspectiveCamera':\r\n\r\n\t\t\t\t\tobject = new THREE.PerspectiveCamera( data.fov, data.aspect, data.near, data.far );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'OrthographicCamera':\r\n\r\n\t\t\t\t\tobject = new THREE.OrthographicCamera( data.left, data.right, data.top, data.bottom, data.near, data.far );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'AmbientLight':\r\n\r\n\t\t\t\t\tobject = new THREE.AmbientLight( data.color );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'DirectionalLight':\r\n\r\n\t\t\t\t\tobject = new THREE.DirectionalLight( data.color, data.intensity );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'PointLight':\r\n\r\n\t\t\t\t\tobject = new THREE.PointLight( data.color, data.intensity, data.distance, data.decay );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'SpotLight':\r\n\r\n\t\t\t\t\tobject = new THREE.SpotLight( data.color, data.intensity, data.distance, data.angle, data.exponent, data.decay );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'HemisphereLight':\r\n\r\n\t\t\t\t\tobject = new THREE.HemisphereLight( data.color, data.groundColor, data.intensity );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'Mesh':\r\n\r\n\t\t\t\t\tobject = new THREE.Mesh( getGeometry( data.geometry ), getMaterial( data.material ) );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'LOD':\r\n\r\n\t\t\t\t\tobject = new THREE.LOD();\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'Line':\r\n\r\n\t\t\t\t\tobject = new THREE.Line( getGeometry( data.geometry ), getMaterial( data.material ), data.mode );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'PointCloud':\r\n\t\t\t\tcase 'Points':\r\n\r\n\t\t\t\t\tobject = new THREE.Points( getGeometry( data.geometry ), getMaterial( data.material ) );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'Sprite':\r\n\r\n\t\t\t\t\tobject = new THREE.Sprite( getMaterial( data.material ) );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'Group':\r\n\r\n\t\t\t\t\tobject = new THREE.Group();\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\r\n\t\t\t\t\tobject = new THREE.Object3D();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tobject.uuid = data.uuid;\r\n\r\n\t\t\tif ( data.name !== undefined ) object.name = data.name;\r\n\t\t\tif ( data.matrix !== undefined ) {\r\n\r\n\t\t\t\tmatrix.fromArray( data.matrix );\r\n\t\t\t\tmatrix.decompose( object.position, object.quaternion, object.scale );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif ( data.position !== undefined ) object.position.fromArray( data.position );\r\n\t\t\t\tif ( data.rotation !== undefined ) object.rotation.fromArray( data.rotation );\r\n\t\t\t\tif ( data.scale !== undefined ) object.scale.fromArray( data.scale );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( data.castShadow !== undefined ) object.castShadow = data.castShadow;\r\n\t\t\tif ( data.receiveShadow !== undefined ) object.receiveShadow = data.receiveShadow;\r\n\r\n\t\t\tif ( data.visible !== undefined ) object.visible = data.visible;\r\n\t\t\tif ( data.userData !== undefined ) object.userData = data.userData;\r\n\r\n\t\t\tif ( data.children !== undefined ) {\r\n\r\n\t\t\t\tfor ( var child in data.children ) {\r\n\r\n\t\t\t\t\tobject.add( this.parseObject( data.children[ child ], geometries, materials ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( data.type === 'LOD' ) {\r\n\r\n\t\t\t\tvar levels = data.levels;\r\n\r\n\t\t\t\tfor ( var l = 0; l < levels.length; l ++ ) {\r\n\r\n\t\t\t\t\tvar level = levels[ l ];\r\n\t\t\t\t\tvar child = object.getObjectByProperty( 'uuid', level.object );\r\n\r\n\t\t\t\t\tif ( child !== undefined ) {\r\n\r\n\t\t\t\t\t\tobject.addLevel( child, level.distance );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn object;\r\n\r\n\t\t}\r\n\r\n\t}()\r\n\r\n};\r\n\r\n// File:src/loaders/TextureLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.TextureLoader = function ( manager ) {\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\r\n};\r\n\r\nTHREE.TextureLoader.prototype = {\r\n\r\n\tconstructor: THREE.TextureLoader,\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tvar texture = new THREE.Texture();\r\n\r\n\t\tvar loader = new THREE.ImageLoader( this.manager );\r\n\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\t\tloader.load( url, function ( image ) {\r\n\r\n\t\t\ttexture.image = image;\r\n\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t\tif ( onLoad !== undefined ) {\r\n\r\n\t\t\t\tonLoad( texture );\r\n\r\n\t\t\t}\r\n\r\n\t\t}, onProgress, onError );\r\n\r\n\t\treturn texture;\r\n\r\n\t},\r\n\r\n\tsetCrossOrigin: function ( value ) {\r\n\r\n\t\tthis.crossOrigin = value;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/CubeTextureLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.CubeTextureLoader = function ( manager ) {\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\r\n};\r\n\r\nTHREE.CubeTextureLoader.prototype = {\r\n\r\n\tconstructor: THREE.CubeTextureLoader,\r\n\r\n\tload: function ( urls, onLoad, onProgress, onError ) {\r\n\r\n\t\tvar texture = new THREE.CubeTexture( [] );\r\n\r\n\t\tvar loader = new THREE.ImageLoader();\r\n\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\r\n\t\tvar loaded = 0;\r\n\r\n\t\tfunction loadTexture( i ) {\r\n\r\n\t\t\tloader.load( urls[ i ], function ( image ) {\r\n\r\n\t\t\t\ttexture.images[ i ] = image;\r\n\r\n\t\t\t\tloaded ++;\r\n\r\n\t\t\t\tif ( loaded === 6 ) {\r\n\r\n\t\t\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t\t\t\tif ( onLoad ) onLoad( texture );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}, undefined, onError );\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0; i < urls.length; ++ i ) {\r\n\r\n\t\t\tloadTexture( i );\r\n\r\n\t\t}\r\n\r\n\t\treturn texture;\r\n\r\n\t},\r\n\r\n\tsetCrossOrigin: function ( value ) {\r\n\r\n\t\tthis.crossOrigin = value;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/BinaryTextureLoader.js\r\n\r\n/**\r\n * @author Nikos M. / https://github.com/foo123/\r\n *\r\n * Abstract Base class to load generic binary textures formats (rgbe, hdr, ...)\r\n */\r\n\r\nTHREE.DataTextureLoader = THREE.BinaryTextureLoader = function ( manager ) {\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\r\n\t// override in sub classes\r\n\tthis._parser = null;\r\n\r\n};\r\n\r\nTHREE.BinaryTextureLoader.prototype = {\r\n\r\n\tconstructor: THREE.BinaryTextureLoader,\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar texture = new THREE.DataTexture();\r\n\r\n\t\tvar loader = new THREE.XHRLoader( this.manager );\r\n\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\t\tloader.setResponseType( 'arraybuffer' );\r\n\r\n\t\tloader.load( url, function ( buffer ) {\r\n\r\n\t\t\tvar texData = scope._parser( buffer );\r\n\r\n\t\t\tif ( ! texData ) return;\r\n\r\n\t\t\tif ( undefined !== texData.image ) {\r\n\r\n\t\t\t\ttexture.image = texData.image;\r\n\r\n\t\t\t} else if ( undefined !== texData.data ) {\r\n\r\n\t\t\t\ttexture.image.width = texData.width;\r\n\t\t\t\ttexture.image.height = texData.height;\r\n\t\t\t\ttexture.image.data = texData.data;\r\n\r\n\t\t\t}\r\n\r\n\t\t\ttexture.wrapS = undefined !== texData.wrapS ? texData.wrapS : THREE.ClampToEdgeWrapping;\r\n\t\t\ttexture.wrapT = undefined !== texData.wrapT ? texData.wrapT : THREE.ClampToEdgeWrapping;\r\n\r\n\t\t\ttexture.magFilter = undefined !== texData.magFilter ? texData.magFilter : THREE.LinearFilter;\r\n\t\t\ttexture.minFilter = undefined !== texData.minFilter ? texData.minFilter : THREE.LinearMipMapLinearFilter;\r\n\r\n\t\t\ttexture.anisotropy = undefined !== texData.anisotropy ? texData.anisotropy : 1;\r\n\r\n\t\t\tif ( undefined !== texData.format ) {\r\n\r\n\t\t\t\ttexture.format = texData.format;\r\n\r\n\t\t\t}\r\n\t\t\tif ( undefined !== texData.type ) {\r\n\r\n\t\t\t\ttexture.type = texData.type;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( undefined !== texData.mipmaps ) {\r\n\r\n\t\t\t\ttexture.mipmaps = texData.mipmaps;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( 1 === texData.mipmapCount ) {\r\n\r\n\t\t\t\ttexture.minFilter = THREE.LinearFilter;\r\n\r\n\t\t\t}\r\n\r\n\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t\tif ( onLoad ) onLoad( texture, texData );\r\n\r\n\t\t}, onProgress, onError );\r\n\r\n\r\n\t\treturn texture;\r\n\r\n\t},\r\n\r\n\tsetCrossOrigin: function ( value ) {\r\n\r\n\t\tthis.crossOrigin = value;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/CompressedTextureLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n *\r\n * Abstract Base class to block based textures loader (dds, pvr, ...)\r\n */\r\n\r\nTHREE.CompressedTextureLoader = function ( manager ) {\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\r\n\t// override in sub classes\r\n\tthis._parser = null;\r\n\r\n};\r\n\r\n\r\nTHREE.CompressedTextureLoader.prototype = {\r\n\r\n\tconstructor: THREE.CompressedTextureLoader,\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar images = [];\r\n\r\n\t\tvar texture = new THREE.CompressedTexture();\r\n\t\ttexture.image = images;\r\n\r\n\t\tvar loader = new THREE.XHRLoader( this.manager );\r\n\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\t\tloader.setResponseType( 'arraybuffer' );\r\n\r\n\t\tif ( Array.isArray( url ) ) {\r\n\r\n\t\t\tvar loaded = 0;\r\n\r\n\t\t\tvar loadTexture = function ( i ) {\r\n\r\n\t\t\t\tloader.load( url[ i ], function ( buffer ) {\r\n\r\n\t\t\t\t\tvar texDatas = scope._parser( buffer, true );\r\n\r\n\t\t\t\t\timages[ i ] = {\r\n\t\t\t\t\t\twidth: texDatas.width,\r\n\t\t\t\t\t\theight: texDatas.height,\r\n\t\t\t\t\t\tformat: texDatas.format,\r\n\t\t\t\t\t\tmipmaps: texDatas.mipmaps\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tloaded += 1;\r\n\r\n\t\t\t\t\tif ( loaded === 6 ) {\r\n\r\n\t\t\t\t\t\tif ( texDatas.mipmapCount === 1 )\r\n \t\t\t\t\t\t\ttexture.minFilter = THREE.LinearFilter;\r\n\r\n\t\t\t\t\t\ttexture.format = texDatas.format;\r\n\t\t\t\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t\t\t\t\tif ( onLoad ) onLoad( texture );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}, onProgress, onError );\r\n\r\n\t\t\t};\r\n\r\n\t\t\tfor ( var i = 0, il = url.length; i < il; ++ i ) {\r\n\r\n\t\t\t\tloadTexture( i );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// compressed cubemap texture stored in a single DDS file\r\n\r\n\t\t\tloader.load( url, function ( buffer ) {\r\n\r\n\t\t\t\tvar texDatas = scope._parser( buffer, true );\r\n\r\n\t\t\t\tif ( texDatas.isCubemap ) {\r\n\r\n\t\t\t\t\tvar faces = texDatas.mipmaps.length / texDatas.mipmapCount;\r\n\r\n\t\t\t\t\tfor ( var f = 0; f < faces; f ++ ) {\r\n\r\n\t\t\t\t\t\timages[ f ] = { mipmaps : [] };\r\n\r\n\t\t\t\t\t\tfor ( var i = 0; i < texDatas.mipmapCount; i ++ ) {\r\n\r\n\t\t\t\t\t\t\timages[ f ].mipmaps.push( texDatas.mipmaps[ f * texDatas.mipmapCount + i ] );\r\n\t\t\t\t\t\t\timages[ f ].format = texDatas.format;\r\n\t\t\t\t\t\t\timages[ f ].width = texDatas.width;\r\n\t\t\t\t\t\t\timages[ f ].height = texDatas.height;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\ttexture.image.width = texDatas.width;\r\n\t\t\t\t\ttexture.image.height = texDatas.height;\r\n\t\t\t\t\ttexture.mipmaps = texDatas.mipmaps;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( texDatas.mipmapCount === 1 ) {\r\n\r\n\t\t\t\t\ttexture.minFilter = THREE.LinearFilter;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttexture.format = texDatas.format;\r\n\t\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t\t\tif ( onLoad ) onLoad( texture );\r\n\r\n\t\t\t}, onProgress, onError );\r\n\r\n\t\t}\r\n\r\n\t\treturn texture;\r\n\r\n\t},\r\n\r\n\tsetCrossOrigin: function ( value ) {\r\n\r\n\t\tthis.crossOrigin = value;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/materials/Material.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Material = function () {\r\n\r\n\tObject.defineProperty( this, 'id', { value: THREE.MaterialIdCount ++ } );\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\tthis.name = '';\r\n\tthis.type = 'Material';\r\n\r\n\tthis.side = THREE.FrontSide;\r\n\r\n\tthis.opacity = 1;\r\n\tthis.transparent = false;\r\n\r\n\tthis.blending = THREE.NormalBlending;\r\n\r\n\tthis.blendSrc = THREE.SrcAlphaFactor;\r\n\tthis.blendDst = THREE.OneMinusSrcAlphaFactor;\r\n\tthis.blendEquation = THREE.AddEquation;\r\n\tthis.blendSrcAlpha = null;\r\n\tthis.blendDstAlpha = null;\r\n\tthis.blendEquationAlpha = null;\r\n\r\n\tthis.depthFunc = THREE.LessEqualDepth;\r\n\tthis.depthTest = true;\r\n\tthis.depthWrite = true;\r\n\r\n\tthis.colorWrite = true;\r\n\r\n\tthis.precision = null; // override the renderer's default precision for this material\r\n\r\n\tthis.polygonOffset = false;\r\n\tthis.polygonOffsetFactor = 0;\r\n\tthis.polygonOffsetUnits = 0;\r\n\r\n\tthis.alphaTest = 0;\r\n\r\n\tthis.overdraw = 0; // Overdrawn pixels (typically between 0 and 1) for fixing antialiasing gaps in CanvasRenderer\r\n\r\n\tthis.visible = true;\r\n\r\n\tthis._needsUpdate = true;\r\n\r\n};\r\n\r\nTHREE.Material.prototype = {\r\n\r\n\tconstructor: THREE.Material,\r\n\r\n\tget needsUpdate () {\r\n\r\n\t\treturn this._needsUpdate;\r\n\r\n\t},\r\n\r\n\tset needsUpdate ( value ) {\r\n\r\n\t\tif ( value === true ) this.update();\r\n\r\n\t\tthis._needsUpdate = value;\r\n\r\n\t},\r\n\r\n\tsetValues: function ( values ) {\r\n\r\n\t\tif ( values === undefined ) return;\r\n\r\n\t\tfor ( var key in values ) {\r\n\r\n\t\t\tvar newValue = values[ key ];\r\n\r\n\t\t\tif ( newValue === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( \"THREE.Material: '\" + key + \"' parameter is undefined.\" );\r\n\t\t\t\tcontinue;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar currentValue = this[ key ];\r\n\r\n\t\t\tif ( currentValue === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( \"THREE.\" + this.type + \": '\" + key + \"' is not a property of this material.\" );\r\n\t\t\t\tcontinue;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( currentValue instanceof THREE.Color ) {\r\n\r\n\t\t\t\tcurrentValue.set( newValue );\r\n\r\n\t\t\t} else if ( currentValue instanceof THREE.Vector3 && newValue instanceof THREE.Vector3 ) {\r\n\r\n\t\t\t\tcurrentValue.copy( newValue );\r\n\r\n\t\t\t} else if ( key === 'overdraw' ) {\r\n\r\n\t\t\t\t// ensure overdraw is backwards-compatible with legacy boolean type\r\n\t\t\t\tthis[ key ] = Number( newValue );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis[ key ] = newValue;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\ttoJSON: function ( meta ) {\r\n\r\n\t\tvar data = {\r\n\t\t\tmetadata: {\r\n\t\t\t\tversion: 4.4,\r\n\t\t\t\ttype: 'Material',\r\n\t\t\t\tgenerator: 'Material.toJSON'\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t// standard Material serialization\r\n\t\tdata.uuid = this.uuid;\r\n\t\tdata.type = this.type;\r\n\t\tif ( this.name !== '' ) data.name = this.name;\r\n\r\n\t\tif ( this.color instanceof THREE.Color ) data.color = this.color.getHex();\r\n\t\tif ( this.emissive instanceof THREE.Color ) data.emissive = this.emissive.getHex();\r\n\t\tif ( this.specular instanceof THREE.Color ) data.specular = this.specular.getHex();\r\n\t\tif ( this.shininess !== undefined ) data.shininess = this.shininess;\r\n\r\n\t\tif ( this.map instanceof THREE.Texture ) data.map = this.map.toJSON( meta ).uuid;\r\n\t\tif ( this.alphaMap instanceof THREE.Texture ) data.alphaMap = this.alphaMap.toJSON( meta ).uuid;\r\n\t\tif ( this.lightMap instanceof THREE.Texture ) data.lightMap = this.lightMap.toJSON( meta ).uuid;\r\n\t\tif ( this.bumpMap instanceof THREE.Texture ) {\r\n\r\n\t\t\tdata.bumpMap = this.bumpMap.toJSON( meta ).uuid;\r\n\t\t\tdata.bumpScale = this.bumpScale;\r\n\r\n\t\t}\r\n\t\tif ( this.normalMap instanceof THREE.Texture ) {\r\n\r\n\t\t\tdata.normalMap = this.normalMap.toJSON( meta ).uuid;\r\n\t\t\tdata.normalScale = this.normalScale; // Removed for now, causes issue in editor ui.js\r\n\r\n\t\t}\r\n\t\tif ( this.displacementMap instanceof THREE.Texture ) {\r\n\r\n\t\t\tdata.displacementMap = this.displacementMap.toJSON( meta ).uuid;\r\n\t\t\tdata.displacementScale = this.displacementScale;\r\n\t\t\tdata.displacementBias = this.displacementBias;\r\n\r\n\t\t}\r\n\t\tif ( this.specularMap instanceof THREE.Texture ) data.specularMap = this.specularMap.toJSON( meta ).uuid;\r\n\t\tif ( this.envMap instanceof THREE.Texture ) {\r\n\r\n\t\t\tdata.envMap = this.envMap.toJSON( meta ).uuid;\r\n\t\t\tdata.reflectivity = this.reflectivity; // Scale behind envMap\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.size !== undefined ) data.size = this.size;\r\n\t\tif ( this.sizeAttenuation !== undefined ) data.sizeAttenuation = this.sizeAttenuation;\r\n\r\n\t\tif ( this.vertexColors !== undefined && this.vertexColors !== THREE.NoColors ) data.vertexColors = this.vertexColors;\r\n\t\tif ( this.shading !== undefined && this.shading !== THREE.SmoothShading ) data.shading = this.shading;\r\n\t\tif ( this.blending !== undefined && this.blending !== THREE.NormalBlending ) data.blending = this.blending;\r\n\t\tif ( this.side !== undefined && this.side !== THREE.FrontSide ) data.side = this.side;\r\n\r\n\t\tif ( this.opacity < 1 ) data.opacity = this.opacity;\r\n\t\tif ( this.transparent === true ) data.transparent = this.transparent;\r\n\t\tif ( this.alphaTest > 0 ) data.alphaTest = this.alphaTest;\r\n\t\tif ( this.wireframe === true ) data.wireframe = this.wireframe;\r\n\t\tif ( this.wireframeLinewidth > 1 ) data.wireframeLinewidth = this.wireframeLinewidth;\r\n\r\n\t\treturn data;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( source ) {\r\n\r\n\t\tthis.name = source.name;\r\n\r\n\t\tthis.side = source.side;\r\n\r\n\t\tthis.opacity = source.opacity;\r\n\t\tthis.transparent = source.transparent;\r\n\r\n\t\tthis.blending = source.blending;\r\n\r\n\t\tthis.blendSrc = source.blendSrc;\r\n\t\tthis.blendDst = source.blendDst;\r\n\t\tthis.blendEquation = source.blendEquation;\r\n\t\tthis.blendSrcAlpha = source.blendSrcAlpha;\r\n\t\tthis.blendDstAlpha = source.blendDstAlpha;\r\n\t\tthis.blendEquationAlpha = source.blendEquationAlpha;\r\n\r\n\t\tthis.depthFunc = source.depthFunc;\r\n\t\tthis.depthTest = source.depthTest;\r\n\t\tthis.depthWrite = source.depthWrite;\r\n\r\n\t\tthis.precision = source.precision;\r\n\r\n\t\tthis.polygonOffset = source.polygonOffset;\r\n\t\tthis.polygonOffsetFactor = source.polygonOffsetFactor;\r\n\t\tthis.polygonOffsetUnits = source.polygonOffsetUnits;\r\n\r\n\t\tthis.alphaTest = source.alphaTest;\r\n\r\n\t\tthis.overdraw = source.overdraw;\r\n\r\n\t\tthis.visible = source.visible;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tupdate: function () {\r\n\r\n\t\tthis.dispatchEvent( { type: 'update' } );\r\n\r\n\t},\r\n\r\n\tdispose: function () {\r\n\r\n\t\tthis.dispatchEvent( { type: 'dispose' } );\r\n\r\n\t},\r\n\r\n\t// Deprecated\r\n\r\n\tget wrapAround () {\r\n\r\n\t\tconsole.warn( 'THREE.' + this.type + ': .wrapAround has been removed.' );\r\n\r\n\t},\r\n\r\n\tset wrapAround ( boolean ) {\r\n\r\n\t\tconsole.warn( 'THREE.' + this.type + ': .wrapAround has been removed.' );\r\n\r\n\t},\r\n\r\n\tget wrapRGB () {\r\n\r\n\t\tconsole.warn( 'THREE.' + this.type + ': .wrapRGB has been removed.' );\r\n\t\treturn new THREE.Color();\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply( THREE.Material.prototype );\r\n\r\nTHREE.MaterialIdCount = 0;\r\n\r\n// File:src/materials/LineBasicMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  opacity: <float>,\r\n *\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  linewidth: <float>,\r\n *  linecap: \"round\",\r\n *  linejoin: \"round\",\r\n *\r\n *  vertexColors: <bool>\r\n *\r\n *  fog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.LineBasicMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this );\r\n\r\n\tthis.type = 'LineBasicMaterial';\r\n\r\n\tthis.color = new THREE.Color( 0xffffff );\r\n\r\n\tthis.linewidth = 1;\r\n\tthis.linecap = 'round';\r\n\tthis.linejoin = 'round';\r\n\r\n\tthis.vertexColors = THREE.NoColors;\r\n\r\n\tthis.fog = true;\r\n\r\n\tthis.setValues( parameters );\r\n\r\n};\r\n\r\nTHREE.LineBasicMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.LineBasicMaterial.prototype.constructor = THREE.LineBasicMaterial;\r\n\r\nTHREE.LineBasicMaterial.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Material.prototype.copy.call( this, source );\r\n\r\n\tthis.color.copy( source.color );\r\n\r\n\tthis.linewidth = source.linewidth;\r\n\tthis.linecap = source.linecap;\r\n\tthis.linejoin = source.linejoin;\r\n\r\n\tthis.vertexColors = source.vertexColors;\r\n\r\n\tthis.fog = source.fog;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/materials/LineDashedMaterial.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  opacity: <float>,\r\n *\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  linewidth: <float>,\r\n *\r\n *  scale: <float>,\r\n *  dashSize: <float>,\r\n *  gapSize: <float>,\r\n *\r\n *  vertexColors: <bool>\r\n *\r\n *  fog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.LineDashedMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this );\r\n\r\n\tthis.type = 'LineDashedMaterial';\r\n\r\n\tthis.color = new THREE.Color( 0xffffff );\r\n\r\n\tthis.linewidth = 1;\r\n\r\n\tthis.scale = 1;\r\n\tthis.dashSize = 3;\r\n\tthis.gapSize = 1;\r\n\r\n\tthis.vertexColors = false;\r\n\r\n\tthis.fog = true;\r\n\r\n\tthis.setValues( parameters );\r\n\r\n};\r\n\r\nTHREE.LineDashedMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.LineDashedMaterial.prototype.constructor = THREE.LineDashedMaterial;\r\n\r\nTHREE.LineDashedMaterial.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Material.prototype.copy.call( this, source );\r\n\r\n\tthis.color.copy( source.color );\r\n\t\r\n\tthis.linewidth = source.linewidth;\r\n\r\n\tthis.scale = source.scale;\r\n\tthis.dashSize = source.dashSize;\r\n\tthis.gapSize = source.gapSize;\r\n\r\n\tthis.vertexColors = source.vertexColors;\r\n\r\n\tthis.fog = source.fog;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/materials/MeshBasicMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  opacity: <float>,\r\n *  map: new THREE.Texture( <Image> ),\r\n *\r\n *  aoMap: new THREE.Texture( <Image> ),\r\n *  aoMapIntensity: <float>\r\n *\r\n *  specularMap: new THREE.Texture( <Image> ),\r\n *\r\n *  alphaMap: new THREE.Texture( <Image> ),\r\n *\r\n *  envMap: new THREE.TextureCube( [posx, negx, posy, negy, posz, negz] ),\r\n *  combine: THREE.Multiply,\r\n *  reflectivity: <float>,\r\n *  refractionRatio: <float>,\r\n *\r\n *  shading: THREE.SmoothShading,\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>,\r\n *\r\n *  vertexColors: THREE.NoColors / THREE.VertexColors / THREE.FaceColors,\r\n *\r\n *  skinning: <bool>,\r\n *  morphTargets: <bool>,\r\n *\r\n *  fog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.MeshBasicMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this );\r\n\r\n\tthis.type = 'MeshBasicMaterial';\r\n\r\n\tthis.color = new THREE.Color( 0xffffff ); // emissive\r\n\r\n\tthis.map = null;\r\n\r\n\tthis.aoMap = null;\r\n\tthis.aoMapIntensity = 1.0;\r\n\r\n\tthis.specularMap = null;\r\n\r\n\tthis.alphaMap = null;\r\n\r\n\tthis.envMap = null;\r\n\tthis.combine = THREE.MultiplyOperation;\r\n\tthis.reflectivity = 1;\r\n\tthis.refractionRatio = 0.98;\r\n\r\n\tthis.fog = true;\r\n\r\n\tthis.shading = THREE.SmoothShading;\r\n\r\n\tthis.wireframe = false;\r\n\tthis.wireframeLinewidth = 1;\r\n\tthis.wireframeLinecap = 'round';\r\n\tthis.wireframeLinejoin = 'round';\r\n\r\n\tthis.vertexColors = THREE.NoColors;\r\n\r\n\tthis.skinning = false;\r\n\tthis.morphTargets = false;\r\n\r\n\tthis.setValues( parameters );\r\n\r\n};\r\n\r\nTHREE.MeshBasicMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.MeshBasicMaterial.prototype.constructor = THREE.MeshBasicMaterial;\r\n\r\nTHREE.MeshBasicMaterial.prototype.copy = function ( source ) {\r\n\t\r\n\tTHREE.Material.prototype.copy.call( this, source );\r\n\r\n\tthis.color.copy( source.color );\r\n\r\n\tthis.map = source.map;\r\n\r\n\tthis.aoMap = source.aoMap;\r\n\tthis.aoMapIntensity = source.aoMapIntensity;\r\n\r\n\tthis.specularMap = source.specularMap;\r\n\r\n\tthis.alphaMap = source.alphaMap;\r\n\r\n\tthis.envMap = source.envMap;\r\n\tthis.combine = source.combine;\r\n\tthis.reflectivity = source.reflectivity;\r\n\tthis.refractionRatio = source.refractionRatio;\r\n\r\n\tthis.fog = source.fog;\r\n\r\n\tthis.shading = source.shading;\r\n\r\n\tthis.wireframe = source.wireframe;\r\n\tthis.wireframeLinewidth = source.wireframeLinewidth;\r\n\tthis.wireframeLinecap = source.wireframeLinecap;\r\n\tthis.wireframeLinejoin = source.wireframeLinejoin;\r\n\r\n\tthis.vertexColors = source.vertexColors;\r\n\r\n\tthis.skinning = source.skinning;\r\n\tthis.morphTargets = source.morphTargets;\r\n\t\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/materials/MeshLambertMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  emissive: <hex>,\r\n *  opacity: <float>,\r\n *\r\n *  map: new THREE.Texture( <Image> ),\r\n *\r\n *  specularMap: new THREE.Texture( <Image> ),\r\n *\r\n *  alphaMap: new THREE.Texture( <Image> ),\r\n *\r\n *  envMap: new THREE.TextureCube( [posx, negx, posy, negy, posz, negz] ),\r\n *  combine: THREE.Multiply,\r\n *  reflectivity: <float>,\r\n *  refractionRatio: <float>,\r\n *\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>,\r\n *\r\n *  vertexColors: THREE.NoColors / THREE.VertexColors / THREE.FaceColors,\r\n *\r\n *  skinning: <bool>,\r\n *  morphTargets: <bool>,\r\n *  morphNormals: <bool>,\r\n *\r\n *\tfog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.MeshLambertMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this );\r\n\r\n\tthis.type = 'MeshLambertMaterial';\r\n\r\n\tthis.color = new THREE.Color( 0xffffff ); // diffuse\r\n\tthis.emissive = new THREE.Color( 0x000000 );\r\n\r\n\tthis.map = null;\r\n\r\n\tthis.specularMap = null;\r\n\r\n\tthis.alphaMap = null;\r\n\r\n\tthis.envMap = null;\r\n\tthis.combine = THREE.MultiplyOperation;\r\n\tthis.reflectivity = 1;\r\n\tthis.refractionRatio = 0.98;\r\n\r\n\tthis.fog = true;\r\n\r\n\tthis.wireframe = false;\r\n\tthis.wireframeLinewidth = 1;\r\n\tthis.wireframeLinecap = 'round';\r\n\tthis.wireframeLinejoin = 'round';\r\n\r\n\tthis.vertexColors = THREE.NoColors;\r\n\r\n\tthis.skinning = false;\r\n\tthis.morphTargets = false;\r\n\tthis.morphNormals = false;\r\n\r\n\tthis.setValues( parameters );\r\n\r\n};\r\n\r\nTHREE.MeshLambertMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.MeshLambertMaterial.prototype.constructor = THREE.MeshLambertMaterial;\r\n\r\nTHREE.MeshLambertMaterial.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Material.prototype.copy.call( this, source );\r\n\r\n\tthis.color.copy( source.color );\r\n\tthis.emissive.copy( source.emissive );\r\n\r\n\tthis.map = source.map;\r\n\r\n\tthis.specularMap = source.specularMap;\r\n\r\n\tthis.alphaMap = source.alphaMap;\r\n\r\n\tthis.envMap = source.envMap;\r\n\tthis.combine = source.combine;\r\n\tthis.reflectivity = source.reflectivity;\r\n\tthis.refractionRatio = source.refractionRatio;\r\n\r\n\tthis.fog = source.fog;\r\n\r\n\tthis.wireframe = source.wireframe;\r\n\tthis.wireframeLinewidth = source.wireframeLinewidth;\r\n\tthis.wireframeLinecap = source.wireframeLinecap;\r\n\tthis.wireframeLinejoin = source.wireframeLinejoin;\r\n\r\n\tthis.vertexColors = source.vertexColors;\r\n\r\n\tthis.skinning = source.skinning;\r\n\tthis.morphTargets = source.morphTargets;\r\n\tthis.morphNormals = source.morphNormals;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/materials/MeshPhongMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  emissive: <hex>,\r\n *  specular: <hex>,\r\n *  shininess: <float>,\r\n *  opacity: <float>,\r\n *\r\n *  map: new THREE.Texture( <Image> ),\r\n *\r\n *  lightMap: new THREE.Texture( <Image> ),\r\n *  lightMapIntensity: <float>\r\n *\r\n *  aoMap: new THREE.Texture( <Image> ),\r\n *  aoMapIntensity: <float>\r\n *\r\n *  emissiveMap: new THREE.Texture( <Image> ),\r\n *\r\n *  bumpMap: new THREE.Texture( <Image> ),\r\n *  bumpScale: <float>,\r\n *\r\n *  normalMap: new THREE.Texture( <Image> ),\r\n *  normalScale: <Vector2>,\r\n *\r\n *  displacementMap: new THREE.Texture( <Image> ),\r\n *  displacementScale: <float>,\r\n *  displacementBias: <float>,\r\n *\r\n *  specularMap: new THREE.Texture( <Image> ),\r\n *\r\n *  alphaMap: new THREE.Texture( <Image> ),\r\n *\r\n *  envMap: new THREE.TextureCube( [posx, negx, posy, negy, posz, negz] ),\r\n *  combine: THREE.Multiply,\r\n *  reflectivity: <float>,\r\n *  refractionRatio: <float>,\r\n *\r\n *  shading: THREE.SmoothShading,\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>,\r\n *\r\n *  vertexColors: THREE.NoColors / THREE.VertexColors / THREE.FaceColors,\r\n *\r\n *  skinning: <bool>,\r\n *  morphTargets: <bool>,\r\n *  morphNormals: <bool>,\r\n *\r\n *\tfog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.MeshPhongMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this );\r\n\r\n\tthis.type = 'MeshPhongMaterial';\r\n\r\n\tthis.color = new THREE.Color( 0xffffff ); // diffuse\r\n\tthis.emissive = new THREE.Color( 0x000000 );\r\n\tthis.specular = new THREE.Color( 0x111111 );\r\n\tthis.shininess = 30;\r\n\r\n\tthis.metal = false;\r\n\r\n\tthis.map = null;\r\n\r\n\tthis.lightMap = null;\r\n\tthis.lightMapIntensity = 1.0;\r\n\r\n\tthis.aoMap = null;\r\n\tthis.aoMapIntensity = 1.0;\r\n\r\n\tthis.emissiveMap = null;\r\n\r\n\tthis.bumpMap = null;\r\n\tthis.bumpScale = 1;\r\n\r\n\tthis.normalMap = null;\r\n\tthis.normalScale = new THREE.Vector2( 1, 1 );\r\n\r\n\tthis.displacementMap = null;\r\n\tthis.displacementScale = 1;\r\n\tthis.displacementBias = 0;\r\n\r\n\tthis.specularMap = null;\r\n\r\n\tthis.alphaMap = null;\r\n\r\n\tthis.envMap = null;\r\n\tthis.combine = THREE.MultiplyOperation;\r\n\tthis.reflectivity = 1;\r\n\tthis.refractionRatio = 0.98;\r\n\r\n\tthis.fog = true;\r\n\r\n\tthis.shading = THREE.SmoothShading;\r\n\r\n\tthis.wireframe = false;\r\n\tthis.wireframeLinewidth = 1;\r\n\tthis.wireframeLinecap = 'round';\r\n\tthis.wireframeLinejoin = 'round';\r\n\r\n\tthis.vertexColors = THREE.NoColors;\r\n\r\n\tthis.skinning = false;\r\n\tthis.morphTargets = false;\r\n\tthis.morphNormals = false;\r\n\r\n\tthis.setValues( parameters );\r\n\r\n};\r\n\r\nTHREE.MeshPhongMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.MeshPhongMaterial.prototype.constructor = THREE.MeshPhongMaterial;\r\n\r\nTHREE.MeshPhongMaterial.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Material.prototype.copy.call( this, source );\r\n\r\n\tthis.color.copy( source.color );\r\n\tthis.emissive.copy( source.emissive );\r\n\tthis.specular.copy( source.specular );\r\n\tthis.shininess = source.shininess;\r\n\r\n\tthis.metal = source.metal;\r\n\r\n\tthis.map = source.map;\r\n\r\n\tthis.lightMap = source.lightMap;\r\n\tthis.lightMapIntensity = source.lightMapIntensity;\r\n\r\n\tthis.aoMap = source.aoMap;\r\n\tthis.aoMapIntensity = source.aoMapIntensity;\r\n\r\n\tthis.emissiveMap = source.emissiveMap;\r\n\r\n\tthis.bumpMap = source.bumpMap;\r\n\tthis.bumpScale = source.bumpScale;\r\n\r\n\tthis.normalMap = source.normalMap;\r\n\tthis.normalScale.copy( source.normalScale );\r\n\r\n\tthis.displacementMap = source.displacementMap;\r\n\tthis.displacementScale = source.displacementScale;\r\n\tthis.displacementBias = source.displacementBias;\r\n\r\n\tthis.specularMap = source.specularMap;\r\n\r\n\tthis.alphaMap = source.alphaMap;\r\n\r\n\tthis.envMap = source.envMap;\r\n\tthis.combine = source.combine;\r\n\tthis.reflectivity = source.reflectivity;\r\n\tthis.refractionRatio = source.refractionRatio;\r\n\r\n\tthis.fog = source.fog;\r\n\r\n\tthis.shading = source.shading;\r\n\r\n\tthis.wireframe = source.wireframe;\r\n\tthis.wireframeLinewidth = source.wireframeLinewidth;\r\n\tthis.wireframeLinecap = source.wireframeLinecap;\r\n\tthis.wireframeLinejoin = source.wireframeLinejoin;\r\n\r\n\tthis.vertexColors = source.vertexColors;\r\n\r\n\tthis.skinning = source.skinning;\r\n\tthis.morphTargets = source.morphTargets;\r\n\tthis.morphNormals = source.morphNormals;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/materials/MeshDepthMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  opacity: <float>,\r\n *\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>\r\n * }\r\n */\r\n\r\nTHREE.MeshDepthMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this );\r\n\r\n\tthis.type = 'MeshDepthMaterial';\r\n\r\n\tthis.morphTargets = false;\r\n\tthis.wireframe = false;\r\n\tthis.wireframeLinewidth = 1;\r\n\r\n\tthis.setValues( parameters );\r\n\r\n};\r\n\r\nTHREE.MeshDepthMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.MeshDepthMaterial.prototype.constructor = THREE.MeshDepthMaterial;\r\n\r\nTHREE.MeshDepthMaterial.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Material.prototype.copy.call( this, source );\r\n\r\n\tthis.wireframe = source.wireframe;\r\n\tthis.wireframeLinewidth = source.wireframeLinewidth;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/materials/MeshNormalMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n *\r\n * parameters = {\r\n *  opacity: <float>,\r\n *\r\n *  shading: THREE.FlatShading,\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>\r\n * }\r\n */\r\n\r\nTHREE.MeshNormalMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this, parameters );\r\n\r\n\tthis.type = 'MeshNormalMaterial';\r\n\r\n\tthis.wireframe = false;\r\n\tthis.wireframeLinewidth = 1;\r\n\r\n\tthis.morphTargets = false;\r\n\r\n\tthis.setValues( parameters );\r\n\r\n};\r\n\r\nTHREE.MeshNormalMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.MeshNormalMaterial.prototype.constructor = THREE.MeshNormalMaterial;\r\n\r\nTHREE.MeshNormalMaterial.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Material.prototype.copy.call( this, source );\r\n\r\n\tthis.wireframe = source.wireframe;\r\n\tthis.wireframeLinewidth = source.wireframeLinewidth;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/materials/MultiMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.MultiMaterial = function ( materials ) {\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\tthis.type = 'MultiMaterial';\r\n\r\n\tthis.materials = materials instanceof Array ? materials : [];\r\n\r\n\tthis.visible = true;\r\n\r\n};\r\n\r\nTHREE.MultiMaterial.prototype = {\r\n\r\n\tconstructor: THREE.MultiMaterial,\r\n\r\n\ttoJSON: function () {\r\n\r\n\t\tvar output = {\r\n\t\t\tmetadata: {\r\n\t\t\t\tversion: 4.2,\r\n\t\t\t\ttype: 'material',\r\n\t\t\t\tgenerator: 'MaterialExporter'\r\n\t\t\t},\r\n\t\t\tuuid: this.uuid,\r\n\t\t\ttype: this.type,\r\n\t\t\tmaterials: []\r\n\t\t};\r\n\r\n\t\tfor ( var i = 0, l = this.materials.length; i < l; i ++ ) {\r\n\r\n\t\t\toutput.materials.push( this.materials[ i ].toJSON() );\r\n\r\n\t\t}\r\n\r\n\t\toutput.visible = this.visible;\r\n\r\n\t\treturn output;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\tvar material = new this.constructor();\r\n\r\n\t\tfor ( var i = 0; i < this.materials.length; i ++ ) {\r\n\r\n\t\t\tmaterial.materials.push( this.materials[ i ].clone() );\r\n\r\n\t\t}\r\n\r\n\t\tmaterial.visible = this.visible;\r\n\r\n\t\treturn material;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// backwards compatibility\r\n\r\nTHREE.MeshFaceMaterial = THREE.MultiMaterial;\r\n\r\n// File:src/materials/PointsMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  opacity: <float>,\r\n *  map: new THREE.Texture( <Image> ),\r\n *\r\n *  size: <float>,\r\n *  sizeAttenuation: <bool>,\r\n *\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  vertexColors: <bool>,\r\n *\r\n *  fog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.PointsMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this );\r\n\r\n\tthis.type = 'PointsMaterial';\r\n\r\n\tthis.color = new THREE.Color( 0xffffff );\r\n\r\n\tthis.map = null;\r\n\r\n\tthis.size = 1;\r\n\tthis.sizeAttenuation = true;\r\n\r\n\tthis.vertexColors = THREE.NoColors;\r\n\r\n\tthis.fog = true;\r\n\r\n\tthis.setValues( parameters );\r\n\r\n};\r\n\r\nTHREE.PointsMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.PointsMaterial.prototype.constructor = THREE.PointsMaterial;\r\n\r\nTHREE.PointsMaterial.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Material.prototype.copy.call( this, source );\r\n\r\n\tthis.color.copy( source.color );\r\n\r\n\tthis.map = source.map;\r\n\r\n\tthis.size = source.size;\r\n\tthis.sizeAttenuation = source.sizeAttenuation;\r\n\r\n\tthis.vertexColors = source.vertexColors;\r\n\r\n\tthis.fog = source.fog;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// backwards compatibility\r\n\r\nTHREE.PointCloudMaterial = function ( parameters ) {\r\n\r\n\tconsole.warn( 'THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial.' );\r\n\treturn new THREE.PointsMaterial( parameters );\r\n\r\n};\r\n\r\nTHREE.ParticleBasicMaterial = function ( parameters ) {\r\n\r\n\tconsole.warn( 'THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial.' );\r\n\treturn new THREE.PointsMaterial( parameters );\r\n\r\n};\r\n\r\nTHREE.ParticleSystemMaterial = function ( parameters ) {\r\n\r\n\tconsole.warn( 'THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial.' );\r\n\treturn new THREE.PointsMaterial( parameters );\r\n\r\n};\r\n\r\n// File:src/materials/ShaderMaterial.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  defines: { \"label\" : \"value\" },\r\n *  uniforms: { \"parameter1\": { type: \"f\", value: 1.0 }, \"parameter2\": { type: \"i\" value2: 2 } },\r\n *\r\n *  fragmentShader: <string>,\r\n *  vertexShader: <string>,\r\n *\r\n *  shading: THREE.SmoothShading,\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>,\r\n *\r\n *  lights: <bool>,\r\n *\r\n *  vertexColors: THREE.NoColors / THREE.VertexColors / THREE.FaceColors,\r\n *\r\n *  skinning: <bool>,\r\n *  morphTargets: <bool>,\r\n *  morphNormals: <bool>,\r\n *\r\n *\tfog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.ShaderMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this );\r\n\r\n\tthis.type = 'ShaderMaterial';\r\n\r\n\tthis.defines = {};\r\n\tthis.uniforms = {};\r\n\r\n\tthis.vertexShader = 'void main() {\\n\\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\\n}';\r\n\tthis.fragmentShader = 'void main() {\\n\\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\\n}';\r\n\r\n\tthis.shading = THREE.SmoothShading;\r\n\r\n\tthis.linewidth = 1;\r\n\r\n\tthis.wireframe = false;\r\n\tthis.wireframeLinewidth = 1;\r\n\r\n\tthis.fog = false; // set to use scene fog\r\n\r\n\tthis.lights = false; // set to use scene lights\r\n\r\n\tthis.vertexColors = THREE.NoColors; // set to use \"color\" attribute stream\r\n\r\n\tthis.skinning = false; // set to use skinning attribute streams\r\n\r\n\tthis.morphTargets = false; // set to use morph targets\r\n\tthis.morphNormals = false; // set to use morph normals\r\n\r\n\tthis.derivatives = false; // set to use derivatives\r\n\r\n\t// When rendered geometry doesn't include these attributes but the material does,\r\n\t// use these default values in WebGL. This avoids errors when buffer data is missing.\r\n\tthis.defaultAttributeValues = {\r\n\t\t'color': [ 1, 1, 1 ],\r\n\t\t'uv': [ 0, 0 ],\r\n\t\t'uv2': [ 0, 0 ]\r\n\t};\r\n\r\n\tthis.index0AttributeName = undefined;\r\n\r\n\tif ( parameters !== undefined ) {\r\n\r\n\t\tif ( parameters.attributes !== undefined ) {\r\n\r\n\t\t\tconsole.error( 'THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead.' );\r\n\r\n\t\t}\r\n\r\n\t\tthis.setValues( parameters );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.ShaderMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.ShaderMaterial.prototype.constructor = THREE.ShaderMaterial;\r\n\r\nTHREE.ShaderMaterial.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Material.prototype.copy.call( this, source );\r\n\r\n\tthis.fragmentShader = source.fragmentShader;\r\n\tthis.vertexShader = source.vertexShader;\r\n\r\n\tthis.uniforms = THREE.UniformsUtils.clone( source.uniforms );\r\n\r\n\tthis.attributes = source.attributes;\r\n\tthis.defines = source.defines;\r\n\r\n\tthis.shading = source.shading;\r\n\r\n\tthis.wireframe = source.wireframe;\r\n\tthis.wireframeLinewidth = source.wireframeLinewidth;\r\n\r\n\tthis.fog = source.fog;\r\n\r\n\tthis.lights = source.lights;\r\n\r\n\tthis.vertexColors = source.vertexColors;\r\n\r\n\tthis.skinning = source.skinning;\r\n\r\n\tthis.morphTargets = source.morphTargets;\r\n\tthis.morphNormals = source.morphNormals;\r\n\r\n\tthis.derivatives = source.derivatives;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nTHREE.ShaderMaterial.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = THREE.Material.prototype.toJSON.call( this, meta );\r\n\r\n\tdata.uniforms = this.uniforms;\r\n\tdata.attributes = this.attributes;\r\n\tdata.vertexShader = this.vertexShader;\r\n\tdata.fragmentShader = this.fragmentShader;\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\n// File:src/materials/RawShaderMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.RawShaderMaterial = function ( parameters ) {\r\n\r\n\tTHREE.ShaderMaterial.call( this, parameters );\r\n\r\n\tthis.type = 'RawShaderMaterial';\r\n\r\n};\r\n\r\nTHREE.RawShaderMaterial.prototype = Object.create( THREE.ShaderMaterial.prototype );\r\nTHREE.RawShaderMaterial.prototype.constructor = THREE.RawShaderMaterial;\r\n// File:src/materials/SpriteMaterial.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  opacity: <float>,\r\n *  map: new THREE.Texture( <Image> ),\r\n *\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *\tuvOffset: new THREE.Vector2(),\r\n *\tuvScale: new THREE.Vector2(),\r\n *\r\n *  fog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.SpriteMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this );\r\n\r\n\tthis.type = 'SpriteMaterial';\r\n\r\n\tthis.color = new THREE.Color( 0xffffff );\r\n\tthis.map = null;\r\n\r\n\tthis.rotation = 0;\r\n\r\n\tthis.fog = false;\r\n\r\n\t// set parameters\r\n\r\n\tthis.setValues( parameters );\r\n\r\n};\r\n\r\nTHREE.SpriteMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.SpriteMaterial.prototype.constructor = THREE.SpriteMaterial;\r\n\r\nTHREE.SpriteMaterial.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Material.prototype.copy.call( this, source );\r\n\r\n\tthis.color.copy( source.color );\r\n\tthis.map = source.map;\r\n\r\n\tthis.rotation = source.rotation;\r\n\r\n\tthis.fog = source.fog;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/textures/Texture.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author szimek / https://github.com/szimek/\r\n */\r\n\r\nTHREE.Texture = function ( image, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy ) {\r\n\r\n\tObject.defineProperty( this, 'id', { value: THREE.TextureIdCount ++ } );\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\tthis.name = '';\r\n\tthis.sourceFile = '';\r\n\r\n\tthis.image = image !== undefined ? image : THREE.Texture.DEFAULT_IMAGE;\r\n\tthis.mipmaps = [];\r\n\r\n\tthis.mapping = mapping !== undefined ? mapping : THREE.Texture.DEFAULT_MAPPING;\r\n\r\n\tthis.wrapS = wrapS !== undefined ? wrapS : THREE.ClampToEdgeWrapping;\r\n\tthis.wrapT = wrapT !== undefined ? wrapT : THREE.ClampToEdgeWrapping;\r\n\r\n\tthis.magFilter = magFilter !== undefined ? magFilter : THREE.LinearFilter;\r\n\tthis.minFilter = minFilter !== undefined ? minFilter : THREE.LinearMipMapLinearFilter;\r\n\r\n\tthis.anisotropy = anisotropy !== undefined ? anisotropy : 1;\r\n\r\n\tthis.format = format !== undefined ? format : THREE.RGBAFormat;\r\n\tthis.type = type !== undefined ? type : THREE.UnsignedByteType;\r\n\r\n\tthis.offset = new THREE.Vector2( 0, 0 );\r\n\tthis.repeat = new THREE.Vector2( 1, 1 );\r\n\r\n\tthis.generateMipmaps = true;\r\n\tthis.premultiplyAlpha = false;\r\n\tthis.flipY = true;\r\n\tthis.unpackAlignment = 4; // valid values: 1, 2, 4, 8 (see http://www.khronos.org/opengles/sdk/docs/man/xhtml/glPixelStorei.xml)\r\n\r\n\tthis.version = 0;\r\n\tthis.onUpdate = null;\r\n\r\n};\r\n\r\nTHREE.Texture.DEFAULT_IMAGE = undefined;\r\nTHREE.Texture.DEFAULT_MAPPING = THREE.UVMapping;\r\n\r\nTHREE.Texture.prototype = {\r\n\r\n\tconstructor: THREE.Texture,\r\n\r\n\tset needsUpdate ( value ) {\r\n\r\n\t\tif ( value === true ) this.version ++;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( source ) {\r\n\r\n\t\tthis.image = source.image;\r\n\t\tthis.mipmaps = source.mipmaps.slice( 0 );\r\n\r\n\t\tthis.mapping = source.mapping;\r\n\r\n\t\tthis.wrapS = source.wrapS;\r\n\t\tthis.wrapT = source.wrapT;\r\n\r\n\t\tthis.magFilter = source.magFilter;\r\n\t\tthis.minFilter = source.minFilter;\r\n\r\n\t\tthis.anisotropy = source.anisotropy;\r\n\r\n\t\tthis.format = source.format;\r\n\t\tthis.type = source.type;\r\n\r\n\t\tthis.offset.copy( source.offset );\r\n\t\tthis.repeat.copy( source.repeat );\r\n\r\n\t\tthis.generateMipmaps = source.generateMipmaps;\r\n\t\tthis.premultiplyAlpha = source.premultiplyAlpha;\r\n\t\tthis.flipY = source.flipY;\r\n\t\tthis.unpackAlignment = source.unpackAlignment;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttoJSON: function ( meta ) {\r\n\r\n\t\tif ( meta.textures[ this.uuid ] !== undefined ) {\r\n\r\n\t\t\treturn meta.textures[ this.uuid ];\r\n\r\n\t\t}\r\n\r\n\t\tfunction getDataURL( image ) {\r\n\r\n\t\t\tvar canvas;\r\n\r\n\t\t\tif ( image.toDataURL !== undefined ) {\r\n\r\n\t\t\t\tcanvas = image;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tcanvas = document.createElement( 'canvas' );\r\n\t\t\t\tcanvas.width = image.width;\r\n\t\t\t\tcanvas.height = image.height;\r\n\r\n\t\t\t\tcanvas.getContext( '2d' ).drawImage( image, 0, 0, image.width, image.height );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( canvas.width > 2048 || canvas.height > 2048 ) {\r\n\r\n\t\t\t\treturn canvas.toDataURL( 'image/jpeg', 0.6 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\treturn canvas.toDataURL( 'image/png' );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar output = {\r\n\t\t\tmetadata: {\r\n\t\t\t\tversion: 4.4,\r\n\t\t\t\ttype: 'Texture',\r\n\t\t\t\tgenerator: 'Texture.toJSON'\r\n\t\t\t},\r\n\r\n\t\t\tuuid: this.uuid,\r\n\t\t\tname: this.name,\r\n\r\n\t\t\tmapping: this.mapping,\r\n\r\n\t\t\trepeat: [ this.repeat.x, this.repeat.y ],\r\n\t\t\toffset: [ this.offset.x, this.offset.y ],\r\n\t\t\twrap: [ this.wrapS, this.wrapT ],\r\n\r\n\t\t\tminFilter: this.minFilter,\r\n\t\t\tmagFilter: this.magFilter,\r\n\t\t\tanisotropy: this.anisotropy\r\n\t\t};\r\n\r\n\t\tif ( this.image !== undefined ) {\r\n\r\n\t\t\t// TODO: Move to THREE.Image\r\n\r\n\t\t\tvar image = this.image;\r\n\r\n\t\t\tif ( image.uuid === undefined ) {\r\n\r\n\t\t\t\timage.uuid = THREE.Math.generateUUID(); // UGH\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( meta.images[ image.uuid ] === undefined ) {\r\n\r\n\t\t\t\tmeta.images[ image.uuid ] = {\r\n\t\t\t\t\tuuid: image.uuid,\r\n\t\t\t\t\turl: getDataURL( image )\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\r\n\t\t\toutput.image = image.uuid;\r\n\r\n\t\t}\r\n\r\n\t\tmeta.textures[ this.uuid ] = output;\r\n\r\n\t\treturn output;\r\n\r\n\t},\r\n\r\n\tdispose: function () {\r\n\r\n\t\tthis.dispatchEvent( { type: 'dispose' } );\r\n\r\n\t},\r\n\r\n\ttransformUv: function ( uv ) {\r\n\r\n\t\tif ( this.mapping !== THREE.UVMapping )  return;\r\n\r\n\t\tuv.multiply( this.repeat );\r\n\t\tuv.add( this.offset );\r\n\r\n\t\tif ( uv.x < 0 || uv.x > 1 ) {\r\n\r\n\t\t\tswitch ( this.wrapS ) {\r\n\r\n\t\t\t\tcase THREE.RepeatWrapping:\r\n\r\n\t\t\t\t\tuv.x = uv.x - Math.floor( uv.x );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase THREE.ClampToEdgeWrapping:\r\n\r\n\t\t\t\t\tuv.x = uv.x < 0 ? 0 : 1;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase THREE.MirroredRepeatWrapping:\r\n\r\n\t\t\t\t\tif ( Math.abs( Math.floor( uv.x ) % 2 ) === 1 ) {\r\n\r\n\t\t\t\t\t\tuv.x = Math.ceil( uv.x ) - uv.x;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tuv.x = uv.x - Math.floor( uv.x );\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( uv.y < 0 || uv.y > 1 ) {\r\n\r\n\t\t\tswitch ( this.wrapT ) {\r\n\r\n\t\t\t\tcase THREE.RepeatWrapping:\r\n\r\n\t\t\t\t\tuv.y = uv.y - Math.floor( uv.y );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase THREE.ClampToEdgeWrapping:\r\n\r\n\t\t\t\t\tuv.y = uv.y < 0 ? 0 : 1;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase THREE.MirroredRepeatWrapping:\r\n\r\n\t\t\t\t\tif ( Math.abs( Math.floor( uv.y ) % 2 ) === 1 ) {\r\n\r\n\t\t\t\t\t\tuv.y = Math.ceil( uv.y ) - uv.y;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tuv.y = uv.y - Math.floor( uv.y );\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.flipY ) {\r\n\r\n\t\t\tuv.y = 1 - uv.y;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply( THREE.Texture.prototype );\r\n\r\nTHREE.TextureIdCount = 0;\r\n\r\n// File:src/textures/CanvasTexture.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.CanvasTexture = function ( canvas, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy ) {\r\n\r\n\tTHREE.Texture.call( this, canvas, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\r\n\r\n\tthis.needsUpdate = true;\r\n\r\n};\r\n\r\nTHREE.CanvasTexture.prototype = Object.create( THREE.Texture.prototype );\r\nTHREE.CanvasTexture.prototype.constructor = THREE.CanvasTexture;\r\n\r\n// File:src/textures/CubeTexture.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.CubeTexture = function ( images, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy ) {\r\n\r\n\tmapping = mapping !== undefined ? mapping : THREE.CubeReflectionMapping;\r\n\r\n\tTHREE.Texture.call( this, images, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\r\n\r\n\tthis.images = images;\r\n\tthis.flipY = false;\r\n\r\n};\r\n\r\nTHREE.CubeTexture.prototype = Object.create( THREE.Texture.prototype );\r\nTHREE.CubeTexture.prototype.constructor = THREE.CubeTexture;\r\n\r\nTHREE.CubeTexture.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Texture.prototype.copy.call( this, source );\r\n\t\r\n\tthis.images = source.images;\r\n\t\r\n\treturn this;\r\n\r\n};\r\n// File:src/textures/CompressedTexture.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.CompressedTexture = function ( mipmaps, width, height, format, type, mapping, wrapS, wrapT, magFilter, minFilter, anisotropy ) {\r\n\r\n\tTHREE.Texture.call( this, null, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\r\n\r\n\tthis.image = { width: width, height: height };\r\n\tthis.mipmaps = mipmaps;\r\n\r\n\t// no flipping for cube textures\r\n\t// (also flipping doesn't work for compressed textures )\r\n\r\n\tthis.flipY = false;\r\n\r\n\t// can't generate mipmaps for compressed textures\r\n\t// mips must be embedded in DDS files\r\n\r\n\tthis.generateMipmaps = false;\r\n\r\n};\r\n\r\nTHREE.CompressedTexture.prototype = Object.create( THREE.Texture.prototype );\r\nTHREE.CompressedTexture.prototype.constructor = THREE.CompressedTexture;\r\n\r\n// File:src/textures/DataTexture.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.DataTexture = function ( data, width, height, format, type, mapping, wrapS, wrapT, magFilter, minFilter, anisotropy ) {\r\n\r\n\tTHREE.Texture.call( this, null, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\r\n\r\n\tthis.image = { data: data, width: width, height: height };\r\n\r\n\tthis.magFilter = magFilter !== undefined ? magFilter : THREE.NearestFilter;\r\n\tthis.minFilter = minFilter !== undefined ? minFilter : THREE.NearestFilter;\r\n\t\r\n\tthis.flipY = false;\r\n\tthis.generateMipmaps  = false;\r\n\r\n};\r\n\r\nTHREE.DataTexture.prototype = Object.create( THREE.Texture.prototype );\r\nTHREE.DataTexture.prototype.constructor = THREE.DataTexture;\r\n\r\n// File:src/textures/VideoTexture.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.VideoTexture = function ( video, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy ) {\r\n\r\n\tTHREE.Texture.call( this, video, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\r\n\r\n\tthis.generateMipmaps = false;\r\n\r\n\tvar scope = this;\r\n\r\n\tfunction update() {\r\n\r\n\t\trequestAnimationFrame( update );\r\n\r\n\t\tif ( video.readyState === video.HAVE_ENOUGH_DATA ) {\r\n\r\n\t\t\tscope.needsUpdate = true;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tupdate();\r\n\r\n};\r\n\r\nTHREE.VideoTexture.prototype = Object.create( THREE.Texture.prototype );\r\nTHREE.VideoTexture.prototype.constructor = THREE.VideoTexture;\r\n\r\n// File:src/objects/Group.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Group = function () {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'Group';\r\n\r\n};\r\n\r\nTHREE.Group.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.Group.prototype.constructor = THREE.Group;\r\n// File:src/objects/Points.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Points = function ( geometry, material ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'Points';\r\n\r\n\tthis.geometry = geometry !== undefined ? geometry : new THREE.Geometry();\r\n\tthis.material = material !== undefined ? material : new THREE.PointsMaterial( { color: Math.random() * 0xffffff } );\r\n\r\n};\r\n\r\nTHREE.Points.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.Points.prototype.constructor = THREE.Points;\r\n\r\nTHREE.Points.prototype.raycast = ( function () {\r\n\r\n\tvar inverseMatrix = new THREE.Matrix4();\r\n\tvar ray = new THREE.Ray();\r\n\r\n\treturn function raycast( raycaster, intersects ) {\r\n\r\n\t\tvar object = this;\r\n\t\tvar geometry = object.geometry;\r\n\t\tvar threshold = raycaster.params.Points.threshold;\r\n\r\n\t\tinverseMatrix.getInverse( this.matrixWorld );\r\n\t\tray.copy( raycaster.ray ).applyMatrix4( inverseMatrix );\r\n\r\n\t\tif ( geometry.boundingBox !== null ) {\r\n\r\n\t\t\tif ( ray.isIntersectionBox( geometry.boundingBox ) === false ) {\r\n\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar localThreshold = threshold / ( ( this.scale.x + this.scale.y + this.scale.z ) / 3 );\r\n\t\tvar localThresholdSq = localThreshold * localThreshold;\r\n\t\tvar position = new THREE.Vector3();\r\n\r\n\t\tfunction testPoint( point, index ) {\r\n\r\n\t\t\tvar rayPointDistanceSq = ray.distanceSqToPoint( point );\r\n\r\n\t\t\tif ( rayPointDistanceSq < localThresholdSq ) {\r\n\r\n\t\t\t\tvar intersectPoint = ray.closestPointToPoint( point );\r\n\t\t\t\tintersectPoint.applyMatrix4( object.matrixWorld );\r\n\r\n\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( intersectPoint );\r\n\r\n\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) return;\r\n\r\n\t\t\t\tintersects.push( {\r\n\r\n\t\t\t\t\tdistance: distance,\r\n\t\t\t\t\tdistanceToRay: Math.sqrt( rayPointDistanceSq ),\r\n\t\t\t\t\tpoint: intersectPoint.clone(),\r\n\t\t\t\t\tindex: index,\r\n\t\t\t\t\tface: null,\r\n\t\t\t\t\tobject: object\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry instanceof THREE.BufferGeometry ) {\r\n\r\n\t\t\tvar index = geometry.index;\r\n\t\t\tvar attributes = geometry.attributes;\r\n\t\t\tvar positions = attributes.position.array;\r\n\r\n\t\t\tif ( index !== null ) {\r\n\r\n\t\t\t\tvar indices = index.array;\r\n\r\n\t\t\t\tfor ( var i = 0, il = indices.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\tvar a = indices[ i ];\r\n\r\n\t\t\t\t\tposition.fromArray( positions, a * 3 );\r\n\r\n\t\t\t\t\ttestPoint( position, a );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tfor ( var i = 0, l = positions.length / 3; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tposition.fromArray( positions, i * 3 );\r\n\r\n\t\t\t\t\ttestPoint( position, i );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tvar vertices = geometry.vertices;\r\n\r\n\t\t\tfor ( var i = 0, l = vertices.length; i < l; i ++ ) {\r\n\r\n\t\t\t\ttestPoint( vertices[ i ], i );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n}() );\r\n\r\nTHREE.Points.prototype.clone = function () {\r\n\r\n\treturn new this.constructor( this.geometry, this.material ).copy( this );\r\n\r\n};\r\n\r\n// Backwards compatibility\r\n\r\nTHREE.PointCloud = function ( geometry, material ) {\r\n\r\n\tconsole.warn( 'THREE.PointCloud has been renamed to THREE.Points.' );\r\n\treturn new THREE.Points( geometry, material );\r\n\r\n};\r\n\r\nTHREE.ParticleSystem = function ( geometry, material ) {\r\n\r\n\tconsole.warn( 'THREE.ParticleSystem has been renamed to THREE.Points.' );\r\n\treturn new THREE.Points( geometry, material );\r\n\r\n};\r\n\r\n// File:src/objects/Line.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Line = function ( geometry, material, mode ) {\r\n\r\n\tif ( mode === 1 ) {\r\n\r\n\t\tconsole.warn( 'THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead.' );\r\n\t\treturn new THREE.LineSegments( geometry, material );\r\n\r\n\t}\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'Line';\r\n\r\n\tthis.geometry = geometry !== undefined ? geometry : new THREE.Geometry();\r\n\tthis.material = material !== undefined ? material : new THREE.LineBasicMaterial( { color: Math.random() * 0xffffff } );\r\n\r\n};\r\n\r\nTHREE.Line.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.Line.prototype.constructor = THREE.Line;\r\n\r\nTHREE.Line.prototype.raycast = ( function () {\r\n\r\n\tvar inverseMatrix = new THREE.Matrix4();\r\n\tvar ray = new THREE.Ray();\r\n\tvar sphere = new THREE.Sphere();\r\n\r\n\treturn function raycast( raycaster, intersects ) {\r\n\r\n\t\tvar precision = raycaster.linePrecision;\r\n\t\tvar precisionSq = precision * precision;\r\n\r\n\t\tvar geometry = this.geometry;\r\n\r\n\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\r\n\r\n\t\t// Checking boundingSphere distance to ray\r\n\r\n\t\tsphere.copy( geometry.boundingSphere );\r\n\t\tsphere.applyMatrix4( this.matrixWorld );\r\n\r\n\t\tif ( raycaster.ray.isIntersectionSphere( sphere ) === false ) {\r\n\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tinverseMatrix.getInverse( this.matrixWorld );\r\n\t\tray.copy( raycaster.ray ).applyMatrix4( inverseMatrix );\r\n\r\n\t\tvar vStart = new THREE.Vector3();\r\n\t\tvar vEnd = new THREE.Vector3();\r\n\t\tvar interSegment = new THREE.Vector3();\r\n\t\tvar interRay = new THREE.Vector3();\r\n\t\tvar step = this instanceof THREE.LineSegments ? 2 : 1;\r\n\r\n\t\tif ( geometry instanceof THREE.BufferGeometry ) {\r\n\r\n\t\t\tvar index = geometry.index;\r\n\t\t\tvar attributes = geometry.attributes;\r\n\r\n\t\t\tif ( index !== null ) {\r\n\r\n\t\t\t\tvar indices = index.array;\r\n\t\t\t\tvar positions = attributes.position.array;\r\n\r\n\t\t\t\tfor ( var i = 0, l = indices.length - 1; i < l; i += step ) {\r\n\r\n\t\t\t\t\tvar a = indices[ i ];\r\n\t\t\t\t\tvar b = indices[ i + 1 ];\r\n\r\n\t\t\t\t\tvStart.fromArray( positions, a * 3 );\r\n\t\t\t\t\tvEnd.fromArray( positions, b * 3 );\r\n\r\n\t\t\t\t\tvar distSq = ray.distanceSqToSegment( vStart, vEnd, interRay, interSegment );\r\n\r\n\t\t\t\t\tif ( distSq > precisionSq ) continue;\r\n\r\n\t\t\t\t\tinterRay.applyMatrix4( this.matrixWorld ); //Move back to world space for distance calculation\r\n\r\n\t\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( interRay );\r\n\r\n\t\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) continue;\r\n\r\n\t\t\t\t\tintersects.push( {\r\n\r\n\t\t\t\t\t\tdistance: distance,\r\n\t\t\t\t\t\t// What do we want? intersection point on the ray or on the segment??\r\n\t\t\t\t\t\t// point: raycaster.ray.at( distance ),\r\n\t\t\t\t\t\tpoint: interSegment.clone().applyMatrix4( this.matrixWorld ),\r\n\t\t\t\t\t\tindex: i,\r\n\t\t\t\t\t\tface: null,\r\n\t\t\t\t\t\tfaceIndex: null,\r\n\t\t\t\t\t\tobject: this\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvar positions = attributes.position.array;\r\n\r\n\t\t\t\tfor ( var i = 0, l = positions.length / 3 - 1; i < l; i += step ) {\r\n\r\n\t\t\t\t\tvStart.fromArray( positions, 3 * i );\r\n\t\t\t\t\tvEnd.fromArray( positions, 3 * i + 3 );\r\n\r\n\t\t\t\t\tvar distSq = ray.distanceSqToSegment( vStart, vEnd, interRay, interSegment );\r\n\r\n\t\t\t\t\tif ( distSq > precisionSq ) continue;\r\n\r\n\t\t\t\t\tinterRay.applyMatrix4( this.matrixWorld ); //Move back to world space for distance calculation\r\n\r\n\t\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( interRay );\r\n\r\n\t\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) continue;\r\n\r\n\t\t\t\t\tintersects.push( {\r\n\r\n\t\t\t\t\t\tdistance: distance,\r\n\t\t\t\t\t\t// What do we want? intersection point on the ray or on the segment??\r\n\t\t\t\t\t\t// point: raycaster.ray.at( distance ),\r\n\t\t\t\t\t\tpoint: interSegment.clone().applyMatrix4( this.matrixWorld ),\r\n\t\t\t\t\t\tindex: i,\r\n\t\t\t\t\t\tface: null,\r\n\t\t\t\t\t\tfaceIndex: null,\r\n\t\t\t\t\t\tobject: this\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( geometry instanceof THREE.Geometry ) {\r\n\r\n\t\t\tvar vertices = geometry.vertices;\r\n\t\t\tvar nbVertices = vertices.length;\r\n\r\n\t\t\tfor ( var i = 0; i < nbVertices - 1; i += step ) {\r\n\r\n\t\t\t\tvar distSq = ray.distanceSqToSegment( vertices[ i ], vertices[ i + 1 ], interRay, interSegment );\r\n\r\n\t\t\t\tif ( distSq > precisionSq ) continue;\r\n\r\n\t\t\t\tinterRay.applyMatrix4( this.matrixWorld ); //Move back to world space for distance calculation\r\n\r\n\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( interRay );\r\n\r\n\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) continue;\r\n\r\n\t\t\t\tintersects.push( {\r\n\r\n\t\t\t\t\tdistance: distance,\r\n\t\t\t\t\t// What do we want? intersection point on the ray or on the segment??\r\n\t\t\t\t\t// point: raycaster.ray.at( distance ),\r\n\t\t\t\t\tpoint: interSegment.clone().applyMatrix4( this.matrixWorld ),\r\n\t\t\t\t\tindex: i,\r\n\t\t\t\t\tface: null,\r\n\t\t\t\t\tfaceIndex: null,\r\n\t\t\t\t\tobject: this\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n}() );\r\n\r\nTHREE.Line.prototype.clone = function () {\r\n\r\n\treturn new this.constructor( this.geometry, this.material ).copy( this );\r\n\r\n};\r\n\r\n// DEPRECATED\r\n\r\nTHREE.LineStrip = 0;\r\nTHREE.LinePieces = 1;\r\n\r\n// File:src/objects/LineSegments.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.LineSegments = function ( geometry, material ) {\r\n\r\n\tTHREE.Line.call( this, geometry, material );\r\n\r\n\tthis.type = 'LineSegments';\r\n\r\n};\r\n\r\nTHREE.LineSegments.prototype = Object.create( THREE.Line.prototype );\r\nTHREE.LineSegments.prototype.constructor = THREE.LineSegments;\r\n\r\n// File:src/objects/Mesh.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author jonobr1 / http://jonobr1.com/\r\n */\r\n\r\nTHREE.Mesh = function ( geometry, material ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'Mesh';\r\n\r\n\tthis.geometry = geometry !== undefined ? geometry : new THREE.Geometry();\r\n\tthis.material = material !== undefined ? material : new THREE.MeshBasicMaterial( { color: Math.random() * 0xffffff } );\r\n\r\n\tthis.updateMorphTargets();\r\n\r\n};\r\n\r\nTHREE.Mesh.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.Mesh.prototype.constructor = THREE.Mesh;\r\n\r\nTHREE.Mesh.prototype.updateMorphTargets = function () {\r\n\r\n\tif ( this.geometry.morphTargets !== undefined && this.geometry.morphTargets.length > 0 ) {\r\n\r\n\t\tthis.morphTargetBase = - 1;\r\n\t\tthis.morphTargetInfluences = [];\r\n\t\tthis.morphTargetDictionary = {};\r\n\r\n\t\tfor ( var m = 0, ml = this.geometry.morphTargets.length; m < ml; m ++ ) {\r\n\r\n\t\t\tthis.morphTargetInfluences.push( 0 );\r\n\t\t\tthis.morphTargetDictionary[ this.geometry.morphTargets[ m ].name ] = m;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.Mesh.prototype.getMorphTargetIndexByName = function ( name ) {\r\n\r\n\tif ( this.morphTargetDictionary[ name ] !== undefined ) {\r\n\r\n\t\treturn this.morphTargetDictionary[ name ];\r\n\r\n\t}\r\n\r\n\tconsole.warn( 'THREE.Mesh.getMorphTargetIndexByName: morph target ' + name + ' does not exist. Returning 0.' );\r\n\r\n\treturn 0;\r\n\r\n};\r\n\r\n\r\nTHREE.Mesh.prototype.raycast = ( function () {\r\n\r\n\tvar inverseMatrix = new THREE.Matrix4();\r\n\tvar ray = new THREE.Ray();\r\n\tvar sphere = new THREE.Sphere();\r\n\r\n\tvar vA = new THREE.Vector3();\r\n\tvar vB = new THREE.Vector3();\r\n\tvar vC = new THREE.Vector3();\r\n\r\n\tvar tempA = new THREE.Vector3();\r\n\tvar tempB = new THREE.Vector3();\r\n\tvar tempC = new THREE.Vector3();\r\n\r\n\tvar uvA = new THREE.Vector2();\r\n\tvar uvB = new THREE.Vector2();\r\n\tvar uvC = new THREE.Vector2();\r\n\r\n\tvar barycoord = new THREE.Vector3();\r\n\r\n\tvar intersectionPoint = new THREE.Vector3();\r\n\tvar intersectionPointWorld = new THREE.Vector3();\r\n\r\n\tfunction uvIntersection( point, p1, p2, p3, uv1, uv2, uv3 ) {\r\n\r\n\t\tTHREE.Triangle.barycoordFromPoint( point, p1, p2, p3, barycoord );\r\n\r\n\t\tuv1.multiplyScalar( barycoord.x );\r\n\t\tuv2.multiplyScalar( barycoord.y );\r\n\t\tuv3.multiplyScalar( barycoord.z );\r\n\r\n\t\tuv1.add( uv2 ).add( uv3 );\r\n\r\n\t\treturn uv1.clone();\r\n\r\n\t}\r\n\r\n\tfunction checkIntersection( object, raycaster, ray, pA, pB, pC, point ){\r\n\r\n\t\tvar intersect;\r\n\t\tvar material = object.material;\r\n\r\n\t\tif ( material.side === THREE.BackSide ) {\r\n\r\n\t\t\tintersect = ray.intersectTriangle( pC, pB, pA, true, point );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tintersect = ray.intersectTriangle( pA, pB, pC, material.side !== THREE.DoubleSide, point );\r\n\r\n\t\t}\r\n\r\n\t\tif ( intersect === null ) return null;\r\n\r\n\t\tintersectionPointWorld.copy( point );\r\n\t\tintersectionPointWorld.applyMatrix4( object.matrixWorld );\r\n\r\n\t\tvar distance = raycaster.ray.origin.distanceTo( intersectionPointWorld );\r\n\r\n\t\tif ( distance < raycaster.near || distance > raycaster.far ) return null;\r\n\r\n\t\treturn {\r\n\t\t\tdistance: distance,\r\n\t\t\tpoint: intersectionPointWorld.clone(),\r\n\t\t\tobject: object\r\n\t\t};\r\n\r\n\t}\r\n\r\n\tfunction checkBufferGeometryIntersection( object, raycaster, ray, positions, uvs, a, b, c ) {\r\n\r\n\t\tvA.fromArray( positions, a * 3 );\r\n\t\tvB.fromArray( positions, b * 3 );\r\n\t\tvC.fromArray( positions, c * 3 );\r\n\r\n\t\tvar intersection = checkIntersection( object, raycaster, ray, vA, vB, vC, intersectionPoint );\r\n\r\n\t\tif ( intersection ) {\r\n\r\n\t\t\tif ( uvs ) {\r\n\r\n\t\t\t\tuvA.fromArray( uvs, a * 2 );\r\n\t\t\t\tuvB.fromArray( uvs, b * 2 );\r\n\t\t\t\tuvC.fromArray( uvs, c * 2 );\r\n\r\n\t\t\t\tintersection.uv = uvIntersection( intersectionPoint,  vA, vB, vC,  uvA, uvB, uvC );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tintersection.face = new THREE.Face3( a, b, c, THREE.Triangle.normal( vA, vB, vC ) );\r\n\t\t\tintersection.faceIndex = a;\r\n\r\n\t\t}\r\n\r\n\t\treturn intersection;\r\n\r\n\t}\r\n\r\n\treturn function raycast( raycaster, intersects ) {\r\n\r\n\t\tvar geometry = this.geometry;\r\n\t\tvar material = this.material;\r\n\r\n\t\tif ( material === undefined ) return;\r\n\r\n\t\t// Checking boundingSphere distance to ray\r\n\r\n\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\r\n\r\n\t\tvar matrixWorld = this.matrixWorld;\r\n\r\n\t\tsphere.copy( geometry.boundingSphere );\r\n\t\tsphere.applyMatrix4( matrixWorld );\r\n\r\n\t\tif ( raycaster.ray.isIntersectionSphere( sphere ) === false ) return;\r\n\r\n\t\t// Check boundingBox before continuing\r\n\r\n\t\tinverseMatrix.getInverse( matrixWorld );\r\n\t\tray.copy( raycaster.ray ).applyMatrix4( inverseMatrix );\r\n\r\n\t\tif ( geometry.boundingBox !== null ) {\r\n\r\n\t\t\tif ( ray.isIntersectionBox( geometry.boundingBox ) === false ) return;\r\n\r\n\t\t}\r\n\r\n\t\tvar uvs, intersection;\r\n\r\n\t\tif ( geometry instanceof THREE.BufferGeometry ) {\r\n\r\n\t\t\tvar a, b, c;\r\n\t\t\tvar index = geometry.index;\r\n\t\t\tvar attributes = geometry.attributes;\r\n\t\t\tvar positions = attributes.position.array;\r\n\r\n\t\t\tif ( attributes.uv !== undefined ){\r\n\r\n\t\t\t\tuvs = attributes.uv.array;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( index !== null ) {\r\n\r\n\t\t\t\tvar indices = index.array;\r\n\r\n\t\t\t\tfor ( var i = 0, l = indices.length; i < l; i += 3 ) {\r\n\r\n\t\t\t\t\ta = indices[ i ];\r\n\t\t\t\t\tb = indices[ i + 1 ];\r\n\t\t\t\t\tc = indices[ i + 2 ];\r\n\r\n\t\t\t\t\tintersection = checkBufferGeometryIntersection( this, raycaster, ray, positions, uvs, a, b, c );\r\n\r\n\t\t\t\t\tif ( intersection ) {\r\n\r\n\t\t\t\t\t\tintersection.faceIndex = Math.floor( i / 3 ); // triangle number in indices buffer semantics\r\n\t\t\t\t\t\tintersects.push( intersection );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\r\n\t\t\t\tfor ( var i = 0, l = positions.length; i < l; i += 9 ) {\r\n\r\n\t\t\t\t\ta = i / 3;\r\n\t\t\t\t\tb = a + 1;\r\n\t\t\t\t\tc = a + 2;\r\n\r\n\t\t\t\t\tintersection = checkBufferGeometryIntersection( this, raycaster, ray, positions, uvs, a, b, c );\r\n\r\n\t\t\t\t\tif ( intersection ) {\r\n\r\n\t\t\t\t\t\tintersection.index = a; // triangle number in positions buffer semantics\r\n\t\t\t\t\t\tintersects.push( intersection );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( geometry instanceof THREE.Geometry ) {\r\n\r\n\t\t\tvar fvA, fvB, fvC;\r\n\t\t\tvar isFaceMaterial = material instanceof THREE.MeshFaceMaterial;\r\n\t\t\tvar materials = isFaceMaterial === true ? material.materials : null;\r\n\r\n\t\t\tvar vertices = geometry.vertices;\r\n\t\t\tvar faces = geometry.faces;\r\n\t\t\tvar faceVertexUvs = geometry.faceVertexUvs[ 0 ];\r\n\t\t\tif ( faceVertexUvs.length > 0 ) uvs = faceVertexUvs;\r\n\r\n\t\t\tfor ( var f = 0, fl = faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\tvar face = faces[ f ];\r\n\t\t\t\tvar faceMaterial = isFaceMaterial === true ? materials[ face.materialIndex ] : material;\r\n\r\n\t\t\t\tif ( faceMaterial === undefined ) continue;\r\n\r\n\t\t\t\tfvA = vertices[ face.a ];\r\n\t\t\t\tfvB = vertices[ face.b ];\r\n\t\t\t\tfvC = vertices[ face.c ];\r\n\r\n\t\t\t\tif ( faceMaterial.morphTargets === true ) {\r\n\r\n\t\t\t\t\tvar morphTargets = geometry.morphTargets;\r\n\t\t\t\t\tvar morphInfluences = this.morphTargetInfluences;\r\n\r\n\t\t\t\t\tvA.set( 0, 0, 0 );\r\n\t\t\t\t\tvB.set( 0, 0, 0 );\r\n\t\t\t\t\tvC.set( 0, 0, 0 );\r\n\r\n\t\t\t\t\tfor ( var t = 0, tl = morphTargets.length; t < tl; t ++ ) {\r\n\r\n\t\t\t\t\t\tvar influence = morphInfluences[ t ];\r\n\r\n\t\t\t\t\t\tif ( influence === 0 ) continue;\r\n\r\n\t\t\t\t\t\tvar targets = morphTargets[ t ].vertices;\r\n\r\n\t\t\t\t\t\tvA.addScaledVector( tempA.subVectors( targets[ face.a ], fvA ), influence );\r\n\t\t\t\t\t\tvB.addScaledVector( tempB.subVectors( targets[ face.b ], fvB ), influence );\r\n\t\t\t\t\t\tvC.addScaledVector( tempC.subVectors( targets[ face.c ], fvC ), influence );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvA.add( fvA );\r\n\t\t\t\t\tvB.add( fvB );\r\n\t\t\t\t\tvC.add( fvC );\r\n\r\n\t\t\t\t\tfvA = vA;\r\n\t\t\t\t\tfvB = vB;\r\n\t\t\t\t\tfvC = vC;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tintersection = checkIntersection( this, raycaster, ray, fvA, fvB, fvC, intersectionPoint );\r\n\r\n\t\t\t\tif ( intersection ) {\r\n\r\n\t\t\t\t\tif ( uvs ) {\r\n\r\n\t\t\t\t\t\tvar uvs_f = uvs[ f ];\r\n\t\t\t\t\t\tuvA.copy( uvs_f[ 0 ] );\r\n\t\t\t\t\t\tuvB.copy( uvs_f[ 1 ] );\r\n\t\t\t\t\t\tuvC.copy( uvs_f[ 2 ] );\r\n\r\n\t\t\t\t\t\tintersection.uv = uvIntersection( intersectionPoint, fvA, fvB, fvC, uvA, uvB, uvC );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tintersection.face = face;\r\n\t\t\t\t\tintersection.faceIndex = f;\r\n\t\t\t\t\tintersects.push( intersection );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n}() );\r\n\r\nTHREE.Mesh.prototype.clone = function () {\r\n\r\n\treturn new this.constructor( this.geometry, this.material ).copy( this );\r\n\r\n};\r\n\r\n// File:src/objects/Bone.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author ikerr / http://verold.com\r\n */\r\n\r\nTHREE.Bone = function ( skin ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'Bone';\r\n\r\n\tthis.skin = skin;\r\n\r\n};\r\n\r\nTHREE.Bone.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.Bone.prototype.constructor = THREE.Bone;\r\n\r\nTHREE.Bone.prototype.copy = function ( source ) {\r\n\t\r\n\tTHREE.Object3D.prototype.copy.call( this, source );\r\n\t\r\n\tthis.skin = source.skin;\r\n\t\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/objects/Skeleton.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author michael guerrero / http://realitymeltdown.com\r\n * @author ikerr / http://verold.com\r\n */\r\n\r\nTHREE.Skeleton = function ( bones, boneInverses, useVertexTexture ) {\r\n\r\n\tthis.useVertexTexture = useVertexTexture !== undefined ? useVertexTexture : true;\r\n\r\n\tthis.identityMatrix = new THREE.Matrix4();\r\n\r\n\t// copy the bone array\r\n\r\n\tbones = bones || [];\r\n\r\n\tthis.bones = bones.slice( 0 );\r\n\r\n\t// create a bone texture or an array of floats\r\n\r\n\tif ( this.useVertexTexture ) {\r\n\r\n\t\t// layout (1 matrix = 4 pixels)\r\n\t\t//      RGBA RGBA RGBA RGBA (=> column1, column2, column3, column4)\r\n\t\t//  with  8x8  pixel texture max   16 bones * 4 pixels =  (8 * 8)\r\n\t\t//       16x16 pixel texture max   64 bones * 4 pixels = (16 * 16)\r\n\t\t//       32x32 pixel texture max  256 bones * 4 pixels = (32 * 32)\r\n\t\t//       64x64 pixel texture max 1024 bones * 4 pixels = (64 * 64)\r\n\r\n\t\t\r\n\t\tvar size = Math.sqrt( this.bones.length * 4 ); // 4 pixels needed for 1 matrix\r\n\t\tsize = THREE.Math.nextPowerOfTwo( Math.ceil( size ) );\r\n\t\tsize = Math.max( size, 4 );\r\n\r\n\t\tthis.boneTextureWidth = size;\r\n\t\tthis.boneTextureHeight = size;\r\n\r\n\t\tthis.boneMatrices = new Float32Array( this.boneTextureWidth * this.boneTextureHeight * 4 ); // 4 floats per RGBA pixel\r\n\t\tthis.boneTexture = new THREE.DataTexture( this.boneMatrices, this.boneTextureWidth, this.boneTextureHeight, THREE.RGBAFormat, THREE.FloatType );\r\n\r\n\t} else {\r\n\r\n\t\tthis.boneMatrices = new Float32Array( 16 * this.bones.length );\r\n\r\n\t}\r\n\r\n\t// use the supplied bone inverses or calculate the inverses\r\n\r\n\tif ( boneInverses === undefined ) {\r\n\r\n\t\tthis.calculateInverses();\r\n\r\n\t} else {\r\n\r\n\t\tif ( this.bones.length === boneInverses.length ) {\r\n\r\n\t\t\tthis.boneInverses = boneInverses.slice( 0 );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tconsole.warn( 'THREE.Skeleton bonInverses is the wrong length.' );\r\n\r\n\t\t\tthis.boneInverses = [];\r\n\r\n\t\t\tfor ( var b = 0, bl = this.bones.length; b < bl; b ++ ) {\r\n\r\n\t\t\t\tthis.boneInverses.push( new THREE.Matrix4() );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.Skeleton.prototype.calculateInverses = function () {\r\n\r\n\tthis.boneInverses = [];\r\n\r\n\tfor ( var b = 0, bl = this.bones.length; b < bl; b ++ ) {\r\n\r\n\t\tvar inverse = new THREE.Matrix4();\r\n\r\n\t\tif ( this.bones[ b ] ) {\r\n\r\n\t\t\tinverse.getInverse( this.bones[ b ].matrixWorld );\r\n\r\n\t\t}\r\n\r\n\t\tthis.boneInverses.push( inverse );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.Skeleton.prototype.pose = function () {\r\n\r\n\tvar bone;\r\n\r\n\t// recover the bind-time world matrices\r\n\r\n\tfor ( var b = 0, bl = this.bones.length; b < bl; b ++ ) {\r\n\r\n\t\tbone = this.bones[ b ];\r\n\r\n\t\tif ( bone ) {\r\n\r\n\t\t\tbone.matrixWorld.getInverse( this.boneInverses[ b ] );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// compute the local matrices, positions, rotations and scales\r\n\r\n\tfor ( var b = 0, bl = this.bones.length; b < bl; b ++ ) {\r\n\r\n\t\tbone = this.bones[ b ];\r\n\r\n\t\tif ( bone ) {\r\n\r\n\t\t\tif ( bone.parent ) {\r\n\r\n\t\t\t\tbone.matrix.getInverse( bone.parent.matrixWorld );\r\n\t\t\t\tbone.matrix.multiply( bone.matrixWorld );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tbone.matrix.copy( bone.matrixWorld );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tbone.matrix.decompose( bone.position, bone.quaternion, bone.scale );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.Skeleton.prototype.update = ( function () {\r\n\r\n\tvar offsetMatrix = new THREE.Matrix4();\r\n\r\n\treturn function update() {\r\n\r\n\t\t// flatten bone matrices to array\r\n\r\n\t\tfor ( var b = 0, bl = this.bones.length; b < bl; b ++ ) {\r\n\r\n\t\t\t// compute the offset between the current and the original transform\r\n\r\n\t\t\tvar matrix = this.bones[ b ] ? this.bones[ b ].matrixWorld : this.identityMatrix;\r\n\r\n\t\t\toffsetMatrix.multiplyMatrices( matrix, this.boneInverses[ b ] );\r\n\t\t\toffsetMatrix.flattenToArrayOffset( this.boneMatrices, b * 16 );\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.useVertexTexture ) {\r\n\r\n\t\t\tthis.boneTexture.needsUpdate = true;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n} )();\r\n\r\nTHREE.Skeleton.prototype.clone = function () {\r\n\r\n\treturn new THREE.Skeleton( this.bones, this.boneInverses, this.useVertexTexture );\r\n\r\n};\r\n\r\n// File:src/objects/SkinnedMesh.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author ikerr / http://verold.com\r\n */\r\n\r\nTHREE.SkinnedMesh = function ( geometry, material, useVertexTexture ) {\r\n\r\n\tTHREE.Mesh.call( this, geometry, material );\r\n\r\n\tthis.type = 'SkinnedMesh';\r\n\r\n\tthis.bindMode = \"attached\";\r\n\tthis.bindMatrix = new THREE.Matrix4();\r\n\tthis.bindMatrixInverse = new THREE.Matrix4();\r\n\r\n\t// init bones\r\n\r\n\t// TODO: remove bone creation as there is no reason (other than\r\n\t// convenience) for THREE.SkinnedMesh to do this.\r\n\r\n\tvar bones = [];\r\n\r\n\tif ( this.geometry && this.geometry.bones !== undefined ) {\r\n\r\n\t\tvar bone, gbone;\r\n\r\n\t\tfor ( var b = 0, bl = this.geometry.bones.length; b < bl; ++ b ) {\r\n\r\n\t\t\tgbone = this.geometry.bones[ b ];\r\n\r\n\t\t\tbone = new THREE.Bone( this );\r\n\t\t\tbones.push( bone );\r\n\r\n\t\t\tbone.name = gbone.name;\r\n\t\t\tbone.position.fromArray( gbone.pos );\r\n\t\t\tbone.quaternion.fromArray( gbone.rotq );\r\n\t\t\tif ( gbone.scl !== undefined ) bone.scale.fromArray( gbone.scl );\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var b = 0, bl = this.geometry.bones.length; b < bl; ++ b ) {\r\n\r\n\t\t\tgbone = this.geometry.bones[ b ];\r\n\r\n\t\t\tif ( gbone.parent !== - 1 && gbone.parent !== null) {\r\n\r\n\t\t\t\tbones[ gbone.parent ].add( bones[ b ] );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.add( bones[ b ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.normalizeSkinWeights();\r\n\r\n\tthis.updateMatrixWorld( true );\r\n\tthis.bind( new THREE.Skeleton( bones, undefined, useVertexTexture ), this.matrixWorld );\r\n\r\n};\r\n\r\n\r\nTHREE.SkinnedMesh.prototype = Object.create( THREE.Mesh.prototype );\r\nTHREE.SkinnedMesh.prototype.constructor = THREE.SkinnedMesh;\r\n\r\nTHREE.SkinnedMesh.prototype.bind = function( skeleton, bindMatrix ) {\r\n\r\n\tthis.skeleton = skeleton;\r\n\r\n\tif ( bindMatrix === undefined ) {\r\n\r\n\t\tthis.updateMatrixWorld( true );\r\n\t\t\r\n\t\tthis.skeleton.calculateInverses();\r\n\r\n\t\tbindMatrix = this.matrixWorld;\r\n\r\n\t}\r\n\r\n\tthis.bindMatrix.copy( bindMatrix );\r\n\tthis.bindMatrixInverse.getInverse( bindMatrix );\r\n\r\n};\r\n\r\nTHREE.SkinnedMesh.prototype.pose = function () {\r\n\r\n\tthis.skeleton.pose();\r\n\r\n};\r\n\r\nTHREE.SkinnedMesh.prototype.normalizeSkinWeights = function () {\r\n\r\n\tif ( this.geometry instanceof THREE.Geometry ) {\r\n\r\n\t\tfor ( var i = 0; i < this.geometry.skinIndices.length; i ++ ) {\r\n\r\n\t\t\tvar sw = this.geometry.skinWeights[ i ];\r\n\r\n\t\t\tvar scale = 1.0 / sw.lengthManhattan();\r\n\r\n\t\t\tif ( scale !== Infinity ) {\r\n\r\n\t\t\t\tsw.multiplyScalar( scale );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tsw.set( 1 ); // this will be normalized by the shader anyway\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t} else {\r\n\r\n\t\t// skinning weights assumed to be normalized for THREE.BufferGeometry\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.SkinnedMesh.prototype.updateMatrixWorld = function( force ) {\r\n\r\n\tTHREE.Mesh.prototype.updateMatrixWorld.call( this, true );\r\n\r\n\tif ( this.bindMode === \"attached\" ) {\r\n\r\n\t\tthis.bindMatrixInverse.getInverse( this.matrixWorld );\r\n\r\n\t} else if ( this.bindMode === \"detached\" ) {\r\n\r\n\t\tthis.bindMatrixInverse.getInverse( this.bindMatrix );\r\n\r\n\t} else {\r\n\r\n\t\tconsole.warn( 'THREE.SkinnedMesh unrecognized bindMode: ' + this.bindMode );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.SkinnedMesh.prototype.clone = function() {\r\n\r\n\treturn new this.constructor( this.geometry, this.material, this.useVertexTexture ).copy( this );\r\n\r\n};\r\n\r\n// File:src/objects/LOD.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.LOD = function () {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'LOD';\r\n\r\n\tObject.defineProperties( this, {\r\n\t\tlevels: {\r\n\t\t\tenumerable: true,\r\n\t\t\tvalue: []\r\n\t\t},\r\n\t\tobjects: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.LOD: .objects has been renamed to .levels.' );\r\n\t\t\t\treturn this.levels;\r\n\r\n\t\t\t}\r\n\t\t}\r\n\t} );\r\n\r\n};\r\n\r\n\r\nTHREE.LOD.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.LOD.prototype.constructor = THREE.LOD;\r\n\r\nTHREE.LOD.prototype.addLevel = function ( object, distance ) {\r\n\r\n\tif ( distance === undefined ) distance = 0;\r\n\r\n\tdistance = Math.abs( distance );\r\n\r\n\tvar levels = this.levels;\r\n\r\n\tfor ( var l = 0; l < levels.length; l ++ ) {\r\n\r\n\t\tif ( distance < levels[ l ].distance ) {\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tlevels.splice( l, 0, { distance: distance, object: object } );\r\n\r\n\tthis.add( object );\r\n\r\n};\r\n\r\nTHREE.LOD.prototype.getObjectForDistance = function ( distance ) {\r\n\r\n\tvar levels = this.levels;\r\n\r\n\tfor ( var i = 1, l = levels.length; i < l; i ++ ) {\r\n\r\n\t\tif ( distance < levels[ i ].distance ) {\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\treturn levels[ i - 1 ].object;\r\n\r\n};\r\n\r\nTHREE.LOD.prototype.raycast = ( function () {\r\n\r\n\tvar matrixPosition = new THREE.Vector3();\r\n\r\n\treturn function raycast( raycaster, intersects ) {\r\n\r\n\t\tmatrixPosition.setFromMatrixPosition( this.matrixWorld );\r\n\r\n\t\tvar distance = raycaster.ray.origin.distanceTo( matrixPosition );\r\n\r\n\t\tthis.getObjectForDistance( distance ).raycast( raycaster, intersects );\r\n\r\n\t};\r\n\r\n}() );\r\n\r\nTHREE.LOD.prototype.update = function () {\r\n\r\n\tvar v1 = new THREE.Vector3();\r\n\tvar v2 = new THREE.Vector3();\r\n\r\n\treturn function update( camera ) {\r\n\r\n\t\tvar levels = this.levels;\r\n\r\n\t\tif ( levels.length > 1 ) {\r\n\r\n\t\t\tv1.setFromMatrixPosition( camera.matrixWorld );\r\n\t\t\tv2.setFromMatrixPosition( this.matrixWorld );\r\n\r\n\t\t\tvar distance = v1.distanceTo( v2 );\r\n\r\n\t\t\tlevels[ 0 ].object.visible = true;\r\n\r\n\t\t\tfor ( var i = 1, l = levels.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tif ( distance >= levels[ i ].distance ) {\r\n\r\n\t\t\t\t\tlevels[ i - 1 ].object.visible = false;\r\n\t\t\t\t\tlevels[ i ].object.visible = true;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( ; i < l; i ++ ) {\r\n\r\n\t\t\t\tlevels[ i ].object.visible = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n}();\r\n\r\nTHREE.LOD.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Object3D.prototype.copy.call( this, source, false );\r\n\r\n\tvar levels = source.levels;\r\n\r\n\tfor ( var i = 0, l = levels.length; i < l; i ++ ) {\r\n\r\n\t\tvar level = levels[ i ];\r\n\r\n\t\tthis.addLevel( level.object.clone(), level.distance );\r\n\r\n\t}\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nTHREE.LOD.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = THREE.Object3D.prototype.toJSON.call( this, meta );\r\n\r\n\tdata.object.levels = [];\r\n\r\n\tvar levels = this.levels;\r\n\r\n\tfor ( var i = 0, l = levels.length; i < l; i ++ ) {\r\n\r\n\t\tvar level = levels[ i ];\r\n\r\n\t\tdata.object.levels.push( {\r\n\t\t\tobject: level.object.uuid,\r\n\t\t\tdistance: level.distance\r\n\t\t} );\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\n// File:src/objects/Sprite.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Sprite = ( function () {\r\n\r\n\tvar indices = new Uint16Array( [ 0, 1, 2,  0, 2, 3 ] );\r\n\tvar vertices = new Float32Array( [ - 0.5, - 0.5, 0,   0.5, - 0.5, 0,   0.5, 0.5, 0,   - 0.5, 0.5, 0 ] );\r\n\tvar uvs = new Float32Array( [ 0, 0,   1, 0,   1, 1,   0, 1 ] );\r\n\r\n\tvar geometry = new THREE.BufferGeometry();\r\n\tgeometry.setIndex( new THREE.BufferAttribute( indices, 1 ) );\r\n\tgeometry.addAttribute( 'position', new THREE.BufferAttribute( vertices, 3 ) );\r\n\tgeometry.addAttribute( 'uv', new THREE.BufferAttribute( uvs, 2 ) );\r\n\r\n\treturn function Sprite( material ) {\r\n\r\n\t\tTHREE.Object3D.call( this );\r\n\r\n\t\tthis.type = 'Sprite';\r\n\r\n\t\tthis.geometry = geometry;\r\n\t\tthis.material = ( material !== undefined ) ? material : new THREE.SpriteMaterial();\r\n\r\n\t};\r\n\r\n} )();\r\n\r\nTHREE.Sprite.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.Sprite.prototype.constructor = THREE.Sprite;\r\n\r\nTHREE.Sprite.prototype.raycast = ( function () {\r\n\r\n\tvar matrixPosition = new THREE.Vector3();\r\n\r\n\treturn function raycast( raycaster, intersects ) {\r\n\r\n\t\tmatrixPosition.setFromMatrixPosition( this.matrixWorld );\r\n\r\n\t\tvar distanceSq = raycaster.ray.distanceSqToPoint( matrixPosition );\r\n\t\tvar guessSizeSq = this.scale.x * this.scale.y;\r\n\r\n\t\tif ( distanceSq > guessSizeSq ) {\r\n\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tintersects.push( {\r\n\r\n\t\t\tdistance: Math.sqrt( distanceSq ),\r\n\t\t\tpoint: this.position,\r\n\t\t\tface: null,\r\n\t\t\tobject: this\r\n\r\n\t\t} );\r\n\r\n\t};\r\n\r\n}() );\r\n\r\nTHREE.Sprite.prototype.clone = function () {\r\n\r\n\treturn new this.constructor( this.material ).copy( this );\r\n\r\n};\r\n\r\n// Backwards compatibility\r\n\r\nTHREE.Particle = THREE.Sprite;\r\n\r\n// File:src/objects/LensFlare.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.LensFlare = function ( texture, size, distance, blending, color ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.lensFlares = [];\r\n\r\n\tthis.positionScreen = new THREE.Vector3();\r\n\tthis.customUpdateCallback = undefined;\r\n\r\n\tif ( texture !== undefined ) {\r\n\r\n\t\tthis.add( texture, size, distance, blending, color );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.LensFlare.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.LensFlare.prototype.constructor = THREE.LensFlare;\r\n\r\n\r\n/*\r\n * Add: adds another flare\r\n */\r\n\r\nTHREE.LensFlare.prototype.add = function ( texture, size, distance, blending, color, opacity ) {\r\n\r\n\tif ( size === undefined ) size = - 1;\r\n\tif ( distance === undefined ) distance = 0;\r\n\tif ( opacity === undefined ) opacity = 1;\r\n\tif ( color === undefined ) color = new THREE.Color( 0xffffff );\r\n\tif ( blending === undefined ) blending = THREE.NormalBlending;\r\n\r\n\tdistance = Math.min( distance, Math.max( 0, distance ) );\r\n\r\n\tthis.lensFlares.push( {\r\n\t\ttexture: texture,\t// THREE.Texture\r\n\t\tsize: size, \t\t// size in pixels (-1 = use texture.width)\r\n\t\tdistance: distance, \t// distance (0-1) from light source (0=at light source)\r\n\t\tx: 0, y: 0, z: 0,\t// screen position (-1 => 1) z = 0 is in front z = 1 is back\r\n\t\tscale: 1, \t\t// scale\r\n\t\trotation: 0, \t\t// rotation\r\n\t\topacity: opacity,\t// opacity\r\n\t\tcolor: color,\t\t// color\r\n\t\tblending: blending\t// blending\r\n\t} );\r\n\r\n};\r\n\r\n/*\r\n * Update lens flares update positions on all flares based on the screen position\r\n * Set myLensFlare.customUpdateCallback to alter the flares in your project specific way.\r\n */\r\n\r\nTHREE.LensFlare.prototype.updateLensFlares = function () {\r\n\r\n\tvar f, fl = this.lensFlares.length;\r\n\tvar flare;\r\n\tvar vecX = - this.positionScreen.x * 2;\r\n\tvar vecY = - this.positionScreen.y * 2;\r\n\r\n\tfor ( f = 0; f < fl; f ++ ) {\r\n\r\n\t\tflare = this.lensFlares[ f ];\r\n\r\n\t\tflare.x = this.positionScreen.x + vecX * flare.distance;\r\n\t\tflare.y = this.positionScreen.y + vecY * flare.distance;\r\n\r\n\t\tflare.wantedRotation = flare.x * Math.PI * 0.25;\r\n\t\tflare.rotation += ( flare.wantedRotation - flare.rotation ) * 0.25;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.LensFlare.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Object3D.prototype.copy.call( this, source );\r\n\r\n\tthis.positionScreen.copy( source.positionScreen );\r\n\tthis.customUpdateCallback = source.customUpdateCallback;\r\n\r\n\tfor ( var i = 0, l = source.lensFlares.length; i < l; i ++ ) {\r\n\r\n\t\tthis.lensFlares.push( source.lensFlares[ i ] );\r\n\r\n\t}\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/scenes/Scene.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Scene = function () {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'Scene';\r\n\r\n\tthis.fog = null;\r\n\tthis.overrideMaterial = null;\r\n\r\n\tthis.autoUpdate = true; // checked by the renderer\r\n\r\n};\r\n\r\nTHREE.Scene.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.Scene.prototype.constructor = THREE.Scene;\r\n\r\nTHREE.Scene.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Object3D.prototype.copy.call( this, source );\r\n\r\n\tif ( source.fog !== null ) this.fog = source.fog.clone();\r\n\tif ( source.overrideMaterial !== null ) this.overrideMaterial = source.overrideMaterial.clone();\r\n\r\n\tthis.autoUpdate = source.autoUpdate;\r\n\tthis.matrixAutoUpdate = source.matrixAutoUpdate;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/scenes/Fog.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Fog = function ( color, near, far ) {\r\n\r\n\tthis.name = '';\r\n\r\n\tthis.color = new THREE.Color( color );\r\n\r\n\tthis.near = ( near !== undefined ) ? near : 1;\r\n\tthis.far = ( far !== undefined ) ? far : 1000;\r\n\r\n};\r\n\r\nTHREE.Fog.prototype.clone = function () {\r\n\r\n\treturn new THREE.Fog( this.color.getHex(), this.near, this.far );\r\n\r\n};\r\n\r\n// File:src/scenes/FogExp2.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.FogExp2 = function ( color, density ) {\r\n\r\n\tthis.name = '';\r\n\r\n\tthis.color = new THREE.Color( color );\r\n\tthis.density = ( density !== undefined ) ? density : 0.00025;\r\n\r\n};\r\n\r\nTHREE.FogExp2.prototype.clone = function () {\r\n\r\n\treturn new THREE.FogExp2( this.color.getHex(), this.density );\r\n\r\n};\r\n\r\n// File:src/renderers/shaders/ShaderChunk.js\r\n\r\nTHREE.ShaderChunk = {};\r\n\r\n// File:src/renderers/shaders/ShaderChunk/alphamap_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'alphamap_fragment'] = \"#ifdef USE_ALPHAMAP\\n\\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/alphamap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'alphamap_pars_fragment'] = \"#ifdef USE_ALPHAMAP\\n\\n\tuniform sampler2D alphaMap;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/alphatest_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'alphatest_fragment'] = \"#ifdef ALPHATEST\\n\\n\tif ( diffuseColor.a < ALPHATEST ) discard;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/aomap_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'aomap_fragment'] = \"#ifdef USE_AOMAP\\n\\n\ttotalAmbientLight *= ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/aomap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'aomap_pars_fragment'] = \"#ifdef USE_AOMAP\\n\\n\tuniform sampler2D aoMap;\\n\tuniform float aoMapIntensity;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/begin_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'begin_vertex'] = \"\\nvec3 transformed = vec3( position );\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/beginnormal_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'beginnormal_vertex'] = \"\\nvec3 objectNormal = vec3( normal );\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/bumpmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'bumpmap_pars_fragment'] = \"#ifdef USE_BUMPMAP\\n\\n\tuniform sampler2D bumpMap;\\n\tuniform float bumpScale;\\n\\n\\n\\n\tvec2 dHdxy_fwd() {\\n\\n\t\tvec2 dSTdx = dFdx( vUv );\\n\t\tvec2 dSTdy = dFdy( vUv );\\n\\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\\n\\n\t\treturn vec2( dBx, dBy );\\n\\n\t}\\n\\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\\n\\n\t\tvec3 vSigmaX = dFdx( surf_pos );\\n\t\tvec3 vSigmaY = dFdy( surf_pos );\\n\t\tvec3 vN = surf_norm;\\n\t\tvec3 R1 = cross( vSigmaY, vN );\\n\t\tvec3 R2 = cross( vN, vSigmaX );\\n\\n\t\tfloat fDet = dot( vSigmaX, R1 );\\n\\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\\n\\n\t}\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/color_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'color_fragment'] = \"#ifdef USE_COLOR\\n\\n\tdiffuseColor.rgb *= vColor;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/color_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'color_pars_fragment'] = \"#ifdef USE_COLOR\\n\\n\tvarying vec3 vColor;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/color_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'color_pars_vertex'] = \"#ifdef USE_COLOR\\n\\n\tvarying vec3 vColor;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/color_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'color_vertex'] = \"#ifdef USE_COLOR\\n\\n\tvColor.xyz = color.xyz;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/common.glsl\r\n\r\nTHREE.ShaderChunk[ 'common'] = \"#define PI 3.14159\\n#define PI2 6.28318\\n#define RECIPROCAL_PI2 0.15915494\\n#define LOG2 1.442695\\n#define EPSILON 1e-6\\n\\n#define saturate(a) clamp( a, 0.0, 1.0 )\\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\\n\\nvec3 transformDirection( in vec3 normal, in mat4 matrix ) {\\n\\n\treturn normalize( ( matrix * vec4( normal, 0.0 ) ).xyz );\\n\\n}\\n\\nvec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {\\n\\n\treturn normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );\\n\\n}\\n\\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\\n\\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\\n\\n\treturn - distance * planeNormal + point;\\n\\n}\\n\\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\\n\\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\\n\\n}\\n\\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\\n\\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\\n\\n}\\n\\nfloat calcLightAttenuation( float lightDistance, float cutoffDistance, float decayExponent ) {\\n\\n\tif ( decayExponent > 0.0 ) {\\n\\n\t  return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\\n\\n\t}\\n\\n\treturn 1.0;\\n\\n}\\n\\nvec3 F_Schlick( in vec3 specularColor, in float dotLH ) {\\n\\n\\n\tfloat fresnel = exp2( ( -5.55437 * dotLH - 6.98316 ) * dotLH );\\n\\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\\n\\n}\\n\\nfloat G_BlinnPhong_Implicit( /* in float dotNL, in float dotNV */ ) {\\n\\n\\n\treturn 0.25;\\n\\n}\\n\\nfloat D_BlinnPhong( in float shininess, in float dotNH ) {\\n\\n\\n\treturn ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\\n\\n}\\n\\nvec3 BRDF_BlinnPhong( in vec3 specularColor, in float shininess, in vec3 normal, in vec3 lightDir, in vec3 viewDir ) {\\n\\n\tvec3 halfDir = normalize( lightDir + viewDir );\\n\\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\\n\tfloat dotLH = saturate( dot( lightDir, halfDir ) );\\n\\n\tvec3 F = F_Schlick( specularColor, dotLH );\\n\\n\tfloat G = G_BlinnPhong_Implicit( /* dotNL, dotNV */ );\\n\\n\tfloat D = D_BlinnPhong( shininess, dotNH );\\n\\n\treturn F * G * D;\\n\\n}\\n\\nvec3 inputToLinear( in vec3 a ) {\\n\\n\t#ifdef GAMMA_INPUT\\n\\n\t\treturn pow( a, vec3( float( GAMMA_FACTOR ) ) );\\n\\n\t#else\\n\\n\t\treturn a;\\n\\n\t#endif\\n\\n}\\n\\nvec3 linearToOutput( in vec3 a ) {\\n\\n\t#ifdef GAMMA_OUTPUT\\n\\n\t\treturn pow( a, vec3( 1.0 / float( GAMMA_FACTOR ) ) );\\n\\n\t#else\\n\\n\t\treturn a;\\n\\n\t#endif\\n\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/defaultnormal_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'defaultnormal_vertex'] = \"#ifdef FLIP_SIDED\\n\\n\tobjectNormal = -objectNormal;\\n\\n#endif\\n\\nvec3 transformedNormal = normalMatrix * objectNormal;\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/displacementmap_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'displacementmap_vertex'] = \"#ifdef USE_DISPLACEMENTMAP\\n\\n\ttransformed += normal * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/displacementmap_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'displacementmap_pars_vertex'] = \"#ifdef USE_DISPLACEMENTMAP\\n\\n\tuniform sampler2D displacementMap;\\n\tuniform float displacementScale;\\n\tuniform float displacementBias;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/emissivemap_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'emissivemap_fragment'] = \"#ifdef USE_EMISSIVEMAP\\n\\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\\n\\n\temissiveColor.rgb = inputToLinear( emissiveColor.rgb );\\n\\n\ttotalEmissiveLight *= emissiveColor.rgb;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/emissivemap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'emissivemap_pars_fragment'] = \"#ifdef USE_EMISSIVEMAP\\n\\n\tuniform sampler2D emissiveMap;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/envmap_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'envmap_fragment'] = \"#ifdef USE_ENVMAP\\n\\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\\n\\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\\n\\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\\n\\n\t\t#ifdef ENVMAP_MODE_REFLECTION\\n\\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\\n\\n\t\t#else\\n\\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\\n\\n\t\t#endif\\n\\n\t#else\\n\\n\t\tvec3 reflectVec = vReflect;\\n\\n\t#endif\\n\\n\t#ifdef DOUBLE_SIDED\\n\t\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\\n\t#else\\n\t\tfloat flipNormal = 1.0;\\n\t#endif\\n\\n\t#ifdef ENVMAP_TYPE_CUBE\\n\t\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\\n\\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\\n\t\tvec2 sampleUV;\\n\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\\n\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\\n\\n\t#elif defined( ENVMAP_TYPE_SPHERE )\\n\t\tvec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\\n\t#endif\\n\\n\tenvColor.xyz = inputToLinear( envColor.xyz );\\n\\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\\n\\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\\n\\n\t#elif defined( ENVMAP_BLENDING_MIX )\\n\\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\\n\\n\t#elif defined( ENVMAP_BLENDING_ADD )\\n\\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\\n\\n\t#endif\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/envmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'envmap_pars_fragment'] = \"#ifdef USE_ENVMAP\\n\\n\tuniform float reflectivity;\\n\t#ifdef ENVMAP_TYPE_CUBE\\n\t\tuniform samplerCube envMap;\\n\t#else\\n\t\tuniform sampler2D envMap;\\n\t#endif\\n\tuniform float flipEnvMap;\\n\\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\\n\\n\t\tuniform float refractionRatio;\\n\\n\t#else\\n\\n\t\tvarying vec3 vReflect;\\n\\n\t#endif\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/envmap_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'envmap_pars_vertex'] = \"#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\\n\\n\tvarying vec3 vReflect;\\n\\n\tuniform float refractionRatio;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/envmap_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'envmap_vertex'] = \"#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\\n\\n\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\\n\\n\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\\n\\n\t#ifdef ENVMAP_MODE_REFLECTION\\n\\n\t\tvReflect = reflect( cameraToVertex, worldNormal );\\n\\n\t#else\\n\\n\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\\n\\n\t#endif\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/fog_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'fog_fragment'] = \"#ifdef USE_FOG\\n\\n\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\\n\\n\t#else\\n\\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\\n\\n\t#endif\\n\\n\t#ifdef FOG_EXP2\\n\\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * depth * depth * LOG2 ) );\\n\\n\t#else\\n\\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, depth );\\n\\n\t#endif\\n\t\\n\toutgoingLight = mix( outgoingLight, fogColor, fogFactor );\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/fog_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'fog_pars_fragment'] = \"#ifdef USE_FOG\\n\\n\tuniform vec3 fogColor;\\n\\n\t#ifdef FOG_EXP2\\n\\n\t\tuniform float fogDensity;\\n\\n\t#else\\n\\n\t\tuniform float fogNear;\\n\t\tuniform float fogFar;\\n\t#endif\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/hemilight_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'hemilight_fragment'] = \"#if MAX_HEMI_LIGHTS > 0\\n\\n\tfor ( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\\n\\n\t\tvec3 lightDir = hemisphereLightDirection[ i ];\\n\\n\t\tfloat dotProduct = dot( normal, lightDir );\\n\\n\t\tfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\\n\\n\t\tvec3 lightColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\\n\\n\t\ttotalAmbientLight += lightColor;\\n\\n\t}\\n\\n#endif\\n\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lightmap_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'lightmap_fragment'] = \"#ifdef USE_LIGHTMAP\\n\\n\ttotalAmbientLight += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lightmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'lightmap_pars_fragment'] = \"#ifdef USE_LIGHTMAP\\n\\n\tuniform sampler2D lightMap;\\n\tuniform float lightMapIntensity;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_lambert_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'lights_lambert_pars_vertex'] = \"#if MAX_DIR_LIGHTS > 0\\n\\n\tuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\\n\tuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_HEMI_LIGHTS > 0\\n\\n\tuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\\n\tuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\\n\tuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_POINT_LIGHTS > 0\\n\\n\tuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\\n\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\\n\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\\n\tuniform float pointLightDecay[ MAX_POINT_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0\\n\\n\tuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\\n\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\\n\tuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_lambert_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'lights_lambert_vertex'] = \"vLightFront = vec3( 0.0 );\\n\\n#ifdef DOUBLE_SIDED\\n\\n\tvLightBack = vec3( 0.0 );\\n\\n#endif\\n\\nvec3 normal = normalize( transformedNormal );\\n\\n#if MAX_POINT_LIGHTS > 0\\n\\n\tfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\\n\\n\t\tvec3 lightColor = pointLightColor[ i ];\\n\\n\t\tvec3 lVector = pointLightPosition[ i ] - mvPosition.xyz;\\n\t\tvec3 lightDir = normalize( lVector );\\n\\n\\n\t\tfloat attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\\n\\n\\n\t\tfloat dotProduct = dot( normal, lightDir );\\n\\n\t\tvLightFront += lightColor * attenuation * saturate( dotProduct );\\n\\n\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\tvLightBack += lightColor * attenuation * saturate( - dotProduct );\\n\\n\t\t#endif\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0\\n\\n\tfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\\n\\n\t\tvec3 lightColor = spotLightColor[ i ];\\n\\n\t\tvec3 lightPosition = spotLightPosition[ i ];\\n\t\tvec3 lVector = lightPosition - mvPosition.xyz;\\n\t\tvec3 lightDir = normalize( lVector );\\n\\n\t\tfloat spotEffect = dot( spotLightDirection[ i ], lightDir );\\n\\n\t\tif ( spotEffect > spotLightAngleCos[ i ] ) {\\n\\n\t\t\tspotEffect = saturate( pow( saturate( spotEffect ), spotLightExponent[ i ] ) );\\n\\n\\n\t\t\tfloat attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\\n\\n\t\t\tattenuation *= spotEffect;\\n\\n\\n\t\t\tfloat dotProduct = dot( normal, lightDir );\\n\\n\t\t\tvLightFront += lightColor * attenuation * saturate( dotProduct );\\n\\n\t\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\t\tvLightBack += lightColor * attenuation * saturate( - dotProduct );\\n\\n\t\t\t#endif\\n\\n\t\t}\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_DIR_LIGHTS > 0\\n\\n\tfor ( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\\n\\n\t\tvec3 lightColor = directionalLightColor[ i ];\\n\\n\t\tvec3 lightDir = directionalLightDirection[ i ];\\n\\n\\n\t\tfloat dotProduct = dot( normal, lightDir );\\n\\n\t\tvLightFront += lightColor * saturate( dotProduct );\\n\\n\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\tvLightBack += lightColor * saturate( - dotProduct );\\n\\n\t\t#endif\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_HEMI_LIGHTS > 0\\n\\n\tfor ( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\\n\\n\t\tvec3 lightDir = hemisphereLightDirection[ i ];\\n\\n\\n\t\tfloat dotProduct = dot( normal, lightDir );\\n\\n\t\tfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\\n\\n\t\tvLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\\n\\n\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\tfloat hemiDiffuseWeightBack = - 0.5 * dotProduct + 0.5;\\n\\n\t\t\tvLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );\\n\\n\t\t#endif\\n\\n\t}\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_phong_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'lights_phong_fragment'] = \"vec3 viewDir = normalize( vViewPosition );\\n\\nvec3 totalDiffuseLight = vec3( 0.0 );\\nvec3 totalSpecularLight = vec3( 0.0 );\\n\\n#if MAX_POINT_LIGHTS > 0\\n\\n\tfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\\n\\n\t\tvec3 lightColor = pointLightColor[ i ];\\n\\n\t\tvec3 lightPosition = pointLightPosition[ i ];\\n\t\tvec3 lVector = lightPosition + vViewPosition.xyz;\\n\t\tvec3 lightDir = normalize( lVector );\\n\\n\\n\t\tfloat attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\\n\\n\\n\t\tfloat cosineTerm = saturate( dot( normal, lightDir ) );\\n\\n\t\ttotalDiffuseLight += lightColor * attenuation * cosineTerm;\\n\\n\\n\t\tvec3 brdf = BRDF_BlinnPhong( specular, shininess, normal, lightDir, viewDir );\\n\\n\t\ttotalSpecularLight += brdf * specularStrength * lightColor * attenuation * cosineTerm;\\n\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0\\n\\n\tfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\\n\\n\t\tvec3 lightColor = spotLightColor[ i ];\\n\\n\t\tvec3 lightPosition = spotLightPosition[ i ];\\n\t\tvec3 lVector = lightPosition + vViewPosition.xyz;\\n\t\tvec3 lightDir = normalize( lVector );\\n\\n\t\tfloat spotEffect = dot( spotLightDirection[ i ], lightDir );\\n\\n\t\tif ( spotEffect > spotLightAngleCos[ i ] ) {\\n\\n\t\t\tspotEffect = saturate( pow( saturate( spotEffect ), spotLightExponent[ i ] ) );\\n\\n\\n\t\t\tfloat attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\\n\\n\t\t\tattenuation *= spotEffect;\\n\\n\\n\t\t\tfloat cosineTerm = saturate( dot( normal, lightDir ) );\\n\\n\t\t\ttotalDiffuseLight += lightColor * attenuation * cosineTerm;\\n\\n\\n\t\t\tvec3 brdf = BRDF_BlinnPhong( specular, shininess, normal, lightDir, viewDir );\\n\\n\t\t\ttotalSpecularLight += brdf * specularStrength * lightColor * attenuation * cosineTerm;\\n\\n\t\t}\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_DIR_LIGHTS > 0\\n\\n\tfor ( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\\n\\n\t\tvec3 lightColor = directionalLightColor[ i ];\\n\\n\t\tvec3 lightDir = directionalLightDirection[ i ];\\n\\n\\n\t\tfloat cosineTerm = saturate( dot( normal, lightDir ) );\\n\\n\t\ttotalDiffuseLight += lightColor * cosineTerm;\\n\\n\\n\t\tvec3 brdf = BRDF_BlinnPhong( specular, shininess, normal, lightDir, viewDir );\\n\\n\t\ttotalSpecularLight += brdf * specularStrength * lightColor * cosineTerm;\\n\\n\t}\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_phong_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'lights_phong_pars_fragment'] = \"uniform vec3 ambientLightColor;\\n\\n#if MAX_DIR_LIGHTS > 0\\n\\n\tuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\\n\tuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_HEMI_LIGHTS > 0\\n\\n\tuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\\n\tuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\\n\tuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_POINT_LIGHTS > 0\\n\\n\tuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\\n\\n\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\\n\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\\n\tuniform float pointLightDecay[ MAX_POINT_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0\\n\\n\tuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\\n\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\\n\tuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_ENVMAP )\\n\\n\tvarying vec3 vWorldPosition;\\n\\n#endif\\n\\nvarying vec3 vViewPosition;\\n\\n#ifndef FLAT_SHADED\\n\\n\tvarying vec3 vNormal;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_phong_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'lights_phong_pars_vertex'] = \"#if MAX_SPOT_LIGHTS > 0 || defined( USE_ENVMAP )\\n\\n\tvarying vec3 vWorldPosition;\\n\\n#endif\\n\\n#if MAX_POINT_LIGHTS > 0\\n\\n\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_phong_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'lights_phong_vertex'] = \"#if MAX_SPOT_LIGHTS > 0 || defined( USE_ENVMAP )\\n\\n\tvWorldPosition = worldPosition.xyz;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/linear_to_gamma_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'linear_to_gamma_fragment'] = \"\\n\toutgoingLight = linearToOutput( outgoingLight );\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/logdepthbuf_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'logdepthbuf_fragment'] = \"#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\\n\\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/logdepthbuf_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'logdepthbuf_pars_fragment'] = \"#ifdef USE_LOGDEPTHBUF\\n\\n\tuniform float logDepthBufFC;\\n\\n\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\n\t\tvarying float vFragDepth;\\n\\n\t#endif\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/logdepthbuf_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'logdepthbuf_pars_vertex'] = \"#ifdef USE_LOGDEPTHBUF\\n\\n\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\n\t\tvarying float vFragDepth;\\n\\n\t#endif\\n\\n\tuniform float logDepthBufFC;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/logdepthbuf_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'logdepthbuf_vertex'] = \"#ifdef USE_LOGDEPTHBUF\\n\\n\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\\n\\n\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\n\t\tvFragDepth = 1.0 + gl_Position.w;\\n\\n#else\\n\\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\\n\\n\t#endif\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/map_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'map_fragment'] = \"#ifdef USE_MAP\\n\\n\tvec4 texelColor = texture2D( map, vUv );\\n\\n\ttexelColor.xyz = inputToLinear( texelColor.xyz );\\n\\n\tdiffuseColor *= texelColor;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/map_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'map_pars_fragment'] = \"#ifdef USE_MAP\\n\\n\tuniform sampler2D map;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/map_particle_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'map_particle_fragment'] = \"#ifdef USE_MAP\\n\\n\tdiffuseColor *= texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/map_particle_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'map_particle_pars_fragment'] = \"#ifdef USE_MAP\\n\\n\tuniform vec4 offsetRepeat;\\n\tuniform sampler2D map;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/morphnormal_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'morphnormal_vertex'] = \"#ifdef USE_MORPHNORMALS\\n\\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/morphtarget_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'morphtarget_pars_vertex'] = \"#ifdef USE_MORPHTARGETS\\n\\n\t#ifndef USE_MORPHNORMALS\\n\\n\tuniform float morphTargetInfluences[ 8 ];\\n\\n\t#else\\n\\n\tuniform float morphTargetInfluences[ 4 ];\\n\\n\t#endif\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/morphtarget_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'morphtarget_vertex'] = \"#ifdef USE_MORPHTARGETS\\n\\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\\n\\n\t#ifndef USE_MORPHNORMALS\\n\\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\\n\\n\t#endif\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/normal_phong_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'normal_phong_fragment'] = \"#ifndef FLAT_SHADED\\n\\n\tvec3 normal = normalize( vNormal );\\n\\n\t#ifdef DOUBLE_SIDED\\n\\n\t\tnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\\n\\n\t#endif\\n\\n#else\\n\\n\tvec3 fdx = dFdx( vViewPosition );\\n\tvec3 fdy = dFdy( vViewPosition );\\n\tvec3 normal = normalize( cross( fdx, fdy ) );\\n\\n#endif\\n\\n#ifdef USE_NORMALMAP\\n\\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\\n\\n#elif defined( USE_BUMPMAP )\\n\\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\\n\\n#endif\\n\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/normalmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'normalmap_pars_fragment'] = \"#ifdef USE_NORMALMAP\\n\\n\tuniform sampler2D normalMap;\\n\tuniform vec2 normalScale;\\n\\n\\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\\n\\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\\n\t\tvec2 st0 = dFdx( vUv.st );\\n\t\tvec2 st1 = dFdy( vUv.st );\\n\\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\\n\t\tvec3 N = normalize( surf_norm );\\n\\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\\n\t\tmapN.xy = normalScale * mapN.xy;\\n\t\tmat3 tsn = mat3( S, T, N );\\n\t\treturn normalize( tsn * mapN );\\n\\n\t}\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/project_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'project_vertex'] = \"#ifdef USE_SKINNING\\n\\n\tvec4 mvPosition = modelViewMatrix * skinned;\\n\\n#else\\n\\n\tvec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\\n\\n#endif\\n\\ngl_Position = projectionMatrix * mvPosition;\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/shadowmap_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'shadowmap_fragment'] = \"#ifdef USE_SHADOWMAP\\n\\n\tfor ( int i = 0; i < MAX_SHADOWS; i ++ ) {\\n\\n\t\tfloat texelSizeY =  1.0 / shadowMapSize[ i ].y;\\n\\n\t\tfloat shadow = 0.0;\\n\\n#if defined( POINT_LIGHT_SHADOWS )\\n\\n\t\tbool isPointLight = shadowDarkness[ i ] < 0.0;\\n\\n\t\tif ( isPointLight ) {\\n\\n\t\t\tfloat realShadowDarkness = abs( shadowDarkness[ i ] );\\n\\n\t\t\tvec3 lightToPosition = vShadowCoord[ i ].xyz;\\n\\n\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\\n\\n\t\t\tvec3 bd3D = normalize( lightToPosition );\\n\t\t\tfloat dp = length( lightToPosition );\\n\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D, texelSizeY ) ), shadowBias[ i ], shadow );\\n\\n\\n\t#if defined( SHADOWMAP_TYPE_PCF )\\n\t\t\tconst float Dr = 1.25;\\n\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\\n\t\t\tconst float Dr = 2.25;\\n\t#endif\\n\\n\t\t\tfloat os = Dr *  2.0 * texelSizeY;\\n\\n\t\t\tconst vec3 Gsd = vec3( - 1, 0, 1 );\\n\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.zzz * os, texelSizeY ) ), shadowBias[ i ], shadow );\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.zxz * os, texelSizeY ) ), shadowBias[ i ], shadow );\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.xxz * os, texelSizeY ) ), shadowBias[ i ], shadow );\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.xzz * os, texelSizeY ) ), shadowBias[ i ], shadow );\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.zzx * os, texelSizeY ) ), shadowBias[ i ], shadow );\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.zxx * os, texelSizeY ) ), shadowBias[ i ], shadow );\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.xxx * os, texelSizeY ) ), shadowBias[ i ], shadow );\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.xzx * os, texelSizeY ) ), shadowBias[ i ], shadow );\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.zzy * os, texelSizeY ) ), shadowBias[ i ], shadow );\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.zxy * os, texelSizeY ) ), shadowBias[ i ], shadow );\\n\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.xxy * os, texelSizeY ) ), shadowBias[ i ], shadow );\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.xzy * os, texelSizeY ) ), shadowBias[ i ], shadow );\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.zyz * os, texelSizeY ) ), shadowBias[ i ], shadow );\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.xyz * os, texelSizeY ) ), shadowBias[ i ], shadow );\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.zyx * os, texelSizeY ) ), shadowBias[ i ], shadow );\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.xyx * os, texelSizeY ) ), shadowBias[ i ], shadow );\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.yzz * os, texelSizeY ) ), shadowBias[ i ], shadow );\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.yxz * os, texelSizeY ) ), shadowBias[ i ], shadow );\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.yxx * os, texelSizeY ) ), shadowBias[ i ], shadow );\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.yzx * os, texelSizeY ) ), shadowBias[ i ], shadow );\\n\\n\t\t\tshadow *= realShadowDarkness * ( 1.0 / 21.0 );\\n\\n\t#else \\n\t\t\tvec3 bd3D = normalize( lightToPosition );\\n\t\t\tfloat dp = length( lightToPosition );\\n\\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D, texelSizeY ) ), shadowBias[ i ], shadow );\\n\\n\t\t\tshadow *= realShadowDarkness;\\n\\n\t#endif\\n\\n\t\t} else {\\n\\n#endif \\n\t\t\tfloat texelSizeX =  1.0 / shadowMapSize[ i ].x;\\n\\n\t\t\tvec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\\n\\n\\n\t\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\\n\t\t\tbool inFrustum = all( inFrustumVec );\\n\\n\t\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\\n\\n\t\t\tbool frustumTest = all( frustumTestVec );\\n\\n\t\t\tif ( frustumTest ) {\\n\\n\t#if defined( SHADOWMAP_TYPE_PCF )\\n\\n\\n\t\t\t\t/*\\n\t\t\t\t\tfor ( float y = -1.25; y <= 1.25; y += 1.25 )\\n\t\t\t\t\t\tfor ( float x = -1.25; x <= 1.25; x += 1.25 ) {\\n\t\t\t\t\t\t\tvec4 rgbaDepth = texture2D( shadowMap[ i ], vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy );\\n\t\t\t\t\t\t\tfloat fDepth = unpackDepth( rgbaDepth );\\n\t\t\t\t\t\t\tif ( fDepth < shadowCoord.z )\\n\t\t\t\t\t\t\t\tshadow += 1.0;\\n\t\t\t\t\t}\\n\t\t\t\t\tshadow /= 9.0;\\n\t\t\t\t*/\\n\\n\t\t\t\tshadowCoord.z += shadowBias[ i ];\\n\\n\t\t\t\tconst float ShadowDelta = 1.0 / 9.0;\\n\\n\t\t\t\tfloat xPixelOffset = texelSizeX;\\n\t\t\t\tfloat yPixelOffset = texelSizeY;\\n\\n\t\t\t\tfloat dx0 = - 1.25 * xPixelOffset;\\n\t\t\t\tfloat dy0 = - 1.25 * yPixelOffset;\\n\t\t\t\tfloat dx1 = 1.25 * xPixelOffset;\\n\t\t\t\tfloat dy1 = 1.25 * yPixelOffset;\\n\\n\t\t\t\tfloat fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += ShadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += ShadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += ShadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += ShadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += ShadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += ShadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += ShadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += ShadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += ShadowDelta;\\n\\n\t\t\t\tshadow *= shadowDarkness[ i ];\\n\\n\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\\n\\n\\n\t\t\t\tshadowCoord.z += shadowBias[ i ];\\n\\n\t\t\t\tfloat xPixelOffset = texelSizeX;\\n\t\t\t\tfloat yPixelOffset = texelSizeY;\\n\\n\t\t\t\tfloat dx0 = - 1.0 * xPixelOffset;\\n\t\t\t\tfloat dy0 = - 1.0 * yPixelOffset;\\n\t\t\t\tfloat dx1 = 1.0 * xPixelOffset;\\n\t\t\t\tfloat dy1 = 1.0 * yPixelOffset;\\n\\n\t\t\t\tmat3 shadowKernel;\\n\t\t\t\tmat3 depthKernel;\\n\\n\t\t\t\tdepthKernel[ 0 ][ 0 ] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\\n\t\t\t\tdepthKernel[ 0 ][ 1 ] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\\n\t\t\t\tdepthKernel[ 0 ][ 2 ] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\\n\t\t\t\tdepthKernel[ 1 ][ 0 ] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\\n\t\t\t\tdepthKernel[ 1 ][ 1 ] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\\n\t\t\t\tdepthKernel[ 1 ][ 2 ] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\\n\t\t\t\tdepthKernel[ 2 ][ 0 ] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\\n\t\t\t\tdepthKernel[ 2 ][ 1 ] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\\n\t\t\t\tdepthKernel[ 2 ][ 2 ] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\\n\\n\t\t\t\tvec3 shadowZ = vec3( shadowCoord.z );\\n\t\t\t\tshadowKernel[ 0 ] = vec3( lessThan( depthKernel[ 0 ], shadowZ ) );\\n\t\t\t\tshadowKernel[ 0 ] *= vec3( 0.25 );\\n\\n\t\t\t\tshadowKernel[ 1 ] = vec3( lessThan( depthKernel[ 1 ], shadowZ ) );\\n\t\t\t\tshadowKernel[ 1 ] *= vec3( 0.25 );\\n\\n\t\t\t\tshadowKernel[ 2 ] = vec3( lessThan( depthKernel[ 2 ], shadowZ ) );\\n\t\t\t\tshadowKernel[ 2 ] *= vec3( 0.25 );\\n\\n\t\t\t\tvec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[ i ].xy );\\n\\n\t\t\t\tshadowKernel[ 0 ] = mix( shadowKernel[ 1 ], shadowKernel[ 0 ], fractionalCoord.x );\\n\t\t\t\tshadowKernel[ 1 ] = mix( shadowKernel[ 2 ], shadowKernel[ 1 ], fractionalCoord.x );\\n\\n\t\t\t\tvec4 shadowValues;\\n\t\t\t\tshadowValues.x = mix( shadowKernel[ 0 ][ 1 ], shadowKernel[ 0 ][ 0 ], fractionalCoord.y );\\n\t\t\t\tshadowValues.y = mix( shadowKernel[ 0 ][ 2 ], shadowKernel[ 0 ][ 1 ], fractionalCoord.y );\\n\t\t\t\tshadowValues.z = mix( shadowKernel[ 1 ][ 1 ], shadowKernel[ 1 ][ 0 ], fractionalCoord.y );\\n\t\t\t\tshadowValues.w = mix( shadowKernel[ 1 ][ 2 ], shadowKernel[ 1 ][ 1 ], fractionalCoord.y );\\n\\n\t\t\t\tshadow = dot( shadowValues, vec4( 1.0 ) ) * shadowDarkness[ i ];\\n\\n\t#else \\n\t\t\t\tshadowCoord.z += shadowBias[ i ];\\n\\n\t\t\t\tvec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\\n\t\t\t\tfloat fDepth = unpackDepth( rgbaDepth );\\n\\n\t\t\t\tif ( fDepth < shadowCoord.z )\\n\t\t\t\t\tshadow = shadowDarkness[ i ];\\n\\n\t#endif\\n\\n\t\t\t}\\n\\n#ifdef SHADOWMAP_DEBUG\\n\\n\t\t\tif ( inFrustum ) {\\n\\n\t\t\t\tif ( i == 0 ) {\\n\\n\t\t\t\t\toutgoingLight *= vec3( 1.0, 0.5, 0.0 );\\n\\n\t\t\t\t} else if ( i == 1 ) {\\n\\n\t\t\t\t\toutgoingLight *= vec3( 0.0, 1.0, 0.8 );\\n\\n\t\t\t\t} else {\\n\\n\t\t\t\t\toutgoingLight *= vec3( 0.0, 0.5, 1.0 );\\n\\n\t\t\t\t}\\n\\n\t\t\t}\\n\\n#endif\\n\\n#if defined( POINT_LIGHT_SHADOWS )\\n\\n\t\t}\\n\\n#endif\\n\\n\t\tshadowMask = shadowMask * vec3( 1.0 - shadow );\\n\\n\t}\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/shadowmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'shadowmap_pars_fragment'] = \"#ifdef USE_SHADOWMAP\\n\\n\tuniform sampler2D shadowMap[ MAX_SHADOWS ];\\n\tuniform vec2 shadowMapSize[ MAX_SHADOWS ];\\n\\n\tuniform float shadowDarkness[ MAX_SHADOWS ];\\n\tuniform float shadowBias[ MAX_SHADOWS ];\\n\\n\tvarying vec4 vShadowCoord[ MAX_SHADOWS ];\\n\\n\tfloat unpackDepth( const in vec4 rgba_depth ) {\\n\\n\t\tconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\\n\t\tfloat depth = dot( rgba_depth, bit_shift );\\n\t\treturn depth;\\n\\n\t}\\n\\n\t#if defined(POINT_LIGHT_SHADOWS)\\n\\n\\n\t\tvoid adjustShadowValue1K( const float testDepth, const vec4 textureData, const float bias, inout float shadowValue ) {\\n\\n\t\t\tconst vec4 bitSh = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\\n\t\t\tif ( testDepth >= dot( textureData, bitSh ) * 1000.0 + bias )\\n\t\t\t\tshadowValue += 1.0;\\n\\n\t\t}\\n\\n\\n\t\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\\n\\n\\n\t\t\tvec3 absV = abs( v );\\n\\n\\n\t\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\\n\t\t\tabsV *= scaleToCube;\\n\\n\\n\t\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\\n\\n\\n\\n\t\t\tvec2 planar = v.xy;\\n\\n\t\t\tfloat almostATexel = 1.5 * texelSizeY;\\n\t\t\tfloat almostOne = 1.0 - almostATexel;\\n\\n\t\t\tif ( absV.z >= almostOne ) {\\n\\n\t\t\t\tif ( v.z > 0.0 )\\n\t\t\t\t\tplanar.x = 4.0 - v.x;\\n\\n\t\t\t} else if ( absV.x >= almostOne ) {\\n\\n\t\t\t\tfloat signX = sign( v.x );\\n\t\t\t\tplanar.x = v.z * signX + 2.0 * signX;\\n\\n\t\t\t} else if ( absV.y >= almostOne ) {\\n\\n\t\t\t\tfloat signY = sign( v.y );\\n\t\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\\n\t\t\t\tplanar.y = v.z * signY - 2.0;\\n\\n\t\t\t}\\n\\n\\n\t\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\\n\\n\t\t}\\n\\n\t#endif\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/shadowmap_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'shadowmap_pars_vertex'] = \"#ifdef USE_SHADOWMAP\\n\\n\tuniform float shadowDarkness[ MAX_SHADOWS ];\\n\tuniform mat4 shadowMatrix[ MAX_SHADOWS ];\\n\tvarying vec4 vShadowCoord[ MAX_SHADOWS ];\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/shadowmap_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'shadowmap_vertex'] = \"#ifdef USE_SHADOWMAP\\n\\n\tfor ( int i = 0; i < MAX_SHADOWS; i ++ ) {\\n\\n\t\t\tvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\\n\\n\t}\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/skinbase_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'skinbase_vertex'] = \"#ifdef USE_SKINNING\\n\\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/skinning_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'skinning_pars_vertex'] = \"#ifdef USE_SKINNING\\n\\n\tuniform mat4 bindMatrix;\\n\tuniform mat4 bindMatrixInverse;\\n\\n\t#ifdef BONE_TEXTURE\\n\\n\t\tuniform sampler2D boneTexture;\\n\t\tuniform int boneTextureWidth;\\n\t\tuniform int boneTextureHeight;\\n\\n\t\tmat4 getBoneMatrix( const in float i ) {\\n\\n\t\t\tfloat j = i * 4.0;\\n\t\t\tfloat x = mod( j, float( boneTextureWidth ) );\\n\t\t\tfloat y = floor( j / float( boneTextureWidth ) );\\n\\n\t\t\tfloat dx = 1.0 / float( boneTextureWidth );\\n\t\t\tfloat dy = 1.0 / float( boneTextureHeight );\\n\\n\t\t\ty = dy * ( y + 0.5 );\\n\\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\\n\\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\\n\\n\t\t\treturn bone;\\n\\n\t\t}\\n\\n\t#else\\n\\n\t\tuniform mat4 boneGlobalMatrices[ MAX_BONES ];\\n\\n\t\tmat4 getBoneMatrix( const in float i ) {\\n\\n\t\t\tmat4 bone = boneGlobalMatrices[ int(i) ];\\n\t\t\treturn bone;\\n\\n\t\t}\\n\\n\t#endif\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/skinning_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'skinning_vertex'] = \"#ifdef USE_SKINNING\\n\\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\\n\\n\tvec4 skinned = vec4( 0.0 );\\n\tskinned += boneMatX * skinVertex * skinWeight.x;\\n\tskinned += boneMatY * skinVertex * skinWeight.y;\\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\\n\tskinned += boneMatW * skinVertex * skinWeight.w;\\n\tskinned  = bindMatrixInverse * skinned;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/skinnormal_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'skinnormal_vertex'] = \"#ifdef USE_SKINNING\\n\\n\tmat4 skinMatrix = mat4( 0.0 );\\n\tskinMatrix += skinWeight.x * boneMatX;\\n\tskinMatrix += skinWeight.y * boneMatY;\\n\tskinMatrix += skinWeight.z * boneMatZ;\\n\tskinMatrix += skinWeight.w * boneMatW;\\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\\n\\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/specularmap_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'specularmap_fragment'] = \"float specularStrength;\\n\\n#ifdef USE_SPECULARMAP\\n\\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\\n\tspecularStrength = texelSpecular.r;\\n\\n#else\\n\\n\tspecularStrength = 1.0;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/specularmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'specularmap_pars_fragment'] = \"#ifdef USE_SPECULARMAP\\n\\n\tuniform sampler2D specularMap;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/uv2_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'uv2_pars_fragment'] = \"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\n\\n\tvarying vec2 vUv2;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/uv2_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'uv2_pars_vertex'] = \"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\n\\n\tattribute vec2 uv2;\\n\tvarying vec2 vUv2;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/uv2_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'uv2_vertex'] = \"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\n\\n\tvUv2 = uv2;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/uv_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'uv_pars_fragment'] = \"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP )\\n\\n\tvarying vec2 vUv;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/uv_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'uv_pars_vertex'] = \"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP )\\n\\n\tvarying vec2 vUv;\\n\tuniform vec4 offsetRepeat;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/uv_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'uv_vertex'] = \"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP )\\n\\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/worldpos_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'worldpos_vertex'] = \"#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\\n\\n\t#ifdef USE_SKINNING\\n\\n\t\tvec4 worldPosition = modelMatrix * skinned;\\n\\n\t#else\\n\\n\t\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\\n\\n\t#endif\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/UniformsUtils.js\r\n\r\n/**\r\n * Uniform Utilities\r\n */\r\n\r\nTHREE.UniformsUtils = {\r\n\r\n\tmerge: function ( uniforms ) {\r\n\r\n\t\tvar merged = {};\r\n\r\n\t\tfor ( var u = 0; u < uniforms.length; u ++ ) {\r\n\r\n\t\t\tvar tmp = this.clone( uniforms[ u ] );\r\n\r\n\t\t\tfor ( var p in tmp ) {\r\n\r\n\t\t\t\tmerged[ p ] = tmp[ p ];\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn merged;\r\n\r\n\t},\r\n\r\n\tclone: function ( uniforms_src ) {\r\n\r\n\t\tvar uniforms_dst = {};\r\n\r\n\t\tfor ( var u in uniforms_src ) {\r\n\r\n\t\t\tuniforms_dst[ u ] = {};\r\n\r\n\t\t\tfor ( var p in uniforms_src[ u ] ) {\r\n\r\n\t\t\t\tvar parameter_src = uniforms_src[ u ][ p ];\r\n\r\n\t\t\t\tif ( parameter_src instanceof THREE.Color ||\r\n\t\t\t\t\t parameter_src instanceof THREE.Vector2 ||\r\n\t\t\t\t\t parameter_src instanceof THREE.Vector3 ||\r\n\t\t\t\t\t parameter_src instanceof THREE.Vector4 ||\r\n\t\t\t\t\t parameter_src instanceof THREE.Matrix3 ||\r\n\t\t\t\t\t parameter_src instanceof THREE.Matrix4 ||\r\n\t\t\t\t\t parameter_src instanceof THREE.Texture ) {\r\n\r\n\t\t\t\t\tuniforms_dst[ u ][ p ] = parameter_src.clone();\r\n\r\n\t\t\t\t} else if ( Array.isArray( parameter_src ) ) {\r\n\r\n\t\t\t\t\tuniforms_dst[ u ][ p ] = parameter_src.slice();\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tuniforms_dst[ u ][ p ] = parameter_src;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn uniforms_dst;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/renderers/shaders/UniformsLib.js\r\n\r\n/**\r\n * Uniforms library for shared webgl shaders\r\n */\r\n\r\nTHREE.UniformsLib = {\r\n\r\n\tcommon: {\r\n\r\n\t\t\"diffuse\" : { type: \"c\", value: new THREE.Color( 0xeeeeee ) },\r\n\t\t\"opacity\" : { type: \"f\", value: 1.0 },\r\n\r\n\t\t\"map\" : { type: \"t\", value: null },\r\n\t\t\"offsetRepeat\" : { type: \"v4\", value: new THREE.Vector4( 0, 0, 1, 1 ) },\r\n\r\n\t\t\"specularMap\" : { type: \"t\", value: null },\r\n\t\t\"alphaMap\" : { type: \"t\", value: null },\r\n\r\n\t\t\"envMap\" : { type: \"t\", value: null },\r\n\t\t\"flipEnvMap\" : { type: \"f\", value: - 1 },\r\n\t\t\"reflectivity\" : { type: \"f\", value: 1.0 },\r\n\t\t\"refractionRatio\" : { type: \"f\", value: 0.98 }\r\n\r\n\t},\r\n\r\n\taomap: {\r\n\r\n\t\t\"aoMap\" : { type: \"t\", value: null },\r\n\t\t\"aoMapIntensity\" : { type: \"f\", value: 1 },\r\n\r\n\t},\r\n\r\n\tlightmap: {\r\n\r\n\t\t\"lightMap\" : { type: \"t\", value: null },\r\n\t\t\"lightMapIntensity\" : { type: \"f\", value: 1 },\r\n\r\n\t},\r\n\r\n\temissivemap: {\r\n\r\n\t\t\"emissiveMap\" : { type: \"t\", value: null },\r\n\r\n\t},\r\n\r\n\tbumpmap: {\r\n\r\n\t\t\"bumpMap\" : { type: \"t\", value: null },\r\n\t\t\"bumpScale\" : { type: \"f\", value: 1 }\r\n\r\n\t},\r\n\r\n\tnormalmap: {\r\n\r\n\t\t\"normalMap\" : { type: \"t\", value: null },\r\n\t\t\"normalScale\" : { type: \"v2\", value: new THREE.Vector2( 1, 1 ) }\r\n\r\n\t},\r\n\r\n\tdisplacementmap: {\r\n\r\n\t\t\"displacementMap\" : { type: \"t\", value: null },\r\n\t\t\"displacementScale\" : { type: \"f\", value: 1 },\r\n\t\t\"displacementBias\" : { type: \"f\", value: 0 }\r\n\r\n\t},\r\n\r\n\tfog : {\r\n\r\n\t\t\"fogDensity\" : { type: \"f\", value: 0.00025 },\r\n\t\t\"fogNear\" : { type: \"f\", value: 1 },\r\n\t\t\"fogFar\" : { type: \"f\", value: 2000 },\r\n\t\t\"fogColor\" : { type: \"c\", value: new THREE.Color( 0xffffff ) }\r\n\r\n\t},\r\n\r\n\tlights: {\r\n\r\n\t\t\"ambientLightColor\" : { type: \"fv\", value: [] },\r\n\r\n\t\t\"directionalLightDirection\" : { type: \"fv\", value: [] },\r\n\t\t\"directionalLightColor\" : { type: \"fv\", value: [] },\r\n\r\n\t\t\"hemisphereLightDirection\" : { type: \"fv\", value: [] },\r\n\t\t\"hemisphereLightSkyColor\" : { type: \"fv\", value: [] },\r\n\t\t\"hemisphereLightGroundColor\" : { type: \"fv\", value: [] },\r\n\r\n\t\t\"pointLightColor\" : { type: \"fv\", value: [] },\r\n\t\t\"pointLightPosition\" : { type: \"fv\", value: [] },\r\n\t\t\"pointLightDistance\" : { type: \"fv1\", value: [] },\r\n\t\t\"pointLightDecay\" : { type: \"fv1\", value: [] },\r\n\r\n\t\t\"spotLightColor\" : { type: \"fv\", value: [] },\r\n\t\t\"spotLightPosition\" : { type: \"fv\", value: [] },\r\n\t\t\"spotLightDirection\" : { type: \"fv\", value: [] },\r\n\t\t\"spotLightDistance\" : { type: \"fv1\", value: [] },\r\n\t\t\"spotLightAngleCos\" : { type: \"fv1\", value: [] },\r\n\t\t\"spotLightExponent\" : { type: \"fv1\", value: [] },\r\n\t\t\"spotLightDecay\" : { type: \"fv1\", value: [] }\r\n\r\n\t},\r\n\r\n\tpoints: {\r\n\r\n\t\t\"psColor\" : { type: \"c\", value: new THREE.Color( 0xeeeeee ) },\r\n\t\t\"opacity\" : { type: \"f\", value: 1.0 },\r\n\t\t\"size\" : { type: \"f\", value: 1.0 },\r\n\t\t\"scale\" : { type: \"f\", value: 1.0 },\r\n\t\t\"map\" : { type: \"t\", value: null },\r\n\t\t\"offsetRepeat\" : { type: \"v4\", value: new THREE.Vector4( 0, 0, 1, 1 ) },\r\n\r\n\t\t\"fogDensity\" : { type: \"f\", value: 0.00025 },\r\n\t\t\"fogNear\" : { type: \"f\", value: 1 },\r\n\t\t\"fogFar\" : { type: \"f\", value: 2000 },\r\n\t\t\"fogColor\" : { type: \"c\", value: new THREE.Color( 0xffffff ) }\r\n\r\n\t},\r\n\r\n\tshadowmap: {\r\n\r\n\t\t\"shadowMap\": { type: \"tv\", value: [] },\r\n\t\t\"shadowMapSize\": { type: \"v2v\", value: [] },\r\n\r\n\t\t\"shadowBias\" : { type: \"fv1\", value: [] },\r\n\t\t\"shadowDarkness\": { type: \"fv1\", value: [] },\r\n\r\n\t\t\"shadowMatrix\" : { type: \"m4v\", value: [] }\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/renderers/shaders/ShaderLib.js\r\n\r\n/**\r\n * Webgl Shader Library for three.js\r\n *\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n */\r\n\r\n\r\nTHREE.ShaderLib = {\r\n\r\n\t'basic': {\r\n\r\n\t\tuniforms: THREE.UniformsUtils.merge( [\r\n\r\n\t\t\tTHREE.UniformsLib[ \"common\" ],\r\n\t\t\tTHREE.UniformsLib[ \"aomap\" ],\r\n\t\t\tTHREE.UniformsLib[ \"fog\" ],\r\n\t\t\tTHREE.UniformsLib[ \"shadowmap\" ]\r\n\r\n\t\t] ),\r\n\r\n\t\tvertexShader: [\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"uv_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"uv2_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"envmap_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"color_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"morphtarget_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"skinning_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"shadowmap_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_vertex\" ],\r\n\r\n\t\t\t\"void main() {\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"uv_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"uv2_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"color_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"skinbase_vertex\" ],\r\n\r\n\t\t\t\"\t#ifdef USE_ENVMAP\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"beginnormal_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"morphnormal_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"skinnormal_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"defaultnormal_vertex\" ],\r\n\r\n\t\t\t\"\t#endif\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"begin_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"morphtarget_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"skinning_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"project_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_vertex\" ],\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"worldpos_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"envmap_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"shadowmap_vertex\" ],\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join( \"\\n\" ),\r\n\r\n\t\tfragmentShader: [\r\n\r\n\t\t\t\"uniform vec3 diffuse;\",\r\n\t\t\t\"uniform float opacity;\",\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"color_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"uv_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"uv2_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"map_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"alphamap_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"aomap_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"envmap_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"fog_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"shadowmap_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"specularmap_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_fragment\" ],\r\n\r\n\t\t\t\"void main() {\",\r\n\r\n\t\t\t\"\tvec3 outgoingLight = vec3( 0.0 );\",\r\n\t\t\t\"\tvec4 diffuseColor = vec4( diffuse, opacity );\",\r\n\t\t\t\"\tvec3 totalAmbientLight = vec3( 1.0 );\", // hardwired\r\n\t\t\t\"\tvec3 shadowMask = vec3( 1.0 );\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"map_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"color_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"alphamap_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"alphatest_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"specularmap_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"aomap_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"shadowmap_fragment\" ],\r\n\r\n\t\t\t\"\toutgoingLight = diffuseColor.rgb * totalAmbientLight * shadowMask;\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"envmap_fragment\" ],\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"linear_to_gamma_fragment\" ],\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"fog_fragment\" ],\r\n\r\n\t\t\t\"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\",\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join( \"\\n\" )\r\n\r\n\t},\r\n\r\n\t'lambert': {\r\n\r\n\t\tuniforms: THREE.UniformsUtils.merge( [\r\n\r\n\t\t\tTHREE.UniformsLib[ \"common\" ],\r\n\t\t\tTHREE.UniformsLib[ \"fog\" ],\r\n\t\t\tTHREE.UniformsLib[ \"lights\" ],\r\n\t\t\tTHREE.UniformsLib[ \"shadowmap\" ],\r\n\r\n\t\t\t{\r\n\t\t\t\t\"emissive\" : { type: \"c\", value: new THREE.Color( 0x000000 ) }\r\n\t\t\t}\r\n\r\n\t\t] ),\r\n\r\n\t\tvertexShader: [\r\n\r\n\t\t\t\"#define LAMBERT\",\r\n\r\n\t\t\t\"varying vec3 vLightFront;\",\r\n\r\n\t\t\t\"#ifdef DOUBLE_SIDED\",\r\n\r\n\t\t\t\"\tvarying vec3 vLightBack;\",\r\n\r\n\t\t\t\"#endif\",\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"uv_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"uv2_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"envmap_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"lights_lambert_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"color_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"morphtarget_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"skinning_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"shadowmap_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_vertex\" ],\r\n\r\n\t\t\t\"void main() {\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"uv_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"uv2_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"color_vertex\" ],\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"beginnormal_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"morphnormal_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"skinbase_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"skinnormal_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"defaultnormal_vertex\" ],\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"begin_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"morphtarget_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"skinning_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"project_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_vertex\" ],\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"worldpos_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"envmap_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"lights_lambert_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"shadowmap_vertex\" ],\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join( \"\\n\" ),\r\n\r\n\t\tfragmentShader: [\r\n\r\n\t\t\t\"uniform vec3 diffuse;\",\r\n\t\t\t\"uniform vec3 emissive;\",\r\n\t\t\t\"uniform float opacity;\",\r\n\r\n\t\t\t\"uniform vec3 ambientLightColor;\",\r\n\r\n\t\t\t\"varying vec3 vLightFront;\",\r\n\r\n\t\t\t\"#ifdef DOUBLE_SIDED\",\r\n\r\n\t\t\t\"\tvarying vec3 vLightBack;\",\r\n\r\n\t\t\t\"#endif\",\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"color_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"uv_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"uv2_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"map_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"alphamap_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"envmap_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"fog_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"shadowmap_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"specularmap_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_fragment\" ],\r\n\r\n\t\t\t\"void main() {\",\r\n\r\n\t\t\t\"\tvec3 outgoingLight = vec3( 0.0 );\",\t// outgoing light does not have an alpha, the surface does\r\n\t\t\t\"\tvec4 diffuseColor = vec4( diffuse, opacity );\",\r\n\t\t\t\"\tvec3 totalAmbientLight = ambientLightColor;\",\r\n\t\t\t\"\tvec3 shadowMask = vec3( 1.0 );\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"map_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"color_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"alphamap_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"alphatest_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"specularmap_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"shadowmap_fragment\" ],\r\n\r\n\t\t\t\"\t#ifdef DOUBLE_SIDED\",\r\n\r\n\t\t\t\"\t\tif ( gl_FrontFacing )\",\r\n\t\t\t\"\t\t\toutgoingLight += diffuseColor.rgb * ( vLightFront * shadowMask + totalAmbientLight ) + emissive;\",\r\n\t\t\t\"\t\telse\",\r\n\t\t\t\"\t\t\toutgoingLight += diffuseColor.rgb * ( vLightBack * shadowMask + totalAmbientLight ) + emissive;\",\r\n\r\n\t\t\t\"\t#else\",\r\n\r\n\t\t\t\"\t\toutgoingLight += diffuseColor.rgb * ( vLightFront * shadowMask + totalAmbientLight ) + emissive;\",\r\n\r\n\t\t\t\"\t#endif\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"envmap_fragment\" ],\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"linear_to_gamma_fragment\" ],\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"fog_fragment\" ],\r\n\r\n\t\t\t\"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\",\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join( \"\\n\" )\r\n\r\n\t},\r\n\r\n\t'phong': {\r\n\r\n\t\tuniforms: THREE.UniformsUtils.merge( [\r\n\r\n\t\t\tTHREE.UniformsLib[ \"common\" ],\r\n\t\t\tTHREE.UniformsLib[ \"aomap\" ],\r\n\t\t\tTHREE.UniformsLib[ \"lightmap\" ],\r\n\t\t\tTHREE.UniformsLib[ \"emissivemap\" ],\r\n\t\t\tTHREE.UniformsLib[ \"bumpmap\" ],\r\n\t\t\tTHREE.UniformsLib[ \"normalmap\" ],\r\n\t\t\tTHREE.UniformsLib[ \"displacementmap\" ],\r\n\t\t\tTHREE.UniformsLib[ \"fog\" ],\r\n\t\t\tTHREE.UniformsLib[ \"lights\" ],\r\n\t\t\tTHREE.UniformsLib[ \"shadowmap\" ],\r\n\r\n\t\t\t{\r\n\t\t\t\t\"emissive\" : { type: \"c\", value: new THREE.Color( 0x000000 ) },\r\n\t\t\t\t\"specular\" : { type: \"c\", value: new THREE.Color( 0x111111 ) },\r\n\t\t\t\t\"shininess\": { type: \"f\", value: 30 }\r\n\t\t\t}\r\n\r\n\t\t] ),\r\n\r\n\t\tvertexShader: [\r\n\r\n\t\t\t\"#define PHONG\",\r\n\r\n\t\t\t\"varying vec3 vViewPosition;\",\r\n\r\n\t\t\t\"#ifndef FLAT_SHADED\",\r\n\r\n\t\t\t\"\tvarying vec3 vNormal;\",\r\n\r\n\t\t\t\"#endif\",\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"uv_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"uv2_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"displacementmap_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"envmap_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"lights_phong_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"color_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"morphtarget_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"skinning_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"shadowmap_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_vertex\" ],\r\n\r\n\t\t\t\"void main() {\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"uv_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"uv2_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"color_vertex\" ],\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"beginnormal_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"morphnormal_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"skinbase_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"skinnormal_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"defaultnormal_vertex\" ],\r\n\r\n\t\t\t\"#ifndef FLAT_SHADED\", // Normal computed with derivatives when FLAT_SHADED\r\n\r\n\t\t\t\"\tvNormal = normalize( transformedNormal );\",\r\n\r\n\t\t\t\"#endif\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"begin_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"displacementmap_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"morphtarget_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"skinning_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"project_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_vertex\" ],\r\n\r\n\t\t\t\"\tvViewPosition = - mvPosition.xyz;\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"worldpos_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"envmap_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"lights_phong_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"shadowmap_vertex\" ],\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join( \"\\n\" ),\r\n\r\n\t\tfragmentShader: [\r\n\r\n\t\t\t\"#define PHONG\",\r\n\r\n\t\t\t\"uniform vec3 diffuse;\",\r\n\t\t\t\"uniform vec3 emissive;\",\r\n\t\t\t\"uniform vec3 specular;\",\r\n\t\t\t\"uniform float shininess;\",\r\n\t\t\t\"uniform float opacity;\",\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"color_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"uv_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"uv2_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"map_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"alphamap_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"aomap_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"lightmap_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"emissivemap_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"envmap_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"fog_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"lights_phong_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"shadowmap_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"bumpmap_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"normalmap_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"specularmap_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_fragment\" ],\r\n\r\n\t\t\t\"void main() {\",\r\n\r\n\t\t\t\"\tvec3 outgoingLight = vec3( 0.0 );\",\r\n\t\t\t\"\tvec4 diffuseColor = vec4( diffuse, opacity );\",\r\n\t\t\t\"\tvec3 totalAmbientLight = ambientLightColor;\",\r\n\t\t\t\"\tvec3 totalEmissiveLight = emissive;\",\r\n\t\t\t\"\tvec3 shadowMask = vec3( 1.0 );\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"map_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"color_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"alphamap_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"alphatest_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"specularmap_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"normal_phong_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"lightmap_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"hemilight_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"aomap_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"emissivemap_fragment\" ],\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"lights_phong_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"shadowmap_fragment\" ],\r\n\r\n\t\t\t\t\"totalDiffuseLight *= shadowMask;\",\r\n\t\t\t\t\"totalSpecularLight *= shadowMask;\",\r\n\r\n\t\t\t\t\"#ifdef METAL\",\r\n\r\n\t\t\t\t\"\toutgoingLight += diffuseColor.rgb * ( totalDiffuseLight + totalAmbientLight ) * specular + totalSpecularLight + totalEmissiveLight;\",\r\n\r\n\t\t\t\t\"#else\",\r\n\r\n\t\t\t\t\"\toutgoingLight += diffuseColor.rgb * ( totalDiffuseLight + totalAmbientLight ) + totalSpecularLight + totalEmissiveLight;\",\r\n\r\n\t\t\t\t\"#endif\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"envmap_fragment\" ],\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"linear_to_gamma_fragment\" ],\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"fog_fragment\" ],\r\n\r\n\t\t\t\"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\",\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join( \"\\n\" )\r\n\r\n\t},\r\n\r\n\t'points': {\r\n\r\n\t\tuniforms: THREE.UniformsUtils.merge( [\r\n\r\n\t\t\tTHREE.UniformsLib[ \"points\" ],\r\n\t\t\tTHREE.UniformsLib[ \"shadowmap\" ]\r\n\r\n\t\t] ),\r\n\r\n\t\tvertexShader: [\r\n\r\n\t\t\t\"uniform float size;\",\r\n\t\t\t\"uniform float scale;\",\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"color_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"shadowmap_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_vertex\" ],\r\n\r\n\t\t\t\"void main() {\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"color_vertex\" ],\r\n\r\n\t\t\t\"\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\",\r\n\r\n\t\t\t\"\t#ifdef USE_SIZEATTENUATION\",\r\n\t\t\t\"\t\tgl_PointSize = size * ( scale / length( mvPosition.xyz ) );\",\r\n\t\t\t\"\t#else\",\r\n\t\t\t\"\t\tgl_PointSize = size;\",\r\n\t\t\t\"\t#endif\",\r\n\r\n\t\t\t\"\tgl_Position = projectionMatrix * mvPosition;\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"worldpos_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"shadowmap_vertex\" ],\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join( \"\\n\" ),\r\n\r\n\t\tfragmentShader: [\r\n\r\n\t\t\t\"uniform vec3 psColor;\",\r\n\t\t\t\"uniform float opacity;\",\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"color_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"map_particle_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"fog_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"shadowmap_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_fragment\" ],\r\n\r\n\t\t\t\"void main() {\",\r\n\r\n\t\t\t\"\tvec3 outgoingLight = vec3( 0.0 );\",\r\n\t\t\t\"\tvec4 diffuseColor = vec4( psColor, opacity );\",\r\n\t\t\t\"\tvec3 shadowMask = vec3( 1.0 );\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"map_particle_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"color_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"alphatest_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"shadowmap_fragment\" ],\r\n\r\n\t\t\t\"\toutgoingLight = diffuseColor.rgb * shadowMask;\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"fog_fragment\" ],\r\n\r\n\t\t\t\"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\",\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join( \"\\n\" )\r\n\r\n\t},\r\n\r\n\t'dashed': {\r\n\r\n\t\tuniforms: THREE.UniformsUtils.merge( [\r\n\r\n\t\t\tTHREE.UniformsLib[ \"common\" ],\r\n\t\t\tTHREE.UniformsLib[ \"fog\" ],\r\n\r\n\t\t\t{\r\n\t\t\t\t\"scale\"    : { type: \"f\", value: 1 },\r\n\t\t\t\t\"dashSize\" : { type: \"f\", value: 1 },\r\n\t\t\t\t\"totalSize\": { type: \"f\", value: 2 }\r\n\t\t\t}\r\n\r\n\t\t] ),\r\n\r\n\t\tvertexShader: [\r\n\r\n\t\t\t\"uniform float scale;\",\r\n\t\t\t\"attribute float lineDistance;\",\r\n\r\n\t\t\t\"varying float vLineDistance;\",\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"color_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_vertex\" ],\r\n\r\n\t\t\t\"void main() {\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"color_vertex\" ],\r\n\r\n\t\t\t\"\tvLineDistance = scale * lineDistance;\",\r\n\r\n\t\t\t\"\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\",\r\n\t\t\t\"\tgl_Position = projectionMatrix * mvPosition;\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_vertex\" ],\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join( \"\\n\" ),\r\n\r\n\t\tfragmentShader: [\r\n\r\n\t\t\t\"uniform vec3 diffuse;\",\r\n\t\t\t\"uniform float opacity;\",\r\n\r\n\t\t\t\"uniform float dashSize;\",\r\n\t\t\t\"uniform float totalSize;\",\r\n\r\n\t\t\t\"varying float vLineDistance;\",\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"color_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"fog_pars_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_fragment\" ],\r\n\r\n\t\t\t\"void main() {\",\r\n\r\n\t\t\t\"\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\",\r\n\r\n\t\t\t\"\t\tdiscard;\",\r\n\r\n\t\t\t\"\t}\",\r\n\r\n\t\t\t\"\tvec3 outgoingLight = vec3( 0.0 );\",\r\n\t\t\t\"\tvec4 diffuseColor = vec4( diffuse, opacity );\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_fragment\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"color_fragment\" ],\r\n\r\n\t\t\t\"\toutgoingLight = diffuseColor.rgb;\", // simple shader\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"fog_fragment\" ],\r\n\r\n\t\t\t\"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\",\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join( \"\\n\" )\r\n\r\n\t},\r\n\r\n\t'depth': {\r\n\r\n\t\tuniforms: {\r\n\r\n\t\t\t\"mNear\": { type: \"f\", value: 1.0 },\r\n\t\t\t\"mFar\" : { type: \"f\", value: 2000.0 },\r\n\t\t\t\"opacity\" : { type: \"f\", value: 1.0 }\r\n\r\n\t\t},\r\n\r\n\t\tvertexShader: [\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"morphtarget_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_vertex\" ],\r\n\r\n\t\t\t\"void main() {\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"begin_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"morphtarget_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"project_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_vertex\" ],\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join( \"\\n\" ),\r\n\r\n\t\tfragmentShader: [\r\n\r\n\t\t\t\"uniform float mNear;\",\r\n\t\t\t\"uniform float mFar;\",\r\n\t\t\t\"uniform float opacity;\",\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_fragment\" ],\r\n\r\n\t\t\t\"void main() {\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_fragment\" ],\r\n\r\n\t\t\t\"\t#ifdef USE_LOGDEPTHBUF_EXT\",\r\n\r\n\t\t\t\"\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\",\r\n\r\n\t\t\t\"\t#else\",\r\n\r\n\t\t\t\"\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\",\r\n\r\n\t\t\t\"\t#endif\",\r\n\r\n\t\t\t\"\tfloat color = 1.0 - smoothstep( mNear, mFar, depth );\",\r\n\t\t\t\"\tgl_FragColor = vec4( vec3( color ), opacity );\",\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join( \"\\n\" )\r\n\r\n\t},\r\n\r\n\t'normal': {\r\n\r\n\t\tuniforms: {\r\n\r\n\t\t\t\"opacity\" : { type: \"f\", value: 1.0 }\r\n\r\n\t\t},\r\n\r\n\t\tvertexShader: [\r\n\r\n\t\t\t\"varying vec3 vNormal;\",\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"morphtarget_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_vertex\" ],\r\n\r\n\t\t\t\"void main() {\",\r\n\r\n\t\t\t\"\tvNormal = normalize( normalMatrix * normal );\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"begin_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"morphtarget_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"project_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_vertex\" ],\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join( \"\\n\" ),\r\n\r\n\t\tfragmentShader: [\r\n\r\n\t\t\t\"uniform float opacity;\",\r\n\t\t\t\"varying vec3 vNormal;\",\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_fragment\" ],\r\n\r\n\t\t\t\"void main() {\",\r\n\r\n\t\t\t\"\tgl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_fragment\" ],\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join( \"\\n\" )\r\n\r\n\t},\r\n\r\n\t/* -------------------------------------------------------------------------\r\n\t//\tCube map shader\r\n\t ------------------------------------------------------------------------- */\r\n\r\n\t'cube': {\r\n\r\n\t\tuniforms: { \"tCube\": { type: \"t\", value: null },\r\n\t\t\t\t\t\"tFlip\": { type: \"f\", value: - 1 } },\r\n\r\n\t\tvertexShader: [\r\n\r\n\t\t\t\"varying vec3 vWorldPosition;\",\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_vertex\" ],\r\n\r\n\t\t\t\"void main() {\",\r\n\r\n\t\t\t\"\tvWorldPosition = transformDirection( position, modelMatrix );\",\r\n\r\n\t\t\t\"\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_vertex\" ],\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join( \"\\n\" ),\r\n\r\n\t\tfragmentShader: [\r\n\r\n\t\t\t\"uniform samplerCube tCube;\",\r\n\t\t\t\"uniform float tFlip;\",\r\n\r\n\t\t\t\"varying vec3 vWorldPosition;\",\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_fragment\" ],\r\n\r\n\t\t\t\"void main() {\",\r\n\r\n\t\t\t\"\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_fragment\" ],\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join( \"\\n\" )\r\n\r\n\t},\r\n\r\n\t/* -------------------------------------------------------------------------\r\n\t//\tCube map shader\r\n\t ------------------------------------------------------------------------- */\r\n\r\n\t'equirect': {\r\n\r\n\t\tuniforms: { \"tEquirect\": { type: \"t\", value: null },\r\n\t\t\t\t\t\"tFlip\": { type: \"f\", value: - 1 } },\r\n\r\n\t\tvertexShader: [\r\n\r\n\t\t\t\"varying vec3 vWorldPosition;\",\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_vertex\" ],\r\n\r\n\t\t\t\"void main() {\",\r\n\r\n\t\t\t\"\tvWorldPosition = transformDirection( position, modelMatrix );\",\r\n\r\n\t\t\t\"\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_vertex\" ],\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join( \"\\n\" ),\r\n\r\n\t\tfragmentShader: [\r\n\r\n\t\t\t\"uniform sampler2D tEquirect;\",\r\n\t\t\t\"uniform float tFlip;\",\r\n\r\n\t\t\t\"varying vec3 vWorldPosition;\",\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_fragment\" ],\r\n\r\n\t\t\t\"void main() {\",\r\n\r\n\t\t\t\t// \"\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\",\r\n\t\t\t\t\"vec3 direction = normalize( vWorldPosition );\",\r\n\t\t\t\t\"vec2 sampleUV;\",\r\n\t\t\t\t\"sampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );\",\r\n\t\t\t\t\"sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\",\r\n\t\t\t\t\"gl_FragColor = texture2D( tEquirect, sampleUV );\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_fragment\" ],\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join( \"\\n\" )\r\n\r\n\t},\r\n\r\n\t/* Depth encoding into RGBA texture\r\n\t *\r\n\t * based on SpiderGL shadow map example\r\n\t * http://spidergl.org/example.php?id=6\r\n\t *\r\n\t * originally from\r\n\t * http://www.gamedev.net/topic/442138-packing-a-float-into-a-a8r8g8b8-texture-shader/page__whichpage__1%25EF%25BF%25BD\r\n\t *\r\n\t * see also\r\n\t * http://aras-p.info/blog/2009/07/30/encoding-floats-to-rgba-the-final/\r\n\t */\r\n\r\n\t'depthRGBA': {\r\n\r\n\t\tuniforms: {},\r\n\r\n\t\tvertexShader: [\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"morphtarget_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"skinning_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_vertex\" ],\r\n\r\n\t\t\t\"void main() {\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"skinbase_vertex\" ],\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"begin_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"morphtarget_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"skinning_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"project_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_vertex\" ],\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join( \"\\n\" ),\r\n\r\n\t\tfragmentShader: [\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_fragment\" ],\r\n\r\n\t\t\t\"vec4 pack_depth( const in float depth ) {\",\r\n\r\n\t\t\t\"\tconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\",\r\n\t\t\t\"\tconst vec4 bit_mask = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\",\r\n\t\t\t\"\tvec4 res = mod( depth * bit_shift * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );\", // \"\tvec4 res = fract( depth * bit_shift );\",\r\n\t\t\t\"\tres -= res.xxyz * bit_mask;\",\r\n\t\t\t\"\treturn res;\",\r\n\r\n\t\t\t\"}\",\r\n\r\n\t\t\t\"void main() {\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_fragment\" ],\r\n\r\n\t\t\t\"\t#ifdef USE_LOGDEPTHBUF_EXT\",\r\n\r\n\t\t\t\"\t\tgl_FragData[ 0 ] = pack_depth( gl_FragDepthEXT );\",\r\n\r\n\t\t\t\"\t#else\",\r\n\r\n\t\t\t\"\t\tgl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );\",\r\n\r\n\t\t\t\"\t#endif\",\r\n\r\n\t\t\t\t//\"gl_FragData[ 0 ] = pack_depth( gl_FragCoord.z / gl_FragCoord.w );\",\r\n\t\t\t\t//\"float z = ( ( gl_FragCoord.z / gl_FragCoord.w ) - 3.0 ) / ( 4000.0 - 3.0 );\",\r\n\t\t\t\t//\"gl_FragData[ 0 ] = pack_depth( z );\",\r\n\t\t\t\t//\"gl_FragData[ 0 ] = vec4( z, z, z, 1.0 );\",\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join( \"\\n\" )\r\n\r\n\t},\r\n\r\n\r\n\t'distanceRGBA': {\r\n\r\n\t\tuniforms: {\r\n\r\n\t\t\t\"lightPos\": { type: \"v3\", value: new THREE.Vector3( 0, 0, 0 ) }\r\n\r\n\t\t},\r\n\r\n\t\tvertexShader: [\r\n\r\n\t\t\t\"varying vec4 vWorldPosition;\",\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"morphtarget_pars_vertex\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"skinning_pars_vertex\" ],\r\n\r\n\t\t\t\"void main() {\",\r\n\r\n\t\t\t\tTHREE.ShaderChunk[ \"skinbase_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"begin_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"morphtarget_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"skinning_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"project_vertex\" ],\r\n\t\t\t\tTHREE.ShaderChunk[ \"worldpos_vertex\" ],\r\n\r\n\t\t\t\t\"vWorldPosition = worldPosition;\",\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join( \"\\n\" ),\r\n\r\n\t\tfragmentShader: [\r\n\r\n\t\t\t\"uniform vec3 lightPos;\",\r\n\t\t\t\"varying vec4 vWorldPosition;\",\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\r\n\r\n\t\t\t\"vec4 pack1K ( float depth ) {\",\r\n\r\n\t\t\t\"   depth /= 1000.0;\",\r\n\t\t\t\"   const vec4 bitSh = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\",\r\n  \t\t\t\"\tconst vec4 bitMsk = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\",\r\n   \t\t\t\"\tvec4 res = fract( depth * bitSh );\",\r\n   \t\t\t\"\tres -= res.xxyz * bitMsk;\",\r\n   \t\t\t\"\treturn res; \",\r\n\r\n\t\t\t\"}\",\r\n\r\n\t\t\t\"float unpack1K ( vec4 color ) {\",\r\n\r\n\t\t\t\"\tconst vec4 bitSh = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\",\r\n\t\t\t\"\treturn dot( color, bitSh ) * 1000.0;\",\r\n\r\n\t\t\t\"}\",\r\n\r\n\t\t\t\"void main () {\",\r\n\r\n\t\t\t\"\tgl_FragColor = pack1K( length( vWorldPosition.xyz - lightPos.xyz ) );\",\r\n\r\n\t\t\t\"}\"\r\n\r\n\t\t].join( \"\\n\" )\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/renderers/WebGLRenderer.js\r\n\r\n/**\r\n * @author supereggbert / http://www.paulbrunt.co.uk/\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author szimek / https://github.com/szimek/\r\n */\r\n\r\nTHREE.WebGLRenderer = function ( parameters ) {\r\n\r\n\tconsole.log( 'THREE.WebGLRenderer', THREE.REVISION );\r\n\r\n\tparameters = parameters || {};\r\n\r\n\tvar _canvas = parameters.canvas !== undefined ? parameters.canvas : document.createElement( 'canvas' ),\r\n\t_context = parameters.context !== undefined ? parameters.context : null,\r\n\r\n\t_width = _canvas.width,\r\n\t_height = _canvas.height,\r\n\r\n\tpixelRatio = 1,\r\n\r\n\t_alpha = parameters.alpha !== undefined ? parameters.alpha : false,\r\n\t_depth = parameters.depth !== undefined ? parameters.depth : true,\r\n\t_stencil = parameters.stencil !== undefined ? parameters.stencil : true,\r\n\t_antialias = parameters.antialias !== undefined ? parameters.antialias : false,\r\n\t_premultipliedAlpha = parameters.premultipliedAlpha !== undefined ? parameters.premultipliedAlpha : true,\r\n\t_preserveDrawingBuffer = parameters.preserveDrawingBuffer !== undefined ? parameters.preserveDrawingBuffer : false,\r\n\r\n\t_clearColor = new THREE.Color( 0x000000 ),\r\n\t_clearAlpha = 0;\r\n\r\n\tvar lights = [];\r\n\r\n\tvar opaqueObjects = [];\r\n\tvar opaqueObjectsLastIndex = - 1;\r\n\tvar transparentObjects = [];\r\n\tvar transparentObjectsLastIndex = - 1;\r\n\r\n\tvar morphInfluences = new Float32Array( 8 );\r\n\r\n\r\n\tvar sprites = [];\r\n\tvar lensFlares = [];\r\n\r\n\t// public properties\r\n\r\n\tthis.domElement = _canvas;\r\n\tthis.context = null;\r\n\r\n\t// clearing\r\n\r\n\tthis.autoClear = true;\r\n\tthis.autoClearColor = true;\r\n\tthis.autoClearDepth = true;\r\n\tthis.autoClearStencil = true;\r\n\r\n\t// scene graph\r\n\r\n\tthis.sortObjects = true;\r\n\r\n\t// physically based shading\r\n\r\n\tthis.gammaFactor = 2.0;\t// for backwards compatibility\r\n\tthis.gammaInput = false;\r\n\tthis.gammaOutput = false;\r\n\r\n\t// morphs\r\n\r\n\tthis.maxMorphTargets = 8;\r\n\tthis.maxMorphNormals = 4;\r\n\r\n\t// flags\r\n\r\n\tthis.autoScaleCubemaps = true;\r\n\r\n\t// internal properties\r\n\r\n\tvar _this = this,\r\n\r\n\t// internal state cache\r\n\r\n\t_currentProgram = null,\r\n\t_currentFramebuffer = null,\r\n\t_currentMaterialId = - 1,\r\n\t_currentGeometryProgram = '',\r\n\t_currentCamera = null,\r\n\r\n\t_usedTextureUnits = 0,\r\n\r\n\t_viewportX = 0,\r\n\t_viewportY = 0,\r\n\t_viewportWidth = _canvas.width,\r\n\t_viewportHeight = _canvas.height,\r\n\t_currentWidth = 0,\r\n\t_currentHeight = 0,\r\n\r\n\t// frustum\r\n\r\n\t_frustum = new THREE.Frustum(),\r\n\r\n\t // camera matrices cache\r\n\r\n\t_projScreenMatrix = new THREE.Matrix4(),\r\n\r\n\t_vector3 = new THREE.Vector3(),\r\n\r\n\t// light arrays cache\r\n\r\n\t_direction = new THREE.Vector3(),\r\n\r\n\t_lightsNeedUpdate = true,\r\n\r\n\t_lights = {\r\n\r\n\t\tambient: [ 0, 0, 0 ],\r\n\t\tdirectional: { length: 0, colors: [], positions: [] },\r\n\t\tpoint: { length: 0, colors: [], positions: [], distances: [], decays: [] },\r\n\t\tspot: { length: 0, colors: [], positions: [], distances: [], directions: [], anglesCos: [], exponents: [], decays: [] },\r\n\t\themi: { length: 0, skyColors: [], groundColors: [], positions: [] }\r\n\r\n\t},\r\n\r\n\t// info\r\n\r\n\t_infoMemory = {\r\n\r\n\t\tgeometries: 0,\r\n\t\ttextures: 0\r\n\r\n\t},\r\n\r\n\t_infoRender = {\r\n\r\n\t\tcalls: 0,\r\n\t\tvertices: 0,\r\n\t\tfaces: 0,\r\n\t\tpoints: 0\r\n\r\n\t};\r\n\r\n\tthis.info = {\r\n\r\n\t\trender: _infoRender,\r\n\t\tmemory: _infoMemory,\r\n\t\tprograms: null\r\n\r\n\t};\r\n\r\n\r\n\t// initialize\r\n\r\n\tvar _gl;\r\n\r\n\ttry {\r\n\r\n\t\tvar attributes = {\r\n\t\t\talpha: _alpha,\r\n\t\t\tdepth: _depth,\r\n\t\t\tstencil: _stencil,\r\n\t\t\tantialias: _antialias,\r\n\t\t\tpremultipliedAlpha: _premultipliedAlpha,\r\n\t\t\tpreserveDrawingBuffer: _preserveDrawingBuffer\r\n\t\t};\r\n\r\n\t\t_gl = _context || _canvas.getContext( 'webgl', attributes ) || _canvas.getContext( 'experimental-webgl', attributes );\r\n\r\n\t\tif ( _gl === null ) {\r\n\r\n\t\t\tif ( _canvas.getContext( 'webgl' ) !== null ) {\r\n\r\n\t\t\t\tthrow 'Error creating WebGL context with your selected attributes.';\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthrow 'Error creating WebGL context.';\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t_canvas.addEventListener( 'webglcontextlost', onContextLost, false );\r\n\r\n\t} catch ( error ) {\r\n\r\n\t\tconsole.error( 'THREE.WebGLRenderer: ' + error );\r\n\r\n\t}\r\n\r\n\tvar extensions = new THREE.WebGLExtensions( _gl );\r\n\r\n\textensions.get( 'OES_texture_float' );\r\n\textensions.get( 'OES_texture_float_linear' );\r\n\textensions.get( 'OES_texture_half_float' );\r\n\textensions.get( 'OES_texture_half_float_linear' );\r\n\textensions.get( 'OES_standard_derivatives' );\r\n\textensions.get( 'ANGLE_instanced_arrays' );\r\n\r\n\tif ( extensions.get( 'OES_element_index_uint' ) ) {\r\n\r\n\t\tTHREE.BufferGeometry.MaxIndex = 4294967296;\r\n\r\n\t}\r\n\r\n\tvar capabilities = new THREE.WebGLCapabilities( _gl, extensions, parameters );\r\n\r\n\tvar state = new THREE.WebGLState( _gl, extensions, paramThreeToGL );\r\n\tvar properties = new THREE.WebGLProperties();\r\n\tvar objects = new THREE.WebGLObjects( _gl, properties, this.info );\r\n\tvar programCache = new THREE.WebGLPrograms( this, capabilities );\r\n\r\n\tthis.info.programs = programCache.programs;\r\n\r\n\tvar bufferRenderer = new THREE.WebGLBufferRenderer( _gl, extensions, _infoRender );\r\n\tvar indexedBufferRenderer = new THREE.WebGLIndexedBufferRenderer( _gl, extensions, _infoRender );\r\n\r\n\t//\r\n\r\n\tfunction glClearColor( r, g, b, a ) {\r\n\r\n\t\tif ( _premultipliedAlpha === true ) {\r\n\r\n\t\t\tr *= a; g *= a; b *= a;\r\n\r\n\t\t}\r\n\r\n\t\t_gl.clearColor( r, g, b, a );\r\n\r\n\t}\r\n\r\n\tfunction setDefaultGLState() {\r\n\r\n\t\tstate.init();\r\n\r\n\t\t_gl.viewport( _viewportX, _viewportY, _viewportWidth, _viewportHeight );\r\n\r\n\t\tglClearColor( _clearColor.r, _clearColor.g, _clearColor.b, _clearAlpha );\r\n\r\n\t}\r\n\r\n\tfunction resetGLState() {\r\n\r\n\t\t_currentProgram = null;\r\n\t\t_currentCamera = null;\r\n\r\n\t\t_currentGeometryProgram = '';\r\n\t\t_currentMaterialId = - 1;\r\n\r\n\t\t_lightsNeedUpdate = true;\r\n\r\n\t\tstate.reset();\r\n\r\n\t}\r\n\r\n\tsetDefaultGLState();\r\n\r\n\tthis.context = _gl;\r\n\tthis.capabilities = capabilities;\r\n\tthis.extensions = extensions;\r\n\tthis.state = state;\r\n\r\n\t// shadow map\r\n\r\n\tvar shadowMap = new THREE.WebGLShadowMap( this, lights, objects );\r\n\r\n\tthis.shadowMap = shadowMap;\r\n\r\n\r\n\t// Plugins\r\n\r\n\tvar spritePlugin = new THREE.SpritePlugin( this, sprites );\r\n\tvar lensFlarePlugin = new THREE.LensFlarePlugin( this, lensFlares );\r\n\r\n\t// API\r\n\r\n\tthis.getContext = function () {\r\n\r\n\t\treturn _gl;\r\n\r\n\t};\r\n\r\n\tthis.getContextAttributes = function () {\r\n\r\n\t\treturn _gl.getContextAttributes();\r\n\r\n\t};\r\n\r\n\tthis.forceContextLoss = function () {\r\n\r\n\t\textensions.get( 'WEBGL_lose_context' ).loseContext();\r\n\r\n\t};\r\n\r\n\tthis.getMaxAnisotropy = ( function () {\r\n\r\n\t\tvar value;\r\n\r\n\t\treturn function getMaxAnisotropy() {\r\n\r\n\t\t\tif ( value !== undefined ) return value;\r\n\r\n\t\t\tvar extension = extensions.get( 'EXT_texture_filter_anisotropic' );\r\n\r\n\t\t\tif ( extension !== null ) {\r\n\r\n\t\t\t\tvalue = _gl.getParameter( extension.MAX_TEXTURE_MAX_ANISOTROPY_EXT );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvalue = 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn value;\r\n\r\n\t\t}\r\n\r\n\t} )();\r\n\r\n\tthis.getPrecision = function () {\r\n\r\n\t\treturn capabilities.precision;\r\n\r\n\t};\r\n\r\n\tthis.getPixelRatio = function () {\r\n\r\n\t\treturn pixelRatio;\r\n\r\n\t};\r\n\r\n\tthis.setPixelRatio = function ( value ) {\r\n\r\n\t\tif ( value !== undefined ) pixelRatio = value;\r\n\r\n\t};\r\n\r\n\tthis.getSize = function () {\r\n\r\n\t\treturn {\r\n\t\t\twidth: _width,\r\n\t\t\theight: _height\r\n\t\t};\r\n\r\n\t};\r\n\r\n\tthis.setSize = function ( width, height, updateStyle ) {\r\n\r\n\t\t_width = width;\r\n\t\t_height = height;\r\n\r\n\t\t_canvas.width = width * pixelRatio;\r\n\t\t_canvas.height = height * pixelRatio;\r\n\r\n\t\tif ( updateStyle !== false ) {\r\n\r\n\t\t\t_canvas.style.width = width + 'px';\r\n\t\t\t_canvas.style.height = height + 'px';\r\n\r\n\t\t}\r\n\r\n\t\tthis.setViewport( 0, 0, width, height );\r\n\r\n\t};\r\n\r\n\tthis.setViewport = function ( x, y, width, height ) {\r\n\r\n\t\t_viewportX = x * pixelRatio;\r\n\t\t_viewportY = y * pixelRatio;\r\n\r\n\t\t_viewportWidth = width * pixelRatio;\r\n\t\t_viewportHeight = height * pixelRatio;\r\n\r\n\t\t_gl.viewport( _viewportX, _viewportY, _viewportWidth, _viewportHeight );\r\n\r\n\t};\r\n\r\n\tthis.getViewport = function ( dimensions ) {\r\n\r\n\t\tdimensions.x = _viewportX / pixelRatio;\r\n\t\tdimensions.y = _viewportY / pixelRatio;\r\n\r\n\t\tdimensions.z = _viewportWidth / pixelRatio;\r\n\t\tdimensions.w = _viewportHeight / pixelRatio;\r\n\r\n\t};\r\n\r\n\tthis.setScissor = function ( x, y, width, height ) {\r\n\r\n\t\t_gl.scissor(\r\n\t\t\tx * pixelRatio,\r\n\t\t\ty * pixelRatio,\r\n\t\t\twidth * pixelRatio,\r\n\t\t\theight * pixelRatio\r\n\t\t);\r\n\r\n\t};\r\n\r\n\tthis.enableScissorTest = function ( boolean ) {\r\n\r\n\t\tstate.setScissorTest( boolean );\r\n\r\n\t};\r\n\r\n\t// Clearing\r\n\r\n\tthis.getClearColor = function () {\r\n\r\n\t\treturn _clearColor;\r\n\r\n\t};\r\n\r\n\tthis.setClearColor = function ( color, alpha ) {\r\n\r\n\t\t_clearColor.set( color );\r\n\r\n\t\t_clearAlpha = alpha !== undefined ? alpha : 1;\r\n\r\n\t\tglClearColor( _clearColor.r, _clearColor.g, _clearColor.b, _clearAlpha );\r\n\r\n\t};\r\n\r\n\tthis.getClearAlpha = function () {\r\n\r\n\t\treturn _clearAlpha;\r\n\r\n\t};\r\n\r\n\tthis.setClearAlpha = function ( alpha ) {\r\n\r\n\t\t_clearAlpha = alpha;\r\n\r\n\t\tglClearColor( _clearColor.r, _clearColor.g, _clearColor.b, _clearAlpha );\r\n\r\n\t};\r\n\r\n\tthis.clear = function ( color, depth, stencil ) {\r\n\r\n\t\tvar bits = 0;\r\n\r\n\t\tif ( color === undefined || color ) bits |= _gl.COLOR_BUFFER_BIT;\r\n\t\tif ( depth === undefined || depth ) bits |= _gl.DEPTH_BUFFER_BIT;\r\n\t\tif ( stencil === undefined || stencil ) bits |= _gl.STENCIL_BUFFER_BIT;\r\n\r\n\t\t_gl.clear( bits );\r\n\r\n\t};\r\n\r\n\tthis.clearColor = function () {\r\n\r\n\t\t_gl.clear( _gl.COLOR_BUFFER_BIT );\r\n\r\n\t};\r\n\r\n\tthis.clearDepth = function () {\r\n\r\n\t\t_gl.clear( _gl.DEPTH_BUFFER_BIT );\r\n\r\n\t};\r\n\r\n\tthis.clearStencil = function () {\r\n\r\n\t\t_gl.clear( _gl.STENCIL_BUFFER_BIT );\r\n\r\n\t};\r\n\r\n\tthis.clearTarget = function ( renderTarget, color, depth, stencil ) {\r\n\r\n\t\tthis.setRenderTarget( renderTarget );\r\n\t\tthis.clear( color, depth, stencil );\r\n\r\n\t};\r\n\r\n\t// Reset\r\n\r\n\tthis.resetGLState = resetGLState;\r\n\r\n\tthis.dispose = function() {\r\n\r\n\t\t_canvas.removeEventListener( 'webglcontextlost', onContextLost, false );\r\n\r\n\t};\r\n\r\n\t// Events\r\n\r\n\tfunction onContextLost( event ) {\r\n\r\n\t\tevent.preventDefault();\r\n\r\n\t\tresetGLState();\r\n\t\tsetDefaultGLState();\r\n\r\n\t\tproperties.clear();\r\n\r\n\t};\r\n\r\n\tfunction onTextureDispose( event ) {\r\n\r\n\t\tvar texture = event.target;\r\n\r\n\t\ttexture.removeEventListener( 'dispose', onTextureDispose );\r\n\r\n\t\tdeallocateTexture( texture );\r\n\r\n\t\t_infoMemory.textures --;\r\n\r\n\r\n\t}\r\n\r\n\tfunction onRenderTargetDispose( event ) {\r\n\r\n\t\tvar renderTarget = event.target;\r\n\r\n\t\trenderTarget.removeEventListener( 'dispose', onRenderTargetDispose );\r\n\r\n\t\tdeallocateRenderTarget( renderTarget );\r\n\r\n\t\t_infoMemory.textures --;\r\n\r\n\t}\r\n\r\n\tfunction onMaterialDispose( event ) {\r\n\r\n\t\tvar material = event.target;\r\n\r\n\t\tmaterial.removeEventListener( 'dispose', onMaterialDispose );\r\n\r\n\t\tdeallocateMaterial( material );\r\n\r\n\t}\r\n\r\n\t// Buffer deallocation\r\n\r\n\tfunction deallocateTexture( texture ) {\r\n\r\n\t\tvar textureProperties = properties.get( texture );\r\n\r\n\t\tif ( texture.image && textureProperties.__image__webglTextureCube ) {\r\n\r\n\t\t\t// cube texture\r\n\r\n\t\t\t_gl.deleteTexture( textureProperties.__image__webglTextureCube );\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// 2D texture\r\n\r\n\t\t\tif ( textureProperties.__webglInit === undefined ) return;\r\n\r\n\t\t\t_gl.deleteTexture( textureProperties.__webglTexture );\r\n\r\n\t\t}\r\n\r\n\t\t// remove all webgl properties\r\n\t\tproperties.delete( texture );\r\n\r\n\t}\r\n\r\n\tfunction deallocateRenderTarget( renderTarget ) {\r\n\r\n\t\tvar renderTargetProperties = properties.get( renderTarget );\r\n\t\tvar textureProperties = properties.get( renderTarget.texture );\r\n\r\n\t\tif ( ! renderTarget || textureProperties.__webglTexture === undefined ) return;\r\n\r\n\t\t_gl.deleteTexture( textureProperties.__webglTexture );\r\n\r\n\t\tif ( renderTarget instanceof THREE.WebGLRenderTargetCube ) {\r\n\r\n\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\t_gl.deleteFramebuffer( renderTargetProperties.__webglFramebuffer[ i ] );\r\n\t\t\t\t_gl.deleteRenderbuffer( renderTargetProperties.__webglRenderbuffer[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\t_gl.deleteFramebuffer( renderTargetProperties.__webglFramebuffer );\r\n\t\t\t_gl.deleteRenderbuffer( renderTargetProperties.__webglRenderbuffer );\r\n\r\n\t\t}\r\n\r\n\t\tproperties.delete( renderTarget.texture );\r\n\t\tproperties.delete( renderTarget );\r\n\r\n\t}\r\n\r\n\tfunction deallocateMaterial( material ) {\r\n\r\n\t\treleaseMaterialProgramReference( material );\r\n\r\n\t\tproperties.delete( material );\r\n\r\n\t}\r\n\r\n\r\n\tfunction releaseMaterialProgramReference( material ) {\r\n\r\n\t\tvar programInfo = properties.get( material ).program;\r\n\r\n\t\tmaterial.program = undefined;\r\n\r\n\t\tif ( programInfo !== undefined ) {\r\n\r\n\t\t\tprogramCache.releaseProgram( programInfo );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// Buffer rendering\r\n\r\n\tthis.renderBufferImmediate = function ( object, program, material ) {\r\n\r\n\t\tstate.initAttributes();\r\n\r\n\t\tvar buffers = properties.get( object );\r\n\r\n\t\tif ( object.hasPositions && ! buffers.position ) buffers.position = _gl.createBuffer();\r\n\t\tif ( object.hasNormals && ! buffers.normal ) buffers.normal = _gl.createBuffer();\r\n\t\tif ( object.hasUvs && ! buffers.uv ) buffers.uv = _gl.createBuffer();\r\n\t\tif ( object.hasColors && ! buffers.color ) buffers.color = _gl.createBuffer();\r\n\r\n\t\tvar attributes = program.getAttributes();\r\n\r\n\t\tif ( object.hasPositions ) {\r\n\r\n\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffers.position );\r\n\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, object.positionArray, _gl.DYNAMIC_DRAW );\r\n\r\n\t\t\tstate.enableAttribute( attributes.position );\r\n\t\t\t_gl.vertexAttribPointer( attributes.position, 3, _gl.FLOAT, false, 0, 0 );\r\n\r\n\t\t}\r\n\r\n\t\tif ( object.hasNormals ) {\r\n\r\n\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffers.normal );\r\n\r\n\t\t\tif ( material.type !== 'MeshPhongMaterial' && material.shading === THREE.FlatShading ) {\r\n\r\n\t\t\t\tfor ( var i = 0, l = object.count * 3; i < l; i += 9 ) {\r\n\r\n\t\t\t\t\tvar array = object.normalArray;\r\n\r\n\t\t\t\t\tvar nx = ( array[ i + 0 ] + array[ i + 3 ] + array[ i + 6 ] ) / 3;\r\n\t\t\t\t\tvar ny = ( array[ i + 1 ] + array[ i + 4 ] + array[ i + 7 ] ) / 3;\r\n\t\t\t\t\tvar nz = ( array[ i + 2 ] + array[ i + 5 ] + array[ i + 8 ] ) / 3;\r\n\r\n\t\t\t\t\tarray[ i + 0 ] = nx;\r\n\t\t\t\t\tarray[ i + 1 ] = ny;\r\n\t\t\t\t\tarray[ i + 2 ] = nz;\r\n\r\n\t\t\t\t\tarray[ i + 3 ] = nx;\r\n\t\t\t\t\tarray[ i + 4 ] = ny;\r\n\t\t\t\t\tarray[ i + 5 ] = nz;\r\n\r\n\t\t\t\t\tarray[ i + 6 ] = nx;\r\n\t\t\t\t\tarray[ i + 7 ] = ny;\r\n\t\t\t\t\tarray[ i + 8 ] = nz;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, object.normalArray, _gl.DYNAMIC_DRAW );\r\n\r\n\t\t\tstate.enableAttribute( attributes.normal );\r\n\r\n\t\t\t_gl.vertexAttribPointer( attributes.normal, 3, _gl.FLOAT, false, 0, 0 );\r\n\r\n\t\t}\r\n\r\n\t\tif ( object.hasUvs && material.map ) {\r\n\r\n\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffers.uv );\r\n\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, object.uvArray, _gl.DYNAMIC_DRAW );\r\n\r\n\t\t\tstate.enableAttribute( attributes.uv );\r\n\r\n\t\t\t_gl.vertexAttribPointer( attributes.uv, 2, _gl.FLOAT, false, 0, 0 );\r\n\r\n\t\t}\r\n\r\n\t\tif ( object.hasColors && material.vertexColors !== THREE.NoColors ) {\r\n\r\n\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffers.color );\r\n\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, object.colorArray, _gl.DYNAMIC_DRAW );\r\n\r\n\t\t\tstate.enableAttribute( attributes.color );\r\n\r\n\t\t\t_gl.vertexAttribPointer( attributes.color, 3, _gl.FLOAT, false, 0, 0 );\r\n\r\n\t\t}\r\n\r\n\t\tstate.disableUnusedAttributes();\r\n\r\n\t\t_gl.drawArrays( _gl.TRIANGLES, 0, object.count );\r\n\r\n\t\tobject.count = 0;\r\n\r\n\t};\r\n\r\n\tthis.renderBufferDirect = function ( camera, lights, fog, geometry, material, object, group ) {\r\n\r\n\t\tsetMaterial( material );\r\n\r\n\t\tvar program = setProgram( camera, lights, fog, material, object );\r\n\r\n\t\tvar updateBuffers = false;\r\n\t\tvar geometryProgram = geometry.id + '_' + program.id + '_' + material.wireframe;\r\n\r\n\t\tif ( geometryProgram !== _currentGeometryProgram ) {\r\n\r\n\t\t\t_currentGeometryProgram = geometryProgram;\r\n\t\t\tupdateBuffers = true;\r\n\r\n\t\t}\r\n\r\n\t\t// morph targets\r\n\r\n\t\tvar morphTargetInfluences = object.morphTargetInfluences;\r\n\r\n\t\tif ( morphTargetInfluences !== undefined ) {\r\n\r\n\t\t\tvar activeInfluences = [];\r\n\r\n\t\t\tfor ( var i = 0, l = morphTargetInfluences.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar influence = morphTargetInfluences[ i ];\r\n\t\t\t\tactiveInfluences.push( [ influence, i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tactiveInfluences.sort( numericalSort );\r\n\r\n\t\t\tif ( activeInfluences.length > 8 ) {\r\n\r\n\t\t\t\tactiveInfluences.length = 8;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar morphAttributes = geometry.morphAttributes;\r\n\r\n\t\t\tfor ( var i = 0, l = activeInfluences.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar influence = activeInfluences[ i ];\r\n\t\t\t\tmorphInfluences[ i ] = influence[ 0 ];\r\n\r\n\t\t\t\tif ( influence[ 0 ] !== 0 ) {\r\n\r\n\t\t\t\t\tvar index = influence[ 1 ];\r\n\r\n\t\t\t\t\tif ( material.morphTargets === true && morphAttributes.position ) geometry.addAttribute( 'morphTarget' + i, morphAttributes.position[ index ] );\r\n\t\t\t\t\tif ( material.morphNormals === true && morphAttributes.normal ) geometry.addAttribute( 'morphNormal' + i, morphAttributes.normal[ index ] );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tif ( material.morphTargets === true ) geometry.removeAttribute( 'morphTarget' + i );\r\n\t\t\t\t\tif ( material.morphNormals === true ) geometry.removeAttribute( 'morphNormal' + i );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar uniforms = program.getUniforms();\r\n\r\n\t\t\tif ( uniforms.morphTargetInfluences !== null ) {\r\n\r\n\t\t\t\t_gl.uniform1fv( uniforms.morphTargetInfluences, morphInfluences );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tupdateBuffers = true;\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tvar index = geometry.index;\r\n\t\tvar position = geometry.attributes.position;\r\n\r\n\t\tif ( material.wireframe === true ) {\r\n\r\n\t\t\tindex = objects.getWireframeAttribute( geometry );\r\n\r\n\t\t}\r\n\r\n\t\tvar renderer;\r\n\r\n\t\tif ( index !== null ) {\r\n\r\n\t\t\trenderer = indexedBufferRenderer;\r\n\t\t\trenderer.setIndex( index );\r\n\r\n\t\t} else {\r\n\r\n\t\t\trenderer = bufferRenderer;\r\n\r\n\t\t}\r\n\r\n\t\tif ( updateBuffers ) {\r\n\r\n\t\t\tsetupVertexAttributes( material, program, geometry );\r\n\r\n\t\t\tif ( index !== null ) {\r\n\r\n\t\t\t\t_gl.bindBuffer( _gl.ELEMENT_ARRAY_BUFFER, objects.getAttributeBuffer( index ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tvar dataStart = 0;\r\n\t\tvar dataCount = Infinity;\r\n\r\n\t\tif ( index !== null ) {\r\n\r\n\t\t\tdataCount = index.count\r\n\r\n\t\t} else if ( position !== undefined ) {\r\n\r\n\t\t\tdataCount = position.count;\r\n\r\n\t\t}\r\n\r\n\t\tvar rangeStart = geometry.drawRange.start;\r\n\t\tvar rangeCount = geometry.drawRange.count;\r\n\r\n\t\tvar groupStart = group !== null ? group.start : 0;\r\n\t\tvar groupCount = group !== null ? group.count : Infinity;\r\n\r\n\t\tvar drawStart = Math.max( dataStart, rangeStart, groupStart );\r\n\t\tvar drawEnd = Math.min( dataStart + dataCount, rangeStart + rangeCount, groupStart + groupCount ) - 1;\r\n\r\n\t\tvar drawCount = Math.max( 0, drawEnd - drawStart + 1 );\r\n\r\n\t\t//\r\n\r\n\t\tif ( object instanceof THREE.Mesh ) {\r\n\r\n\t\t\tif ( material.wireframe === true ) {\r\n\r\n\t\t\t\tstate.setLineWidth( material.wireframeLinewidth * pixelRatio );\r\n\t\t\t\trenderer.setMode( _gl.LINES );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\trenderer.setMode( _gl.TRIANGLES );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( geometry instanceof THREE.InstancedBufferGeometry && geometry.maxInstancedCount > 0 ) {\r\n\r\n\t\t\t\trenderer.renderInstances( geometry );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\trenderer.render( drawStart, drawCount );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( object instanceof THREE.Line ) {\r\n\r\n\t\t\tvar lineWidth = material.linewidth;\r\n\r\n\t\t\tif ( lineWidth === undefined ) lineWidth = 1; // Not using Line*Material\r\n\r\n\t\t\tstate.setLineWidth( lineWidth * pixelRatio );\r\n\r\n\t\t\tif ( object instanceof THREE.LineSegments ) {\r\n\r\n\t\t\t\trenderer.setMode( _gl.LINES );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\trenderer.setMode( _gl.LINE_STRIP );\r\n\r\n\t\t\t}\r\n\r\n\t\t\trenderer.render( drawStart, drawCount );\r\n\r\n\t\t} else if ( object instanceof THREE.Points ) {\r\n\r\n\t\t\trenderer.setMode( _gl.POINTS );\r\n\t\t\trenderer.render( drawStart, drawCount );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tfunction setupVertexAttributes( material, program, geometry, startIndex ) {\r\n\r\n\t\tvar extension;\r\n\r\n\t\tif ( geometry instanceof THREE.InstancedBufferGeometry ) {\r\n\r\n\t\t\textension = extensions.get( 'ANGLE_instanced_arrays' );\r\n\r\n\t\t\tif ( extension === null ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.' );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( startIndex === undefined ) startIndex = 0;\r\n\r\n\t\tstate.initAttributes();\r\n\r\n\t\tvar geometryAttributes = geometry.attributes;\r\n\r\n\t\tvar programAttributes = program.getAttributes();\r\n\r\n\t\tvar materialDefaultAttributeValues = material.defaultAttributeValues;\r\n\r\n\t\tfor ( var name in programAttributes ) {\r\n\r\n\t\t\tvar programAttribute = programAttributes[ name ];\r\n\r\n\t\t\tif ( programAttribute >= 0 ) {\r\n\r\n\t\t\t\tvar geometryAttribute = geometryAttributes[ name ];\r\n\r\n\t\t\t\tif ( geometryAttribute !== undefined ) {\r\n\r\n\t\t\t\t\tvar size = geometryAttribute.itemSize;\r\n\t\t\t\t\tvar buffer = objects.getAttributeBuffer( geometryAttribute );\r\n\r\n\t\t\t\t\tif ( geometryAttribute instanceof THREE.InterleavedBufferAttribute ) {\r\n\r\n\t\t\t\t\t\tvar data = geometryAttribute.data;\r\n\t\t\t\t\t\tvar stride = data.stride;\r\n\t\t\t\t\t\tvar offset = geometryAttribute.offset;\r\n\r\n\t\t\t\t\t\tif ( data instanceof THREE.InstancedInterleavedBuffer ) {\r\n\r\n\t\t\t\t\t\t\tstate.enableAttributeAndDivisor( programAttribute, data.meshPerAttribute, extension );\r\n\r\n\t\t\t\t\t\t\tif ( geometry.maxInstancedCount === undefined ) {\r\n\r\n\t\t\t\t\t\t\t\tgeometry.maxInstancedCount = data.meshPerAttribute * data.count;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tstate.enableAttribute( programAttribute );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffer );\r\n\t\t\t\t\t\t_gl.vertexAttribPointer( programAttribute, size, _gl.FLOAT, false, stride * data.array.BYTES_PER_ELEMENT, ( startIndex * stride + offset ) * data.array.BYTES_PER_ELEMENT );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tif ( geometryAttribute instanceof THREE.InstancedBufferAttribute ) {\r\n\r\n\t\t\t\t\t\t\tstate.enableAttributeAndDivisor( programAttribute, geometryAttribute.meshPerAttribute, extension );\r\n\r\n\t\t\t\t\t\t\tif ( geometry.maxInstancedCount === undefined ) {\r\n\r\n\t\t\t\t\t\t\t\tgeometry.maxInstancedCount = geometryAttribute.meshPerAttribute * geometryAttribute.count;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tstate.enableAttribute( programAttribute );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffer );\r\n\t\t\t\t\t\t_gl.vertexAttribPointer( programAttribute, size, _gl.FLOAT, false, 0, startIndex * size * 4 ); // 4 bytes per Float32\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else if ( materialDefaultAttributeValues !== undefined ) {\r\n\r\n\t\t\t\t\tvar value = materialDefaultAttributeValues[ name ];\r\n\r\n\t\t\t\t\tif ( value !== undefined ) {\r\n\r\n\t\t\t\t\t\tswitch ( value.length ) {\r\n\r\n\t\t\t\t\t\t\tcase 2:\r\n\t\t\t\t\t\t\t\t_gl.vertexAttrib2fv( programAttribute, value );\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\tcase 3:\r\n\t\t\t\t\t\t\t\t_gl.vertexAttrib3fv( programAttribute, value );\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\tcase 4:\r\n\t\t\t\t\t\t\t\t_gl.vertexAttrib4fv( programAttribute, value );\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\t\t_gl.vertexAttrib1fv( programAttribute, value );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tstate.disableUnusedAttributes();\r\n\r\n\t}\r\n\r\n\t// Sorting\r\n\r\n\tfunction numericalSort ( a, b ) {\r\n\r\n\t\treturn b[ 0 ] - a[ 0 ];\r\n\r\n\t}\r\n\r\n\tfunction painterSortStable ( a, b ) {\r\n\r\n\t\tif ( a.object.renderOrder !== b.object.renderOrder ) {\r\n\r\n\t\t\treturn a.object.renderOrder - b.object.renderOrder;\r\n\r\n\t\t} else if ( a.material.id !== b.material.id ) {\r\n\r\n\t\t\treturn a.material.id - b.material.id;\r\n\r\n\t\t} else if ( a.z !== b.z ) {\r\n\r\n\t\t\treturn a.z - b.z;\r\n\r\n\t\t} else {\r\n\r\n\t\t\treturn a.id - b.id;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction reversePainterSortStable ( a, b ) {\r\n\r\n\t\tif ( a.object.renderOrder !== b.object.renderOrder ) {\r\n\r\n\t\t\treturn a.object.renderOrder - b.object.renderOrder;\r\n\r\n\t\t} if ( a.z !== b.z ) {\r\n\r\n\t\t\treturn b.z - a.z;\r\n\r\n\t\t} else {\r\n\r\n\t\t\treturn a.id - b.id;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// Rendering\r\n\r\n\tthis.render = function ( scene, camera, renderTarget, forceClear ) {\r\n\r\n\t\tif ( camera instanceof THREE.Camera === false ) {\r\n\r\n\t\t\tconsole.error( 'THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tvar fog = scene.fog;\r\n\r\n\t\t// reset caching for this frame\r\n\r\n\t\t_currentGeometryProgram = '';\r\n\t\t_currentMaterialId = - 1;\r\n\t\t_currentCamera = null;\r\n\t\t_lightsNeedUpdate = true;\r\n\r\n\t\t// update scene graph\r\n\r\n\t\tif ( scene.autoUpdate === true ) scene.updateMatrixWorld();\r\n\r\n\t\t// update camera matrices and frustum\r\n\r\n\t\tif ( camera.parent === null ) camera.updateMatrixWorld();\r\n\r\n\t\tcamera.matrixWorldInverse.getInverse( camera.matrixWorld );\r\n\r\n\t\t_projScreenMatrix.multiplyMatrices( camera.projectionMatrix, camera.matrixWorldInverse );\r\n\t\t_frustum.setFromMatrix( _projScreenMatrix );\r\n\r\n\t\tlights.length = 0;\r\n\r\n\t\topaqueObjectsLastIndex = - 1;\r\n\t\ttransparentObjectsLastIndex = - 1;\r\n\r\n\t\tsprites.length = 0;\r\n\t\tlensFlares.length = 0;\r\n\r\n\t\tprojectObject( scene, camera );\r\n\r\n\t\topaqueObjects.length = opaqueObjectsLastIndex + 1;\r\n\t\ttransparentObjects.length = transparentObjectsLastIndex + 1;\r\n\r\n\t\tif ( _this.sortObjects === true ) {\r\n\r\n\t\t\topaqueObjects.sort( painterSortStable );\r\n\t\t\ttransparentObjects.sort( reversePainterSortStable );\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tshadowMap.render( scene );\r\n\r\n\t\t//\r\n\r\n\t\t_infoRender.calls = 0;\r\n\t\t_infoRender.vertices = 0;\r\n\t\t_infoRender.faces = 0;\r\n\t\t_infoRender.points = 0;\r\n\r\n\t\tthis.setRenderTarget( renderTarget );\r\n\r\n\t\tif ( this.autoClear || forceClear ) {\r\n\r\n\t\t\tthis.clear( this.autoClearColor, this.autoClearDepth, this.autoClearStencil );\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tif ( scene.overrideMaterial ) {\r\n\r\n\t\t\tvar overrideMaterial = scene.overrideMaterial;\r\n\r\n\t\t\trenderObjects( opaqueObjects, camera, lights, fog, overrideMaterial );\r\n\t\t\trenderObjects( transparentObjects, camera, lights, fog, overrideMaterial );\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// opaque pass (front-to-back order)\r\n\r\n\t\t\tstate.setBlending( THREE.NoBlending );\r\n\t\t\trenderObjects( opaqueObjects, camera, lights, fog );\r\n\r\n\t\t\t// transparent pass (back-to-front order)\r\n\r\n\t\t\trenderObjects( transparentObjects, camera, lights, fog );\r\n\r\n\t\t}\r\n\r\n\t\t// custom render plugins (post pass)\r\n\r\n\t\tspritePlugin.render( scene, camera );\r\n\t\tlensFlarePlugin.render( scene, camera, _currentWidth, _currentHeight );\r\n\r\n\t\t// Generate mipmap if we're using any kind of mipmap filtering\r\n\r\n\t\tif ( renderTarget ) {\r\n\r\n\t\t\tvar texture = renderTarget.texture;\r\n\t\t\tvar isTargetPowerOfTwo = isPowerOfTwo( renderTarget );\r\n\t\t\tif ( texture.generateMipmaps && isTargetPowerOfTwo && texture.minFilter !== THREE.NearestFilter && texture.minFilter !== THREE.LinearFilter ) {\r\n\r\n\t\t\t\t updateRenderTargetMipmap( renderTarget );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// Ensure depth buffer writing is enabled so it can be cleared on next render\r\n\r\n\t\tstate.setDepthTest( true );\r\n\t\tstate.setDepthWrite( true );\r\n\t\tstate.setColorWrite( true );\r\n\r\n\t\t// _gl.finish();\r\n\r\n\t};\r\n\r\n\tfunction pushRenderItem( object, geometry, material, z, group ) {\r\n\r\n\t\tvar array, index;\r\n\r\n\t\t// allocate the next position in the appropriate array\r\n\r\n\t\tif ( material.transparent ) {\r\n\r\n\t\t\tarray = transparentObjects;\r\n\t\t\tindex = ++ transparentObjectsLastIndex;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tarray = opaqueObjects;\r\n\t\t\tindex = ++ opaqueObjectsLastIndex;\r\n\r\n\t\t}\r\n\r\n\t\t// recycle existing render item or grow the array\r\n\r\n\t\tvar renderItem = array[ index ];\r\n\r\n\t\tif ( renderItem !== undefined ) {\r\n\r\n\t\t\trenderItem.id = object.id;\r\n\t\t\trenderItem.object = object;\r\n\t\t\trenderItem.geometry = geometry;\r\n\t\t\trenderItem.material = material;\r\n\t\t\trenderItem.z = _vector3.z;\r\n\t\t\trenderItem.group = group;\r\n\r\n\t\t} else {\r\n\r\n\t\t\trenderItem = {\r\n\t\t\t\tid: object.id,\r\n\t\t\t\tobject: object,\r\n\t\t\t\tgeometry: geometry,\r\n\t\t\t\tmaterial: material,\r\n\t\t\t\tz: _vector3.z,\r\n\t\t\t\tgroup: group\r\n\t\t\t};\r\n\r\n\t\t\t// assert( index === array.length );\r\n\t\t\tarray.push( renderItem );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction projectObject( object, camera ) {\r\n\r\n\t\tif ( object.visible === false ) return;\r\n\r\n\t\tif ( ( object.channels.mask & camera.channels.mask ) !== 0 ) {\r\n\r\n\t\t\tif ( object instanceof THREE.Light ) {\r\n\r\n\t\t\t\tlights.push( object );\r\n\r\n\t\t\t} else if ( object instanceof THREE.Sprite ) {\r\n\r\n\t\t\t\tsprites.push( object );\r\n\r\n\t\t\t} else if ( object instanceof THREE.LensFlare ) {\r\n\r\n\t\t\t\tlensFlares.push( object );\r\n\r\n\t\t\t} else if ( object instanceof THREE.ImmediateRenderObject ) {\r\n\r\n\t\t\t\tif ( _this.sortObjects === true ) {\r\n\r\n\t\t\t\t\t_vector3.setFromMatrixPosition( object.matrixWorld );\r\n\t\t\t\t\t_vector3.applyProjection( _projScreenMatrix );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tpushRenderItem( object, null, object.material, _vector3.z, null );\r\n\r\n\t\t\t} else if ( object instanceof THREE.Mesh || object instanceof THREE.Line || object instanceof THREE.Points ) {\r\n\r\n\t\t\t\tif ( object instanceof THREE.SkinnedMesh ) {\r\n\r\n\t\t\t\t\tobject.skeleton.update();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( object.frustumCulled === false || _frustum.intersectsObject( object ) === true ) {\r\n\r\n\t\t\t\t\tvar material = object.material;\r\n\r\n\t\t\t\t\tif ( material.visible === true ) {\r\n\r\n\t\t\t\t\t\tif ( _this.sortObjects === true ) {\r\n\r\n\t\t\t\t\t\t\t_vector3.setFromMatrixPosition( object.matrixWorld );\r\n\t\t\t\t\t\t\t_vector3.applyProjection( _projScreenMatrix );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar geometry = objects.update( object );\r\n\r\n\t\t\t\t\t\tif ( material instanceof THREE.MeshFaceMaterial ) {\r\n\r\n\t\t\t\t\t\t\tvar groups = geometry.groups;\r\n\t\t\t\t\t\t\tvar materials = material.materials;\r\n\r\n\t\t\t\t\t\t\tfor ( var i = 0, l = groups.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\t\t\t\tvar group = groups[ i ];\r\n\t\t\t\t\t\t\t\tvar groupMaterial = materials[ group.materialIndex ];\r\n\r\n\t\t\t\t\t\t\t\tif ( groupMaterial.visible === true ) {\r\n\r\n\t\t\t\t\t\t\t\t\tpushRenderItem( object, geometry, groupMaterial, _vector3.z, group );\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tpushRenderItem( object, geometry, material, _vector3.z, null );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar children = object.children;\r\n\r\n\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\r\n\r\n\t\t\tprojectObject( children[ i ], camera );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction renderObjects( renderList, camera, lights, fog, overrideMaterial ) {\r\n\r\n\t\tfor ( var i = 0, l = renderList.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar renderItem = renderList[ i ];\r\n\r\n\t\t\tvar object = renderItem.object;\r\n\t\t\tvar geometry = renderItem.geometry;\r\n\t\t\tvar material = overrideMaterial === undefined ? renderItem.material : overrideMaterial;\r\n\t\t\tvar group = renderItem.group;\r\n\r\n\t\t\tobject.modelViewMatrix.multiplyMatrices( camera.matrixWorldInverse, object.matrixWorld );\r\n\t\t\tobject.normalMatrix.getNormalMatrix( object.modelViewMatrix );\r\n\r\n\t\t\tif ( object instanceof THREE.ImmediateRenderObject ) {\r\n\r\n\t\t\t\tsetMaterial( material );\r\n\r\n\t\t\t\tvar program = setProgram( camera, lights, fog, material, object );\r\n\r\n\t\t\t\t_currentGeometryProgram = '';\r\n\r\n\t\t\t\tobject.render( function ( object ) {\r\n\r\n\t\t\t\t\t_this.renderBufferImmediate( object, program, material );\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t_this.renderBufferDirect( camera, lights, fog, geometry, material, object, group );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction initMaterial( material, lights, fog, object ) {\r\n\r\n\t\tvar materialProperties = properties.get( material );\r\n\r\n\t\tvar parameters = programCache.getParameters( material, lights, fog, object );\r\n\t\tvar code = programCache.getProgramCode( material, parameters );\r\n\r\n\t\tvar program = materialProperties.program;\r\n\t\tvar programChange = true;\r\n\r\n\t\tif ( program === undefined ) {\r\n\r\n\t\t\t// new material\r\n\t\t\tmaterial.addEventListener( 'dispose', onMaterialDispose );\r\n\r\n\t\t} else if ( program.code !== code ) {\r\n\r\n\t\t\t// changed glsl or parameters\r\n\t\t\treleaseMaterialProgramReference( material );\r\n\r\n\t\t} else if ( parameters.shaderID !== undefined ) {\r\n\r\n\t\t\t// same glsl and uniform list\r\n\t\t\treturn;\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// only rebuild uniform list\r\n\t\t\tprogramChange = false;\r\n\r\n\t\t}\r\n\r\n\t\tif ( programChange ) {\r\n\r\n\t\t\tif ( parameters.shaderID ) {\r\n\r\n\t\t\t\tvar shader = THREE.ShaderLib[ parameters.shaderID ];\r\n\r\n\t\t\t\tmaterialProperties.__webglShader = {\r\n\t\t\t\t\tname: material.type,\r\n\t\t\t\t\tuniforms: THREE.UniformsUtils.clone( shader.uniforms ),\r\n\t\t\t\t\tvertexShader: shader.vertexShader,\r\n\t\t\t\t\tfragmentShader: shader.fragmentShader\r\n\t\t\t\t};\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tmaterialProperties.__webglShader = {\r\n\t\t\t\t\tname: material.type,\r\n\t\t\t\t\tuniforms: material.uniforms,\r\n\t\t\t\t\tvertexShader: material.vertexShader,\r\n\t\t\t\t\tfragmentShader: material.fragmentShader\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\r\n\t\t\tmaterial.__webglShader = materialProperties.__webglShader;\r\n\r\n\t\t\tprogram = programCache.acquireProgram( material, parameters, code );\r\n\r\n\t\t\tmaterialProperties.program = program;\r\n\t\t\tmaterial.program = program;\r\n\r\n\t\t}\r\n\r\n\t\tvar attributes = program.getAttributes();\r\n\r\n\t\tif ( material.morphTargets ) {\r\n\r\n\t\t\tmaterial.numSupportedMorphTargets = 0;\r\n\r\n\t\t\tfor ( var i = 0; i < _this.maxMorphTargets; i ++ ) {\r\n\r\n\t\t\t\tif ( attributes[ 'morphTarget' + i ] >= 0 ) {\r\n\r\n\t\t\t\t\tmaterial.numSupportedMorphTargets ++;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.morphNormals ) {\r\n\r\n\t\t\tmaterial.numSupportedMorphNormals = 0;\r\n\r\n\t\t\tfor ( i = 0; i < _this.maxMorphNormals; i ++ ) {\r\n\r\n\t\t\t\tif ( attributes[ 'morphNormal' + i ] >= 0 ) {\r\n\r\n\t\t\t\t\tmaterial.numSupportedMorphNormals ++;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tmaterialProperties.uniformsList = [];\r\n\r\n\t\tvar uniformLocations = materialProperties.program.getUniforms();\r\n\r\n\t\tfor ( var u in materialProperties.__webglShader.uniforms ) {\r\n\r\n\t\t\tvar location = uniformLocations[ u ];\r\n\r\n\t\t\tif ( location ) {\r\n\r\n\t\t\t\tmaterialProperties.uniformsList.push( [ materialProperties.__webglShader.uniforms[ u ], location ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction setMaterial( material ) {\r\n\r\n\t\tsetMaterialFaces( material );\r\n\r\n\t\tif ( material.transparent === true ) {\r\n\r\n\t\t\tstate.setBlending( material.blending, material.blendEquation, material.blendSrc, material.blendDst, material.blendEquationAlpha, material.blendSrcAlpha, material.blendDstAlpha );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tstate.setBlending( THREE.NoBlending );\r\n\r\n\t\t}\r\n\r\n\t\tstate.setDepthFunc( material.depthFunc );\r\n\t\tstate.setDepthTest( material.depthTest );\r\n\t\tstate.setDepthWrite( material.depthWrite );\r\n\t\tstate.setColorWrite( material.colorWrite );\r\n\t\tstate.setPolygonOffset( material.polygonOffset, material.polygonOffsetFactor, material.polygonOffsetUnits );\r\n\r\n\t}\r\n\r\n\tfunction setMaterialFaces( material ) {\r\n\r\n\t\tmaterial.side !== THREE.DoubleSide ? state.enable( _gl.CULL_FACE ) : state.disable( _gl.CULL_FACE );\r\n\t\tstate.setFlipSided( material.side === THREE.BackSide );\r\n\r\n\t}\r\n\r\n\tfunction setProgram( camera, lights, fog, material, object ) {\r\n\r\n\t\t_usedTextureUnits = 0;\r\n\r\n\t\tvar materialProperties = properties.get( material );\r\n\r\n\t\tif ( material.needsUpdate || ! materialProperties.program ) {\r\n\r\n\t\t\tinitMaterial( material, lights, fog, object );\r\n\t\t\tmaterial.needsUpdate = false;\r\n\r\n\t\t}\r\n\r\n\t\tvar refreshProgram = false;\r\n\t\tvar refreshMaterial = false;\r\n\t\tvar refreshLights = false;\r\n\r\n\t\tvar program = materialProperties.program,\r\n\t\t\tp_uniforms = program.getUniforms(),\r\n\t\t\tm_uniforms = materialProperties.__webglShader.uniforms;\r\n\r\n\t\tif ( program.id !== _currentProgram ) {\r\n\r\n\t\t\t_gl.useProgram( program.program );\r\n\t\t\t_currentProgram = program.id;\r\n\r\n\t\t\trefreshProgram = true;\r\n\t\t\trefreshMaterial = true;\r\n\t\t\trefreshLights = true;\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.id !== _currentMaterialId ) {\r\n\r\n\t\t\tif ( _currentMaterialId === - 1 ) refreshLights = true;\r\n\t\t\t_currentMaterialId = material.id;\r\n\r\n\t\t\trefreshMaterial = true;\r\n\r\n\t\t}\r\n\r\n\t\tif ( refreshProgram || camera !== _currentCamera ) {\r\n\r\n\t\t\t_gl.uniformMatrix4fv( p_uniforms.projectionMatrix, false, camera.projectionMatrix.elements );\r\n\r\n\t\t\tif ( capabilities.logarithmicDepthBuffer ) {\r\n\r\n\t\t\t\t_gl.uniform1f( p_uniforms.logDepthBufFC, 2.0 / ( Math.log( camera.far + 1.0 ) / Math.LN2 ) );\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t\tif ( camera !== _currentCamera ) _currentCamera = camera;\r\n\r\n\t\t\t// load material specific uniforms\r\n\t\t\t// (shader material also gets them for the sake of genericity)\r\n\r\n\t\t\tif ( material instanceof THREE.ShaderMaterial ||\r\n\t\t\t\t material instanceof THREE.MeshPhongMaterial ||\r\n\t\t\t\t material.envMap ) {\r\n\r\n\t\t\t\tif ( p_uniforms.cameraPosition !== undefined ) {\r\n\r\n\t\t\t\t\t_vector3.setFromMatrixPosition( camera.matrixWorld );\r\n\t\t\t\t\t_gl.uniform3f( p_uniforms.cameraPosition, _vector3.x, _vector3.y, _vector3.z );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material instanceof THREE.MeshPhongMaterial ||\r\n\t\t\t\t material instanceof THREE.MeshLambertMaterial ||\r\n\t\t\t\t material instanceof THREE.MeshBasicMaterial ||\r\n\t\t\t\t material instanceof THREE.ShaderMaterial ||\r\n\t\t\t\t material.skinning ) {\r\n\r\n\t\t\t\tif ( p_uniforms.viewMatrix !== undefined ) {\r\n\r\n\t\t\t\t\t_gl.uniformMatrix4fv( p_uniforms.viewMatrix, false, camera.matrixWorldInverse.elements );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// skinning uniforms must be set even if material didn't change\r\n\t\t// auto-setting of texture unit for bone texture must go before other textures\r\n\t\t// not sure why, but otherwise weird things happen\r\n\r\n\t\tif ( material.skinning ) {\r\n\r\n\t\t\tif ( object.bindMatrix && p_uniforms.bindMatrix !== undefined ) {\r\n\r\n\t\t\t\t_gl.uniformMatrix4fv( p_uniforms.bindMatrix, false, object.bindMatrix.elements );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( object.bindMatrixInverse && p_uniforms.bindMatrixInverse !== undefined ) {\r\n\r\n\t\t\t\t_gl.uniformMatrix4fv( p_uniforms.bindMatrixInverse, false, object.bindMatrixInverse.elements );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( capabilities.floatVertexTextures && object.skeleton && object.skeleton.useVertexTexture ) {\r\n\r\n\t\t\t\tif ( p_uniforms.boneTexture !== undefined ) {\r\n\r\n\t\t\t\t\tvar textureUnit = getTextureUnit();\r\n\r\n\t\t\t\t\t_gl.uniform1i( p_uniforms.boneTexture, textureUnit );\r\n\t\t\t\t\t_this.setTexture( object.skeleton.boneTexture, textureUnit );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( p_uniforms.boneTextureWidth !== undefined ) {\r\n\r\n\t\t\t\t\t_gl.uniform1i( p_uniforms.boneTextureWidth, object.skeleton.boneTextureWidth );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( p_uniforms.boneTextureHeight !== undefined ) {\r\n\r\n\t\t\t\t\t_gl.uniform1i( p_uniforms.boneTextureHeight, object.skeleton.boneTextureHeight );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( object.skeleton && object.skeleton.boneMatrices ) {\r\n\r\n\t\t\t\tif ( p_uniforms.boneGlobalMatrices !== undefined ) {\r\n\r\n\t\t\t\t\t_gl.uniformMatrix4fv( p_uniforms.boneGlobalMatrices, false, object.skeleton.boneMatrices );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( refreshMaterial ) {\r\n\r\n\t\t\t// refresh uniforms common to several materials\r\n\r\n\t\t\tif ( fog && material.fog ) {\r\n\r\n\t\t\t\trefreshUniformsFog( m_uniforms, fog );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material instanceof THREE.MeshPhongMaterial ||\r\n\t\t\t\t material instanceof THREE.MeshLambertMaterial ||\r\n\t\t\t\t material.lights ) {\r\n\r\n\t\t\t\tif ( _lightsNeedUpdate ) {\r\n\r\n\t\t\t\t\trefreshLights = true;\r\n\t\t\t\t\tsetupLights( lights, camera );\r\n\t\t\t\t\t_lightsNeedUpdate = false;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( refreshLights ) {\r\n\r\n\t\t\t\t\trefreshUniformsLights( m_uniforms, _lights );\r\n\t\t\t\t\tmarkUniformsLightsNeedsUpdate( m_uniforms, true );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tmarkUniformsLightsNeedsUpdate( m_uniforms, false );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material instanceof THREE.MeshBasicMaterial ||\r\n\t\t\t\t material instanceof THREE.MeshLambertMaterial ||\r\n\t\t\t\t material instanceof THREE.MeshPhongMaterial ) {\r\n\r\n\t\t\t\trefreshUniformsCommon( m_uniforms, material );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// refresh single material specific uniforms\r\n\r\n\t\t\tif ( material instanceof THREE.LineBasicMaterial ) {\r\n\r\n\t\t\t\trefreshUniformsLine( m_uniforms, material );\r\n\r\n\t\t\t} else if ( material instanceof THREE.LineDashedMaterial ) {\r\n\r\n\t\t\t\trefreshUniformsLine( m_uniforms, material );\r\n\t\t\t\trefreshUniformsDash( m_uniforms, material );\r\n\r\n\t\t\t} else if ( material instanceof THREE.PointsMaterial ) {\r\n\r\n\t\t\t\trefreshUniformsParticle( m_uniforms, material );\r\n\r\n\t\t\t} else if ( material instanceof THREE.MeshPhongMaterial ) {\r\n\r\n\t\t\t\trefreshUniformsPhong( m_uniforms, material );\r\n\r\n\t\t\t} else if ( material instanceof THREE.MeshDepthMaterial ) {\r\n\r\n\t\t\t\tm_uniforms.mNear.value = camera.near;\r\n\t\t\t\tm_uniforms.mFar.value = camera.far;\r\n\t\t\t\tm_uniforms.opacity.value = material.opacity;\r\n\r\n\t\t\t} else if ( material instanceof THREE.MeshNormalMaterial ) {\r\n\r\n\t\t\t\tm_uniforms.opacity.value = material.opacity;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( object.receiveShadow && ! material._shadowPass ) {\r\n\r\n\t\t\t\trefreshUniformsShadow( m_uniforms, lights, camera );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// load common uniforms\r\n\r\n\t\t\tloadUniformsGeneric( materialProperties.uniformsList );\r\n\r\n\t\t}\r\n\r\n\t\tloadUniformsMatrices( p_uniforms, object );\r\n\r\n\t\tif ( p_uniforms.modelMatrix !== undefined ) {\r\n\r\n\t\t\t_gl.uniformMatrix4fv( p_uniforms.modelMatrix, false, object.matrixWorld.elements );\r\n\r\n\t\t}\r\n\r\n\t\treturn program;\r\n\r\n\t}\r\n\r\n\t// Uniforms (refresh uniforms objects)\r\n\r\n\tfunction refreshUniformsCommon ( uniforms, material ) {\r\n\r\n\t\tuniforms.opacity.value = material.opacity;\r\n\r\n\t\tuniforms.diffuse.value = material.color;\r\n\r\n\t\tif ( material.emissive ) {\r\n\r\n\t\t\tuniforms.emissive.value = material.emissive;\r\n\r\n\t\t}\r\n\r\n\t\tuniforms.map.value = material.map;\r\n\t\tuniforms.specularMap.value = material.specularMap;\r\n\t\tuniforms.alphaMap.value = material.alphaMap;\r\n\r\n\t\tif ( material.aoMap ) {\r\n\r\n\t\t\tuniforms.aoMap.value = material.aoMap;\r\n\t\t\tuniforms.aoMapIntensity.value = material.aoMapIntensity;\r\n\r\n\t\t}\r\n\r\n\t\t// uv repeat and offset setting priorities\r\n\t\t// 1. color map\r\n\t\t// 2. specular map\r\n\t\t// 3. normal map\r\n\t\t// 4. bump map\r\n\t\t// 5. alpha map\r\n\t\t// 6. emissive map\r\n\r\n\t\tvar uvScaleMap;\r\n\r\n\t\tif ( material.map ) {\r\n\r\n\t\t\tuvScaleMap = material.map;\r\n\r\n\t\t} else if ( material.specularMap ) {\r\n\r\n\t\t\tuvScaleMap = material.specularMap;\r\n\r\n\t\t} else if ( material.displacementMap ) {\r\n\r\n\t\t\tuvScaleMap = material.displacementMap;\r\n\r\n\t\t} else if ( material.normalMap ) {\r\n\r\n\t\t\tuvScaleMap = material.normalMap;\r\n\r\n\t\t} else if ( material.bumpMap ) {\r\n\r\n\t\t\tuvScaleMap = material.bumpMap;\r\n\r\n\t\t} else if ( material.alphaMap ) {\r\n\r\n\t\t\tuvScaleMap = material.alphaMap;\r\n\r\n\t\t} else if ( material.emissiveMap ) {\r\n\r\n\t\t\tuvScaleMap = material.emissiveMap;\r\n\r\n\t\t}\r\n\r\n\t\tif ( uvScaleMap !== undefined ) {\r\n\r\n\t\t\tif ( uvScaleMap instanceof THREE.WebGLRenderTarget ) uvScaleMap = uvScaleMap.texture;\r\n\t\t\tvar offset = uvScaleMap.offset;\r\n\t\t\tvar repeat = uvScaleMap.repeat;\r\n\r\n\t\t\tuniforms.offsetRepeat.value.set( offset.x, offset.y, repeat.x, repeat.y );\r\n\r\n\t\t}\r\n\r\n\t\tuniforms.envMap.value = material.envMap;\r\n\t\tuniforms.flipEnvMap.value = ( material.envMap instanceof THREE.WebGLRenderTargetCube ) ? 1 : - 1;\r\n\r\n\t\tuniforms.reflectivity.value = material.reflectivity;\r\n\t\tuniforms.refractionRatio.value = material.refractionRatio;\r\n\r\n\t}\r\n\r\n\tfunction refreshUniformsLine ( uniforms, material ) {\r\n\r\n\t\tuniforms.diffuse.value = material.color;\r\n\t\tuniforms.opacity.value = material.opacity;\r\n\r\n\t}\r\n\r\n\tfunction refreshUniformsDash ( uniforms, material ) {\r\n\r\n\t\tuniforms.dashSize.value = material.dashSize;\r\n\t\tuniforms.totalSize.value = material.dashSize + material.gapSize;\r\n\t\tuniforms.scale.value = material.scale;\r\n\r\n\t}\r\n\r\n\tfunction refreshUniformsParticle ( uniforms, material ) {\r\n\r\n\t\tuniforms.psColor.value = material.color;\r\n\t\tuniforms.opacity.value = material.opacity;\r\n\t\tuniforms.size.value = material.size;\r\n\t\tuniforms.scale.value = _canvas.height / 2.0; // TODO: Cache this.\r\n\r\n\t\tuniforms.map.value = material.map;\r\n\r\n\t\tif ( material.map !== null ) {\r\n\r\n\t\t\tvar offset = material.map.offset;\r\n\t\t\tvar repeat = material.map.repeat;\r\n\r\n\t\t\tuniforms.offsetRepeat.value.set( offset.x, offset.y, repeat.x, repeat.y );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction refreshUniformsFog ( uniforms, fog ) {\r\n\r\n\t\tuniforms.fogColor.value = fog.color;\r\n\r\n\t\tif ( fog instanceof THREE.Fog ) {\r\n\r\n\t\t\tuniforms.fogNear.value = fog.near;\r\n\t\t\tuniforms.fogFar.value = fog.far;\r\n\r\n\t\t} else if ( fog instanceof THREE.FogExp2 ) {\r\n\r\n\t\t\tuniforms.fogDensity.value = fog.density;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction refreshUniformsPhong ( uniforms, material ) {\r\n\r\n\t\tuniforms.specular.value = material.specular;\r\n\t\tuniforms.shininess.value = Math.max( material.shininess, 1e-4 ); // to prevent pow( 0.0, 0.0 )\r\n\r\n\t\tif ( material.lightMap ) {\r\n\r\n\t\t\tuniforms.lightMap.value = material.lightMap;\r\n\t\t\tuniforms.lightMapIntensity.value = material.lightMapIntensity;\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.emissiveMap ) {\r\n\r\n\t\t\tuniforms.emissiveMap.value = material.emissiveMap;\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.bumpMap ) {\r\n\r\n\t\t\tuniforms.bumpMap.value = material.bumpMap;\r\n\t\t\tuniforms.bumpScale.value = material.bumpScale;\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.normalMap ) {\r\n\r\n\t\t\tuniforms.normalMap.value = material.normalMap;\r\n\t\t\tuniforms.normalScale.value.copy( material.normalScale );\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.displacementMap ) {\r\n\r\n\t\t\tuniforms.displacementMap.value = material.displacementMap;\r\n\t\t\tuniforms.displacementScale.value = material.displacementScale;\r\n\t\t\tuniforms.displacementBias.value = material.displacementBias;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction refreshUniformsLights ( uniforms, lights ) {\r\n\r\n\t\tuniforms.ambientLightColor.value = lights.ambient;\r\n\r\n\t\tuniforms.directionalLightColor.value = lights.directional.colors;\r\n\t\tuniforms.directionalLightDirection.value = lights.directional.positions;\r\n\r\n\t\tuniforms.pointLightColor.value = lights.point.colors;\r\n\t\tuniforms.pointLightPosition.value = lights.point.positions;\r\n\t\tuniforms.pointLightDistance.value = lights.point.distances;\r\n\t\tuniforms.pointLightDecay.value = lights.point.decays;\r\n\r\n\t\tuniforms.spotLightColor.value = lights.spot.colors;\r\n\t\tuniforms.spotLightPosition.value = lights.spot.positions;\r\n\t\tuniforms.spotLightDistance.value = lights.spot.distances;\r\n\t\tuniforms.spotLightDirection.value = lights.spot.directions;\r\n\t\tuniforms.spotLightAngleCos.value = lights.spot.anglesCos;\r\n\t\tuniforms.spotLightExponent.value = lights.spot.exponents;\r\n\t\tuniforms.spotLightDecay.value = lights.spot.decays;\r\n\r\n\t\tuniforms.hemisphereLightSkyColor.value = lights.hemi.skyColors;\r\n\t\tuniforms.hemisphereLightGroundColor.value = lights.hemi.groundColors;\r\n\t\tuniforms.hemisphereLightDirection.value = lights.hemi.positions;\r\n\r\n\t}\r\n\r\n\t// If uniforms are marked as clean, they don't need to be loaded to the GPU.\r\n\r\n\tfunction markUniformsLightsNeedsUpdate ( uniforms, value ) {\r\n\r\n\t\tuniforms.ambientLightColor.needsUpdate = value;\r\n\r\n\t\tuniforms.directionalLightColor.needsUpdate = value;\r\n\t\tuniforms.directionalLightDirection.needsUpdate = value;\r\n\r\n\t\tuniforms.pointLightColor.needsUpdate = value;\r\n\t\tuniforms.pointLightPosition.needsUpdate = value;\r\n\t\tuniforms.pointLightDistance.needsUpdate = value;\r\n\t\tuniforms.pointLightDecay.needsUpdate = value;\r\n\r\n\t\tuniforms.spotLightColor.needsUpdate = value;\r\n\t\tuniforms.spotLightPosition.needsUpdate = value;\r\n\t\tuniforms.spotLightDistance.needsUpdate = value;\r\n\t\tuniforms.spotLightDirection.needsUpdate = value;\r\n\t\tuniforms.spotLightAngleCos.needsUpdate = value;\r\n\t\tuniforms.spotLightExponent.needsUpdate = value;\r\n\t\tuniforms.spotLightDecay.needsUpdate = value;\r\n\r\n\t\tuniforms.hemisphereLightSkyColor.needsUpdate = value;\r\n\t\tuniforms.hemisphereLightGroundColor.needsUpdate = value;\r\n\t\tuniforms.hemisphereLightDirection.needsUpdate = value;\r\n\r\n\t}\r\n\r\n\tfunction refreshUniformsShadow ( uniforms, lights, camera ) {\r\n\r\n\t\tif ( uniforms.shadowMatrix ) {\r\n\r\n\t\t\tvar j = 0;\r\n\r\n\t\t\tfor ( var i = 0, il = lights.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tvar light = lights[ i ];\r\n\r\n\t\t\t\tif ( light.castShadow === true ) {\r\n\r\n\t\t\t\t\tif ( light instanceof THREE.PointLight || light instanceof THREE.SpotLight || light instanceof THREE.DirectionalLight ) {\r\n\r\n\t\t\t\t\t\tvar shadow = light.shadow;\r\n\r\n\t\t\t\t\t\tif ( light instanceof THREE.PointLight ) {\r\n\r\n\t\t\t\t\t\t\t// for point lights we set the shadow matrix to be a translation-only matrix\r\n\t\t\t\t\t\t\t// equal to inverse of the light's position\r\n\t\t\t\t\t\t\t_vector3.setFromMatrixPosition( light.matrixWorld ).negate();\r\n\t\t\t\t\t\t\tshadow.matrix.identity().setPosition( _vector3 );\r\n\r\n\t\t\t\t\t\t\t// for point lights we set the sign of the shadowDarkness uniform to be negative\r\n\t\t\t\t\t\t\tuniforms.shadowDarkness.value[ j ] = - shadow.darkness;\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tuniforms.shadowDarkness.value[ j ] = shadow.darkness;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tuniforms.shadowMatrix.value[ j ] = shadow.matrix;\r\n\t\t\t\t\t\tuniforms.shadowMap.value[ j ] = shadow.map;\r\n\t\t\t\t\t\tuniforms.shadowMapSize.value[ j ] = shadow.mapSize;\r\n\t\t\t\t\t\tuniforms.shadowBias.value[ j ] = shadow.bias;\r\n\r\n\t\t\t\t\t\tj ++;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// Uniforms (load to GPU)\r\n\r\n\tfunction loadUniformsMatrices ( uniforms, object ) {\r\n\r\n\t\t_gl.uniformMatrix4fv( uniforms.modelViewMatrix, false, object.modelViewMatrix.elements );\r\n\r\n\t\tif ( uniforms.normalMatrix ) {\r\n\r\n\t\t\t_gl.uniformMatrix3fv( uniforms.normalMatrix, false, object.normalMatrix.elements );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction getTextureUnit() {\r\n\r\n\t\tvar textureUnit = _usedTextureUnits;\r\n\r\n\t\tif ( textureUnit >= capabilities.maxTextures ) {\r\n\r\n\t\t\tconsole.warn( 'WebGLRenderer: trying to use ' + textureUnit + ' texture units while this GPU supports only ' + capabilities.maxTextures );\r\n\r\n\t\t}\r\n\r\n\t\t_usedTextureUnits += 1;\r\n\r\n\t\treturn textureUnit;\r\n\r\n\t}\r\n\r\n\tfunction loadUniformsGeneric ( uniforms ) {\r\n\r\n\t\tvar texture, textureUnit;\r\n\r\n\t\tfor ( var j = 0, jl = uniforms.length; j < jl; j ++ ) {\r\n\r\n\t\t\tvar uniform = uniforms[ j ][ 0 ];\r\n\r\n\t\t\t// needsUpdate property is not added to all uniforms.\r\n\t\t\tif ( uniform.needsUpdate === false ) continue;\r\n\r\n\t\t\tvar type = uniform.type;\r\n\t\t\tvar value = uniform.value;\r\n\t\t\tvar location = uniforms[ j ][ 1 ];\r\n\r\n\t\t\tswitch ( type ) {\r\n\r\n\t\t\t\tcase '1i':\r\n\t\t\t\t\t_gl.uniform1i( location, value );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase '1f':\r\n\t\t\t\t\t_gl.uniform1f( location, value );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase '2f':\r\n\t\t\t\t\t_gl.uniform2f( location, value[ 0 ], value[ 1 ] );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase '3f':\r\n\t\t\t\t\t_gl.uniform3f( location, value[ 0 ], value[ 1 ], value[ 2 ] );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase '4f':\r\n\t\t\t\t\t_gl.uniform4f( location, value[ 0 ], value[ 1 ], value[ 2 ], value[ 3 ] );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase '1iv':\r\n\t\t\t\t\t_gl.uniform1iv( location, value );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase '3iv':\r\n\t\t\t\t\t_gl.uniform3iv( location, value );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase '1fv':\r\n\t\t\t\t\t_gl.uniform1fv( location, value );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase '2fv':\r\n\t\t\t\t\t_gl.uniform2fv( location, value );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase '3fv':\r\n\t\t\t\t\t_gl.uniform3fv( location, value );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase '4fv':\r\n\t\t\t\t\t_gl.uniform4fv( location, value );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'Matrix3fv':\r\n\t\t\t\t\t_gl.uniformMatrix3fv( location, false, value );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'Matrix4fv':\r\n\t\t\t\t\t_gl.uniformMatrix4fv( location, false, value );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t//\r\n\r\n\t\t\t\tcase 'i':\r\n\r\n\t\t\t\t\t// single integer\r\n\t\t\t\t\t_gl.uniform1i( location, value );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'f':\r\n\r\n\t\t\t\t\t// single float\r\n\t\t\t\t\t_gl.uniform1f( location, value );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'v2':\r\n\r\n\t\t\t\t\t// single THREE.Vector2\r\n\t\t\t\t\t_gl.uniform2f( location, value.x, value.y );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'v3':\r\n\r\n\t\t\t\t\t// single THREE.Vector3\r\n\t\t\t\t\t_gl.uniform3f( location, value.x, value.y, value.z );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'v4':\r\n\r\n\t\t\t\t\t// single THREE.Vector4\r\n\t\t\t\t\t_gl.uniform4f( location, value.x, value.y, value.z, value.w );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'c':\r\n\r\n\t\t\t\t\t// single THREE.Color\r\n\t\t\t\t\t_gl.uniform3f( location, value.r, value.g, value.b );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'iv1':\r\n\r\n\t\t\t\t\t// flat array of integers (JS or typed array)\r\n\t\t\t\t\t_gl.uniform1iv( location, value );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'iv':\r\n\r\n\t\t\t\t\t// flat array of integers with 3 x N size (JS or typed array)\r\n\t\t\t\t\t_gl.uniform3iv( location, value );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'fv1':\r\n\r\n\t\t\t\t\t// flat array of floats (JS or typed array)\r\n\t\t\t\t\t_gl.uniform1fv( location, value );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'fv':\r\n\r\n\t\t\t\t\t// flat array of floats with 3 x N size (JS or typed array)\r\n\t\t\t\t\t_gl.uniform3fv( location, value );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'v2v':\r\n\r\n\t\t\t\t\t// array of THREE.Vector2\r\n\r\n\t\t\t\t\tif ( uniform._array === undefined ) {\r\n\r\n\t\t\t\t\t\tuniform._array = new Float32Array( 2 * value.length );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfor ( var i = 0, i2 = 0, il = value.length; i < il; i ++, i2 += 2 ) {\r\n\r\n\t\t\t\t\t\tuniform._array[ i2 + 0 ] = value[ i ].x;\r\n\t\t\t\t\t\tuniform._array[ i2 + 1 ] = value[ i ].y;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t_gl.uniform2fv( location, uniform._array );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'v3v':\r\n\r\n\t\t\t\t\t// array of THREE.Vector3\r\n\r\n\t\t\t\t\tif ( uniform._array === undefined ) {\r\n\r\n\t\t\t\t\t\tuniform._array = new Float32Array( 3 * value.length );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfor ( var i = 0, i3 = 0, il = value.length; i < il; i ++, i3 += 3 ) {\r\n\r\n\t\t\t\t\t\tuniform._array[ i3 + 0 ] = value[ i ].x;\r\n\t\t\t\t\t\tuniform._array[ i3 + 1 ] = value[ i ].y;\r\n\t\t\t\t\t\tuniform._array[ i3 + 2 ] = value[ i ].z;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t_gl.uniform3fv( location, uniform._array );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'v4v':\r\n\r\n\t\t\t\t\t// array of THREE.Vector4\r\n\r\n\t\t\t\t\tif ( uniform._array === undefined ) {\r\n\r\n\t\t\t\t\t\tuniform._array = new Float32Array( 4 * value.length );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfor ( var i = 0, i4 = 0, il = value.length; i < il; i ++, i4 += 4 ) {\r\n\r\n\t\t\t\t\t\tuniform._array[ i4 + 0 ] = value[ i ].x;\r\n\t\t\t\t\t\tuniform._array[ i4 + 1 ] = value[ i ].y;\r\n\t\t\t\t\t\tuniform._array[ i4 + 2 ] = value[ i ].z;\r\n\t\t\t\t\t\tuniform._array[ i4 + 3 ] = value[ i ].w;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t_gl.uniform4fv( location, uniform._array );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'm3':\r\n\r\n\t\t\t\t\t// single THREE.Matrix3\r\n\t\t\t\t\t_gl.uniformMatrix3fv( location, false, value.elements );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'm3v':\r\n\r\n\t\t\t\t\t// array of THREE.Matrix3\r\n\r\n\t\t\t\t\tif ( uniform._array === undefined ) {\r\n\r\n\t\t\t\t\t\tuniform._array = new Float32Array( 9 * value.length );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfor ( var i = 0, il = value.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\tvalue[ i ].flattenToArrayOffset( uniform._array, i * 9 );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t_gl.uniformMatrix3fv( location, false, uniform._array );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'm4':\r\n\r\n\t\t\t\t\t// single THREE.Matrix4\r\n\t\t\t\t\t_gl.uniformMatrix4fv( location, false, value.elements );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'm4v':\r\n\r\n\t\t\t\t\t// array of THREE.Matrix4\r\n\r\n\t\t\t\t\tif ( uniform._array === undefined ) {\r\n\r\n\t\t\t\t\t\tuniform._array = new Float32Array( 16 * value.length );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfor ( var i = 0, il = value.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\tvalue[ i ].flattenToArrayOffset( uniform._array, i * 16 );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t_gl.uniformMatrix4fv( location, false, uniform._array );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 't':\r\n\r\n\t\t\t\t\t// single THREE.Texture (2d or cube)\r\n\r\n\t\t\t\t\ttexture = value;\r\n\t\t\t\t\ttextureUnit = getTextureUnit();\r\n\r\n\t\t\t\t\t_gl.uniform1i( location, textureUnit );\r\n\r\n\t\t\t\t\tif ( ! texture ) continue;\r\n\r\n\t\t\t\t\tif ( texture instanceof THREE.CubeTexture ||\r\n\t\t\t\t\t\t ( Array.isArray( texture.image ) && texture.image.length === 6 ) ) {\r\n\r\n\t\t\t\t\t\t// CompressedTexture can have Array in image :/\r\n\r\n\t\t\t\t\t\tsetCubeTexture( texture, textureUnit );\r\n\r\n\t\t\t\t\t} else if ( texture instanceof THREE.WebGLRenderTargetCube ) {\r\n\r\n\t\t\t\t\t\tsetCubeTextureDynamic( texture.texture, textureUnit );\r\n\r\n\t\t\t\t\t} else if ( texture instanceof THREE.WebGLRenderTarget ) {\r\n\r\n\t\t\t\t\t\t_this.setTexture( texture.texture, textureUnit );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t_this.setTexture( texture, textureUnit );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'tv':\r\n\r\n\t\t\t\t\t// array of THREE.Texture (2d or cube)\r\n\r\n\t\t\t\t\tif ( uniform._array === undefined ) {\r\n\r\n\t\t\t\t\t\tuniform._array = [];\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfor ( var i = 0, il = uniform.value.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\tuniform._array[ i ] = getTextureUnit();\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t_gl.uniform1iv( location, uniform._array );\r\n\r\n\t\t\t\t\tfor ( var i = 0, il = uniform.value.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\ttexture = uniform.value[ i ];\r\n\t\t\t\t\t\ttextureUnit = uniform._array[ i ];\r\n\r\n\t\t\t\t\t\tif ( ! texture ) continue;\r\n\r\n\t\t\t\t\t\tif ( texture instanceof THREE.CubeTexture ||\r\n\t\t\t\t\t\t\t ( texture.image instanceof Array && texture.image.length === 6 ) ) {\r\n\r\n\t\t\t\t\t\t\t// CompressedTexture can have Array in image :/\r\n\r\n\t\t\t\t\t\t\tsetCubeTexture( texture, textureUnit );\r\n\r\n\t\t\t\t\t\t} else if ( texture instanceof THREE.WebGLRenderTarget ) {\r\n\r\n\t\t\t\t\t\t\t_this.setTexture( texture.texture, textureUnit );\r\n\r\n\t\t\t\t\t\t} else if ( texture instanceof THREE.WebGLRenderTargetCube ) {\r\n\r\n\t\t\t\t\t\t\tsetCubeTextureDynamic( texture.texture, textureUnit );\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t_this.setTexture( texture, textureUnit );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Unknown uniform type: ' + type );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction setColorLinear( array, offset, color, intensity ) {\r\n\r\n\t\tarray[ offset + 0 ] = color.r * intensity;\r\n\t\tarray[ offset + 1 ] = color.g * intensity;\r\n\t\tarray[ offset + 2 ] = color.b * intensity;\r\n\r\n\t}\r\n\r\n\tfunction setupLights ( lights, camera ) {\r\n\r\n\t\tvar l, ll, light,\r\n\t\tr = 0, g = 0, b = 0,\r\n\t\tcolor, skyColor, groundColor,\r\n\t\tintensity,\r\n\t\tdistance,\r\n\r\n\t\tzlights = _lights,\r\n\r\n\t\tviewMatrix = camera.matrixWorldInverse,\r\n\r\n\t\tdirColors = zlights.directional.colors,\r\n\t\tdirPositions = zlights.directional.positions,\r\n\r\n\t\tpointColors = zlights.point.colors,\r\n\t\tpointPositions = zlights.point.positions,\r\n\t\tpointDistances = zlights.point.distances,\r\n\t\tpointDecays = zlights.point.decays,\r\n\r\n\t\tspotColors = zlights.spot.colors,\r\n\t\tspotPositions = zlights.spot.positions,\r\n\t\tspotDistances = zlights.spot.distances,\r\n\t\tspotDirections = zlights.spot.directions,\r\n\t\tspotAnglesCos = zlights.spot.anglesCos,\r\n\t\tspotExponents = zlights.spot.exponents,\r\n\t\tspotDecays = zlights.spot.decays,\r\n\r\n\t\themiSkyColors = zlights.hemi.skyColors,\r\n\t\themiGroundColors = zlights.hemi.groundColors,\r\n\t\themiPositions = zlights.hemi.positions,\r\n\r\n\t\tdirLength = 0,\r\n\t\tpointLength = 0,\r\n\t\tspotLength = 0,\r\n\t\themiLength = 0,\r\n\r\n\t\tdirCount = 0,\r\n\t\tpointCount = 0,\r\n\t\tspotCount = 0,\r\n\t\themiCount = 0,\r\n\r\n\t\tdirOffset = 0,\r\n\t\tpointOffset = 0,\r\n\t\tspotOffset = 0,\r\n\t\themiOffset = 0;\r\n\r\n\t\tfor ( l = 0, ll = lights.length; l < ll; l ++ ) {\r\n\r\n\t\t\tlight = lights[ l ];\r\n\r\n\t\t\tcolor = light.color;\r\n\t\t\tintensity = light.intensity;\r\n\t\t\tdistance = light.distance;\r\n\r\n\t\t\tif ( light instanceof THREE.AmbientLight ) {\r\n\r\n\t\t\t\tif ( ! light.visible ) continue;\r\n\r\n\t\t\t\tr += color.r;\r\n\t\t\t\tg += color.g;\r\n\t\t\t\tb += color.b;\r\n\r\n\t\t\t} else if ( light instanceof THREE.DirectionalLight ) {\r\n\r\n\t\t\t\tdirCount += 1;\r\n\r\n\t\t\t\tif ( ! light.visible ) continue;\r\n\r\n\t\t\t\t_direction.setFromMatrixPosition( light.matrixWorld );\r\n\t\t\t\t_vector3.setFromMatrixPosition( light.target.matrixWorld );\r\n\t\t\t\t_direction.sub( _vector3 );\r\n\t\t\t\t_direction.transformDirection( viewMatrix );\r\n\r\n\t\t\t\tdirOffset = dirLength * 3;\r\n\r\n\t\t\t\tdirPositions[ dirOffset + 0 ] = _direction.x;\r\n\t\t\t\tdirPositions[ dirOffset + 1 ] = _direction.y;\r\n\t\t\t\tdirPositions[ dirOffset + 2 ] = _direction.z;\r\n\r\n\t\t\t\tsetColorLinear( dirColors, dirOffset, color, intensity );\r\n\r\n\t\t\t\tdirLength += 1;\r\n\r\n\t\t\t} else if ( light instanceof THREE.PointLight ) {\r\n\r\n\t\t\t\tpointCount += 1;\r\n\r\n\t\t\t\tif ( ! light.visible ) continue;\r\n\r\n\t\t\t\tpointOffset = pointLength * 3;\r\n\r\n\t\t\t\tsetColorLinear( pointColors, pointOffset, color, intensity );\r\n\r\n\t\t\t\t_vector3.setFromMatrixPosition( light.matrixWorld );\r\n\t\t\t\t_vector3.applyMatrix4( viewMatrix );\r\n\r\n\t\t\t\tpointPositions[ pointOffset + 0 ] = _vector3.x;\r\n\t\t\t\tpointPositions[ pointOffset + 1 ] = _vector3.y;\r\n\t\t\t\tpointPositions[ pointOffset + 2 ] = _vector3.z;\r\n\r\n\t\t\t\t// distance is 0 if decay is 0, because there is no attenuation at all.\r\n\t\t\t\tpointDistances[ pointLength ] = distance;\r\n\t\t\t\tpointDecays[ pointLength ] = ( light.distance === 0 ) ? 0.0 : light.decay;\r\n\r\n\t\t\t\tpointLength += 1;\r\n\r\n\t\t\t} else if ( light instanceof THREE.SpotLight ) {\r\n\r\n\t\t\t\tspotCount += 1;\r\n\r\n\t\t\t\tif ( ! light.visible ) continue;\r\n\r\n\t\t\t\tspotOffset = spotLength * 3;\r\n\r\n\t\t\t\tsetColorLinear( spotColors, spotOffset, color, intensity );\r\n\r\n\t\t\t\t_direction.setFromMatrixPosition( light.matrixWorld );\r\n\t\t\t\t_vector3.copy( _direction ).applyMatrix4( viewMatrix );\r\n\r\n\t\t\t\tspotPositions[ spotOffset + 0 ] = _vector3.x;\r\n\t\t\t\tspotPositions[ spotOffset + 1 ] = _vector3.y;\r\n\t\t\t\tspotPositions[ spotOffset + 2 ] = _vector3.z;\r\n\r\n\t\t\t\tspotDistances[ spotLength ] = distance;\r\n\r\n\t\t\t\t_vector3.setFromMatrixPosition( light.target.matrixWorld );\r\n\t\t\t\t_direction.sub( _vector3 );\r\n\t\t\t\t_direction.transformDirection( viewMatrix );\r\n\r\n\t\t\t\tspotDirections[ spotOffset + 0 ] = _direction.x;\r\n\t\t\t\tspotDirections[ spotOffset + 1 ] = _direction.y;\r\n\t\t\t\tspotDirections[ spotOffset + 2 ] = _direction.z;\r\n\r\n\t\t\t\tspotAnglesCos[ spotLength ] = Math.cos( light.angle );\r\n\t\t\t\tspotExponents[ spotLength ] = light.exponent;\r\n\t\t\t\tspotDecays[ spotLength ] = ( light.distance === 0 ) ? 0.0 : light.decay;\r\n\r\n\t\t\t\tspotLength += 1;\r\n\r\n\t\t\t} else if ( light instanceof THREE.HemisphereLight ) {\r\n\r\n\t\t\t\themiCount += 1;\r\n\r\n\t\t\t\tif ( ! light.visible ) continue;\r\n\r\n\t\t\t\t_direction.setFromMatrixPosition( light.matrixWorld );\r\n\t\t\t\t_direction.transformDirection( viewMatrix );\r\n\r\n\t\t\t\themiOffset = hemiLength * 3;\r\n\r\n\t\t\t\themiPositions[ hemiOffset + 0 ] = _direction.x;\r\n\t\t\t\themiPositions[ hemiOffset + 1 ] = _direction.y;\r\n\t\t\t\themiPositions[ hemiOffset + 2 ] = _direction.z;\r\n\r\n\t\t\t\tskyColor = light.color;\r\n\t\t\t\tgroundColor = light.groundColor;\r\n\r\n\t\t\t\tsetColorLinear( hemiSkyColors, hemiOffset, skyColor, intensity );\r\n\t\t\t\tsetColorLinear( hemiGroundColors, hemiOffset, groundColor, intensity );\r\n\r\n\t\t\t\themiLength += 1;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// null eventual remains from removed lights\r\n\t\t// (this is to avoid if in shader)\r\n\r\n\t\tfor ( l = dirLength * 3, ll = Math.max( dirColors.length, dirCount * 3 ); l < ll; l ++ ) dirColors[ l ] = 0.0;\r\n\t\tfor ( l = pointLength * 3, ll = Math.max( pointColors.length, pointCount * 3 ); l < ll; l ++ ) pointColors[ l ] = 0.0;\r\n\t\tfor ( l = spotLength * 3, ll = Math.max( spotColors.length, spotCount * 3 ); l < ll; l ++ ) spotColors[ l ] = 0.0;\r\n\t\tfor ( l = hemiLength * 3, ll = Math.max( hemiSkyColors.length, hemiCount * 3 ); l < ll; l ++ ) hemiSkyColors[ l ] = 0.0;\r\n\t\tfor ( l = hemiLength * 3, ll = Math.max( hemiGroundColors.length, hemiCount * 3 ); l < ll; l ++ ) hemiGroundColors[ l ] = 0.0;\r\n\r\n\t\tzlights.directional.length = dirLength;\r\n\t\tzlights.point.length = pointLength;\r\n\t\tzlights.spot.length = spotLength;\r\n\t\tzlights.hemi.length = hemiLength;\r\n\r\n\t\tzlights.ambient[ 0 ] = r;\r\n\t\tzlights.ambient[ 1 ] = g;\r\n\t\tzlights.ambient[ 2 ] = b;\r\n\r\n\t}\r\n\r\n\t// GL state setting\r\n\r\n\tthis.setFaceCulling = function ( cullFace, frontFaceDirection ) {\r\n\r\n\t\tif ( cullFace === THREE.CullFaceNone ) {\r\n\r\n\t\t\tstate.disable( _gl.CULL_FACE );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tif ( frontFaceDirection === THREE.FrontFaceDirectionCW ) {\r\n\r\n\t\t\t\t_gl.frontFace( _gl.CW );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t_gl.frontFace( _gl.CCW );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( cullFace === THREE.CullFaceBack ) {\r\n\r\n\t\t\t\t_gl.cullFace( _gl.BACK );\r\n\r\n\t\t\t} else if ( cullFace === THREE.CullFaceFront ) {\r\n\r\n\t\t\t\t_gl.cullFace( _gl.FRONT );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t_gl.cullFace( _gl.FRONT_AND_BACK );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tstate.enable( _gl.CULL_FACE );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t// Textures\r\n\r\n\tfunction setTextureParameters ( textureType, texture, isImagePowerOfTwo ) {\r\n\r\n\t\tvar extension;\r\n\r\n\t\tif ( isImagePowerOfTwo ) {\r\n\r\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_WRAP_S, paramThreeToGL( texture.wrapS ) );\r\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_WRAP_T, paramThreeToGL( texture.wrapT ) );\r\n\r\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_MAG_FILTER, paramThreeToGL( texture.magFilter ) );\r\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_MIN_FILTER, paramThreeToGL( texture.minFilter ) );\r\n\r\n\t\t} else {\r\n\r\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_WRAP_S, _gl.CLAMP_TO_EDGE );\r\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_WRAP_T, _gl.CLAMP_TO_EDGE );\r\n\r\n\t\t\tif ( texture.wrapS !== THREE.ClampToEdgeWrapping || texture.wrapT !== THREE.ClampToEdgeWrapping ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.', texture );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_MAG_FILTER, filterFallback( texture.magFilter ) );\r\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_MIN_FILTER, filterFallback( texture.minFilter ) );\r\n\r\n\t\t\tif ( texture.minFilter !== THREE.NearestFilter && texture.minFilter !== THREE.LinearFilter ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.', texture );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\textension = extensions.get( 'EXT_texture_filter_anisotropic' );\r\n\r\n\t\tif ( extension ) {\r\n\r\n\t\t\tif ( texture.type === THREE.FloatType && extensions.get( 'OES_texture_float_linear' ) === null ) return;\r\n\t\t\tif ( texture.type === THREE.HalfFloatType && extensions.get( 'OES_texture_half_float_linear' ) === null ) return;\r\n\r\n\t\t\tif ( texture.anisotropy > 1 || properties.get( texture ).__currentAnisotropy ) {\r\n\r\n\t\t\t\t_gl.texParameterf( textureType, extension.TEXTURE_MAX_ANISOTROPY_EXT, Math.min( texture.anisotropy, _this.getMaxAnisotropy() ) );\r\n\t\t\t\tproperties.get( texture ).__currentAnisotropy = texture.anisotropy;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction uploadTexture( textureProperties, texture, slot ) {\r\n\r\n\t\tif ( textureProperties.__webglInit === undefined ) {\r\n\r\n\t\t\ttextureProperties.__webglInit = true;\r\n\r\n\t\t\ttexture.addEventListener( 'dispose', onTextureDispose );\r\n\r\n\t\t\ttextureProperties.__webglTexture = _gl.createTexture();\r\n\r\n\t\t\t_infoMemory.textures ++;\r\n\r\n\t\t}\r\n\r\n\t\tstate.activeTexture( _gl.TEXTURE0 + slot );\r\n\t\tstate.bindTexture( _gl.TEXTURE_2D, textureProperties.__webglTexture );\r\n\r\n\t\t_gl.pixelStorei( _gl.UNPACK_FLIP_Y_WEBGL, texture.flipY );\r\n\t\t_gl.pixelStorei( _gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, texture.premultiplyAlpha );\r\n\t\t_gl.pixelStorei( _gl.UNPACK_ALIGNMENT, texture.unpackAlignment );\r\n\r\n\t\ttexture.image = clampToMaxSize( texture.image, capabilities.maxTextureSize );\r\n\r\n\t\tif ( textureNeedsPowerOfTwo( texture ) && isPowerOfTwo( texture.image ) === false ) {\r\n\r\n\t\t\ttexture.image = makePowerOfTwo( texture.image );\r\n\r\n\t\t}\r\n\r\n\t\tvar image = texture.image,\r\n\t\tisImagePowerOfTwo = isPowerOfTwo( image ),\r\n\t\tglFormat = paramThreeToGL( texture.format ),\r\n\t\tglType = paramThreeToGL( texture.type );\r\n\r\n\t\tsetTextureParameters( _gl.TEXTURE_2D, texture, isImagePowerOfTwo );\r\n\r\n\t\tvar mipmap, mipmaps = texture.mipmaps;\r\n\r\n\t\tif ( texture instanceof THREE.DataTexture ) {\r\n\r\n\t\t\t// use manually created mipmaps if available\r\n\t\t\t// if there are no manual mipmaps\r\n\t\t\t// set 0 level mipmap and then use GL to generate other mipmap levels\r\n\r\n\t\t\tif ( mipmaps.length > 0 && isImagePowerOfTwo ) {\r\n\r\n\t\t\t\tfor ( var i = 0, il = mipmaps.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\tmipmap = mipmaps[ i ];\r\n\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, i, glFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttexture.generateMipmaps = false;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, 0, glFormat, image.width, image.height, 0, glFormat, glType, image.data );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( texture instanceof THREE.CompressedTexture ) {\r\n\r\n\t\t\tfor ( var i = 0, il = mipmaps.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tmipmap = mipmaps[ i ];\r\n\r\n\t\t\t\tif ( texture.format !== THREE.RGBAFormat && texture.format !== THREE.RGBFormat ) {\r\n\r\n\t\t\t\t\tif ( state.getCompressedTextureFormats().indexOf( glFormat ) > - 1 ) {\r\n\r\n\t\t\t\t\t\tstate.compressedTexImage2D( _gl.TEXTURE_2D, i, glFormat, mipmap.width, mipmap.height, 0, mipmap.data );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tconsole.warn( \"THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()\" );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, i, glFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// regular Texture (image, video, canvas)\r\n\r\n\t\t\t// use manually created mipmaps if available\r\n\t\t\t// if there are no manual mipmaps\r\n\t\t\t// set 0 level mipmap and then use GL to generate other mipmap levels\r\n\r\n\t\t\tif ( mipmaps.length > 0 && isImagePowerOfTwo ) {\r\n\r\n\t\t\t\tfor ( var i = 0, il = mipmaps.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\tmipmap = mipmaps[ i ];\r\n\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, i, glFormat, glFormat, glType, mipmap );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttexture.generateMipmaps = false;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, 0, glFormat, glFormat, glType, texture.image );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( texture.generateMipmaps && isImagePowerOfTwo ) _gl.generateMipmap( _gl.TEXTURE_2D );\r\n\r\n\t\ttextureProperties.__version = texture.version;\r\n\r\n\t\tif ( texture.onUpdate ) texture.onUpdate( texture );\r\n\r\n\t}\r\n\r\n\tthis.setTexture = function ( texture, slot ) {\r\n\r\n\t\tvar textureProperties = properties.get( texture );\r\n\r\n\t\tif ( texture.version > 0 && textureProperties.__version !== texture.version ) {\r\n\r\n\t\t\tvar image = texture.image;\r\n\r\n\t\t\tif ( image === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture marked for update but image is undefined', texture );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( image.complete === false ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture marked for update but image is incomplete', texture );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tuploadTexture( textureProperties, texture, slot );\r\n\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tstate.activeTexture( _gl.TEXTURE0 + slot );\r\n\t\tstate.bindTexture( _gl.TEXTURE_2D, textureProperties.__webglTexture );\r\n\r\n\t};\r\n\r\n\tfunction clampToMaxSize ( image, maxSize ) {\r\n\r\n\t\tif ( image.width > maxSize || image.height > maxSize ) {\r\n\r\n\t\t\t// Warning: Scaling through the canvas will only work with images that use\r\n\t\t\t// premultiplied alpha.\r\n\r\n\t\t\tvar scale = maxSize / Math.max( image.width, image.height );\r\n\r\n\t\t\tvar canvas = document.createElement( 'canvas' );\r\n\t\t\tcanvas.width = Math.floor( image.width * scale );\r\n\t\t\tcanvas.height = Math.floor( image.height * scale );\r\n\r\n\t\t\tvar context = canvas.getContext( '2d' );\r\n\t\t\tcontext.drawImage( image, 0, 0, image.width, image.height, 0, 0, canvas.width, canvas.height );\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: image is too big (' + image.width + 'x' + image.height + '). Resized to ' + canvas.width + 'x' + canvas.height, image );\r\n\r\n\t\t\treturn canvas;\r\n\r\n\t\t}\r\n\r\n\t\treturn image;\r\n\r\n\t}\r\n\r\n\tfunction isPowerOfTwo( image ) {\r\n\r\n\t\treturn THREE.Math.isPowerOfTwo( image.width ) && THREE.Math.isPowerOfTwo( image.height );\r\n\r\n\t}\r\n\r\n\tfunction textureNeedsPowerOfTwo( texture ) {\r\n\r\n\t\tif ( texture.wrapS !== THREE.ClampToEdgeWrapping || texture.wrapT !== THREE.ClampToEdgeWrapping ) return true;\r\n\t\tif ( texture.minFilter !== THREE.NearestFilter && texture.minFilter !== THREE.LinearFilter ) return true;\r\n\r\n\t\treturn false;\r\n\r\n\t}\r\n\r\n\tfunction makePowerOfTwo( image ) {\r\n\r\n\t\tif ( image instanceof HTMLImageElement || image instanceof HTMLCanvasElement ) {\r\n\r\n\t\t\tvar canvas = document.createElement( 'canvas' );\r\n\t\t\tcanvas.width = THREE.Math.nearestPowerOfTwo( image.width );\r\n\t\t\tcanvas.height = THREE.Math.nearestPowerOfTwo( image.height );\r\n\r\n\t\t\tvar context = canvas.getContext( '2d' );\r\n\t\t\tcontext.drawImage( image, 0, 0, canvas.width, canvas.height );\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: image is not power of two (' + image.width + 'x' + image.height + '). Resized to ' + canvas.width + 'x' + canvas.height, image );\r\n\r\n\t\t\treturn canvas;\r\n\r\n\t\t}\r\n\r\n\t\treturn image;\r\n\r\n\t}\r\n\r\n\tfunction setCubeTexture ( texture, slot ) {\r\n\r\n\t\tvar textureProperties = properties.get( texture );\r\n\r\n\t\tif ( texture.image.length === 6 ) {\r\n\r\n\t\t\tif ( texture.version > 0 && textureProperties.__version !== texture.version ) {\r\n\r\n\t\t\t\tif ( ! textureProperties.__image__webglTextureCube ) {\r\n\r\n\t\t\t\t\ttexture.addEventListener( 'dispose', onTextureDispose );\r\n\r\n\t\t\t\t\ttextureProperties.__image__webglTextureCube = _gl.createTexture();\r\n\r\n\t\t\t\t\t_infoMemory.textures ++;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tstate.activeTexture( _gl.TEXTURE0 + slot );\r\n\t\t\t\tstate.bindTexture( _gl.TEXTURE_CUBE_MAP, textureProperties.__image__webglTextureCube );\r\n\r\n\t\t\t\t_gl.pixelStorei( _gl.UNPACK_FLIP_Y_WEBGL, texture.flipY );\r\n\r\n\t\t\t\tvar isCompressed = texture instanceof THREE.CompressedTexture;\r\n\t\t\t\tvar isDataTexture = texture.image[ 0 ] instanceof THREE.DataTexture;\r\n\r\n\t\t\t\tvar cubeImage = [];\r\n\r\n\t\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\t\tif ( _this.autoScaleCubemaps && ! isCompressed && ! isDataTexture ) {\r\n\r\n\t\t\t\t\t\tcubeImage[ i ] = clampToMaxSize( texture.image[ i ], capabilities.maxCubemapSize );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tcubeImage[ i ] = isDataTexture ? texture.image[ i ].image : texture.image[ i ];\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar image = cubeImage[ 0 ],\r\n\t\t\t\tisImagePowerOfTwo = isPowerOfTwo( image ),\r\n\t\t\t\tglFormat = paramThreeToGL( texture.format ),\r\n\t\t\t\tglType = paramThreeToGL( texture.type );\r\n\r\n\t\t\t\tsetTextureParameters( _gl.TEXTURE_CUBE_MAP, texture, isImagePowerOfTwo );\r\n\r\n\t\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\t\tif ( ! isCompressed ) {\r\n\r\n\t\t\t\t\t\tif ( isDataTexture ) {\r\n\r\n\t\t\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, 0, glFormat, cubeImage[ i ].width, cubeImage[ i ].height, 0, glFormat, glType, cubeImage[ i ].data );\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, 0, glFormat, glFormat, glType, cubeImage[ i ] );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tvar mipmap, mipmaps = cubeImage[ i ].mipmaps;\r\n\r\n\t\t\t\t\t\tfor ( var j = 0, jl = mipmaps.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\t\t\tmipmap = mipmaps[ j ];\r\n\r\n\t\t\t\t\t\t\tif ( texture.format !== THREE.RGBAFormat && texture.format !== THREE.RGBFormat ) {\r\n\r\n\t\t\t\t\t\t\t\tif ( state.getCompressedTextureFormats().indexOf( glFormat ) > - 1 ) {\r\n\r\n\t\t\t\t\t\t\t\t\tstate.compressedTexImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, j, glFormat, mipmap.width, mipmap.height, 0, mipmap.data );\r\n\r\n\t\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\t\tconsole.warn( \"THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setCubeTexture()\" );\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, j, glFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( texture.generateMipmaps && isImagePowerOfTwo ) {\r\n\r\n\t\t\t\t\t_gl.generateMipmap( _gl.TEXTURE_CUBE_MAP );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttextureProperties.__version = texture.version;\r\n\r\n\t\t\t\tif ( texture.onUpdate ) texture.onUpdate( texture );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tstate.activeTexture( _gl.TEXTURE0 + slot );\r\n\t\t\t\tstate.bindTexture( _gl.TEXTURE_CUBE_MAP, textureProperties.__image__webglTextureCube );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction setCubeTextureDynamic ( texture, slot ) {\r\n\r\n\t\tstate.activeTexture( _gl.TEXTURE0 + slot );\r\n\t\tstate.bindTexture( _gl.TEXTURE_CUBE_MAP, properties.get( texture ).__webglTexture );\r\n\r\n\t}\r\n\r\n\t// Render targets\r\n\r\n\tfunction setupFrameBuffer ( framebuffer, renderTarget, textureTarget ) {\r\n\r\n\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, framebuffer );\r\n\t\t_gl.framebufferTexture2D( _gl.FRAMEBUFFER, _gl.COLOR_ATTACHMENT0, textureTarget, properties.get( renderTarget.texture ).__webglTexture, 0 );\r\n\r\n\t}\r\n\r\n\tfunction setupRenderBuffer ( renderbuffer, renderTarget ) {\r\n\r\n\t\t_gl.bindRenderbuffer( _gl.RENDERBUFFER, renderbuffer );\r\n\r\n\t\tif ( renderTarget.depthBuffer && ! renderTarget.stencilBuffer ) {\r\n\r\n\t\t\t_gl.renderbufferStorage( _gl.RENDERBUFFER, _gl.DEPTH_COMPONENT16, renderTarget.width, renderTarget.height );\r\n\t\t\t_gl.framebufferRenderbuffer( _gl.FRAMEBUFFER, _gl.DEPTH_ATTACHMENT, _gl.RENDERBUFFER, renderbuffer );\r\n\r\n\t\t/* For some reason this is not working. Defaulting to RGBA4.\r\n\t\t} else if ( ! renderTarget.depthBuffer && renderTarget.stencilBuffer ) {\r\n\r\n\t\t\t_gl.renderbufferStorage( _gl.RENDERBUFFER, _gl.STENCIL_INDEX8, renderTarget.width, renderTarget.height );\r\n\t\t\t_gl.framebufferRenderbuffer( _gl.FRAMEBUFFER, _gl.STENCIL_ATTACHMENT, _gl.RENDERBUFFER, renderbuffer );\r\n\t\t*/\r\n\r\n\t\t} else if ( renderTarget.depthBuffer && renderTarget.stencilBuffer ) {\r\n\r\n\t\t\t_gl.renderbufferStorage( _gl.RENDERBUFFER, _gl.DEPTH_STENCIL, renderTarget.width, renderTarget.height );\r\n\t\t\t_gl.framebufferRenderbuffer( _gl.FRAMEBUFFER, _gl.DEPTH_STENCIL_ATTACHMENT, _gl.RENDERBUFFER, renderbuffer );\r\n\r\n\t\t} else {\r\n\r\n\t\t\t_gl.renderbufferStorage( _gl.RENDERBUFFER, _gl.RGBA4, renderTarget.width, renderTarget.height );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.setRenderTarget = function ( renderTarget ) {\r\n\r\n\t\tvar isCube = ( renderTarget instanceof THREE.WebGLRenderTargetCube );\r\n\r\n\t\tif ( renderTarget && properties.get( renderTarget ).__webglFramebuffer === undefined ) {\r\n\r\n\t\t\tvar renderTargetProperties = properties.get( renderTarget );\r\n\t\t\tvar textureProperties = properties.get( renderTarget.texture );\r\n\r\n\t\t\tif ( renderTarget.depthBuffer === undefined ) renderTarget.depthBuffer = true;\r\n\t\t\tif ( renderTarget.stencilBuffer === undefined ) renderTarget.stencilBuffer = true;\r\n\r\n\t\t\trenderTarget.addEventListener( 'dispose', onRenderTargetDispose );\r\n\r\n\t\t\ttextureProperties.__webglTexture = _gl.createTexture();\r\n\r\n\t\t\t_infoMemory.textures ++;\r\n\r\n\t\t\t// Setup texture, create render and frame buffers\r\n\r\n\t\t\tvar isTargetPowerOfTwo = isPowerOfTwo( renderTarget ),\r\n\t\t\t\tglFormat = paramThreeToGL( renderTarget.texture.format ),\r\n\t\t\t\tglType = paramThreeToGL( renderTarget.texture.type );\r\n\r\n\t\t\tif ( isCube ) {\r\n\r\n\t\t\t\trenderTargetProperties.__webglFramebuffer = [];\r\n\t\t\t\trenderTargetProperties.__webglRenderbuffer = [];\r\n\r\n\t\t\t\tstate.bindTexture( _gl.TEXTURE_CUBE_MAP, textureProperties.__webglTexture );\r\n\r\n\t\t\t\tsetTextureParameters( _gl.TEXTURE_CUBE_MAP, renderTarget.texture, isTargetPowerOfTwo );\r\n\r\n\t\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\t\trenderTargetProperties.__webglFramebuffer[ i ] = _gl.createFramebuffer();\r\n\t\t\t\t\trenderTargetProperties.__webglRenderbuffer[ i ] = _gl.createRenderbuffer();\r\n\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, 0, glFormat, renderTarget.width, renderTarget.height, 0, glFormat, glType, null );\r\n\r\n\t\t\t\t\tsetupFrameBuffer( renderTargetProperties.__webglFramebuffer[ i ], renderTarget, _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i );\r\n\t\t\t\t\tsetupRenderBuffer( renderTargetProperties.__webglRenderbuffer[ i ], renderTarget );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( renderTarget.texture.generateMipmaps && isTargetPowerOfTwo ) _gl.generateMipmap( _gl.TEXTURE_CUBE_MAP );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\trenderTargetProperties.__webglFramebuffer = _gl.createFramebuffer();\r\n\r\n\t\t\t\tif ( renderTarget.shareDepthFrom ) {\r\n\r\n\t\t\t\t\trenderTargetProperties.__webglRenderbuffer = renderTarget.shareDepthFrom.__webglRenderbuffer;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\trenderTargetProperties.__webglRenderbuffer = _gl.createRenderbuffer();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tstate.bindTexture( _gl.TEXTURE_2D, textureProperties.__webglTexture );\r\n\t\t\t\tsetTextureParameters( _gl.TEXTURE_2D, renderTarget.texture, isTargetPowerOfTwo );\r\n\r\n\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, 0, glFormat, renderTarget.width, renderTarget.height, 0, glFormat, glType, null );\r\n\r\n\t\t\t\tsetupFrameBuffer( renderTargetProperties.__webglFramebuffer, renderTarget, _gl.TEXTURE_2D );\r\n\r\n\t\t\t\tif ( renderTarget.shareDepthFrom ) {\r\n\r\n\t\t\t\t\tif ( renderTarget.depthBuffer && ! renderTarget.stencilBuffer ) {\r\n\r\n\t\t\t\t\t\t_gl.framebufferRenderbuffer( _gl.FRAMEBUFFER, _gl.DEPTH_ATTACHMENT, _gl.RENDERBUFFER, renderTargetProperties.__webglRenderbuffer );\r\n\r\n\t\t\t\t\t} else if ( renderTarget.depthBuffer && renderTarget.stencilBuffer ) {\r\n\r\n\t\t\t\t\t\t_gl.framebufferRenderbuffer( _gl.FRAMEBUFFER, _gl.DEPTH_STENCIL_ATTACHMENT, _gl.RENDERBUFFER, renderTargetProperties.__webglRenderbuffer );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tsetupRenderBuffer( renderTargetProperties.__webglRenderbuffer, renderTarget );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( renderTarget.texture.generateMipmaps && isTargetPowerOfTwo ) _gl.generateMipmap( _gl.TEXTURE_2D );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Release everything\r\n\r\n\t\t\tif ( isCube ) {\r\n\r\n\t\t\t\tstate.bindTexture( _gl.TEXTURE_CUBE_MAP, null );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tstate.bindTexture( _gl.TEXTURE_2D, null );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_gl.bindRenderbuffer( _gl.RENDERBUFFER, null );\r\n\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, null );\r\n\r\n\t\t}\r\n\r\n\t\tvar framebuffer, width, height, vx, vy;\r\n\r\n\t\tif ( renderTarget ) {\r\n\r\n\t\t\tvar renderTargetProperties = properties.get( renderTarget );\r\n\r\n\t\t\tif ( isCube ) {\r\n\r\n\t\t\t\tframebuffer = renderTargetProperties.__webglFramebuffer[ renderTarget.activeCubeFace ];\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tframebuffer = renderTargetProperties.__webglFramebuffer;\r\n\r\n\t\t\t}\r\n\r\n\t\t\twidth = renderTarget.width;\r\n\t\t\theight = renderTarget.height;\r\n\r\n\t\t\tvx = 0;\r\n\t\t\tvy = 0;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tframebuffer = null;\r\n\r\n\t\t\twidth = _viewportWidth;\r\n\t\t\theight = _viewportHeight;\r\n\r\n\t\t\tvx = _viewportX;\r\n\t\t\tvy = _viewportY;\r\n\r\n\t\t}\r\n\r\n\t\tif ( framebuffer !== _currentFramebuffer ) {\r\n\r\n\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, framebuffer );\r\n\t\t\t_gl.viewport( vx, vy, width, height );\r\n\r\n\t\t\t_currentFramebuffer = framebuffer;\r\n\r\n\t\t}\r\n\r\n\t\tif ( isCube ) {\r\n\r\n\t\t\tvar textureProperties = properties.get( renderTarget.texture );\r\n\t\t\t_gl.framebufferTexture2D( _gl.FRAMEBUFFER, _gl.COLOR_ATTACHMENT0, _gl.TEXTURE_CUBE_MAP_POSITIVE_X + renderTarget.activeCubeFace, textureProperties.__webglTexture, 0 );\r\n\r\n\t\t}\r\n\r\n\t\t_currentWidth = width;\r\n\t\t_currentHeight = height;\r\n\r\n\t};\r\n\r\n\tthis.readRenderTargetPixels = function ( renderTarget, x, y, width, height, buffer ) {\r\n\r\n\t\tif ( renderTarget instanceof THREE.WebGLRenderTarget === false ) {\r\n\r\n\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tvar framebuffer = properties.get( renderTarget ).__webglFramebuffer;\r\n\r\n\t\tif ( framebuffer ) {\r\n\r\n\t\t\tvar restore = false;\r\n\r\n\t\t\tif ( framebuffer !== _currentFramebuffer ) {\r\n\r\n\t\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, framebuffer );\r\n\r\n\t\t\t\trestore = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\ttry {\r\n\r\n\t\t\t\tvar texture = renderTarget.texture;\r\n\r\n\t\t\t\tif ( texture.format !== THREE.RGBAFormat\r\n\t\t\t\t\t&& paramThreeToGL( texture.format ) !== _gl.getParameter( _gl.IMPLEMENTATION_COLOR_READ_FORMAT ) ) {\r\n\r\n\t\t\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.' );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( texture.type !== THREE.UnsignedByteType\r\n\t\t\t\t\t&& paramThreeToGL( texture.type ) !== _gl.getParameter( _gl.IMPLEMENTATION_COLOR_READ_TYPE )\r\n\t\t\t\t\t&& ! ( texture.type === THREE.FloatType && extensions.get( 'WEBGL_color_buffer_float' ) )\r\n\t\t\t\t\t&& ! ( texture.type === THREE.HalfFloatType && extensions.get( 'EXT_color_buffer_half_float' ) ) ) {\r\n\r\n\t\t\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.' );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( _gl.checkFramebufferStatus( _gl.FRAMEBUFFER ) === _gl.FRAMEBUFFER_COMPLETE ) {\r\n\r\n\t\t\t\t\t_gl.readPixels( x, y, width, height, paramThreeToGL( texture.format ), paramThreeToGL( texture.type ), buffer );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} finally {\r\n\r\n\t\t\t\tif ( restore ) {\r\n\r\n\t\t\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, _currentFramebuffer );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tfunction updateRenderTargetMipmap( renderTarget ) {\r\n\r\n\t\tvar target = renderTarget instanceof THREE.WebGLRenderTargetCube ? _gl.TEXTURE_CUBE_MAP : _gl.TEXTURE_2D;\r\n\t\tvar texture = properties.get( renderTarget.texture ).__webglTexture;\r\n\r\n\t\tstate.bindTexture( target, texture );\r\n\t\t_gl.generateMipmap( target );\r\n\t\tstate.bindTexture( target, null );\r\n\r\n\t}\r\n\r\n\t// Fallback filters for non-power-of-2 textures\r\n\r\n\tfunction filterFallback ( f ) {\r\n\r\n\t\tif ( f === THREE.NearestFilter || f === THREE.NearestMipMapNearestFilter || f === THREE.NearestMipMapLinearFilter ) {\r\n\r\n\t\t\treturn _gl.NEAREST;\r\n\r\n\t\t}\r\n\r\n\t\treturn _gl.LINEAR;\r\n\r\n\t}\r\n\r\n\t// Map three.js constants to WebGL constants\r\n\r\n\tfunction paramThreeToGL ( p ) {\r\n\r\n\t\tvar extension;\r\n\r\n\t\tif ( p === THREE.RepeatWrapping ) return _gl.REPEAT;\r\n\t\tif ( p === THREE.ClampToEdgeWrapping ) return _gl.CLAMP_TO_EDGE;\r\n\t\tif ( p === THREE.MirroredRepeatWrapping ) return _gl.MIRRORED_REPEAT;\r\n\r\n\t\tif ( p === THREE.NearestFilter ) return _gl.NEAREST;\r\n\t\tif ( p === THREE.NearestMipMapNearestFilter ) return _gl.NEAREST_MIPMAP_NEAREST;\r\n\t\tif ( p === THREE.NearestMipMapLinearFilter ) return _gl.NEAREST_MIPMAP_LINEAR;\r\n\r\n\t\tif ( p === THREE.LinearFilter ) return _gl.LINEAR;\r\n\t\tif ( p === THREE.LinearMipMapNearestFilter ) return _gl.LINEAR_MIPMAP_NEAREST;\r\n\t\tif ( p === THREE.LinearMipMapLinearFilter ) return _gl.LINEAR_MIPMAP_LINEAR;\r\n\r\n\t\tif ( p === THREE.UnsignedByteType ) return _gl.UNSIGNED_BYTE;\r\n\t\tif ( p === THREE.UnsignedShort4444Type ) return _gl.UNSIGNED_SHORT_4_4_4_4;\r\n\t\tif ( p === THREE.UnsignedShort5551Type ) return _gl.UNSIGNED_SHORT_5_5_5_1;\r\n\t\tif ( p === THREE.UnsignedShort565Type ) return _gl.UNSIGNED_SHORT_5_6_5;\r\n\r\n\t\tif ( p === THREE.ByteType ) return _gl.BYTE;\r\n\t\tif ( p === THREE.ShortType ) return _gl.SHORT;\r\n\t\tif ( p === THREE.UnsignedShortType ) return _gl.UNSIGNED_SHORT;\r\n\t\tif ( p === THREE.IntType ) return _gl.INT;\r\n\t\tif ( p === THREE.UnsignedIntType ) return _gl.UNSIGNED_INT;\r\n\t\tif ( p === THREE.FloatType ) return _gl.FLOAT;\r\n\r\n\t\textension = extensions.get( 'OES_texture_half_float' );\r\n\r\n\t\tif ( extension !== null ) {\r\n\r\n\t\t\tif ( p === THREE.HalfFloatType ) return extension.HALF_FLOAT_OES;\r\n\r\n\t\t}\r\n\r\n\t\tif ( p === THREE.AlphaFormat ) return _gl.ALPHA;\r\n\t\tif ( p === THREE.RGBFormat ) return _gl.RGB;\r\n\t\tif ( p === THREE.RGBAFormat ) return _gl.RGBA;\r\n\t\tif ( p === THREE.LuminanceFormat ) return _gl.LUMINANCE;\r\n\t\tif ( p === THREE.LuminanceAlphaFormat ) return _gl.LUMINANCE_ALPHA;\r\n\r\n\t\tif ( p === THREE.AddEquation ) return _gl.FUNC_ADD;\r\n\t\tif ( p === THREE.SubtractEquation ) return _gl.FUNC_SUBTRACT;\r\n\t\tif ( p === THREE.ReverseSubtractEquation ) return _gl.FUNC_REVERSE_SUBTRACT;\r\n\r\n\t\tif ( p === THREE.ZeroFactor ) return _gl.ZERO;\r\n\t\tif ( p === THREE.OneFactor ) return _gl.ONE;\r\n\t\tif ( p === THREE.SrcColorFactor ) return _gl.SRC_COLOR;\r\n\t\tif ( p === THREE.OneMinusSrcColorFactor ) return _gl.ONE_MINUS_SRC_COLOR;\r\n\t\tif ( p === THREE.SrcAlphaFactor ) return _gl.SRC_ALPHA;\r\n\t\tif ( p === THREE.OneMinusSrcAlphaFactor ) return _gl.ONE_MINUS_SRC_ALPHA;\r\n\t\tif ( p === THREE.DstAlphaFactor ) return _gl.DST_ALPHA;\r\n\t\tif ( p === THREE.OneMinusDstAlphaFactor ) return _gl.ONE_MINUS_DST_ALPHA;\r\n\r\n\t\tif ( p === THREE.DstColorFactor ) return _gl.DST_COLOR;\r\n\t\tif ( p === THREE.OneMinusDstColorFactor ) return _gl.ONE_MINUS_DST_COLOR;\r\n\t\tif ( p === THREE.SrcAlphaSaturateFactor ) return _gl.SRC_ALPHA_SATURATE;\r\n\r\n\t\textension = extensions.get( 'WEBGL_compressed_texture_s3tc' );\r\n\r\n\t\tif ( extension !== null ) {\r\n\r\n\t\t\tif ( p === THREE.RGB_S3TC_DXT1_Format ) return extension.COMPRESSED_RGB_S3TC_DXT1_EXT;\r\n\t\t\tif ( p === THREE.RGBA_S3TC_DXT1_Format ) return extension.COMPRESSED_RGBA_S3TC_DXT1_EXT;\r\n\t\t\tif ( p === THREE.RGBA_S3TC_DXT3_Format ) return extension.COMPRESSED_RGBA_S3TC_DXT3_EXT;\r\n\t\t\tif ( p === THREE.RGBA_S3TC_DXT5_Format ) return extension.COMPRESSED_RGBA_S3TC_DXT5_EXT;\r\n\r\n\t\t}\r\n\r\n\t\textension = extensions.get( 'WEBGL_compressed_texture_pvrtc' );\r\n\r\n\t\tif ( extension !== null ) {\r\n\r\n\t\t\tif ( p === THREE.RGB_PVRTC_4BPPV1_Format ) return extension.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;\r\n\t\t\tif ( p === THREE.RGB_PVRTC_2BPPV1_Format ) return extension.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;\r\n\t\t\tif ( p === THREE.RGBA_PVRTC_4BPPV1_Format ) return extension.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;\r\n\t\t\tif ( p === THREE.RGBA_PVRTC_2BPPV1_Format ) return extension.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG;\r\n\r\n\t\t}\r\n\r\n\t\textension = extensions.get( 'EXT_blend_minmax' );\r\n\r\n\t\tif ( extension !== null ) {\r\n\r\n\t\t\tif ( p === THREE.MinEquation ) return extension.MIN_EXT;\r\n\t\t\tif ( p === THREE.MaxEquation ) return extension.MAX_EXT;\r\n\r\n\t\t}\r\n\r\n\t\treturn 0;\r\n\r\n\t}\r\n\r\n\t// DEPRECATED\r\n\r\n\tthis.supportsFloatTextures = function () {\r\n\r\n\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( \\'OES_texture_float\\' ).' );\r\n\t\treturn extensions.get( 'OES_texture_float' );\r\n\r\n\t};\r\n\r\n\tthis.supportsHalfFloatTextures = function () {\r\n\r\n\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( \\'OES_texture_half_float\\' ).' );\r\n\t\treturn extensions.get( 'OES_texture_half_float' );\r\n\r\n\t};\r\n\r\n\tthis.supportsStandardDerivatives = function () {\r\n\r\n\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( \\'OES_standard_derivatives\\' ).' );\r\n\t\treturn extensions.get( 'OES_standard_derivatives' );\r\n\r\n\t};\r\n\r\n\tthis.supportsCompressedTextureS3TC = function () {\r\n\r\n\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( \\'WEBGL_compressed_texture_s3tc\\' ).' );\r\n\t\treturn extensions.get( 'WEBGL_compressed_texture_s3tc' );\r\n\r\n\t};\r\n\r\n\tthis.supportsCompressedTexturePVRTC = function () {\r\n\r\n\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( \\'WEBGL_compressed_texture_pvrtc\\' ).' );\r\n\t\treturn extensions.get( 'WEBGL_compressed_texture_pvrtc' );\r\n\r\n\t};\r\n\r\n\tthis.supportsBlendMinMax = function () {\r\n\r\n\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( \\'EXT_blend_minmax\\' ).' );\r\n\t\treturn extensions.get( 'EXT_blend_minmax' );\r\n\r\n\t};\r\n\r\n\tthis.supportsVertexTextures = function () {\r\n\r\n\t\treturn capabilities.vertexTextures;\r\n\r\n\t};\r\n\r\n\tthis.supportsInstancedArrays = function () {\r\n\r\n\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( \\'ANGLE_instanced_arrays\\' ).' );\r\n\t\treturn extensions.get( 'ANGLE_instanced_arrays' );\r\n\r\n\t};\r\n\r\n\t//\r\n\r\n\tthis.initMaterial = function () {\r\n\r\n\t\tconsole.warn( 'THREE.WebGLRenderer: .initMaterial() has been removed.' );\r\n\r\n\t};\r\n\r\n\tthis.addPrePlugin = function () {\r\n\r\n\t\tconsole.warn( 'THREE.WebGLRenderer: .addPrePlugin() has been removed.' );\r\n\r\n\t};\r\n\r\n\tthis.addPostPlugin = function () {\r\n\r\n\t\tconsole.warn( 'THREE.WebGLRenderer: .addPostPlugin() has been removed.' );\r\n\r\n\t};\r\n\r\n\tthis.updateShadowMap = function () {\r\n\r\n\t\tconsole.warn( 'THREE.WebGLRenderer: .updateShadowMap() has been removed.' );\r\n\r\n\t};\r\n\r\n\tObject.defineProperties( this, {\r\n\t\tshadowMapEnabled: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\treturn shadowMap.enabled;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled.' );\r\n\t\t\t\tshadowMap.enabled = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowMapType: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\treturn shadowMap.type;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type.' );\r\n\t\t\t\tshadowMap.type = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowMapCullFace: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\treturn shadowMap.cullFace;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace.' );\r\n\t\t\t\tshadowMap.cullFace = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowMapDebug: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\treturn shadowMap.debug;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMapDebug is now .shadowMap.debug.' );\r\n\t\t\t\tshadowMap.debug = value;\r\n\r\n\t\t\t}\r\n\t\t}\r\n\t} );\r\n\r\n};\r\n\r\n// File:src/renderers/WebGLRenderTarget.js\r\n\r\n/**\r\n * @author szimek / https://github.com/szimek/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.WebGLRenderTarget = function ( width, height, options ) {\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\tthis.width = width;\r\n\tthis.height = height;\r\n\r\n\toptions = options || {};\r\n\r\n\tif ( options.minFilter === undefined ) options.minFilter = THREE.LinearFilter;\r\n\r\n\tthis.texture = new THREE.Texture( undefined, undefined, options.wrapS, options.wrapT, options.magFilter, options.minFilter, options.format, options.type, options.anisotropy );\r\n\r\n\tthis.depthBuffer = options.depthBuffer !== undefined ? options.depthBuffer : true;\r\n\tthis.stencilBuffer = options.stencilBuffer !== undefined ? options.stencilBuffer : true;\r\n\r\n\tthis.shareDepthFrom = options.shareDepthFrom !== undefined ? options.shareDepthFrom : null;\r\n\r\n};\r\n\r\nTHREE.WebGLRenderTarget.prototype = {\r\n\r\n\tconstructor: THREE.WebGLRenderTarget,\r\n\r\n\tget wrapS() {\r\n\r\n\t\tconsole.warn( 'THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.' );\r\n\r\n\t\treturn this.texture.wrapS;\r\n\r\n\t},\r\n\r\n\tset wrapS( value ) {\r\n\r\n\t\tconsole.warn( 'THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.' );\r\n\r\n\t\tthis.texture.wrapS = value;\r\n\r\n\t},\r\n\r\n\tget wrapT() {\r\n\r\n\t\tconsole.warn( 'THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.' );\r\n\r\n\t\treturn this.texture.wrapT;\r\n\r\n\t},\r\n\r\n\tset wrapT( value ) {\r\n\r\n\t\tconsole.warn( 'THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.' );\r\n\r\n\t\tthis.texture.wrapT = value;\r\n\r\n\t},\r\n\r\n\tget magFilter() {\r\n\r\n\t\tconsole.warn( 'THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.' );\r\n\r\n\t\treturn this.texture.magFilter;\r\n\r\n\t},\r\n\r\n\tset magFilter( value ) {\r\n\r\n\t\tconsole.warn( 'THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.' );\r\n\r\n\t\tthis.texture.magFilter = value;\r\n\r\n\t},\r\n\r\n\tget minFilter() {\r\n\r\n\t\tconsole.warn( 'THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.' );\r\n\r\n\t\treturn this.texture.minFilter;\r\n\r\n\t},\r\n\r\n\tset minFilter( value ) {\r\n\r\n\t\tconsole.warn( 'THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.' );\r\n\r\n\t\tthis.texture.minFilter = value;\r\n\r\n\t},\r\n\r\n\tget anisotropy() {\r\n\r\n\t\tconsole.warn( 'THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.' );\r\n\r\n\t\treturn this.texture.anisotropy;\r\n\r\n\t},\r\n\r\n\tset anisotropy( value ) {\r\n\r\n\t\tconsole.warn( 'THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.' );\r\n\r\n\t\tthis.texture.anisotropy = value;\r\n\r\n\t},\r\n\r\n\tget offset() {\r\n\r\n\t\tconsole.warn( 'THREE.WebGLRenderTarget: .offset is now .texture.offset.' );\r\n\r\n\t\treturn this.texture.offset;\r\n\r\n\t},\r\n\r\n\tset offset( value ) {\r\n\r\n\t\tconsole.warn( 'THREE.WebGLRenderTarget: .offset is now .texture.offset.' );\r\n\r\n\t\tthis.texture.offset = value;\r\n\r\n\t},\r\n\r\n\tget repeat() {\r\n\r\n\t\tconsole.warn( 'THREE.WebGLRenderTarget: .repeat is now .texture.repeat.' );\r\n\r\n\t\treturn this.texture.repeat;\r\n\r\n\t},\r\n\r\n\tset repeat( value ) {\r\n\r\n\t\tconsole.warn( 'THREE.WebGLRenderTarget: .repeat is now .texture.repeat.' );\r\n\r\n\t\tthis.texture.repeat = value;\r\n\r\n\t},\r\n\r\n\tget format() {\r\n\r\n\t\tconsole.warn( 'THREE.WebGLRenderTarget: .format is now .texture.format.' );\r\n\r\n\t\treturn this.texture.format;\r\n\r\n\t},\r\n\r\n\tset format( value ) {\r\n\r\n\t\tconsole.warn( 'THREE.WebGLRenderTarget: .format is now .texture.format.' );\r\n\r\n\t\tthis.texture.format = value;\r\n\r\n\t},\r\n\r\n\tget type() {\r\n\r\n\t\tconsole.warn( 'THREE.WebGLRenderTarget: .type is now .texture.type.' );\r\n\r\n\t\treturn this.texture.type;\r\n\r\n\t},\r\n\r\n\tset type( value ) {\r\n\r\n\t\tconsole.warn( 'THREE.WebGLRenderTarget: .type is now .texture.type.' );\r\n\r\n\t\tthis.texture.type = value;\r\n\r\n\t},\r\n\r\n\tget generateMipmaps() {\r\n\r\n\t\tconsole.warn( 'THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.' );\r\n\r\n\t\treturn this.texture.generateMipmaps;\r\n\r\n\t},\r\n\r\n\tset generateMipmaps( value ) {\r\n\r\n\t\tconsole.warn( 'THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.' );\r\n\r\n\t\tthis.texture.generateMipmaps = value;\r\n\r\n\t},\r\n\r\n\t//\r\n\r\n\tsetSize: function ( width, height ) {\r\n\r\n\t\tif ( this.width !== width || this.height !== height ) {\r\n\r\n\t\t\tthis.width = width;\r\n\t\t\tthis.height = height;\r\n\r\n\t\t\tthis.dispose();\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( source ) {\r\n\r\n\t\tthis.width = source.width;\r\n\t\tthis.height = source.height;\r\n\r\n\t\tthis.texture = source.texture.clone();\r\n\r\n\t\tthis.depthBuffer = source.depthBuffer;\r\n\t\tthis.stencilBuffer = source.stencilBuffer;\r\n\r\n\t\tthis.shareDepthFrom = source.shareDepthFrom;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdispose: function () {\r\n\r\n\t\tthis.dispatchEvent( { type: 'dispose' } );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply( THREE.WebGLRenderTarget.prototype );\r\n\r\n// File:src/renderers/WebGLRenderTargetCube.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com\r\n */\r\n\r\nTHREE.WebGLRenderTargetCube = function ( width, height, options ) {\r\n\r\n\tTHREE.WebGLRenderTarget.call( this, width, height, options );\r\n\r\n\tthis.activeCubeFace = 0; // PX 0, NX 1, PY 2, NY 3, PZ 4, NZ 5\r\n\r\n};\r\n\r\nTHREE.WebGLRenderTargetCube.prototype = Object.create( THREE.WebGLRenderTarget.prototype );\r\nTHREE.WebGLRenderTargetCube.prototype.constructor = THREE.WebGLRenderTargetCube;\r\n\r\n// File:src/renderers/webgl/WebGLBufferRenderer.js\r\n\r\n/**\r\n* @author mrdoob / http://mrdoob.com/\r\n*/\r\n\r\nTHREE.WebGLBufferRenderer = function ( _gl, extensions, _infoRender ) {\r\n\r\n\tvar mode;\r\n\r\n\tfunction setMode( value ) {\r\n\r\n\t\tmode = value;\r\n\r\n\t}\r\n\r\n\tfunction render( start, count ) {\r\n\r\n\t\t_gl.drawArrays( mode, start, count );\r\n\r\n\t\t_infoRender.calls ++;\r\n\t\t_infoRender.vertices += count;\r\n\t\tif ( mode === _gl.TRIANGLES ) _infoRender.faces += count / 3;\r\n\r\n\t}\r\n\r\n\tfunction renderInstances( geometry ) {\r\n\r\n\t\tvar extension = extensions.get( 'ANGLE_instanced_arrays' );\r\n\r\n\t\tif ( extension === null ) {\r\n\r\n\t\t\tconsole.error( 'THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tvar position = geometry.attributes.position;\r\n\r\n\t\tif ( position instanceof THREE.InterleavedBufferAttribute ) {\r\n\r\n\t\t\textension.drawArraysInstancedANGLE( mode, 0, position.data.count, geometry.maxInstancedCount );\r\n\r\n\t\t} else {\r\n\r\n\t\t\textension.drawArraysInstancedANGLE( mode, 0, position.count, geometry.maxInstancedCount );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.setMode = setMode;\r\n\tthis.render = render;\r\n\tthis.renderInstances = renderInstances;\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/WebGLIndexedBufferRenderer.js\r\n\r\n/**\r\n* @author mrdoob / http://mrdoob.com/\r\n*/\r\n\r\nTHREE.WebGLIndexedBufferRenderer = function ( _gl, extensions, _infoRender ) {\r\n\r\n\tvar mode;\r\n\r\n\tfunction setMode( value ) {\r\n\r\n\t\tmode = value;\r\n\r\n\t}\r\n\r\n\tvar type, size;\r\n\r\n\tfunction setIndex( index ) {\r\n\r\n\t\tif ( index.array instanceof Uint32Array && extensions.get( 'OES_element_index_uint' ) ) {\r\n\r\n\t\t\ttype = _gl.UNSIGNED_INT;\r\n\t\t\tsize = 4;\r\n\r\n\t\t} else {\r\n\r\n\t\t\ttype = _gl.UNSIGNED_SHORT;\r\n\t\t\tsize = 2;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction render( start, count ) {\r\n\r\n\t\t_gl.drawElements( mode, count, type, start * size );\r\n\r\n\t\t_infoRender.calls ++;\r\n\t\t_infoRender.vertices += count;\r\n\t\tif ( mode === _gl.TRIANGLES ) _infoRender.faces += count / 3;\r\n\r\n\t}\r\n\r\n\tfunction renderInstances( geometry ) {\r\n\r\n\t\tvar extension = extensions.get( 'ANGLE_instanced_arrays' );\r\n\r\n\t\tif ( extension === null ) {\r\n\r\n\t\t\tconsole.error( 'THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tvar index = geometry.index;\r\n\r\n\t\textension.drawElementsInstancedANGLE( mode, index.array.length, type, 0, geometry.maxInstancedCount );\r\n\r\n\t}\r\n\r\n\tthis.setMode = setMode;\r\n\tthis.setIndex = setIndex;\r\n\tthis.render = render;\r\n\tthis.renderInstances = renderInstances;\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/WebGLExtensions.js\r\n\r\n/**\r\n* @author mrdoob / http://mrdoob.com/\r\n*/\r\n\r\nTHREE.WebGLExtensions = function ( gl ) {\r\n\r\n\tvar extensions = {};\r\n\r\n\tthis.get = function ( name ) {\r\n\r\n\t\tif ( extensions[ name ] !== undefined ) {\r\n\r\n\t\t\treturn extensions[ name ];\r\n\r\n\t\t}\r\n\r\n\t\tvar extension;\r\n\r\n\t\tswitch ( name ) {\r\n\r\n\t\t\tcase 'EXT_texture_filter_anisotropic':\r\n\t\t\t\textension = gl.getExtension( 'EXT_texture_filter_anisotropic' ) || gl.getExtension( 'MOZ_EXT_texture_filter_anisotropic' ) || gl.getExtension( 'WEBKIT_EXT_texture_filter_anisotropic' );\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'WEBGL_compressed_texture_s3tc':\r\n\t\t\t\textension = gl.getExtension( 'WEBGL_compressed_texture_s3tc' ) || gl.getExtension( 'MOZ_WEBGL_compressed_texture_s3tc' ) || gl.getExtension( 'WEBKIT_WEBGL_compressed_texture_s3tc' );\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'WEBGL_compressed_texture_pvrtc':\r\n\t\t\t\textension = gl.getExtension( 'WEBGL_compressed_texture_pvrtc' ) || gl.getExtension( 'WEBKIT_WEBGL_compressed_texture_pvrtc' );\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tdefault:\r\n\t\t\t\textension = gl.getExtension( name );\r\n\r\n\t\t}\r\n\r\n\t\tif ( extension === null ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: ' + name + ' extension not supported.' );\r\n\r\n\t\t}\r\n\r\n\t\textensions[ name ] = extension;\r\n\r\n\t\treturn extension;\r\n\r\n\t};\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/WebGLCapabilities.js\r\n\r\nTHREE.WebGLCapabilities = function ( gl, extensions, parameters ) {\r\n\r\n\tfunction getMaxPrecision( precision ) {\r\n\r\n\t\tif ( precision === 'highp' ) {\r\n\r\n\t\t\tif ( gl.getShaderPrecisionFormat( gl.VERTEX_SHADER, gl.HIGH_FLOAT ).precision > 0 &&\r\n\t\t\t     gl.getShaderPrecisionFormat( gl.FRAGMENT_SHADER, gl.HIGH_FLOAT ).precision > 0 ) {\r\n\r\n\t\t\t\treturn 'highp';\r\n\r\n\t\t\t}\r\n\r\n\t\t\tprecision = 'mediump';\r\n\r\n\t\t}\r\n\r\n\t\tif ( precision === 'mediump' ) {\r\n\r\n\t\t\tif ( gl.getShaderPrecisionFormat( gl.VERTEX_SHADER, gl.MEDIUM_FLOAT ).precision > 0 &&\r\n\t\t\t     gl.getShaderPrecisionFormat( gl.FRAGMENT_SHADER, gl.MEDIUM_FLOAT ).precision > 0 ) {\r\n\r\n\t\t\t\treturn 'mediump';\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn 'lowp';\r\n\r\n\t}\r\n\r\n\tthis.getMaxPrecision = getMaxPrecision;\r\n\r\n\tthis.precision = parameters.precision !== undefined ? parameters.precision : 'highp',\r\n\tthis.logarithmicDepthBuffer = parameters.logarithmicDepthBuffer !== undefined ? parameters.logarithmicDepthBuffer : false;\r\n\r\n\tthis.maxTextures = gl.getParameter( gl.MAX_TEXTURE_IMAGE_UNITS );\r\n\tthis.maxVertexTextures = gl.getParameter( gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS );\r\n\tthis.maxTextureSize = gl.getParameter( gl.MAX_TEXTURE_SIZE );\r\n\tthis.maxCubemapSize = gl.getParameter( gl.MAX_CUBE_MAP_TEXTURE_SIZE );\r\n\r\n\tthis.maxAttributes = gl.getParameter( gl.MAX_VERTEX_ATTRIBS );\r\n\tthis.maxVertexUniforms = gl.getParameter( gl.MAX_VERTEX_UNIFORM_VECTORS );\r\n\tthis.maxVaryings = gl.getParameter( gl.MAX_VARYING_VECTORS );\r\n\tthis.maxFragmentUniforms = gl.getParameter( gl.MAX_FRAGMENT_UNIFORM_VECTORS );\r\n\r\n\tthis.vertexTextures = this.maxVertexTextures > 0;\r\n\tthis.floatFragmentTextures = !! extensions.get( 'OES_texture_float' );\r\n\tthis.floatVertexTextures = this.vertexTextures && this.floatFragmentTextures;\r\n\r\n\tvar _maxPrecision = getMaxPrecision( this.precision );\r\n\r\n\tif ( _maxPrecision !== this.precision ) {\r\n\r\n\t\tconsole.warn( 'THREE.WebGLRenderer:', this.precision, 'not supported, using', _maxPrecision, 'instead.' );\r\n\t\tthis.precision = _maxPrecision;\r\n\r\n\t}\r\n\r\n\tif ( this.logarithmicDepthBuffer ) {\r\n\r\n\t\tthis.logarithmicDepthBuffer = !! extensions.get( 'EXT_frag_depth' );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/WebGLGeometries.js\r\n\r\n/**\r\n* @author mrdoob / http://mrdoob.com/\r\n*/\r\n\r\nTHREE.WebGLGeometries = function ( gl, properties, info ) {\r\n\r\n\tvar geometries = {};\r\n\r\n\tfunction get( object ) {\r\n\r\n\t\tvar geometry = object.geometry;\r\n\r\n\t\tif ( geometries[ geometry.id ] !== undefined ) {\r\n\r\n\t\t\treturn geometries[ geometry.id ];\r\n\r\n\t\t}\r\n\r\n\t\tgeometry.addEventListener( 'dispose', onGeometryDispose );\r\n\r\n\t\tvar buffergeometry;\r\n\r\n\t\tif ( geometry instanceof THREE.BufferGeometry ) {\r\n\r\n\t\t\tbuffergeometry = geometry;\r\n\r\n\t\t} else if ( geometry instanceof THREE.Geometry ) {\r\n\r\n\t\t\tif ( geometry._bufferGeometry === undefined ) {\r\n\r\n\t\t\t\tgeometry._bufferGeometry = new THREE.BufferGeometry().setFromObject( object );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tbuffergeometry = geometry._bufferGeometry;\r\n\r\n\t\t}\r\n\r\n\t\tgeometries[ geometry.id ] = buffergeometry;\r\n\r\n\t\tinfo.memory.geometries ++;\r\n\r\n\t\treturn buffergeometry;\r\n\r\n\t}\r\n\r\n\tfunction onGeometryDispose( event ) {\r\n\r\n\t\tvar geometry = event.target;\r\n\t\tvar buffergeometry = geometries[ geometry.id ];\r\n\r\n\t\tdeleteAttributes( buffergeometry.attributes );\r\n\r\n\t\tgeometry.removeEventListener( 'dispose', onGeometryDispose );\r\n\r\n\t\tdelete geometries[ geometry.id ];\r\n\r\n\t\tvar property = properties.get( geometry );\r\n\t\tif ( property.wireframe ) deleteAttribute( property.wireframe );\r\n\r\n\t\tinfo.memory.geometries --;\r\n\r\n\t}\r\n\r\n\tfunction getAttributeBuffer( attribute ) {\r\n\r\n\t\tif ( attribute instanceof THREE.InterleavedBufferAttribute ) {\r\n\r\n\t\t\treturn properties.get( attribute.data ).__webglBuffer;\r\n\r\n\t\t}\r\n\r\n\t\treturn properties.get( attribute ).__webglBuffer;\r\n\r\n\t}\r\n\r\n\tfunction deleteAttribute( attribute ) {\r\n\r\n\t\tvar buffer = getAttributeBuffer( attribute );\r\n\r\n\t\tif ( buffer !== undefined ) {\r\n\r\n\t\t\tgl.deleteBuffer( buffer );\r\n\t\t\tremoveAttributeBuffer( attribute );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction deleteAttributes( attributes ) {\r\n\r\n\t\tfor ( var name in attributes ) {\r\n\r\n\t\t\tdeleteAttribute( attributes[ name ] );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction removeAttributeBuffer( attribute ) {\r\n\r\n\t\tif ( attribute instanceof THREE.InterleavedBufferAttribute ) {\r\n\r\n\t\t\tproperties.delete( attribute.data );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tproperties.delete( attribute );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.get = get;\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/WebGLObjects.js\r\n\r\n/**\r\n* @author mrdoob / http://mrdoob.com/\r\n*/\r\n\r\nTHREE.WebGLObjects = function ( gl, properties, info ) {\r\n\r\n\tvar geometries = new THREE.WebGLGeometries( gl, properties, info );\r\n\r\n\t//\r\n\r\n\tfunction update( object ) {\r\n\r\n\t\t// TODO: Avoid updating twice (when using shadowMap). Maybe add frame counter.\r\n\r\n\t\tvar geometry = geometries.get( object );\r\n\r\n\t\tif ( object.geometry instanceof THREE.Geometry ) {\r\n\r\n\t\t\tgeometry.updateFromObject( object );\r\n\r\n\t\t}\r\n\r\n\t\tvar index = geometry.index;\r\n\t\tvar attributes = geometry.attributes;\r\n\r\n\t\tif ( index !== null ) {\r\n\r\n\t\t\tupdateAttribute( index, gl.ELEMENT_ARRAY_BUFFER );\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var name in attributes ) {\r\n\r\n\t\t\tupdateAttribute( attributes[ name ], gl.ARRAY_BUFFER );\r\n\r\n\t\t}\r\n\r\n\t\t// morph targets\r\n\r\n\t\tvar morphAttributes = geometry.morphAttributes;\r\n\r\n\t\tfor ( var name in morphAttributes ) {\r\n\r\n\t\t\tvar array = morphAttributes[ name ];\r\n\r\n\t\t\tfor ( var i = 0, l = array.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tupdateAttribute( array[ i ], gl.ARRAY_BUFFER );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn geometry;\r\n\r\n\t}\r\n\r\n\tfunction updateAttribute( attribute, bufferType ) {\r\n\r\n\t\tvar data = ( attribute instanceof THREE.InterleavedBufferAttribute ) ? attribute.data : attribute;\r\n\r\n\t\tvar attributeProperties = properties.get( data );\r\n\r\n\t\tif ( attributeProperties.__webglBuffer === undefined ) {\r\n\r\n\t\t\tcreateBuffer( attributeProperties, data, bufferType );\r\n\r\n\t\t} else if ( attributeProperties.version !== data.version ) {\r\n\r\n\t\t\tupdateBuffer( attributeProperties, data, bufferType );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction createBuffer( attributeProperties, data, bufferType ) {\r\n\r\n\t\tattributeProperties.__webglBuffer = gl.createBuffer();\r\n\t\tgl.bindBuffer( bufferType, attributeProperties.__webglBuffer );\r\n\r\n\t\tvar usage = data.dynamic ? gl.DYNAMIC_DRAW : gl.STATIC_DRAW;\r\n\r\n\t\tgl.bufferData( bufferType, data.array, usage );\r\n\r\n\t\tattributeProperties.version = data.version;\r\n\r\n\t}\r\n\r\n\tfunction updateBuffer( attributeProperties, data, bufferType ) {\r\n\r\n\t\tgl.bindBuffer( bufferType, attributeProperties.__webglBuffer );\r\n\r\n\t\tif ( data.dynamic === false || data.updateRange.count === - 1 ) {\r\n\r\n\t\t\t// Not using update ranges\r\n\r\n\t\t\tgl.bufferSubData( bufferType, 0, data.array );\r\n\r\n\t\t} else if ( data.updateRange.count === 0 ) {\r\n\r\n\t\t\tconsole.error( 'THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually.' );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tgl.bufferSubData( bufferType, data.updateRange.offset * data.array.BYTES_PER_ELEMENT,\r\n\t\t\t\t\t\t\t  data.array.subarray( data.updateRange.offset, data.updateRange.offset + data.updateRange.count ) );\r\n\r\n\t\t\tdata.updateRange.count = 0; // reset range\r\n\r\n\t\t}\r\n\r\n\t\tattributeProperties.version = data.version;\r\n\r\n\t}\r\n\r\n\tfunction getAttributeBuffer( attribute ) {\r\n\r\n\t\tif ( attribute instanceof THREE.InterleavedBufferAttribute ) {\r\n\r\n\t\t\treturn properties.get( attribute.data ).__webglBuffer;\r\n\r\n\t\t}\r\n\r\n\t\treturn properties.get( attribute ).__webglBuffer;\r\n\r\n\t}\r\n\r\n\tfunction getWireframeAttribute( geometry ) {\r\n\r\n\t\tvar property = properties.get( geometry );\r\n\r\n\t\tif ( property.wireframe !== undefined ) {\r\n\r\n\t\t\treturn property.wireframe;\r\n\r\n\t\t}\r\n\r\n\t\tvar indices = [];\r\n\r\n\t\tvar index = geometry.index;\r\n\t\tvar attributes = geometry.attributes;\r\n\t\tvar position = attributes.position;\r\n\r\n\t\t// console.time( 'wireframe' );\r\n\r\n\t\tif ( index !== null ) {\r\n\r\n\t\t\tvar edges = {};\r\n\t\t\tvar array = index.array;\r\n\r\n\t\t\tfor ( var i = 0, l = array.length; i < l; i += 3 ) {\r\n\r\n\t\t\t\tvar a = array[ i + 0 ];\r\n\t\t\t\tvar b = array[ i + 1 ];\r\n\t\t\t\tvar c = array[ i + 2 ];\r\n\r\n\t\t\t\tif ( checkEdge( edges, a, b ) ) indices.push( a, b );\r\n\t\t\t\tif ( checkEdge( edges, b, c ) ) indices.push( b, c );\r\n\t\t\t\tif ( checkEdge( edges, c, a ) ) indices.push( c, a );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tvar array = attributes.position.array;\r\n\r\n\t\t\tfor ( var i = 0, l = ( array.length / 3 ) - 1; i < l; i += 3 ) {\r\n\r\n\t\t\t\tvar a = i + 0;\r\n\t\t\t\tvar b = i + 1;\r\n\t\t\t\tvar c = i + 2;\r\n\r\n\t\t\t\tindices.push( a, b, b, c, c, a );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// console.timeEnd( 'wireframe' );\r\n\r\n\t\tvar TypeArray = position.count > 65535 ? Uint32Array : Uint16Array;\r\n\t\tvar attribute = new THREE.BufferAttribute( new TypeArray( indices ), 1 );\r\n\r\n\t\tupdateAttribute( attribute, gl.ELEMENT_ARRAY_BUFFER );\r\n\r\n\t\tproperty.wireframe = attribute;\r\n\r\n\t\treturn attribute;\r\n\r\n\t}\r\n\r\n\tfunction checkEdge( edges, a, b ) {\r\n\r\n\t\tif ( a > b ) {\r\n\r\n\t\t\tvar tmp = a;\r\n\t\t\ta = b;\r\n\t\t\tb = tmp;\r\n\r\n\t\t}\r\n\r\n\t\tvar list = edges[ a ];\r\n\r\n\t\tif ( list === undefined ) {\r\n\r\n\t\t\tedges[ a ] = [ b ];\r\n\t\t\treturn true;\r\n\r\n\t\t} else if ( list.indexOf( b ) === -1 ) {\r\n\r\n\t\t\tlist.push( b );\r\n\t\t\treturn true;\r\n\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\r\n\t}\r\n\r\n\tthis.getAttributeBuffer = getAttributeBuffer;\r\n\tthis.getWireframeAttribute = getWireframeAttribute;\r\n\r\n\tthis.update = update;\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/WebGLProgram.js\r\n\r\nTHREE.WebGLProgram = ( function () {\r\n\r\n\tvar programIdCount = 0;\r\n\r\n\tfunction generateDefines( defines ) {\r\n\r\n\t\tvar chunks = [];\r\n\r\n\t\tfor ( var name in defines ) {\r\n\r\n\t\t\tvar value = defines[ name ];\r\n\r\n\t\t\tif ( value === false ) continue;\r\n\r\n\t\t\tchunks.push( '#define ' + name + ' ' + value );\r\n\r\n\t\t}\r\n\r\n\t\treturn chunks.join( '\\n' );\r\n\r\n\t}\r\n\r\n\tfunction fetchUniformLocations( gl, program, identifiers ) {\r\n\r\n\t\tvar uniforms = {};\r\n\r\n\t\tvar n = gl.getProgramParameter( program, gl.ACTIVE_UNIFORMS );\r\n\r\n\t\tfor ( var i = 0; i < n; i ++ ) {\r\n\r\n\t\t\tvar info = gl.getActiveUniform( program, i );\r\n\t\t\tvar name = info.name;\r\n\t\t\tvar location = gl.getUniformLocation( program, name );\r\n\r\n\t\t\t// console.log(\"THREE.WebGLProgram: ACTIVE UNIFORM:\", name);\r\n\r\n\t\t\tvar suffixPos = name.lastIndexOf( '[0]' );\r\n\t\t\tif ( suffixPos !== - 1 && suffixPos === name.length - 3 ) {\r\n\r\n\t\t\t\tuniforms[ name.substr( 0, suffixPos ) ] = location;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tuniforms[ name ] = location;\r\n\r\n\t\t}\r\n\r\n\t\treturn uniforms;\r\n\r\n\t}\r\n\r\n\tfunction fetchAttributeLocations( gl, program, identifiers ) {\r\n\r\n\t\tvar attributes = {};\r\n\r\n\t\tvar n = gl.getProgramParameter( program, gl.ACTIVE_ATTRIBUTES );\r\n\r\n\t\tfor ( var i = 0; i < n; i ++ ) {\r\n\r\n\t\t\tvar info = gl.getActiveAttrib( program, i );\r\n\t\t\tvar name = info.name;\r\n\r\n\t\t\t// console.log(\"THREE.WebGLProgram: ACTIVE VERTEX ATTRIBUTE:\", name, i );\r\n\r\n\t\t\tattributes[ name ] = gl.getAttribLocation( program, name );\r\n\r\n\t\t}\r\n\r\n\t\treturn attributes;\r\n\r\n\t}\r\n\r\n\tfunction filterEmptyLine( string ) {\r\n\r\n\t\treturn string !== '';\r\n\r\n\t}\r\n\r\n\treturn function WebGLProgram( renderer, code, material, parameters ) {\r\n\r\n\t\tvar gl = renderer.context;\r\n\r\n\t\tvar defines = material.defines;\r\n\r\n\t\tvar vertexShader = material.__webglShader.vertexShader;\r\n\t\tvar fragmentShader = material.__webglShader.fragmentShader;\r\n\r\n\t\tvar shadowMapTypeDefine = 'SHADOWMAP_TYPE_BASIC';\r\n\r\n\t\tif ( parameters.shadowMapType === THREE.PCFShadowMap ) {\r\n\r\n\t\t\tshadowMapTypeDefine = 'SHADOWMAP_TYPE_PCF';\r\n\r\n\t\t} else if ( parameters.shadowMapType === THREE.PCFSoftShadowMap ) {\r\n\r\n\t\t\tshadowMapTypeDefine = 'SHADOWMAP_TYPE_PCF_SOFT';\r\n\r\n\t\t}\r\n\r\n\t\tvar envMapTypeDefine = 'ENVMAP_TYPE_CUBE';\r\n\t\tvar envMapModeDefine = 'ENVMAP_MODE_REFLECTION';\r\n\t\tvar envMapBlendingDefine = 'ENVMAP_BLENDING_MULTIPLY';\r\n\r\n\t\tif ( parameters.envMap ) {\r\n\r\n\t\t\tswitch ( material.envMap.mapping ) {\r\n\r\n\t\t\t\tcase THREE.CubeReflectionMapping:\r\n\t\t\t\tcase THREE.CubeRefractionMapping:\r\n\t\t\t\t\tenvMapTypeDefine = 'ENVMAP_TYPE_CUBE';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase THREE.EquirectangularReflectionMapping:\r\n\t\t\t\tcase THREE.EquirectangularRefractionMapping:\r\n\t\t\t\t\tenvMapTypeDefine = 'ENVMAP_TYPE_EQUIREC';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase THREE.SphericalReflectionMapping:\r\n\t\t\t\t\tenvMapTypeDefine = 'ENVMAP_TYPE_SPHERE';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tswitch ( material.envMap.mapping ) {\r\n\r\n\t\t\t\tcase THREE.CubeRefractionMapping:\r\n\t\t\t\tcase THREE.EquirectangularRefractionMapping:\r\n\t\t\t\t\tenvMapModeDefine = 'ENVMAP_MODE_REFRACTION';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tswitch ( material.combine ) {\r\n\r\n\t\t\t\tcase THREE.MultiplyOperation:\r\n\t\t\t\t\tenvMapBlendingDefine = 'ENVMAP_BLENDING_MULTIPLY';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase THREE.MixOperation:\r\n\t\t\t\t\tenvMapBlendingDefine = 'ENVMAP_BLENDING_MIX';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase THREE.AddOperation:\r\n\t\t\t\t\tenvMapBlendingDefine = 'ENVMAP_BLENDING_ADD';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar gammaFactorDefine = ( renderer.gammaFactor > 0 ) ? renderer.gammaFactor : 1.0;\r\n\r\n\t\t// console.log( 'building new program ' );\r\n\r\n\t\t//\r\n\r\n\t\tvar customDefines = generateDefines( defines );\r\n\r\n\t\t//\r\n\r\n\t\tvar program = gl.createProgram();\r\n\r\n\t\tvar prefixVertex, prefixFragment;\r\n\r\n\t\tif ( material instanceof THREE.RawShaderMaterial ) {\r\n\r\n\t\t\tprefixVertex = '';\r\n\t\t\tprefixFragment = '';\r\n\r\n\t\t} else {\r\n\r\n\t\t\tprefixVertex = [\r\n\r\n\t\t\t\t'precision ' + parameters.precision + ' float;',\r\n\t\t\t\t'precision ' + parameters.precision + ' int;',\r\n\r\n\t\t\t\t'#define SHADER_NAME ' + material.__webglShader.name,\r\n\r\n\t\t\t\tcustomDefines,\r\n\r\n\t\t\t\tparameters.supportsVertexTextures ? '#define VERTEX_TEXTURES' : '',\r\n\r\n\t\t\t\trenderer.gammaInput ? '#define GAMMA_INPUT' : '',\r\n\t\t\t\trenderer.gammaOutput ? '#define GAMMA_OUTPUT' : '',\r\n\t\t\t\t'#define GAMMA_FACTOR ' + gammaFactorDefine,\r\n\r\n\t\t\t\t'#define MAX_DIR_LIGHTS ' + parameters.maxDirLights,\r\n\t\t\t\t'#define MAX_POINT_LIGHTS ' + parameters.maxPointLights,\r\n\t\t\t\t'#define MAX_SPOT_LIGHTS ' + parameters.maxSpotLights,\r\n\t\t\t\t'#define MAX_HEMI_LIGHTS ' + parameters.maxHemiLights,\r\n\r\n\t\t\t\t'#define MAX_SHADOWS ' + parameters.maxShadows,\r\n\r\n\t\t\t\t'#define MAX_BONES ' + parameters.maxBones,\r\n\r\n\t\t\t\tparameters.map ? '#define USE_MAP' : '',\r\n\t\t\t\tparameters.envMap ? '#define USE_ENVMAP' : '',\r\n\t\t\t\tparameters.envMap ? '#define ' + envMapModeDefine : '',\r\n\t\t\t\tparameters.lightMap ? '#define USE_LIGHTMAP' : '',\r\n\t\t\t\tparameters.aoMap ? '#define USE_AOMAP' : '',\r\n\t\t\t\tparameters.emissiveMap ? '#define USE_EMISSIVEMAP' : '',\r\n\t\t\t\tparameters.bumpMap ? '#define USE_BUMPMAP' : '',\r\n\t\t\t\tparameters.normalMap ? '#define USE_NORMALMAP' : '',\r\n\t\t\t\tparameters.displacementMap && parameters.supportsVertexTextures ? '#define USE_DISPLACEMENTMAP' : '',\r\n\t\t\t\tparameters.specularMap ? '#define USE_SPECULARMAP' : '',\r\n\t\t\t\tparameters.alphaMap ? '#define USE_ALPHAMAP' : '',\r\n\t\t\t\tparameters.vertexColors ? '#define USE_COLOR' : '',\r\n\r\n\t\t\t\tparameters.flatShading ? '#define FLAT_SHADED' : '',\r\n\r\n\t\t\t\tparameters.skinning ? '#define USE_SKINNING' : '',\r\n\t\t\t\tparameters.useVertexTexture ? '#define BONE_TEXTURE' : '',\r\n\r\n\t\t\t\tparameters.morphTargets ? '#define USE_MORPHTARGETS' : '',\r\n\t\t\t\tparameters.morphNormals && parameters.flatShading === false ? '#define USE_MORPHNORMALS' : '',\r\n\t\t\t\tparameters.doubleSided ? '#define DOUBLE_SIDED' : '',\r\n\t\t\t\tparameters.flipSided ? '#define FLIP_SIDED' : '',\r\n\r\n\t\t\t\tparameters.shadowMapEnabled ? '#define USE_SHADOWMAP' : '',\r\n\t\t\t\tparameters.shadowMapEnabled ? '#define ' + shadowMapTypeDefine : '',\r\n\t\t\t\tparameters.shadowMapDebug ? '#define SHADOWMAP_DEBUG' : '',\r\n\t\t\t\tparameters.pointLightShadows > 0 ? '#define POINT_LIGHT_SHADOWS' : '',\r\n\r\n\t\t\t\tparameters.sizeAttenuation ? '#define USE_SIZEATTENUATION' : '',\r\n\r\n\t\t\t\tparameters.logarithmicDepthBuffer ? '#define USE_LOGDEPTHBUF' : '',\r\n\t\t\t\tparameters.logarithmicDepthBuffer && renderer.extensions.get( 'EXT_frag_depth' ) ? '#define USE_LOGDEPTHBUF_EXT' : '',\r\n\r\n\r\n\t\t\t\t'uniform mat4 modelMatrix;',\r\n\t\t\t\t'uniform mat4 modelViewMatrix;',\r\n\t\t\t\t'uniform mat4 projectionMatrix;',\r\n\t\t\t\t'uniform mat4 viewMatrix;',\r\n\t\t\t\t'uniform mat3 normalMatrix;',\r\n\t\t\t\t'uniform vec3 cameraPosition;',\r\n\r\n\t\t\t\t'attribute vec3 position;',\r\n\t\t\t\t'attribute vec3 normal;',\r\n\t\t\t\t'attribute vec2 uv;',\r\n\r\n\t\t\t\t'#ifdef USE_COLOR',\r\n\r\n\t\t\t\t'\tattribute vec3 color;',\r\n\r\n\t\t\t\t'#endif',\r\n\r\n\t\t\t\t'#ifdef USE_MORPHTARGETS',\r\n\r\n\t\t\t\t'\tattribute vec3 morphTarget0;',\r\n\t\t\t\t'\tattribute vec3 morphTarget1;',\r\n\t\t\t\t'\tattribute vec3 morphTarget2;',\r\n\t\t\t\t'\tattribute vec3 morphTarget3;',\r\n\r\n\t\t\t\t'\t#ifdef USE_MORPHNORMALS',\r\n\r\n\t\t\t\t'\t\tattribute vec3 morphNormal0;',\r\n\t\t\t\t'\t\tattribute vec3 morphNormal1;',\r\n\t\t\t\t'\t\tattribute vec3 morphNormal2;',\r\n\t\t\t\t'\t\tattribute vec3 morphNormal3;',\r\n\r\n\t\t\t\t'\t#else',\r\n\r\n\t\t\t\t'\t\tattribute vec3 morphTarget4;',\r\n\t\t\t\t'\t\tattribute vec3 morphTarget5;',\r\n\t\t\t\t'\t\tattribute vec3 morphTarget6;',\r\n\t\t\t\t'\t\tattribute vec3 morphTarget7;',\r\n\r\n\t\t\t\t'\t#endif',\r\n\r\n\t\t\t\t'#endif',\r\n\r\n\t\t\t\t'#ifdef USE_SKINNING',\r\n\r\n\t\t\t\t'\tattribute vec4 skinIndex;',\r\n\t\t\t\t'\tattribute vec4 skinWeight;',\r\n\r\n\t\t\t\t'#endif',\r\n\r\n\t\t\t\t'\\n'\r\n\r\n\t\t\t].filter( filterEmptyLine ).join( '\\n' );\r\n\r\n\t\t\tprefixFragment = [\r\n\r\n\t\t\t\tparameters.bumpMap || parameters.normalMap || parameters.flatShading || material.derivatives ? '#extension GL_OES_standard_derivatives : enable' : '',\r\n\t\t\t\tparameters.logarithmicDepthBuffer && renderer.extensions.get( 'EXT_frag_depth' ) ? '#extension GL_EXT_frag_depth : enable' : '',\r\n\r\n\t\t\t\t'precision ' + parameters.precision + ' float;',\r\n\t\t\t\t'precision ' + parameters.precision + ' int;',\r\n\r\n\t\t\t\t'#define SHADER_NAME ' + material.__webglShader.name,\r\n\r\n\t\t\t\tcustomDefines,\r\n\r\n\t\t\t\t'#define MAX_DIR_LIGHTS ' + parameters.maxDirLights,\r\n\t\t\t\t'#define MAX_POINT_LIGHTS ' + parameters.maxPointLights,\r\n\t\t\t\t'#define MAX_SPOT_LIGHTS ' + parameters.maxSpotLights,\r\n\t\t\t\t'#define MAX_HEMI_LIGHTS ' + parameters.maxHemiLights,\r\n\r\n\t\t\t\t'#define MAX_SHADOWS ' + parameters.maxShadows,\r\n\r\n\t\t\t\tparameters.alphaTest ? '#define ALPHATEST ' + parameters.alphaTest : '',\r\n\r\n\t\t\t\trenderer.gammaInput ? '#define GAMMA_INPUT' : '',\r\n\t\t\t\trenderer.gammaOutput ? '#define GAMMA_OUTPUT' : '',\r\n\t\t\t\t'#define GAMMA_FACTOR ' + gammaFactorDefine,\r\n\r\n\t\t\t\t( parameters.useFog && parameters.fog ) ? '#define USE_FOG' : '',\r\n\t\t\t\t( parameters.useFog && parameters.fogExp ) ? '#define FOG_EXP2' : '',\r\n\r\n\t\t\t\tparameters.map ? '#define USE_MAP' : '',\r\n\t\t\t\tparameters.envMap ? '#define USE_ENVMAP' : '',\r\n\t\t\t\tparameters.envMap ? '#define ' + envMapTypeDefine : '',\r\n\t\t\t\tparameters.envMap ? '#define ' + envMapModeDefine : '',\r\n\t\t\t\tparameters.envMap ? '#define ' + envMapBlendingDefine : '',\r\n\t\t\t\tparameters.lightMap ? '#define USE_LIGHTMAP' : '',\r\n\t\t\t\tparameters.aoMap ? '#define USE_AOMAP' : '',\r\n\t\t\t\tparameters.emissiveMap ? '#define USE_EMISSIVEMAP' : '',\r\n\t\t\t\tparameters.bumpMap ? '#define USE_BUMPMAP' : '',\r\n\t\t\t\tparameters.normalMap ? '#define USE_NORMALMAP' : '',\r\n\t\t\t\tparameters.specularMap ? '#define USE_SPECULARMAP' : '',\r\n\t\t\t\tparameters.alphaMap ? '#define USE_ALPHAMAP' : '',\r\n\t\t\t\tparameters.vertexColors ? '#define USE_COLOR' : '',\r\n\r\n\t\t\t\tparameters.flatShading ? '#define FLAT_SHADED' : '',\r\n\r\n\t\t\t\tparameters.metal ? '#define METAL' : '',\r\n\t\t\t\tparameters.doubleSided ? '#define DOUBLE_SIDED' : '',\r\n\t\t\t\tparameters.flipSided ? '#define FLIP_SIDED' : '',\r\n\r\n\t\t\t\tparameters.shadowMapEnabled ? '#define USE_SHADOWMAP' : '',\r\n\t\t\t\tparameters.shadowMapEnabled ? '#define ' + shadowMapTypeDefine : '',\r\n\t\t\t\tparameters.shadowMapDebug ? '#define SHADOWMAP_DEBUG' : '',\r\n\t\t\t\tparameters.pointLightShadows > 0 ? '#define POINT_LIGHT_SHADOWS' : '',\r\n\r\n\t\t\t\tparameters.logarithmicDepthBuffer ? '#define USE_LOGDEPTHBUF' : '',\r\n\t\t\t\tparameters.logarithmicDepthBuffer && renderer.extensions.get( 'EXT_frag_depth' ) ? '#define USE_LOGDEPTHBUF_EXT' : '',\r\n\r\n\t\t\t\t'uniform mat4 viewMatrix;',\r\n\t\t\t\t'uniform vec3 cameraPosition;',\r\n\r\n\t\t\t\t'\\n'\r\n\r\n\t\t\t].filter( filterEmptyLine ).join( '\\n' );\r\n\r\n\t\t}\r\n\r\n\t\tvar vertexGlsl = prefixVertex + vertexShader;\r\n\t\tvar fragmentGlsl = prefixFragment + fragmentShader;\r\n\r\n\t\tvar glVertexShader = THREE.WebGLShader( gl, gl.VERTEX_SHADER, vertexGlsl );\r\n\t\tvar glFragmentShader = THREE.WebGLShader( gl, gl.FRAGMENT_SHADER, fragmentGlsl );\r\n\r\n\t\tgl.attachShader( program, glVertexShader );\r\n\t\tgl.attachShader( program, glFragmentShader );\r\n\r\n\t\t// Force a particular attribute to index 0.\r\n\r\n\t\tif ( material.index0AttributeName !== undefined ) {\r\n\r\n\t\t\tgl.bindAttribLocation( program, 0, material.index0AttributeName );\r\n\r\n\t\t} else if ( parameters.morphTargets === true ) {\r\n\r\n\t\t\t// programs with morphTargets displace position out of attribute 0\r\n\t\t\tgl.bindAttribLocation( program, 0, 'position' );\r\n\r\n\t\t}\r\n\r\n\t\tgl.linkProgram( program );\r\n\r\n\t\tvar programLog = gl.getProgramInfoLog( program );\r\n\t\tvar vertexLog = gl.getShaderInfoLog( glVertexShader );\r\n\t\tvar fragmentLog = gl.getShaderInfoLog( glFragmentShader );\r\n\r\n\t\tvar runnable = true;\r\n\t\tvar haveDiagnostics = true;\r\n\r\n\t\tif ( gl.getProgramParameter( program, gl.LINK_STATUS ) === false ) {\r\n\r\n\t\t\trunnable = false;\r\n\r\n\t\t\tconsole.error( 'THREE.WebGLProgram: shader error: ', gl.getError(), 'gl.VALIDATE_STATUS', gl.getProgramParameter( program, gl.VALIDATE_STATUS ), 'gl.getProgramInfoLog', programLog, vertexLog, fragmentLog );\r\n\r\n\t\t} else if ( programLog !== '' ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLProgram: gl.getProgramInfoLog()', programLog );\r\n\r\n\t\t} else if ( vertexLog === '' || fragmentLog === '' ) {\r\n\r\n\t\t\thaveDiagnostics = false;\r\n\r\n\t\t}\r\n\r\n\t\tif ( haveDiagnostics ) {\r\n\r\n\t\t\tthis.diagnostics = {\r\n\r\n\t\t\t\trunnable: runnable,\r\n\t\t\t\tmaterial: material,\r\n\r\n\t\t\t\tprogramLog: programLog,\r\n\r\n\t\t\t\tvertexShader: {\r\n\r\n\t\t\t\t\tlog: vertexLog,\r\n\t\t\t\t\tprefix: prefixVertex\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tfragmentShader: {\r\n\r\n\t\t\t\t\tlog: fragmentLog,\r\n\t\t\t\t\tprefix: prefixFragment\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t\t// clean up\r\n\r\n\t\tgl.deleteShader( glVertexShader );\r\n\t\tgl.deleteShader( glFragmentShader );\r\n\r\n\t\t// set up caching for uniform locations\r\n\r\n\t\tvar cachedUniforms;\r\n\r\n\t\tthis.getUniforms = function() {\r\n\r\n\t\t\tif ( cachedUniforms === undefined ) {\r\n\r\n\t\t\t\tcachedUniforms = fetchUniformLocations( gl, program );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn cachedUniforms;\r\n\r\n\t\t};\r\n\r\n\t\t// set up caching for attribute locations\r\n\r\n\t\tvar cachedAttributes;\r\n\r\n\t\tthis.getAttributes = function() {\r\n\r\n\t\t\tif ( cachedAttributes === undefined ) {\r\n\r\n\t\t\t\tcachedAttributes = fetchAttributeLocations( gl, program );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn cachedAttributes;\r\n\r\n\t\t};\r\n\r\n\t\t// free resource\r\n\r\n\t\tthis.destroy = function() {\r\n\r\n\t\t\tgl.deleteProgram( program );\r\n\t\t\tthis.program = undefined;\r\n\r\n\t\t};\r\n\r\n\t\t// DEPRECATED\r\n\r\n\t\tObject.defineProperties( this, {\r\n\r\n\t\t\tuniforms: {\r\n\t\t\t\tget: function() {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.WebGLProgram: .uniforms is now .getUniforms().' );\r\n\t\t\t\t\treturn this.getUniforms();\r\n\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tattributes: {\r\n\t\t\t\tget: function() {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.WebGLProgram: .attributes is now .getAttributes().' );\r\n\t\t\t\t\treturn this.getAttributes();\r\n\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t} );\r\n\r\n\r\n\t\t//\r\n\r\n\t\tthis.id = programIdCount ++;\r\n\t\tthis.code = code;\r\n\t\tthis.usedTimes = 1;\r\n\t\tthis.program = program;\r\n\t\tthis.vertexShader = glVertexShader;\r\n\t\tthis.fragmentShader = glFragmentShader;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n} )();\r\n\r\n// File:src/renderers/webgl/WebGLPrograms.js\r\n\r\nTHREE.WebGLPrograms = function ( renderer, capabilities ) {\r\n\r\n\tvar programs = [];\r\n\r\n\tvar shaderIDs = {\r\n\t\tMeshDepthMaterial: 'depth',\r\n\t\tMeshNormalMaterial: 'normal',\r\n\t\tMeshBasicMaterial: 'basic',\r\n\t\tMeshLambertMaterial: 'lambert',\r\n\t\tMeshPhongMaterial: 'phong',\r\n\t\tLineBasicMaterial: 'basic',\r\n\t\tLineDashedMaterial: 'dashed',\r\n\t\tPointsMaterial: 'points'\r\n\t};\r\n\r\n\tvar parameterNames = [\r\n\t\t\"precision\", \"supportsVertexTextures\", \"map\", \"envMap\", \"envMapMode\",\r\n\t\t\"lightMap\", \"aoMap\", \"emissiveMap\", \"bumpMap\", \"normalMap\", \"displacementMap\", \"specularMap\",\r\n\t\t\"alphaMap\", \"combine\", \"vertexColors\", \"fog\", \"useFog\", \"fogExp\",\r\n\t\t\"flatShading\", \"sizeAttenuation\", \"logarithmicDepthBuffer\", \"skinning\",\r\n\t\t\"maxBones\", \"useVertexTexture\", \"morphTargets\", \"morphNormals\",\r\n\t\t\"maxMorphTargets\", \"maxMorphNormals\", \"maxDirLights\", \"maxPointLights\",\r\n\t\t\"maxSpotLights\", \"maxHemiLights\", \"maxShadows\", \"shadowMapEnabled\", \"pointLightShadows\",\r\n\t\t\"shadowMapType\", \"shadowMapDebug\", \"alphaTest\", \"metal\", \"doubleSided\",\r\n\t\t\"flipSided\"\r\n\t];\r\n\r\n\r\n\tfunction allocateBones ( object ) {\r\n\r\n\t\tif ( capabilities.floatVertexTextures && object && object.skeleton && object.skeleton.useVertexTexture ) {\r\n\r\n\t\t\treturn 1024;\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// default for when object is not specified\r\n\t\t\t// ( for example when prebuilding shader to be used with multiple objects )\r\n\t\t\t//\r\n\t\t\t//  - leave some extra space for other uniforms\r\n\t\t\t//  - limit here is ANGLE's 254 max uniform vectors\r\n\t\t\t//    (up to 54 should be safe)\r\n\r\n\t\t\tvar nVertexUniforms = capabilities.maxVertexUniforms;\r\n\t\t\tvar nVertexMatrices = Math.floor( ( nVertexUniforms - 20 ) / 4 );\r\n\r\n\t\t\tvar maxBones = nVertexMatrices;\r\n\r\n\t\t\tif ( object !== undefined && object instanceof THREE.SkinnedMesh ) {\r\n\r\n\t\t\t\tmaxBones = Math.min( object.skeleton.bones.length, maxBones );\r\n\r\n\t\t\t\tif ( maxBones < object.skeleton.bones.length ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'WebGLRenderer: too many bones - ' + object.skeleton.bones.length + ', this GPU supports just ' + maxBones + ' (try OpenGL instead of ANGLE)' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn maxBones;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction allocateLights( lights ) {\r\n\r\n\t\tvar dirLights = 0;\r\n\t\tvar pointLights = 0;\r\n\t\tvar spotLights = 0;\r\n\t\tvar hemiLights = 0;\r\n\r\n\t\tfor ( var l = 0, ll = lights.length; l < ll; l ++ ) {\r\n\r\n\t\t\tvar light = lights[ l ];\r\n\r\n\t\t\tif ( light.visible === false ) continue;\r\n\r\n\t\t\tif ( light instanceof THREE.DirectionalLight ) dirLights ++;\r\n\t\t\tif ( light instanceof THREE.PointLight ) pointLights ++;\r\n\t\t\tif ( light instanceof THREE.SpotLight ) spotLights ++;\r\n\t\t\tif ( light instanceof THREE.HemisphereLight ) hemiLights ++;\r\n\r\n\t\t}\r\n\r\n\t\treturn { 'directional': dirLights, 'point': pointLights, 'spot': spotLights, 'hemi': hemiLights };\r\n\r\n\t}\r\n\r\n\tfunction allocateShadows( lights ) {\r\n\r\n\t\tvar maxShadows = 0;\r\n\t\tvar pointLightShadows = 0;\r\n\r\n\t\tfor ( var l = 0, ll = lights.length; l < ll; l ++ ) {\r\n\r\n\t\t\tvar light = lights[ l ];\r\n\r\n\t\t\tif ( ! light.castShadow ) continue;\r\n\r\n\t\t\tif ( light instanceof THREE.SpotLight || light instanceof THREE.DirectionalLight ) maxShadows ++;\r\n\t\t\tif ( light instanceof THREE.PointLight ) {\r\n\r\n\t\t\t\tmaxShadows ++;\r\n\t\t\t\tpointLightShadows ++;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn { 'maxShadows': maxShadows, 'pointLightShadows': pointLightShadows };\r\n\r\n\t}\r\n\r\n\tthis.getParameters = function ( material, lights, fog, object ) {\r\n\r\n\t\tvar shaderID = shaderIDs[ material.type ];\r\n\t\t// heuristics to create shader parameters according to lights in the scene\r\n\t\t// (not to blow over maxLights budget)\r\n\r\n\t\tvar maxLightCount = allocateLights( lights );\r\n\t\tvar allocatedShadows = allocateShadows( lights );\r\n\t\tvar maxBones = allocateBones( object );\r\n\t\tvar precision = renderer.getPrecision();\r\n\r\n\t\tif ( material.precision !== null ) {\r\n\r\n\t\t\tprecision = capabilities.getMaxPrecision( material.precision );\r\n\r\n\t\t\tif ( precision !== material.precision ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer.initMaterial:', material.precision, 'not supported, using', precision, 'instead.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar parameters = {\r\n\r\n\t\t\tshaderID: shaderID,\r\n\r\n\t\t\tprecision: precision,\r\n\t\t\tsupportsVertexTextures: capabilities.vertexTextures,\r\n\r\n\t\t\tmap: !! material.map,\r\n\t\t\tenvMap: !! material.envMap,\r\n\t\t\tenvMapMode: material.envMap && material.envMap.mapping,\r\n\t\t\tlightMap: !! material.lightMap,\r\n\t\t\taoMap: !! material.aoMap,\r\n\t\t\temissiveMap: !! material.emissiveMap,\r\n\t\t\tbumpMap: !! material.bumpMap,\r\n\t\t\tnormalMap: !! material.normalMap,\r\n\t\t\tdisplacementMap: !! material.displacementMap,\r\n\t\t\tspecularMap: !! material.specularMap,\r\n\t\t\talphaMap: !! material.alphaMap,\r\n\r\n\t\t\tcombine: material.combine,\r\n\r\n\t\t\tvertexColors: material.vertexColors,\r\n\r\n\t\t\tfog: fog,\r\n\t\t\tuseFog: material.fog,\r\n\t\t\tfogExp: fog instanceof THREE.FogExp2,\r\n\r\n\t\t\tflatShading: material.shading === THREE.FlatShading,\r\n\r\n\t\t\tsizeAttenuation: material.sizeAttenuation,\r\n\t\t\tlogarithmicDepthBuffer: capabilities.logarithmicDepthBuffer,\r\n\r\n\t\t\tskinning: material.skinning,\r\n\t\t\tmaxBones: maxBones,\r\n\t\t\tuseVertexTexture: capabilities.floatVertexTextures && object && object.skeleton && object.skeleton.useVertexTexture,\r\n\r\n\t\t\tmorphTargets: material.morphTargets,\r\n\t\t\tmorphNormals: material.morphNormals,\r\n\t\t\tmaxMorphTargets: renderer.maxMorphTargets,\r\n\t\t\tmaxMorphNormals: renderer.maxMorphNormals,\r\n\r\n\t\t\tmaxDirLights: maxLightCount.directional,\r\n\t\t\tmaxPointLights: maxLightCount.point,\r\n\t\t\tmaxSpotLights: maxLightCount.spot,\r\n\t\t\tmaxHemiLights: maxLightCount.hemi,\r\n\r\n\t\t\tmaxShadows: allocatedShadows.maxShadows,\r\n\t\t\tpointLightShadows: allocatedShadows.pointLightShadows,\r\n\t\t\tshadowMapEnabled: renderer.shadowMap.enabled && object.receiveShadow && allocatedShadows.maxShadows > 0,\r\n\t\t\tshadowMapType: renderer.shadowMap.type,\r\n\t\t\tshadowMapDebug: renderer.shadowMap.debug,\r\n\r\n\t\t\talphaTest: material.alphaTest,\r\n\t\t\tmetal: material.metal,\r\n\t\t\tdoubleSided: material.side === THREE.DoubleSide,\r\n\t\t\tflipSided: material.side === THREE.BackSide\r\n\r\n\t\t};\r\n\r\n\t\treturn parameters;\r\n\r\n\t};\r\n\r\n\tthis.getProgramCode = function ( material, parameters ) {\r\n\r\n\t\tvar chunks = [];\r\n\r\n\t\tif ( parameters.shaderID ) {\r\n\r\n\t\t\tchunks.push( parameters.shaderID );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tchunks.push( material.fragmentShader );\r\n\t\t\tchunks.push( material.vertexShader );\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.defines !== undefined ) {\r\n\r\n\t\t\tfor ( var name in material.defines ) {\r\n\r\n\t\t\t\tchunks.push( name );\r\n\t\t\t\tchunks.push( material.defines[ name ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0; i < parameterNames.length; i ++ ) {\r\n\r\n\t\t\tvar parameterName = parameterNames[ i ];\r\n\t\t\tchunks.push( parameterName );\r\n\t\t\tchunks.push( parameters[ parameterName ] );\r\n\r\n\t\t}\r\n\r\n\t\treturn chunks.join();\r\n\r\n\t};\r\n\r\n\tthis.acquireProgram = function ( material, parameters, code ) {\r\n\r\n\t\tvar program;\r\n\r\n\t\t// Check if code has been already compiled\r\n\t\tfor ( var p = 0, pl = programs.length; p < pl; p ++ ) {\r\n\r\n\t\t\tvar programInfo = programs[ p ];\r\n\r\n\t\t\tif ( programInfo.code === code ) {\r\n\r\n\t\t\t\tprogram = programInfo;\r\n\t\t\t\t++ program.usedTimes;\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( program === undefined ) {\r\n\r\n\t\t\tprogram = new THREE.WebGLProgram( renderer, code, material, parameters );\r\n\t\t\tprograms.push( program );\r\n\r\n\t\t}\r\n\r\n\t\treturn program;\r\n\r\n\t};\r\n\r\n\tthis.releaseProgram = function( program ) {\r\n\r\n\t\tif ( -- program.usedTimes === 0 ) {\r\n\r\n\t\t\t// Remove from unordered set\r\n\t\t\tvar i = programs.indexOf( program );\r\n\t\t\tprograms[ i ] = programs[ programs.length - 1 ];\r\n\t\t\tprograms.pop();\r\n\r\n\t\t\t// Free WebGL resources\r\n\t\t\tprogram.destroy();\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t// Exposed for resource monitoring & error feedback via renderer.info:\r\n\tthis.programs = programs;\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/WebGLProperties.js\r\n\r\n/**\r\n* @author fordacious / fordacious.github.io\r\n*/\r\n\r\nTHREE.WebGLProperties = function () {\r\n\r\n\tvar properties = {};\r\n\r\n\tthis.get = function ( object ) {\r\n\r\n\t\tvar uuid = object.uuid;\r\n\t\tvar map = properties[ uuid ];\r\n\r\n\t\tif ( map === undefined ) {\r\n\r\n\t\t\tmap = {};\r\n\t\t\tproperties[ uuid ] = map;\r\n\r\n\t\t}\r\n\r\n\t\treturn map;\r\n\r\n\t};\r\n\r\n\tthis.delete = function ( object ) {\r\n\r\n\t\tdelete properties[ object.uuid ];\r\n\r\n\t};\r\n\r\n\tthis.clear = function () {\r\n\r\n\t\tproperties = {};\r\n\r\n\t};\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/WebGLShader.js\r\n\r\nTHREE.WebGLShader = ( function () {\r\n\r\n\tfunction addLineNumbers( string ) {\r\n\r\n\t\tvar lines = string.split( '\\n' );\r\n\r\n\t\tfor ( var i = 0; i < lines.length; i ++ ) {\r\n\r\n\t\t\tlines[ i ] = ( i + 1 ) + ': ' + lines[ i ];\r\n\r\n\t\t}\r\n\r\n\t\treturn lines.join( '\\n' );\r\n\r\n\t}\r\n\r\n\treturn function WebGLShader( gl, type, string ) {\r\n\r\n\t\tvar shader = gl.createShader( type );\r\n\r\n\t\tgl.shaderSource( shader, string );\r\n\t\tgl.compileShader( shader );\r\n\r\n\t\tif ( gl.getShaderParameter( shader, gl.COMPILE_STATUS ) === false ) {\r\n\r\n\t\t\tconsole.error( 'THREE.WebGLShader: Shader couldn\\'t compile.' );\r\n\r\n\t\t}\r\n\r\n\t\tif ( gl.getShaderInfoLog( shader ) !== '' ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLShader: gl.getShaderInfoLog()', type === gl.VERTEX_SHADER ? 'vertex' : 'fragment', gl.getShaderInfoLog( shader ), addLineNumbers( string ) );\r\n\r\n\t\t}\r\n\r\n\t\t// --enable-privileged-webgl-extension\r\n\t\t// console.log( type, gl.getExtension( 'WEBGL_debug_shaders' ).getTranslatedShaderSource( shader ) );\r\n\r\n\t\treturn shader;\r\n\r\n\t};\r\n\r\n} )();\r\n\r\n// File:src/renderers/webgl/WebGLShadowMap.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.WebGLShadowMap = function ( _renderer, _lights, _objects ) {\r\n\r\n\tvar _gl = _renderer.context,\r\n\t_state = _renderer.state,\r\n\t_frustum = new THREE.Frustum(),\r\n\t_projScreenMatrix = new THREE.Matrix4(),\r\n\r\n\t_min = new THREE.Vector3(),\r\n\t_max = new THREE.Vector3(),\r\n\r\n\t_lookTarget = new THREE.Vector3(),\r\n\t_lightPositionWorld = new THREE.Vector3(),\r\n\r\n\t_renderList = [],\r\n\r\n\t_MorphingFlag = 1,\r\n\t_SkinningFlag = 2,\r\n\r\n\t_NumberOfMaterialVariants = ( _MorphingFlag | _SkinningFlag ) + 1,\r\n\r\n\t_depthMaterials = new Array( _NumberOfMaterialVariants ),\r\n\t_distanceMaterials = new Array( _NumberOfMaterialVariants );\r\n\r\n\tvar cubeDirections = [\r\n\t\tnew THREE.Vector3( 1, 0, 0 ), new THREE.Vector3( - 1, 0, 0 ), new THREE.Vector3( 0, 0, 1 ),\r\n\t\tnew THREE.Vector3( 0, 0, - 1 ), new THREE.Vector3( 0, 1, 0 ), new THREE.Vector3( 0, - 1, 0 )\r\n\t];\r\n\r\n\tvar cubeUps = [\r\n\t\tnew THREE.Vector3( 0, 1, 0 ), new THREE.Vector3( 0, 1, 0 ), new THREE.Vector3( 0, 1, 0 ),\r\n\t\tnew THREE.Vector3( 0, 1, 0 ), new THREE.Vector3( 0, 0, 1 ),\tnew THREE.Vector3( 0, 0, - 1 )\r\n\t];\r\n\r\n\tvar cube2DViewPorts = [\r\n\t\tnew THREE.Vector4(), new THREE.Vector4(), new THREE.Vector4(),\r\n\t\tnew THREE.Vector4(), new THREE.Vector4(), new THREE.Vector4()\r\n\t];\r\n\r\n\tvar _vector4 = new THREE.Vector4();\r\n\r\n\t// init\r\n\r\n\tvar depthShader = THREE.ShaderLib[ \"depthRGBA\" ];\r\n\tvar depthUniforms = THREE.UniformsUtils.clone( depthShader.uniforms );\r\n\r\n\tvar distanceShader = THREE.ShaderLib[ \"distanceRGBA\" ];\r\n\tvar distanceUniforms = THREE.UniformsUtils.clone( distanceShader.uniforms );\r\n\r\n\tfor ( var i = 0; i !== _NumberOfMaterialVariants; ++ i ) {\r\n\r\n\t\tvar useMorphing = ( i & _MorphingFlag ) !== 0;\r\n\t\tvar useSkinning = ( i & _SkinningFlag ) !== 0;\r\n\r\n\t\tvar depthMaterial = new THREE.ShaderMaterial( {\r\n\t\t\tuniforms: depthUniforms,\r\n\t\t\tvertexShader: depthShader.vertexShader,\r\n\t\t\tfragmentShader: depthShader.fragmentShader,\r\n\t\t\tmorphTargets: useMorphing,\r\n\t\t\tskinning: useSkinning\r\n\t\t} );\r\n\r\n\t\tdepthMaterial._shadowPass = true;\r\n\r\n\t\t_depthMaterials[ i ] = depthMaterial;\r\n\r\n\t\tvar distanceMaterial = new THREE.ShaderMaterial( {\r\n\t\t\tuniforms: distanceUniforms,\r\n\t\t\tvertexShader: distanceShader.vertexShader,\r\n\t\t\tfragmentShader: distanceShader.fragmentShader,\r\n\t\t\tmorphTargets: useMorphing,\r\n\t\t\tskinning: useSkinning\r\n\t\t} );\r\n\r\n\t\tdistanceMaterial._shadowPass = true;\r\n\r\n\t\t_distanceMaterials[ i ] = distanceMaterial;\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tvar scope = this;\r\n\r\n\tthis.enabled = false;\r\n\r\n\tthis.autoUpdate = true;\r\n\tthis.needsUpdate = false;\r\n\r\n\tthis.type = THREE.PCFShadowMap;\r\n\tthis.cullFace = THREE.CullFaceFront;\r\n\r\n\tthis.render = function ( scene ) {\r\n\r\n\t\tvar faceCount, isPointLight;\r\n\r\n\t\tif ( scope.enabled === false ) return;\r\n\t\tif ( scope.autoUpdate === false && scope.needsUpdate === false ) return;\r\n\r\n\t\t// Set GL state for depth map.\r\n\t\t_gl.clearColor( 1, 1, 1, 1 );\r\n\t\t_state.disable( _gl.BLEND );\r\n\t\t_state.enable( _gl.CULL_FACE );\r\n\t\t_gl.frontFace( _gl.CCW );\r\n\t\t_gl.cullFace( scope.cullFace === THREE.CullFaceFront ? _gl.FRONT : _gl.BACK );\r\n\t\t_state.setDepthTest( true );\r\n\r\n\t\t// save the existing viewport so it can be restored later\r\n\t\t_renderer.getViewport( _vector4 );\r\n\r\n\t\t// render depth map\r\n\r\n\t\tfor ( var i = 0, il = _lights.length; i < il; i ++ ) {\r\n\r\n\t\t\tvar light = _lights[ i ];\r\n\r\n\t\t\tif ( light.castShadow === true ) {\r\n\r\n\t\t\t\tvar shadow = light.shadow;\r\n\t\t\t\tvar shadowCamera = shadow.camera;\r\n\t\t\t\tvar shadowMapSize = shadow.mapSize;\r\n\r\n\t\t\t\tif ( light instanceof THREE.PointLight ) {\r\n\r\n\t\t\t\t\tfaceCount = 6;\r\n\t\t\t\t\tisPointLight = true;\r\n\r\n\t\t\t\t\tvar vpWidth = shadowMapSize.x / 4.0;\r\n\t\t\t\t\tvar vpHeight = shadowMapSize.y / 2.0;\r\n\r\n\t\t\t\t\t// These viewports map a cube-map onto a 2D texture with the\r\n\t\t\t\t\t// following orientation:\r\n\t\t\t\t\t//\r\n\t\t\t\t\t//  xzXZ\r\n\t\t\t\t\t//   y Y\r\n\t\t\t\t\t//\r\n\t\t\t\t\t// X - Positive x direction\r\n\t\t\t\t\t// x - Negative x direction\r\n\t\t\t\t\t// Y - Positive y direction\r\n\t\t\t\t\t// y - Negative y direction\r\n\t\t\t\t\t// Z - Positive z direction\r\n\t\t\t\t\t// z - Negative z direction\r\n\r\n\t\t\t\t\t// positive X\r\n\t\t\t\t\tcube2DViewPorts[ 0 ].set( vpWidth * 2, vpHeight, vpWidth, vpHeight );\r\n\t\t\t\t\t// negative X\r\n\t\t\t\t\tcube2DViewPorts[ 1 ].set( 0, vpHeight, vpWidth, vpHeight );\r\n\t\t\t\t\t// positive Z\r\n\t\t\t\t\tcube2DViewPorts[ 2 ].set( vpWidth * 3, vpHeight, vpWidth, vpHeight );\r\n\t\t\t\t\t// negative Z\r\n\t\t\t\t\tcube2DViewPorts[ 3 ].set( vpWidth, vpHeight, vpWidth, vpHeight );\r\n\t\t\t\t\t// positive Y\r\n\t\t\t\t\tcube2DViewPorts[ 4 ].set( vpWidth * 3, 0, vpWidth, vpHeight );\r\n\t\t\t\t\t// negative Y\r\n\t\t\t\t\tcube2DViewPorts[ 5 ].set( vpWidth, 0, vpWidth, vpHeight );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tfaceCount = 1;\r\n\t\t\t\t\tisPointLight = false;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( shadow.map === null ) {\r\n\r\n\t\t\t\t\tvar shadowFilter = THREE.LinearFilter;\r\n\r\n\t\t\t\t\tif ( scope.type === THREE.PCFSoftShadowMap ) {\r\n\r\n\t\t\t\t\t\tshadowFilter = THREE.NearestFilter;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar pars = { minFilter: shadowFilter, magFilter: shadowFilter, format: THREE.RGBAFormat };\r\n\r\n\t\t\t\t\tshadow.map = new THREE.WebGLRenderTarget( shadowMapSize.x, shadowMapSize.y, pars );\r\n\t\t\t\t\tshadow.matrix = new THREE.Matrix4();\r\n\r\n\t\t\t\t\t//\r\n\r\n\t\t\t\t\tif ( light instanceof THREE.SpotLight ) {\r\n\r\n\t\t\t\t\t\tshadowCamera.aspect = shadowMapSize.x / shadowMapSize.y;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tshadowCamera.updateProjectionMatrix();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar shadowMap = shadow.map;\r\n\t\t\t\tvar shadowMatrix = shadow.matrix;\r\n\r\n\t\t\t\t_lightPositionWorld.setFromMatrixPosition( light.matrixWorld );\r\n\t\t\t\tshadowCamera.position.copy( _lightPositionWorld );\r\n\r\n\t\t\t\t_renderer.setRenderTarget( shadowMap );\r\n\t\t\t\t_renderer.clear();\r\n\r\n\t\t\t\t// render shadow map for each cube face (if omni-directional) or\r\n\t\t\t\t// run a single pass if not\r\n\r\n\t\t\t\tfor ( var face = 0; face < faceCount; face ++ ) {\r\n\r\n\t\t\t\t\tif ( isPointLight ) {\r\n\r\n\t\t\t\t\t\t_lookTarget.copy( shadowCamera.position );\r\n\t\t\t\t\t\t_lookTarget.add( cubeDirections[ face ] );\r\n\t\t\t\t\t\tshadowCamera.up.copy( cubeUps[ face ] );\r\n\t\t\t\t\t\tshadowCamera.lookAt( _lookTarget );\r\n\t\t\t\t\t\tvar vpDimensions = cube2DViewPorts[ face ];\r\n\t\t\t\t\t\t_renderer.setViewport( vpDimensions.x, vpDimensions.y, vpDimensions.z, vpDimensions.w );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t_lookTarget.setFromMatrixPosition( light.target.matrixWorld );\r\n\t\t\t\t\t\tshadowCamera.lookAt( _lookTarget );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tshadowCamera.updateMatrixWorld();\r\n\t\t\t\t\tshadowCamera.matrixWorldInverse.getInverse( shadowCamera.matrixWorld );\r\n\r\n\t\t\t\t\t// compute shadow matrix\r\n\r\n\t\t\t\t\tshadowMatrix.set(\r\n\t\t\t\t\t\t0.5, 0.0, 0.0, 0.5,\r\n\t\t\t\t\t\t0.0, 0.5, 0.0, 0.5,\r\n\t\t\t\t\t\t0.0, 0.0, 0.5, 0.5,\r\n\t\t\t\t\t\t0.0, 0.0, 0.0, 1.0\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tshadowMatrix.multiply( shadowCamera.projectionMatrix );\r\n\t\t\t\t\tshadowMatrix.multiply( shadowCamera.matrixWorldInverse );\r\n\r\n\t\t\t\t\t// update camera matrices and frustum\r\n\r\n\t\t\t\t\t_projScreenMatrix.multiplyMatrices( shadowCamera.projectionMatrix, shadowCamera.matrixWorldInverse );\r\n\t\t\t\t\t_frustum.setFromMatrix( _projScreenMatrix );\r\n\r\n\t\t\t\t\t// set object matrices & frustum culling\r\n\r\n\t\t\t\t\t_renderList.length = 0;\r\n\r\n\t\t\t\t\tprojectObject( scene, shadowCamera );\r\n\r\n\t\t\t\t\t// render shadow map\r\n\t\t\t\t\t// render regular objects\r\n\r\n\t\t\t\t\tfor ( var j = 0, jl = _renderList.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\t\tvar object = _renderList[ j ];\r\n\t\t\t\t\t\tvar geometry = _objects.update( object );\r\n\t\t\t\t\t\tvar material = object.material;\r\n\r\n\t\t\t\t\t\tif ( material instanceof THREE.MeshFaceMaterial ) {\r\n\r\n\t\t\t\t\t\t\tvar groups = geometry.groups;\r\n\t\t\t\t\t\t\tvar materials = material.materials;\r\n\r\n\t\t\t\t\t\t\tfor ( var k = 0, kl = groups.length; k < kl; k ++ ) {\r\n\r\n\t\t\t\t\t\t\t\tvar group = groups[ k ];\r\n\t\t\t\t\t\t\t\tvar groupMaterial = materials[ group.materialIndex ];\r\n\r\n\t\t\t\t\t\t\t\tif ( groupMaterial.visible === true ) {\r\n\r\n\t\t\t\t\t\t\t\t\tvar depthMaterial = getDepthMaterial( object, groupMaterial, isPointLight, _lightPositionWorld );\r\n\t\t\t\t\t\t\t\t\t_renderer.renderBufferDirect( shadowCamera, _lights, null, geometry, depthMaterial, object, group );\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tvar depthMaterial = getDepthMaterial( object, material, isPointLight, _lightPositionWorld );\r\n\t\t\t\t\t\t\t_renderer.renderBufferDirect( shadowCamera, _lights, null, geometry, depthMaterial, object, null );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// We must call _renderer.resetGLState() at the end of each iteration of\r\n\t\t\t\t// the light loop in order to force material updates for each light.\r\n\t\t\t\t_renderer.resetGLState();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t_renderer.setViewport( _vector4.x, _vector4.y, _vector4.z, _vector4.w );\r\n\r\n\t\t// Restore GL state.\r\n\t\tvar clearColor = _renderer.getClearColor(),\r\n\t\tclearAlpha = _renderer.getClearAlpha();\r\n\t\t_renderer.setClearColor( clearColor, clearAlpha );\r\n\t\t_state.enable( _gl.BLEND );\r\n\r\n\t\tif ( scope.cullFace === THREE.CullFaceFront ) {\r\n\r\n\t\t\t_gl.cullFace( _gl.BACK );\r\n\r\n\t\t}\r\n\r\n\t\t_renderer.resetGLState();\r\n\r\n\t\tscope.needsUpdate = false;\r\n\r\n\t};\r\n\r\n\tfunction getDepthMaterial( object, material, isPointLight, lightPositionWorld ) {\r\n\r\n\t\tvar geometry = object.geometry;\r\n\r\n\t\tvar newMaterial = null;\r\n\r\n\t\tvar materialVariants = _depthMaterials;\r\n\t\tvar customMaterial = object.customDepthMaterial;\r\n\r\n\t\tif ( isPointLight ) {\r\n\r\n\t\t\tmaterialVariants = _distanceMaterials;\r\n\t\t\tcustomMaterial = object.customDistanceMaterial;\r\n\r\n\t\t}\r\n\r\n\t\tif ( ! customMaterial ) {\r\n\r\n\t\t\tvar useMorphing = geometry.morphTargets !== undefined &&\r\n\t\t\t\t\tgeometry.morphTargets.length > 0 && material.morphTargets;\r\n\r\n\t\t\tvar useSkinning = object instanceof THREE.SkinnedMesh && material.skinning;\r\n\r\n\t\t\tvar variantIndex = 0;\r\n\r\n\t\t\tif ( useMorphing ) variantIndex |= _MorphingFlag;\r\n\t\t\tif ( useSkinning ) variantIndex |= _SkinningFlag;\r\n\r\n\t\t\tnewMaterial = materialVariants[ variantIndex ];\r\n\r\n\t\t} else {\r\n\r\n\t\t\tnewMaterial = customMaterial;\r\n\r\n\t\t}\r\n\r\n\t\tnewMaterial.visible = material.visible;\r\n\t\tnewMaterial.wireframe = material.wireframe;\r\n\t\tnewMaterial.wireframeLinewidth = material.wireframeLinewidth;\r\n\r\n\t\tif ( isPointLight && newMaterial.uniforms.lightPos !== undefined ) {\r\n\r\n\t\t\tnewMaterial.uniforms.lightPos.value.copy( lightPositionWorld );\r\n\r\n\t\t}\r\n\r\n\t\treturn newMaterial;\r\n\r\n\t}\r\n\r\n\tfunction projectObject( object, camera ) {\r\n\r\n\t\tif ( object.visible === false ) return;\r\n\r\n\t\tif ( object instanceof THREE.Mesh || object instanceof THREE.Line || object instanceof THREE.Points ) {\r\n\r\n\t\t\tif ( object.castShadow && ( object.frustumCulled === false || _frustum.intersectsObject( object ) === true ) ) {\r\n\r\n\t\t\t\tvar material = object.material;\r\n\r\n\t\t\t\tif ( material.visible === true ) {\r\n\r\n\t\t\t\t\tobject.modelViewMatrix.multiplyMatrices( camera.matrixWorldInverse, object.matrixWorld );\r\n\t\t\t\t\t_renderList.push( object );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar children = object.children;\r\n\r\n\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\r\n\r\n\t\t\tprojectObject( children[ i ], camera );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/WebGLState.js\r\n\r\n/**\r\n* @author mrdoob / http://mrdoob.com/\r\n*/\r\n\r\nTHREE.WebGLState = function ( gl, extensions, paramThreeToGL ) {\r\n\r\n\tvar _this = this;\r\n\r\n\tvar newAttributes = new Uint8Array( 16 );\r\n\tvar enabledAttributes = new Uint8Array( 16 );\r\n\tvar attributeDivisors = new Uint8Array( 16 );\r\n\r\n\tvar capabilities = {};\r\n\r\n\tvar compressedTextureFormats = null;\r\n\r\n\tvar currentBlending = null;\r\n\tvar currentBlendEquation = null;\r\n\tvar currentBlendSrc = null;\r\n\tvar currentBlendDst = null;\r\n\tvar currentBlendEquationAlpha = null;\r\n\tvar currentBlendSrcAlpha = null;\r\n\tvar currentBlendDstAlpha = null;\r\n\r\n\tvar currentDepthFunc = null;\r\n\tvar currentDepthWrite = null;\r\n\r\n\tvar currentColorWrite = null;\r\n\r\n\tvar currentFlipSided = null;\r\n\r\n\tvar currentLineWidth = null;\r\n\r\n\tvar currentPolygonOffsetFactor = null;\r\n\tvar currentPolygonOffsetUnits = null;\r\n\r\n\tvar maxTextures = gl.getParameter( gl.MAX_TEXTURE_IMAGE_UNITS );\r\n\r\n\tvar currentTextureSlot = undefined;\r\n\tvar currentBoundTextures = {};\r\n\r\n\tthis.init = function () {\r\n\r\n\t\tgl.clearColor( 0, 0, 0, 1 );\r\n\t\tgl.clearDepth( 1 );\r\n\t\tgl.clearStencil( 0 );\r\n\r\n\t\tthis.enable( gl.DEPTH_TEST );\r\n\t\tgl.depthFunc( gl.LEQUAL );\r\n\r\n\t\tgl.frontFace( gl.CCW );\r\n\t\tgl.cullFace( gl.BACK );\r\n\t\tthis.enable( gl.CULL_FACE );\r\n\r\n\t\tthis.enable( gl.BLEND );\r\n\t\tgl.blendEquation( gl.FUNC_ADD );\r\n\t\tgl.blendFunc( gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA );\r\n\r\n\t};\r\n\r\n\tthis.initAttributes = function () {\r\n\r\n\t\tfor ( var i = 0, l = newAttributes.length; i < l; i ++ ) {\r\n\r\n\t\t\tnewAttributes[ i ] = 0;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.enableAttribute = function ( attribute ) {\r\n\r\n\t\tnewAttributes[ attribute ] = 1;\r\n\r\n\t\tif ( enabledAttributes[ attribute ] === 0 ) {\r\n\r\n\t\t\tgl.enableVertexAttribArray( attribute );\r\n\t\t\tenabledAttributes[ attribute ] = 1;\r\n\r\n\t\t}\r\n\r\n\t\tif ( attributeDivisors[ attribute ] !== 0 ) {\r\n\r\n\t\t\tvar extension = extensions.get( 'ANGLE_instanced_arrays' );\r\n\r\n\t\t\textension.vertexAttribDivisorANGLE( attribute, 0 );\r\n\t\t\tattributeDivisors[ attribute ] = 0;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.enableAttributeAndDivisor = function ( attribute, meshPerAttribute, extension ) {\r\n\r\n\t\tnewAttributes[ attribute ] = 1;\r\n\r\n\t\tif ( enabledAttributes[ attribute ] === 0 ) {\r\n\r\n\t\t\tgl.enableVertexAttribArray( attribute );\r\n\t\t\tenabledAttributes[ attribute ] = 1;\r\n\r\n\t\t}\r\n\r\n\t\tif ( attributeDivisors[ attribute ] !== meshPerAttribute ) {\r\n\r\n\t\t\textension.vertexAttribDivisorANGLE( attribute, meshPerAttribute );\r\n\t\t\tattributeDivisors[ attribute ] = meshPerAttribute;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.disableUnusedAttributes = function () {\r\n\r\n\t\tfor ( var i = 0, l = enabledAttributes.length; i < l; i ++ ) {\r\n\r\n\t\t\tif ( enabledAttributes[ i ] !== newAttributes[ i ] ) {\r\n\r\n\t\t\t\tgl.disableVertexAttribArray( i );\r\n\t\t\t\tenabledAttributes[ i ] = 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.enable = function ( id ) {\r\n\r\n\t\tif ( capabilities[ id ] !== true ) {\r\n\r\n\t\t\tgl.enable( id );\r\n\t\t\tcapabilities[ id ] = true;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.disable = function ( id ) {\r\n\r\n\t\tif ( capabilities[ id ] !== false ) {\r\n\r\n\t\t\tgl.disable( id );\r\n\t\t\tcapabilities[ id ] = false;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.getCompressedTextureFormats = function () {\r\n\r\n\t\tif ( compressedTextureFormats === null ) {\r\n\r\n\t\t\tcompressedTextureFormats = [];\r\n\r\n\t\t\tif ( extensions.get( 'WEBGL_compressed_texture_pvrtc' ) ||\r\n\t\t\t     extensions.get( 'WEBGL_compressed_texture_s3tc' ) ) {\r\n\r\n\t\t\t\tvar formats = gl.getParameter( gl.COMPRESSED_TEXTURE_FORMATS );\r\n\r\n\t\t\t\tfor ( var i = 0; i < formats.length; i ++ ) {\r\n\r\n\t\t\t\t\tcompressedTextureFormats.push( formats[ i ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn compressedTextureFormats;\r\n\r\n\t};\r\n\r\n\tthis.setBlending = function ( blending, blendEquation, blendSrc, blendDst, blendEquationAlpha, blendSrcAlpha, blendDstAlpha ) {\r\n\r\n\t\tif ( blending !== currentBlending ) {\r\n\r\n\t\t\tif ( blending === THREE.NoBlending ) {\r\n\r\n\t\t\t\tthis.disable( gl.BLEND );\r\n\r\n\t\t\t} else if ( blending === THREE.AdditiveBlending ) {\r\n\r\n\t\t\t\tthis.enable( gl.BLEND );\r\n\t\t\t\tgl.blendEquation( gl.FUNC_ADD );\r\n\t\t\t\tgl.blendFunc( gl.SRC_ALPHA, gl.ONE );\r\n\r\n\t\t\t} else if ( blending === THREE.SubtractiveBlending ) {\r\n\r\n\t\t\t\t// TODO: Find blendFuncSeparate() combination\r\n\r\n\t\t\t\tthis.enable( gl.BLEND );\r\n\t\t\t\tgl.blendEquation( gl.FUNC_ADD );\r\n\t\t\t\tgl.blendFunc( gl.ZERO, gl.ONE_MINUS_SRC_COLOR );\r\n\r\n\t\t\t} else if ( blending === THREE.MultiplyBlending ) {\r\n\r\n\t\t\t\t// TODO: Find blendFuncSeparate() combination\r\n\r\n\t\t\t\tthis.enable( gl.BLEND );\r\n\t\t\t\tgl.blendEquation( gl.FUNC_ADD );\r\n\t\t\t\tgl.blendFunc( gl.ZERO, gl.SRC_COLOR );\r\n\r\n\t\t\t} else if ( blending === THREE.CustomBlending ) {\r\n\r\n\t\t\t\tthis.enable( gl.BLEND );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.enable( gl.BLEND );\r\n\t\t\t\tgl.blendEquationSeparate( gl.FUNC_ADD, gl.FUNC_ADD );\r\n\t\t\t\tgl.blendFuncSeparate( gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcurrentBlending = blending;\r\n\r\n\t\t}\r\n\r\n\t\tif ( blending === THREE.CustomBlending ) {\r\n\r\n\t\t\tblendEquationAlpha = blendEquationAlpha || blendEquation;\r\n\t\t\tblendSrcAlpha = blendSrcAlpha || blendSrc;\r\n\t\t\tblendDstAlpha = blendDstAlpha || blendDst;\r\n\r\n\t\t\tif ( blendEquation !== currentBlendEquation || blendEquationAlpha !== currentBlendEquationAlpha ) {\r\n\r\n\t\t\t\tgl.blendEquationSeparate( paramThreeToGL( blendEquation ), paramThreeToGL( blendEquationAlpha ) );\r\n\r\n\t\t\t\tcurrentBlendEquation = blendEquation;\r\n\t\t\t\tcurrentBlendEquationAlpha = blendEquationAlpha;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( blendSrc !== currentBlendSrc || blendDst !== currentBlendDst || blendSrcAlpha !== currentBlendSrcAlpha || blendDstAlpha !== currentBlendDstAlpha ) {\r\n\r\n\t\t\t\tgl.blendFuncSeparate( paramThreeToGL( blendSrc ), paramThreeToGL( blendDst ), paramThreeToGL( blendSrcAlpha ), paramThreeToGL( blendDstAlpha ) );\r\n\r\n\t\t\t\tcurrentBlendSrc = blendSrc;\r\n\t\t\t\tcurrentBlendDst = blendDst;\r\n\t\t\t\tcurrentBlendSrcAlpha = blendSrcAlpha;\r\n\t\t\t\tcurrentBlendDstAlpha = blendDstAlpha;\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tcurrentBlendEquation = null;\r\n\t\t\tcurrentBlendSrc = null;\r\n\t\t\tcurrentBlendDst = null;\r\n\t\t\tcurrentBlendEquationAlpha = null;\r\n\t\t\tcurrentBlendSrcAlpha = null;\r\n\t\t\tcurrentBlendDstAlpha = null;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.setDepthFunc = function ( depthFunc ) {\r\n\r\n\t\tif ( currentDepthFunc !== depthFunc ) {\r\n\r\n\t\t\tif ( depthFunc ) {\r\n\r\n\t\t\t\tswitch ( depthFunc ) {\r\n\r\n\t\t\t\t\tcase THREE.NeverDepth:\r\n\r\n\t\t\t\t\t\tgl.depthFunc( gl.NEVER );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase THREE.AlwaysDepth:\r\n\r\n\t\t\t\t\t\tgl.depthFunc( gl.ALWAYS );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase THREE.LessDepth:\r\n\r\n\t\t\t\t\t\tgl.depthFunc( gl.LESS );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase THREE.LessEqualDepth:\r\n\r\n\t\t\t\t\t\tgl.depthFunc( gl.LEQUAL );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase THREE.EqualDepth:\r\n\r\n\t\t\t\t\t\tgl.depthFunc( gl.EQUAL );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase THREE.GreaterEqualDepth:\r\n\r\n\t\t\t\t\t\tgl.depthFunc( gl.GEQUAL );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase THREE.GreaterDepth:\r\n\r\n\t\t\t\t\t\tgl.depthFunc( gl.GREATER );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase THREE.NotEqualDepth:\r\n\r\n\t\t\t\t\t\tgl.depthFunc( gl.NOTEQUAL );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault:\r\n\r\n\t\t\t\t\t\tgl.depthFunc( gl.LEQUAL );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tgl.depthFunc( gl.LEQUAL );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcurrentDepthFunc = depthFunc;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.setDepthTest = function ( depthTest ) {\r\n\r\n\t\tif ( depthTest ) {\r\n\r\n\t\t\tthis.enable( gl.DEPTH_TEST );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.disable( gl.DEPTH_TEST );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.setDepthWrite = function ( depthWrite ) {\r\n\r\n\t\tif ( currentDepthWrite !== depthWrite ) {\r\n\r\n\t\t\tgl.depthMask( depthWrite );\r\n\t\t\tcurrentDepthWrite = depthWrite;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.setColorWrite = function ( colorWrite ) {\r\n\r\n\t\tif ( currentColorWrite !== colorWrite ) {\r\n\r\n\t\t\tgl.colorMask( colorWrite, colorWrite, colorWrite, colorWrite );\r\n\t\t\tcurrentColorWrite = colorWrite;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.setFlipSided = function ( flipSided ) {\r\n\r\n\t\tif ( currentFlipSided !== flipSided ) {\r\n\r\n\t\t\tif ( flipSided ) {\r\n\r\n\t\t\t\tgl.frontFace( gl.CW );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tgl.frontFace( gl.CCW );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcurrentFlipSided = flipSided;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.setLineWidth = function ( width ) {\r\n\r\n\t\tif ( width !== currentLineWidth ) {\r\n\r\n\t\t\tgl.lineWidth( width );\r\n\r\n\t\t\tcurrentLineWidth = width;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.setPolygonOffset = function ( polygonOffset, factor, units ) {\r\n\r\n\t\tif ( polygonOffset ) {\r\n\r\n\t\t\tthis.enable( gl.POLYGON_OFFSET_FILL );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.disable( gl.POLYGON_OFFSET_FILL );\r\n\r\n\t\t}\r\n\r\n\t\tif ( polygonOffset && ( currentPolygonOffsetFactor !== factor || currentPolygonOffsetUnits !== units ) ) {\r\n\r\n\t\t\tgl.polygonOffset( factor, units );\r\n\r\n\t\t\tcurrentPolygonOffsetFactor = factor;\r\n\t\t\tcurrentPolygonOffsetUnits = units;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.setScissorTest = function ( scissorTest ) {\r\n\r\n\t\tif ( scissorTest ) {\r\n\r\n\t\t\tthis.enable( gl.SCISSOR_TEST );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.disable( gl.SCISSOR_TEST );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t// texture\r\n\r\n\tthis.activeTexture = function ( webglSlot ) {\r\n\r\n\t\tif ( webglSlot === undefined ) webglSlot = gl.TEXTURE0 + maxTextures - 1;\r\n\r\n\t\tif ( currentTextureSlot !== webglSlot ) {\r\n\r\n\t\t\tgl.activeTexture( webglSlot );\r\n\t\t\tcurrentTextureSlot = webglSlot;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.bindTexture = function ( webglType, webglTexture ) {\r\n\r\n\t\tif ( currentTextureSlot === undefined ) {\r\n\r\n\t\t\t_this.activeTexture();\r\n\r\n\t\t}\r\n\r\n\t\tvar boundTexture = currentBoundTextures[ currentTextureSlot ];\r\n\r\n\t\tif ( boundTexture === undefined ) {\r\n\r\n\t\t\tboundTexture = { type: undefined, texture: undefined };\r\n\t\t\tcurrentBoundTextures[ currentTextureSlot ] = boundTexture;\r\n\r\n\t\t}\r\n\r\n\t\tif ( boundTexture.type !== webglType || boundTexture.texture !== webglTexture ) {\r\n\r\n\t\t\tgl.bindTexture( webglType, webglTexture );\r\n\r\n\t\t\tboundTexture.type = webglType;\r\n\t\t\tboundTexture.texture = webglTexture;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.compressedTexImage2D = function () {\r\n\r\n\t\ttry {\r\n\r\n\t\t\tgl.compressedTexImage2D.apply( gl, arguments );\r\n\r\n\t\t} catch ( error ) {\r\n\r\n\t\t\tconsole.error( error );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.texImage2D = function () {\r\n\r\n\t\ttry {\r\n\r\n\t\t\tgl.texImage2D.apply( gl, arguments );\r\n\r\n\t\t} catch ( error ) {\r\n\r\n\t\t\tconsole.error( error );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t//\r\n\r\n\tthis.reset = function () {\r\n\r\n\t\tfor ( var i = 0; i < enabledAttributes.length; i ++ ) {\r\n\r\n\t\t\tif ( enabledAttributes[ i ] === 1 ) {\r\n\r\n\t\t\t\tgl.disableVertexAttribArray( i );\r\n\t\t\t\tenabledAttributes[ i ] = 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tcapabilities = {};\r\n\r\n\t\tcompressedTextureFormats = null;\r\n\r\n\t\tcurrentBlending = null;\r\n\r\n\t\tcurrentDepthWrite = null;\r\n\t\tcurrentColorWrite = null;\r\n\r\n\t\tcurrentFlipSided = null;\r\n\r\n\t};\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/plugins/LensFlarePlugin.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.LensFlarePlugin = function ( renderer, flares ) {\r\n\r\n\tvar gl = renderer.context;\r\n\tvar state = renderer.state;\r\n\r\n\tvar vertexBuffer, elementBuffer;\r\n\tvar program, attributes, uniforms;\r\n\tvar hasVertexTexture;\r\n\r\n\tvar tempTexture, occlusionTexture;\r\n\r\n\tfunction init() {\r\n\r\n\t\tvar vertices = new Float32Array( [\r\n\t\t\t- 1, - 1,  0, 0,\r\n\t\t\t 1, - 1,  1, 0,\r\n\t\t\t 1,  1,  1, 1,\r\n\t\t\t- 1,  1,  0, 1\r\n\t\t] );\r\n\r\n\t\tvar faces = new Uint16Array( [\r\n\t\t\t0, 1, 2,\r\n\t\t\t0, 2, 3\r\n\t\t] );\r\n\r\n\t\t// buffers\r\n\r\n\t\tvertexBuffer     = gl.createBuffer();\r\n\t\telementBuffer    = gl.createBuffer();\r\n\r\n\t\tgl.bindBuffer( gl.ARRAY_BUFFER, vertexBuffer );\r\n\t\tgl.bufferData( gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW );\r\n\r\n\t\tgl.bindBuffer( gl.ELEMENT_ARRAY_BUFFER, elementBuffer );\r\n\t\tgl.bufferData( gl.ELEMENT_ARRAY_BUFFER, faces, gl.STATIC_DRAW );\r\n\r\n\t\t// textures\r\n\r\n\t\ttempTexture      = gl.createTexture();\r\n\t\tocclusionTexture = gl.createTexture();\r\n\r\n\t\tstate.bindTexture( gl.TEXTURE_2D, tempTexture );\r\n\t\tgl.texImage2D( gl.TEXTURE_2D, 0, gl.RGB, 16, 16, 0, gl.RGB, gl.UNSIGNED_BYTE, null );\r\n\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE );\r\n\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE );\r\n\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST );\r\n\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST );\r\n\r\n\t\tstate.bindTexture( gl.TEXTURE_2D, occlusionTexture );\r\n\t\tgl.texImage2D( gl.TEXTURE_2D, 0, gl.RGBA, 16, 16, 0, gl.RGBA, gl.UNSIGNED_BYTE, null );\r\n\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE );\r\n\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE );\r\n\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST );\r\n\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST );\r\n\r\n\t\thasVertexTexture = gl.getParameter( gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS ) > 0;\r\n\r\n\t\tvar shader;\r\n\r\n\t\tif ( hasVertexTexture ) {\r\n\r\n\t\t\tshader = {\r\n\r\n\t\t\t\tvertexShader: [\r\n\r\n\t\t\t\t\t\"uniform lowp int renderType;\",\r\n\r\n\t\t\t\t\t\"uniform vec3 screenPosition;\",\r\n\t\t\t\t\t\"uniform vec2 scale;\",\r\n\t\t\t\t\t\"uniform float rotation;\",\r\n\r\n\t\t\t\t\t\"uniform sampler2D occlusionMap;\",\r\n\r\n\t\t\t\t\t\"attribute vec2 position;\",\r\n\t\t\t\t\t\"attribute vec2 uv;\",\r\n\r\n\t\t\t\t\t\"varying vec2 vUV;\",\r\n\t\t\t\t\t\"varying float vVisibility;\",\r\n\r\n\t\t\t\t\t\"void main() {\",\r\n\r\n\t\t\t\t\t\t\"vUV = uv;\",\r\n\r\n\t\t\t\t\t\t\"vec2 pos = position;\",\r\n\r\n\t\t\t\t\t\t\"if ( renderType == 2 ) {\",\r\n\r\n\t\t\t\t\t\t\t\"vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );\",\r\n\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );\",\r\n\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );\",\r\n\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );\",\r\n\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );\",\r\n\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );\",\r\n\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );\",\r\n\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );\",\r\n\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );\",\r\n\r\n\t\t\t\t\t\t\t\"vVisibility =        visibility.r / 9.0;\",\r\n\t\t\t\t\t\t\t\"vVisibility *= 1.0 - visibility.g / 9.0;\",\r\n\t\t\t\t\t\t\t\"vVisibility *=       visibility.b / 9.0;\",\r\n\t\t\t\t\t\t\t\"vVisibility *= 1.0 - visibility.a / 9.0;\",\r\n\r\n\t\t\t\t\t\t\t\"pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\",\r\n\t\t\t\t\t\t\t\"pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\",\r\n\r\n\t\t\t\t\t\t\"}\",\r\n\r\n\t\t\t\t\t\t\"gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\",\r\n\r\n\t\t\t\t\t\"}\"\r\n\r\n\t\t\t\t].join( \"\\n\" ),\r\n\r\n\t\t\t\tfragmentShader: [\r\n\r\n\t\t\t\t\t\"uniform lowp int renderType;\",\r\n\r\n\t\t\t\t\t\"uniform sampler2D map;\",\r\n\t\t\t\t\t\"uniform float opacity;\",\r\n\t\t\t\t\t\"uniform vec3 color;\",\r\n\r\n\t\t\t\t\t\"varying vec2 vUV;\",\r\n\t\t\t\t\t\"varying float vVisibility;\",\r\n\r\n\t\t\t\t\t\"void main() {\",\r\n\r\n\t\t\t\t\t\t// pink square\r\n\r\n\t\t\t\t\t\t\"if ( renderType == 0 ) {\",\r\n\r\n\t\t\t\t\t\t\t\"gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\",\r\n\r\n\t\t\t\t\t\t// restore\r\n\r\n\t\t\t\t\t\t\"} else if ( renderType == 1 ) {\",\r\n\r\n\t\t\t\t\t\t\t\"gl_FragColor = texture2D( map, vUV );\",\r\n\r\n\t\t\t\t\t\t// flare\r\n\r\n\t\t\t\t\t\t\"} else {\",\r\n\r\n\t\t\t\t\t\t\t\"vec4 texture = texture2D( map, vUV );\",\r\n\t\t\t\t\t\t\t\"texture.a *= opacity * vVisibility;\",\r\n\t\t\t\t\t\t\t\"gl_FragColor = texture;\",\r\n\t\t\t\t\t\t\t\"gl_FragColor.rgb *= color;\",\r\n\r\n\t\t\t\t\t\t\"}\",\r\n\r\n\t\t\t\t\t\"}\"\r\n\r\n\t\t\t\t].join( \"\\n\" )\r\n\r\n\t\t\t};\r\n\r\n\t\t} else {\r\n\r\n\t\t\tshader = {\r\n\r\n\t\t\t\tvertexShader: [\r\n\r\n\t\t\t\t\t\"uniform lowp int renderType;\",\r\n\r\n\t\t\t\t\t\"uniform vec3 screenPosition;\",\r\n\t\t\t\t\t\"uniform vec2 scale;\",\r\n\t\t\t\t\t\"uniform float rotation;\",\r\n\r\n\t\t\t\t\t\"attribute vec2 position;\",\r\n\t\t\t\t\t\"attribute vec2 uv;\",\r\n\r\n\t\t\t\t\t\"varying vec2 vUV;\",\r\n\r\n\t\t\t\t\t\"void main() {\",\r\n\r\n\t\t\t\t\t\t\"vUV = uv;\",\r\n\r\n\t\t\t\t\t\t\"vec2 pos = position;\",\r\n\r\n\t\t\t\t\t\t\"if ( renderType == 2 ) {\",\r\n\r\n\t\t\t\t\t\t\t\"pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\",\r\n\t\t\t\t\t\t\t\"pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\",\r\n\r\n\t\t\t\t\t\t\"}\",\r\n\r\n\t\t\t\t\t\t\"gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\",\r\n\r\n\t\t\t\t\t\"}\"\r\n\r\n\t\t\t\t].join( \"\\n\" ),\r\n\r\n\t\t\t\tfragmentShader: [\r\n\r\n\t\t\t\t\t\"precision mediump float;\",\r\n\r\n\t\t\t\t\t\"uniform lowp int renderType;\",\r\n\r\n\t\t\t\t\t\"uniform sampler2D map;\",\r\n\t\t\t\t\t\"uniform sampler2D occlusionMap;\",\r\n\t\t\t\t\t\"uniform float opacity;\",\r\n\t\t\t\t\t\"uniform vec3 color;\",\r\n\r\n\t\t\t\t\t\"varying vec2 vUV;\",\r\n\r\n\t\t\t\t\t\"void main() {\",\r\n\r\n\t\t\t\t\t\t// pink square\r\n\r\n\t\t\t\t\t\t\"if ( renderType == 0 ) {\",\r\n\r\n\t\t\t\t\t\t\t\"gl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );\",\r\n\r\n\t\t\t\t\t\t// restore\r\n\r\n\t\t\t\t\t\t\"} else if ( renderType == 1 ) {\",\r\n\r\n\t\t\t\t\t\t\t\"gl_FragColor = texture2D( map, vUV );\",\r\n\r\n\t\t\t\t\t\t// flare\r\n\r\n\t\t\t\t\t\t\"} else {\",\r\n\r\n\t\t\t\t\t\t\t\"float visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a;\",\r\n\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a;\",\r\n\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a;\",\r\n\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;\",\r\n\t\t\t\t\t\t\t\"visibility = ( 1.0 - visibility / 4.0 );\",\r\n\r\n\t\t\t\t\t\t\t\"vec4 texture = texture2D( map, vUV );\",\r\n\t\t\t\t\t\t\t\"texture.a *= opacity * visibility;\",\r\n\t\t\t\t\t\t\t\"gl_FragColor = texture;\",\r\n\t\t\t\t\t\t\t\"gl_FragColor.rgb *= color;\",\r\n\r\n\t\t\t\t\t\t\"}\",\r\n\r\n\t\t\t\t\t\"}\"\r\n\r\n\t\t\t\t].join( \"\\n\" )\r\n\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t\tprogram = createProgram( shader );\r\n\r\n\t\tattributes = {\r\n\t\t\tvertex: gl.getAttribLocation ( program, \"position\" ),\r\n\t\t\tuv:     gl.getAttribLocation ( program, \"uv\" )\r\n\t\t};\r\n\r\n\t\tuniforms = {\r\n\t\t\trenderType:     gl.getUniformLocation( program, \"renderType\" ),\r\n\t\t\tmap:            gl.getUniformLocation( program, \"map\" ),\r\n\t\t\tocclusionMap:   gl.getUniformLocation( program, \"occlusionMap\" ),\r\n\t\t\topacity:        gl.getUniformLocation( program, \"opacity\" ),\r\n\t\t\tcolor:          gl.getUniformLocation( program, \"color\" ),\r\n\t\t\tscale:          gl.getUniformLocation( program, \"scale\" ),\r\n\t\t\trotation:       gl.getUniformLocation( program, \"rotation\" ),\r\n\t\t\tscreenPosition: gl.getUniformLocation( program, \"screenPosition\" )\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t/*\r\n\t * Render lens flares\r\n\t * Method: renders 16x16 0xff00ff-colored points scattered over the light source area,\r\n\t *         reads these back and calculates occlusion.\r\n\t */\r\n\r\n\tthis.render = function ( scene, camera, viewportWidth, viewportHeight ) {\r\n\r\n\t\tif ( flares.length === 0 ) return;\r\n\r\n\t\tvar tempPosition = new THREE.Vector3();\r\n\r\n\t\tvar invAspect = viewportHeight / viewportWidth,\r\n\t\t\thalfViewportWidth = viewportWidth * 0.5,\r\n\t\t\thalfViewportHeight = viewportHeight * 0.5;\r\n\r\n\t\tvar size = 16 / viewportHeight,\r\n\t\t\tscale = new THREE.Vector2( size * invAspect, size );\r\n\r\n\t\tvar screenPosition = new THREE.Vector3( 1, 1, 0 ),\r\n\t\t\tscreenPositionPixels = new THREE.Vector2( 1, 1 );\r\n\r\n\t\tif ( program === undefined ) {\r\n\r\n\t\t\tinit();\r\n\r\n\t\t}\r\n\r\n\t\tgl.useProgram( program );\r\n\r\n\t\tstate.initAttributes();\r\n\t\tstate.enableAttribute( attributes.vertex );\r\n\t\tstate.enableAttribute( attributes.uv );\r\n\t\tstate.disableUnusedAttributes();\r\n\r\n\t\t// loop through all lens flares to update their occlusion and positions\r\n\t\t// setup gl and common used attribs/uniforms\r\n\r\n\t\tgl.uniform1i( uniforms.occlusionMap, 0 );\r\n\t\tgl.uniform1i( uniforms.map, 1 );\r\n\r\n\t\tgl.bindBuffer( gl.ARRAY_BUFFER, vertexBuffer );\r\n\t\tgl.vertexAttribPointer( attributes.vertex, 2, gl.FLOAT, false, 2 * 8, 0 );\r\n\t\tgl.vertexAttribPointer( attributes.uv, 2, gl.FLOAT, false, 2 * 8, 8 );\r\n\r\n\t\tgl.bindBuffer( gl.ELEMENT_ARRAY_BUFFER, elementBuffer );\r\n\r\n\t\tstate.disable( gl.CULL_FACE );\r\n\t\tgl.depthMask( false );\r\n\r\n\t\tfor ( var i = 0, l = flares.length; i < l; i ++ ) {\r\n\r\n\t\t\tsize = 16 / viewportHeight;\r\n\t\t\tscale.set( size * invAspect, size );\r\n\r\n\t\t\t// calc object screen position\r\n\r\n\t\t\tvar flare = flares[ i ];\r\n\r\n\t\t\ttempPosition.set( flare.matrixWorld.elements[ 12 ], flare.matrixWorld.elements[ 13 ], flare.matrixWorld.elements[ 14 ] );\r\n\r\n\t\t\ttempPosition.applyMatrix4( camera.matrixWorldInverse );\r\n\t\t\ttempPosition.applyProjection( camera.projectionMatrix );\r\n\r\n\t\t\t// setup arrays for gl programs\r\n\r\n\t\t\tscreenPosition.copy( tempPosition );\r\n\r\n\t\t\tscreenPositionPixels.x = screenPosition.x * halfViewportWidth + halfViewportWidth;\r\n\t\t\tscreenPositionPixels.y = screenPosition.y * halfViewportHeight + halfViewportHeight;\r\n\r\n\t\t\t// screen cull\r\n\r\n\t\t\tif ( hasVertexTexture || (\r\n\t\t\t\tscreenPositionPixels.x > 0 &&\r\n\t\t\t\tscreenPositionPixels.x < viewportWidth &&\r\n\t\t\t\tscreenPositionPixels.y > 0 &&\r\n\t\t\t\tscreenPositionPixels.y < viewportHeight ) ) {\r\n\r\n\t\t\t\t// save current RGB to temp texture\r\n\r\n\t\t\t\tstate.activeTexture( gl.TEXTURE0 );\r\n\t\t\t\tstate.bindTexture( gl.TEXTURE_2D, null );\r\n\t\t\t\tstate.activeTexture( gl.TEXTURE1 );\r\n\t\t\t\tstate.bindTexture( gl.TEXTURE_2D, tempTexture );\r\n\t\t\t\tgl.copyTexImage2D( gl.TEXTURE_2D, 0, gl.RGB, screenPositionPixels.x - 8, screenPositionPixels.y - 8, 16, 16, 0 );\r\n\r\n\r\n\t\t\t\t// render pink quad\r\n\r\n\t\t\t\tgl.uniform1i( uniforms.renderType, 0 );\r\n\t\t\t\tgl.uniform2f( uniforms.scale, scale.x, scale.y );\r\n\t\t\t\tgl.uniform3f( uniforms.screenPosition, screenPosition.x, screenPosition.y, screenPosition.z );\r\n\r\n\t\t\t\tstate.disable( gl.BLEND );\r\n\t\t\t\tstate.enable( gl.DEPTH_TEST );\r\n\r\n\t\t\t\tgl.drawElements( gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0 );\r\n\r\n\r\n\t\t\t\t// copy result to occlusionMap\r\n\r\n\t\t\t\tstate.activeTexture( gl.TEXTURE0 );\r\n\t\t\t\tstate.bindTexture( gl.TEXTURE_2D, occlusionTexture );\r\n\t\t\t\tgl.copyTexImage2D( gl.TEXTURE_2D, 0, gl.RGBA, screenPositionPixels.x - 8, screenPositionPixels.y - 8, 16, 16, 0 );\r\n\r\n\r\n\t\t\t\t// restore graphics\r\n\r\n\t\t\t\tgl.uniform1i( uniforms.renderType, 1 );\r\n\t\t\t\tstate.disable( gl.DEPTH_TEST );\r\n\r\n\t\t\t\tstate.activeTexture( gl.TEXTURE1 );\r\n\t\t\t\tstate.bindTexture( gl.TEXTURE_2D, tempTexture );\r\n\t\t\t\tgl.drawElements( gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0 );\r\n\r\n\r\n\t\t\t\t// update object positions\r\n\r\n\t\t\t\tflare.positionScreen.copy( screenPosition );\r\n\r\n\t\t\t\tif ( flare.customUpdateCallback ) {\r\n\r\n\t\t\t\t\tflare.customUpdateCallback( flare );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tflare.updateLensFlares();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// render flares\r\n\r\n\t\t\t\tgl.uniform1i( uniforms.renderType, 2 );\r\n\t\t\t\tstate.enable( gl.BLEND );\r\n\r\n\t\t\t\tfor ( var j = 0, jl = flare.lensFlares.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\tvar sprite = flare.lensFlares[ j ];\r\n\r\n\t\t\t\t\tif ( sprite.opacity > 0.001 && sprite.scale > 0.001 ) {\r\n\r\n\t\t\t\t\t\tscreenPosition.x = sprite.x;\r\n\t\t\t\t\t\tscreenPosition.y = sprite.y;\r\n\t\t\t\t\t\tscreenPosition.z = sprite.z;\r\n\r\n\t\t\t\t\t\tsize = sprite.size * sprite.scale / viewportHeight;\r\n\r\n\t\t\t\t\t\tscale.x = size * invAspect;\r\n\t\t\t\t\t\tscale.y = size;\r\n\r\n\t\t\t\t\t\tgl.uniform3f( uniforms.screenPosition, screenPosition.x, screenPosition.y, screenPosition.z );\r\n\t\t\t\t\t\tgl.uniform2f( uniforms.scale, scale.x, scale.y );\r\n\t\t\t\t\t\tgl.uniform1f( uniforms.rotation, sprite.rotation );\r\n\r\n\t\t\t\t\t\tgl.uniform1f( uniforms.opacity, sprite.opacity );\r\n\t\t\t\t\t\tgl.uniform3f( uniforms.color, sprite.color.r, sprite.color.g, sprite.color.b );\r\n\r\n\t\t\t\t\t\tstate.setBlending( sprite.blending, sprite.blendEquation, sprite.blendSrc, sprite.blendDst );\r\n\t\t\t\t\t\trenderer.setTexture( sprite.texture, 1 );\r\n\r\n\t\t\t\t\t\tgl.drawElements( gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0 );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// restore gl\r\n\r\n\t\tstate.enable( gl.CULL_FACE );\r\n\t\tstate.enable( gl.DEPTH_TEST );\r\n\t\tgl.depthMask( true );\r\n\r\n\t\trenderer.resetGLState();\r\n\r\n\t};\r\n\r\n\tfunction createProgram ( shader ) {\r\n\r\n\t\tvar program = gl.createProgram();\r\n\r\n\t\tvar fragmentShader = gl.createShader( gl.FRAGMENT_SHADER );\r\n\t\tvar vertexShader = gl.createShader( gl.VERTEX_SHADER );\r\n\r\n\t\tvar prefix = \"precision \" + renderer.getPrecision() + \" float;\\n\";\r\n\r\n\t\tgl.shaderSource( fragmentShader, prefix + shader.fragmentShader );\r\n\t\tgl.shaderSource( vertexShader, prefix + shader.vertexShader );\r\n\r\n\t\tgl.compileShader( fragmentShader );\r\n\t\tgl.compileShader( vertexShader );\r\n\r\n\t\tgl.attachShader( program, fragmentShader );\r\n\t\tgl.attachShader( program, vertexShader );\r\n\r\n\t\tgl.linkProgram( program );\r\n\r\n\t\treturn program;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/plugins/SpritePlugin.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.SpritePlugin = function ( renderer, sprites ) {\r\n\r\n\tvar gl = renderer.context;\r\n\tvar state = renderer.state;\r\n\r\n\tvar vertexBuffer, elementBuffer;\r\n\tvar program, attributes, uniforms;\r\n\r\n\tvar texture;\r\n\r\n\t// decompose matrixWorld\r\n\r\n\tvar spritePosition = new THREE.Vector3();\r\n\tvar spriteRotation = new THREE.Quaternion();\r\n\tvar spriteScale = new THREE.Vector3();\r\n\r\n\tfunction init() {\r\n\r\n\t\tvar vertices = new Float32Array( [\r\n\t\t\t- 0.5, - 0.5,  0, 0,\r\n\t\t\t  0.5, - 0.5,  1, 0,\r\n\t\t\t  0.5,   0.5,  1, 1,\r\n\t\t\t- 0.5,   0.5,  0, 1\r\n\t\t] );\r\n\r\n\t\tvar faces = new Uint16Array( [\r\n\t\t\t0, 1, 2,\r\n\t\t\t0, 2, 3\r\n\t\t] );\r\n\r\n\t\tvertexBuffer  = gl.createBuffer();\r\n\t\telementBuffer = gl.createBuffer();\r\n\r\n\t\tgl.bindBuffer( gl.ARRAY_BUFFER, vertexBuffer );\r\n\t\tgl.bufferData( gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW );\r\n\r\n\t\tgl.bindBuffer( gl.ELEMENT_ARRAY_BUFFER, elementBuffer );\r\n\t\tgl.bufferData( gl.ELEMENT_ARRAY_BUFFER, faces, gl.STATIC_DRAW );\r\n\r\n\t\tprogram = createProgram();\r\n\r\n\t\tattributes = {\r\n\t\t\tposition:\t\t\tgl.getAttribLocation ( program, 'position' ),\r\n\t\t\tuv:\t\t\t\t\tgl.getAttribLocation ( program, 'uv' )\r\n\t\t};\r\n\r\n\t\tuniforms = {\r\n\t\t\tuvOffset:\t\t\tgl.getUniformLocation( program, 'uvOffset' ),\r\n\t\t\tuvScale:\t\t\tgl.getUniformLocation( program, 'uvScale' ),\r\n\r\n\t\t\trotation:\t\t\tgl.getUniformLocation( program, 'rotation' ),\r\n\t\t\tscale:\t\t\t\tgl.getUniformLocation( program, 'scale' ),\r\n\r\n\t\t\tcolor:\t\t\t\tgl.getUniformLocation( program, 'color' ),\r\n\t\t\tmap:\t\t\t\tgl.getUniformLocation( program, 'map' ),\r\n\t\t\topacity:\t\t\tgl.getUniformLocation( program, 'opacity' ),\r\n\r\n\t\t\tmodelViewMatrix: \tgl.getUniformLocation( program, 'modelViewMatrix' ),\r\n\t\t\tprojectionMatrix:\tgl.getUniformLocation( program, 'projectionMatrix' ),\r\n\r\n\t\t\tfogType:\t\t\tgl.getUniformLocation( program, 'fogType' ),\r\n\t\t\tfogDensity:\t\t\tgl.getUniformLocation( program, 'fogDensity' ),\r\n\t\t\tfogNear:\t\t\tgl.getUniformLocation( program, 'fogNear' ),\r\n\t\t\tfogFar:\t\t\t\tgl.getUniformLocation( program, 'fogFar' ),\r\n\t\t\tfogColor:\t\t\tgl.getUniformLocation( program, 'fogColor' ),\r\n\r\n\t\t\talphaTest:\t\t\tgl.getUniformLocation( program, 'alphaTest' )\r\n\t\t};\r\n\r\n\t\tvar canvas = document.createElement( 'canvas' );\r\n\t\tcanvas.width = 8;\r\n\t\tcanvas.height = 8;\r\n\r\n\t\tvar context = canvas.getContext( '2d' );\r\n\t\tcontext.fillStyle = 'white';\r\n\t\tcontext.fillRect( 0, 0, 8, 8 );\r\n\r\n\t\ttexture = new THREE.Texture( canvas );\r\n\t\ttexture.needsUpdate = true;\r\n\r\n\t}\r\n\r\n\tthis.render = function ( scene, camera ) {\r\n\r\n\t\tif ( sprites.length === 0 ) return;\r\n\r\n\t\t// setup gl\r\n\r\n\t\tif ( program === undefined ) {\r\n\r\n\t\t\tinit();\r\n\r\n\t\t}\r\n\r\n\t\tgl.useProgram( program );\r\n\r\n\t\tstate.initAttributes();\r\n\t\tstate.enableAttribute( attributes.position );\r\n\t\tstate.enableAttribute( attributes.uv );\r\n\t\tstate.disableUnusedAttributes();\r\n\r\n\t\tstate.disable( gl.CULL_FACE );\r\n\t\tstate.enable( gl.BLEND );\r\n\r\n\t\tgl.bindBuffer( gl.ARRAY_BUFFER, vertexBuffer );\r\n\t\tgl.vertexAttribPointer( attributes.position, 2, gl.FLOAT, false, 2 * 8, 0 );\r\n\t\tgl.vertexAttribPointer( attributes.uv, 2, gl.FLOAT, false, 2 * 8, 8 );\r\n\r\n\t\tgl.bindBuffer( gl.ELEMENT_ARRAY_BUFFER, elementBuffer );\r\n\r\n\t\tgl.uniformMatrix4fv( uniforms.projectionMatrix, false, camera.projectionMatrix.elements );\r\n\r\n\t\tstate.activeTexture( gl.TEXTURE0 );\r\n\t\tgl.uniform1i( uniforms.map, 0 );\r\n\r\n\t\tvar oldFogType = 0;\r\n\t\tvar sceneFogType = 0;\r\n\t\tvar fog = scene.fog;\r\n\r\n\t\tif ( fog ) {\r\n\r\n\t\t\tgl.uniform3f( uniforms.fogColor, fog.color.r, fog.color.g, fog.color.b );\r\n\r\n\t\t\tif ( fog instanceof THREE.Fog ) {\r\n\r\n\t\t\t\tgl.uniform1f( uniforms.fogNear, fog.near );\r\n\t\t\t\tgl.uniform1f( uniforms.fogFar, fog.far );\r\n\r\n\t\t\t\tgl.uniform1i( uniforms.fogType, 1 );\r\n\t\t\t\toldFogType = 1;\r\n\t\t\t\tsceneFogType = 1;\r\n\r\n\t\t\t} else if ( fog instanceof THREE.FogExp2 ) {\r\n\r\n\t\t\t\tgl.uniform1f( uniforms.fogDensity, fog.density );\r\n\r\n\t\t\t\tgl.uniform1i( uniforms.fogType, 2 );\r\n\t\t\t\toldFogType = 2;\r\n\t\t\t\tsceneFogType = 2;\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tgl.uniform1i( uniforms.fogType, 0 );\r\n\t\t\toldFogType = 0;\r\n\t\t\tsceneFogType = 0;\r\n\r\n\t\t}\r\n\r\n\r\n\t\t// update positions and sort\r\n\r\n\t\tfor ( var i = 0, l = sprites.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar sprite = sprites[ i ];\r\n\r\n\t\t\tsprite.modelViewMatrix.multiplyMatrices( camera.matrixWorldInverse, sprite.matrixWorld );\r\n\t\t\tsprite.z = - sprite.modelViewMatrix.elements[ 14 ];\r\n\r\n\t\t}\r\n\r\n\t\tsprites.sort( painterSortStable );\r\n\r\n\t\t// render all sprites\r\n\r\n\t\tvar scale = [];\r\n\r\n\t\tfor ( var i = 0, l = sprites.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar sprite = sprites[ i ];\r\n\t\t\tvar material = sprite.material;\r\n\r\n\t\t\tgl.uniform1f( uniforms.alphaTest, material.alphaTest );\r\n\t\t\tgl.uniformMatrix4fv( uniforms.modelViewMatrix, false, sprite.modelViewMatrix.elements );\r\n\r\n\t\t\tsprite.matrixWorld.decompose( spritePosition, spriteRotation, spriteScale );\r\n\r\n\t\t\tscale[ 0 ] = spriteScale.x;\r\n\t\t\tscale[ 1 ] = spriteScale.y;\r\n\r\n\t\t\tvar fogType = 0;\r\n\r\n\t\t\tif ( scene.fog && material.fog ) {\r\n\r\n\t\t\t\tfogType = sceneFogType;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( oldFogType !== fogType ) {\r\n\r\n\t\t\t\tgl.uniform1i( uniforms.fogType, fogType );\r\n\t\t\t\toldFogType = fogType;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.map !== null ) {\r\n\r\n\t\t\t\tgl.uniform2f( uniforms.uvOffset, material.map.offset.x, material.map.offset.y );\r\n\t\t\t\tgl.uniform2f( uniforms.uvScale, material.map.repeat.x, material.map.repeat.y );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tgl.uniform2f( uniforms.uvOffset, 0, 0 );\r\n\t\t\t\tgl.uniform2f( uniforms.uvScale, 1, 1 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgl.uniform1f( uniforms.opacity, material.opacity );\r\n\t\t\tgl.uniform3f( uniforms.color, material.color.r, material.color.g, material.color.b );\r\n\r\n\t\t\tgl.uniform1f( uniforms.rotation, material.rotation );\r\n\t\t\tgl.uniform2fv( uniforms.scale, scale );\r\n\r\n\t\t\tstate.setBlending( material.blending, material.blendEquation, material.blendSrc, material.blendDst );\r\n\t\t\tstate.setDepthTest( material.depthTest );\r\n\t\t\tstate.setDepthWrite( material.depthWrite );\r\n\r\n\t\t\tif ( material.map && material.map.image && material.map.image.width ) {\r\n\r\n\t\t\t\trenderer.setTexture( material.map, 0 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\trenderer.setTexture( texture, 0 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgl.drawElements( gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0 );\r\n\r\n\t\t}\r\n\r\n\t\t// restore gl\r\n\r\n\t\tstate.enable( gl.CULL_FACE );\r\n\r\n\t\trenderer.resetGLState();\r\n\r\n\t};\r\n\r\n\tfunction createProgram () {\r\n\r\n\t\tvar program = gl.createProgram();\r\n\r\n\t\tvar vertexShader = gl.createShader( gl.VERTEX_SHADER );\r\n\t\tvar fragmentShader = gl.createShader( gl.FRAGMENT_SHADER );\r\n\r\n\t\tgl.shaderSource( vertexShader, [\r\n\r\n\t\t\t'precision ' + renderer.getPrecision() + ' float;',\r\n\r\n\t\t\t'uniform mat4 modelViewMatrix;',\r\n\t\t\t'uniform mat4 projectionMatrix;',\r\n\t\t\t'uniform float rotation;',\r\n\t\t\t'uniform vec2 scale;',\r\n\t\t\t'uniform vec2 uvOffset;',\r\n\t\t\t'uniform vec2 uvScale;',\r\n\r\n\t\t\t'attribute vec2 position;',\r\n\t\t\t'attribute vec2 uv;',\r\n\r\n\t\t\t'varying vec2 vUV;',\r\n\r\n\t\t\t'void main() {',\r\n\r\n\t\t\t\t'vUV = uvOffset + uv * uvScale;',\r\n\r\n\t\t\t\t'vec2 alignedPosition = position * scale;',\r\n\r\n\t\t\t\t'vec2 rotatedPosition;',\r\n\t\t\t\t'rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;',\r\n\t\t\t\t'rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;',\r\n\r\n\t\t\t\t'vec4 finalPosition;',\r\n\r\n\t\t\t\t'finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );',\r\n\t\t\t\t'finalPosition.xy += rotatedPosition;',\r\n\t\t\t\t'finalPosition = projectionMatrix * finalPosition;',\r\n\r\n\t\t\t\t'gl_Position = finalPosition;',\r\n\r\n\t\t\t'}'\r\n\r\n\t\t].join( '\\n' ) );\r\n\r\n\t\tgl.shaderSource( fragmentShader, [\r\n\r\n\t\t\t'precision ' + renderer.getPrecision() + ' float;',\r\n\r\n\t\t\t'uniform vec3 color;',\r\n\t\t\t'uniform sampler2D map;',\r\n\t\t\t'uniform float opacity;',\r\n\r\n\t\t\t'uniform int fogType;',\r\n\t\t\t'uniform vec3 fogColor;',\r\n\t\t\t'uniform float fogDensity;',\r\n\t\t\t'uniform float fogNear;',\r\n\t\t\t'uniform float fogFar;',\r\n\t\t\t'uniform float alphaTest;',\r\n\r\n\t\t\t'varying vec2 vUV;',\r\n\r\n\t\t\t'void main() {',\r\n\r\n\t\t\t\t'vec4 texture = texture2D( map, vUV );',\r\n\r\n\t\t\t\t'if ( texture.a < alphaTest ) discard;',\r\n\r\n\t\t\t\t'gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );',\r\n\r\n\t\t\t\t'if ( fogType > 0 ) {',\r\n\r\n\t\t\t\t\t'float depth = gl_FragCoord.z / gl_FragCoord.w;',\r\n\t\t\t\t\t'float fogFactor = 0.0;',\r\n\r\n\t\t\t\t\t'if ( fogType == 1 ) {',\r\n\r\n\t\t\t\t\t\t'fogFactor = smoothstep( fogNear, fogFar, depth );',\r\n\r\n\t\t\t\t\t'} else {',\r\n\r\n\t\t\t\t\t\t'const float LOG2 = 1.442695;',\r\n\t\t\t\t\t\t'fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );',\r\n\t\t\t\t\t\t'fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );',\r\n\r\n\t\t\t\t\t'}',\r\n\r\n\t\t\t\t\t'gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );',\r\n\r\n\t\t\t\t'}',\r\n\r\n\t\t\t'}'\r\n\r\n\t\t].join( '\\n' ) );\r\n\r\n\t\tgl.compileShader( vertexShader );\r\n\t\tgl.compileShader( fragmentShader );\r\n\r\n\t\tgl.attachShader( program, vertexShader );\r\n\t\tgl.attachShader( program, fragmentShader );\r\n\r\n\t\tgl.linkProgram( program );\r\n\r\n\t\treturn program;\r\n\r\n\t}\r\n\r\n\tfunction painterSortStable ( a, b ) {\r\n\r\n\t\tif ( a.z !== b.z ) {\r\n\r\n\t\t\treturn b.z - a.z;\r\n\r\n\t\t} else {\r\n\r\n\t\t\treturn b.id - a.id;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/extras/CurveUtils.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n */\r\n\r\nTHREE.CurveUtils = {\r\n\r\n\ttangentQuadraticBezier: function ( t, p0, p1, p2 ) {\r\n\r\n\t\treturn 2 * ( 1 - t ) * ( p1 - p0 ) + 2 * t * ( p2 - p1 );\r\n\r\n\t},\r\n\r\n\t// Puay Bing, thanks for helping with this derivative!\r\n\r\n\ttangentCubicBezier: function ( t, p0, p1, p2, p3 ) {\r\n\r\n\t\treturn - 3 * p0 * ( 1 - t ) * ( 1 - t )  +\r\n\t\t\t3 * p1 * ( 1 - t ) * ( 1 - t ) - 6 * t * p1 * ( 1 - t ) +\r\n\t\t\t6 * t *  p2 * ( 1 - t ) - 3 * t * t * p2 +\r\n\t\t\t3 * t * t * p3;\r\n\r\n\t},\r\n\r\n\ttangentSpline: function ( t, p0, p1, p2, p3 ) {\r\n\r\n\t\t// To check if my formulas are correct\r\n\r\n\t\tvar h00 = 6 * t * t - 6 * t; \t// derived from 2t^3  3t^2 + 1\r\n\t\tvar h10 = 3 * t * t - 4 * t + 1; // t^3  2t^2 + t\r\n\t\tvar h01 = - 6 * t * t + 6 * t; \t//  2t3 + 3t2\r\n\t\tvar h11 = 3 * t * t - 2 * t;\t// t3  t2\r\n\r\n\t\treturn h00 + h10 + h01 + h11;\r\n\r\n\t},\r\n\r\n\t// Catmull-Rom\r\n\r\n\tinterpolate: function( p0, p1, p2, p3, t ) {\r\n\r\n\t\tvar v0 = ( p2 - p0 ) * 0.5;\r\n\t\tvar v1 = ( p3 - p1 ) * 0.5;\r\n\t\tvar t2 = t * t;\r\n\t\tvar t3 = t * t2;\r\n\t\treturn ( 2 * p1 - 2 * p2 + v0 + v1 ) * t3 + ( - 3 * p1 + 3 * p2 - 2 * v0 - v1 ) * t2 + v0 * t + p1;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/extras/GeometryUtils.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.GeometryUtils = {\r\n\r\n\tmerge: function ( geometry1, geometry2, materialIndexOffset ) {\r\n\r\n\t\tconsole.warn( 'THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.' );\r\n\r\n\t\tvar matrix;\r\n\r\n\t\tif ( geometry2 instanceof THREE.Mesh ) {\r\n\r\n\t\t\tgeometry2.matrixAutoUpdate && geometry2.updateMatrix();\r\n\r\n\t\t\tmatrix = geometry2.matrix;\r\n\t\t\tgeometry2 = geometry2.geometry;\r\n\r\n\t\t}\r\n\r\n\t\tgeometry1.merge( geometry2, matrix, materialIndexOffset );\r\n\r\n\t},\r\n\r\n\tcenter: function ( geometry ) {\r\n\r\n\t\tconsole.warn( 'THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead.' );\r\n\t\treturn geometry.center();\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/extras/ImageUtils.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author Daosheng Mu / https://github.com/DaoshengMu/\r\n */\r\n\r\nTHREE.ImageUtils = {\r\n\r\n\tcrossOrigin: undefined,\r\n\r\n\tloadTexture: function ( url, mapping, onLoad, onError ) {\r\n\r\n\t\tconsole.warn( 'THREE.ImageUtils.loadTexture is being deprecated. Use THREE.TextureLoader() instead.' );\r\n\r\n\t\tvar loader = new THREE.TextureLoader();\r\n\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\r\n\t\tvar texture = loader.load( url, onLoad, undefined, onError );\r\n\r\n\t\tif ( mapping ) texture.mapping = mapping;\r\n\r\n\t\treturn texture;\r\n\r\n\t},\r\n\r\n\tloadTextureCube: function ( urls, mapping, onLoad, onError ) {\r\n\r\n\t\tconsole.warn( 'THREE.ImageUtils.loadTextureCube is being deprecated. Use THREE.CubeTextureLoader() instead.' );\r\n\r\n\t\tvar loader = new THREE.CubeTextureLoader();\r\n\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\r\n\t\tvar texture = loader.load( urls, onLoad, undefined, onError );\r\n\r\n\t\tif ( mapping ) texture.mapping = mapping;\r\n\r\n\t\treturn texture;\r\n\r\n\t},\r\n\r\n\tloadCompressedTexture: function () {\r\n\r\n\t\tconsole.error( 'THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.' )\r\n\r\n\t},\r\n\r\n\tloadCompressedTextureCube: function () {\r\n\r\n\t\tconsole.error( 'THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.' )\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/extras/SceneUtils.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.SceneUtils = {\r\n\r\n\tcreateMultiMaterialObject: function ( geometry, materials ) {\r\n\r\n\t\tvar group = new THREE.Group();\r\n\r\n\t\tfor ( var i = 0, l = materials.length; i < l; i ++ ) {\r\n\r\n\t\t\tgroup.add( new THREE.Mesh( geometry, materials[ i ] ) );\r\n\r\n\t\t}\r\n\r\n\t\treturn group;\r\n\r\n\t},\r\n\r\n\tdetach: function ( child, parent, scene ) {\r\n\r\n\t\tchild.applyMatrix( parent.matrixWorld );\r\n\t\tparent.remove( child );\r\n\t\tscene.add( child );\r\n\r\n\t},\r\n\r\n\tattach: function ( child, scene, parent ) {\r\n\r\n\t\tvar matrixWorldInverse = new THREE.Matrix4();\r\n\t\tmatrixWorldInverse.getInverse( parent.matrixWorld );\r\n\t\tchild.applyMatrix( matrixWorldInverse );\r\n\r\n\t\tscene.remove( child );\r\n\t\tparent.add( child );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/extras/ShapeUtils.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n */\r\n\r\nTHREE.ShapeUtils = {\r\n\r\n\t// calculate area of the contour polygon\r\n\r\n\tarea: function ( contour ) {\r\n\r\n\t\tvar n = contour.length;\r\n\t\tvar a = 0.0;\r\n\r\n\t\tfor ( var p = n - 1, q = 0; q < n; p = q ++ ) {\r\n\r\n\t\t\ta += contour[ p ].x * contour[ q ].y - contour[ q ].x * contour[ p ].y;\r\n\r\n\t\t}\r\n\r\n\t\treturn a * 0.5;\r\n\r\n\t},\r\n\r\n\ttriangulate: ( function () {\r\n\r\n\t\t/**\r\n\t\t * This code is a quick port of code written in C++ which was submitted to\r\n\t\t * flipcode.com by John W. Ratcliff  // July 22, 2000\r\n\t\t * See original code and more information here:\r\n\t\t * http://www.flipcode.com/archives/Efficient_Polygon_Triangulation.shtml\r\n\t\t *\r\n\t\t * ported to actionscript by Zevan Rosser\r\n\t\t * www.actionsnippet.com\r\n\t\t *\r\n\t\t * ported to javascript by Joshua Koo\r\n\t\t * http://www.lab4games.net/zz85/blog\r\n\t\t *\r\n\t\t */\r\n\r\n\t\tfunction snip( contour, u, v, w, n, verts ) {\r\n\r\n\t\t\tvar p;\r\n\t\t\tvar ax, ay, bx, by;\r\n\t\t\tvar cx, cy, px, py;\r\n\r\n\t\t\tax = contour[ verts[ u ] ].x;\r\n\t\t\tay = contour[ verts[ u ] ].y;\r\n\r\n\t\t\tbx = contour[ verts[ v ] ].x;\r\n\t\t\tby = contour[ verts[ v ] ].y;\r\n\r\n\t\t\tcx = contour[ verts[ w ] ].x;\r\n\t\t\tcy = contour[ verts[ w ] ].y;\r\n\r\n\t\t\tif ( Number.EPSILON > ( ( ( bx - ax ) * ( cy - ay ) ) - ( ( by - ay ) * ( cx - ax ) ) ) ) return false;\r\n\r\n\t\t\tvar aX, aY, bX, bY, cX, cY;\r\n\t\t\tvar apx, apy, bpx, bpy, cpx, cpy;\r\n\t\t\tvar cCROSSap, bCROSScp, aCROSSbp;\r\n\r\n\t\t\taX = cx - bx;  aY = cy - by;\r\n\t\t\tbX = ax - cx;  bY = ay - cy;\r\n\t\t\tcX = bx - ax;  cY = by - ay;\r\n\r\n\t\t\tfor ( p = 0; p < n; p ++ ) {\r\n\r\n\t\t\t\tpx = contour[ verts[ p ] ].x;\r\n\t\t\t\tpy = contour[ verts[ p ] ].y;\r\n\r\n\t\t\t\tif ( ( ( px === ax ) && ( py === ay ) ) ||\r\n\t\t\t\t\t ( ( px === bx ) && ( py === by ) ) ||\r\n\t\t\t\t\t ( ( px === cx ) && ( py === cy ) ) )\tcontinue;\r\n\r\n\t\t\t\tapx = px - ax;  apy = py - ay;\r\n\t\t\t\tbpx = px - bx;  bpy = py - by;\r\n\t\t\t\tcpx = px - cx;  cpy = py - cy;\r\n\r\n\t\t\t\t// see if p is inside triangle abc\r\n\r\n\t\t\t\taCROSSbp = aX * bpy - aY * bpx;\r\n\t\t\t\tcCROSSap = cX * apy - cY * apx;\r\n\t\t\t\tbCROSScp = bX * cpy - bY * cpx;\r\n\r\n\t\t\t\tif ( ( aCROSSbp >= - Number.EPSILON ) && ( bCROSScp >= - Number.EPSILON ) && ( cCROSSap >= - Number.EPSILON ) ) return false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t}\r\n\r\n\t\t// takes in an contour array and returns\r\n\r\n\t\treturn function ( contour, indices ) {\r\n\r\n\t\t\tvar n = contour.length;\r\n\r\n\t\t\tif ( n < 3 ) return null;\r\n\r\n\t\t\tvar result = [],\r\n\t\t\t\tverts = [],\r\n\t\t\t\tvertIndices = [];\r\n\r\n\t\t\t/* we want a counter-clockwise polygon in verts */\r\n\r\n\t\t\tvar u, v, w;\r\n\r\n\t\t\tif ( THREE.ShapeUtils.area( contour ) > 0.0 ) {\r\n\r\n\t\t\t\tfor ( v = 0; v < n; v ++ ) verts[ v ] = v;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tfor ( v = 0; v < n; v ++ ) verts[ v ] = ( n - 1 ) - v;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar nv = n;\r\n\r\n\t\t\t/*  remove nv - 2 vertices, creating 1 triangle every time */\r\n\r\n\t\t\tvar count = 2 * nv;   /* error detection */\r\n\r\n\t\t\tfor ( v = nv - 1; nv > 2; ) {\r\n\r\n\t\t\t\t/* if we loop, it is probably a non-simple polygon */\r\n\r\n\t\t\t\tif ( ( count -- ) <= 0 ) {\r\n\r\n\t\t\t\t\t//** Triangulate: ERROR - probable bad polygon!\r\n\r\n\t\t\t\t\t//throw ( \"Warning, unable to triangulate polygon!\" );\r\n\t\t\t\t\t//return null;\r\n\t\t\t\t\t// Sometimes warning is fine, especially polygons are triangulated in reverse.\r\n\t\t\t\t\tconsole.warn( 'THREE.ShapeUtils: Unable to triangulate polygon! in triangulate()' );\r\n\r\n\t\t\t\t\tif ( indices ) return vertIndices;\r\n\t\t\t\t\treturn result;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t/* three consecutive vertices in current polygon, <u,v,w> */\r\n\r\n\t\t\t\tu = v; \t \tif ( nv <= u ) u = 0;     /* previous */\r\n\t\t\t\tv = u + 1;  if ( nv <= v ) v = 0;     /* new v    */\r\n\t\t\t\tw = v + 1;  if ( nv <= w ) w = 0;     /* next     */\r\n\r\n\t\t\t\tif ( snip( contour, u, v, w, nv, verts ) ) {\r\n\r\n\t\t\t\t\tvar a, b, c, s, t;\r\n\r\n\t\t\t\t\t/* true names of the vertices */\r\n\r\n\t\t\t\t\ta = verts[ u ];\r\n\t\t\t\t\tb = verts[ v ];\r\n\t\t\t\t\tc = verts[ w ];\r\n\r\n\t\t\t\t\t/* output Triangle */\r\n\r\n\t\t\t\t\tresult.push( [ contour[ a ],\r\n\t\t\t\t\t\tcontour[ b ],\r\n\t\t\t\t\t\tcontour[ c ] ] );\r\n\r\n\r\n\t\t\t\t\tvertIndices.push( [ verts[ u ], verts[ v ], verts[ w ] ] );\r\n\r\n\t\t\t\t\t/* remove v from the remaining polygon */\r\n\r\n\t\t\t\t\tfor ( s = v, t = v + 1; t < nv; s ++, t ++ ) {\r\n\r\n\t\t\t\t\t\tverts[ s ] = verts[ t ];\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tnv --;\r\n\r\n\t\t\t\t\t/* reset error detection counter */\r\n\r\n\t\t\t\t\tcount = 2 * nv;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( indices ) return vertIndices;\r\n\t\t\treturn result;\r\n\r\n\t\t}\r\n\r\n\t} )(),\r\n\r\n\ttriangulateShape: function ( contour, holes ) {\r\n\r\n\t\tfunction point_in_segment_2D_colin( inSegPt1, inSegPt2, inOtherPt ) {\r\n\r\n\t\t\t// inOtherPt needs to be collinear to the inSegment\r\n\t\t\tif ( inSegPt1.x !== inSegPt2.x ) {\r\n\r\n\t\t\t\tif ( inSegPt1.x < inSegPt2.x ) {\r\n\r\n\t\t\t\t\treturn\t( ( inSegPt1.x <= inOtherPt.x ) && ( inOtherPt.x <= inSegPt2.x ) );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\treturn\t( ( inSegPt2.x <= inOtherPt.x ) && ( inOtherPt.x <= inSegPt1.x ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif ( inSegPt1.y < inSegPt2.y ) {\r\n\r\n\t\t\t\t\treturn\t( ( inSegPt1.y <= inOtherPt.y ) && ( inOtherPt.y <= inSegPt2.y ) );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\treturn\t( ( inSegPt2.y <= inOtherPt.y ) && ( inOtherPt.y <= inSegPt1.y ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction intersect_segments_2D( inSeg1Pt1, inSeg1Pt2, inSeg2Pt1, inSeg2Pt2, inExcludeAdjacentSegs ) {\r\n\r\n\t\t\tvar seg1dx = inSeg1Pt2.x - inSeg1Pt1.x,   seg1dy = inSeg1Pt2.y - inSeg1Pt1.y;\r\n\t\t\tvar seg2dx = inSeg2Pt2.x - inSeg2Pt1.x,   seg2dy = inSeg2Pt2.y - inSeg2Pt1.y;\r\n\r\n\t\t\tvar seg1seg2dx = inSeg1Pt1.x - inSeg2Pt1.x;\r\n\t\t\tvar seg1seg2dy = inSeg1Pt1.y - inSeg2Pt1.y;\r\n\r\n\t\t\tvar limit\t\t= seg1dy * seg2dx - seg1dx * seg2dy;\r\n\t\t\tvar perpSeg1\t= seg1dy * seg1seg2dx - seg1dx * seg1seg2dy;\r\n\r\n\t\t\tif ( Math.abs( limit ) > Number.EPSILON ) {\r\n\r\n\t\t\t\t// not parallel\r\n\r\n\t\t\t\tvar perpSeg2;\r\n\t\t\t\tif ( limit > 0 ) {\r\n\r\n\t\t\t\t\tif ( ( perpSeg1 < 0 ) || ( perpSeg1 > limit ) ) \t\treturn [];\r\n\t\t\t\t\tperpSeg2 = seg2dy * seg1seg2dx - seg2dx * seg1seg2dy;\r\n\t\t\t\t\tif ( ( perpSeg2 < 0 ) || ( perpSeg2 > limit ) ) \t\treturn [];\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tif ( ( perpSeg1 > 0 ) || ( perpSeg1 < limit ) ) \t\treturn [];\r\n\t\t\t\t\tperpSeg2 = seg2dy * seg1seg2dx - seg2dx * seg1seg2dy;\r\n\t\t\t\t\tif ( ( perpSeg2 > 0 ) || ( perpSeg2 < limit ) ) \t\treturn [];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// i.e. to reduce rounding errors\r\n\t\t\t\t// intersection at endpoint of segment#1?\r\n\t\t\t\tif ( perpSeg2 === 0 ) {\r\n\r\n\t\t\t\t\tif ( ( inExcludeAdjacentSegs ) &&\r\n\t\t\t\t\t\t ( ( perpSeg1 === 0 ) || ( perpSeg1 === limit ) ) )\t\treturn [];\r\n\t\t\t\t\treturn [ inSeg1Pt1 ];\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif ( perpSeg2 === limit ) {\r\n\r\n\t\t\t\t\tif ( ( inExcludeAdjacentSegs ) &&\r\n\t\t\t\t\t\t ( ( perpSeg1 === 0 ) || ( perpSeg1 === limit ) ) )\t\treturn [];\r\n\t\t\t\t\treturn [ inSeg1Pt2 ];\r\n\r\n\t\t\t\t}\r\n\t\t\t\t// intersection at endpoint of segment#2?\r\n\t\t\t\tif ( perpSeg1 === 0 )\t\treturn [ inSeg2Pt1 ];\r\n\t\t\t\tif ( perpSeg1 === limit )\treturn [ inSeg2Pt2 ];\r\n\r\n\t\t\t\t// return real intersection point\r\n\t\t\t\tvar factorSeg1 = perpSeg2 / limit;\r\n\t\t\t\treturn\t[ { x: inSeg1Pt1.x + factorSeg1 * seg1dx,\r\n\t\t\t\t\t\t\ty: inSeg1Pt1.y + factorSeg1 * seg1dy } ];\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// parallel or collinear\r\n\t\t\t\tif ( ( perpSeg1 !== 0 ) ||\r\n\t\t\t\t\t ( seg2dy * seg1seg2dx !== seg2dx * seg1seg2dy ) ) \t\t\treturn [];\r\n\r\n\t\t\t\t// they are collinear or degenerate\r\n\t\t\t\tvar seg1Pt = ( ( seg1dx === 0 ) && ( seg1dy === 0 ) );\t// segment1 is just a point?\r\n\t\t\t\tvar seg2Pt = ( ( seg2dx === 0 ) && ( seg2dy === 0 ) );\t// segment2 is just a point?\r\n\t\t\t\t// both segments are points\r\n\t\t\t\tif ( seg1Pt && seg2Pt ) {\r\n\r\n\t\t\t\t\tif ( ( inSeg1Pt1.x !== inSeg2Pt1.x ) ||\r\n\t\t\t\t\t\t ( inSeg1Pt1.y !== inSeg2Pt1.y ) )\t\treturn [];\t// they are distinct  points\r\n\t\t\t\t\treturn [ inSeg1Pt1 ];                 \t\t\t\t\t\t// they are the same point\r\n\r\n\t\t\t\t}\r\n\t\t\t\t// segment#1  is a single point\r\n\t\t\t\tif ( seg1Pt ) {\r\n\r\n\t\t\t\t\tif ( ! point_in_segment_2D_colin( inSeg2Pt1, inSeg2Pt2, inSeg1Pt1 ) )\t\treturn [];\t\t// but not in segment#2\r\n\t\t\t\t\treturn [ inSeg1Pt1 ];\r\n\r\n\t\t\t\t}\r\n\t\t\t\t// segment#2  is a single point\r\n\t\t\t\tif ( seg2Pt ) {\r\n\r\n\t\t\t\t\tif ( ! point_in_segment_2D_colin( inSeg1Pt1, inSeg1Pt2, inSeg2Pt1 ) )\t\treturn [];\t\t// but not in segment#1\r\n\t\t\t\t\treturn [ inSeg2Pt1 ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// they are collinear segments, which might overlap\r\n\t\t\t\tvar seg1min, seg1max, seg1minVal, seg1maxVal;\r\n\t\t\t\tvar seg2min, seg2max, seg2minVal, seg2maxVal;\r\n\t\t\t\tif ( seg1dx !== 0 ) {\r\n\r\n\t\t\t\t\t// the segments are NOT on a vertical line\r\n\t\t\t\t\tif ( inSeg1Pt1.x < inSeg1Pt2.x ) {\r\n\r\n\t\t\t\t\t\tseg1min = inSeg1Pt1; seg1minVal = inSeg1Pt1.x;\r\n\t\t\t\t\t\tseg1max = inSeg1Pt2; seg1maxVal = inSeg1Pt2.x;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tseg1min = inSeg1Pt2; seg1minVal = inSeg1Pt2.x;\r\n\t\t\t\t\t\tseg1max = inSeg1Pt1; seg1maxVal = inSeg1Pt1.x;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( inSeg2Pt1.x < inSeg2Pt2.x ) {\r\n\r\n\t\t\t\t\t\tseg2min = inSeg2Pt1; seg2minVal = inSeg2Pt1.x;\r\n\t\t\t\t\t\tseg2max = inSeg2Pt2; seg2maxVal = inSeg2Pt2.x;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tseg2min = inSeg2Pt2; seg2minVal = inSeg2Pt2.x;\r\n\t\t\t\t\t\tseg2max = inSeg2Pt1; seg2maxVal = inSeg2Pt1.x;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t// the segments are on a vertical line\r\n\t\t\t\t\tif ( inSeg1Pt1.y < inSeg1Pt2.y ) {\r\n\r\n\t\t\t\t\t\tseg1min = inSeg1Pt1; seg1minVal = inSeg1Pt1.y;\r\n\t\t\t\t\t\tseg1max = inSeg1Pt2; seg1maxVal = inSeg1Pt2.y;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tseg1min = inSeg1Pt2; seg1minVal = inSeg1Pt2.y;\r\n\t\t\t\t\t\tseg1max = inSeg1Pt1; seg1maxVal = inSeg1Pt1.y;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( inSeg2Pt1.y < inSeg2Pt2.y ) {\r\n\r\n\t\t\t\t\t\tseg2min = inSeg2Pt1; seg2minVal = inSeg2Pt1.y;\r\n\t\t\t\t\t\tseg2max = inSeg2Pt2; seg2maxVal = inSeg2Pt2.y;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tseg2min = inSeg2Pt2; seg2minVal = inSeg2Pt2.y;\r\n\t\t\t\t\t\tseg2max = inSeg2Pt1; seg2maxVal = inSeg2Pt1.y;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif ( seg1minVal <= seg2minVal ) {\r\n\r\n\t\t\t\t\tif ( seg1maxVal <  seg2minVal )\treturn [];\r\n\t\t\t\t\tif ( seg1maxVal === seg2minVal )\t{\r\n\r\n\t\t\t\t\t\tif ( inExcludeAdjacentSegs )\t\treturn [];\r\n\t\t\t\t\t\treturn [ seg2min ];\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( seg1maxVal <= seg2maxVal )\treturn [ seg2min, seg1max ];\r\n\t\t\t\t\treturn\t[ seg2min, seg2max ];\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tif ( seg1minVal >  seg2maxVal )\treturn [];\r\n\t\t\t\t\tif ( seg1minVal === seg2maxVal )\t{\r\n\r\n\t\t\t\t\t\tif ( inExcludeAdjacentSegs )\t\treturn [];\r\n\t\t\t\t\t\treturn [ seg1min ];\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( seg1maxVal <= seg2maxVal )\treturn [ seg1min, seg1max ];\r\n\t\t\t\t\treturn\t[ seg1min, seg2max ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction isPointInsideAngle( inVertex, inLegFromPt, inLegToPt, inOtherPt ) {\r\n\r\n\t\t\t// The order of legs is important\r\n\r\n\t\t\t// translation of all points, so that Vertex is at (0,0)\r\n\t\t\tvar legFromPtX\t= inLegFromPt.x - inVertex.x,  legFromPtY\t= inLegFromPt.y - inVertex.y;\r\n\t\t\tvar legToPtX\t= inLegToPt.x\t- inVertex.x,  legToPtY\t\t= inLegToPt.y\t- inVertex.y;\r\n\t\t\tvar otherPtX\t= inOtherPt.x\t- inVertex.x,  otherPtY\t\t= inOtherPt.y\t- inVertex.y;\r\n\r\n\t\t\t// main angle >0: < 180 deg.; 0: 180 deg.; <0: > 180 deg.\r\n\t\t\tvar from2toAngle\t= legFromPtX * legToPtY - legFromPtY * legToPtX;\r\n\t\t\tvar from2otherAngle\t= legFromPtX * otherPtY - legFromPtY * otherPtX;\r\n\r\n\t\t\tif ( Math.abs( from2toAngle ) > Number.EPSILON ) {\r\n\r\n\t\t\t\t// angle != 180 deg.\r\n\r\n\t\t\t\tvar other2toAngle\t\t= otherPtX * legToPtY - otherPtY * legToPtX;\r\n\t\t\t\t// console.log( \"from2to: \" + from2toAngle + \", from2other: \" + from2otherAngle + \", other2to: \" + other2toAngle );\r\n\r\n\t\t\t\tif ( from2toAngle > 0 ) {\r\n\r\n\t\t\t\t\t// main angle < 180 deg.\r\n\t\t\t\t\treturn\t( ( from2otherAngle >= 0 ) && ( other2toAngle >= 0 ) );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t// main angle > 180 deg.\r\n\t\t\t\t\treturn\t( ( from2otherAngle >= 0 ) || ( other2toAngle >= 0 ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// angle == 180 deg.\r\n\t\t\t\t// console.log( \"from2to: 180 deg., from2other: \" + from2otherAngle  );\r\n\t\t\t\treturn\t( from2otherAngle > 0 );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\r\n\t\tfunction removeHoles( contour, holes ) {\r\n\r\n\t\t\tvar shape = contour.concat(); // work on this shape\r\n\t\t\tvar hole;\r\n\r\n\t\t\tfunction isCutLineInsideAngles( inShapeIdx, inHoleIdx ) {\r\n\r\n\t\t\t\t// Check if hole point lies within angle around shape point\r\n\t\t\t\tvar lastShapeIdx = shape.length - 1;\r\n\r\n\t\t\t\tvar prevShapeIdx = inShapeIdx - 1;\r\n\t\t\t\tif ( prevShapeIdx < 0 )\t\t\tprevShapeIdx = lastShapeIdx;\r\n\r\n\t\t\t\tvar nextShapeIdx = inShapeIdx + 1;\r\n\t\t\t\tif ( nextShapeIdx > lastShapeIdx )\tnextShapeIdx = 0;\r\n\r\n\t\t\t\tvar insideAngle = isPointInsideAngle( shape[ inShapeIdx ], shape[ prevShapeIdx ], shape[ nextShapeIdx ], hole[ inHoleIdx ] );\r\n\t\t\t\tif ( ! insideAngle ) {\r\n\r\n\t\t\t\t\t// console.log( \"Vertex (Shape): \" + inShapeIdx + \", Point: \" + hole[inHoleIdx].x + \"/\" + hole[inHoleIdx].y );\r\n\t\t\t\t\treturn\tfalse;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Check if shape point lies within angle around hole point\r\n\t\t\t\tvar lastHoleIdx = hole.length - 1;\r\n\r\n\t\t\t\tvar prevHoleIdx = inHoleIdx - 1;\r\n\t\t\t\tif ( prevHoleIdx < 0 )\t\t\tprevHoleIdx = lastHoleIdx;\r\n\r\n\t\t\t\tvar nextHoleIdx = inHoleIdx + 1;\r\n\t\t\t\tif ( nextHoleIdx > lastHoleIdx )\tnextHoleIdx = 0;\r\n\r\n\t\t\t\tinsideAngle = isPointInsideAngle( hole[ inHoleIdx ], hole[ prevHoleIdx ], hole[ nextHoleIdx ], shape[ inShapeIdx ] );\r\n\t\t\t\tif ( ! insideAngle ) {\r\n\r\n\t\t\t\t\t// console.log( \"Vertex (Hole): \" + inHoleIdx + \", Point: \" + shape[inShapeIdx].x + \"/\" + shape[inShapeIdx].y );\r\n\t\t\t\t\treturn\tfalse;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn\ttrue;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction intersectsShapeEdge( inShapePt, inHolePt ) {\r\n\r\n\t\t\t\t// checks for intersections with shape edges\r\n\t\t\t\tvar sIdx, nextIdx, intersection;\r\n\t\t\t\tfor ( sIdx = 0; sIdx < shape.length; sIdx ++ ) {\r\n\r\n\t\t\t\t\tnextIdx = sIdx + 1; nextIdx %= shape.length;\r\n\t\t\t\t\tintersection = intersect_segments_2D( inShapePt, inHolePt, shape[ sIdx ], shape[ nextIdx ], true );\r\n\t\t\t\t\tif ( intersection.length > 0 )\t\treturn\ttrue;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn\tfalse;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar indepHoles = [];\r\n\r\n\t\t\tfunction intersectsHoleEdge( inShapePt, inHolePt ) {\r\n\r\n\t\t\t\t// checks for intersections with hole edges\r\n\t\t\t\tvar ihIdx, chkHole,\r\n\t\t\t\t\thIdx, nextIdx, intersection;\r\n\t\t\t\tfor ( ihIdx = 0; ihIdx < indepHoles.length; ihIdx ++ ) {\r\n\r\n\t\t\t\t\tchkHole = holes[ indepHoles[ ihIdx ]];\r\n\t\t\t\t\tfor ( hIdx = 0; hIdx < chkHole.length; hIdx ++ ) {\r\n\r\n\t\t\t\t\t\tnextIdx = hIdx + 1; nextIdx %= chkHole.length;\r\n\t\t\t\t\t\tintersection = intersect_segments_2D( inShapePt, inHolePt, chkHole[ hIdx ], chkHole[ nextIdx ], true );\r\n\t\t\t\t\t\tif ( intersection.length > 0 )\t\treturn\ttrue;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\treturn\tfalse;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar holeIndex, shapeIndex,\r\n\t\t\t\tshapePt, holePt,\r\n\t\t\t\tholeIdx, cutKey, failedCuts = [],\r\n\t\t\t\ttmpShape1, tmpShape2,\r\n\t\t\t\ttmpHole1, tmpHole2;\r\n\r\n\t\t\tfor ( var h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\t\t\tindepHoles.push( h );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar minShapeIndex = 0;\r\n\t\t\tvar counter = indepHoles.length * 2;\r\n\t\t\twhile ( indepHoles.length > 0 ) {\r\n\r\n\t\t\t\tcounter --;\r\n\t\t\t\tif ( counter < 0 ) {\r\n\r\n\t\t\t\t\tconsole.log( \"Infinite Loop! Holes left:\" + indepHoles.length + \", Probably Hole outside Shape!\" );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// search for shape-vertex and hole-vertex,\r\n\t\t\t\t// which can be connected without intersections\r\n\t\t\t\tfor ( shapeIndex = minShapeIndex; shapeIndex < shape.length; shapeIndex ++ ) {\r\n\r\n\t\t\t\t\tshapePt = shape[ shapeIndex ];\r\n\t\t\t\t\tholeIndex\t= - 1;\r\n\r\n\t\t\t\t\t// search for hole which can be reached without intersections\r\n\t\t\t\t\tfor ( var h = 0; h < indepHoles.length; h ++ ) {\r\n\r\n\t\t\t\t\t\tholeIdx = indepHoles[ h ];\r\n\r\n\t\t\t\t\t\t// prevent multiple checks\r\n\t\t\t\t\t\tcutKey = shapePt.x + \":\" + shapePt.y + \":\" + holeIdx;\r\n\t\t\t\t\t\tif ( failedCuts[ cutKey ] !== undefined )\t\t\tcontinue;\r\n\r\n\t\t\t\t\t\thole = holes[ holeIdx ];\r\n\t\t\t\t\t\tfor ( var h2 = 0; h2 < hole.length; h2 ++ ) {\r\n\r\n\t\t\t\t\t\t\tholePt = hole[ h2 ];\r\n\t\t\t\t\t\t\tif ( ! isCutLineInsideAngles( shapeIndex, h2 ) )\t\tcontinue;\r\n\t\t\t\t\t\t\tif ( intersectsShapeEdge( shapePt, holePt ) )\t\tcontinue;\r\n\t\t\t\t\t\t\tif ( intersectsHoleEdge( shapePt, holePt ) )\t\tcontinue;\r\n\r\n\t\t\t\t\t\t\tholeIndex = h2;\r\n\t\t\t\t\t\t\tindepHoles.splice( h, 1 );\r\n\r\n\t\t\t\t\t\t\ttmpShape1 = shape.slice( 0, shapeIndex + 1 );\r\n\t\t\t\t\t\t\ttmpShape2 = shape.slice( shapeIndex );\r\n\t\t\t\t\t\t\ttmpHole1 = hole.slice( holeIndex );\r\n\t\t\t\t\t\t\ttmpHole2 = hole.slice( 0, holeIndex + 1 );\r\n\r\n\t\t\t\t\t\t\tshape = tmpShape1.concat( tmpHole1 ).concat( tmpHole2 ).concat( tmpShape2 );\r\n\r\n\t\t\t\t\t\t\tminShapeIndex = shapeIndex;\r\n\r\n\t\t\t\t\t\t\t// Debug only, to show the selected cuts\r\n\t\t\t\t\t\t\t// glob_CutLines.push( [ shapePt, holePt ] );\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ( holeIndex >= 0 )\tbreak;\t\t// hole-vertex found\r\n\r\n\t\t\t\t\t\tfailedCuts[ cutKey ] = true;\t\t\t// remember failure\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( holeIndex >= 0 )\tbreak;\t\t// hole-vertex found\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn shape; \t\t\t/* shape with no holes */\r\n\r\n\t\t}\r\n\r\n\r\n\t\tvar i, il, f, face,\r\n\t\t\tkey, index,\r\n\t\t\tallPointsMap = {};\r\n\r\n\t\t// To maintain reference to old shape, one must match coordinates, or offset the indices from original arrays. It's probably easier to do the first.\r\n\r\n\t\tvar allpoints = contour.concat();\r\n\r\n\t\tfor ( var h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\t\tArray.prototype.push.apply( allpoints, holes[ h ] );\r\n\r\n\t\t}\r\n\r\n\t\t//console.log( \"allpoints\",allpoints, allpoints.length );\r\n\r\n\t\t// prepare all points map\r\n\r\n\t\tfor ( i = 0, il = allpoints.length; i < il; i ++ ) {\r\n\r\n\t\t\tkey = allpoints[ i ].x + \":\" + allpoints[ i ].y;\r\n\r\n\t\t\tif ( allPointsMap[ key ] !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( \"THREE.Shape: Duplicate point\", key );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tallPointsMap[ key ] = i;\r\n\r\n\t\t}\r\n\r\n\t\t// remove holes by cutting paths to holes and adding them to the shape\r\n\t\tvar shapeWithoutHoles = removeHoles( contour, holes );\r\n\r\n\t\tvar triangles = THREE.ShapeUtils.triangulate( shapeWithoutHoles, false ); // True returns indices for points of spooled shape\r\n\t\t//console.log( \"triangles\",triangles, triangles.length );\r\n\r\n\t\t// check all face vertices against all points map\r\n\r\n\t\tfor ( i = 0, il = triangles.length; i < il; i ++ ) {\r\n\r\n\t\t\tface = triangles[ i ];\r\n\r\n\t\t\tfor ( f = 0; f < 3; f ++ ) {\r\n\r\n\t\t\t\tkey = face[ f ].x + \":\" + face[ f ].y;\r\n\r\n\t\t\t\tindex = allPointsMap[ key ];\r\n\r\n\t\t\t\tif ( index !== undefined ) {\r\n\r\n\t\t\t\t\tface[ f ] = index;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn triangles.concat();\r\n\r\n\t},\r\n\r\n\tisClockWise: function ( pts ) {\r\n\r\n\t\treturn THREE.ShapeUtils.area( pts ) < 0;\r\n\r\n\t},\r\n\r\n\t// Bezier Curves formulas obtained from\r\n\t// http://en.wikipedia.org/wiki/B%C3%A9zier_curve\r\n\r\n\t// Quad Bezier Functions\r\n\r\n\tb2: ( function () {\r\n\r\n\t\tfunction b2p0( t, p ) {\r\n\r\n\t\t\tvar k = 1 - t;\r\n\t\t\treturn k * k * p;\r\n\r\n\t\t}\r\n\r\n\t\tfunction b2p1( t, p ) {\r\n\r\n\t\t\treturn 2 * ( 1 - t ) * t * p;\r\n\r\n\t\t}\r\n\r\n\t\tfunction b2p2( t, p ) {\r\n\r\n\t\t\treturn t * t * p;\r\n\r\n\t\t}\r\n\r\n\t\treturn function ( t, p0, p1, p2 ) {\r\n\r\n\t\t\treturn b2p0( t, p0 ) + b2p1( t, p1 ) + b2p2( t, p2 );\r\n\r\n\t\t};\r\n\r\n\t} )(),\r\n\r\n\t// Cubic Bezier Functions\r\n\r\n\tb3: ( function () {\r\n\r\n\t\tfunction b3p0( t, p ) {\r\n\r\n\t\t\tvar k = 1 - t;\r\n\t\t\treturn k * k * k * p;\r\n\r\n\t\t}\r\n\r\n\t\tfunction b3p1( t, p ) {\r\n\r\n\t\t\tvar k = 1 - t;\r\n\t\t\treturn 3 * k * k * t * p;\r\n\r\n\t\t}\r\n\r\n\t\tfunction b3p2( t, p ) {\r\n\r\n\t\t\tvar k = 1 - t;\r\n\t\t\treturn 3 * k * t * t * p;\r\n\r\n\t\t}\r\n\r\n\t\tfunction b3p3( t, p ) {\r\n\r\n\t\t\treturn t * t * t * p;\r\n\r\n\t\t}\r\n\r\n\t\treturn function ( t, p0, p1, p2, p3 ) {\r\n\r\n\t\t\treturn b3p0( t, p0 ) + b3p1( t, p1 ) + b3p2( t, p2 ) + b3p3( t, p3 );\r\n\r\n\t\t};\r\n\r\n\t} )()\r\n\r\n};\r\n\r\n// File:src/extras/audio/Audio.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Audio = function ( listener ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'Audio';\r\n\r\n\tthis.context = listener.context;\r\n\tthis.source = this.context.createBufferSource();\r\n\tthis.source.onended = this.onEnded.bind( this );\r\n\r\n\tthis.gain = this.context.createGain();\r\n\tthis.gain.connect( this.context.destination );\r\n\r\n\tthis.panner = this.context.createPanner();\r\n\tthis.panner.connect( this.gain );\r\n\r\n\tthis.autoplay = false;\r\n\r\n\tthis.startTime = 0;\r\n\tthis.playbackRate = 1;\r\n\tthis.isPlaying = false;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.Audio.prototype.constructor = THREE.Audio;\r\n\r\nTHREE.Audio.prototype.load = function ( file ) {\r\n\r\n\tvar scope = this;\r\n\r\n\tvar request = new XMLHttpRequest();\r\n\trequest.open( 'GET', file, true );\r\n\trequest.responseType = 'arraybuffer';\r\n\trequest.onload = function ( e ) {\r\n\r\n\t\tscope.context.decodeAudioData( this.response, function ( buffer ) {\r\n\r\n\t\t\tscope.source.buffer = buffer;\r\n\r\n\t\t\tif ( scope.autoplay ) scope.play();\r\n\r\n\t\t} );\r\n\r\n\t};\r\n\trequest.send();\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.play = function () {\r\n\r\n\tif ( this.isPlaying === true ) {\r\n\r\n\t\tconsole.warn( 'THREE.Audio: Audio is already playing.' );\r\n\t\treturn;\r\n\r\n\t}\r\n\r\n\tvar source = this.context.createBufferSource();\r\n\r\n\tsource.buffer = this.source.buffer;\r\n\tsource.loop = this.source.loop;\r\n\tsource.onended = this.source.onended;\r\n\tsource.start( 0, this.startTime );\r\n\tsource.playbackRate.value = this.playbackRate;\r\n\r\n\tthis.isPlaying = true;\r\n\r\n\tthis.source = source;\r\n\r\n\tthis.connect();\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.pause = function () {\r\n\r\n\tthis.source.stop();\r\n\tthis.startTime = this.context.currentTime;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.stop = function () {\r\n\r\n\tthis.source.stop();\r\n\tthis.startTime = 0;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.connect = function () {\r\n\r\n\tif ( this.filter !== undefined ) {\r\n\r\n\t\tthis.source.connect( this.filter );\r\n\t\tthis.filter.connect( this.panner );\r\n\r\n\t} else {\r\n\r\n\t\tthis.source.connect( this.panner );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.disconnect = function () {\r\n\r\n\tif ( this.filter !== undefined ) {\r\n\r\n\t\tthis.source.disconnect( this.filter );\r\n\t\tthis.filter.disconnect( this.panner );\r\n\r\n\t} else {\r\n\r\n\t\tthis.source.disconnect( this.panner );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.setFilter = function ( value ) {\r\n\r\n\tif ( this.isPlaying === true ) {\r\n\r\n\t\tthis.disconnect();\r\n\t\tthis.filter = value;\r\n\t\tthis.connect();\r\n\r\n\t} else {\r\n\r\n\t\tthis.filter = value;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.getFilter = function () {\r\n\r\n\treturn this.filter;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.setPlaybackRate = function ( value ) {\r\n\r\n\tthis.playbackRate = value;\r\n\r\n\tif ( this.isPlaying === true ) {\r\n\r\n\t\tthis.source.playbackRate.value = this.playbackRate;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.getPlaybackRate = function () {\r\n\r\n\treturn this.playbackRate;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.onEnded = function() {\r\n\r\n\tthis.isPlaying = false;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.setLoop = function ( value ) {\r\n\r\n\tthis.source.loop = value;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.getLoop = function () {\r\n\r\n\treturn this.source.loop;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.setRefDistance = function ( value ) {\r\n\r\n\tthis.panner.refDistance = value;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.getRefDistance = function () {\r\n\r\n\treturn this.panner.refDistance;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.setRolloffFactor = function ( value ) {\r\n\r\n\tthis.panner.rolloffFactor = value;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.getRolloffFactor = function () {\r\n\r\n\treturn this.panner.rolloffFactor;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.setVolume = function ( value ) {\r\n\r\n\tthis.gain.gain.value = value;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.getVolume = function () {\r\n\r\n\treturn this.gain.gain.value;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.updateMatrixWorld = ( function () {\r\n\r\n\tvar position = new THREE.Vector3();\r\n\r\n\treturn function updateMatrixWorld( force ) {\r\n\r\n\t\tTHREE.Object3D.prototype.updateMatrixWorld.call( this, force );\r\n\r\n\t\tposition.setFromMatrixPosition( this.matrixWorld );\r\n\r\n\t\tthis.panner.setPosition( position.x, position.y, position.z );\r\n\r\n\t};\r\n\r\n} )();\r\n\r\n// File:src/extras/audio/AudioListener.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.AudioListener = function () {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'AudioListener';\r\n\r\n\tthis.context = new ( window.AudioContext || window.webkitAudioContext )();\r\n\r\n};\r\n\r\nTHREE.AudioListener.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.AudioListener.prototype.constructor = THREE.AudioListener;\r\n\r\nTHREE.AudioListener.prototype.updateMatrixWorld = ( function () {\r\n\r\n\tvar position = new THREE.Vector3();\r\n\tvar quaternion = new THREE.Quaternion();\r\n\tvar scale = new THREE.Vector3();\r\n\r\n\tvar orientation = new THREE.Vector3();\r\n\r\n\treturn function updateMatrixWorld( force ) {\r\n\r\n\t\tTHREE.Object3D.prototype.updateMatrixWorld.call( this, force );\r\n\r\n\t\tvar listener = this.context.listener;\r\n\t\tvar up = this.up;\r\n\r\n\t\tthis.matrixWorld.decompose( position, quaternion, scale );\r\n\r\n\t\torientation.set( 0, 0, - 1 ).applyQuaternion( quaternion );\r\n\r\n\t\tlistener.setPosition( position.x, position.y, position.z );\r\n\t\tlistener.setOrientation( orientation.x, orientation.y, orientation.z, up.x, up.y, up.z );\r\n\r\n\t};\r\n\r\n} )();\r\n\r\n// File:src/extras/core/Curve.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * Extensible curve object\r\n *\r\n * Some common of Curve methods\r\n * .getPoint(t), getTangent(t)\r\n * .getPointAt(u), getTagentAt(u)\r\n * .getPoints(), .getSpacedPoints()\r\n * .getLength()\r\n * .updateArcLengths()\r\n *\r\n * This following classes subclasses THREE.Curve:\r\n *\r\n * -- 2d classes --\r\n * THREE.LineCurve\r\n * THREE.QuadraticBezierCurve\r\n * THREE.CubicBezierCurve\r\n * THREE.SplineCurve\r\n * THREE.ArcCurve\r\n * THREE.EllipseCurve\r\n *\r\n * -- 3d classes --\r\n * THREE.LineCurve3\r\n * THREE.QuadraticBezierCurve3\r\n * THREE.CubicBezierCurve3\r\n * THREE.SplineCurve3\r\n * THREE.ClosedSplineCurve3\r\n *\r\n * A series of curves can be represented as a THREE.CurvePath\r\n *\r\n **/\r\n\r\n/**************************************************************\r\n *\tAbstract Curve base class\r\n **************************************************************/\r\n\r\nTHREE.Curve = function () {\r\n\r\n};\r\n\r\nTHREE.Curve.prototype = {\r\n\r\n\tconstructor: THREE.Curve,\r\n\r\n\t// Virtual base class method to overwrite and implement in subclasses\r\n\t//\t- t [0 .. 1]\r\n\r\n\tgetPoint: function ( t ) {\r\n\r\n\t\tconsole.warn( \"THREE.Curve: Warning, getPoint() not implemented!\" );\r\n\t\treturn null;\r\n\r\n\t},\r\n\r\n\t// Get point at relative position in curve according to arc length\r\n\t// - u [0 .. 1]\r\n\r\n\tgetPointAt: function ( u ) {\r\n\r\n\t\tvar t = this.getUtoTmapping( u );\r\n\t\treturn this.getPoint( t );\r\n\r\n\t},\r\n\r\n\t// Get sequence of points using getPoint( t )\r\n\r\n\tgetPoints: function ( divisions ) {\r\n\r\n\t\tif ( ! divisions ) divisions = 5;\r\n\r\n\t\tvar d, pts = [];\r\n\r\n\t\tfor ( d = 0; d <= divisions; d ++ ) {\r\n\r\n\t\t\tpts.push( this.getPoint( d / divisions ) );\r\n\r\n\t\t}\r\n\r\n\t\treturn pts;\r\n\r\n\t},\r\n\r\n\t// Get sequence of points using getPointAt( u )\r\n\r\n\tgetSpacedPoints: function ( divisions ) {\r\n\r\n\t\tif ( ! divisions ) divisions = 5;\r\n\r\n\t\tvar d, pts = [];\r\n\r\n\t\tfor ( d = 0; d <= divisions; d ++ ) {\r\n\r\n\t\t\tpts.push( this.getPointAt( d / divisions ) );\r\n\r\n\t\t}\r\n\r\n\t\treturn pts;\r\n\r\n\t},\r\n\r\n\t// Get total curve arc length\r\n\r\n\tgetLength: function () {\r\n\r\n\t\tvar lengths = this.getLengths();\r\n\t\treturn lengths[ lengths.length - 1 ];\r\n\r\n\t},\r\n\r\n\t// Get list of cumulative segment lengths\r\n\r\n\tgetLengths: function ( divisions ) {\r\n\r\n\t\tif ( ! divisions ) divisions = ( this.__arcLengthDivisions ) ? ( this.__arcLengthDivisions ) : 200;\r\n\r\n\t\tif ( this.cacheArcLengths\r\n\t\t\t&& ( this.cacheArcLengths.length === divisions + 1 )\r\n\t\t\t&& ! this.needsUpdate ) {\r\n\r\n\t\t\t//console.log( \"cached\", this.cacheArcLengths );\r\n\t\t\treturn this.cacheArcLengths;\r\n\r\n\t\t}\r\n\r\n\t\tthis.needsUpdate = false;\r\n\r\n\t\tvar cache = [];\r\n\t\tvar current, last = this.getPoint( 0 );\r\n\t\tvar p, sum = 0;\r\n\r\n\t\tcache.push( 0 );\r\n\r\n\t\tfor ( p = 1; p <= divisions; p ++ ) {\r\n\r\n\t\t\tcurrent = this.getPoint ( p / divisions );\r\n\t\t\tsum += current.distanceTo( last );\r\n\t\t\tcache.push( sum );\r\n\t\t\tlast = current;\r\n\r\n\t\t}\r\n\r\n\t\tthis.cacheArcLengths = cache;\r\n\r\n\t\treturn cache; // { sums: cache, sum:sum }; Sum is in the last element.\r\n\r\n\t},\r\n\r\n\tupdateArcLengths: function() {\r\n\r\n\t\tthis.needsUpdate = true;\r\n\t\tthis.getLengths();\r\n\r\n\t},\r\n\r\n\t// Given u ( 0 .. 1 ), get a t to find p. This gives you points which are equidistant\r\n\r\n\tgetUtoTmapping: function ( u, distance ) {\r\n\r\n\t\tvar arcLengths = this.getLengths();\r\n\r\n\t\tvar i = 0, il = arcLengths.length;\r\n\r\n\t\tvar targetArcLength; // The targeted u distance value to get\r\n\r\n\t\tif ( distance ) {\r\n\r\n\t\t\ttargetArcLength = distance;\r\n\r\n\t\t} else {\r\n\r\n\t\t\ttargetArcLength = u * arcLengths[ il - 1 ];\r\n\r\n\t\t}\r\n\r\n\t\t//var time = Date.now();\r\n\r\n\t\t// binary search for the index with largest value smaller than target u distance\r\n\r\n\t\tvar low = 0, high = il - 1, comparison;\r\n\r\n\t\twhile ( low <= high ) {\r\n\r\n\t\t\ti = Math.floor( low + ( high - low ) / 2 ); // less likely to overflow, though probably not issue here, JS doesn't really have integers, all numbers are floats\r\n\r\n\t\t\tcomparison = arcLengths[ i ] - targetArcLength;\r\n\r\n\t\t\tif ( comparison < 0 ) {\r\n\r\n\t\t\t\tlow = i + 1;\r\n\r\n\t\t\t} else if ( comparison > 0 ) {\r\n\r\n\t\t\t\thigh = i - 1;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\thigh = i;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\t// DONE\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\ti = high;\r\n\r\n\t\t//console.log('b' , i, low, high, Date.now()- time);\r\n\r\n\t\tif ( arcLengths[ i ] === targetArcLength ) {\r\n\r\n\t\t\tvar t = i / ( il - 1 );\r\n\t\t\treturn t;\r\n\r\n\t\t}\r\n\r\n\t\t// we could get finer grain at lengths, or use simple interpolation between two points\r\n\r\n\t\tvar lengthBefore = arcLengths[ i ];\r\n\t\tvar lengthAfter = arcLengths[ i + 1 ];\r\n\r\n\t\tvar segmentLength = lengthAfter - lengthBefore;\r\n\r\n\t\t// determine where we are between the 'before' and 'after' points\r\n\r\n\t\tvar segmentFraction = ( targetArcLength - lengthBefore ) / segmentLength;\r\n\r\n\t\t// add that fractional amount to t\r\n\r\n\t\tvar t = ( i + segmentFraction ) / ( il - 1 );\r\n\r\n\t\treturn t;\r\n\r\n\t},\r\n\r\n\t// Returns a unit vector tangent at t\r\n\t// In case any sub curve does not implement its tangent derivation,\r\n\t// 2 points a small delta apart will be used to find its gradient\r\n\t// which seems to give a reasonable approximation\r\n\r\n\tgetTangent: function( t ) {\r\n\r\n\t\tvar delta = 0.0001;\r\n\t\tvar t1 = t - delta;\r\n\t\tvar t2 = t + delta;\r\n\r\n\t\t// Capping in case of danger\r\n\r\n\t\tif ( t1 < 0 ) t1 = 0;\r\n\t\tif ( t2 > 1 ) t2 = 1;\r\n\r\n\t\tvar pt1 = this.getPoint( t1 );\r\n\t\tvar pt2 = this.getPoint( t2 );\r\n\r\n\t\tvar vec = pt2.clone().sub( pt1 );\r\n\t\treturn vec.normalize();\r\n\r\n\t},\r\n\r\n\tgetTangentAt: function ( u ) {\r\n\r\n\t\tvar t = this.getUtoTmapping( u );\r\n\t\treturn this.getTangent( t );\r\n\r\n\t}\r\n\r\n}\r\n\r\nTHREE.Curve.Utils = THREE.CurveUtils; // backwards compatibility\r\n\r\n// TODO: Transformation for Curves?\r\n\r\n/**************************************************************\r\n *\t3D Curves\r\n **************************************************************/\r\n\r\n// A Factory method for creating new curve subclasses\r\n\r\nTHREE.Curve.create = function ( constructor, getPointFunc ) {\r\n\r\n\tconstructor.prototype = Object.create( THREE.Curve.prototype );\r\n\tconstructor.prototype.constructor = constructor;\r\n\tconstructor.prototype.getPoint = getPointFunc;\r\n\r\n\treturn constructor;\r\n\r\n};\r\n\r\n// File:src/extras/core/CurvePath.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n *\r\n **/\r\n\r\n/**************************************************************\r\n *\tCurved Path - a curve path is simply a array of connected\r\n *  curves, but retains the api of a curve\r\n **************************************************************/\r\n\r\nTHREE.CurvePath = function () {\r\n\r\n\tthis.curves = [];\r\n\r\n\tthis.autoClose = false; // Automatically closes the path\r\n\r\n};\r\n\r\nTHREE.CurvePath.prototype = Object.create( THREE.Curve.prototype );\r\nTHREE.CurvePath.prototype.constructor = THREE.CurvePath;\r\n\r\nTHREE.CurvePath.prototype.add = function ( curve ) {\r\n\r\n\tthis.curves.push( curve );\r\n\r\n};\r\n\r\n/*\r\nTHREE.CurvePath.prototype.checkConnection = function() {\r\n\t// TODO\r\n\t// If the ending of curve is not connected to the starting\r\n\t// or the next curve, then, this is not a real path\r\n};\r\n*/\r\n\r\nTHREE.CurvePath.prototype.closePath = function() {\r\n\r\n\t// TODO Test\r\n\t// and verify for vector3 (needs to implement equals)\r\n\t// Add a line curve if start and end of lines are not connected\r\n\tvar startPoint = this.curves[ 0 ].getPoint( 0 );\r\n\tvar endPoint = this.curves[ this.curves.length - 1 ].getPoint( 1 );\r\n\r\n\tif ( ! startPoint.equals( endPoint ) ) {\r\n\r\n\t\tthis.curves.push( new THREE.LineCurve( endPoint, startPoint ) );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// To get accurate point with reference to\r\n// entire path distance at time t,\r\n// following has to be done:\r\n\r\n// 1. Length of each sub path have to be known\r\n// 2. Locate and identify type of curve\r\n// 3. Get t for the curve\r\n// 4. Return curve.getPointAt(t')\r\n\r\nTHREE.CurvePath.prototype.getPoint = function( t ) {\r\n\r\n\tvar d = t * this.getLength();\r\n\tvar curveLengths = this.getCurveLengths();\r\n\tvar i = 0;\r\n\r\n\t// To think about boundaries points.\r\n\r\n\twhile ( i < curveLengths.length ) {\r\n\r\n\t\tif ( curveLengths[ i ] >= d ) {\r\n\r\n\t\t\tvar diff = curveLengths[ i ] - d;\r\n\t\t\tvar curve = this.curves[ i ];\r\n\r\n\t\t\tvar u = 1 - diff / curve.getLength();\r\n\r\n\t\t\treturn curve.getPointAt( u );\r\n\r\n\t\t}\r\n\r\n\t\ti ++;\r\n\r\n\t}\r\n\r\n\treturn null;\r\n\r\n\t// loop where sum != 0, sum > d , sum+1 <d\r\n\r\n};\r\n\r\n/*\r\nTHREE.CurvePath.prototype.getTangent = function( t ) {\r\n};\r\n*/\r\n\r\n// We cannot use the default THREE.Curve getPoint() with getLength() because in\r\n// THREE.Curve, getLength() depends on getPoint() but in THREE.CurvePath\r\n// getPoint() depends on getLength\r\n\r\nTHREE.CurvePath.prototype.getLength = function() {\r\n\r\n\tvar lens = this.getCurveLengths();\r\n\treturn lens[ lens.length - 1 ];\r\n\r\n};\r\n\r\n// Compute lengths and cache them\r\n// We cannot overwrite getLengths() because UtoT mapping uses it.\r\n\r\nTHREE.CurvePath.prototype.getCurveLengths = function() {\r\n\r\n\t// We use cache values if curves and cache array are same length\r\n\r\n\tif ( this.cacheLengths && this.cacheLengths.length === this.curves.length ) {\r\n\r\n\t\treturn this.cacheLengths;\r\n\r\n\t}\r\n\r\n\t// Get length of sub-curve\r\n\t// Push sums into cached array\r\n\r\n\tvar lengths = [], sums = 0;\r\n\r\n\tfor ( var i = 0, l = this.curves.length; i < l; i ++ ) {\r\n\r\n\t\tsums += this.curves[ i ].getLength();\r\n\t\tlengths.push( sums );\r\n\r\n\t}\r\n\r\n\tthis.cacheLengths = lengths;\r\n\r\n\treturn lengths;\r\n\r\n};\r\n\r\n\r\n\r\n/**************************************************************\r\n *\tCreate Geometries Helpers\r\n **************************************************************/\r\n\r\n/// Generate geometry from path points (for Line or Points objects)\r\n\r\nTHREE.CurvePath.prototype.createPointsGeometry = function( divisions ) {\r\n\r\n\tvar pts = this.getPoints( divisions, true );\r\n\treturn this.createGeometry( pts );\r\n\r\n};\r\n\r\n// Generate geometry from equidistant sampling along the path\r\n\r\nTHREE.CurvePath.prototype.createSpacedPointsGeometry = function( divisions ) {\r\n\r\n\tvar pts = this.getSpacedPoints( divisions, true );\r\n\treturn this.createGeometry( pts );\r\n\r\n};\r\n\r\nTHREE.CurvePath.prototype.createGeometry = function( points ) {\r\n\r\n\tvar geometry = new THREE.Geometry();\r\n\r\n\tfor ( var i = 0, l = points.length; i < l; i ++ ) {\r\n\r\n\t\tvar point = points[ i ];\r\n\t\tgeometry.vertices.push( new THREE.Vector3( point.x, point.y, point.z || 0 ) );\r\n\r\n\t}\r\n\r\n\treturn geometry;\r\n\r\n};\r\n\r\n// File:src/extras/core/Path.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * Creates free form 2d path using series of points, lines or curves.\r\n *\r\n **/\r\n\r\nTHREE.Path = function ( points ) {\r\n\r\n\tTHREE.CurvePath.call( this );\r\n\r\n\tthis.actions = [];\r\n\r\n\tif ( points ) {\r\n\r\n\t\tthis.fromPoints( points );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.Path.prototype = Object.create( THREE.CurvePath.prototype );\r\nTHREE.Path.prototype.constructor = THREE.Path;\r\n\r\n// TODO Clean up PATH API\r\n\r\n// Create path using straight lines to connect all points\r\n// - vectors: array of Vector2\r\n\r\nTHREE.Path.prototype.fromPoints = function ( vectors ) {\r\n\r\n\tthis.moveTo( vectors[ 0 ].x, vectors[ 0 ].y );\r\n\r\n\tfor ( var i = 1, l = vectors.length; i < l; i ++ ) {\r\n\r\n\t\tthis.lineTo( vectors[ i ].x, vectors[ i ].y );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// startPath() endPath()?\r\n\r\nTHREE.Path.prototype.moveTo = function ( x, y ) {\r\n\r\n\tthis.actions.push( { action: 'moveTo', args: [ x, y ] } );\r\n\r\n};\r\n\r\nTHREE.Path.prototype.lineTo = function ( x, y ) {\r\n\r\n\tvar lastargs = this.actions[ this.actions.length - 1 ].args;\r\n\r\n\tvar x0 = lastargs[ lastargs.length - 2 ];\r\n\tvar y0 = lastargs[ lastargs.length - 1 ];\r\n\r\n\tvar curve = new THREE.LineCurve( new THREE.Vector2( x0, y0 ), new THREE.Vector2( x, y ) );\r\n\tthis.curves.push( curve );\r\n\r\n\tthis.actions.push( { action: 'lineTo', args: [ x, y ] } );\r\n\r\n};\r\n\r\nTHREE.Path.prototype.quadraticCurveTo = function( aCPx, aCPy, aX, aY ) {\r\n\r\n\tvar lastargs = this.actions[ this.actions.length - 1 ].args;\r\n\r\n\tvar x0 = lastargs[ lastargs.length - 2 ];\r\n\tvar y0 = lastargs[ lastargs.length - 1 ];\r\n\r\n\tvar curve = new THREE.QuadraticBezierCurve(\r\n\t\tnew THREE.Vector2( x0, y0 ),\r\n\t\tnew THREE.Vector2( aCPx, aCPy ),\r\n\t\tnew THREE.Vector2( aX, aY )\r\n\t);\r\n\r\n\tthis.curves.push( curve );\r\n\r\n\tthis.actions.push( { action: 'quadraticCurveTo', args: [ aCPx, aCPy, aX, aY ] } );\r\n\r\n};\r\n\r\nTHREE.Path.prototype.bezierCurveTo = function( aCP1x, aCP1y, aCP2x, aCP2y, aX, aY ) {\r\n\r\n\tvar lastargs = this.actions[ this.actions.length - 1 ].args;\r\n\r\n\tvar x0 = lastargs[ lastargs.length - 2 ];\r\n\tvar y0 = lastargs[ lastargs.length - 1 ];\r\n\r\n\tvar curve = new THREE.CubicBezierCurve(\r\n\t\tnew THREE.Vector2( x0, y0 ),\r\n\t\tnew THREE.Vector2( aCP1x, aCP1y ),\r\n\t\tnew THREE.Vector2( aCP2x, aCP2y ),\r\n\t\tnew THREE.Vector2( aX, aY )\r\n\t);\r\n\r\n\tthis.curves.push( curve );\r\n\r\n\tthis.actions.push( { action: 'bezierCurveTo', args: [ aCP1x, aCP1y, aCP2x, aCP2y, aX, aY ] } );\r\n\r\n};\r\n\r\nTHREE.Path.prototype.splineThru = function( pts /*Array of Vector*/ ) {\r\n\r\n\tvar args = Array.prototype.slice.call( arguments );\r\n\r\n\tvar lastargs = this.actions[ this.actions.length - 1 ].args;\r\n\r\n\tvar x0 = lastargs[ lastargs.length - 2 ];\r\n\tvar y0 = lastargs[ lastargs.length - 1 ];\r\n\r\n\tvar npts = [ new THREE.Vector2( x0, y0 ) ];\r\n\tArray.prototype.push.apply( npts, pts );\r\n\r\n\tvar curve = new THREE.SplineCurve( npts );\r\n\tthis.curves.push( curve );\r\n\r\n\tthis.actions.push( { action: 'splineThru', args: args } );\r\n\r\n};\r\n\r\n// FUTURE: Change the API or follow canvas API?\r\n\r\nTHREE.Path.prototype.arc = function ( aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise ) {\r\n\r\n\tvar lastargs = this.actions[ this.actions.length - 1 ].args;\r\n\tvar x0 = lastargs[ lastargs.length - 2 ];\r\n\tvar y0 = lastargs[ lastargs.length - 1 ];\r\n\r\n\tthis.absarc( aX + x0, aY + y0, aRadius,\r\n\t\taStartAngle, aEndAngle, aClockwise );\r\n\r\n };\r\n\r\n THREE.Path.prototype.absarc = function ( aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise ) {\r\n\r\n\tthis.absellipse( aX, aY, aRadius, aRadius, aStartAngle, aEndAngle, aClockwise );\r\n\r\n };\r\n\r\nTHREE.Path.prototype.ellipse = function ( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation ) {\r\n\r\n\tvar lastargs = this.actions[ this.actions.length - 1 ].args;\r\n\tvar x0 = lastargs[ lastargs.length - 2 ];\r\n\tvar y0 = lastargs[ lastargs.length - 1 ];\r\n\r\n\tthis.absellipse( aX + x0, aY + y0, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation );\r\n\r\n };\r\n\r\n\r\nTHREE.Path.prototype.absellipse = function ( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation ) {\r\n\r\n\tvar args = [\r\n\t\taX, aY,\r\n\t\txRadius, yRadius,\r\n\t\taStartAngle, aEndAngle,\r\n\t\taClockwise,\r\n\t\taRotation || 0 // aRotation is optional.\r\n\t];\r\n\r\n\tvar curve = new THREE.EllipseCurve( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation );\r\n\tthis.curves.push( curve );\r\n\r\n\tvar lastPoint = curve.getPoint( 1 );\r\n\targs.push( lastPoint.x );\r\n\targs.push( lastPoint.y );\r\n\r\n\tthis.actions.push( { action: 'ellipse', args: args } );\r\n\r\n };\r\n\r\nTHREE.Path.prototype.getSpacedPoints = function ( divisions, closedPath ) {\r\n\r\n\tif ( ! divisions ) divisions = 40;\r\n\r\n\tvar points = [];\r\n\r\n\tfor ( var i = 0; i < divisions; i ++ ) {\r\n\r\n\t\tpoints.push( this.getPoint( i / divisions ) );\r\n\r\n\t\t//if ( !this.getPoint( i / divisions ) ) throw \"DIE\";\r\n\r\n\t}\r\n\r\n\t// if ( closedPath ) {\r\n\t//\r\n\t// \tpoints.push( points[ 0 ] );\r\n\t//\r\n\t// }\r\n\r\n\treturn points;\r\n\r\n};\r\n\r\n/* Return an array of vectors based on contour of the path */\r\n\r\nTHREE.Path.prototype.getPoints = function( divisions, closedPath ) {\r\n\r\n\tdivisions = divisions || 12;\r\n\r\n\tvar b2 = THREE.ShapeUtils.b2;\r\n\tvar b3 = THREE.ShapeUtils.b3;\r\n\r\n\tvar points = [];\r\n\r\n\tvar cpx, cpy, cpx2, cpy2, cpx1, cpy1, cpx0, cpy0,\r\n\t\tlaste, tx, ty;\r\n\r\n\tfor ( var i = 0, l = this.actions.length; i < l; i ++ ) {\r\n\r\n\t\tvar item = this.actions[ i ];\r\n\r\n\t\tvar action = item.action;\r\n\t\tvar args = item.args;\r\n\r\n\t\tswitch ( action ) {\r\n\r\n\t\tcase 'moveTo':\r\n\r\n\t\t\tpoints.push( new THREE.Vector2( args[ 0 ], args[ 1 ] ) );\r\n\r\n\t\t\tbreak;\r\n\r\n\t\tcase 'lineTo':\r\n\r\n\t\t\tpoints.push( new THREE.Vector2( args[ 0 ], args[ 1 ] ) );\r\n\r\n\t\t\tbreak;\r\n\r\n\t\tcase 'quadraticCurveTo':\r\n\r\n\t\t\tcpx  = args[ 2 ];\r\n\t\t\tcpy  = args[ 3 ];\r\n\r\n\t\t\tcpx1 = args[ 0 ];\r\n\t\t\tcpy1 = args[ 1 ];\r\n\r\n\t\t\tif ( points.length > 0 ) {\r\n\r\n\t\t\t\tlaste = points[ points.length - 1 ];\r\n\r\n\t\t\t\tcpx0 = laste.x;\r\n\t\t\t\tcpy0 = laste.y;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tlaste = this.actions[ i - 1 ].args;\r\n\r\n\t\t\t\tcpx0 = laste[ laste.length - 2 ];\r\n\t\t\t\tcpy0 = laste[ laste.length - 1 ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var j = 1; j <= divisions; j ++ ) {\r\n\r\n\t\t\t\tvar t = j / divisions;\r\n\r\n\t\t\t\ttx = b2( t, cpx0, cpx1, cpx );\r\n\t\t\t\tty = b2( t, cpy0, cpy1, cpy );\r\n\r\n\t\t\t\tpoints.push( new THREE.Vector2( tx, ty ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tbreak;\r\n\r\n\t\tcase 'bezierCurveTo':\r\n\r\n\t\t\tcpx  = args[ 4 ];\r\n\t\t\tcpy  = args[ 5 ];\r\n\r\n\t\t\tcpx1 = args[ 0 ];\r\n\t\t\tcpy1 = args[ 1 ];\r\n\r\n\t\t\tcpx2 = args[ 2 ];\r\n\t\t\tcpy2 = args[ 3 ];\r\n\r\n\t\t\tif ( points.length > 0 ) {\r\n\r\n\t\t\t\tlaste = points[ points.length - 1 ];\r\n\r\n\t\t\t\tcpx0 = laste.x;\r\n\t\t\t\tcpy0 = laste.y;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tlaste = this.actions[ i - 1 ].args;\r\n\r\n\t\t\t\tcpx0 = laste[ laste.length - 2 ];\r\n\t\t\t\tcpy0 = laste[ laste.length - 1 ];\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t\tfor ( var j = 1; j <= divisions; j ++ ) {\r\n\r\n\t\t\t\tvar t = j / divisions;\r\n\r\n\t\t\t\ttx = b3( t, cpx0, cpx1, cpx2, cpx );\r\n\t\t\t\tty = b3( t, cpy0, cpy1, cpy2, cpy );\r\n\r\n\t\t\t\tpoints.push( new THREE.Vector2( tx, ty ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tbreak;\r\n\r\n\t\tcase 'splineThru':\r\n\r\n\t\t\tlaste = this.actions[ i - 1 ].args;\r\n\r\n\t\t\tvar last = new THREE.Vector2( laste[ laste.length - 2 ], laste[ laste.length - 1 ] );\r\n\t\t\tvar spts = [ last ];\r\n\r\n\t\t\tvar n = divisions * args[ 0 ].length;\r\n\r\n\t\t\tspts = spts.concat( args[ 0 ] );\r\n\r\n\t\t\tvar spline = new THREE.SplineCurve( spts );\r\n\r\n\t\t\tfor ( var j = 1; j <= n; j ++ ) {\r\n\r\n\t\t\t\tpoints.push( spline.getPointAt( j / n ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tbreak;\r\n\r\n\t\tcase 'arc':\r\n\r\n\t\t\tvar aX = args[ 0 ], aY = args[ 1 ],\r\n\t\t\t\taRadius = args[ 2 ],\r\n\t\t\t\taStartAngle = args[ 3 ], aEndAngle = args[ 4 ],\r\n\t\t\t\taClockwise = !! args[ 5 ];\r\n\r\n\t\t\tvar deltaAngle = aEndAngle - aStartAngle;\r\n\t\t\tvar angle;\r\n\t\t\tvar tdivisions = divisions * 2;\r\n\r\n\t\t\tfor ( var j = 1; j <= tdivisions; j ++ ) {\r\n\r\n\t\t\t\tvar t = j / tdivisions;\r\n\r\n\t\t\t\tif ( ! aClockwise ) {\r\n\r\n\t\t\t\t\tt = 1 - t;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tangle = aStartAngle + t * deltaAngle;\r\n\r\n\t\t\t\ttx = aX + aRadius * Math.cos( angle );\r\n\t\t\t\tty = aY + aRadius * Math.sin( angle );\r\n\r\n\t\t\t\t//console.log('t', t, 'angle', angle, 'tx', tx, 'ty', ty);\r\n\r\n\t\t\t\tpoints.push( new THREE.Vector2( tx, ty ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//console.log(points);\r\n\r\n\t\t\tbreak;\r\n\r\n\t\tcase 'ellipse':\r\n\r\n\t\t\tvar aX = args[ 0 ], aY = args[ 1 ],\r\n\t\t\t\txRadius = args[ 2 ],\r\n\t\t\t\tyRadius = args[ 3 ],\r\n\t\t\t\taStartAngle = args[ 4 ], aEndAngle = args[ 5 ],\r\n\t\t\t\taClockwise = !! args[ 6 ],\r\n\t\t\t\taRotation = args[ 7 ];\r\n\r\n\r\n\t\t\tvar deltaAngle = aEndAngle - aStartAngle;\r\n\t\t\tvar angle;\r\n\t\t\tvar tdivisions = divisions * 2;\r\n\r\n\t\t\tvar cos, sin;\r\n\t\t\tif ( aRotation !== 0 ) {\r\n\r\n\t\t\t\tcos = Math.cos( aRotation );\r\n\t\t\t\tsin = Math.sin( aRotation );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var j = 1; j <= tdivisions; j ++ ) {\r\n\r\n\t\t\t\tvar t = j / tdivisions;\r\n\r\n\t\t\t\tif ( ! aClockwise ) {\r\n\r\n\t\t\t\t\tt = 1 - t;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tangle = aStartAngle + t * deltaAngle;\r\n\r\n\t\t\t\ttx = aX + xRadius * Math.cos( angle );\r\n\t\t\t\tty = aY + yRadius * Math.sin( angle );\r\n\r\n\t\t\t\tif ( aRotation !== 0 ) {\r\n\r\n\t\t\t\t\tvar x = tx, y = ty;\r\n\r\n\t\t\t\t\t// Rotate the point about the center of the ellipse.\r\n\t\t\t\t\ttx = ( x - aX ) * cos - ( y - aY ) * sin + aX;\r\n\t\t\t\t\tty = ( x - aX ) * sin + ( y - aY ) * cos + aY;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//console.log('t', t, 'angle', angle, 'tx', tx, 'ty', ty);\r\n\r\n\t\t\t\tpoints.push( new THREE.Vector2( tx, ty ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//console.log(points);\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t} // end switch\r\n\r\n\t}\r\n\r\n\r\n\r\n\t// Normalize to remove the closing point by default.\r\n\tvar lastPoint = points[ points.length - 1 ];\r\n\tif ( Math.abs( lastPoint.x - points[ 0 ].x ) < Number.EPSILON &&\r\n\t\t\t Math.abs( lastPoint.y - points[ 0 ].y ) < Number.EPSILON )\r\n\t\tpoints.splice( points.length - 1, 1 );\r\n\tif ( closedPath ) {\r\n\r\n\t\tpoints.push( points[ 0 ] );\r\n\r\n\t}\r\n\r\n\treturn points;\r\n\r\n};\r\n\r\n//\r\n// Breaks path into shapes\r\n//\r\n//\tAssumptions (if parameter isCCW==true the opposite holds):\r\n//\t- solid shapes are defined clockwise (CW)\r\n//\t- holes are defined counterclockwise (CCW)\r\n//\r\n//\tIf parameter noHoles==true:\r\n//  - all subPaths are regarded as solid shapes\r\n//  - definition order CW/CCW has no relevance\r\n//\r\n\r\nTHREE.Path.prototype.toShapes = function( isCCW, noHoles ) {\r\n\r\n\tfunction extractSubpaths( inActions ) {\r\n\r\n\t\tvar subPaths = [], lastPath = new THREE.Path();\r\n\r\n\t\tfor ( var i = 0, l = inActions.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar item = inActions[ i ];\r\n\r\n\t\t\tvar args = item.args;\r\n\t\t\tvar action = item.action;\r\n\r\n\t\t\tif ( action === 'moveTo' ) {\r\n\r\n\t\t\t\tif ( lastPath.actions.length !== 0 ) {\r\n\r\n\t\t\t\t\tsubPaths.push( lastPath );\r\n\t\t\t\t\tlastPath = new THREE.Path();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tlastPath[ action ].apply( lastPath, args );\r\n\r\n\t\t}\r\n\r\n\t\tif ( lastPath.actions.length !== 0 ) {\r\n\r\n\t\t\tsubPaths.push( lastPath );\r\n\r\n\t\t}\r\n\r\n\t\t// console.log(subPaths);\r\n\r\n\t\treturn\tsubPaths;\r\n\r\n\t}\r\n\r\n\tfunction toShapesNoHoles( inSubpaths ) {\r\n\r\n\t\tvar shapes = [];\r\n\r\n\t\tfor ( var i = 0, l = inSubpaths.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar tmpPath = inSubpaths[ i ];\r\n\r\n\t\t\tvar tmpShape = new THREE.Shape();\r\n\t\t\ttmpShape.actions = tmpPath.actions;\r\n\t\t\ttmpShape.curves = tmpPath.curves;\r\n\r\n\t\t\tshapes.push( tmpShape );\r\n\r\n\t\t}\r\n\r\n\t\t//console.log(\"shape\", shapes);\r\n\r\n\t\treturn shapes;\r\n\r\n\t}\r\n\r\n\tfunction isPointInsidePolygon( inPt, inPolygon ) {\r\n\r\n\t\tvar polyLen = inPolygon.length;\r\n\r\n\t\t// inPt on polygon contour => immediate success    or\r\n\t\t// toggling of inside/outside at every single! intersection point of an edge\r\n\t\t//  with the horizontal line through inPt, left of inPt\r\n\t\t//  not counting lowerY endpoints of edges and whole edges on that line\r\n\t\tvar inside = false;\r\n\t\tfor ( var p = polyLen - 1, q = 0; q < polyLen; p = q ++ ) {\r\n\r\n\t\t\tvar edgeLowPt  = inPolygon[ p ];\r\n\t\t\tvar edgeHighPt = inPolygon[ q ];\r\n\r\n\t\t\tvar edgeDx = edgeHighPt.x - edgeLowPt.x;\r\n\t\t\tvar edgeDy = edgeHighPt.y - edgeLowPt.y;\r\n\r\n\t\t\tif ( Math.abs( edgeDy ) > Number.EPSILON ) {\r\n\r\n\t\t\t\t// not parallel\r\n\t\t\t\tif ( edgeDy < 0 ) {\r\n\r\n\t\t\t\t\tedgeLowPt  = inPolygon[ q ]; edgeDx = - edgeDx;\r\n\t\t\t\t\tedgeHighPt = inPolygon[ p ]; edgeDy = - edgeDy;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif ( ( inPt.y < edgeLowPt.y ) || ( inPt.y > edgeHighPt.y ) ) \t\tcontinue;\r\n\r\n\t\t\t\tif ( inPt.y === edgeLowPt.y ) {\r\n\r\n\t\t\t\t\tif ( inPt.x === edgeLowPt.x )\t\treturn\ttrue;\t\t// inPt is on contour ?\r\n\t\t\t\t\t// continue;\t\t\t\t// no intersection or edgeLowPt => doesn't count !!!\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tvar perpEdge = edgeDy * ( inPt.x - edgeLowPt.x ) - edgeDx * ( inPt.y - edgeLowPt.y );\r\n\t\t\t\t\tif ( perpEdge === 0 )\t\t\t\treturn\ttrue;\t\t// inPt is on contour ?\r\n\t\t\t\t\tif ( perpEdge < 0 ) \t\t\t\tcontinue;\r\n\t\t\t\t\tinside = ! inside;\t\t// true intersection left of inPt\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// parallel or collinear\r\n\t\t\t\tif ( inPt.y !== edgeLowPt.y ) \t\tcontinue;\t\t\t// parallel\r\n\t\t\t\t// edge lies on the same horizontal line as inPt\r\n\t\t\t\tif ( ( ( edgeHighPt.x <= inPt.x ) && ( inPt.x <= edgeLowPt.x ) ) ||\r\n\t\t\t\t\t ( ( edgeLowPt.x <= inPt.x ) && ( inPt.x <= edgeHighPt.x ) ) )\t\treturn\ttrue;\t// inPt: Point on contour !\r\n\t\t\t\t// continue;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn\tinside;\r\n\r\n\t}\r\n\r\n\tvar isClockWise = THREE.ShapeUtils.isClockWise;\r\n\r\n\tvar subPaths = extractSubpaths( this.actions );\r\n\tif ( subPaths.length === 0 ) return [];\r\n\r\n\tif ( noHoles === true )\treturn\ttoShapesNoHoles( subPaths );\r\n\r\n\r\n\tvar solid, tmpPath, tmpShape, shapes = [];\r\n\r\n\tif ( subPaths.length === 1 ) {\r\n\r\n\t\ttmpPath = subPaths[ 0 ];\r\n\t\ttmpShape = new THREE.Shape();\r\n\t\ttmpShape.actions = tmpPath.actions;\r\n\t\ttmpShape.curves = tmpPath.curves;\r\n\t\tshapes.push( tmpShape );\r\n\t\treturn shapes;\r\n\r\n\t}\r\n\r\n\tvar holesFirst = ! isClockWise( subPaths[ 0 ].getPoints() );\r\n\tholesFirst = isCCW ? ! holesFirst : holesFirst;\r\n\r\n\t// console.log(\"Holes first\", holesFirst);\r\n\r\n\tvar betterShapeHoles = [];\r\n\tvar newShapes = [];\r\n\tvar newShapeHoles = [];\r\n\tvar mainIdx = 0;\r\n\tvar tmpPoints;\r\n\r\n\tnewShapes[ mainIdx ] = undefined;\r\n\tnewShapeHoles[ mainIdx ] = [];\r\n\r\n\tfor ( var i = 0, l = subPaths.length; i < l; i ++ ) {\r\n\r\n\t\ttmpPath = subPaths[ i ];\r\n\t\ttmpPoints = tmpPath.getPoints();\r\n\t\tsolid = isClockWise( tmpPoints );\r\n\t\tsolid = isCCW ? ! solid : solid;\r\n\r\n\t\tif ( solid ) {\r\n\r\n\t\t\tif ( ( ! holesFirst ) && ( newShapes[ mainIdx ] ) )\tmainIdx ++;\r\n\r\n\t\t\tnewShapes[ mainIdx ] = { s: new THREE.Shape(), p: tmpPoints };\r\n\t\t\tnewShapes[ mainIdx ].s.actions = tmpPath.actions;\r\n\t\t\tnewShapes[ mainIdx ].s.curves = tmpPath.curves;\r\n\r\n\t\t\tif ( holesFirst )\tmainIdx ++;\r\n\t\t\tnewShapeHoles[ mainIdx ] = [];\r\n\r\n\t\t\t//console.log('cw', i);\r\n\r\n\t\t} else {\r\n\r\n\t\t\tnewShapeHoles[ mainIdx ].push( { h: tmpPath, p: tmpPoints[ 0 ] } );\r\n\r\n\t\t\t//console.log('ccw', i);\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// only Holes? -> probably all Shapes with wrong orientation\r\n\tif ( ! newShapes[ 0 ] )\treturn\ttoShapesNoHoles( subPaths );\r\n\r\n\r\n\tif ( newShapes.length > 1 ) {\r\n\r\n\t\tvar ambiguous = false;\r\n\t\tvar toChange = [];\r\n\r\n\t\tfor ( var sIdx = 0, sLen = newShapes.length; sIdx < sLen; sIdx ++ ) {\r\n\r\n\t\t\tbetterShapeHoles[ sIdx ] = [];\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var sIdx = 0, sLen = newShapes.length; sIdx < sLen; sIdx ++ ) {\r\n\r\n\t\t\tvar sho = newShapeHoles[ sIdx ];\r\n\r\n\t\t\tfor ( var hIdx = 0; hIdx < sho.length; hIdx ++ ) {\r\n\r\n\t\t\t\tvar ho = sho[ hIdx ];\r\n\t\t\t\tvar hole_unassigned = true;\r\n\r\n\t\t\t\tfor ( var s2Idx = 0; s2Idx < newShapes.length; s2Idx ++ ) {\r\n\r\n\t\t\t\t\tif ( isPointInsidePolygon( ho.p, newShapes[ s2Idx ].p ) ) {\r\n\r\n\t\t\t\t\t\tif ( sIdx !== s2Idx )\ttoChange.push( { froms: sIdx, tos: s2Idx, hole: hIdx } );\r\n\t\t\t\t\t\tif ( hole_unassigned ) {\r\n\r\n\t\t\t\t\t\t\thole_unassigned = false;\r\n\t\t\t\t\t\t\tbetterShapeHoles[ s2Idx ].push( ho );\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tambiguous = true;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif ( hole_unassigned ) {\r\n\r\n\t\t\t\t\tbetterShapeHoles[ sIdx ].push( ho );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\t// console.log(\"ambiguous: \", ambiguous);\r\n\t\tif ( toChange.length > 0 ) {\r\n\r\n\t\t\t// console.log(\"to change: \", toChange);\r\n\t\t\tif ( ! ambiguous )\tnewShapeHoles = betterShapeHoles;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tvar tmpHoles;\r\n\r\n\tfor ( var i = 0, il = newShapes.length; i < il; i ++ ) {\r\n\r\n\t\ttmpShape = newShapes[ i ].s;\r\n\t\tshapes.push( tmpShape );\r\n\t\ttmpHoles = newShapeHoles[ i ];\r\n\r\n\t\tfor ( var j = 0, jl = tmpHoles.length; j < jl; j ++ ) {\r\n\r\n\t\t\ttmpShape.holes.push( tmpHoles[ j ].h );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t//console.log(\"shape\", shapes);\r\n\r\n\treturn shapes;\r\n\r\n};\r\n\r\n// File:src/extras/core/Shape.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * Defines a 2d shape plane using paths.\r\n **/\r\n\r\n// STEP 1 Create a path.\r\n// STEP 2 Turn path into shape.\r\n// STEP 3 ExtrudeGeometry takes in Shape/Shapes\r\n// STEP 3a - Extract points from each shape, turn to vertices\r\n// STEP 3b - Triangulate each shape, add faces.\r\n\r\nTHREE.Shape = function () {\r\n\r\n\tTHREE.Path.apply( this, arguments );\r\n\r\n\tthis.holes = [];\r\n\r\n};\r\n\r\nTHREE.Shape.prototype = Object.create( THREE.Path.prototype );\r\nTHREE.Shape.prototype.constructor = THREE.Shape;\r\n\r\n// Convenience method to return ExtrudeGeometry\r\n\r\nTHREE.Shape.prototype.extrude = function ( options ) {\r\n\r\n\treturn new THREE.ExtrudeGeometry( this, options );\r\n\r\n};\r\n\r\n// Convenience method to return ShapeGeometry\r\n\r\nTHREE.Shape.prototype.makeGeometry = function ( options ) {\r\n\r\n\treturn new THREE.ShapeGeometry( this, options );\r\n\r\n};\r\n\r\n// Get points of holes\r\n\r\nTHREE.Shape.prototype.getPointsHoles = function ( divisions ) {\r\n\r\n\tvar holesPts = [];\r\n\r\n\tfor ( var i = 0, l = this.holes.length; i < l; i ++ ) {\r\n\r\n\t\tholesPts[ i ] = this.holes[ i ].getPoints( divisions );\r\n\r\n\t}\r\n\r\n\treturn holesPts;\r\n\r\n};\r\n\r\n\r\n// Get points of shape and holes (keypoints based on segments parameter)\r\n\r\nTHREE.Shape.prototype.extractAllPoints = function ( divisions ) {\r\n\r\n\treturn {\r\n\r\n\t\tshape: this.getPoints( divisions ),\r\n\t\tholes: this.getPointsHoles( divisions )\r\n\r\n\t};\r\n\r\n};\r\n\r\nTHREE.Shape.prototype.extractPoints = function ( divisions ) {\r\n\r\n\treturn this.extractAllPoints( divisions );\r\n\r\n};\r\n\r\nTHREE.Shape.Utils = THREE.ShapeUtils; // backwards compatibility\r\n\r\n// File:src/extras/curves/LineCurve.js\r\n\r\n/**************************************************************\r\n *\tLine\r\n **************************************************************/\r\n\r\nTHREE.LineCurve = function ( v1, v2 ) {\r\n\r\n\tthis.v1 = v1;\r\n\tthis.v2 = v2;\r\n\r\n};\r\n\r\nTHREE.LineCurve.prototype = Object.create( THREE.Curve.prototype );\r\nTHREE.LineCurve.prototype.constructor = THREE.LineCurve;\r\n\r\nTHREE.LineCurve.prototype.getPoint = function ( t ) {\r\n\r\n\tvar point = this.v2.clone().sub( this.v1 );\r\n\tpoint.multiplyScalar( t ).add( this.v1 );\r\n\r\n\treturn point;\r\n\r\n};\r\n\r\n// Line curve is linear, so we can overwrite default getPointAt\r\n\r\nTHREE.LineCurve.prototype.getPointAt = function ( u ) {\r\n\r\n\treturn this.getPoint( u );\r\n\r\n};\r\n\r\nTHREE.LineCurve.prototype.getTangent = function( t ) {\r\n\r\n\tvar tangent = this.v2.clone().sub( this.v1 );\r\n\r\n\treturn tangent.normalize();\r\n\r\n};\r\n\r\n// File:src/extras/curves/QuadraticBezierCurve.js\r\n\r\n/**************************************************************\r\n *\tQuadratic Bezier curve\r\n **************************************************************/\r\n\r\n\r\nTHREE.QuadraticBezierCurve = function ( v0, v1, v2 ) {\r\n\r\n\tthis.v0 = v0;\r\n\tthis.v1 = v1;\r\n\tthis.v2 = v2;\r\n\r\n};\r\n\r\nTHREE.QuadraticBezierCurve.prototype = Object.create( THREE.Curve.prototype );\r\nTHREE.QuadraticBezierCurve.prototype.constructor = THREE.QuadraticBezierCurve;\r\n\r\n\r\nTHREE.QuadraticBezierCurve.prototype.getPoint = function ( t ) {\r\n\r\n\tvar b2 = THREE.ShapeUtils.b2;\r\n\r\n\treturn new THREE.Vector2(\r\n\t\tb2( t, this.v0.x, this.v1.x, this.v2.x ),\r\n\t\tb2( t, this.v0.y, this.v1.y, this.v2.y )\r\n\t);\r\n\r\n};\r\n\r\n\r\nTHREE.QuadraticBezierCurve.prototype.getTangent = function( t ) {\r\n\r\n\tvar tangentQuadraticBezier = THREE.CurveUtils.tangentQuadraticBezier;\r\n\r\n\treturn new THREE.Vector2(\r\n\t\ttangentQuadraticBezier( t, this.v0.x, this.v1.x, this.v2.x ),\r\n\t\ttangentQuadraticBezier( t, this.v0.y, this.v1.y, this.v2.y )\r\n\t).normalize();\r\n\r\n};\r\n\r\n// File:src/extras/curves/CubicBezierCurve.js\r\n\r\n/**************************************************************\r\n *\tCubic Bezier curve\r\n **************************************************************/\r\n\r\nTHREE.CubicBezierCurve = function ( v0, v1, v2, v3 ) {\r\n\r\n\tthis.v0 = v0;\r\n\tthis.v1 = v1;\r\n\tthis.v2 = v2;\r\n\tthis.v3 = v3;\r\n\r\n};\r\n\r\nTHREE.CubicBezierCurve.prototype = Object.create( THREE.Curve.prototype );\r\nTHREE.CubicBezierCurve.prototype.constructor = THREE.CubicBezierCurve;\r\n\r\nTHREE.CubicBezierCurve.prototype.getPoint = function ( t ) {\r\n\r\n\tvar b3 = THREE.ShapeUtils.b3;\r\n\r\n\treturn new THREE.Vector2( \r\n\t\tb3( t, this.v0.x, this.v1.x, this.v2.x, this.v3.x ),\r\n\t\tb3( t, this.v0.y, this.v1.y, this.v2.y, this.v3.y )\r\n\t);\r\n\r\n};\r\n\r\nTHREE.CubicBezierCurve.prototype.getTangent = function( t ) {\r\n\r\n\tvar tangentCubicBezier = THREE.CurveUtils.tangentCubicBezier;\r\n\r\n\treturn new THREE.Vector2( \r\n\t\ttangentCubicBezier( t, this.v0.x, this.v1.x, this.v2.x, this.v3.x ),\r\n\t\ttangentCubicBezier( t, this.v0.y, this.v1.y, this.v2.y, this.v3.y )\r\n\t).normalize();\r\n\r\n};\r\n\r\n// File:src/extras/curves/SplineCurve.js\r\n\r\n/**************************************************************\r\n *\tSpline curve\r\n **************************************************************/\r\n\r\nTHREE.SplineCurve = function ( points /* array of Vector2 */ ) {\r\n\r\n\tthis.points = ( points == undefined ) ? [] : points;\r\n\r\n};\r\n\r\nTHREE.SplineCurve.prototype = Object.create( THREE.Curve.prototype );\r\nTHREE.SplineCurve.prototype.constructor = THREE.SplineCurve;\r\n\r\nTHREE.SplineCurve.prototype.getPoint = function ( t ) {\r\n\r\n\tvar points = this.points;\r\n\tvar point = ( points.length - 1 ) * t;\r\n\r\n\tvar intPoint = Math.floor( point );\r\n\tvar weight = point - intPoint;\r\n\r\n\tvar point0 = points[ intPoint === 0 ? intPoint : intPoint - 1 ];\r\n\tvar point1 = points[ intPoint ];\r\n\tvar point2 = points[ intPoint > points.length - 2 ? points.length - 1 : intPoint + 1 ];\r\n\tvar point3 = points[ intPoint > points.length - 3 ? points.length - 1 : intPoint + 2 ];\r\n\r\n\tvar interpolate = THREE.CurveUtils.interpolate;\r\n\r\n\treturn new THREE.Vector2(\r\n\t\tinterpolate( point0.x, point1.x, point2.x, point3.x, weight ),\r\n\t\tinterpolate( point0.y, point1.y, point2.y, point3.y, weight )\r\n\t);\r\n\r\n};\r\n\r\n// File:src/extras/curves/EllipseCurve.js\r\n\r\n/**************************************************************\r\n *\tEllipse curve\r\n **************************************************************/\r\n\r\nTHREE.EllipseCurve = function ( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation ) {\r\n\r\n\tthis.aX = aX;\r\n\tthis.aY = aY;\r\n\r\n\tthis.xRadius = xRadius;\r\n\tthis.yRadius = yRadius;\r\n\r\n\tthis.aStartAngle = aStartAngle;\r\n\tthis.aEndAngle = aEndAngle;\r\n\r\n\tthis.aClockwise = aClockwise;\r\n\t\r\n\tthis.aRotation = aRotation || 0;\r\n\r\n};\r\n\r\nTHREE.EllipseCurve.prototype = Object.create( THREE.Curve.prototype );\r\nTHREE.EllipseCurve.prototype.constructor = THREE.EllipseCurve;\r\n\r\nTHREE.EllipseCurve.prototype.getPoint = function ( t ) {\r\n\r\n\tvar deltaAngle = this.aEndAngle - this.aStartAngle;\r\n\r\n\tif ( deltaAngle < 0 ) deltaAngle += Math.PI * 2;\r\n\tif ( deltaAngle > Math.PI * 2 ) deltaAngle -= Math.PI * 2;\r\n\r\n\tvar angle;\r\n\r\n\tif ( this.aClockwise === true ) {\r\n\r\n\t\tangle = this.aEndAngle + ( 1 - t ) * ( Math.PI * 2 - deltaAngle );\r\n\r\n\t} else {\r\n\r\n\t\tangle = this.aStartAngle + t * deltaAngle;\r\n\r\n\t}\r\n\t\r\n\tvar x = this.aX + this.xRadius * Math.cos( angle );\r\n\tvar y = this.aY + this.yRadius * Math.sin( angle );\r\n\r\n\tif ( this.aRotation !== 0 ) {\r\n\r\n\t\tvar cos = Math.cos( this.aRotation );\r\n\t\tvar sin = Math.sin( this.aRotation );\r\n\r\n\t\tvar tx = x, ty = y;\r\n\r\n\t\t// Rotate the point about the center of the ellipse.\r\n\t\tx = ( tx - this.aX ) * cos - ( ty - this.aY ) * sin + this.aX;\r\n\t\ty = ( tx - this.aX ) * sin + ( ty - this.aY ) * cos + this.aY;\r\n\r\n\t}\r\n\r\n\treturn new THREE.Vector2( x, y );\r\n\r\n};\r\n\r\n// File:src/extras/curves/ArcCurve.js\r\n\r\n/**************************************************************\r\n *\tArc curve\r\n **************************************************************/\r\n\r\nTHREE.ArcCurve = function ( aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise ) {\r\n\r\n\tTHREE.EllipseCurve.call( this, aX, aY, aRadius, aRadius, aStartAngle, aEndAngle, aClockwise );\r\n\r\n};\r\n\r\nTHREE.ArcCurve.prototype = Object.create( THREE.EllipseCurve.prototype );\r\nTHREE.ArcCurve.prototype.constructor = THREE.ArcCurve;\r\n\r\n// File:src/extras/curves/LineCurve3.js\r\n\r\n/**************************************************************\r\n *\tLine3D\r\n **************************************************************/\r\n\r\nTHREE.LineCurve3 = THREE.Curve.create(\r\n\r\n\tfunction ( v1, v2 ) {\r\n\r\n\t\tthis.v1 = v1;\r\n\t\tthis.v2 = v2;\r\n\r\n\t},\r\n\r\n\tfunction ( t ) {\r\n\r\n\t\tvar vector = new THREE.Vector3();\r\n\r\n\t\tvector.subVectors( this.v2, this.v1 ); // diff\r\n\t\tvector.multiplyScalar( t );\r\n\t\tvector.add( this.v1 );\r\n\r\n\t\treturn vector;\r\n\r\n\t}\r\n\r\n);\r\n\r\n// File:src/extras/curves/QuadraticBezierCurve3.js\r\n\r\n/**************************************************************\r\n *\tQuadratic Bezier 3D curve\r\n **************************************************************/\r\n\r\nTHREE.QuadraticBezierCurve3 = THREE.Curve.create(\r\n\r\n\tfunction ( v0, v1, v2 ) {\r\n\r\n\t\tthis.v0 = v0;\r\n\t\tthis.v1 = v1;\r\n\t\tthis.v2 = v2;\r\n\r\n\t},\r\n\r\n\tfunction ( t ) {\r\n\r\n\t\tvar b2 = THREE.ShapeUtils.b2;\t\t\r\n\r\n\t\treturn new THREE.Vector3(\r\n\t\t\tb2( t, this.v0.x, this.v1.x, this.v2.x ),\r\n\t\t\tb2( t, this.v0.y, this.v1.y, this.v2.y ),\r\n\t\t\tb2( t, this.v0.z, this.v1.z, this.v2.z )\r\n\t\t);\r\n\r\n\t}\r\n\r\n);\r\n\r\n// File:src/extras/curves/CubicBezierCurve3.js\r\n\r\n/**************************************************************\r\n *\tCubic Bezier 3D curve\r\n **************************************************************/\r\n\r\nTHREE.CubicBezierCurve3 = THREE.Curve.create(\r\n\r\n\tfunction ( v0, v1, v2, v3 ) {\r\n\r\n\t\tthis.v0 = v0;\r\n\t\tthis.v1 = v1;\r\n\t\tthis.v2 = v2;\r\n\t\tthis.v3 = v3;\r\n\r\n\t},\r\n\r\n\tfunction ( t ) {\r\n\r\n\t\tvar b3 = THREE.ShapeUtils.b3;\r\n\r\n\t\treturn new THREE.Vector3(\r\n\t\t\tb3( t, this.v0.x, this.v1.x, this.v2.x, this.v3.x ),\r\n\t\t\tb3( t, this.v0.y, this.v1.y, this.v2.y, this.v3.y ),\r\n\t\t\tb3( t, this.v0.z, this.v1.z, this.v2.z, this.v3.z )\r\n\t\t);\r\n\r\n\t}\r\n\r\n);\r\n\r\n// File:src/extras/curves/SplineCurve3.js\r\n\r\n/**************************************************************\r\n *\tSpline 3D curve\r\n **************************************************************/\r\n\r\n\r\nTHREE.SplineCurve3 = THREE.Curve.create(\r\n\r\n\tfunction ( points /* array of Vector3 */ ) {\r\n\r\n\t\tconsole.warn( 'THREE.SplineCurve3 will be deprecated. Please use THREE.CatmullRomCurve3' );\r\n\t\tthis.points = ( points == undefined ) ? [] : points;\r\n\r\n\t},\r\n\r\n\tfunction ( t ) {\r\n\r\n\t\tvar points = this.points;\r\n\t\tvar point = ( points.length - 1 ) * t;\r\n\r\n\t\tvar intPoint = Math.floor( point );\r\n\t\tvar weight = point - intPoint;\r\n\r\n\t\tvar point0 = points[ intPoint == 0 ? intPoint : intPoint - 1 ];\r\n\t\tvar point1 = points[ intPoint ];\r\n\t\tvar point2 = points[ intPoint > points.length - 2 ? points.length - 1 : intPoint + 1 ];\r\n\t\tvar point3 = points[ intPoint > points.length - 3 ? points.length - 1 : intPoint + 2 ];\r\n\r\n\t\tvar interpolate = THREE.CurveUtils.interpolate;\r\n\r\n\t\treturn new THREE.Vector3(\r\n\t\t\tinterpolate( point0.x, point1.x, point2.x, point3.x, weight ),\r\n\t\t\tinterpolate( point0.y, point1.y, point2.y, point3.y, weight ),\r\n\t\t\tinterpolate( point0.z, point1.z, point2.z, point3.z, weight )\r\n\t\t);\r\n\r\n\t}\r\n\r\n);\r\n\r\n// File:src/extras/curves/CatmullRomCurve3.js\r\n\r\n/**\r\n * @author zz85 https://github.com/zz85\r\n *\r\n * Centripetal CatmullRom Curve - which is useful for avoiding\r\n * cusps and self-intersections in non-uniform catmull rom curves.\r\n * http://www.cemyuksel.com/research/catmullrom_param/catmullrom.pdf\r\n *\r\n * curve.type accepts centripetal(default), chordal and catmullrom\r\n * curve.tension is used for catmullrom which defaults to 0.5\r\n */\r\n\r\nTHREE.CatmullRomCurve3 = ( function() {\r\n\r\n\tvar\r\n\t\ttmp = new THREE.Vector3(),\r\n\t\tpx = new CubicPoly(),\r\n\t\tpy = new CubicPoly(),\r\n\t\tpz = new CubicPoly();\r\n\r\n\t/*\r\n\tBased on an optimized c++ solution in\r\n\t - http://stackoverflow.com/questions/9489736/catmull-rom-curve-with-no-cusps-and-no-self-intersections/\r\n\t - http://ideone.com/NoEbVM\r\n\r\n\tThis CubicPoly class could be used for reusing some variables and calculations,\r\n\tbut for three.js curve use, it could be possible inlined and flatten into a single function call\r\n\twhich can be placed in CurveUtils.\r\n\t*/\r\n\r\n\tfunction CubicPoly() {\r\n\r\n\t}\r\n\r\n\t/*\r\n\t * Compute coefficients for a cubic polynomial\r\n\t *   p(s) = c0 + c1*s + c2*s^2 + c3*s^3\r\n\t * such that\r\n\t *   p(0) = x0, p(1) = x1\r\n\t *  and\r\n\t *   p'(0) = t0, p'(1) = t1.\r\n\t */\r\n\tCubicPoly.prototype.init = function( x0, x1, t0, t1 ) {\r\n\r\n\t\tthis.c0 = x0;\r\n\t\tthis.c1 = t0;\r\n\t\tthis.c2 = - 3 * x0 + 3 * x1 - 2 * t0 - t1;\r\n\t\tthis.c3 = 2 * x0 - 2 * x1 + t0 + t1;\r\n\r\n\t};\r\n\r\n\tCubicPoly.prototype.initNonuniformCatmullRom = function( x0, x1, x2, x3, dt0, dt1, dt2 ) {\r\n\r\n\t\t// compute tangents when parameterized in [t1,t2]\r\n\t\tvar t1 = ( x1 - x0 ) / dt0 - ( x2 - x0 ) / ( dt0 + dt1 ) + ( x2 - x1 ) / dt1;\r\n\t\tvar t2 = ( x2 - x1 ) / dt1 - ( x3 - x1 ) / ( dt1 + dt2 ) + ( x3 - x2 ) / dt2;\r\n\r\n\t\t// rescale tangents for parametrization in [0,1]\r\n\t\tt1 *= dt1;\r\n\t\tt2 *= dt1;\r\n\r\n\t\t// initCubicPoly\r\n\t\tthis.init( x1, x2, t1, t2 );\r\n\r\n\t};\r\n\r\n\t// standard Catmull-Rom spline: interpolate between x1 and x2 with previous/following points x1/x4\r\n\tCubicPoly.prototype.initCatmullRom = function( x0, x1, x2, x3, tension ) {\r\n\r\n\t\tthis.init( x1, x2, tension * ( x2 - x0 ), tension * ( x3 - x1 ) );\r\n\r\n\t};\r\n\r\n\tCubicPoly.prototype.calc = function( t ) {\r\n\r\n\t\tvar t2 = t * t;\r\n\t\tvar t3 = t2 * t;\r\n\t\treturn this.c0 + this.c1 * t + this.c2 * t2 + this.c3 * t3;\r\n\r\n\t};\r\n\r\n\t// Subclass Three.js curve\r\n\treturn THREE.Curve.create(\r\n\r\n\t\tfunction ( p /* array of Vector3 */ ) {\r\n\r\n\t\t\tthis.points = p || [];\r\n\r\n\t\t},\r\n\r\n\t\tfunction ( t ) {\r\n\r\n\t\t\tvar points = this.points,\r\n\t\t\t\tpoint, intPoint, weight, l;\r\n\r\n\t\t\tl = points.length;\r\n\r\n\t\t\tif ( l < 2 ) console.log( 'duh, you need at least 2 points' );\r\n\r\n\t\t\tpoint = ( l - 1 ) * t;\r\n\t\t\tintPoint = Math.floor( point );\r\n\t\t\tweight = point - intPoint;\r\n\r\n\t\t\tif ( weight === 0 && intPoint === l - 1 ) {\r\n\r\n\t\t\t\tintPoint = l - 2;\r\n\t\t\t\tweight = 1;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar p0, p1, p2, p3;\r\n\r\n\t\t\tif ( intPoint === 0 ) {\r\n\r\n\t\t\t\t// extrapolate first point\r\n\t\t\t\ttmp.subVectors( points[ 0 ], points[ 1 ] ).add( points[ 0 ] );\r\n\t\t\t\tp0 = tmp;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tp0 = points[ intPoint - 1 ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tp1 = points[ intPoint ];\r\n\t\t\tp2 = points[ intPoint + 1 ];\r\n\r\n\t\t\tif ( intPoint + 2 < l ) {\r\n\r\n\t\t\t\tp3 = points[ intPoint + 2 ]\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// extrapolate last point\r\n\t\t\t\ttmp.subVectors( points[ l - 1 ], points[ l - 2 ] ).add( points[ l - 2 ] );\r\n\t\t\t\tp3 = tmp;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.type === undefined || this.type === 'centripetal' || this.type === 'chordal' ) {\r\n\r\n\t\t\t\t// init Centripetal / Chordal Catmull-Rom\r\n\t\t\t\tvar pow = this.type === 'chordal' ? 0.5 : 0.25;\r\n\t\t\t\tvar dt0 = Math.pow( p0.distanceToSquared( p1 ), pow );\r\n\t\t\t\tvar dt1 = Math.pow( p1.distanceToSquared( p2 ), pow );\r\n\t\t\t\tvar dt2 = Math.pow( p2.distanceToSquared( p3 ), pow );\r\n\r\n\t\t\t\t// safety check for repeated points\r\n\t\t\t\tif ( dt1 < 1e-4 ) dt1 = 1.0;\r\n\t\t\t\tif ( dt0 < 1e-4 ) dt0 = dt1;\r\n\t\t\t\tif ( dt2 < 1e-4 ) dt2 = dt1;\r\n\r\n\t\t\t\tpx.initNonuniformCatmullRom( p0.x, p1.x, p2.x, p3.x, dt0, dt1, dt2 );\r\n\t\t\t\tpy.initNonuniformCatmullRom( p0.y, p1.y, p2.y, p3.y, dt0, dt1, dt2 );\r\n\t\t\t\tpz.initNonuniformCatmullRom( p0.z, p1.z, p2.z, p3.z, dt0, dt1, dt2 );\r\n\r\n\t\t\t} else if ( this.type === 'catmullrom' ) {\r\n\r\n\t\t\t\tvar tension = this.tension !== undefined ? this.tension : 0.5;\r\n\t\t\t\tpx.initCatmullRom( p0.x, p1.x, p2.x, p3.x, tension );\r\n\t\t\t\tpy.initCatmullRom( p0.y, p1.y, p2.y, p3.y, tension );\r\n\t\t\t\tpz.initCatmullRom( p0.z, p1.z, p2.z, p3.z, tension );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar v = new THREE.Vector3(\r\n\t\t\t\tpx.calc( weight ),\r\n\t\t\t\tpy.calc( weight ),\r\n\t\t\t\tpz.calc( weight )\r\n\t\t\t);\r\n\r\n\t\t\treturn v;\r\n\r\n\t\t}\r\n\r\n\t);\r\n\r\n} )();\r\n\r\n// File:src/extras/curves/ClosedSplineCurve3.js\r\n\r\n/**************************************************************\r\n *\tClosed Spline 3D curve\r\n **************************************************************/\r\n\r\n\r\nTHREE.ClosedSplineCurve3 = THREE.Curve.create(\r\n\r\n\tfunction ( points /* array of Vector3 */ ) {\r\n\r\n\t\tthis.points = ( points == undefined ) ? [] : points;\r\n\r\n\t},\r\n\r\n\tfunction ( t ) {\r\n\r\n\t\tvar points = this.points;\r\n\t\tvar point = ( points.length - 0 ) * t; // This needs to be from 0-length +1\r\n\r\n\t\tvar intPoint = Math.floor( point );\r\n\t\tvar weight = point - intPoint;\r\n\r\n\t\tintPoint += intPoint > 0 ? 0 : ( Math.floor( Math.abs( intPoint ) / points.length ) + 1 ) * points.length;\r\n\r\n\t\tvar point0 = points[ ( intPoint - 1 ) % points.length ];\r\n\t\tvar point1 = points[ ( intPoint     ) % points.length ];\r\n\t\tvar point2 = points[ ( intPoint + 1 ) % points.length ];\r\n\t\tvar point3 = points[ ( intPoint + 2 ) % points.length ];\r\n\r\n\t\tvar interpolate = THREE.CurveUtils.interpolate;\r\n\r\n\t\treturn new THREE.Vector3(\r\n\t\t\tinterpolate( point0.x, point1.x, point2.x, point3.x, weight ),\r\n\t\t\tinterpolate( point0.y, point1.y, point2.y, point3.y, weight ),\r\n\t\t\tinterpolate( point0.z, point1.z, point2.z, point3.z, weight )\r\n\t\t);\r\n\r\n\t}\r\n\r\n);\r\n\r\n// File:src/extras/geometries/BoxGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * based on http://papervision3d.googlecode.com/svn/trunk/as3/trunk/src/org/papervision3d/objects/primitives/Cube.as\r\n */\r\n\r\nTHREE.BoxGeometry = function ( width, height, depth, widthSegments, heightSegments, depthSegments ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'BoxGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\twidth: width,\r\n\t\theight: height,\r\n\t\tdepth: depth,\r\n\t\twidthSegments: widthSegments,\r\n\t\theightSegments: heightSegments,\r\n\t\tdepthSegments: depthSegments\r\n\t};\r\n\r\n\tthis.widthSegments = widthSegments || 1;\r\n\tthis.heightSegments = heightSegments || 1;\r\n\tthis.depthSegments = depthSegments || 1;\r\n\r\n\tvar scope = this;\r\n\r\n\tvar width_half = width / 2;\r\n\tvar height_half = height / 2;\r\n\tvar depth_half = depth / 2;\r\n\r\n\tbuildPlane( 'z', 'y', - 1, - 1, depth, height, width_half, 0 ); // px\r\n\tbuildPlane( 'z', 'y',   1, - 1, depth, height, - width_half, 1 ); // nx\r\n\tbuildPlane( 'x', 'z',   1,   1, width, depth, height_half, 2 ); // py\r\n\tbuildPlane( 'x', 'z',   1, - 1, width, depth, - height_half, 3 ); // ny\r\n\tbuildPlane( 'x', 'y',   1, - 1, width, height, depth_half, 4 ); // pz\r\n\tbuildPlane( 'x', 'y', - 1, - 1, width, height, - depth_half, 5 ); // nz\r\n\r\n\tfunction buildPlane( u, v, udir, vdir, width, height, depth, materialIndex ) {\r\n\r\n\t\tvar w, ix, iy,\r\n\t\tgridX = scope.widthSegments,\r\n\t\tgridY = scope.heightSegments,\r\n\t\twidth_half = width / 2,\r\n\t\theight_half = height / 2,\r\n\t\toffset = scope.vertices.length;\r\n\r\n\t\tif ( ( u === 'x' && v === 'y' ) || ( u === 'y' && v === 'x' ) ) {\r\n\r\n\t\t\tw = 'z';\r\n\r\n\t\t} else if ( ( u === 'x' && v === 'z' ) || ( u === 'z' && v === 'x' ) ) {\r\n\r\n\t\t\tw = 'y';\r\n\t\t\tgridY = scope.depthSegments;\r\n\r\n\t\t} else if ( ( u === 'z' && v === 'y' ) || ( u === 'y' && v === 'z' ) ) {\r\n\r\n\t\t\tw = 'x';\r\n\t\t\tgridX = scope.depthSegments;\r\n\r\n\t\t}\r\n\r\n\t\tvar gridX1 = gridX + 1,\r\n\t\tgridY1 = gridY + 1,\r\n\t\tsegment_width = width / gridX,\r\n\t\tsegment_height = height / gridY,\r\n\t\tnormal = new THREE.Vector3();\r\n\r\n\t\tnormal[ w ] = depth > 0 ? 1 : - 1;\r\n\r\n\t\tfor ( iy = 0; iy < gridY1; iy ++ ) {\r\n\r\n\t\t\tfor ( ix = 0; ix < gridX1; ix ++ ) {\r\n\r\n\t\t\t\tvar vector = new THREE.Vector3();\r\n\t\t\t\tvector[ u ] = ( ix * segment_width - width_half ) * udir;\r\n\t\t\t\tvector[ v ] = ( iy * segment_height - height_half ) * vdir;\r\n\t\t\t\tvector[ w ] = depth;\r\n\r\n\t\t\t\tscope.vertices.push( vector );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfor ( iy = 0; iy < gridY; iy ++ ) {\r\n\r\n\t\t\tfor ( ix = 0; ix < gridX; ix ++ ) {\r\n\r\n\t\t\t\tvar a = ix + gridX1 * iy;\r\n\t\t\t\tvar b = ix + gridX1 * ( iy + 1 );\r\n\t\t\t\tvar c = ( ix + 1 ) + gridX1 * ( iy + 1 );\r\n\t\t\t\tvar d = ( ix + 1 ) + gridX1 * iy;\r\n\r\n\t\t\t\tvar uva = new THREE.Vector2( ix / gridX, 1 - iy / gridY );\r\n\t\t\t\tvar uvb = new THREE.Vector2( ix / gridX, 1 - ( iy + 1 ) / gridY );\r\n\t\t\t\tvar uvc = new THREE.Vector2( ( ix + 1 ) / gridX, 1 - ( iy + 1 ) / gridY );\r\n\t\t\t\tvar uvd = new THREE.Vector2( ( ix + 1 ) / gridX, 1 - iy / gridY );\r\n\r\n\t\t\t\tvar face = new THREE.Face3( a + offset, b + offset, d + offset );\r\n\t\t\t\tface.normal.copy( normal );\r\n\t\t\t\tface.vertexNormals.push( normal.clone(), normal.clone(), normal.clone() );\r\n\t\t\t\tface.materialIndex = materialIndex;\r\n\r\n\t\t\t\tscope.faces.push( face );\r\n\t\t\t\tscope.faceVertexUvs[ 0 ].push( [ uva, uvb, uvd ] );\r\n\r\n\t\t\t\tface = new THREE.Face3( b + offset, c + offset, d + offset );\r\n\t\t\t\tface.normal.copy( normal );\r\n\t\t\t\tface.vertexNormals.push( normal.clone(), normal.clone(), normal.clone() );\r\n\t\t\t\tface.materialIndex = materialIndex;\r\n\r\n\t\t\t\tscope.faces.push( face );\r\n\t\t\t\tscope.faceVertexUvs[ 0 ].push( [ uvb.clone(), uvc, uvd.clone() ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.mergeVertices();\r\n\r\n};\r\n\r\nTHREE.BoxGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.BoxGeometry.prototype.constructor = THREE.BoxGeometry;\r\n\r\nTHREE.BoxGeometry.prototype.clone = function () {\r\n\r\n\tvar parameters = this.parameters;\r\n\r\n\treturn new THREE.BoxGeometry(\r\n\t\tparameters.width,\r\n\t\tparameters.height,\r\n\t\tparameters.depth,\r\n\t\tparameters.widthSegments,\r\n\t\tparameters.heightSegments,\r\n\t\tparameters.depthSegments\r\n\t);\r\n\r\n};\r\n\r\nTHREE.CubeGeometry = THREE.BoxGeometry; // backwards compatibility\r\n\r\n// File:src/extras/geometries/CircleGeometry.js\r\n\r\n/**\r\n * @author hughes\r\n */\r\n\r\nTHREE.CircleGeometry = function ( radius, segments, thetaStart, thetaLength ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'CircleGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\tsegments: segments,\r\n\t\tthetaStart: thetaStart,\r\n\t\tthetaLength: thetaLength\r\n\t};\r\n\r\n\tthis.fromBufferGeometry( new THREE.CircleBufferGeometry( radius, segments, thetaStart, thetaLength ) );\r\n\r\n};\r\n\r\nTHREE.CircleGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.CircleGeometry.prototype.constructor = THREE.CircleGeometry;\r\n\r\nTHREE.CircleGeometry.prototype.clone = function () {\r\n\r\n\tvar parameters = this.parameters;\r\n\r\n\treturn new THREE.CircleGeometry(\r\n\t\tparameters.radius,\r\n\t\tparameters.segments,\r\n\t\tparameters.thetaStart,\r\n\t\tparameters.thetaLength\r\n\t);\r\n\r\n};\r\n\r\n// File:src/extras/geometries/CircleBufferGeometry.js\r\n\r\n/**\r\n * @author benaadams / https://twitter.com/ben_a_adams\r\n */\r\n\r\nTHREE.CircleBufferGeometry = function ( radius, segments, thetaStart, thetaLength ) {\r\n\r\n\tTHREE.BufferGeometry.call( this );\r\n\r\n\tthis.type = 'CircleBufferGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\tsegments: segments,\r\n\t\tthetaStart: thetaStart,\r\n\t\tthetaLength: thetaLength\r\n\t};\r\n\r\n\tradius = radius || 50;\r\n\tsegments = segments !== undefined ? Math.max( 3, segments ) : 8;\r\n\r\n\tthetaStart = thetaStart !== undefined ? thetaStart : 0;\r\n\tthetaLength = thetaLength !== undefined ? thetaLength : Math.PI * 2;\r\n\r\n\tvar vertices = segments + 2;\r\n\r\n\tvar positions = new Float32Array( vertices * 3 );\r\n\tvar normals = new Float32Array( vertices * 3 );\r\n\tvar uvs = new Float32Array( vertices * 2 );\r\n\r\n\t// center data is already zero, but need to set a few extras\r\n\tnormals[ 2 ] = 1.0;\r\n\tuvs[ 0 ] = 0.5;\r\n\tuvs[ 1 ] = 0.5;\r\n\r\n\tfor ( var s = 0, i = 3, ii = 2 ; s <= segments; s ++, i += 3, ii += 2 ) {\r\n\r\n\t\tvar segment = thetaStart + s / segments * thetaLength;\r\n\r\n\t\tpositions[ i ] = radius * Math.cos( segment );\r\n\t\tpositions[ i + 1 ] = radius * Math.sin( segment );\r\n\r\n\t\tnormals[ i + 2 ] = 1; // normal z\r\n\r\n\t\tuvs[ ii ] = ( positions[ i ] / radius + 1 ) / 2;\r\n\t\tuvs[ ii + 1 ] = ( positions[ i + 1 ] / radius + 1 ) / 2;\r\n\r\n\t}\r\n\r\n\tvar indices = [];\r\n\r\n\tfor ( var i = 1; i <= segments; i ++ ) {\r\n\r\n\t\tindices.push( i, i + 1, 0 );\r\n\r\n\t}\r\n\r\n\tthis.setIndex( new THREE.BufferAttribute( new Uint16Array( indices ), 1 ) );\r\n\tthis.addAttribute( 'position', new THREE.BufferAttribute( positions, 3 ) );\r\n\tthis.addAttribute( 'normal', new THREE.BufferAttribute( normals, 3 ) );\r\n\tthis.addAttribute( 'uv', new THREE.BufferAttribute( uvs, 2 ) );\r\n\r\n\tthis.boundingSphere = new THREE.Sphere( new THREE.Vector3(), radius );\r\n\r\n};\r\n\r\nTHREE.CircleBufferGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\r\nTHREE.CircleBufferGeometry.prototype.constructor = THREE.CircleBufferGeometry;\r\n\r\nTHREE.CircleBufferGeometry.prototype.clone = function () {\r\n\r\n\tvar parameters = this.parameters;\r\n\r\n\treturn new THREE.CircleBufferGeometry(\r\n\t\tparameters.radius,\r\n\t\tparameters.segments,\r\n\t\tparameters.thetaStart,\r\n\t\tparameters.thetaLength\r\n\t);\r\n\r\n};\r\n\r\n// File:src/extras/geometries/CylinderGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.CylinderGeometry = function ( radiusTop, radiusBottom, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'CylinderGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradiusTop: radiusTop,\r\n\t\tradiusBottom: radiusBottom,\r\n\t\theight: height,\r\n\t\tradialSegments: radialSegments,\r\n\t\theightSegments: heightSegments,\r\n\t\topenEnded: openEnded,\r\n\t\tthetaStart: thetaStart,\r\n\t\tthetaLength: thetaLength\r\n\t};\r\n\r\n\tradiusTop = radiusTop !== undefined ? radiusTop : 20;\r\n\tradiusBottom = radiusBottom !== undefined ? radiusBottom : 20;\r\n\theight = height !== undefined ? height : 100;\r\n\r\n\tradialSegments = radialSegments || 8;\r\n\theightSegments = heightSegments || 1;\r\n\r\n\topenEnded = openEnded !== undefined ? openEnded : false;\r\n\tthetaStart = thetaStart !== undefined ? thetaStart : 0;\r\n\tthetaLength = thetaLength !== undefined ? thetaLength : 2 * Math.PI;\r\n\r\n\tvar heightHalf = height / 2;\r\n\r\n\tvar x, y, vertices = [], uvs = [];\r\n\r\n\tfor ( y = 0; y <= heightSegments; y ++ ) {\r\n\r\n\t\tvar verticesRow = [];\r\n\t\tvar uvsRow = [];\r\n\r\n\t\tvar v = y / heightSegments;\r\n\t\tvar radius = v * ( radiusBottom - radiusTop ) + radiusTop;\r\n\r\n\t\tfor ( x = 0; x <= radialSegments; x ++ ) {\r\n\r\n\t\t\tvar u = x / radialSegments;\r\n\r\n\t\t\tvar vertex = new THREE.Vector3();\r\n\t\t\tvertex.x = radius * Math.sin( u * thetaLength + thetaStart );\r\n\t\t\tvertex.y = - v * height + heightHalf;\r\n\t\t\tvertex.z = radius * Math.cos( u * thetaLength + thetaStart );\r\n\r\n\t\t\tthis.vertices.push( vertex );\r\n\r\n\t\t\tverticesRow.push( this.vertices.length - 1 );\r\n\t\t\tuvsRow.push( new THREE.Vector2( u, 1 - v ) );\r\n\r\n\t\t}\r\n\r\n\t\tvertices.push( verticesRow );\r\n\t\tuvs.push( uvsRow );\r\n\r\n\t}\r\n\r\n\tvar tanTheta = ( radiusBottom - radiusTop ) / height;\r\n\tvar na, nb;\r\n\r\n\tfor ( x = 0; x < radialSegments; x ++ ) {\r\n\r\n\t\tif ( radiusTop !== 0 ) {\r\n\r\n\t\t\tna = this.vertices[ vertices[ 0 ][ x ] ].clone();\r\n\t\t\tnb = this.vertices[ vertices[ 0 ][ x + 1 ] ].clone();\r\n\r\n\t\t} else {\r\n\r\n\t\t\tna = this.vertices[ vertices[ 1 ][ x ] ].clone();\r\n\t\t\tnb = this.vertices[ vertices[ 1 ][ x + 1 ] ].clone();\r\n\r\n\t\t}\r\n\r\n\t\tna.setY( Math.sqrt( na.x * na.x + na.z * na.z ) * tanTheta ).normalize();\r\n\t\tnb.setY( Math.sqrt( nb.x * nb.x + nb.z * nb.z ) * tanTheta ).normalize();\r\n\r\n\t\tfor ( y = 0; y < heightSegments; y ++ ) {\r\n\r\n\t\t\tvar v1 = vertices[ y ][ x ];\r\n\t\t\tvar v2 = vertices[ y + 1 ][ x ];\r\n\t\t\tvar v3 = vertices[ y + 1 ][ x + 1 ];\r\n\t\t\tvar v4 = vertices[ y ][ x + 1 ];\r\n\r\n\t\t\tvar n1 = na.clone();\r\n\t\t\tvar n2 = na.clone();\r\n\t\t\tvar n3 = nb.clone();\r\n\t\t\tvar n4 = nb.clone();\r\n\r\n\t\t\tvar uv1 = uvs[ y ][ x ].clone();\r\n\t\t\tvar uv2 = uvs[ y + 1 ][ x ].clone();\r\n\t\t\tvar uv3 = uvs[ y + 1 ][ x + 1 ].clone();\r\n\t\t\tvar uv4 = uvs[ y ][ x + 1 ].clone();\r\n\r\n\t\t\tthis.faces.push( new THREE.Face3( v1, v2, v4, [ n1, n2, n4 ] ) );\r\n\t\t\tthis.faceVertexUvs[ 0 ].push( [ uv1, uv2, uv4 ] );\r\n\r\n\t\t\tthis.faces.push( new THREE.Face3( v2, v3, v4, [ n2.clone(), n3, n4.clone() ] ) );\r\n\t\t\tthis.faceVertexUvs[ 0 ].push( [ uv2.clone(), uv3, uv4.clone() ] );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// top cap\r\n\r\n\tif ( openEnded === false && radiusTop > 0 ) {\r\n\r\n\t\tthis.vertices.push( new THREE.Vector3( 0, heightHalf, 0 ) );\r\n\r\n\t\tfor ( x = 0; x < radialSegments; x ++ ) {\r\n\r\n\t\t\tvar v1 = vertices[ 0 ][ x ];\r\n\t\t\tvar v2 = vertices[ 0 ][ x + 1 ];\r\n\t\t\tvar v3 = this.vertices.length - 1;\r\n\r\n\t\t\tvar n1 = new THREE.Vector3( 0, 1, 0 );\r\n\t\t\tvar n2 = new THREE.Vector3( 0, 1, 0 );\r\n\t\t\tvar n3 = new THREE.Vector3( 0, 1, 0 );\r\n\r\n\t\t\tvar uv1 = uvs[ 0 ][ x ].clone();\r\n\t\t\tvar uv2 = uvs[ 0 ][ x + 1 ].clone();\r\n\t\t\tvar uv3 = new THREE.Vector2( uv2.x, 0 );\r\n\r\n\t\t\tthis.faces.push( new THREE.Face3( v1, v2, v3, [ n1, n2, n3 ], undefined, 1 ) );\r\n\t\t\tthis.faceVertexUvs[ 0 ].push( [ uv1, uv2, uv3 ] );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// bottom cap\r\n\r\n\tif ( openEnded === false && radiusBottom > 0 ) {\r\n\r\n\t\tthis.vertices.push( new THREE.Vector3( 0, - heightHalf, 0 ) );\r\n\r\n\t\tfor ( x = 0; x < radialSegments; x ++ ) {\r\n\r\n\t\t\tvar v1 = vertices[ heightSegments ][ x + 1 ];\r\n\t\t\tvar v2 = vertices[ heightSegments ][ x ];\r\n\t\t\tvar v3 = this.vertices.length - 1;\r\n\r\n\t\t\tvar n1 = new THREE.Vector3( 0, - 1, 0 );\r\n\t\t\tvar n2 = new THREE.Vector3( 0, - 1, 0 );\r\n\t\t\tvar n3 = new THREE.Vector3( 0, - 1, 0 );\r\n\r\n\t\t\tvar uv1 = uvs[ heightSegments ][ x + 1 ].clone();\r\n\t\t\tvar uv2 = uvs[ heightSegments ][ x ].clone();\r\n\t\t\tvar uv3 = new THREE.Vector2( uv2.x, 1 );\r\n\r\n\t\t\tthis.faces.push( new THREE.Face3( v1, v2, v3, [ n1, n2, n3 ], undefined, 2 ) );\r\n\t\t\tthis.faceVertexUvs[ 0 ].push( [ uv1, uv2, uv3 ] );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.computeFaceNormals();\r\n\r\n};\r\n\r\nTHREE.CylinderGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.CylinderGeometry.prototype.constructor = THREE.CylinderGeometry;\r\n\r\nTHREE.CylinderGeometry.prototype.clone = function () {\r\n\r\n\tvar parameters = this.parameters;\r\n\r\n\treturn new THREE.CylinderGeometry(\r\n\t\tparameters.radiusTop,\r\n\t\tparameters.radiusBottom,\r\n\t\tparameters.height,\r\n\t\tparameters.radialSegments,\r\n\t\tparameters.heightSegments,\r\n\t\tparameters.openEnded,\r\n\t\tparameters.thetaStart,\r\n\t\tparameters.thetaLength\r\n\t);\r\n\r\n};\r\n\r\n// File:src/extras/geometries/EdgesGeometry.js\r\n\r\n/**\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.EdgesGeometry = function ( geometry, thresholdAngle ) {\r\n\r\n\tTHREE.BufferGeometry.call( this );\r\n\r\n\tthresholdAngle = ( thresholdAngle !== undefined ) ? thresholdAngle : 1;\r\n\r\n\tvar thresholdDot = Math.cos( THREE.Math.degToRad( thresholdAngle ) );\r\n\r\n\tvar edge = [ 0, 0 ], hash = {};\r\n\r\n\tfunction sortFunction( a, b ) {\r\n\r\n\t\treturn a - b;\r\n\r\n\t}\r\n\r\n\tvar keys = [ 'a', 'b', 'c' ];\r\n\r\n\tvar geometry2;\r\n\r\n\tif ( geometry instanceof THREE.BufferGeometry ) {\r\n\r\n\t\tgeometry2 = new THREE.Geometry();\r\n\t\tgeometry2.fromBufferGeometry( geometry );\r\n\r\n\t} else {\r\n\r\n\t\tgeometry2 = geometry.clone();\r\n\r\n\t}\r\n\r\n\tgeometry2.mergeVertices();\r\n\tgeometry2.computeFaceNormals();\r\n\r\n\tvar vertices = geometry2.vertices;\r\n\tvar faces = geometry2.faces;\r\n\r\n\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\r\n\r\n\t\tvar face = faces[ i ];\r\n\r\n\t\tfor ( var j = 0; j < 3; j ++ ) {\r\n\r\n\t\t\tedge[ 0 ] = face[ keys[ j ] ];\r\n\t\t\tedge[ 1 ] = face[ keys[ ( j + 1 ) % 3 ] ];\r\n\t\t\tedge.sort( sortFunction );\r\n\r\n\t\t\tvar key = edge.toString();\r\n\r\n\t\t\tif ( hash[ key ] === undefined ) {\r\n\r\n\t\t\t\thash[ key ] = { vert1: edge[ 0 ], vert2: edge[ 1 ], face1: i, face2: undefined };\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\thash[ key ].face2 = i;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tvar coords = [];\r\n\r\n\tfor ( var key in hash ) {\r\n\r\n\t\tvar h = hash[ key ];\r\n\r\n\t\tif ( h.face2 === undefined || faces[ h.face1 ].normal.dot( faces[ h.face2 ].normal ) <= thresholdDot ) {\r\n\r\n\t\t\tvar vertex = vertices[ h.vert1 ];\r\n\t\t\tcoords.push( vertex.x );\r\n\t\t\tcoords.push( vertex.y );\r\n\t\t\tcoords.push( vertex.z );\r\n\r\n\t\t\tvertex = vertices[ h.vert2 ];\r\n\t\t\tcoords.push( vertex.x );\r\n\t\t\tcoords.push( vertex.y );\r\n\t\t\tcoords.push( vertex.z );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.addAttribute( 'position', new THREE.BufferAttribute( new Float32Array( coords ), 3 ) );\r\n\r\n};\r\n\r\nTHREE.EdgesGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\r\nTHREE.EdgesGeometry.prototype.constructor = THREE.EdgesGeometry;\r\n\r\n// File:src/extras/geometries/ExtrudeGeometry.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n *\r\n * Creates extruded geometry from a path shape.\r\n *\r\n * parameters = {\r\n *\r\n *  curveSegments: <int>, // number of points on the curves\r\n *  steps: <int>, // number of points for z-side extrusions / used for subdividing segments of extrude spline too\r\n *  amount: <int>, // Depth to extrude the shape\r\n *\r\n *  bevelEnabled: <bool>, // turn on bevel\r\n *  bevelThickness: <float>, // how deep into the original shape bevel goes\r\n *  bevelSize: <float>, // how far from shape outline is bevel\r\n *  bevelSegments: <int>, // number of bevel layers\r\n *\r\n *  extrudePath: <THREE.CurvePath> // 3d spline path to extrude shape along. (creates Frames if .frames aren't defined)\r\n *  frames: <THREE.TubeGeometry.FrenetFrames> // containing arrays of tangents, normals, binormals\r\n *\r\n *  uvGenerator: <Object> // object that provides UV generator functions\r\n *\r\n * }\r\n **/\r\n\r\nTHREE.ExtrudeGeometry = function ( shapes, options ) {\r\n\r\n\tif ( typeof( shapes ) === \"undefined\" ) {\r\n\r\n\t\tshapes = [];\r\n\t\treturn;\r\n\r\n\t}\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'ExtrudeGeometry';\r\n\r\n\tshapes = Array.isArray( shapes ) ? shapes : [ shapes ];\r\n\r\n\tthis.addShapeList( shapes, options );\r\n\r\n\tthis.computeFaceNormals();\r\n\r\n\t// can't really use automatic vertex normals\r\n\t// as then front and back sides get smoothed too\r\n\t// should do separate smoothing just for sides\r\n\r\n\t//this.computeVertexNormals();\r\n\r\n\t//console.log( \"took\", ( Date.now() - startTime ) );\r\n\r\n};\r\n\r\nTHREE.ExtrudeGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.ExtrudeGeometry.prototype.constructor = THREE.ExtrudeGeometry;\r\n\r\nTHREE.ExtrudeGeometry.prototype.addShapeList = function ( shapes, options ) {\r\n\r\n\tvar sl = shapes.length;\r\n\r\n\tfor ( var s = 0; s < sl; s ++ ) {\r\n\r\n\t\tvar shape = shapes[ s ];\r\n\t\tthis.addShape( shape, options );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.ExtrudeGeometry.prototype.addShape = function ( shape, options ) {\r\n\r\n\tvar amount = options.amount !== undefined ? options.amount : 100;\r\n\r\n\tvar bevelThickness = options.bevelThickness !== undefined ? options.bevelThickness : 6; // 10\r\n\tvar bevelSize = options.bevelSize !== undefined ? options.bevelSize : bevelThickness - 2; // 8\r\n\tvar bevelSegments = options.bevelSegments !== undefined ? options.bevelSegments : 3;\r\n\r\n\tvar bevelEnabled = options.bevelEnabled !== undefined ? options.bevelEnabled : true; // false\r\n\r\n\tvar curveSegments = options.curveSegments !== undefined ? options.curveSegments : 12;\r\n\r\n\tvar steps = options.steps !== undefined ? options.steps : 1;\r\n\r\n\tvar extrudePath = options.extrudePath;\r\n\tvar extrudePts, extrudeByPath = false;\r\n\r\n\t// Use default WorldUVGenerator if no UV generators are specified.\r\n\tvar uvgen = options.UVGenerator !== undefined ? options.UVGenerator : THREE.ExtrudeGeometry.WorldUVGenerator;\r\n\r\n\tvar splineTube, binormal, normal, position2;\r\n\tif ( extrudePath ) {\r\n\r\n\t\textrudePts = extrudePath.getSpacedPoints( steps );\r\n\r\n\t\textrudeByPath = true;\r\n\t\tbevelEnabled = false; // bevels not supported for path extrusion\r\n\r\n\t\t// SETUP TNB variables\r\n\r\n\t\t// Reuse TNB from TubeGeomtry for now.\r\n\t\t// TODO1 - have a .isClosed in spline?\r\n\r\n\t\tsplineTube = options.frames !== undefined ? options.frames : new THREE.TubeGeometry.FrenetFrames( extrudePath, steps, false );\r\n\r\n\t\t// console.log(splineTube, 'splineTube', splineTube.normals.length, 'steps', steps, 'extrudePts', extrudePts.length);\r\n\r\n\t\tbinormal = new THREE.Vector3();\r\n\t\tnormal = new THREE.Vector3();\r\n\t\tposition2 = new THREE.Vector3();\r\n\r\n\t}\r\n\r\n\t// Safeguards if bevels are not enabled\r\n\r\n\tif ( ! bevelEnabled ) {\r\n\r\n\t\tbevelSegments = 0;\r\n\t\tbevelThickness = 0;\r\n\t\tbevelSize = 0;\r\n\r\n\t}\r\n\r\n\t// Variables initialization\r\n\r\n\tvar ahole, h, hl; // looping of holes\r\n\tvar scope = this;\r\n\r\n\tvar shapesOffset = this.vertices.length;\r\n\r\n\tvar shapePoints = shape.extractPoints( curveSegments );\r\n\r\n\tvar vertices = shapePoints.shape;\r\n\tvar holes = shapePoints.holes;\r\n\r\n\tvar reverse = ! THREE.ShapeUtils.isClockWise( vertices );\r\n\r\n\tif ( reverse ) {\r\n\r\n\t\tvertices = vertices.reverse();\r\n\r\n\t\t// Maybe we should also check if holes are in the opposite direction, just to be safe ...\r\n\r\n\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\t\tahole = holes[ h ];\r\n\r\n\t\t\tif ( THREE.ShapeUtils.isClockWise( ahole ) ) {\r\n\r\n\t\t\t\tholes[ h ] = ahole.reverse();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treverse = false; // If vertices are in order now, we shouldn't need to worry about them again (hopefully)!\r\n\r\n\t}\r\n\r\n\r\n\tvar faces = THREE.ShapeUtils.triangulateShape( vertices, holes );\r\n\r\n\t/* Vertices */\r\n\r\n\tvar contour = vertices; // vertices has all points but contour has only points of circumference\r\n\r\n\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\tahole = holes[ h ];\r\n\r\n\t\tvertices = vertices.concat( ahole );\r\n\r\n\t}\r\n\r\n\r\n\tfunction scalePt2 ( pt, vec, size ) {\r\n\r\n\t\tif ( ! vec ) console.error( \"THREE.ExtrudeGeometry: vec does not exist\" );\r\n\r\n\t\treturn vec.clone().multiplyScalar( size ).add( pt );\r\n\r\n\t}\r\n\r\n\tvar b, bs, t, z,\r\n\t\tvert, vlen = vertices.length,\r\n\t\tface, flen = faces.length;\r\n\r\n\r\n\t// Find directions for point movement\r\n\r\n\r\n\tfunction getBevelVec( inPt, inPrev, inNext ) {\r\n\r\n\t\t// computes for inPt the corresponding point inPt' on a new contour\r\n\t\t//   shifted by 1 unit (length of normalized vector) to the left\r\n\t\t// if we walk along contour clockwise, this new contour is outside the old one\r\n\t\t//\r\n\t\t// inPt' is the intersection of the two lines parallel to the two\r\n\t\t//  adjacent edges of inPt at a distance of 1 unit on the left side.\r\n\r\n\t\tvar v_trans_x, v_trans_y, shrink_by = 1;\t\t// resulting translation vector for inPt\r\n\r\n\t\t// good reading for geometry algorithms (here: line-line intersection)\r\n\t\t// http://geomalgorithms.com/a05-_intersect-1.html\r\n\r\n\t\tvar v_prev_x = inPt.x - inPrev.x, v_prev_y = inPt.y - inPrev.y;\r\n\t\tvar v_next_x = inNext.x - inPt.x, v_next_y = inNext.y - inPt.y;\r\n\r\n\t\tvar v_prev_lensq = ( v_prev_x * v_prev_x + v_prev_y * v_prev_y );\r\n\r\n\t\t// check for collinear edges\r\n\t\tvar collinear0 = ( v_prev_x * v_next_y - v_prev_y * v_next_x );\r\n\r\n\t\tif ( Math.abs( collinear0 ) > Number.EPSILON ) {\r\n\r\n\t\t\t// not collinear\r\n\r\n\t\t\t// length of vectors for normalizing\r\n\r\n\t\t\tvar v_prev_len = Math.sqrt( v_prev_lensq );\r\n\t\t\tvar v_next_len = Math.sqrt( v_next_x * v_next_x + v_next_y * v_next_y );\r\n\r\n\t\t\t// shift adjacent points by unit vectors to the left\r\n\r\n\t\t\tvar ptPrevShift_x = ( inPrev.x - v_prev_y / v_prev_len );\r\n\t\t\tvar ptPrevShift_y = ( inPrev.y + v_prev_x / v_prev_len );\r\n\r\n\t\t\tvar ptNextShift_x = ( inNext.x - v_next_y / v_next_len );\r\n\t\t\tvar ptNextShift_y = ( inNext.y + v_next_x / v_next_len );\r\n\r\n\t\t\t// scaling factor for v_prev to intersection point\r\n\r\n\t\t\tvar sf = (  ( ptNextShift_x - ptPrevShift_x ) * v_next_y -\r\n\t\t\t\t\t\t( ptNextShift_y - ptPrevShift_y ) * v_next_x    ) /\r\n\t\t\t\t\t  ( v_prev_x * v_next_y - v_prev_y * v_next_x );\r\n\r\n\t\t\t// vector from inPt to intersection point\r\n\r\n\t\t\tv_trans_x = ( ptPrevShift_x + v_prev_x * sf - inPt.x );\r\n\t\t\tv_trans_y = ( ptPrevShift_y + v_prev_y * sf - inPt.y );\r\n\r\n\t\t\t// Don't normalize!, otherwise sharp corners become ugly\r\n\t\t\t//  but prevent crazy spikes\r\n\t\t\tvar v_trans_lensq = ( v_trans_x * v_trans_x + v_trans_y * v_trans_y );\r\n\t\t\tif ( v_trans_lensq <= 2 ) {\r\n\r\n\t\t\t\treturn\tnew THREE.Vector2( v_trans_x, v_trans_y );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tshrink_by = Math.sqrt( v_trans_lensq / 2 );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// handle special case of collinear edges\r\n\r\n\t\t\tvar direction_eq = false;\t\t// assumes: opposite\r\n\t\t\tif ( v_prev_x > Number.EPSILON ) {\r\n\r\n\t\t\t\tif ( v_next_x > Number.EPSILON ) {\r\n\r\n\t\t\t\t\tdirection_eq = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif ( v_prev_x < - Number.EPSILON ) {\r\n\r\n\t\t\t\t\tif ( v_next_x < - Number.EPSILON ) {\r\n\r\n\t\t\t\t\t\tdirection_eq = true;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tif ( Math.sign( v_prev_y ) === Math.sign( v_next_y ) ) {\r\n\r\n\t\t\t\t\t\tdirection_eq = true;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( direction_eq ) {\r\n\r\n\t\t\t\t// console.log(\"Warning: lines are a straight sequence\");\r\n\t\t\t\tv_trans_x = - v_prev_y;\r\n\t\t\t\tv_trans_y =  v_prev_x;\r\n\t\t\t\tshrink_by = Math.sqrt( v_prev_lensq );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// console.log(\"Warning: lines are a straight spike\");\r\n\t\t\t\tv_trans_x = v_prev_x;\r\n\t\t\t\tv_trans_y = v_prev_y;\r\n\t\t\t\tshrink_by = Math.sqrt( v_prev_lensq / 2 );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn\tnew THREE.Vector2( v_trans_x / shrink_by, v_trans_y / shrink_by );\r\n\r\n\t}\r\n\r\n\r\n\tvar contourMovements = [];\r\n\r\n\tfor ( var i = 0, il = contour.length, j = il - 1, k = i + 1; i < il; i ++, j ++, k ++ ) {\r\n\r\n\t\tif ( j === il ) j = 0;\r\n\t\tif ( k === il ) k = 0;\r\n\r\n\t\t//  (j)---(i)---(k)\r\n\t\t// console.log('i,j,k', i, j , k)\r\n\r\n\t\tcontourMovements[ i ] = getBevelVec( contour[ i ], contour[ j ], contour[ k ] );\r\n\r\n\t}\r\n\r\n\tvar holesMovements = [], oneHoleMovements, verticesMovements = contourMovements.concat();\r\n\r\n\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\tahole = holes[ h ];\r\n\r\n\t\toneHoleMovements = [];\r\n\r\n\t\tfor ( i = 0, il = ahole.length, j = il - 1, k = i + 1; i < il; i ++, j ++, k ++ ) {\r\n\r\n\t\t\tif ( j === il ) j = 0;\r\n\t\t\tif ( k === il ) k = 0;\r\n\r\n\t\t\t//  (j)---(i)---(k)\r\n\t\t\toneHoleMovements[ i ] = getBevelVec( ahole[ i ], ahole[ j ], ahole[ k ] );\r\n\r\n\t\t}\r\n\r\n\t\tholesMovements.push( oneHoleMovements );\r\n\t\tverticesMovements = verticesMovements.concat( oneHoleMovements );\r\n\r\n\t}\r\n\r\n\r\n\t// Loop bevelSegments, 1 for the front, 1 for the back\r\n\r\n\tfor ( b = 0; b < bevelSegments; b ++ ) {\r\n\r\n\t\t//for ( b = bevelSegments; b > 0; b -- ) {\r\n\r\n\t\tt = b / bevelSegments;\r\n\t\tz = bevelThickness * ( 1 - t );\r\n\r\n\t\t//z = bevelThickness * t;\r\n\t\tbs = bevelSize * ( Math.sin ( t * Math.PI / 2 ) ); // curved\r\n\t\t//bs = bevelSize * t; // linear\r\n\r\n\t\t// contract shape\r\n\r\n\t\tfor ( i = 0, il = contour.length; i < il; i ++ ) {\r\n\r\n\t\t\tvert = scalePt2( contour[ i ], contourMovements[ i ], bs );\r\n\r\n\t\t\tv( vert.x, vert.y,  - z );\r\n\r\n\t\t}\r\n\r\n\t\t// expand holes\r\n\r\n\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\t\tahole = holes[ h ];\r\n\t\t\toneHoleMovements = holesMovements[ h ];\r\n\r\n\t\t\tfor ( i = 0, il = ahole.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tvert = scalePt2( ahole[ i ], oneHoleMovements[ i ], bs );\r\n\r\n\t\t\t\tv( vert.x, vert.y,  - z );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tbs = bevelSize;\r\n\r\n\t// Back facing vertices\r\n\r\n\tfor ( i = 0; i < vlen; i ++ ) {\r\n\r\n\t\tvert = bevelEnabled ? scalePt2( vertices[ i ], verticesMovements[ i ], bs ) : vertices[ i ];\r\n\r\n\t\tif ( ! extrudeByPath ) {\r\n\r\n\t\t\tv( vert.x, vert.y, 0 );\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// v( vert.x, vert.y + extrudePts[ 0 ].y, extrudePts[ 0 ].x );\r\n\r\n\t\t\tnormal.copy( splineTube.normals[ 0 ] ).multiplyScalar( vert.x );\r\n\t\t\tbinormal.copy( splineTube.binormals[ 0 ] ).multiplyScalar( vert.y );\r\n\r\n\t\t\tposition2.copy( extrudePts[ 0 ] ).add( normal ).add( binormal );\r\n\r\n\t\t\tv( position2.x, position2.y, position2.z );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// Add stepped vertices...\r\n\t// Including front facing vertices\r\n\r\n\tvar s;\r\n\r\n\tfor ( s = 1; s <= steps; s ++ ) {\r\n\r\n\t\tfor ( i = 0; i < vlen; i ++ ) {\r\n\r\n\t\t\tvert = bevelEnabled ? scalePt2( vertices[ i ], verticesMovements[ i ], bs ) : vertices[ i ];\r\n\r\n\t\t\tif ( ! extrudeByPath ) {\r\n\r\n\t\t\t\tv( vert.x, vert.y, amount / steps * s );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// v( vert.x, vert.y + extrudePts[ s - 1 ].y, extrudePts[ s - 1 ].x );\r\n\r\n\t\t\t\tnormal.copy( splineTube.normals[ s ] ).multiplyScalar( vert.x );\r\n\t\t\t\tbinormal.copy( splineTube.binormals[ s ] ).multiplyScalar( vert.y );\r\n\r\n\t\t\t\tposition2.copy( extrudePts[ s ] ).add( normal ).add( binormal );\r\n\r\n\t\t\t\tv( position2.x, position2.y, position2.z );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\t// Add bevel segments planes\r\n\r\n\t//for ( b = 1; b <= bevelSegments; b ++ ) {\r\n\tfor ( b = bevelSegments - 1; b >= 0; b -- ) {\r\n\r\n\t\tt = b / bevelSegments;\r\n\t\tz = bevelThickness * ( 1 - t );\r\n\t\t//bs = bevelSize * ( 1-Math.sin ( ( 1 - t ) * Math.PI/2 ) );\r\n\t\tbs = bevelSize * Math.sin ( t * Math.PI / 2 );\r\n\r\n\t\t// contract shape\r\n\r\n\t\tfor ( i = 0, il = contour.length; i < il; i ++ ) {\r\n\r\n\t\t\tvert = scalePt2( contour[ i ], contourMovements[ i ], bs );\r\n\t\t\tv( vert.x, vert.y,  amount + z );\r\n\r\n\t\t}\r\n\r\n\t\t// expand holes\r\n\r\n\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\t\tahole = holes[ h ];\r\n\t\t\toneHoleMovements = holesMovements[ h ];\r\n\r\n\t\t\tfor ( i = 0, il = ahole.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tvert = scalePt2( ahole[ i ], oneHoleMovements[ i ], bs );\r\n\r\n\t\t\t\tif ( ! extrudeByPath ) {\r\n\r\n\t\t\t\t\tv( vert.x, vert.y,  amount + z );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tv( vert.x, vert.y + extrudePts[ steps - 1 ].y, extrudePts[ steps - 1 ].x + z );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/* Faces */\r\n\r\n\t// Top and bottom faces\r\n\r\n\tbuildLidFaces();\r\n\r\n\t// Sides faces\r\n\r\n\tbuildSideFaces();\r\n\r\n\r\n\t/////  Internal functions\r\n\r\n\tfunction buildLidFaces() {\r\n\r\n\t\tif ( bevelEnabled ) {\r\n\r\n\t\t\tvar layer = 0; // steps + 1\r\n\t\t\tvar offset = vlen * layer;\r\n\r\n\t\t\t// Bottom faces\r\n\r\n\t\t\tfor ( i = 0; i < flen; i ++ ) {\r\n\r\n\t\t\t\tface = faces[ i ];\r\n\t\t\t\tf3( face[ 2 ] + offset, face[ 1 ] + offset, face[ 0 ] + offset );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tlayer = steps + bevelSegments * 2;\r\n\t\t\toffset = vlen * layer;\r\n\r\n\t\t\t// Top faces\r\n\r\n\t\t\tfor ( i = 0; i < flen; i ++ ) {\r\n\r\n\t\t\t\tface = faces[ i ];\r\n\t\t\t\tf3( face[ 0 ] + offset, face[ 1 ] + offset, face[ 2 ] + offset );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// Bottom faces\r\n\r\n\t\t\tfor ( i = 0; i < flen; i ++ ) {\r\n\r\n\t\t\t\tface = faces[ i ];\r\n\t\t\t\tf3( face[ 2 ], face[ 1 ], face[ 0 ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Top faces\r\n\r\n\t\t\tfor ( i = 0; i < flen; i ++ ) {\r\n\r\n\t\t\t\tface = faces[ i ];\r\n\t\t\t\tf3( face[ 0 ] + vlen * steps, face[ 1 ] + vlen * steps, face[ 2 ] + vlen * steps );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// Create faces for the z-sides of the shape\r\n\r\n\tfunction buildSideFaces() {\r\n\r\n\t\tvar layeroffset = 0;\r\n\t\tsidewalls( contour, layeroffset );\r\n\t\tlayeroffset += contour.length;\r\n\r\n\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\t\tahole = holes[ h ];\r\n\t\t\tsidewalls( ahole, layeroffset );\r\n\r\n\t\t\t//, true\r\n\t\t\tlayeroffset += ahole.length;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction sidewalls( contour, layeroffset ) {\r\n\r\n\t\tvar j, k;\r\n\t\ti = contour.length;\r\n\r\n\t\twhile ( -- i >= 0 ) {\r\n\r\n\t\t\tj = i;\r\n\t\t\tk = i - 1;\r\n\t\t\tif ( k < 0 ) k = contour.length - 1;\r\n\r\n\t\t\t//console.log('b', i,j, i-1, k,vertices.length);\r\n\r\n\t\t\tvar s = 0, sl = steps  + bevelSegments * 2;\r\n\r\n\t\t\tfor ( s = 0; s < sl; s ++ ) {\r\n\r\n\t\t\t\tvar slen1 = vlen * s;\r\n\t\t\t\tvar slen2 = vlen * ( s + 1 );\r\n\r\n\t\t\t\tvar a = layeroffset + j + slen1,\r\n\t\t\t\t\tb = layeroffset + k + slen1,\r\n\t\t\t\t\tc = layeroffset + k + slen2,\r\n\t\t\t\t\td = layeroffset + j + slen2;\r\n\r\n\t\t\t\tf4( a, b, c, d, contour, s, sl, j, k );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\tfunction v( x, y, z ) {\r\n\r\n\t\tscope.vertices.push( new THREE.Vector3( x, y, z ) );\r\n\r\n\t}\r\n\r\n\tfunction f3( a, b, c ) {\r\n\r\n\t\ta += shapesOffset;\r\n\t\tb += shapesOffset;\r\n\t\tc += shapesOffset;\r\n\r\n\t\tscope.faces.push( new THREE.Face3( a, b, c, null, null, 0 ) );\r\n\r\n\t\tvar uvs = uvgen.generateTopUV( scope, a, b, c );\r\n\r\n\t\tscope.faceVertexUvs[ 0 ].push( uvs );\r\n\r\n\t}\r\n\r\n\tfunction f4( a, b, c, d, wallContour, stepIndex, stepsLength, contourIndex1, contourIndex2 ) {\r\n\r\n\t\ta += shapesOffset;\r\n\t\tb += shapesOffset;\r\n\t\tc += shapesOffset;\r\n\t\td += shapesOffset;\r\n\r\n\t\tscope.faces.push( new THREE.Face3( a, b, d, null, null, 1 ) );\r\n\t\tscope.faces.push( new THREE.Face3( b, c, d, null, null, 1 ) );\r\n\r\n\t\tvar uvs = uvgen.generateSideWallUV( scope, a, b, c, d );\r\n\r\n\t\tscope.faceVertexUvs[ 0 ].push( [ uvs[ 0 ], uvs[ 1 ], uvs[ 3 ] ] );\r\n\t\tscope.faceVertexUvs[ 0 ].push( [ uvs[ 1 ], uvs[ 2 ], uvs[ 3 ] ] );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.ExtrudeGeometry.WorldUVGenerator = {\r\n\r\n\tgenerateTopUV: function ( geometry, indexA, indexB, indexC ) {\r\n\r\n\t\tvar vertices = geometry.vertices;\r\n\r\n\t\tvar a = vertices[ indexA ];\r\n\t\tvar b = vertices[ indexB ];\r\n\t\tvar c = vertices[ indexC ];\r\n\r\n\t\treturn [\r\n\t\t\tnew THREE.Vector2( a.x, a.y ),\r\n\t\t\tnew THREE.Vector2( b.x, b.y ),\r\n\t\t\tnew THREE.Vector2( c.x, c.y )\r\n\t\t];\r\n\r\n\t},\r\n\r\n\tgenerateSideWallUV: function ( geometry, indexA, indexB, indexC, indexD ) {\r\n\r\n\t\tvar vertices = geometry.vertices;\r\n\r\n\t\tvar a = vertices[ indexA ];\r\n\t\tvar b = vertices[ indexB ];\r\n\t\tvar c = vertices[ indexC ];\r\n\t\tvar d = vertices[ indexD ];\r\n\r\n\t\tif ( Math.abs( a.y - b.y ) < 0.01 ) {\r\n\r\n\t\t\treturn [\r\n\t\t\t\tnew THREE.Vector2( a.x, 1 - a.z ),\r\n\t\t\t\tnew THREE.Vector2( b.x, 1 - b.z ),\r\n\t\t\t\tnew THREE.Vector2( c.x, 1 - c.z ),\r\n\t\t\t\tnew THREE.Vector2( d.x, 1 - d.z )\r\n\t\t\t];\r\n\r\n\t\t} else {\r\n\r\n\t\t\treturn [\r\n\t\t\t\tnew THREE.Vector2( a.y, 1 - a.z ),\r\n\t\t\t\tnew THREE.Vector2( b.y, 1 - b.z ),\r\n\t\t\t\tnew THREE.Vector2( c.y, 1 - c.z ),\r\n\t\t\t\tnew THREE.Vector2( d.y, 1 - d.z )\r\n\t\t\t];\r\n\r\n\t\t}\r\n\r\n\t}\r\n};\r\n\r\n// File:src/extras/geometries/ShapeGeometry.js\r\n\r\n/**\r\n * @author jonobr1 / http://jonobr1.com\r\n *\r\n * Creates a one-sided polygonal geometry from a path shape. Similar to\r\n * ExtrudeGeometry.\r\n *\r\n * parameters = {\r\n *\r\n *\tcurveSegments: <int>, // number of points on the curves. NOT USED AT THE MOMENT.\r\n *\r\n *\tmaterial: <int> // material index for front and back faces\r\n *\tuvGenerator: <Object> // object that provides UV generator functions\r\n *\r\n * }\r\n **/\r\n\r\nTHREE.ShapeGeometry = function ( shapes, options ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'ShapeGeometry';\r\n\r\n\tif ( Array.isArray( shapes ) === false ) shapes = [ shapes ];\r\n\r\n\tthis.addShapeList( shapes, options );\r\n\r\n\tthis.computeFaceNormals();\r\n\r\n};\r\n\r\nTHREE.ShapeGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.ShapeGeometry.prototype.constructor = THREE.ShapeGeometry;\r\n\r\n/**\r\n * Add an array of shapes to THREE.ShapeGeometry.\r\n */\r\nTHREE.ShapeGeometry.prototype.addShapeList = function ( shapes, options ) {\r\n\r\n\tfor ( var i = 0, l = shapes.length; i < l; i ++ ) {\r\n\r\n\t\tthis.addShape( shapes[ i ], options );\r\n\r\n\t}\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n/**\r\n * Adds a shape to THREE.ShapeGeometry, based on THREE.ExtrudeGeometry.\r\n */\r\nTHREE.ShapeGeometry.prototype.addShape = function ( shape, options ) {\r\n\r\n\tif ( options === undefined ) options = {};\r\n\tvar curveSegments = options.curveSegments !== undefined ? options.curveSegments : 12;\r\n\r\n\tvar material = options.material;\r\n\tvar uvgen = options.UVGenerator === undefined ? THREE.ExtrudeGeometry.WorldUVGenerator : options.UVGenerator;\r\n\r\n\t//\r\n\r\n\tvar i, l, hole;\r\n\r\n\tvar shapesOffset = this.vertices.length;\r\n\tvar shapePoints = shape.extractPoints( curveSegments );\r\n\r\n\tvar vertices = shapePoints.shape;\r\n\tvar holes = shapePoints.holes;\r\n\r\n\tvar reverse = ! THREE.ShapeUtils.isClockWise( vertices );\r\n\r\n\tif ( reverse ) {\r\n\r\n\t\tvertices = vertices.reverse();\r\n\r\n\t\t// Maybe we should also check if holes are in the opposite direction, just to be safe...\r\n\r\n\t\tfor ( i = 0, l = holes.length; i < l; i ++ ) {\r\n\r\n\t\t\thole = holes[ i ];\r\n\r\n\t\t\tif ( THREE.ShapeUtils.isClockWise( hole ) ) {\r\n\r\n\t\t\t\tholes[ i ] = hole.reverse();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treverse = false;\r\n\r\n\t}\r\n\r\n\tvar faces = THREE.ShapeUtils.triangulateShape( vertices, holes );\r\n\r\n\t// Vertices\r\n\r\n\tfor ( i = 0, l = holes.length; i < l; i ++ ) {\r\n\r\n\t\thole = holes[ i ];\r\n\t\tvertices = vertices.concat( hole );\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tvar vert, vlen = vertices.length;\r\n\tvar face, flen = faces.length;\r\n\r\n\tfor ( i = 0; i < vlen; i ++ ) {\r\n\r\n\t\tvert = vertices[ i ];\r\n\r\n\t\tthis.vertices.push( new THREE.Vector3( vert.x, vert.y, 0 ) );\r\n\r\n\t}\r\n\r\n\tfor ( i = 0; i < flen; i ++ ) {\r\n\r\n\t\tface = faces[ i ];\r\n\r\n\t\tvar a = face[ 0 ] + shapesOffset;\r\n\t\tvar b = face[ 1 ] + shapesOffset;\r\n\t\tvar c = face[ 2 ] + shapesOffset;\r\n\r\n\t\tthis.faces.push( new THREE.Face3( a, b, c, null, null, material ) );\r\n\t\tthis.faceVertexUvs[ 0 ].push( uvgen.generateTopUV( this, a, b, c ) );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/extras/geometries/LatheGeometry.js\r\n\r\n/**\r\n * @author astrodud / http://astrodud.isgreat.org/\r\n * @author zz85 / https://github.com/zz85\r\n * @author bhouston / http://clara.io\r\n */\r\n\r\n// points - to create a closed torus, one must use a set of points \r\n//    like so: [ a, b, c, d, a ], see first is the same as last.\r\n// segments - the number of circumference segments to create\r\n// phiStart - the starting radian\r\n// phiLength - the radian (0 to 2*PI) range of the lathed section\r\n//    2*pi is a closed lathe, less than 2PI is a portion.\r\n\r\nTHREE.LatheGeometry = function ( points, segments, phiStart, phiLength ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'LatheGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tpoints: points,\r\n\t\tsegments: segments,\r\n\t\tphiStart: phiStart,\r\n\t\tphiLength: phiLength\r\n\t};\r\n\r\n\tsegments = segments || 12;\r\n\tphiStart = phiStart || 0;\r\n\tphiLength = phiLength || 2 * Math.PI;\r\n\r\n\tvar inversePointLength = 1.0 / ( points.length - 1 );\r\n\tvar inverseSegments = 1.0 / segments;\r\n\r\n\tfor ( var i = 0, il = segments; i <= il; i ++ ) {\r\n\r\n\t\tvar phi = phiStart + i * inverseSegments * phiLength;\r\n\r\n\t\tvar c = Math.cos( phi ),\r\n\t\t\ts = Math.sin( phi );\r\n\r\n\t\tfor ( var j = 0, jl = points.length; j < jl; j ++ ) {\r\n\r\n\t\t\tvar pt = points[ j ];\r\n\r\n\t\t\tvar vertex = new THREE.Vector3();\r\n\r\n\t\t\tvertex.x = c * pt.x - s * pt.y;\r\n\t\t\tvertex.y = s * pt.x + c * pt.y;\r\n\t\t\tvertex.z = pt.z;\r\n\r\n\t\t\tthis.vertices.push( vertex );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tvar np = points.length;\r\n\r\n\tfor ( var i = 0, il = segments; i < il; i ++ ) {\r\n\r\n\t\tfor ( var j = 0, jl = points.length - 1; j < jl; j ++ ) {\r\n\r\n\t\t\tvar base = j + np * i;\r\n\t\t\tvar a = base;\r\n\t\t\tvar b = base + np;\r\n\t\t\tvar c = base + 1 + np;\r\n\t\t\tvar d = base + 1;\r\n\r\n\t\t\tvar u0 = i * inverseSegments;\r\n\t\t\tvar v0 = j * inversePointLength;\r\n\t\t\tvar u1 = u0 + inverseSegments;\r\n\t\t\tvar v1 = v0 + inversePointLength;\r\n\r\n\t\t\tthis.faces.push( new THREE.Face3( a, b, d ) );\r\n\r\n\t\t\tthis.faceVertexUvs[ 0 ].push( [\r\n\r\n\t\t\t\tnew THREE.Vector2( u0, v0 ),\r\n\t\t\t\tnew THREE.Vector2( u1, v0 ),\r\n\t\t\t\tnew THREE.Vector2( u0, v1 )\r\n\r\n\t\t\t] );\r\n\r\n\t\t\tthis.faces.push( new THREE.Face3( b, c, d ) );\r\n\r\n\t\t\tthis.faceVertexUvs[ 0 ].push( [\r\n\r\n\t\t\t\tnew THREE.Vector2( u1, v0 ),\r\n\t\t\t\tnew THREE.Vector2( u1, v1 ),\r\n\t\t\t\tnew THREE.Vector2( u0, v1 )\r\n\r\n\t\t\t] );\r\n\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.mergeVertices();\r\n\tthis.computeFaceNormals();\r\n\tthis.computeVertexNormals();\r\n\r\n};\r\n\r\nTHREE.LatheGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.LatheGeometry.prototype.constructor = THREE.LatheGeometry;\r\n\r\n// File:src/extras/geometries/PlaneGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * based on http://papervision3d.googlecode.com/svn/trunk/as3/trunk/src/org/papervision3d/objects/primitives/Plane.as\r\n */\r\n\r\nTHREE.PlaneGeometry = function ( width, height, widthSegments, heightSegments ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'PlaneGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\twidth: width,\r\n\t\theight: height,\r\n\t\twidthSegments: widthSegments,\r\n\t\theightSegments: heightSegments\r\n\t};\r\n\r\n\tthis.fromBufferGeometry( new THREE.PlaneBufferGeometry( width, height, widthSegments, heightSegments ) );\r\n\r\n};\r\n\r\nTHREE.PlaneGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.PlaneGeometry.prototype.constructor = THREE.PlaneGeometry;\r\n\r\nTHREE.PlaneGeometry.prototype.clone = function () {\r\n\r\n\tvar parameters = this.parameters;\r\n\r\n\treturn new THREE.PlaneGeometry(\r\n\t\tparameters.width,\r\n\t\tparameters.height,\r\n\t\tparameters.widthSegments,\r\n\t\tparameters.heightSegments\r\n\t);\r\n\r\n};\r\n\r\n// File:src/extras/geometries/PlaneBufferGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * based on http://papervision3d.googlecode.com/svn/trunk/as3/trunk/src/org/papervision3d/objects/primitives/Plane.as\r\n */\r\n\r\nTHREE.PlaneBufferGeometry = function ( width, height, widthSegments, heightSegments ) {\r\n\r\n\tTHREE.BufferGeometry.call( this );\r\n\r\n\tthis.type = 'PlaneBufferGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\twidth: width,\r\n\t\theight: height,\r\n\t\twidthSegments: widthSegments,\r\n\t\theightSegments: heightSegments\r\n\t};\r\n\r\n\tvar width_half = width / 2;\r\n\tvar height_half = height / 2;\r\n\r\n\tvar gridX = Math.floor( widthSegments ) || 1;\r\n\tvar gridY = Math.floor( heightSegments ) || 1;\r\n\r\n\tvar gridX1 = gridX + 1;\r\n\tvar gridY1 = gridY + 1;\r\n\r\n\tvar segment_width = width / gridX;\r\n\tvar segment_height = height / gridY;\r\n\r\n\tvar vertices = new Float32Array( gridX1 * gridY1 * 3 );\r\n\tvar normals = new Float32Array( gridX1 * gridY1 * 3 );\r\n\tvar uvs = new Float32Array( gridX1 * gridY1 * 2 );\r\n\r\n\tvar offset = 0;\r\n\tvar offset2 = 0;\r\n\r\n\tfor ( var iy = 0; iy < gridY1; iy ++ ) {\r\n\r\n\t\tvar y = iy * segment_height - height_half;\r\n\r\n\t\tfor ( var ix = 0; ix < gridX1; ix ++ ) {\r\n\r\n\t\t\tvar x = ix * segment_width - width_half;\r\n\r\n\t\t\tvertices[ offset ] = x;\r\n\t\t\tvertices[ offset + 1 ] = - y;\r\n\r\n\t\t\tnormals[ offset + 2 ] = 1;\r\n\r\n\t\t\tuvs[ offset2 ] = ix / gridX;\r\n\t\t\tuvs[ offset2 + 1 ] = 1 - ( iy / gridY );\r\n\r\n\t\t\toffset += 3;\r\n\t\t\toffset2 += 2;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\toffset = 0;\r\n\r\n\tvar indices = new ( ( vertices.length / 3 ) > 65535 ? Uint32Array : Uint16Array )( gridX * gridY * 6 );\r\n\r\n\tfor ( var iy = 0; iy < gridY; iy ++ ) {\r\n\r\n\t\tfor ( var ix = 0; ix < gridX; ix ++ ) {\r\n\r\n\t\t\tvar a = ix + gridX1 * iy;\r\n\t\t\tvar b = ix + gridX1 * ( iy + 1 );\r\n\t\t\tvar c = ( ix + 1 ) + gridX1 * ( iy + 1 );\r\n\t\t\tvar d = ( ix + 1 ) + gridX1 * iy;\r\n\r\n\t\t\tindices[ offset ] = a;\r\n\t\t\tindices[ offset + 1 ] = b;\r\n\t\t\tindices[ offset + 2 ] = d;\r\n\r\n\t\t\tindices[ offset + 3 ] = b;\r\n\t\t\tindices[ offset + 4 ] = c;\r\n\t\t\tindices[ offset + 5 ] = d;\r\n\r\n\t\t\toffset += 6;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.setIndex( new THREE.BufferAttribute( indices, 1 ) );\r\n\tthis.addAttribute( 'position', new THREE.BufferAttribute( vertices, 3 ) );\r\n\tthis.addAttribute( 'normal', new THREE.BufferAttribute( normals, 3 ) );\r\n\tthis.addAttribute( 'uv', new THREE.BufferAttribute( uvs, 2 ) );\r\n\r\n};\r\n\r\nTHREE.PlaneBufferGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\r\nTHREE.PlaneBufferGeometry.prototype.constructor = THREE.PlaneBufferGeometry;\r\n\r\nTHREE.PlaneBufferGeometry.prototype.clone = function () {\r\n\r\n\tvar parameters = this.parameters;\r\n\r\n\treturn new THREE.PlaneBufferGeometry(\r\n\t\tparameters.width,\r\n\t\tparameters.height,\r\n\t\tparameters.widthSegments,\r\n\t\tparameters.heightSegments\r\n\t);\r\n\r\n};\r\n\r\n// File:src/extras/geometries/RingGeometry.js\r\n\r\n/**\r\n * @author Kaleb Murphy\r\n */\r\n\r\nTHREE.RingGeometry = function ( innerRadius, outerRadius, thetaSegments, phiSegments, thetaStart, thetaLength ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'RingGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tinnerRadius: innerRadius,\r\n\t\touterRadius: outerRadius,\r\n\t\tthetaSegments: thetaSegments,\r\n\t\tphiSegments: phiSegments,\r\n\t\tthetaStart: thetaStart,\r\n\t\tthetaLength: thetaLength\r\n\t};\r\n\r\n\tinnerRadius = innerRadius || 0;\r\n\touterRadius = outerRadius || 50;\r\n\r\n\tthetaStart = thetaStart !== undefined ? thetaStart : 0;\r\n\tthetaLength = thetaLength !== undefined ? thetaLength : Math.PI * 2;\r\n\r\n\tthetaSegments = thetaSegments !== undefined ? Math.max( 3, thetaSegments ) : 8;\r\n\tphiSegments = phiSegments !== undefined ? Math.max( 1, phiSegments ) : 8;\r\n\r\n\tvar i, o, uvs = [], radius = innerRadius, radiusStep = ( ( outerRadius - innerRadius ) / phiSegments );\r\n\r\n\tfor ( i = 0; i < phiSegments + 1; i ++ ) {\r\n\r\n\t\t// concentric circles inside ring\r\n\r\n\t\tfor ( o = 0; o < thetaSegments + 1; o ++ ) {\r\n\r\n\t\t\t// number of segments per circle\r\n\r\n\t\t\tvar vertex = new THREE.Vector3();\r\n\t\t\tvar segment = thetaStart + o / thetaSegments * thetaLength;\r\n\t\t\tvertex.x = radius * Math.cos( segment );\r\n\t\t\tvertex.y = radius * Math.sin( segment );\r\n\r\n\t\t\tthis.vertices.push( vertex );\r\n\t\t\tuvs.push( new THREE.Vector2( ( vertex.x / outerRadius + 1 ) / 2, ( vertex.y / outerRadius + 1 ) / 2 ) );\r\n\r\n\t\t}\r\n\r\n\t\tradius += radiusStep;\r\n\r\n\t}\r\n\r\n\tvar n = new THREE.Vector3( 0, 0, 1 );\r\n\r\n\tfor ( i = 0; i < phiSegments; i ++ ) {\r\n\r\n\t\t// concentric circles inside ring\r\n\r\n\t\tvar thetaSegment = i * ( thetaSegments + 1 );\r\n\r\n\t\tfor ( o = 0; o < thetaSegments ; o ++ ) {\r\n\r\n\t\t\t// number of segments per circle\r\n\r\n\t\t\tvar segment = o + thetaSegment;\r\n\r\n\t\t\tvar v1 = segment;\r\n\t\t\tvar v2 = segment + thetaSegments + 1;\r\n\t\t\tvar v3 = segment + thetaSegments + 2;\r\n\r\n\t\t\tthis.faces.push( new THREE.Face3( v1, v2, v3, [ n.clone(), n.clone(), n.clone() ] ) );\r\n\t\t\tthis.faceVertexUvs[ 0 ].push( [ uvs[ v1 ].clone(), uvs[ v2 ].clone(), uvs[ v3 ].clone() ] );\r\n\r\n\t\t\tv1 = segment;\r\n\t\t\tv2 = segment + thetaSegments + 2;\r\n\t\t\tv3 = segment + 1;\r\n\r\n\t\t\tthis.faces.push( new THREE.Face3( v1, v2, v3, [ n.clone(), n.clone(), n.clone() ] ) );\r\n\t\t\tthis.faceVertexUvs[ 0 ].push( [ uvs[ v1 ].clone(), uvs[ v2 ].clone(), uvs[ v3 ].clone() ] );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.computeFaceNormals();\r\n\r\n\tthis.boundingSphere = new THREE.Sphere( new THREE.Vector3(), radius );\r\n\r\n};\r\n\r\nTHREE.RingGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.RingGeometry.prototype.constructor = THREE.RingGeometry;\r\n\r\nTHREE.RingGeometry.prototype.clone = function () {\r\n\r\n\tvar parameters = this.parameters;\r\n\r\n\treturn new THREE.RingGeometry(\r\n\t\tparameters.innerRadius,\r\n\t\tparameters.outerRadius,\r\n\t\tparameters.thetaSegments,\r\n\t\tparameters.phiSegments,\r\n\t\tparameters.thetaStart,\r\n\t\tparameters.thetaLength\r\n\t);\r\n\r\n};\r\n\r\n// File:src/extras/geometries/SphereGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.SphereGeometry = function ( radius, widthSegments, heightSegments, phiStart, phiLength, thetaStart, thetaLength ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'SphereGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\twidthSegments: widthSegments,\r\n\t\theightSegments: heightSegments,\r\n\t\tphiStart: phiStart,\r\n\t\tphiLength: phiLength,\r\n\t\tthetaStart: thetaStart,\r\n\t\tthetaLength: thetaLength\r\n\t};\r\n\r\n\tthis.fromBufferGeometry( new THREE.SphereBufferGeometry( radius, widthSegments, heightSegments, phiStart, phiLength, thetaStart, thetaLength ) );\r\n\r\n};\r\n\r\nTHREE.SphereGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.SphereGeometry.prototype.constructor = THREE.SphereGeometry;\r\n\r\nTHREE.SphereGeometry.prototype.clone = function () {\r\n\r\n\tvar parameters = this.parameters;\r\n\r\n\treturn new THREE.SphereGeometry(\r\n\t\tparameters.radius,\r\n\t\tparameters.widthSegments,\r\n\t\tparameters.heightSegments,\r\n\t\tparameters.phiStart,\r\n\t\tparameters.phiLength,\r\n\t\tparameters.thetaStart,\r\n\t\tparameters.thetaLength\r\n\t);\r\n\r\n};\r\n\r\n// File:src/extras/geometries/SphereBufferGeometry.js\r\n\r\n/**\r\n * @author benaadams / https://twitter.com/ben_a_adams\r\n * based on THREE.SphereGeometry\r\n */\r\n\r\nTHREE.SphereBufferGeometry = function ( radius, widthSegments, heightSegments, phiStart, phiLength, thetaStart, thetaLength ) {\r\n\r\n\tTHREE.BufferGeometry.call( this );\r\n\r\n\tthis.type = 'SphereBufferGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\twidthSegments: widthSegments,\r\n\t\theightSegments: heightSegments,\r\n\t\tphiStart: phiStart,\r\n\t\tphiLength: phiLength,\r\n\t\tthetaStart: thetaStart,\r\n\t\tthetaLength: thetaLength\r\n\t};\r\n\r\n\tradius = radius || 50;\r\n\r\n\twidthSegments = Math.max( 3, Math.floor( widthSegments ) || 8 );\r\n\theightSegments = Math.max( 2, Math.floor( heightSegments ) || 6 );\r\n\r\n\tphiStart = phiStart !== undefined ? phiStart : 0;\r\n\tphiLength = phiLength !== undefined ? phiLength : Math.PI * 2;\r\n\r\n\tthetaStart = thetaStart !== undefined ? thetaStart : 0;\r\n\tthetaLength = thetaLength !== undefined ? thetaLength : Math.PI;\r\n\r\n\tvar thetaEnd = thetaStart + thetaLength;\r\n\r\n\tvar vertexCount = ( ( widthSegments + 1 ) * ( heightSegments + 1 ) );\r\n\r\n\tvar positions = new THREE.BufferAttribute( new Float32Array( vertexCount * 3 ), 3 );\r\n\tvar normals = new THREE.BufferAttribute( new Float32Array( vertexCount * 3 ), 3 );\r\n\tvar uvs = new THREE.BufferAttribute( new Float32Array( vertexCount * 2 ), 2 );\r\n\r\n\tvar index = 0, vertices = [], normal = new THREE.Vector3();\r\n\r\n\tfor ( var y = 0; y <= heightSegments; y ++ ) {\r\n\r\n\t\tvar verticesRow = [];\r\n\r\n\t\tvar v = y / heightSegments;\r\n\r\n\t\tfor ( var x = 0; x <= widthSegments; x ++ ) {\r\n\r\n\t\t\tvar u = x / widthSegments;\r\n\r\n\t\t\tvar px = - radius * Math.cos( phiStart + u * phiLength ) * Math.sin( thetaStart + v * thetaLength );\r\n\t\t\tvar py = radius * Math.cos( thetaStart + v * thetaLength );\r\n\t\t\tvar pz = radius * Math.sin( phiStart + u * phiLength ) * Math.sin( thetaStart + v * thetaLength );\r\n\r\n\t\t\tnormal.set( px, py, pz ).normalize();\r\n\r\n\t\t\tpositions.setXYZ( index, px, py, pz );\r\n\t\t\tnormals.setXYZ( index, normal.x, normal.y, normal.z );\r\n\t\t\tuvs.setXY( index, u, 1 - v );\r\n\r\n\t\t\tverticesRow.push( index );\r\n\r\n\t\t\tindex ++;\r\n\r\n\t\t}\r\n\r\n\t\tvertices.push( verticesRow );\r\n\r\n\t}\r\n\r\n\tvar indices = [];\r\n\r\n\tfor ( var y = 0; y < heightSegments; y ++ ) {\r\n\r\n\t\tfor ( var x = 0; x < widthSegments; x ++ ) {\r\n\r\n\t\t\tvar v1 = vertices[ y ][ x + 1 ];\r\n\t\t\tvar v2 = vertices[ y ][ x ];\r\n\t\t\tvar v3 = vertices[ y + 1 ][ x ];\r\n\t\t\tvar v4 = vertices[ y + 1 ][ x + 1 ];\r\n\r\n\t\t\tif ( y !== 0 || thetaStart > 0 ) indices.push( v1, v2, v4 );\r\n\t\t\tif ( y !== heightSegments - 1 || thetaEnd < Math.PI ) indices.push( v2, v3, v4 );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.setIndex( new ( positions.count > 65535 ? THREE.Uint32Attribute : THREE.Uint16Attribute )( indices, 1 ) );\r\n\tthis.addAttribute( 'position', positions );\r\n\tthis.addAttribute( 'normal', normals );\r\n\tthis.addAttribute( 'uv', uvs );\r\n\r\n\tthis.boundingSphere = new THREE.Sphere( new THREE.Vector3(), radius );\r\n\r\n};\r\n\r\nTHREE.SphereBufferGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\r\nTHREE.SphereBufferGeometry.prototype.constructor = THREE.SphereBufferGeometry;\r\n\r\nTHREE.SphereBufferGeometry.prototype.clone = function () {\r\n\r\n\tvar parameters = this.parameters;\r\n\r\n\treturn new THREE.SphereBufferGeometry(\r\n\t\tparameters.radius,\r\n\t\tparameters.widthSegments,\r\n\t\tparameters.heightSegments,\r\n\t\tparameters.phiStart,\r\n\t\tparameters.phiLength,\r\n\t\tparameters.thetaStart,\r\n\t\tparameters.thetaLength\r\n\t);\r\n\r\n};\r\n\r\n// File:src/extras/geometries/TorusGeometry.js\r\n\r\n/**\r\n * @author oosmoxiecode\r\n * @author mrdoob / http://mrdoob.com/\r\n * based on http://code.google.com/p/away3d/source/browse/trunk/fp10/Away3DLite/src/away3dlite/primitives/Torus.as?r=2888\r\n */\r\n\r\nTHREE.TorusGeometry = function ( radius, tube, radialSegments, tubularSegments, arc ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'TorusGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\ttube: tube,\r\n\t\tradialSegments: radialSegments,\r\n\t\ttubularSegments: tubularSegments,\r\n\t\tarc: arc\r\n\t};\r\n\r\n\tradius = radius || 100;\r\n\ttube = tube || 40;\r\n\tradialSegments = radialSegments || 8;\r\n\ttubularSegments = tubularSegments || 6;\r\n\tarc = arc || Math.PI * 2;\r\n\r\n\tvar center = new THREE.Vector3(), uvs = [], normals = [];\r\n\r\n\tfor ( var j = 0; j <= radialSegments; j ++ ) {\r\n\r\n\t\tfor ( var i = 0; i <= tubularSegments; i ++ ) {\r\n\r\n\t\t\tvar u = i / tubularSegments * arc;\r\n\t\t\tvar v = j / radialSegments * Math.PI * 2;\r\n\r\n\t\t\tcenter.x = radius * Math.cos( u );\r\n\t\t\tcenter.y = radius * Math.sin( u );\r\n\r\n\t\t\tvar vertex = new THREE.Vector3();\r\n\t\t\tvertex.x = ( radius + tube * Math.cos( v ) ) * Math.cos( u );\r\n\t\t\tvertex.y = ( radius + tube * Math.cos( v ) ) * Math.sin( u );\r\n\t\t\tvertex.z = tube * Math.sin( v );\r\n\r\n\t\t\tthis.vertices.push( vertex );\r\n\r\n\t\t\tuvs.push( new THREE.Vector2( i / tubularSegments, j / radialSegments ) );\r\n\t\t\tnormals.push( vertex.clone().sub( center ).normalize() );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfor ( var j = 1; j <= radialSegments; j ++ ) {\r\n\r\n\t\tfor ( var i = 1; i <= tubularSegments; i ++ ) {\r\n\r\n\t\t\tvar a = ( tubularSegments + 1 ) * j + i - 1;\r\n\t\t\tvar b = ( tubularSegments + 1 ) * ( j - 1 ) + i - 1;\r\n\t\t\tvar c = ( tubularSegments + 1 ) * ( j - 1 ) + i;\r\n\t\t\tvar d = ( tubularSegments + 1 ) * j + i;\r\n\r\n\t\t\tvar face = new THREE.Face3( a, b, d, [ normals[ a ].clone(), normals[ b ].clone(), normals[ d ].clone() ] );\r\n\t\t\tthis.faces.push( face );\r\n\t\t\tthis.faceVertexUvs[ 0 ].push( [ uvs[ a ].clone(), uvs[ b ].clone(), uvs[ d ].clone() ] );\r\n\r\n\t\t\tface = new THREE.Face3( b, c, d, [ normals[ b ].clone(), normals[ c ].clone(), normals[ d ].clone() ] );\r\n\t\t\tthis.faces.push( face );\r\n\t\t\tthis.faceVertexUvs[ 0 ].push( [ uvs[ b ].clone(), uvs[ c ].clone(), uvs[ d ].clone() ] );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.computeFaceNormals();\r\n\r\n};\r\n\r\nTHREE.TorusGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.TorusGeometry.prototype.constructor = THREE.TorusGeometry;\r\n\r\nTHREE.TorusGeometry.prototype.clone = function () {\r\n\r\n\tvar parameters = this.parameters;\r\n\r\n\treturn new THREE.TorusGeometry(\r\n\t\tparameters.radius,\r\n\t\tparameters.tube,\r\n\t\tparameters.radialSegments,\r\n\t\tparameters.tubularSegments,\r\n\t\tparameters.arc\r\n\t);\r\n\r\n};\r\n\r\n// File:src/extras/geometries/TorusKnotGeometry.js\r\n\r\n/**\r\n * @author oosmoxiecode\r\n * based on http://code.google.com/p/away3d/source/browse/trunk/fp10/Away3D/src/away3d/primitives/TorusKnot.as?spec=svn2473&r=2473\r\n */\r\n\r\nTHREE.TorusKnotGeometry = function ( radius, tube, radialSegments, tubularSegments, p, q, heightScale ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'TorusKnotGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\ttube: tube,\r\n\t\tradialSegments: radialSegments,\r\n\t\ttubularSegments: tubularSegments,\r\n\t\tp: p,\r\n\t\tq: q,\r\n\t\theightScale: heightScale\r\n\t};\r\n\r\n\tradius = radius || 100;\r\n\ttube = tube || 40;\r\n\tradialSegments = radialSegments || 64;\r\n\ttubularSegments = tubularSegments || 8;\r\n\tp = p || 2;\r\n\tq = q || 3;\r\n\theightScale = heightScale || 1;\r\n\r\n\tvar grid = new Array( radialSegments );\r\n\tvar tang = new THREE.Vector3();\r\n\tvar n = new THREE.Vector3();\r\n\tvar bitan = new THREE.Vector3();\r\n\r\n\tfor ( var i = 0; i < radialSegments; ++ i ) {\r\n\r\n\t\tgrid[ i ] = new Array( tubularSegments );\r\n\t\tvar u = i / radialSegments * 2 * p * Math.PI;\r\n\t\tvar p1 = getPos( u, q, p, radius, heightScale );\r\n\t\tvar p2 = getPos( u + 0.01, q, p, radius, heightScale );\r\n\t\ttang.subVectors( p2, p1 );\r\n\t\tn.addVectors( p2, p1 );\r\n\r\n\t\tbitan.crossVectors( tang, n );\r\n\t\tn.crossVectors( bitan, tang );\r\n\t\tbitan.normalize();\r\n\t\tn.normalize();\r\n\r\n\t\tfor ( var j = 0; j < tubularSegments; ++ j ) {\r\n\r\n\t\t\tvar v = j / tubularSegments * 2 * Math.PI;\r\n\t\t\tvar cx = - tube * Math.cos( v ); // TODO: Hack: Negating it so it faces outside.\r\n\t\t\tvar cy = tube * Math.sin( v );\r\n\r\n\t\t\tvar pos = new THREE.Vector3();\r\n\t\t\tpos.x = p1.x + cx * n.x + cy * bitan.x;\r\n\t\t\tpos.y = p1.y + cx * n.y + cy * bitan.y;\r\n\t\t\tpos.z = p1.z + cx * n.z + cy * bitan.z;\r\n\r\n\t\t\tgrid[ i ][ j ] = this.vertices.push( pos ) - 1;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfor ( var i = 0; i < radialSegments; ++ i ) {\r\n\r\n\t\tfor ( var j = 0; j < tubularSegments; ++ j ) {\r\n\r\n\t\t\tvar ip = ( i + 1 ) % radialSegments;\r\n\t\t\tvar jp = ( j + 1 ) % tubularSegments;\r\n\r\n\t\t\tvar a = grid[ i ][ j ];\r\n\t\t\tvar b = grid[ ip ][ j ];\r\n\t\t\tvar c = grid[ ip ][ jp ];\r\n\t\t\tvar d = grid[ i ][ jp ];\r\n\r\n\t\t\tvar uva = new THREE.Vector2( i / radialSegments, j / tubularSegments );\r\n\t\t\tvar uvb = new THREE.Vector2( ( i + 1 ) / radialSegments, j / tubularSegments );\r\n\t\t\tvar uvc = new THREE.Vector2( ( i + 1 ) / radialSegments, ( j + 1 ) / tubularSegments );\r\n\t\t\tvar uvd = new THREE.Vector2( i / radialSegments, ( j + 1 ) / tubularSegments );\r\n\r\n\t\t\tthis.faces.push( new THREE.Face3( a, b, d ) );\r\n\t\t\tthis.faceVertexUvs[ 0 ].push( [ uva, uvb, uvd ] );\r\n\r\n\t\t\tthis.faces.push( new THREE.Face3( b, c, d ) );\r\n\t\t\tthis.faceVertexUvs[ 0 ].push( [ uvb.clone(), uvc, uvd.clone() ] );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.computeFaceNormals();\r\n\tthis.computeVertexNormals();\r\n\r\n\tfunction getPos( u, in_q, in_p, radius, heightScale ) {\r\n\r\n\t\tvar cu = Math.cos( u );\r\n\t\tvar su = Math.sin( u );\r\n\t\tvar quOverP = in_q / in_p * u;\r\n\t\tvar cs = Math.cos( quOverP );\r\n\r\n\t\tvar tx = radius * ( 2 + cs ) * 0.5 * cu;\r\n\t\tvar ty = radius * ( 2 + cs ) * su * 0.5;\r\n\t\tvar tz = heightScale * radius * Math.sin( quOverP ) * 0.5;\r\n\r\n\t\treturn new THREE.Vector3( tx, ty, tz );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.TorusKnotGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.TorusKnotGeometry.prototype.constructor = THREE.TorusKnotGeometry;\r\n\r\nTHREE.TorusKnotGeometry.prototype.clone = function () {\r\n\r\n\tvar parameters = this.parameters;\r\n\r\n\treturn new THREE.TorusKnotGeometry(\r\n\t\tparameters.radius,\r\n\t\tparameters.tube,\r\n\t\tparameters.radialSegments,\r\n\t\tparameters.tubularSegments,\r\n\t\tparameters.p,\r\n\t\tparameters.q,\r\n\t\tparameters.heightScale\r\n\t);\r\n\r\n};\r\n\r\n// File:src/extras/geometries/TubeGeometry.js\r\n\r\n/**\r\n * @author WestLangley / https://github.com/WestLangley\r\n * @author zz85 / https://github.com/zz85\r\n * @author miningold / https://github.com/miningold\r\n * @author jonobr1 / https://github.com/jonobr1\r\n *\r\n * Modified from the TorusKnotGeometry by @oosmoxiecode\r\n *\r\n * Creates a tube which extrudes along a 3d spline\r\n *\r\n * Uses parallel transport frames as described in\r\n * http://www.cs.indiana.edu/pub/techreports/TR425.pdf\r\n */\r\n\r\nTHREE.TubeGeometry = function ( path, segments, radius, radialSegments, closed, taper ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'TubeGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tpath: path,\r\n\t\tsegments: segments,\r\n\t\tradius: radius,\r\n\t\tradialSegments: radialSegments,\r\n\t\tclosed: closed,\r\n\t\ttaper: taper\r\n\t};\r\n\r\n\tsegments = segments || 64;\r\n\tradius = radius || 1;\r\n\tradialSegments = radialSegments || 8;\r\n\tclosed = closed || false;\r\n\ttaper = taper || THREE.TubeGeometry.NoTaper;\r\n\r\n\tvar grid = [];\r\n\r\n\tvar scope = this,\r\n\r\n\t\ttangent,\r\n\t\tnormal,\r\n\t\tbinormal,\r\n\r\n\t\tnumpoints = segments + 1,\r\n\r\n\t\tu, v, r,\r\n\r\n\t\tcx, cy,\r\n\t\tpos, pos2 = new THREE.Vector3(),\r\n\t\ti, j,\r\n\t\tip, jp,\r\n\t\ta, b, c, d,\r\n\t\tuva, uvb, uvc, uvd;\r\n\r\n\tvar frames = new THREE.TubeGeometry.FrenetFrames( path, segments, closed ),\r\n\t\ttangents = frames.tangents,\r\n\t\tnormals = frames.normals,\r\n\t\tbinormals = frames.binormals;\r\n\r\n\t// proxy internals\r\n\tthis.tangents = tangents;\r\n\tthis.normals = normals;\r\n\tthis.binormals = binormals;\r\n\r\n\tfunction vert( x, y, z ) {\r\n\r\n\t\treturn scope.vertices.push( new THREE.Vector3( x, y, z ) ) - 1;\r\n\r\n\t}\r\n\r\n\t// construct the grid\r\n\r\n\tfor ( i = 0; i < numpoints; i ++ ) {\r\n\r\n\t\tgrid[ i ] = [];\r\n\r\n\t\tu = i / ( numpoints - 1 );\r\n\r\n\t\tpos = path.getPointAt( u );\r\n\r\n\t\ttangent = tangents[ i ];\r\n\t\tnormal = normals[ i ];\r\n\t\tbinormal = binormals[ i ];\r\n\r\n\t\tr = radius * taper( u );\r\n\r\n\t\tfor ( j = 0; j < radialSegments; j ++ ) {\r\n\r\n\t\t\tv = j / radialSegments * 2 * Math.PI;\r\n\r\n\t\t\tcx = - r * Math.cos( v ); // TODO: Hack: Negating it so it faces outside.\r\n\t\t\tcy = r * Math.sin( v );\r\n\r\n\t\t\tpos2.copy( pos );\r\n\t\t\tpos2.x += cx * normal.x + cy * binormal.x;\r\n\t\t\tpos2.y += cx * normal.y + cy * binormal.y;\r\n\t\t\tpos2.z += cx * normal.z + cy * binormal.z;\r\n\r\n\t\t\tgrid[ i ][ j ] = vert( pos2.x, pos2.y, pos2.z );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\t// construct the mesh\r\n\r\n\tfor ( i = 0; i < segments; i ++ ) {\r\n\r\n\t\tfor ( j = 0; j < radialSegments; j ++ ) {\r\n\r\n\t\t\tip = ( closed ) ? ( i + 1 ) % segments : i + 1;\r\n\t\t\tjp = ( j + 1 ) % radialSegments;\r\n\r\n\t\t\ta = grid[ i ][ j ];\t\t// *** NOT NECESSARILY PLANAR ! ***\r\n\t\t\tb = grid[ ip ][ j ];\r\n\t\t\tc = grid[ ip ][ jp ];\r\n\t\t\td = grid[ i ][ jp ];\r\n\r\n\t\t\tuva = new THREE.Vector2( i / segments, j / radialSegments );\r\n\t\t\tuvb = new THREE.Vector2( ( i + 1 ) / segments, j / radialSegments );\r\n\t\t\tuvc = new THREE.Vector2( ( i + 1 ) / segments, ( j + 1 ) / radialSegments );\r\n\t\t\tuvd = new THREE.Vector2( i / segments, ( j + 1 ) / radialSegments );\r\n\r\n\t\t\tthis.faces.push( new THREE.Face3( a, b, d ) );\r\n\t\t\tthis.faceVertexUvs[ 0 ].push( [ uva, uvb, uvd ] );\r\n\r\n\t\t\tthis.faces.push( new THREE.Face3( b, c, d ) );\r\n\t\t\tthis.faceVertexUvs[ 0 ].push( [ uvb.clone(), uvc, uvd.clone() ] );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.computeFaceNormals();\r\n\tthis.computeVertexNormals();\r\n\r\n};\r\n\r\nTHREE.TubeGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.TubeGeometry.prototype.constructor = THREE.TubeGeometry;\r\nTHREE.TubeGeometry.prototype.clone = function() {\r\n\r\n\treturn new this.constructor( this.parameters.path,\r\n\t\tthis.parameters.segments, this.parameters.radius, this.parameters.radialSegments,\r\n\t\tthis.parameters.closed, this.parameters.taper\r\n\t);\r\n\r\n};\r\n\r\nTHREE.TubeGeometry.NoTaper = function ( u ) {\r\n\r\n\treturn 1;\r\n\r\n};\r\n\r\nTHREE.TubeGeometry.SinusoidalTaper = function ( u ) {\r\n\r\n\treturn Math.sin( Math.PI * u );\r\n\r\n};\r\n\r\n// For computing of Frenet frames, exposing the tangents, normals and binormals the spline\r\nTHREE.TubeGeometry.FrenetFrames = function ( path, segments, closed ) {\r\n\r\n\tvar\tnormal = new THREE.Vector3(),\r\n\r\n\t\ttangents = [],\r\n\t\tnormals = [],\r\n\t\tbinormals = [],\r\n\r\n\t\tvec = new THREE.Vector3(),\r\n\t\tmat = new THREE.Matrix4(),\r\n\r\n\t\tnumpoints = segments + 1,\r\n\t\ttheta,\r\n\t\tsmallest,\r\n\r\n\t\ttx, ty, tz,\r\n\t\ti, u;\r\n\r\n\r\n\t// expose internals\r\n\tthis.tangents = tangents;\r\n\tthis.normals = normals;\r\n\tthis.binormals = binormals;\r\n\r\n\t// compute the tangent vectors for each segment on the path\r\n\r\n\tfor ( i = 0; i < numpoints; i ++ ) {\r\n\r\n\t\tu = i / ( numpoints - 1 );\r\n\r\n\t\ttangents[ i ] = path.getTangentAt( u );\r\n\t\ttangents[ i ].normalize();\r\n\r\n\t}\r\n\r\n\tinitialNormal3();\r\n\r\n\t/*\r\n\tfunction initialNormal1(lastBinormal) {\r\n\t\t// fixed start binormal. Has dangers of 0 vectors\r\n\t\tnormals[ 0 ] = new THREE.Vector3();\r\n\t\tbinormals[ 0 ] = new THREE.Vector3();\r\n\t\tif (lastBinormal===undefined) lastBinormal = new THREE.Vector3( 0, 0, 1 );\r\n\t\tnormals[ 0 ].crossVectors( lastBinormal, tangents[ 0 ] ).normalize();\r\n\t\tbinormals[ 0 ].crossVectors( tangents[ 0 ], normals[ 0 ] ).normalize();\r\n\t}\r\n\r\n\tfunction initialNormal2() {\r\n\r\n\t\t// This uses the Frenet-Serret formula for deriving binormal\r\n\t\tvar t2 = path.getTangentAt( epsilon );\r\n\r\n\t\tnormals[ 0 ] = new THREE.Vector3().subVectors( t2, tangents[ 0 ] ).normalize();\r\n\t\tbinormals[ 0 ] = new THREE.Vector3().crossVectors( tangents[ 0 ], normals[ 0 ] );\r\n\r\n\t\tnormals[ 0 ].crossVectors( binormals[ 0 ], tangents[ 0 ] ).normalize(); // last binormal x tangent\r\n\t\tbinormals[ 0 ].crossVectors( tangents[ 0 ], normals[ 0 ] ).normalize();\r\n\r\n\t}\r\n\t*/\r\n\r\n\tfunction initialNormal3() {\r\n\r\n\t\t// select an initial normal vector perpendicular to the first tangent vector,\r\n\t\t// and in the direction of the smallest tangent xyz component\r\n\r\n\t\tnormals[ 0 ] = new THREE.Vector3();\r\n\t\tbinormals[ 0 ] = new THREE.Vector3();\r\n\t\tsmallest = Number.MAX_VALUE;\r\n\t\ttx = Math.abs( tangents[ 0 ].x );\r\n\t\tty = Math.abs( tangents[ 0 ].y );\r\n\t\ttz = Math.abs( tangents[ 0 ].z );\r\n\r\n\t\tif ( tx <= smallest ) {\r\n\r\n\t\t\tsmallest = tx;\r\n\t\t\tnormal.set( 1, 0, 0 );\r\n\r\n\t\t}\r\n\r\n\t\tif ( ty <= smallest ) {\r\n\r\n\t\t\tsmallest = ty;\r\n\t\t\tnormal.set( 0, 1, 0 );\r\n\r\n\t\t}\r\n\r\n\t\tif ( tz <= smallest ) {\r\n\r\n\t\t\tnormal.set( 0, 0, 1 );\r\n\r\n\t\t}\r\n\r\n\t\tvec.crossVectors( tangents[ 0 ], normal ).normalize();\r\n\r\n\t\tnormals[ 0 ].crossVectors( tangents[ 0 ], vec );\r\n\t\tbinormals[ 0 ].crossVectors( tangents[ 0 ], normals[ 0 ] );\r\n\r\n\t}\r\n\r\n\r\n\t// compute the slowly-varying normal and binormal vectors for each segment on the path\r\n\r\n\tfor ( i = 1; i < numpoints; i ++ ) {\r\n\r\n\t\tnormals[ i ] = normals[ i - 1 ].clone();\r\n\r\n\t\tbinormals[ i ] = binormals[ i - 1 ].clone();\r\n\r\n\t\tvec.crossVectors( tangents[ i - 1 ], tangents[ i ] );\r\n\r\n\t\tif ( vec.length() > Number.EPSILON ) {\r\n\r\n\t\t\tvec.normalize();\r\n\r\n\t\t\ttheta = Math.acos( THREE.Math.clamp( tangents[ i - 1 ].dot( tangents[ i ] ), - 1, 1 ) ); // clamp for floating pt errors\r\n\r\n\t\t\tnormals[ i ].applyMatrix4( mat.makeRotationAxis( vec, theta ) );\r\n\r\n\t\t}\r\n\r\n\t\tbinormals[ i ].crossVectors( tangents[ i ], normals[ i ] );\r\n\r\n\t}\r\n\r\n\r\n\t// if the curve is closed, postprocess the vectors so the first and last normal vectors are the same\r\n\r\n\tif ( closed ) {\r\n\r\n\t\ttheta = Math.acos( THREE.Math.clamp( normals[ 0 ].dot( normals[ numpoints - 1 ] ), - 1, 1 ) );\r\n\t\ttheta /= ( numpoints - 1 );\r\n\r\n\t\tif ( tangents[ 0 ].dot( vec.crossVectors( normals[ 0 ], normals[ numpoints - 1 ] ) ) > 0 ) {\r\n\r\n\t\t\ttheta = - theta;\r\n\r\n\t\t}\r\n\r\n\t\tfor ( i = 1; i < numpoints; i ++ ) {\r\n\r\n\t\t\t// twist a little...\r\n\t\t\tnormals[ i ].applyMatrix4( mat.makeRotationAxis( tangents[ i ], theta * i ) );\r\n\t\t\tbinormals[ i ].crossVectors( tangents[ i ], normals[ i ] );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/extras/geometries/PolyhedronGeometry.js\r\n\r\n/**\r\n * @author clockworkgeek / https://github.com/clockworkgeek\r\n * @author timothypratley / https://github.com/timothypratley\r\n * @author WestLangley / http://github.com/WestLangley\r\n*/\r\n\r\nTHREE.PolyhedronGeometry = function ( vertices, indices, radius, detail ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'PolyhedronGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tvertices: vertices,\r\n\t\tindices: indices,\r\n\t\tradius: radius,\r\n\t\tdetail: detail\r\n\t};\r\n\r\n\tradius = radius || 1;\r\n\tdetail = detail || 0;\r\n\r\n\tvar that = this;\r\n\r\n\tfor ( var i = 0, l = vertices.length; i < l; i += 3 ) {\r\n\r\n\t\tprepare( new THREE.Vector3( vertices[ i ], vertices[ i + 1 ], vertices[ i + 2 ] ) );\r\n\r\n\t}\r\n\r\n\tvar p = this.vertices;\r\n\r\n\tvar faces = [];\r\n\r\n\tfor ( var i = 0, j = 0, l = indices.length; i < l; i += 3, j ++ ) {\r\n\r\n\t\tvar v1 = p[ indices[ i ] ];\r\n\t\tvar v2 = p[ indices[ i + 1 ] ];\r\n\t\tvar v3 = p[ indices[ i + 2 ] ];\r\n\r\n\t\tfaces[ j ] = new THREE.Face3( v1.index, v2.index, v3.index, [ v1.clone(), v2.clone(), v3.clone() ], undefined, j );\r\n\r\n\t}\r\n\r\n\tvar centroid = new THREE.Vector3();\r\n\r\n\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\r\n\r\n\t\tsubdivide( faces[ i ], detail );\r\n\r\n\t}\r\n\r\n\r\n\t// Handle case when face straddles the seam\r\n\r\n\tfor ( var i = 0, l = this.faceVertexUvs[ 0 ].length; i < l; i ++ ) {\r\n\r\n\t\tvar uvs = this.faceVertexUvs[ 0 ][ i ];\r\n\r\n\t\tvar x0 = uvs[ 0 ].x;\r\n\t\tvar x1 = uvs[ 1 ].x;\r\n\t\tvar x2 = uvs[ 2 ].x;\r\n\r\n\t\tvar max = Math.max( x0, x1, x2 );\r\n\t\tvar min = Math.min( x0, x1, x2 );\r\n\r\n\t\tif ( max > 0.9 && min < 0.1 ) {\r\n\r\n\t\t\t// 0.9 is somewhat arbitrary\r\n\r\n\t\t\tif ( x0 < 0.2 ) uvs[ 0 ].x += 1;\r\n\t\t\tif ( x1 < 0.2 ) uvs[ 1 ].x += 1;\r\n\t\t\tif ( x2 < 0.2 ) uvs[ 2 ].x += 1;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\t// Apply radius\r\n\r\n\tfor ( var i = 0, l = this.vertices.length; i < l; i ++ ) {\r\n\r\n\t\tthis.vertices[ i ].multiplyScalar( radius );\r\n\r\n\t}\r\n\r\n\r\n\t// Merge vertices\r\n\r\n\tthis.mergeVertices();\r\n\r\n\tthis.computeFaceNormals();\r\n\r\n\tthis.boundingSphere = new THREE.Sphere( new THREE.Vector3(), radius );\r\n\r\n\r\n\t// Project vector onto sphere's surface\r\n\r\n\tfunction prepare( vector ) {\r\n\r\n\t\tvar vertex = vector.normalize().clone();\r\n\t\tvertex.index = that.vertices.push( vertex ) - 1;\r\n\r\n\t\t// Texture coords are equivalent to map coords, calculate angle and convert to fraction of a circle.\r\n\r\n\t\tvar u = azimuth( vector ) / 2 / Math.PI + 0.5;\r\n\t\tvar v = inclination( vector ) / Math.PI + 0.5;\r\n\t\tvertex.uv = new THREE.Vector2( u, 1 - v );\r\n\r\n\t\treturn vertex;\r\n\r\n\t}\r\n\r\n\r\n\t// Approximate a curved face with recursively sub-divided triangles.\r\n\r\n\tfunction make( v1, v2, v3, materialIndex ) {\r\n\r\n\t\tvar face = new THREE.Face3( v1.index, v2.index, v3.index, [ v1.clone(), v2.clone(), v3.clone() ], undefined, materialIndex );\r\n\t\tthat.faces.push( face );\r\n\r\n\t\tcentroid.copy( v1 ).add( v2 ).add( v3 ).divideScalar( 3 );\r\n\r\n\t\tvar azi = azimuth( centroid );\r\n\r\n\t\tthat.faceVertexUvs[ 0 ].push( [\r\n\t\t\tcorrectUV( v1.uv, v1, azi ),\r\n\t\t\tcorrectUV( v2.uv, v2, azi ),\r\n\t\t\tcorrectUV( v3.uv, v3, azi )\r\n\t\t] );\r\n\r\n\t}\r\n\r\n\r\n\t// Analytically subdivide a face to the required detail level.\r\n\r\n\tfunction subdivide( face, detail ) {\r\n\r\n\t\tvar cols = Math.pow( 2, detail );\r\n\t\tvar a = prepare( that.vertices[ face.a ] );\r\n\t\tvar b = prepare( that.vertices[ face.b ] );\r\n\t\tvar c = prepare( that.vertices[ face.c ] );\r\n\t\tvar v = [];\r\n\r\n\t\tvar materialIndex = face.materialIndex;\r\n\r\n\t\t// Construct all of the vertices for this subdivision.\r\n\r\n\t\tfor ( var i = 0 ; i <= cols; i ++ ) {\r\n\r\n\t\t\tv[ i ] = [];\r\n\r\n\t\t\tvar aj = prepare( a.clone().lerp( c, i / cols ) );\r\n\t\t\tvar bj = prepare( b.clone().lerp( c, i / cols ) );\r\n\t\t\tvar rows = cols - i;\r\n\r\n\t\t\tfor ( var j = 0; j <= rows; j ++ ) {\r\n\r\n\t\t\t\tif ( j === 0 && i === cols ) {\r\n\r\n\t\t\t\t\tv[ i ][ j ] = aj;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tv[ i ][ j ] = prepare( aj.clone().lerp( bj, j / rows ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// Construct all of the faces.\r\n\r\n\t\tfor ( var i = 0; i < cols ; i ++ ) {\r\n\r\n\t\t\tfor ( var j = 0; j < 2 * ( cols - i ) - 1; j ++ ) {\r\n\r\n\t\t\t\tvar k = Math.floor( j / 2 );\r\n\r\n\t\t\t\tif ( j % 2 === 0 ) {\r\n\r\n\t\t\t\t\tmake(\r\n\t\t\t\t\t\tv[ i ][ k + 1 ],\r\n\t\t\t\t\t\tv[ i + 1 ][ k ],\r\n\t\t\t\t\t\tv[ i ][ k ],\r\n\t\t\t\t\t\tmaterialIndex\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tmake(\r\n\t\t\t\t\t\tv[ i ][ k + 1 ],\r\n\t\t\t\t\t\tv[ i + 1 ][ k + 1 ],\r\n\t\t\t\t\t\tv[ i + 1 ][ k ],\r\n\t\t\t\t\t\tmaterialIndex\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\t// Angle around the Y axis, counter-clockwise when looking from above.\r\n\r\n\tfunction azimuth( vector ) {\r\n\r\n\t\treturn Math.atan2( vector.z, - vector.x );\r\n\r\n\t}\r\n\r\n\r\n\t// Angle above the XZ plane.\r\n\r\n\tfunction inclination( vector ) {\r\n\r\n\t\treturn Math.atan2( - vector.y, Math.sqrt( ( vector.x * vector.x ) + ( vector.z * vector.z ) ) );\r\n\r\n\t}\r\n\r\n\r\n\t// Texture fixing helper. Spheres have some odd behaviours.\r\n\r\n\tfunction correctUV( uv, vector, azimuth ) {\r\n\r\n\t\tif ( ( azimuth < 0 ) && ( uv.x === 1 ) ) uv = new THREE.Vector2( uv.x - 1, uv.y );\r\n\t\tif ( ( vector.x === 0 ) && ( vector.z === 0 ) ) uv = new THREE.Vector2( azimuth / 2 / Math.PI + 0.5, uv.y );\r\n\t\treturn uv.clone();\r\n\r\n\t}\r\n\r\n\r\n};\r\n\r\nTHREE.PolyhedronGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.PolyhedronGeometry.prototype.constructor = THREE.PolyhedronGeometry;\r\n\r\nTHREE.PolyhedronGeometry.prototype.clone = function () {\r\n\r\n\tvar parameters = this.parameters;\r\n\r\n\treturn new THREE.PolyhedronGeometry(\r\n\t\tparameters.vertices,\r\n\t\tparameters.indices,\r\n\t\tparameters.radius,\r\n\t\tparameters.detail\r\n\t);\r\n\r\n};\r\n\r\n// File:src/extras/geometries/DodecahedronGeometry.js\r\n\r\n/**\r\n * @author Abe Pazos / https://hamoid.com\r\n */\r\n\r\nTHREE.DodecahedronGeometry = function ( radius, detail ) {\r\n\r\n\tvar t = ( 1 + Math.sqrt( 5 ) ) / 2;\r\n\tvar r = 1 / t;\r\n\r\n\tvar vertices = [\r\n\r\n\t\t// (1, 1, 1)\r\n\t\t- 1, - 1, - 1,    - 1, - 1,  1,\r\n\t\t- 1,  1, - 1,    - 1,  1,  1,\r\n\t\t 1, - 1, - 1,     1, - 1,  1,\r\n\t\t 1,  1, - 1,     1,  1,  1,\r\n\r\n\t\t// (0, 1/, )\r\n\t\t 0, - r, - t,     0, - r,  t,\r\n\t\t 0,  r, - t,     0,  r,  t,\r\n\r\n\t\t// (1/, , 0)\r\n\t\t- r, - t,  0,    - r,  t,  0,\r\n\t\t r, - t,  0,     r,  t,  0,\r\n\r\n\t\t// (, 0, 1/)\r\n\t\t- t,  0, - r,     t,  0, - r,\r\n\t\t- t,  0,  r,     t,  0,  r\r\n\t];\r\n\r\n\tvar indices = [\r\n\t\t 3, 11,  7,      3,  7, 15,      3, 15, 13,\r\n\t\t 7, 19, 17,      7, 17,  6,      7,  6, 15,\r\n\t\t17,  4,  8,     17,  8, 10,     17, 10,  6,\r\n\t\t 8,  0, 16,      8, 16,  2,      8,  2, 10,\r\n\t\t 0, 12,  1,      0,  1, 18,      0, 18, 16,\r\n\t\t 6, 10,  2,      6,  2, 13,      6, 13, 15,\r\n\t\t 2, 16, 18,      2, 18,  3,      2,  3, 13,\r\n\t\t18,  1,  9,     18,  9, 11,     18, 11,  3,\r\n\t\t 4, 14, 12,      4, 12,  0,      4,  0,  8,\r\n\t\t11,  9,  5,     11,  5, 19,     11, 19,  7,\r\n\t\t19,  5, 14,     19, 14,  4,     19,  4, 17,\r\n\t\t 1, 12, 14,      1, 14,  5,      1,  5,  9\r\n\t];\r\n\r\n\tTHREE.PolyhedronGeometry.call( this, vertices, indices, radius, detail );\r\n\r\n\tthis.type = 'DodecahedronGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\tdetail: detail\r\n\t};\r\n\r\n};\r\n\r\nTHREE.DodecahedronGeometry.prototype = Object.create( THREE.PolyhedronGeometry.prototype );\r\nTHREE.DodecahedronGeometry.prototype.constructor = THREE.DodecahedronGeometry;\r\n\r\nTHREE.DodecahedronGeometry.prototype.clone = function () {\r\n\r\n\tvar parameters = this.parameters;\r\n\r\n\treturn new THREE.DodecahedronGeometry(\r\n\t\tparameters.radius,\r\n\t\tparameters.detail\r\n\t);\r\n\r\n};\r\n\r\n// File:src/extras/geometries/IcosahedronGeometry.js\r\n\r\n/**\r\n * @author timothypratley / https://github.com/timothypratley\r\n */\r\n\r\nTHREE.IcosahedronGeometry = function ( radius, detail ) {\r\n\r\n\tvar t = ( 1 + Math.sqrt( 5 ) ) / 2;\r\n\r\n\tvar vertices = [\r\n\t\t- 1,  t,  0,    1,  t,  0,   - 1, - t,  0,    1, - t,  0,\r\n\t\t 0, - 1,  t,    0,  1,  t,    0, - 1, - t,    0,  1, - t,\r\n\t\t t,  0, - 1,    t,  0,  1,   - t,  0, - 1,   - t,  0,  1\r\n\t];\r\n\r\n\tvar indices = [\r\n\t\t 0, 11,  5,    0,  5,  1,    0,  1,  7,    0,  7, 10,    0, 10, 11,\r\n\t\t 1,  5,  9,    5, 11,  4,   11, 10,  2,   10,  7,  6,    7,  1,  8,\r\n\t\t 3,  9,  4,    3,  4,  2,    3,  2,  6,    3,  6,  8,    3,  8,  9,\r\n\t\t 4,  9,  5,    2,  4, 11,    6,  2, 10,    8,  6,  7,    9,  8,  1\r\n\t];\r\n\r\n\tTHREE.PolyhedronGeometry.call( this, vertices, indices, radius, detail );\r\n\r\n\tthis.type = 'IcosahedronGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\tdetail: detail\r\n\t};\r\n\r\n};\r\n\r\nTHREE.IcosahedronGeometry.prototype = Object.create( THREE.PolyhedronGeometry.prototype );\r\nTHREE.IcosahedronGeometry.prototype.constructor = THREE.IcosahedronGeometry;\r\n\r\nTHREE.IcosahedronGeometry.prototype.clone = function () {\r\n\r\n\tvar parameters = this.parameters;\r\n\r\n\treturn new THREE.IcosahedronGeometry(\r\n\t\tparameters.radius,\r\n\t\tparameters.detail\r\n\t);\r\n\r\n};\r\n\r\n// File:src/extras/geometries/OctahedronGeometry.js\r\n\r\n/**\r\n * @author timothypratley / https://github.com/timothypratley\r\n */\r\n\r\nTHREE.OctahedronGeometry = function ( radius, detail ) {\r\n\r\n\tvar vertices = [\r\n\t\t1, 0, 0,   - 1, 0, 0,    0, 1, 0,    0, - 1, 0,    0, 0, 1,    0, 0, - 1\r\n\t];\r\n\r\n\tvar indices = [\r\n\t\t0, 2, 4,    0, 4, 3,    0, 3, 5,    0, 5, 2,    1, 2, 5,    1, 5, 3,    1, 3, 4,    1, 4, 2\r\n\t];\r\n\r\n\tTHREE.PolyhedronGeometry.call( this, vertices, indices, radius, detail );\r\n\r\n\tthis.type = 'OctahedronGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\tdetail: detail\r\n\t};\r\n\r\n};\r\n\r\nTHREE.OctahedronGeometry.prototype = Object.create( THREE.PolyhedronGeometry.prototype );\r\nTHREE.OctahedronGeometry.prototype.constructor = THREE.OctahedronGeometry;\r\n\r\nTHREE.OctahedronGeometry.prototype.clone = function () {\r\n\r\n\tvar parameters = this.parameters;\r\n\r\n\treturn new THREE.OctahedronGeometry(\r\n\t\tparameters.radius,\r\n\t\tparameters.detail\r\n\t);\r\n\r\n};\r\n\r\n// File:src/extras/geometries/TetrahedronGeometry.js\r\n\r\n/**\r\n * @author timothypratley / https://github.com/timothypratley\r\n */\r\n\r\nTHREE.TetrahedronGeometry = function ( radius, detail ) {\r\n\r\n\tvar vertices = [\r\n\t\t 1,  1,  1,   - 1, - 1,  1,   - 1,  1, - 1,    1, - 1, - 1\r\n\t];\r\n\r\n\tvar indices = [\r\n\t\t 2,  1,  0,    0,  3,  2,    1,  3,  0,    2,  3,  1\r\n\t];\r\n\r\n\tTHREE.PolyhedronGeometry.call( this, vertices, indices, radius, detail );\r\n\r\n\tthis.type = 'TetrahedronGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\tdetail: detail\r\n\t};\r\n\r\n};\r\n\r\nTHREE.TetrahedronGeometry.prototype = Object.create( THREE.PolyhedronGeometry.prototype );\r\nTHREE.TetrahedronGeometry.prototype.constructor = THREE.TetrahedronGeometry;\r\n\r\nTHREE.TetrahedronGeometry.prototype.clone = function () {\r\n\r\n\tvar parameters = this.parameters;\r\n\r\n\treturn new THREE.TetrahedronGeometry(\r\n\t\tparameters.radius,\r\n\t\tparameters.detail\r\n\t);\r\n\r\n};\r\n\r\n// File:src/extras/geometries/ParametricGeometry.js\r\n\r\n/**\r\n * @author zz85 / https://github.com/zz85\r\n * Parametric Surfaces Geometry\r\n * based on the brilliant article by @prideout http://prideout.net/blog/?p=44\r\n *\r\n * new THREE.ParametricGeometry( parametricFunction, uSegments, ySegements );\r\n *\r\n */\r\n\r\nTHREE.ParametricGeometry = function ( func, slices, stacks ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'ParametricGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tfunc: func,\r\n\t\tslices: slices,\r\n\t\tstacks: stacks\r\n\t};\r\n\r\n\tvar verts = this.vertices;\r\n\tvar faces = this.faces;\r\n\tvar uvs = this.faceVertexUvs[ 0 ];\r\n\r\n\tvar i, j, p;\r\n\tvar u, v;\r\n\r\n\tvar sliceCount = slices + 1;\r\n\r\n\tfor ( i = 0; i <= stacks; i ++ ) {\r\n\r\n\t\tv = i / stacks;\r\n\r\n\t\tfor ( j = 0; j <= slices; j ++ ) {\r\n\r\n\t\t\tu = j / slices;\r\n\r\n\t\t\tp = func( u, v );\r\n\t\t\tverts.push( p );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tvar a, b, c, d;\r\n\tvar uva, uvb, uvc, uvd;\r\n\r\n\tfor ( i = 0; i < stacks; i ++ ) {\r\n\r\n\t\tfor ( j = 0; j < slices; j ++ ) {\r\n\r\n\t\t\ta = i * sliceCount + j;\r\n\t\t\tb = i * sliceCount + j + 1;\r\n\t\t\tc = ( i + 1 ) * sliceCount + j + 1;\r\n\t\t\td = ( i + 1 ) * sliceCount + j;\r\n\r\n\t\t\tuva = new THREE.Vector2( j / slices, i / stacks );\r\n\t\t\tuvb = new THREE.Vector2( ( j + 1 ) / slices, i / stacks );\r\n\t\t\tuvc = new THREE.Vector2( ( j + 1 ) / slices, ( i + 1 ) / stacks );\r\n\t\t\tuvd = new THREE.Vector2( j / slices, ( i + 1 ) / stacks );\r\n\r\n\t\t\tfaces.push( new THREE.Face3( a, b, d ) );\r\n\t\t\tuvs.push( [ uva, uvb, uvd ] );\r\n\r\n\t\t\tfaces.push( new THREE.Face3( b, c, d ) );\r\n\t\t\tuvs.push( [ uvb.clone(), uvc, uvd.clone() ] );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// console.log(this);\r\n\r\n\t// magic bullet\r\n\t// var diff = this.mergeVertices();\r\n\t// console.log('removed ', diff, ' vertices by merging');\r\n\r\n\tthis.computeFaceNormals();\r\n\tthis.computeVertexNormals();\r\n\r\n};\r\n\r\nTHREE.ParametricGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.ParametricGeometry.prototype.constructor = THREE.ParametricGeometry;\r\n\r\n// File:src/extras/geometries/WireframeGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.WireframeGeometry = function ( geometry ) {\r\n\r\n\tTHREE.BufferGeometry.call( this );\r\n\r\n\tvar edge = [ 0, 0 ], hash = {};\r\n\r\n\tfunction sortFunction( a, b ) {\r\n\r\n\t\treturn a - b;\r\n\r\n\t}\r\n\r\n\tvar keys = [ 'a', 'b', 'c' ];\r\n\r\n\tif ( geometry instanceof THREE.Geometry ) {\r\n\r\n\t\tvar vertices = geometry.vertices;\r\n\t\tvar faces = geometry.faces;\r\n\t\tvar numEdges = 0;\r\n\r\n\t\t// allocate maximal size\r\n\t\tvar edges = new Uint32Array( 6 * faces.length );\r\n\r\n\t\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar face = faces[ i ];\r\n\r\n\t\t\tfor ( var j = 0; j < 3; j ++ ) {\r\n\r\n\t\t\t\tedge[ 0 ] = face[ keys[ j ] ];\r\n\t\t\t\tedge[ 1 ] = face[ keys[ ( j + 1 ) % 3 ] ];\r\n\t\t\t\tedge.sort( sortFunction );\r\n\r\n\t\t\t\tvar key = edge.toString();\r\n\r\n\t\t\t\tif ( hash[ key ] === undefined ) {\r\n\r\n\t\t\t\t\tedges[ 2 * numEdges ] = edge[ 0 ];\r\n\t\t\t\t\tedges[ 2 * numEdges + 1 ] = edge[ 1 ];\r\n\t\t\t\t\thash[ key ] = true;\r\n\t\t\t\t\tnumEdges ++;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar coords = new Float32Array( numEdges * 2 * 3 );\r\n\r\n\t\tfor ( var i = 0, l = numEdges; i < l; i ++ ) {\r\n\r\n\t\t\tfor ( var j = 0; j < 2; j ++ ) {\r\n\r\n\t\t\t\tvar vertex = vertices[ edges [ 2 * i + j ] ];\r\n\r\n\t\t\t\tvar index = 6 * i + 3 * j;\r\n\t\t\t\tcoords[ index + 0 ] = vertex.x;\r\n\t\t\t\tcoords[ index + 1 ] = vertex.y;\r\n\t\t\t\tcoords[ index + 2 ] = vertex.z;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tthis.addAttribute( 'position', new THREE.BufferAttribute( coords, 3 ) );\r\n\r\n\t} else if ( geometry instanceof THREE.BufferGeometry ) {\r\n\r\n\t\tif ( geometry.index !== null ) {\r\n\r\n\t\t\t// Indexed BufferGeometry\r\n\r\n\t\t\tvar indices = geometry.index.array;\r\n\t\t\tvar vertices = geometry.attributes.position;\r\n\t\t\tvar drawcalls = geometry.drawcalls;\r\n\t\t\tvar numEdges = 0;\r\n\r\n\t\t\tif ( drawcalls.length === 0 ) {\r\n\r\n\t\t\t\tgeometry.addGroup( 0, indices.length );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// allocate maximal size\r\n\t\t\tvar edges = new Uint32Array( 2 * indices.length );\r\n\r\n\t\t\tfor ( var o = 0, ol = drawcalls.length; o < ol; ++ o ) {\r\n\r\n\t\t\t\tvar drawcall = drawcalls[ o ];\r\n\r\n\t\t\t\tvar start = drawcall.start;\r\n\t\t\t\tvar count = drawcall.count;\r\n\r\n\t\t\t\tfor ( var i = start, il = start + count; i < il; i += 3 ) {\r\n\r\n\t\t\t\t\tfor ( var j = 0; j < 3; j ++ ) {\r\n\r\n\t\t\t\t\t\tedge[ 0 ] = indices[ i + j ];\r\n\t\t\t\t\t\tedge[ 1 ] = indices[ i + ( j + 1 ) % 3 ];\r\n\t\t\t\t\t\tedge.sort( sortFunction );\r\n\r\n\t\t\t\t\t\tvar key = edge.toString();\r\n\r\n\t\t\t\t\t\tif ( hash[ key ] === undefined ) {\r\n\r\n\t\t\t\t\t\t\tedges[ 2 * numEdges ] = edge[ 0 ];\r\n\t\t\t\t\t\t\tedges[ 2 * numEdges + 1 ] = edge[ 1 ];\r\n\t\t\t\t\t\t\thash[ key ] = true;\r\n\t\t\t\t\t\t\tnumEdges ++;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar coords = new Float32Array( numEdges * 2 * 3 );\r\n\r\n\t\t\tfor ( var i = 0, l = numEdges; i < l; i ++ ) {\r\n\r\n\t\t\t\tfor ( var j = 0; j < 2; j ++ ) {\r\n\r\n\t\t\t\t\tvar index = 6 * i + 3 * j;\r\n\t\t\t\t\tvar index2 = edges[ 2 * i + j ];\r\n\r\n\t\t\t\t\tcoords[ index + 0 ] = vertices.getX( index2 );\r\n\t\t\t\t\tcoords[ index + 1 ] = vertices.getY( index2 );\r\n\t\t\t\t\tcoords[ index + 2 ] = vertices.getZ( index2 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.addAttribute( 'position', new THREE.BufferAttribute( coords, 3 ) );\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// non-indexed BufferGeometry\r\n\r\n\t\t\tvar vertices = geometry.attributes.position.array;\r\n\t\t\tvar numEdges = vertices.length / 3;\r\n\t\t\tvar numTris = numEdges / 3;\r\n\r\n\t\t\tvar coords = new Float32Array( numEdges * 2 * 3 );\r\n\r\n\t\t\tfor ( var i = 0, l = numTris; i < l; i ++ ) {\r\n\r\n\t\t\t\tfor ( var j = 0; j < 3; j ++ ) {\r\n\r\n\t\t\t\t\tvar index = 18 * i + 6 * j;\r\n\r\n\t\t\t\t\tvar index1 = 9 * i + 3 * j;\r\n\t\t\t\t\tcoords[ index + 0 ] = vertices[ index1 ];\r\n\t\t\t\t\tcoords[ index + 1 ] = vertices[ index1 + 1 ];\r\n\t\t\t\t\tcoords[ index + 2 ] = vertices[ index1 + 2 ];\r\n\r\n\t\t\t\t\tvar index2 = 9 * i + 3 * ( ( j + 1 ) % 3 );\r\n\t\t\t\t\tcoords[ index + 3 ] = vertices[ index2 ];\r\n\t\t\t\t\tcoords[ index + 4 ] = vertices[ index2 + 1 ];\r\n\t\t\t\t\tcoords[ index + 5 ] = vertices[ index2 + 2 ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.addAttribute( 'position', new THREE.BufferAttribute( coords, 3 ) );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.WireframeGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\r\nTHREE.WireframeGeometry.prototype.constructor = THREE.WireframeGeometry;\r\n\r\n// File:src/extras/helpers/AxisHelper.js\r\n\r\n/**\r\n * @author sroucheray / http://sroucheray.org/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.AxisHelper = function ( size ) {\r\n\r\n\tsize = size || 1;\r\n\r\n\tvar vertices = new Float32Array( [\r\n\t\t0, 0, 0,  size, 0, 0,\r\n\t\t0, 0, 0,  0, size, 0,\r\n\t\t0, 0, 0,  0, 0, size\r\n\t] );\r\n\r\n\tvar colors = new Float32Array( [\r\n\t\t1, 0, 0,  1, 0.6, 0,\r\n\t\t0, 1, 0,  0.6, 1, 0,\r\n\t\t0, 0, 1,  0, 0.6, 1\r\n\t] );\r\n\r\n\tvar geometry = new THREE.BufferGeometry();\r\n\tgeometry.addAttribute( 'position', new THREE.BufferAttribute( vertices, 3 ) );\r\n\tgeometry.addAttribute( 'color', new THREE.BufferAttribute( colors, 3 ) );\r\n\r\n\tvar material = new THREE.LineBasicMaterial( { vertexColors: THREE.VertexColors } );\r\n\r\n\tTHREE.LineSegments.call( this, geometry, material );\r\n\r\n};\r\n\r\nTHREE.AxisHelper.prototype = Object.create( THREE.LineSegments.prototype );\r\nTHREE.AxisHelper.prototype.constructor = THREE.AxisHelper;\r\n\r\n// File:src/extras/helpers/ArrowHelper.js\r\n\r\n/**\r\n * @author WestLangley / http://github.com/WestLangley\r\n * @author zz85 / http://github.com/zz85\r\n * @author bhouston / http://clara.io\r\n *\r\n * Creates an arrow for visualizing directions\r\n *\r\n * Parameters:\r\n *  dir - Vector3\r\n *  origin - Vector3\r\n *  length - Number\r\n *  color - color in hex value\r\n *  headLength - Number\r\n *  headWidth - Number\r\n */\r\n\r\nTHREE.ArrowHelper = ( function () {\r\n\r\n\tvar lineGeometry = new THREE.Geometry();\r\n\tlineGeometry.vertices.push( new THREE.Vector3( 0, 0, 0 ), new THREE.Vector3( 0, 1, 0 ) );\r\n\r\n\tvar coneGeometry = new THREE.CylinderGeometry( 0, 0.5, 1, 5, 1 );\r\n\tconeGeometry.translate( 0, - 0.5, 0 );\r\n\r\n\treturn function ArrowHelper( dir, origin, length, color, headLength, headWidth ) {\r\n\r\n\t\t// dir is assumed to be normalized\r\n\r\n\t\tTHREE.Object3D.call( this );\r\n\r\n\t\tif ( color === undefined ) color = 0xffff00;\r\n\t\tif ( length === undefined ) length = 1;\r\n\t\tif ( headLength === undefined ) headLength = 0.2 * length;\r\n\t\tif ( headWidth === undefined ) headWidth = 0.2 * headLength;\r\n\r\n\t\tthis.position.copy( origin );\r\n\t\t\r\n\t\tif ( headLength < length ) {\r\n\t\t\tthis.line = new THREE.Line( lineGeometry, new THREE.LineBasicMaterial( { color: color } ) );\r\n\t\t\tthis.line.matrixAutoUpdate = false;\r\n\t\t\tthis.add( this.line );\r\n\t\t}\r\n\r\n\t\tthis.cone = new THREE.Mesh( coneGeometry, new THREE.MeshBasicMaterial( { color: color } ) );\r\n\t\tthis.cone.matrixAutoUpdate = false;\r\n\t\tthis.add( this.cone );\r\n\r\n\t\tthis.setDirection( dir );\r\n\t\tthis.setLength( length, headLength, headWidth );\r\n\r\n\t}\r\n\r\n}() );\r\n\r\nTHREE.ArrowHelper.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.ArrowHelper.prototype.constructor = THREE.ArrowHelper;\r\n\r\nTHREE.ArrowHelper.prototype.setDirection = ( function () {\r\n\r\n\tvar axis = new THREE.Vector3();\r\n\tvar radians;\r\n\r\n\treturn function setDirection( dir ) {\r\n\r\n\t\t// dir is assumed to be normalized\r\n\r\n\t\tif ( dir.y > 0.99999 ) {\r\n\r\n\t\t\tthis.quaternion.set( 0, 0, 0, 1 );\r\n\r\n\t\t} else if ( dir.y < - 0.99999 ) {\r\n\r\n\t\t\tthis.quaternion.set( 1, 0, 0, 0 );\r\n\r\n\t\t} else {\r\n\r\n\t\t\taxis.set( dir.z, 0, - dir.x ).normalize();\r\n\r\n\t\t\tradians = Math.acos( dir.y );\r\n\r\n\t\t\tthis.quaternion.setFromAxisAngle( axis, radians );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n}() );\r\n\r\nTHREE.ArrowHelper.prototype.setLength = function ( length, headLength, headWidth ) {\r\n\r\n\tif ( headLength === undefined ) headLength = 0.2 * length;\r\n\tif ( headWidth === undefined ) headWidth = 0.2 * headLength;\r\n\r\n\tif ( headLength < length ){\r\n\t\tthis.line.scale.set( 1, length - headLength, 1 );\r\n\t\tthis.line.updateMatrix();\r\n\t}\r\n\r\n\tthis.cone.scale.set( headWidth, headLength, headWidth );\r\n\tthis.cone.position.y = length;\r\n\tthis.cone.updateMatrix();\r\n\r\n};\r\n\r\nTHREE.ArrowHelper.prototype.setColor = function ( color ) {\r\n\r\n\tif ( this.line !== undefined ) this.line.material.color.set( color );\r\n\tthis.cone.material.color.set( color );\r\n\r\n};\r\n\r\n// File:src/extras/helpers/BoxHelper.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.BoxHelper = function ( object ) {\r\n\r\n\tvar indices = new Uint16Array( [ 0, 1, 1, 2, 2, 3, 3, 0, 4, 5, 5, 6, 6, 7, 7, 4, 0, 4, 1, 5, 2, 6, 3, 7 ] );\r\n\tvar positions = new Float32Array( 8 * 3 );\r\n\r\n\tvar geometry = new THREE.BufferGeometry();\r\n\tgeometry.setIndex( new THREE.BufferAttribute( indices, 1 ) );\r\n\tgeometry.addAttribute( 'position', new THREE.BufferAttribute( positions, 3 ) );\r\n\r\n\tTHREE.LineSegments.call( this, geometry, new THREE.LineBasicMaterial( { color: 0xffff00 } ) );\r\n\r\n\tif ( object !== undefined ) {\r\n\r\n\t\tthis.update( object );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.BoxHelper.prototype = Object.create( THREE.LineSegments.prototype );\r\nTHREE.BoxHelper.prototype.constructor = THREE.BoxHelper;\r\n\r\nTHREE.BoxHelper.prototype.update = ( function () {\r\n\r\n\tvar box = new THREE.Box3();\r\n\r\n\treturn function ( object ) {\r\n\r\n\t\tbox.setFromObject( object );\r\n\r\n\t\tif ( box.empty() ) return;\r\n\r\n\t\tvar min = box.min;\r\n\t\tvar max = box.max;\r\n\r\n\t\t/*\r\n\t\t  5____4\r\n\t\t1/___0/|\r\n\t\t| 6__|_7\r\n\t\t2/___3/\r\n\r\n\t\t0: max.x, max.y, max.z\r\n\t\t1: min.x, max.y, max.z\r\n\t\t2: min.x, min.y, max.z\r\n\t\t3: max.x, min.y, max.z\r\n\t\t4: max.x, max.y, min.z\r\n\t\t5: min.x, max.y, min.z\r\n\t\t6: min.x, min.y, min.z\r\n\t\t7: max.x, min.y, min.z\r\n\t\t*/\r\n\r\n\t\tvar position = this.geometry.attributes.position;\r\n\t\tvar array = position.array;\r\n\r\n\t\tarray[  0 ] = max.x; array[  1 ] = max.y; array[  2 ] = max.z;\r\n\t\tarray[  3 ] = min.x; array[  4 ] = max.y; array[  5 ] = max.z;\r\n\t\tarray[  6 ] = min.x; array[  7 ] = min.y; array[  8 ] = max.z;\r\n\t\tarray[  9 ] = max.x; array[ 10 ] = min.y; array[ 11 ] = max.z;\r\n\t\tarray[ 12 ] = max.x; array[ 13 ] = max.y; array[ 14 ] = min.z;\r\n\t\tarray[ 15 ] = min.x; array[ 16 ] = max.y; array[ 17 ] = min.z;\r\n\t\tarray[ 18 ] = min.x; array[ 19 ] = min.y; array[ 20 ] = min.z;\r\n\t\tarray[ 21 ] = max.x; array[ 22 ] = min.y; array[ 23 ] = min.z;\r\n\r\n\t\tposition.needsUpdate = true;\r\n\r\n\t\tthis.geometry.computeBoundingSphere();\r\n\r\n\t}\r\n\r\n} )();\r\n\r\n// File:src/extras/helpers/BoundingBoxHelper.js\r\n\r\n/**\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\n// a helper to show the world-axis-aligned bounding box for an object\r\n\r\nTHREE.BoundingBoxHelper = function ( object, hex ) {\r\n\r\n\tvar color = ( hex !== undefined ) ? hex : 0x888888;\r\n\r\n\tthis.object = object;\r\n\r\n\tthis.box = new THREE.Box3();\r\n\r\n\tTHREE.Mesh.call( this, new THREE.BoxGeometry( 1, 1, 1 ), new THREE.MeshBasicMaterial( { color: color, wireframe: true } ) );\r\n\r\n};\r\n\r\nTHREE.BoundingBoxHelper.prototype = Object.create( THREE.Mesh.prototype );\r\nTHREE.BoundingBoxHelper.prototype.constructor = THREE.BoundingBoxHelper;\r\n\r\nTHREE.BoundingBoxHelper.prototype.update = function () {\r\n\r\n\tthis.box.setFromObject( this.object );\r\n\r\n\tthis.box.size( this.scale );\r\n\r\n\tthis.box.center( this.position );\r\n\r\n};\r\n\r\n// File:src/extras/helpers/CameraHelper.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n *\t- shows frustum, line of sight and up of the camera\r\n *\t- suitable for fast updates\r\n * \t- based on frustum visualization in lightgl.js shadowmap example\r\n *\t\thttp://evanw.github.com/lightgl.js/tests/shadowmap.html\r\n */\r\n\r\nTHREE.CameraHelper = function ( camera ) {\r\n\r\n\tvar geometry = new THREE.Geometry();\r\n\tvar material = new THREE.LineBasicMaterial( { color: 0xffffff, vertexColors: THREE.FaceColors } );\r\n\r\n\tvar pointMap = {};\r\n\r\n\t// colors\r\n\r\n\tvar hexFrustum = 0xffaa00;\r\n\tvar hexCone = 0xff0000;\r\n\tvar hexUp = 0x00aaff;\r\n\tvar hexTarget = 0xffffff;\r\n\tvar hexCross = 0x333333;\r\n\r\n\t// near\r\n\r\n\taddLine( \"n1\", \"n2\", hexFrustum );\r\n\taddLine( \"n2\", \"n4\", hexFrustum );\r\n\taddLine( \"n4\", \"n3\", hexFrustum );\r\n\taddLine( \"n3\", \"n1\", hexFrustum );\r\n\r\n\t// far\r\n\r\n\taddLine( \"f1\", \"f2\", hexFrustum );\r\n\taddLine( \"f2\", \"f4\", hexFrustum );\r\n\taddLine( \"f4\", \"f3\", hexFrustum );\r\n\taddLine( \"f3\", \"f1\", hexFrustum );\r\n\r\n\t// sides\r\n\r\n\taddLine( \"n1\", \"f1\", hexFrustum );\r\n\taddLine( \"n2\", \"f2\", hexFrustum );\r\n\taddLine( \"n3\", \"f3\", hexFrustum );\r\n\taddLine( \"n4\", \"f4\", hexFrustum );\r\n\r\n\t// cone\r\n\r\n\taddLine( \"p\", \"n1\", hexCone );\r\n\taddLine( \"p\", \"n2\", hexCone );\r\n\taddLine( \"p\", \"n3\", hexCone );\r\n\taddLine( \"p\", \"n4\", hexCone );\r\n\r\n\t// up\r\n\r\n\taddLine( \"u1\", \"u2\", hexUp );\r\n\taddLine( \"u2\", \"u3\", hexUp );\r\n\taddLine( \"u3\", \"u1\", hexUp );\r\n\r\n\t// target\r\n\r\n\taddLine( \"c\", \"t\", hexTarget );\r\n\taddLine( \"p\", \"c\", hexCross );\r\n\r\n\t// cross\r\n\r\n\taddLine( \"cn1\", \"cn2\", hexCross );\r\n\taddLine( \"cn3\", \"cn4\", hexCross );\r\n\r\n\taddLine( \"cf1\", \"cf2\", hexCross );\r\n\taddLine( \"cf3\", \"cf4\", hexCross );\r\n\r\n\tfunction addLine( a, b, hex ) {\r\n\r\n\t\taddPoint( a, hex );\r\n\t\taddPoint( b, hex );\r\n\r\n\t}\r\n\r\n\tfunction addPoint( id, hex ) {\r\n\r\n\t\tgeometry.vertices.push( new THREE.Vector3() );\r\n\t\tgeometry.colors.push( new THREE.Color( hex ) );\r\n\r\n\t\tif ( pointMap[ id ] === undefined ) {\r\n\r\n\t\t\tpointMap[ id ] = [];\r\n\r\n\t\t}\r\n\r\n\t\tpointMap[ id ].push( geometry.vertices.length - 1 );\r\n\r\n\t}\r\n\r\n\tTHREE.LineSegments.call( this, geometry, material );\r\n\r\n\tthis.camera = camera;\r\n\tthis.camera.updateProjectionMatrix();\r\n\r\n\tthis.matrix = camera.matrixWorld;\r\n\tthis.matrixAutoUpdate = false;\r\n\r\n\tthis.pointMap = pointMap;\r\n\r\n\tthis.update();\r\n\r\n};\r\n\r\nTHREE.CameraHelper.prototype = Object.create( THREE.LineSegments.prototype );\r\nTHREE.CameraHelper.prototype.constructor = THREE.CameraHelper;\r\n\r\nTHREE.CameraHelper.prototype.update = function () {\r\n\r\n\tvar geometry, pointMap;\r\n\r\n\tvar vector = new THREE.Vector3();\r\n\tvar camera = new THREE.Camera();\r\n\r\n\tfunction setPoint( point, x, y, z ) {\r\n\r\n\t\tvector.set( x, y, z ).unproject( camera );\r\n\r\n\t\tvar points = pointMap[ point ];\r\n\r\n\t\tif ( points !== undefined ) {\r\n\r\n\t\t\tfor ( var i = 0, il = points.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tgeometry.vertices[ points[ i ] ].copy( vector );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\treturn function () {\r\n\r\n\t\tgeometry = this.geometry;\r\n\t\tpointMap = this.pointMap;\r\n\r\n\t\tvar w = 1, h = 1;\r\n\r\n\t\t// we need just camera projection matrix\r\n\t\t// world matrix must be identity\r\n\r\n\t\tcamera.projectionMatrix.copy( this.camera.projectionMatrix );\r\n\r\n\t\t// center / target\r\n\r\n\t\tsetPoint( \"c\", 0, 0, - 1 );\r\n\t\tsetPoint( \"t\", 0, 0,  1 );\r\n\r\n\t\t// near\r\n\r\n\t\tsetPoint( \"n1\", - w, - h, - 1 );\r\n\t\tsetPoint( \"n2\",   w, - h, - 1 );\r\n\t\tsetPoint( \"n3\", - w,   h, - 1 );\r\n\t\tsetPoint( \"n4\",   w,   h, - 1 );\r\n\r\n\t\t// far\r\n\r\n\t\tsetPoint( \"f1\", - w, - h, 1 );\r\n\t\tsetPoint( \"f2\",   w, - h, 1 );\r\n\t\tsetPoint( \"f3\", - w,   h, 1 );\r\n\t\tsetPoint( \"f4\",   w,   h, 1 );\r\n\r\n\t\t// up\r\n\r\n\t\tsetPoint( \"u1\",   w * 0.7, h * 1.1, - 1 );\r\n\t\tsetPoint( \"u2\", - w * 0.7, h * 1.1, - 1 );\r\n\t\tsetPoint( \"u3\",         0, h * 2,   - 1 );\r\n\r\n\t\t// cross\r\n\r\n\t\tsetPoint( \"cf1\", - w,   0, 1 );\r\n\t\tsetPoint( \"cf2\",   w,   0, 1 );\r\n\t\tsetPoint( \"cf3\",   0, - h, 1 );\r\n\t\tsetPoint( \"cf4\",   0,   h, 1 );\r\n\r\n\t\tsetPoint( \"cn1\", - w,   0, - 1 );\r\n\t\tsetPoint( \"cn2\",   w,   0, - 1 );\r\n\t\tsetPoint( \"cn3\",   0, - h, - 1 );\r\n\t\tsetPoint( \"cn4\",   0,   h, - 1 );\r\n\r\n\t\tgeometry.verticesNeedUpdate = true;\r\n\r\n\t};\r\n\r\n}();\r\n\r\n// File:src/extras/helpers/DirectionalLightHelper.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.DirectionalLightHelper = function ( light, size ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.light = light;\r\n\tthis.light.updateMatrixWorld();\r\n\r\n\tthis.matrix = light.matrixWorld;\r\n\tthis.matrixAutoUpdate = false;\r\n\r\n\tsize = size || 1;\r\n\r\n\tvar geometry = new THREE.Geometry();\r\n\tgeometry.vertices.push(\r\n\t\tnew THREE.Vector3( - size,   size, 0 ),\r\n\t\tnew THREE.Vector3(   size,   size, 0 ),\r\n\t\tnew THREE.Vector3(   size, - size, 0 ),\r\n\t\tnew THREE.Vector3( - size, - size, 0 ),\r\n\t\tnew THREE.Vector3( - size,   size, 0 )\r\n\t);\r\n\r\n\tvar material = new THREE.LineBasicMaterial( { fog: false } );\r\n\tmaterial.color.copy( this.light.color ).multiplyScalar( this.light.intensity );\r\n\r\n\tthis.lightPlane = new THREE.Line( geometry, material );\r\n\tthis.add( this.lightPlane );\r\n\r\n\tgeometry = new THREE.Geometry();\r\n\tgeometry.vertices.push(\r\n\t\tnew THREE.Vector3(),\r\n\t\tnew THREE.Vector3()\r\n\t);\r\n\r\n\tmaterial = new THREE.LineBasicMaterial( { fog: false } );\r\n\tmaterial.color.copy( this.light.color ).multiplyScalar( this.light.intensity );\r\n\r\n\tthis.targetLine = new THREE.Line( geometry, material );\r\n\tthis.add( this.targetLine );\r\n\r\n\tthis.update();\r\n\r\n};\r\n\r\nTHREE.DirectionalLightHelper.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.DirectionalLightHelper.prototype.constructor = THREE.DirectionalLightHelper;\r\n\r\nTHREE.DirectionalLightHelper.prototype.dispose = function () {\r\n\r\n\tthis.lightPlane.geometry.dispose();\r\n\tthis.lightPlane.material.dispose();\r\n\tthis.targetLine.geometry.dispose();\r\n\tthis.targetLine.material.dispose();\r\n\r\n};\r\n\r\nTHREE.DirectionalLightHelper.prototype.update = function () {\r\n\r\n\tvar v1 = new THREE.Vector3();\r\n\tvar v2 = new THREE.Vector3();\r\n\tvar v3 = new THREE.Vector3();\r\n\r\n\treturn function () {\r\n\r\n\t\tv1.setFromMatrixPosition( this.light.matrixWorld );\r\n\t\tv2.setFromMatrixPosition( this.light.target.matrixWorld );\r\n\t\tv3.subVectors( v2, v1 );\r\n\r\n\t\tthis.lightPlane.lookAt( v3 );\r\n\t\tthis.lightPlane.material.color.copy( this.light.color ).multiplyScalar( this.light.intensity );\r\n\r\n\t\tthis.targetLine.geometry.vertices[ 1 ].copy( v3 );\r\n\t\tthis.targetLine.geometry.verticesNeedUpdate = true;\r\n\t\tthis.targetLine.material.color.copy( this.lightPlane.material.color );\r\n\r\n\t};\r\n\r\n}();\r\n\r\n// File:src/extras/helpers/EdgesHelper.js\r\n\r\n/**\r\n * @author WestLangley / http://github.com/WestLangley\r\n * @param object THREE.Mesh whose geometry will be used\r\n * @param hex line color\r\n * @param thresholdAngle the minimum angle (in degrees),\r\n * between the face normals of adjacent faces,\r\n * that is required to render an edge. A value of 10 means\r\n * an edge is only rendered if the angle is at least 10 degrees.\r\n */\r\n\r\nTHREE.EdgesHelper = function ( object, hex, thresholdAngle ) {\r\n\r\n\tvar color = ( hex !== undefined ) ? hex : 0xffffff;\r\n\r\n\tTHREE.LineSegments.call( this, new THREE.EdgesGeometry( object.geometry, thresholdAngle ), new THREE.LineBasicMaterial( { color: color } ) );\r\n\r\n\tthis.matrix = object.matrixWorld;\r\n\tthis.matrixAutoUpdate = false;\r\n\r\n};\r\n\r\nTHREE.EdgesHelper.prototype = Object.create( THREE.LineSegments.prototype );\r\nTHREE.EdgesHelper.prototype.constructor = THREE.EdgesHelper;\r\n\r\n// File:src/extras/helpers/FaceNormalsHelper.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n*/\r\n\r\nTHREE.FaceNormalsHelper = function ( object, size, hex, linewidth ) {\r\n\r\n\t// FaceNormalsHelper only supports THREE.Geometry\r\n\r\n\tthis.object = object;\r\n\r\n\tthis.size = ( size !== undefined ) ? size : 1;\r\n\r\n\tvar color = ( hex !== undefined ) ? hex : 0xffff00;\r\n\r\n\tvar width = ( linewidth !== undefined ) ? linewidth : 1;\r\n\r\n\t//\r\n\r\n\tvar nNormals = 0;\r\n\r\n\tvar objGeometry = this.object.geometry;\r\n\r\n\tif ( objGeometry instanceof THREE.Geometry ) {\r\n\r\n\t\tnNormals = objGeometry.faces.length;\r\n\r\n\t} else {\r\n\r\n\t\tconsole.warn( 'THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.' );\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tvar geometry = new THREE.BufferGeometry();\r\n\r\n\tvar positions = new THREE.Float32Attribute( nNormals * 2 * 3, 3 );\r\n\r\n\tgeometry.addAttribute( 'position', positions );\r\n\r\n\tTHREE.LineSegments.call( this, geometry, new THREE.LineBasicMaterial( { color: color, linewidth: width } ) );\r\n\r\n\t//\r\n\r\n\tthis.matrixAutoUpdate = false;\r\n\tthis.update();\r\n\r\n};\r\n\r\nTHREE.FaceNormalsHelper.prototype = Object.create( THREE.LineSegments.prototype );\r\nTHREE.FaceNormalsHelper.prototype.constructor = THREE.FaceNormalsHelper;\r\n\r\nTHREE.FaceNormalsHelper.prototype.update = ( function () {\r\n\r\n\tvar v1 = new THREE.Vector3();\r\n\tvar v2 = new THREE.Vector3();\r\n\tvar normalMatrix = new THREE.Matrix3();\r\n\r\n\treturn function update() {\r\n\r\n\t\tthis.object.updateMatrixWorld( true );\r\n\r\n\t\tnormalMatrix.getNormalMatrix( this.object.matrixWorld );\r\n\r\n\t\tvar matrixWorld = this.object.matrixWorld;\r\n\r\n\t\tvar position = this.geometry.attributes.position;\r\n\r\n\t\t//\r\n\r\n\t\tvar objGeometry = this.object.geometry;\r\n\r\n\t\tvar vertices = objGeometry.vertices;\r\n\r\n\t\tvar faces = objGeometry.faces;\r\n\r\n\t\tvar idx = 0;\r\n\r\n\t\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar face = faces[ i ];\r\n\r\n\t\t\tvar normal = face.normal;\r\n\r\n\t\t\tv1.copy( vertices[ face.a ] )\r\n\t\t\t\t.add( vertices[ face.b ] )\r\n\t\t\t\t.add( vertices[ face.c ] )\r\n\t\t\t\t.divideScalar( 3 )\r\n\t\t\t\t.applyMatrix4( matrixWorld );\r\n\r\n\t\t\tv2.copy( normal ).applyMatrix3( normalMatrix ).normalize().multiplyScalar( this.size ).add( v1 );\r\n\r\n\t\t\tposition.setXYZ( idx, v1.x, v1.y, v1.z );\r\n\r\n\t\t\tidx = idx + 1;\r\n\r\n\t\t\tposition.setXYZ( idx, v2.x, v2.y, v2.z );\r\n\r\n\t\t\tidx = idx + 1;\r\n\r\n\t\t}\r\n\r\n\t\tposition.needsUpdate = true;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n}() );\r\n\r\n// File:src/extras/helpers/GridHelper.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.GridHelper = function ( size, step ) {\r\n\r\n\tvar geometry = new THREE.Geometry();\r\n\tvar material = new THREE.LineBasicMaterial( { vertexColors: THREE.VertexColors } );\r\n\r\n\tthis.color1 = new THREE.Color( 0x444444 );\r\n\tthis.color2 = new THREE.Color( 0x888888 );\r\n\r\n\tfor ( var i = - size; i <= size; i += step ) {\r\n\r\n\t\tgeometry.vertices.push(\r\n\t\t\tnew THREE.Vector3( - size, 0, i ), new THREE.Vector3( size, 0, i ),\r\n\t\t\tnew THREE.Vector3( i, 0, - size ), new THREE.Vector3( i, 0, size )\r\n\t\t);\r\n\r\n\t\tvar color = i === 0 ? this.color1 : this.color2;\r\n\r\n\t\tgeometry.colors.push( color, color, color, color );\r\n\r\n\t}\r\n\r\n\tTHREE.LineSegments.call( this, geometry, material );\r\n\r\n};\r\n\r\nTHREE.GridHelper.prototype = Object.create( THREE.LineSegments.prototype );\r\nTHREE.GridHelper.prototype.constructor = THREE.GridHelper;\r\n\r\nTHREE.GridHelper.prototype.setColors = function( colorCenterLine, colorGrid ) {\r\n\r\n\tthis.color1.set( colorCenterLine );\r\n\tthis.color2.set( colorGrid );\r\n\r\n\tthis.geometry.colorsNeedUpdate = true;\r\n\r\n};\r\n\r\n// File:src/extras/helpers/HemisphereLightHelper.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.HemisphereLightHelper = function ( light, sphereSize ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.light = light;\r\n\tthis.light.updateMatrixWorld();\r\n\r\n\tthis.matrix = light.matrixWorld;\r\n\tthis.matrixAutoUpdate = false;\r\n\r\n\tthis.colors = [ new THREE.Color(), new THREE.Color() ];\r\n\r\n\tvar geometry = new THREE.SphereGeometry( sphereSize, 4, 2 );\r\n\tgeometry.rotateX( - Math.PI / 2 );\r\n\r\n\tfor ( var i = 0, il = 8; i < il; i ++ ) {\r\n\r\n\t\tgeometry.faces[ i ].color = this.colors[ i < 4 ? 0 : 1 ];\r\n\r\n\t}\r\n\r\n\tvar material = new THREE.MeshBasicMaterial( { vertexColors: THREE.FaceColors, wireframe: true } );\r\n\r\n\tthis.lightSphere = new THREE.Mesh( geometry, material );\r\n\tthis.add( this.lightSphere );\r\n\r\n\tthis.update();\r\n\r\n};\r\n\r\nTHREE.HemisphereLightHelper.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.HemisphereLightHelper.prototype.constructor = THREE.HemisphereLightHelper;\r\n\r\nTHREE.HemisphereLightHelper.prototype.dispose = function () {\r\n\r\n\tthis.lightSphere.geometry.dispose();\r\n\tthis.lightSphere.material.dispose();\r\n\r\n};\r\n\r\nTHREE.HemisphereLightHelper.prototype.update = function () {\r\n\r\n\tvar vector = new THREE.Vector3();\r\n\r\n\treturn function () {\r\n\r\n\t\tthis.colors[ 0 ].copy( this.light.color ).multiplyScalar( this.light.intensity );\r\n\t\tthis.colors[ 1 ].copy( this.light.groundColor ).multiplyScalar( this.light.intensity );\r\n\r\n\t\tthis.lightSphere.lookAt( vector.setFromMatrixPosition( this.light.matrixWorld ).negate() );\r\n\t\tthis.lightSphere.geometry.colorsNeedUpdate = true;\r\n\r\n\t}\r\n\r\n}();\r\n\r\n// File:src/extras/helpers/PointLightHelper.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.PointLightHelper = function ( light, sphereSize ) {\r\n\r\n\tthis.light = light;\r\n\tthis.light.updateMatrixWorld();\r\n\r\n\tvar geometry = new THREE.SphereGeometry( sphereSize, 4, 2 );\r\n\tvar material = new THREE.MeshBasicMaterial( { wireframe: true, fog: false } );\r\n\tmaterial.color.copy( this.light.color ).multiplyScalar( this.light.intensity );\r\n\r\n\tTHREE.Mesh.call( this, geometry, material );\r\n\r\n\tthis.matrix = this.light.matrixWorld;\r\n\tthis.matrixAutoUpdate = false;\r\n\r\n\t/*\r\n\tvar distanceGeometry = new THREE.IcosahedronGeometry( 1, 2 );\r\n\tvar distanceMaterial = new THREE.MeshBasicMaterial( { color: hexColor, fog: false, wireframe: true, opacity: 0.1, transparent: true } );\r\n\r\n\tthis.lightSphere = new THREE.Mesh( bulbGeometry, bulbMaterial );\r\n\tthis.lightDistance = new THREE.Mesh( distanceGeometry, distanceMaterial );\r\n\r\n\tvar d = light.distance;\r\n\r\n\tif ( d === 0.0 ) {\r\n\r\n\t\tthis.lightDistance.visible = false;\r\n\r\n\t} else {\r\n\r\n\t\tthis.lightDistance.scale.set( d, d, d );\r\n\r\n\t}\r\n\r\n\tthis.add( this.lightDistance );\r\n\t*/\r\n\r\n};\r\n\r\nTHREE.PointLightHelper.prototype = Object.create( THREE.Mesh.prototype );\r\nTHREE.PointLightHelper.prototype.constructor = THREE.PointLightHelper;\r\n\r\nTHREE.PointLightHelper.prototype.dispose = function () {\r\n\r\n\tthis.geometry.dispose();\r\n\tthis.material.dispose();\r\n\r\n};\r\n\r\nTHREE.PointLightHelper.prototype.update = function () {\r\n\r\n\tthis.material.color.copy( this.light.color ).multiplyScalar( this.light.intensity );\r\n\r\n\t/*\r\n\tvar d = this.light.distance;\r\n\r\n\tif ( d === 0.0 ) {\r\n\r\n\t\tthis.lightDistance.visible = false;\r\n\r\n\t} else {\r\n\r\n\t\tthis.lightDistance.visible = true;\r\n\t\tthis.lightDistance.scale.set( d, d, d );\r\n\r\n\t}\r\n\t*/\r\n\r\n};\r\n\r\n// File:src/extras/helpers/SkeletonHelper.js\r\n\r\n/**\r\n * @author Sean Griffin / http://twitter.com/sgrif\r\n * @author Michael Guerrero / http://realitymeltdown.com\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author ikerr / http://verold.com\r\n */\r\n\r\nTHREE.SkeletonHelper = function ( object ) {\r\n\r\n\tthis.bones = this.getBoneList( object );\r\n\r\n\tvar geometry = new THREE.Geometry();\r\n\r\n\tfor ( var i = 0; i < this.bones.length; i ++ ) {\r\n\r\n\t\tvar bone = this.bones[ i ];\r\n\r\n\t\tif ( bone.parent instanceof THREE.Bone ) {\r\n\r\n\t\t\tgeometry.vertices.push( new THREE.Vector3() );\r\n\t\t\tgeometry.vertices.push( new THREE.Vector3() );\r\n\t\t\tgeometry.colors.push( new THREE.Color( 0, 0, 1 ) );\r\n\t\t\tgeometry.colors.push( new THREE.Color( 0, 1, 0 ) );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tgeometry.dynamic = true;\r\n\r\n\tvar material = new THREE.LineBasicMaterial( { vertexColors: THREE.VertexColors, depthTest: false, depthWrite: false, transparent: true } );\r\n\r\n\tTHREE.LineSegments.call( this, geometry, material );\r\n\r\n\tthis.root = object;\r\n\r\n\tthis.matrix = object.matrixWorld;\r\n\tthis.matrixAutoUpdate = false;\r\n\r\n\tthis.update();\r\n\r\n};\r\n\r\n\r\nTHREE.SkeletonHelper.prototype = Object.create( THREE.LineSegments.prototype );\r\nTHREE.SkeletonHelper.prototype.constructor = THREE.SkeletonHelper;\r\n\r\nTHREE.SkeletonHelper.prototype.getBoneList = function( object ) {\r\n\r\n\tvar boneList = [];\r\n\r\n\tif ( object instanceof THREE.Bone ) {\r\n\r\n\t\tboneList.push( object );\r\n\r\n\t}\r\n\r\n\tfor ( var i = 0; i < object.children.length; i ++ ) {\r\n\r\n\t\tboneList.push.apply( boneList, this.getBoneList( object.children[ i ] ) );\r\n\r\n\t}\r\n\r\n\treturn boneList;\r\n\r\n};\r\n\r\nTHREE.SkeletonHelper.prototype.update = function () {\r\n\r\n\tvar geometry = this.geometry;\r\n\r\n\tvar matrixWorldInv = new THREE.Matrix4().getInverse( this.root.matrixWorld );\r\n\r\n\tvar boneMatrix = new THREE.Matrix4();\r\n\r\n\tvar j = 0;\r\n\r\n\tfor ( var i = 0; i < this.bones.length; i ++ ) {\r\n\r\n\t\tvar bone = this.bones[ i ];\r\n\r\n\t\tif ( bone.parent instanceof THREE.Bone ) {\r\n\r\n\t\t\tboneMatrix.multiplyMatrices( matrixWorldInv, bone.matrixWorld );\r\n\t\t\tgeometry.vertices[ j ].setFromMatrixPosition( boneMatrix );\r\n\r\n\t\t\tboneMatrix.multiplyMatrices( matrixWorldInv, bone.parent.matrixWorld );\r\n\t\t\tgeometry.vertices[ j + 1 ].setFromMatrixPosition( boneMatrix );\r\n\r\n\t\t\tj += 2;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tgeometry.verticesNeedUpdate = true;\r\n\r\n\tgeometry.computeBoundingSphere();\r\n\r\n};\r\n\r\n// File:src/extras/helpers/SpotLightHelper.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n*/\r\n\r\nTHREE.SpotLightHelper = function ( light ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.light = light;\r\n\tthis.light.updateMatrixWorld();\r\n\r\n\tthis.matrix = light.matrixWorld;\r\n\tthis.matrixAutoUpdate = false;\r\n\r\n\tvar geometry = new THREE.CylinderGeometry( 0, 1, 1, 8, 1, true );\r\n\r\n\tgeometry.translate( 0, - 0.5, 0 );\r\n\tgeometry.rotateX( - Math.PI / 2 );\r\n\r\n\tvar material = new THREE.MeshBasicMaterial( { wireframe: true, fog: false } );\r\n\r\n\tthis.cone = new THREE.Mesh( geometry, material );\r\n\tthis.add( this.cone );\r\n\r\n\tthis.update();\r\n\r\n};\r\n\r\nTHREE.SpotLightHelper.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.SpotLightHelper.prototype.constructor = THREE.SpotLightHelper;\r\n\r\nTHREE.SpotLightHelper.prototype.dispose = function () {\r\n\r\n\tthis.cone.geometry.dispose();\r\n\tthis.cone.material.dispose();\r\n\r\n};\r\n\r\nTHREE.SpotLightHelper.prototype.update = function () {\r\n\r\n\tvar vector = new THREE.Vector3();\r\n\tvar vector2 = new THREE.Vector3();\r\n\r\n\treturn function () {\r\n\r\n\t\tvar coneLength = this.light.distance ? this.light.distance : 10000;\r\n\t\tvar coneWidth = coneLength * Math.tan( this.light.angle );\r\n\r\n\t\tthis.cone.scale.set( coneWidth, coneWidth, coneLength );\r\n\r\n\t\tvector.setFromMatrixPosition( this.light.matrixWorld );\r\n\t\tvector2.setFromMatrixPosition( this.light.target.matrixWorld );\r\n\r\n\t\tthis.cone.lookAt( vector2.sub( vector ) );\r\n\r\n\t\tthis.cone.material.color.copy( this.light.color ).multiplyScalar( this.light.intensity );\r\n\r\n\t};\r\n\r\n}();\r\n\r\n// File:src/extras/helpers/VertexNormalsHelper.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n*/\r\n\r\nTHREE.VertexNormalsHelper = function ( object, size, hex, linewidth ) {\r\n\r\n\tthis.object = object;\r\n\r\n\tthis.size = ( size !== undefined ) ? size : 1;\r\n\r\n\tvar color = ( hex !== undefined ) ? hex : 0xff0000;\r\n\r\n\tvar width = ( linewidth !== undefined ) ? linewidth : 1;\r\n\r\n\t//\r\n\r\n\tvar nNormals = 0;\r\n\r\n\tvar objGeometry = this.object.geometry;\r\n\r\n\tif ( objGeometry instanceof THREE.Geometry ) {\r\n\r\n\t\tnNormals = objGeometry.faces.length * 3;\r\n\r\n\t} else if ( objGeometry instanceof THREE.BufferGeometry ) {\r\n\r\n\t\tnNormals = objGeometry.attributes.normal.count\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tvar geometry = new THREE.BufferGeometry();\r\n\r\n\tvar positions = new THREE.Float32Attribute( nNormals * 2 * 3, 3 );\r\n\r\n\tgeometry.addAttribute( 'position', positions );\r\n\r\n\tTHREE.LineSegments.call( this, geometry, new THREE.LineBasicMaterial( { color: color, linewidth: width } ) );\r\n\r\n\t//\r\n\r\n\tthis.matrixAutoUpdate = false;\r\n\r\n\tthis.update();\r\n\r\n};\r\n\r\nTHREE.VertexNormalsHelper.prototype = Object.create( THREE.LineSegments.prototype );\r\nTHREE.VertexNormalsHelper.prototype.constructor = THREE.VertexNormalsHelper;\r\n\r\nTHREE.VertexNormalsHelper.prototype.update = ( function () {\r\n\r\n\tvar v1 = new THREE.Vector3();\r\n\tvar v2 = new THREE.Vector3();\r\n\tvar normalMatrix = new THREE.Matrix3();\r\n\r\n\treturn function update() {\r\n\r\n\t\tvar keys = [ 'a', 'b', 'c' ];\r\n\r\n\t\tthis.object.updateMatrixWorld( true );\r\n\r\n\t\tnormalMatrix.getNormalMatrix( this.object.matrixWorld );\r\n\r\n\t\tvar matrixWorld = this.object.matrixWorld;\r\n\r\n\t\tvar position = this.geometry.attributes.position;\r\n\r\n\t\t//\r\n\r\n\t\tvar objGeometry = this.object.geometry;\r\n\r\n\t\tif ( objGeometry instanceof THREE.Geometry ) {\r\n\r\n\t\t\tvar vertices = objGeometry.vertices;\r\n\r\n\t\t\tvar faces = objGeometry.faces;\r\n\r\n\t\t\tvar idx = 0;\r\n\r\n\t\t\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar face = faces[ i ];\r\n\r\n\t\t\t\tfor ( var j = 0, jl = face.vertexNormals.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\tvar vertex = vertices[ face[ keys[ j ] ] ];\r\n\r\n\t\t\t\t\tvar normal = face.vertexNormals[ j ];\r\n\r\n\t\t\t\t\tv1.copy( vertex ).applyMatrix4( matrixWorld );\r\n\r\n\t\t\t\t\tv2.copy( normal ).applyMatrix3( normalMatrix ).normalize().multiplyScalar( this.size ).add( v1 );\r\n\r\n\t\t\t\t\tposition.setXYZ( idx, v1.x, v1.y, v1.z );\r\n\r\n\t\t\t\t\tidx = idx + 1;\r\n\r\n\t\t\t\t\tposition.setXYZ( idx, v2.x, v2.y, v2.z );\r\n\r\n\t\t\t\t\tidx = idx + 1;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( objGeometry instanceof THREE.BufferGeometry ) {\r\n\r\n\t\t\tvar objPos = objGeometry.attributes.position;\r\n\r\n\t\t\tvar objNorm = objGeometry.attributes.normal;\r\n\r\n\t\t\tvar idx = 0;\r\n\r\n\t\t\t// for simplicity, ignore index and drawcalls, and render every normal\r\n\r\n\t\t\tfor ( var j = 0, jl = objPos.count; j < jl; j ++ ) {\r\n\r\n\t\t\t\tv1.set( objPos.getX( j ), objPos.getY( j ), objPos.getZ( j ) ).applyMatrix4( matrixWorld );\r\n\r\n\t\t\t\tv2.set( objNorm.getX( j ), objNorm.getY( j ), objNorm.getZ( j ) );\r\n\r\n\t\t\t\tv2.applyMatrix3( normalMatrix ).normalize().multiplyScalar( this.size ).add( v1 );\r\n\r\n\t\t\t\tposition.setXYZ( idx, v1.x, v1.y, v1.z );\r\n\r\n\t\t\t\tidx = idx + 1;\r\n\r\n\t\t\t\tposition.setXYZ( idx, v2.x, v2.y, v2.z );\r\n\r\n\t\t\t\tidx = idx + 1;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tposition.needsUpdate = true;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n}() );\r\n\r\n// File:src/extras/helpers/WireframeHelper.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.WireframeHelper = function ( object, hex ) {\r\n\r\n\tvar color = ( hex !== undefined ) ? hex : 0xffffff;\r\n\r\n\tTHREE.LineSegments.call( this, new THREE.WireframeGeometry( object.geometry ), new THREE.LineBasicMaterial( { color: color } ) );\r\n\r\n\tthis.matrix = object.matrixWorld;\r\n\tthis.matrixAutoUpdate = false;\r\n\r\n};\r\n\r\nTHREE.WireframeHelper.prototype = Object.create( THREE.LineSegments.prototype );\r\nTHREE.WireframeHelper.prototype.constructor = THREE.WireframeHelper;\r\n\r\n// File:src/extras/objects/ImmediateRenderObject.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.ImmediateRenderObject = function ( material ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.material = material;\r\n\tthis.render = function ( renderCallback ) {};\r\n\r\n};\r\n\r\nTHREE.ImmediateRenderObject.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.ImmediateRenderObject.prototype.constructor = THREE.ImmediateRenderObject;\r\n\r\n// File:src/extras/objects/MorphBlendMesh.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.MorphBlendMesh = function( geometry, material ) {\r\n\r\n\tTHREE.Mesh.call( this, geometry, material );\r\n\r\n\tthis.animationsMap = {};\r\n\tthis.animationsList = [];\r\n\r\n\t// prepare default animation\r\n\t// (all frames played together in 1 second)\r\n\r\n\tvar numFrames = this.geometry.morphTargets.length;\r\n\r\n\tvar name = \"__default\";\r\n\r\n\tvar startFrame = 0;\r\n\tvar endFrame = numFrames - 1;\r\n\r\n\tvar fps = numFrames / 1;\r\n\r\n\tthis.createAnimation( name, startFrame, endFrame, fps );\r\n\tthis.setAnimationWeight( name, 1 );\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype = Object.create( THREE.Mesh.prototype );\r\nTHREE.MorphBlendMesh.prototype.constructor = THREE.MorphBlendMesh;\r\n\r\nTHREE.MorphBlendMesh.prototype.createAnimation = function ( name, start, end, fps ) {\r\n\r\n\tvar animation = {\r\n\r\n\t\tstart: start,\r\n\t\tend: end,\r\n\r\n\t\tlength: end - start + 1,\r\n\r\n\t\tfps: fps,\r\n\t\tduration: ( end - start ) / fps,\r\n\r\n\t\tlastFrame: 0,\r\n\t\tcurrentFrame: 0,\r\n\r\n\t\tactive: false,\r\n\r\n\t\ttime: 0,\r\n\t\tdirection: 1,\r\n\t\tweight: 1,\r\n\r\n\t\tdirectionBackwards: false,\r\n\t\tmirroredLoop: false\r\n\r\n\t};\r\n\r\n\tthis.animationsMap[ name ] = animation;\r\n\tthis.animationsList.push( animation );\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.autoCreateAnimations = function ( fps ) {\r\n\r\n\tvar pattern = /([a-z]+)_?(\\d+)/;\r\n\r\n\tvar firstAnimation, frameRanges = {};\r\n\r\n\tvar geometry = this.geometry;\r\n\r\n\tfor ( var i = 0, il = geometry.morphTargets.length; i < il; i ++ ) {\r\n\r\n\t\tvar morph = geometry.morphTargets[ i ];\r\n\t\tvar chunks = morph.name.match( pattern );\r\n\r\n\t\tif ( chunks && chunks.length > 1 ) {\r\n\r\n\t\t\tvar name = chunks[ 1 ];\r\n\r\n\t\t\tif ( ! frameRanges[ name ] ) frameRanges[ name ] = { start: Infinity, end: - Infinity };\r\n\r\n\t\t\tvar range = frameRanges[ name ];\r\n\r\n\t\t\tif ( i < range.start ) range.start = i;\r\n\t\t\tif ( i > range.end ) range.end = i;\r\n\r\n\t\t\tif ( ! firstAnimation ) firstAnimation = name;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfor ( var name in frameRanges ) {\r\n\r\n\t\tvar range = frameRanges[ name ];\r\n\t\tthis.createAnimation( name, range.start, range.end, fps );\r\n\r\n\t}\r\n\r\n\tthis.firstAnimation = firstAnimation;\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationDirectionForward = function ( name ) {\r\n\r\n\tvar animation = this.animationsMap[ name ];\r\n\r\n\tif ( animation ) {\r\n\r\n\t\tanimation.direction = 1;\r\n\t\tanimation.directionBackwards = false;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationDirectionBackward = function ( name ) {\r\n\r\n\tvar animation = this.animationsMap[ name ];\r\n\r\n\tif ( animation ) {\r\n\r\n\t\tanimation.direction = - 1;\r\n\t\tanimation.directionBackwards = true;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationFPS = function ( name, fps ) {\r\n\r\n\tvar animation = this.animationsMap[ name ];\r\n\r\n\tif ( animation ) {\r\n\r\n\t\tanimation.fps = fps;\r\n\t\tanimation.duration = ( animation.end - animation.start ) / animation.fps;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationDuration = function ( name, duration ) {\r\n\r\n\tvar animation = this.animationsMap[ name ];\r\n\r\n\tif ( animation ) {\r\n\r\n\t\tanimation.duration = duration;\r\n\t\tanimation.fps = ( animation.end - animation.start ) / animation.duration;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationWeight = function ( name, weight ) {\r\n\r\n\tvar animation = this.animationsMap[ name ];\r\n\r\n\tif ( animation ) {\r\n\r\n\t\tanimation.weight = weight;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationTime = function ( name, time ) {\r\n\r\n\tvar animation = this.animationsMap[ name ];\r\n\r\n\tif ( animation ) {\r\n\r\n\t\tanimation.time = time;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.getAnimationTime = function ( name ) {\r\n\r\n\tvar time = 0;\r\n\r\n\tvar animation = this.animationsMap[ name ];\r\n\r\n\tif ( animation ) {\r\n\r\n\t\ttime = animation.time;\r\n\r\n\t}\r\n\r\n\treturn time;\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.getAnimationDuration = function ( name ) {\r\n\r\n\tvar duration = - 1;\r\n\r\n\tvar animation = this.animationsMap[ name ];\r\n\r\n\tif ( animation ) {\r\n\r\n\t\tduration = animation.duration;\r\n\r\n\t}\r\n\r\n\treturn duration;\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.playAnimation = function ( name ) {\r\n\r\n\tvar animation = this.animationsMap[ name ];\r\n\r\n\tif ( animation ) {\r\n\r\n\t\tanimation.time = 0;\r\n\t\tanimation.active = true;\r\n\r\n\t} else {\r\n\r\n\t\tconsole.warn( \"THREE.MorphBlendMesh: animation[\" + name + \"] undefined in .playAnimation()\" );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.stopAnimation = function ( name ) {\r\n\r\n\tvar animation = this.animationsMap[ name ];\r\n\r\n\tif ( animation ) {\r\n\r\n\t\tanimation.active = false;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.update = function ( delta ) {\r\n\r\n\tfor ( var i = 0, il = this.animationsList.length; i < il; i ++ ) {\r\n\r\n\t\tvar animation = this.animationsList[ i ];\r\n\r\n\t\tif ( ! animation.active ) continue;\r\n\r\n\t\tvar frameTime = animation.duration / animation.length;\r\n\r\n\t\tanimation.time += animation.direction * delta;\r\n\r\n\t\tif ( animation.mirroredLoop ) {\r\n\r\n\t\t\tif ( animation.time > animation.duration || animation.time < 0 ) {\r\n\r\n\t\t\t\tanimation.direction *= - 1;\r\n\r\n\t\t\t\tif ( animation.time > animation.duration ) {\r\n\r\n\t\t\t\t\tanimation.time = animation.duration;\r\n\t\t\t\t\tanimation.directionBackwards = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( animation.time < 0 ) {\r\n\r\n\t\t\t\t\tanimation.time = 0;\r\n\t\t\t\t\tanimation.directionBackwards = false;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tanimation.time = animation.time % animation.duration;\r\n\r\n\t\t\tif ( animation.time < 0 ) animation.time += animation.duration;\r\n\r\n\t\t}\r\n\r\n\t\tvar keyframe = animation.start + THREE.Math.clamp( Math.floor( animation.time / frameTime ), 0, animation.length - 1 );\r\n\t\tvar weight = animation.weight;\r\n\r\n\t\tif ( keyframe !== animation.currentFrame ) {\r\n\r\n\t\t\tthis.morphTargetInfluences[ animation.lastFrame ] = 0;\r\n\t\t\tthis.morphTargetInfluences[ animation.currentFrame ] = 1 * weight;\r\n\r\n\t\t\tthis.morphTargetInfluences[ keyframe ] = 0;\r\n\r\n\t\t\tanimation.lastFrame = animation.currentFrame;\r\n\t\t\tanimation.currentFrame = keyframe;\r\n\r\n\t\t}\r\n\r\n\t\tvar mix = ( animation.time % frameTime ) / frameTime;\r\n\r\n\t\tif ( animation.directionBackwards ) mix = 1 - mix;\r\n\r\n\t\tif ( animation.currentFrame !== animation.lastFrame ) {\r\n\r\n\t\t\tthis.morphTargetInfluences[ animation.currentFrame ] = mix * weight;\r\n\t\t\tthis.morphTargetInfluences[ animation.lastFrame ] = ( 1 - mix ) * weight;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.morphTargetInfluences[ animation.currentFrame ] = weight;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\n\r\n// Export the THREE object for **Node.js**, with\r\n// backwards-compatibility for the old `require()` API. If we're in\r\n// the browser, add `_` as a global object via a string identifier,\r\n// for Closure Compiler \"advanced\" mode.\r\nif (typeof exports !== 'undefined') {\r\n  if (typeof module !== 'undefined' && module.exports) {\r\n    exports = module.exports = THREE;\r\n  }\r\n  exports.THREE = THREE;\r\n} else {\r\n  this['THREE'] = THREE;\r\n}\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/three/three.js\n ** module id = 9\n ** module chunks = 0\n **/","/**\n * lodash 3.0.3 (Custom Build) <https://lodash.com/>\n * Build: `lodash modern modularize exports=\"npm\" -o ./`\n * Copyright 2012-2015 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <https://lodash.com/license>\n */\nvar arrayEach = require('lodash._arrayeach'),\n    baseEach = require('lodash._baseeach'),\n    bindCallback = require('lodash._bindcallback'),\n    isArray = require('lodash.isarray');\n\n/**\n * Creates a function for `_.forEach` or `_.forEachRight`.\n *\n * @private\n * @param {Function} arrayFunc The function to iterate over an array.\n * @param {Function} eachFunc The function to iterate over a collection.\n * @returns {Function} Returns the new each function.\n */\nfunction createForEach(arrayFunc, eachFunc) {\n  return function(collection, iteratee, thisArg) {\n    return (typeof iteratee == 'function' && thisArg === undefined && isArray(collection))\n      ? arrayFunc(collection, iteratee)\n      : eachFunc(collection, bindCallback(iteratee, thisArg, 3));\n  };\n}\n\n/**\n * Iterates over elements of `collection` invoking `iteratee` for each element.\n * The `iteratee` is bound to `thisArg` and invoked with three arguments:\n * (value, index|key, collection). Iteratee functions may exit iteration early\n * by explicitly returning `false`.\n *\n * **Note:** As with other \"Collections\" methods, objects with a \"length\" property\n * are iterated like arrays. To avoid this behavior `_.forIn` or `_.forOwn`\n * may be used for object iteration.\n *\n * @static\n * @memberOf _\n * @alias each\n * @category Collection\n * @param {Array|Object|string} collection The collection to iterate over.\n * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n * @param {*} [thisArg] The `this` binding of `iteratee`.\n * @returns {Array|Object|string} Returns `collection`.\n * @example\n *\n * _([1, 2]).forEach(function(n) {\n *   console.log(n);\n * }).value();\n * // => logs each value from left to right and returns the array\n *\n * _.forEach({ 'a': 1, 'b': 2 }, function(n, key) {\n *   console.log(n, key);\n * });\n * // => logs each value-key pair and returns the object (iteration order is not guaranteed)\n */\nvar forEach = createForEach(arrayEach, baseEach);\n\nmodule.exports = forEach;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/lodash.foreach/index.js\n ** module id = 10\n ** module chunks = 0\n **/","/**\n * lodash 3.0.0 (Custom Build) <https://lodash.com/>\n * Build: `lodash modern modularize exports=\"npm\" -o ./`\n * Copyright 2012-2015 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.7.0 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <https://lodash.com/license>\n */\n\n/**\n * A specialized version of `_.forEach` for arrays without support for callback\n * shorthands or `this` binding.\n *\n * @private\n * @param {Array} array The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns `array`.\n */\nfunction arrayEach(array, iteratee) {\n  var index = -1,\n      length = array.length;\n\n  while (++index < length) {\n    if (iteratee(array[index], index, array) === false) {\n      break;\n    }\n  }\n  return array;\n}\n\nmodule.exports = arrayEach;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/lodash._arrayeach/index.js\n ** module id = 11\n ** module chunks = 0\n **/","/**\n * lodash 3.0.4 (Custom Build) <https://lodash.com/>\n * Build: `lodash modern modularize exports=\"npm\" -o ./`\n * Copyright 2012-2015 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <https://lodash.com/license>\n */\nvar keys = require('lodash.keys');\n\n/**\n * Used as the [maximum length](https://people.mozilla.org/~jorendorff/es6-draft.html#sec-number.max_safe_integer)\n * of an array-like value.\n */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/**\n * The base implementation of `_.forEach` without support for callback\n * shorthands and `this` binding.\n *\n * @private\n * @param {Array|Object|string} collection The collection to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array|Object|string} Returns `collection`.\n */\nvar baseEach = createBaseEach(baseForOwn);\n\n/**\n * The base implementation of `baseForIn` and `baseForOwn` which iterates\n * over `object` properties returned by `keysFunc` invoking `iteratee` for\n * each property. Iteratee functions may exit iteration early by explicitly\n * returning `false`.\n *\n * @private\n * @param {Object} object The object to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @returns {Object} Returns `object`.\n */\nvar baseFor = createBaseFor();\n\n/**\n * The base implementation of `_.forOwn` without support for callback\n * shorthands and `this` binding.\n *\n * @private\n * @param {Object} object The object to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Object} Returns `object`.\n */\nfunction baseForOwn(object, iteratee) {\n  return baseFor(object, iteratee, keys);\n}\n\n/**\n * The base implementation of `_.property` without support for deep paths.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @returns {Function} Returns the new function.\n */\nfunction baseProperty(key) {\n  return function(object) {\n    return object == null ? undefined : object[key];\n  };\n}\n\n/**\n * Creates a `baseEach` or `baseEachRight` function.\n *\n * @private\n * @param {Function} eachFunc The function to iterate over a collection.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {Function} Returns the new base function.\n */\nfunction createBaseEach(eachFunc, fromRight) {\n  return function(collection, iteratee) {\n    var length = collection ? getLength(collection) : 0;\n    if (!isLength(length)) {\n      return eachFunc(collection, iteratee);\n    }\n    var index = fromRight ? length : -1,\n        iterable = toObject(collection);\n\n    while ((fromRight ? index-- : ++index < length)) {\n      if (iteratee(iterable[index], index, iterable) === false) {\n        break;\n      }\n    }\n    return collection;\n  };\n}\n\n/**\n * Creates a base function for `_.forIn` or `_.forInRight`.\n *\n * @private\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {Function} Returns the new base function.\n */\nfunction createBaseFor(fromRight) {\n  return function(object, iteratee, keysFunc) {\n    var iterable = toObject(object),\n        props = keysFunc(object),\n        length = props.length,\n        index = fromRight ? length : -1;\n\n    while ((fromRight ? index-- : ++index < length)) {\n      var key = props[index];\n      if (iteratee(iterable[key], key, iterable) === false) {\n        break;\n      }\n    }\n    return object;\n  };\n}\n\n/**\n * Gets the \"length\" property value of `object`.\n *\n * **Note:** This function is used to avoid a [JIT bug](https://bugs.webkit.org/show_bug.cgi?id=142792)\n * that affects Safari on at least iOS 8.1-8.3 ARM64.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {*} Returns the \"length\" value.\n */\nvar getLength = baseProperty('length');\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This function is based on [`ToLength`](https://people.mozilla.org/~jorendorff/es6-draft.html#sec-tolength).\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n */\nfunction isLength(value) {\n  return typeof value == 'number' && value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\n/**\n * Converts `value` to an object if it's not one.\n *\n * @private\n * @param {*} value The value to process.\n * @returns {Object} Returns the object.\n */\nfunction toObject(value) {\n  return isObject(value) ? value : Object(value);\n}\n\n/**\n * Checks if `value` is the [language type](https://es5.github.io/#x8) of `Object`.\n * (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(1);\n * // => false\n */\nfunction isObject(value) {\n  // Avoid a V8 JIT bug in Chrome 19-20.\n  // See https://code.google.com/p/v8/issues/detail?id=2291 for more details.\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\nmodule.exports = baseEach;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/lodash._baseeach/index.js\n ** module id = 12\n ** module chunks = 0\n **/","/**\n * lodash 3.1.2 (Custom Build) <https://lodash.com/>\n * Build: `lodash modern modularize exports=\"npm\" -o ./`\n * Copyright 2012-2015 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <https://lodash.com/license>\n */\nvar getNative = require('lodash._getnative'),\n    isArguments = require('lodash.isarguments'),\n    isArray = require('lodash.isarray');\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^\\d+$/;\n\n/** Used for native method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/* Native method references for those with the same name as other `lodash` methods. */\nvar nativeKeys = getNative(Object, 'keys');\n\n/**\n * Used as the [maximum length](http://ecma-international.org/ecma-262/6.0/#sec-number.max_safe_integer)\n * of an array-like value.\n */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/**\n * The base implementation of `_.property` without support for deep paths.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @returns {Function} Returns the new function.\n */\nfunction baseProperty(key) {\n  return function(object) {\n    return object == null ? undefined : object[key];\n  };\n}\n\n/**\n * Gets the \"length\" property value of `object`.\n *\n * **Note:** This function is used to avoid a [JIT bug](https://bugs.webkit.org/show_bug.cgi?id=142792)\n * that affects Safari on at least iOS 8.1-8.3 ARM64.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {*} Returns the \"length\" value.\n */\nvar getLength = baseProperty('length');\n\n/**\n * Checks if `value` is array-like.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(getLength(value));\n}\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  value = (typeof value == 'number' || reIsUint.test(value)) ? +value : -1;\n  length = length == null ? MAX_SAFE_INTEGER : length;\n  return value > -1 && value % 1 == 0 && value < length;\n}\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This function is based on [`ToLength`](http://ecma-international.org/ecma-262/6.0/#sec-tolength).\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n */\nfunction isLength(value) {\n  return typeof value == 'number' && value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\n/**\n * A fallback implementation of `Object.keys` which creates an array of the\n * own enumerable property names of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction shimKeys(object) {\n  var props = keysIn(object),\n      propsLength = props.length,\n      length = propsLength && object.length;\n\n  var allowIndexes = !!length && isLength(length) &&\n    (isArray(object) || isArguments(object));\n\n  var index = -1,\n      result = [];\n\n  while (++index < propsLength) {\n    var key = props[index];\n    if ((allowIndexes && isIndex(key, length)) || hasOwnProperty.call(object, key)) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\n/**\n * Checks if `value` is the [language type](https://es5.github.io/#x8) of `Object`.\n * (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(1);\n * // => false\n */\nfunction isObject(value) {\n  // Avoid a V8 JIT bug in Chrome 19-20.\n  // See https://code.google.com/p/v8/issues/detail?id=2291 for more details.\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Creates an array of the own enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects. See the\n * [ES spec](http://ecma-international.org/ecma-262/6.0/#sec-object.keys)\n * for more details.\n *\n * @static\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keys(new Foo);\n * // => ['a', 'b'] (iteration order is not guaranteed)\n *\n * _.keys('hi');\n * // => ['0', '1']\n */\nvar keys = !nativeKeys ? shimKeys : function(object) {\n  var Ctor = object == null ? undefined : object.constructor;\n  if ((typeof Ctor == 'function' && Ctor.prototype === object) ||\n      (typeof object != 'function' && isArrayLike(object))) {\n    return shimKeys(object);\n  }\n  return isObject(object) ? nativeKeys(object) : [];\n};\n\n/**\n * Creates an array of the own and inherited enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects.\n *\n * @static\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keysIn(new Foo);\n * // => ['a', 'b', 'c'] (iteration order is not guaranteed)\n */\nfunction keysIn(object) {\n  if (object == null) {\n    return [];\n  }\n  if (!isObject(object)) {\n    object = Object(object);\n  }\n  var length = object.length;\n  length = (length && isLength(length) &&\n    (isArray(object) || isArguments(object)) && length) || 0;\n\n  var Ctor = object.constructor,\n      index = -1,\n      isProto = typeof Ctor == 'function' && Ctor.prototype === object,\n      result = Array(length),\n      skipIndexes = length > 0;\n\n  while (++index < length) {\n    result[index] = (index + '');\n  }\n  for (var key in object) {\n    if (!(skipIndexes && isIndex(key, length)) &&\n        !(key == 'constructor' && (isProto || !hasOwnProperty.call(object, key)))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = keys;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/lodash.keys/index.js\n ** module id = 13\n ** module chunks = 0\n **/","/**\n * lodash 3.9.1 (Custom Build) <https://lodash.com/>\n * Build: `lodash modern modularize exports=\"npm\" -o ./`\n * Copyright 2012-2015 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <https://lodash.com/license>\n */\n\n/** `Object#toString` result references. */\nvar funcTag = '[object Function]';\n\n/** Used to detect host constructors (Safari > 5). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/**\n * Checks if `value` is object-like.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/** Used for native method references. */\nvar objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar fnToString = Function.prototype.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the [`toStringTag`](http://ecma-international.org/ecma-262/6.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objToString = objectProto.toString;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  fnToString.call(hasOwnProperty).replace(/[\\\\^$.*+?()[\\]{}|]/g, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = object == null ? undefined : object[key];\n  return isNative(value) ? value : undefined;\n}\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is correctly classified, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in older versions of Chrome and Safari which return 'function' for regexes\n  // and Safari 8 equivalents which return 'object' for typed array constructors.\n  return isObject(value) && objToString.call(value) == funcTag;\n}\n\n/**\n * Checks if `value` is the [language type](https://es5.github.io/#x8) of `Object`.\n * (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(1);\n * // => false\n */\nfunction isObject(value) {\n  // Avoid a V8 JIT bug in Chrome 19-20.\n  // See https://code.google.com/p/v8/issues/detail?id=2291 for more details.\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is a native function.\n *\n * @static\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function, else `false`.\n * @example\n *\n * _.isNative(Array.prototype.push);\n * // => true\n *\n * _.isNative(_);\n * // => false\n */\nfunction isNative(value) {\n  if (value == null) {\n    return false;\n  }\n  if (isFunction(value)) {\n    return reIsNative.test(fnToString.call(value));\n  }\n  return isObjectLike(value) && reIsHostCtor.test(value);\n}\n\nmodule.exports = getNative;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/lodash._getnative/index.js\n ** module id = 14\n ** module chunks = 0\n **/","/**\n * lodash 3.0.4 (Custom Build) <https://lodash.com/>\n * Build: `lodash modern modularize exports=\"npm\" -o ./`\n * Copyright 2012-2015 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <https://lodash.com/license>\n */\n\n/**\n * Checks if `value` is object-like.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/** Used for native method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Native method references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/**\n * Used as the [maximum length](http://ecma-international.org/ecma-262/6.0/#sec-number.max_safe_integer)\n * of an array-like value.\n */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/**\n * The base implementation of `_.property` without support for deep paths.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @returns {Function} Returns the new function.\n */\nfunction baseProperty(key) {\n  return function(object) {\n    return object == null ? undefined : object[key];\n  };\n}\n\n/**\n * Gets the \"length\" property value of `object`.\n *\n * **Note:** This function is used to avoid a [JIT bug](https://bugs.webkit.org/show_bug.cgi?id=142792)\n * that affects Safari on at least iOS 8.1-8.3 ARM64.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {*} Returns the \"length\" value.\n */\nvar getLength = baseProperty('length');\n\n/**\n * Checks if `value` is array-like.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(getLength(value));\n}\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This function is based on [`ToLength`](http://ecma-international.org/ecma-262/6.0/#sec-tolength).\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n */\nfunction isLength(value) {\n  return typeof value == 'number' && value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\n/**\n * Checks if `value` is classified as an `arguments` object.\n *\n * @static\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is correctly classified, else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nfunction isArguments(value) {\n  return isObjectLike(value) && isArrayLike(value) &&\n    hasOwnProperty.call(value, 'callee') && !propertyIsEnumerable.call(value, 'callee');\n}\n\nmodule.exports = isArguments;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/lodash.isarguments/index.js\n ** module id = 15\n ** module chunks = 0\n **/","/**\n * lodash 3.0.4 (Custom Build) <https://lodash.com/>\n * Build: `lodash modern modularize exports=\"npm\" -o ./`\n * Copyright 2012-2015 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <https://lodash.com/license>\n */\n\n/** `Object#toString` result references. */\nvar arrayTag = '[object Array]',\n    funcTag = '[object Function]';\n\n/** Used to detect host constructors (Safari > 5). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/**\n * Checks if `value` is object-like.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/** Used for native method references. */\nvar objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar fnToString = Function.prototype.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the [`toStringTag`](http://ecma-international.org/ecma-262/6.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objToString = objectProto.toString;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  fnToString.call(hasOwnProperty).replace(/[\\\\^$.*+?()[\\]{}|]/g, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/* Native method references for those with the same name as other `lodash` methods. */\nvar nativeIsArray = getNative(Array, 'isArray');\n\n/**\n * Used as the [maximum length](http://ecma-international.org/ecma-262/6.0/#sec-number.max_safe_integer)\n * of an array-like value.\n */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = object == null ? undefined : object[key];\n  return isNative(value) ? value : undefined;\n}\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This function is based on [`ToLength`](http://ecma-international.org/ecma-262/6.0/#sec-tolength).\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n */\nfunction isLength(value) {\n  return typeof value == 'number' && value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\n/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is correctly classified, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(function() { return arguments; }());\n * // => false\n */\nvar isArray = nativeIsArray || function(value) {\n  return isObjectLike(value) && isLength(value.length) && objToString.call(value) == arrayTag;\n};\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is correctly classified, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in older versions of Chrome and Safari which return 'function' for regexes\n  // and Safari 8 equivalents which return 'object' for typed array constructors.\n  return isObject(value) && objToString.call(value) == funcTag;\n}\n\n/**\n * Checks if `value` is the [language type](https://es5.github.io/#x8) of `Object`.\n * (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(1);\n * // => false\n */\nfunction isObject(value) {\n  // Avoid a V8 JIT bug in Chrome 19-20.\n  // See https://code.google.com/p/v8/issues/detail?id=2291 for more details.\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is a native function.\n *\n * @static\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function, else `false`.\n * @example\n *\n * _.isNative(Array.prototype.push);\n * // => true\n *\n * _.isNative(_);\n * // => false\n */\nfunction isNative(value) {\n  if (value == null) {\n    return false;\n  }\n  if (isFunction(value)) {\n    return reIsNative.test(fnToString.call(value));\n  }\n  return isObjectLike(value) && reIsHostCtor.test(value);\n}\n\nmodule.exports = isArray;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/lodash.isarray/index.js\n ** module id = 16\n ** module chunks = 0\n **/","/**\n * lodash 3.0.1 (Custom Build) <https://lodash.com/>\n * Build: `lodash modern modularize exports=\"npm\" -o ./`\n * Copyright 2012-2015 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <https://lodash.com/license>\n */\n\n/**\n * A specialized version of `baseCallback` which only supports `this` binding\n * and specifying the number of arguments to provide to `func`.\n *\n * @private\n * @param {Function} func The function to bind.\n * @param {*} thisArg The `this` binding of `func`.\n * @param {number} [argCount] The number of arguments to provide to `func`.\n * @returns {Function} Returns the callback.\n */\nfunction bindCallback(func, thisArg, argCount) {\n  if (typeof func != 'function') {\n    return identity;\n  }\n  if (thisArg === undefined) {\n    return func;\n  }\n  switch (argCount) {\n    case 1: return function(value) {\n      return func.call(thisArg, value);\n    };\n    case 3: return function(value, index, collection) {\n      return func.call(thisArg, value, index, collection);\n    };\n    case 4: return function(accumulator, value, index, collection) {\n      return func.call(thisArg, accumulator, value, index, collection);\n    };\n    case 5: return function(value, other, key, object, source) {\n      return func.call(thisArg, value, other, key, object, source);\n    };\n  }\n  return function() {\n    return func.apply(thisArg, arguments);\n  };\n}\n\n/**\n * This method returns the first argument provided to it.\n *\n * @static\n * @memberOf _\n * @category Utility\n * @param {*} value Any value.\n * @returns {*} Returns `value`.\n * @example\n *\n * var object = { 'user': 'fred' };\n *\n * _.identity(object) === object;\n * // => true\n */\nfunction identity(value) {\n  return value;\n}\n\nmodule.exports = bindCallback;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/lodash._bindcallback/index.js\n ** module id = 17\n ** module chunks = 0\n **/","/**\n * lodash 3.2.0 (Custom Build) <https://lodash.com/>\n * Build: `lodash modern modularize exports=\"npm\" -o ./`\n * Copyright 2012-2015 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <https://lodash.com/license>\n */\nvar baseAssign = require('lodash._baseassign'),\n    createAssigner = require('lodash._createassigner'),\n    keys = require('lodash.keys');\n\n/**\n * A specialized version of `_.assign` for customizing assigned values without\n * support for argument juggling, multiple sources, and `this` binding `customizer`\n * functions.\n *\n * @private\n * @param {Object} object The destination object.\n * @param {Object} source The source object.\n * @param {Function} customizer The function to customize assigned values.\n * @returns {Object} Returns `object`.\n */\nfunction assignWith(object, source, customizer) {\n  var index = -1,\n      props = keys(source),\n      length = props.length;\n\n  while (++index < length) {\n    var key = props[index],\n        value = object[key],\n        result = customizer(value, source[key], key, object, source);\n\n    if ((result === result ? (result !== value) : (value === value)) ||\n        (value === undefined && !(key in object))) {\n      object[key] = result;\n    }\n  }\n  return object;\n}\n\n/**\n * Assigns own enumerable properties of source object(s) to the destination\n * object. Subsequent sources overwrite property assignments of previous sources.\n * If `customizer` is provided it is invoked to produce the assigned values.\n * The `customizer` is bound to `thisArg` and invoked with five arguments:\n * (objectValue, sourceValue, key, object, source).\n *\n * **Note:** This method mutates `object` and is based on\n * [`Object.assign`](https://people.mozilla.org/~jorendorff/es6-draft.html#sec-object.assign).\n *\n * @static\n * @memberOf _\n * @alias extend\n * @category Object\n * @param {Object} object The destination object.\n * @param {...Object} [sources] The source objects.\n * @param {Function} [customizer] The function to customize assigned values.\n * @param {*} [thisArg] The `this` binding of `customizer`.\n * @returns {Object} Returns `object`.\n * @example\n *\n * _.assign({ 'user': 'barney' }, { 'age': 40 }, { 'user': 'fred' });\n * // => { 'user': 'fred', 'age': 40 }\n *\n * // using a customizer callback\n * var defaults = _.partialRight(_.assign, function(value, other) {\n *   return _.isUndefined(value) ? other : value;\n * });\n *\n * defaults({ 'user': 'barney' }, { 'age': 36 }, { 'user': 'fred' });\n * // => { 'user': 'barney', 'age': 36 }\n */\nvar assign = createAssigner(function(object, source, customizer) {\n  return customizer\n    ? assignWith(object, source, customizer)\n    : baseAssign(object, source);\n});\n\nmodule.exports = assign;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/lodash.assign/index.js\n ** module id = 18\n ** module chunks = 0\n **/","/**\n * lodash 3.2.0 (Custom Build) <https://lodash.com/>\n * Build: `lodash modern modularize exports=\"npm\" -o ./`\n * Copyright 2012-2015 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <https://lodash.com/license>\n */\nvar baseCopy = require('lodash._basecopy'),\n    keys = require('lodash.keys');\n\n/**\n * The base implementation of `_.assign` without support for argument juggling,\n * multiple sources, and `customizer` functions.\n *\n * @private\n * @param {Object} object The destination object.\n * @param {Object} source The source object.\n * @returns {Object} Returns `object`.\n */\nfunction baseAssign(object, source) {\n  return source == null\n    ? object\n    : baseCopy(source, keys(source), object);\n}\n\nmodule.exports = baseAssign;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/lodash._baseassign/index.js\n ** module id = 19\n ** module chunks = 0\n **/","/**\n * lodash 3.0.1 (Custom Build) <https://lodash.com/>\n * Build: `lodash modern modularize exports=\"npm\" -o ./`\n * Copyright 2012-2015 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <https://lodash.com/license>\n */\n\n/**\n * Copies properties of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy properties from.\n * @param {Array} props The property names to copy.\n * @param {Object} [object={}] The object to copy properties to.\n * @returns {Object} Returns `object`.\n */\nfunction baseCopy(source, props, object) {\n  object || (object = {});\n\n  var index = -1,\n      length = props.length;\n\n  while (++index < length) {\n    var key = props[index];\n    object[key] = source[key];\n  }\n  return object;\n}\n\nmodule.exports = baseCopy;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/lodash._basecopy/index.js\n ** module id = 20\n ** module chunks = 0\n **/","/**\n * lodash 3.1.1 (Custom Build) <https://lodash.com/>\n * Build: `lodash modern modularize exports=\"npm\" -o ./`\n * Copyright 2012-2015 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <https://lodash.com/license>\n */\nvar bindCallback = require('lodash._bindcallback'),\n    isIterateeCall = require('lodash._isiterateecall'),\n    restParam = require('lodash.restparam');\n\n/**\n * Creates a function that assigns properties of source object(s) to a given\n * destination object.\n *\n * **Note:** This function is used to create `_.assign`, `_.defaults`, and `_.merge`.\n *\n * @private\n * @param {Function} assigner The function to assign values.\n * @returns {Function} Returns the new assigner function.\n */\nfunction createAssigner(assigner) {\n  return restParam(function(object, sources) {\n    var index = -1,\n        length = object == null ? 0 : sources.length,\n        customizer = length > 2 ? sources[length - 2] : undefined,\n        guard = length > 2 ? sources[2] : undefined,\n        thisArg = length > 1 ? sources[length - 1] : undefined;\n\n    if (typeof customizer == 'function') {\n      customizer = bindCallback(customizer, thisArg, 5);\n      length -= 2;\n    } else {\n      customizer = typeof thisArg == 'function' ? thisArg : undefined;\n      length -= (customizer ? 1 : 0);\n    }\n    if (guard && isIterateeCall(sources[0], sources[1], guard)) {\n      customizer = length < 3 ? undefined : customizer;\n      length = 1;\n    }\n    while (++index < length) {\n      var source = sources[index];\n      if (source) {\n        assigner(object, source, customizer);\n      }\n    }\n    return object;\n  });\n}\n\nmodule.exports = createAssigner;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/lodash._createassigner/index.js\n ** module id = 21\n ** module chunks = 0\n **/","/**\n * lodash 3.0.9 (Custom Build) <https://lodash.com/>\n * Build: `lodash modern modularize exports=\"npm\" -o ./`\n * Copyright 2012-2015 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <https://lodash.com/license>\n */\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^\\d+$/;\n\n/**\n * Used as the [maximum length](https://people.mozilla.org/~jorendorff/es6-draft.html#sec-number.max_safe_integer)\n * of an array-like value.\n */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/**\n * The base implementation of `_.property` without support for deep paths.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @returns {Function} Returns the new function.\n */\nfunction baseProperty(key) {\n  return function(object) {\n    return object == null ? undefined : object[key];\n  };\n}\n\n/**\n * Gets the \"length\" property value of `object`.\n *\n * **Note:** This function is used to avoid a [JIT bug](https://bugs.webkit.org/show_bug.cgi?id=142792)\n * that affects Safari on at least iOS 8.1-8.3 ARM64.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {*} Returns the \"length\" value.\n */\nvar getLength = baseProperty('length');\n\n/**\n * Checks if `value` is array-like.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(getLength(value));\n}\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  value = (typeof value == 'number' || reIsUint.test(value)) ? +value : -1;\n  length = length == null ? MAX_SAFE_INTEGER : length;\n  return value > -1 && value % 1 == 0 && value < length;\n}\n\n/**\n * Checks if the provided arguments are from an iteratee call.\n *\n * @private\n * @param {*} value The potential iteratee value argument.\n * @param {*} index The potential iteratee index or key argument.\n * @param {*} object The potential iteratee object argument.\n * @returns {boolean} Returns `true` if the arguments are from an iteratee call, else `false`.\n */\nfunction isIterateeCall(value, index, object) {\n  if (!isObject(object)) {\n    return false;\n  }\n  var type = typeof index;\n  if (type == 'number'\n      ? (isArrayLike(object) && isIndex(index, object.length))\n      : (type == 'string' && index in object)) {\n    var other = object[index];\n    return value === value ? (value === other) : (other !== other);\n  }\n  return false;\n}\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This function is based on [`ToLength`](https://people.mozilla.org/~jorendorff/es6-draft.html#sec-tolength).\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n */\nfunction isLength(value) {\n  return typeof value == 'number' && value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\n/**\n * Checks if `value` is the [language type](https://es5.github.io/#x8) of `Object`.\n * (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(1);\n * // => false\n */\nfunction isObject(value) {\n  // Avoid a V8 JIT bug in Chrome 19-20.\n  // See https://code.google.com/p/v8/issues/detail?id=2291 for more details.\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\nmodule.exports = isIterateeCall;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/lodash._isiterateecall/index.js\n ** module id = 22\n ** module chunks = 0\n **/","/**\n * lodash 3.6.1 (Custom Build) <https://lodash.com/>\n * Build: `lodash modern modularize exports=\"npm\" -o ./`\n * Copyright 2012-2015 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <https://lodash.com/license>\n */\n\n/** Used as the `TypeError` message for \"Functions\" methods. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/* Native method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * Creates a function that invokes `func` with the `this` binding of the\n * created function and arguments from `start` and beyond provided as an array.\n *\n * **Note:** This method is based on the [rest parameter](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/rest_parameters).\n *\n * @static\n * @memberOf _\n * @category Function\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @returns {Function} Returns the new function.\n * @example\n *\n * var say = _.restParam(function(what, names) {\n *   return what + ' ' + _.initial(names).join(', ') +\n *     (_.size(names) > 1 ? ', & ' : '') + _.last(names);\n * });\n *\n * say('hello', 'fred', 'barney', 'pebbles');\n * // => 'hello fred, barney, & pebbles'\n */\nfunction restParam(func, start) {\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  start = nativeMax(start === undefined ? (func.length - 1) : (+start || 0), 0);\n  return function() {\n    var args = arguments,\n        index = -1,\n        length = nativeMax(args.length - start, 0),\n        rest = Array(length);\n\n    while (++index < length) {\n      rest[index] = args[start + index];\n    }\n    switch (start) {\n      case 0: return func.call(this, rest);\n      case 1: return func.call(this, args[0], rest);\n      case 2: return func.call(this, args[0], args[1], rest);\n    }\n    var otherArgs = Array(start + 1);\n    index = -1;\n    while (++index < start) {\n      otherArgs[index] = args[index];\n    }\n    otherArgs[start] = rest;\n    return func.apply(this, otherArgs);\n  };\n}\n\nmodule.exports = restParam;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/lodash.restparam/index.js\n ** module id = 23\n ** module chunks = 0\n **/","module.exports = new RegExp(\n\t'^' +\n\n\t// protocol identifier\n\t'(?:(?:(?:https?):)?//)' +\n\n\t// user:pass authentication\n\t'(?:\\\\S+(?::\\\\S*)?@)?' +\n\t'(?:' +\n\n\t// IP address exclusion\n\t// private & local networks\n\t'(' +\n\t'(?!(?:10|127)(?:\\\\.\\\\d{1,3}){3})' +\n\t'(?!(?:169\\\\.254|192\\\\.168)(?:\\\\.\\\\d{1,3}){2})' +\n\t'(?!172\\\\.(?:1[6-9]|2\\\\d|3[0-1])(?:\\\\.\\\\d{1,3}){2})' +\n\n\t// IP address dotted notation octets\n\t// excludes loopback network 0.0.0.0\n\t// excludes reserved space >= 224.0.0.0\n\t// excludes network & broacast addresses\n\t// (first & last IP address of each class)\n\t'(?:[1-9]\\\\d?|1\\\\d\\\\d|2[01]\\\\d|22[0-3])' +\n\t'(?:\\\\.(?:1?\\\\d{1,2}|2[0-4]\\\\d|25[0-5])){2}' +\n\t'(?:\\\\.(?:[1-9]\\\\d?|1\\\\d\\\\d|2[0-4]\\\\d|25[0-4]))' +\n\t'|' +\n\n\t// host name\n\t'(?:(?:[a-z\\\\u00a1-\\\\uffff0-9]-*)*[a-z\\\\u00a1-\\\\uffff0-9]+)' +\n\n\t// domain name\n\t'(?:\\\\.(?:[a-z\\\\u00a1-\\\\uffff0-9]-*)*[a-z\\\\u00a1-\\\\uffff0-9]+)*' +\n\n\t// TLD identifier\n\t'(?:\\\\.(?:[a-z\\\\u00a1-\\\\uffff]{2,}))?' +\n\t')' +\n\n\t')' +\n\n\t// port number\n\t'(?::(\\\\d{2,5}))?' +\n\n\t// resource path\n\t'(?:/\\\\S*)?' +\n\t'$', 'i'\n);\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/utils/urlregex.js\n ** module id = 24\n ** module chunks = 0\n **/","var map = {\n\t\"./asphalt.jpg\": 26,\n\t\"./brick-tiles.jpg\": 27,\n\t\"./bricks-normal.jpg\": 28,\n\t\"./bricks-specular.jpg\": 29,\n\t\"./bricks.jpg\": 30,\n\t\"./checkerboard.png\": 31,\n\t\"./grass.jpg\": 32,\n\t\"./metal-floor.jpg\": 33,\n\t\"./metal.jpg\": 34,\n\t\"./stone.jpg\": 35,\n\t\"./tiles.jpg\": 36,\n\t\"./weathered-wood.jpg\": 37,\n\t\"./wood.jpg\": 38\n};\nfunction webpackContext(req) {\n\treturn __webpack_require__(webpackContextResolve(req));\n};\nfunction webpackContextResolve(req) {\n\treturn map[req] || (function() { throw new Error(\"Cannot find module '\" + req + \"'.\") }());\n};\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 25;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/images ^\\.\\/.*$\n ** module id = 25\n ** module chunks = 0\n **/","module.exports = __webpack_public_path__ + \"image/asphalt.jpg\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/images/asphalt.jpg\n ** module id = 26\n ** module chunks = 0\n **/","module.exports = __webpack_public_path__ + \"image/brick-tiles.jpg\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/images/brick-tiles.jpg\n ** module id = 27\n ** module chunks = 0\n **/","module.exports = __webpack_public_path__ + \"image/bricks-normal.jpg\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/images/bricks-normal.jpg\n ** module id = 28\n ** module chunks = 0\n **/","module.exports = __webpack_public_path__ + \"image/bricks-specular.jpg\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/images/bricks-specular.jpg\n ** module id = 29\n ** module chunks = 0\n **/","module.exports = __webpack_public_path__ + \"image/bricks.jpg\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/images/bricks.jpg\n ** module id = 30\n ** module chunks = 0\n **/","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEAAQMAAABmvDolAAAABlBMVEUsLCzp6enLhVdXAAAAAWJLR0QAiAUdSAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB94KFBIOCP7R3TQAAAA4SURBVGje7dAhEgAACMOw/f/T4Gc5XKqjmlRTBQAAAAAAAAAAAAAA4AiMAQAAAAAAAAAAAADgGSyKafDiEFszywAAAABJRU5ErkJggg==\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/images/checkerboard.png\n ** module id = 31\n ** module chunks = 0\n **/","module.exports = __webpack_public_path__ + \"image/grass.jpg\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/images/grass.jpg\n ** module id = 32\n ** module chunks = 0\n **/","module.exports = __webpack_public_path__ + \"image/metal-floor.jpg\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/images/metal-floor.jpg\n ** module id = 33\n ** module chunks = 0\n **/","module.exports = __webpack_public_path__ + \"image/metal.jpg\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/images/metal.jpg\n ** module id = 34\n ** module chunks = 0\n **/","module.exports = __webpack_public_path__ + \"image/stone.jpg\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/images/stone.jpg\n ** module id = 35\n ** module chunks = 0\n **/","module.exports = __webpack_public_path__ + \"image/tiles.jpg\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/images/tiles.jpg\n ** module id = 36\n ** module chunks = 0\n **/","module.exports = __webpack_public_path__ + \"image/weathered-wood.jpg\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/images/weathered-wood.jpg\n ** module id = 37\n ** module chunks = 0\n **/","module.exports = __webpack_public_path__ + \"image/wood.jpg\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/images/wood.jpg\n ** module id = 38\n ** module chunks = 0\n **/","module.exports = (function () {\n\t'use strict';\n\n\tvar\tNEAR_DISTANCE = 3,\n\t\tmaterials = require('./materials'),\n\t\tTHREE = require('three'),\n\t\teventEmitter = require('event-emitter'),\n\n\t\txAxis = new THREE.Vector3(1, 0, 0),\n\t\tyAxis = new THREE.Vector3(0, 1, 0),\n\t\tzAxis = new THREE.Vector3(0, 0, 1),\n\n\t\tscratchVector1 = new THREE.Vector3(),\n\t\tscratchVector2 = new THREE.Vector3(),\n\n\t\tallObjects = window.WeakMap ? new window.WeakMap() : {};\n\n\tfunction distance(object, origin) {\n\t\tvar geometry;\n\n\t\tgeometry = object.geometry;\n\n\t\t//assumes object world matrix has been updated\n\t\tscratchVector1.setFromMatrixPosition(origin.matrixWorld);\n\n\t\tif (!geometry) {\n\t\t\t//first convert to world coordinate\n\t\t\tscratchVector2.setFromMatrixPosition(object.matrixWorld);\n\t\t\treturn scratchVector2.distanceTo(scratchVector1);\n\t\t}\n\n\t\tobject.worldToLocal(scratchVector1);\n\t\treturn object.geometry.boundingBox.distanceToPoint(scratchVector1);\n\t}\n\n\tfunction VRObject(parent, creator, body, options) {\n\t\tvar material,\n\t\t\tobject,\n\t\t\tself = this,\n\n\t\t\tisNear = false,\n\t\t\tisTarget = false,\n\n\t\t\tcamera = body && (function () {\n\t\t\t\tvar i,\n\t\t\t\t\tc;\n\t\t\t\tfor (i = 0; i < body.children.length; i++) {\n\t\t\t\t\tc = body.children[i];\n\t\t\t\t\tif (c instanceof THREE.PerspectiveCamera) {\n\t\t\t\t\t\treturn c;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}()),\n\t\t\tfrustum,\n\t\t\tcameraViewProjectionMatrix,\n\n\t\t\traycaster;\n\n\t\toptions = options || {};\n\n\t\teventEmitter(this);\n\n\t\tif (body) {\n\t\t\t// raycaster = new THREE.Raycaster();\n\n\t\t\tthis.update = function () {\n\t\t\t\tvar wasNear = isNear,\n\t\t\t\t\twasTarget = isTarget,\n\n\t\t\t\t\tintersects, intersect, i;\n\n\t\t\t\tisNear = self.distance < NEAR_DISTANCE;\n\t\t\t\tif (isNear !== wasNear) {\n\t\t\t\t\tif (isNear) {\n\t\t\t\t\t\tself.emit('near', self);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tself.emit('far', self);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t/*\n\t\t\t\traycaster.ray.origin.copy(origin);\n\t\t\t\traycaster.ray.direction.set(0, 0, 0.5).unproject(camera).sub(origin).normalize();\n\n\t\t\t\t//todo: consider whether this needs to be recursive. maybe a different event\n\t\t\t\tintersects = raycaster.intersectObject(object);\n\t\t\t\tif (intersects.length) {\n\t\t\t\t\tisTarget = true;\n\t\t\t\t\tif (!wasTarget) {\n\t\t\t\t\t\tself.emit('target-on', intersects[0]);\n\t\t\t\t\t}\n\t\t\t\t} else if (wasTarget) {\n\t\t\t\t\tself.emit('target-off');\n\t\t\t\t}\n\t\t\t\t*/\n\t\t\t};\n\t\t}\n\n\t\t//todo: get material from options\n\t\tthis.object = object = creator.call(this, parent, options);\n\t\tthis.parent = this.object.parent || parent;\n\n\t\tif (object instanceof THREE.Mesh) {\n\t\t\tif (options.castShadow !== false) {\n\t\t\t\tobject.castShadow = true;\n\t\t\t}\n\t\t\tif (options.receiveShadow !== false) {\n\t\t\t\tobject.receiveShadow = true;\n\t\t\t}\n\n\t\t\tif (object.geometry) {\n\t\t\t\tobject.geometry.computeBoundingBox();\n\t\t\t}\n\t\t}\n\n\t\tif (options.name !== undefined) {\n\t\t\tobject.name = options.name;\n\t\t}\n\t\tself.name = object.name;\n\n\t\tif (allObjects.set) {\n\t\t\tallObjects.set(object, this);\n\t\t} else {\n\t\t\tallObjects[object.id] = this;\n\t\t}\n\n\t\tobject.position.set(\n\t\t\tparseFloat(options.x) || 0,\n\t\t\tparseFloat(options.y) || 0,\n\t\t\tparseFloat(options.z) || 0\n\t\t);\n\n\t\tthis.setMaterial(options.material);\n\n\t\tif (options.color) {\n\t\t\tmaterial = object.material;\n\t\t\tmaterial.color = new THREE.Color(options.color);\n\t\t\tmaterial.ambient = material.color;\n\t\t}\n\n\t\t['position', 'scale', 'rotation', 'quaternion', 'material'].forEach(function (prop) {\n\t\t\tif (prop in object && !self[prop]) {\n\t\t\t\tself[prop] = object[prop];\n\t\t\t}\n\t\t});\n\n\t\tObject.defineProperty(this, 'visible', {\n\t\t\tset: function (val) {\n\t\t\t\tself.object.visible = !!val;\n\t\t\t},\n\t\t\tget: function () {\n\t\t\t\treturn self.object.visible;\n\t\t\t}\n\t\t});\n\n\t\tObject.defineProperty(this, 'distance', {\n\t\t\tget: function () {\n\t\t\t\treturn distance(self.object, body || parent);\n\t\t\t}\n\t\t});\n\n\t\tif (camera) {\n\t\t\tfrustum = new THREE.Frustum();\n\t\t\tcameraViewProjectionMatrix = new THREE.Matrix4();\n\t\t\tObject.defineProperty(this, 'inView', {\n\t\t\t\tget: function () {\n\t\t\t\t\tcamera.updateMatrixWorld(); // make sure the camera matrix is updated\n\t\t\t\t\tcamera.matrixWorldInverse.getInverse(camera.matrixWorld);\n\t\t\t\t\tcameraViewProjectionMatrix.multiplyMatrices(camera.projectionMatrix, camera.matrixWorldInverse);\n\t\t\t\t\tfrustum.setFromMatrix(cameraViewProjectionMatrix);\n\t\t\t\t\treturn frustum.intersectsObject(self.object);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tVRObject.prototype.hide = function () {\n\t\tthis.object.visible = false;\n\t\treturn this;\n\t};\n\n\tVRObject.prototype.show = function () {\n\t\tthis.object.visible = true;\n\t\treturn this;\n\t};\n\n\tVRObject.prototype.moveTo = function (x, y, z) {\n\t\tvar position = this.object.position;\n\n\t\tx = !isNaN(x) ? x : position.x;\n\t\ty = !isNaN(y) ? y : position.y;\n\t\tz = !isNaN(z) ? z : position.z;\n\n\t\tposition.set(x, y, z);\n\n\t\treturn this;\n\t};\n\n\tVRObject.prototype.moveX = function (distance) {\n\t\tthis.object.translateX(distance);\n\t\treturn this;\n\t};\n\n\tVRObject.prototype.moveY = function (distance) {\n\t\tthis.object.translateY(distance);\n\t\treturn this;\n\t};\n\tVRObject.prototype.moveUp = VRObject.prototype.moveY;\n\tVRObject.prototype.moveDown = function (distance) {\n\t\tthis.moveY(-distance);\n\t\treturn this;\n\t};\n\n\tVRObject.prototype.moveZ = function (distance) {\n\t\tthis.object.translateZ(distance);\n\t\treturn this;\n\t};\n\n\tVRObject.prototype.rotateX = function (angle) {\n\t\tthis.object.rotateOnAxis(xAxis, angle);\n\t\treturn this;\n\t};\n\n\tVRObject.prototype.rotateY = function (angle) {\n\t\tthis.object.rotateOnAxis(yAxis, angle);\n\t\treturn this;\n\t};\n\n\tVRObject.prototype.rotateZ = function (angle) {\n\t\tthis.object.rotateOnAxis(zAxis, angle);\n\t\treturn this;\n\t};\n\n\tVRObject.prototype.setScale = function (x, y, z) {\n\t\tvar scale = this.object.scale;\n\n\t\tif (x !== undefined && !isNaN(x)) {\n\t\t\tif (y === undefined && z === undefined) {\n\t\t\t\ty = z = x;\n\t\t\t}\n\t\t}\n\n\t\tx = !isNaN(x) ? x : scale.x;\n\t\ty = !isNaN(y) ? y : scale.y;\n\t\tz = !isNaN(z) ? z : scale.z;\n\n\t\tscale.set(x, y, z);\n\n\t\treturn this;\n\t};\n\n\tVRObject.prototype.setMaterial = function (material, options) {\n\t\tif (material && this.object instanceof THREE.Mesh) {\n\t\t\tif (typeof material === 'function') {\n\t\t\t\tmaterial = material();\n\t\t\t} else if (typeof material === 'string' && materials[material]) {\n\t\t\t\tmaterial = materials[material](options);\n\t\t\t} else if (material && !(material instanceof THREE.Material) && typeof material !== 'number') {\n\t\t\t\ttry {\n\t\t\t\t\tmaterial = materials.material(material);\n\t\t\t\t} catch (e) {}\n\t\t\t}\n\n\t\t\tif (material instanceof THREE.Material) {\n\t\t\t\tthis.object.material = material;\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t};\n\n\tVRObject.prototype.update = function () {};\n\n\tVRObject.prototype.raycastable = true;\n\n\tVRObject.repeat = function (count, options) {\n\t\tvar i,\n\t\t\tchange = false,\n\t\t\tlastObject = this,\n\t\t\tcurrentPosition = new THREE.Vector3(),\n\t\t\tdeltaPosition = new THREE.Vector3(),\n\t\t\tcurrentQuaternion = new THREE.Quaternion(),\n\t\t\tdeltaQuaternion = new THREE.Quaternion();\n\n\t\tif (!options) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (options.offset) {}\n\n\t\tfor (i = 0; i < count; i++) {\n\n\t\t}\n\t};\n\n\tVRObject.findObject = function (object) {\n\t\tif (object instanceof VRObject) {\n\t\t\treturn object;\n\t\t}\n\n\t\tif (object && object instanceof THREE.Object3D) {\n\t\t\tif (allObjects.get) {\n\t\t\t\treturn allObjects.get(object);\n\t\t\t}\n\n\t\t\treturn allObjects[object.id];\n\t\t}\n\n\t\t// if (typeof object === 'number') {\n\t\t// \treturn allObjects[object];\n\t\t// }\n\t};\n\n\treturn VRObject;\n\n}());\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/vr-object.js\n ** module id = 39\n ** module chunks = 0\n **/","'use strict';\n\nvar d        = require('d')\n  , callable = require('es5-ext/object/valid-callable')\n\n  , apply = Function.prototype.apply, call = Function.prototype.call\n  , create = Object.create, defineProperty = Object.defineProperty\n  , defineProperties = Object.defineProperties\n  , hasOwnProperty = Object.prototype.hasOwnProperty\n  , descriptor = { configurable: true, enumerable: false, writable: true }\n\n  , on, once, off, emit, methods, descriptors, base;\n\non = function (type, listener) {\n\tvar data;\n\n\tcallable(listener);\n\n\tif (!hasOwnProperty.call(this, '__ee__')) {\n\t\tdata = descriptor.value = create(null);\n\t\tdefineProperty(this, '__ee__', descriptor);\n\t\tdescriptor.value = null;\n\t} else {\n\t\tdata = this.__ee__;\n\t}\n\tif (!data[type]) data[type] = listener;\n\telse if (typeof data[type] === 'object') data[type].push(listener);\n\telse data[type] = [data[type], listener];\n\n\treturn this;\n};\n\nonce = function (type, listener) {\n\tvar once, self;\n\n\tcallable(listener);\n\tself = this;\n\ton.call(this, type, once = function () {\n\t\toff.call(self, type, once);\n\t\tapply.call(listener, this, arguments);\n\t});\n\n\tonce.__eeOnceListener__ = listener;\n\treturn this;\n};\n\noff = function (type, listener) {\n\tvar data, listeners, candidate, i;\n\n\tcallable(listener);\n\n\tif (!hasOwnProperty.call(this, '__ee__')) return this;\n\tdata = this.__ee__;\n\tif (!data[type]) return this;\n\tlisteners = data[type];\n\n\tif (typeof listeners === 'object') {\n\t\tfor (i = 0; (candidate = listeners[i]); ++i) {\n\t\t\tif ((candidate === listener) ||\n\t\t\t\t\t(candidate.__eeOnceListener__ === listener)) {\n\t\t\t\tif (listeners.length === 2) data[type] = listeners[i ? 0 : 1];\n\t\t\t\telse listeners.splice(i, 1);\n\t\t\t}\n\t\t}\n\t} else {\n\t\tif ((listeners === listener) ||\n\t\t\t\t(listeners.__eeOnceListener__ === listener)) {\n\t\t\tdelete data[type];\n\t\t}\n\t}\n\n\treturn this;\n};\n\nemit = function (type) {\n\tvar i, l, listener, listeners, args;\n\n\tif (!hasOwnProperty.call(this, '__ee__')) return;\n\tlisteners = this.__ee__[type];\n\tif (!listeners) return;\n\n\tif (typeof listeners === 'object') {\n\t\tl = arguments.length;\n\t\targs = new Array(l - 1);\n\t\tfor (i = 1; i < l; ++i) args[i - 1] = arguments[i];\n\n\t\tlisteners = listeners.slice();\n\t\tfor (i = 0; (listener = listeners[i]); ++i) {\n\t\t\tapply.call(listener, this, args);\n\t\t}\n\t} else {\n\t\tswitch (arguments.length) {\n\t\tcase 1:\n\t\t\tcall.call(listeners, this);\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tcall.call(listeners, this, arguments[1]);\n\t\t\tbreak;\n\t\tcase 3:\n\t\t\tcall.call(listeners, this, arguments[1], arguments[2]);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tl = arguments.length;\n\t\t\targs = new Array(l - 1);\n\t\t\tfor (i = 1; i < l; ++i) {\n\t\t\t\targs[i - 1] = arguments[i];\n\t\t\t}\n\t\t\tapply.call(listeners, this, args);\n\t\t}\n\t}\n};\n\nmethods = {\n\ton: on,\n\tonce: once,\n\toff: off,\n\temit: emit\n};\n\ndescriptors = {\n\ton: d(on),\n\tonce: d(once),\n\toff: d(off),\n\temit: d(emit)\n};\n\nbase = defineProperties({}, descriptors);\n\nmodule.exports = exports = function (o) {\n\treturn (o == null) ? create(base) : defineProperties(Object(o), descriptors);\n};\nexports.methods = methods;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/event-emitter/index.js\n ** module id = 40\n ** module chunks = 0\n **/","'use strict';\n\nvar assign        = require('es5-ext/object/assign')\n  , normalizeOpts = require('es5-ext/object/normalize-options')\n  , isCallable    = require('es5-ext/object/is-callable')\n  , contains      = require('es5-ext/string/#/contains')\n\n  , d;\n\nd = module.exports = function (dscr, value/*, options*/) {\n\tvar c, e, w, options, desc;\n\tif ((arguments.length < 2) || (typeof dscr !== 'string')) {\n\t\toptions = value;\n\t\tvalue = dscr;\n\t\tdscr = null;\n\t} else {\n\t\toptions = arguments[2];\n\t}\n\tif (dscr == null) {\n\t\tc = w = true;\n\t\te = false;\n\t} else {\n\t\tc = contains.call(dscr, 'c');\n\t\te = contains.call(dscr, 'e');\n\t\tw = contains.call(dscr, 'w');\n\t}\n\n\tdesc = { value: value, configurable: c, enumerable: e, writable: w };\n\treturn !options ? desc : assign(normalizeOpts(options), desc);\n};\n\nd.gs = function (dscr, get, set/*, options*/) {\n\tvar c, e, options, desc;\n\tif (typeof dscr !== 'string') {\n\t\toptions = set;\n\t\tset = get;\n\t\tget = dscr;\n\t\tdscr = null;\n\t} else {\n\t\toptions = arguments[3];\n\t}\n\tif (get == null) {\n\t\tget = undefined;\n\t} else if (!isCallable(get)) {\n\t\toptions = get;\n\t\tget = set = undefined;\n\t} else if (set == null) {\n\t\tset = undefined;\n\t} else if (!isCallable(set)) {\n\t\toptions = set;\n\t\tset = undefined;\n\t}\n\tif (dscr == null) {\n\t\tc = true;\n\t\te = false;\n\t} else {\n\t\tc = contains.call(dscr, 'c');\n\t\te = contains.call(dscr, 'e');\n\t}\n\n\tdesc = { get: get, set: set, configurable: c, enumerable: e };\n\treturn !options ? desc : assign(normalizeOpts(options), desc);\n};\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/d/index.js\n ** module id = 41\n ** module chunks = 0\n **/","'use strict';\n\nmodule.exports = require('./is-implemented')()\n\t? Object.assign\n\t: require('./shim');\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/es5-ext/object/assign/index.js\n ** module id = 42\n ** module chunks = 0\n **/","'use strict';\n\nmodule.exports = function () {\n\tvar assign = Object.assign, obj;\n\tif (typeof assign !== 'function') return false;\n\tobj = { foo: 'raz' };\n\tassign(obj, { bar: 'dwa' }, { trzy: 'trzy' });\n\treturn (obj.foo + obj.bar + obj.trzy) === 'razdwatrzy';\n};\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/es5-ext/object/assign/is-implemented.js\n ** module id = 43\n ** module chunks = 0\n **/","'use strict';\n\nvar keys  = require('../keys')\n  , value = require('../valid-value')\n\n  , max = Math.max;\n\nmodule.exports = function (dest, src/*, srcn*/) {\n\tvar error, i, l = max(arguments.length, 2), assign;\n\tdest = Object(value(dest));\n\tassign = function (key) {\n\t\ttry { dest[key] = src[key]; } catch (e) {\n\t\t\tif (!error) error = e;\n\t\t}\n\t};\n\tfor (i = 1; i < l; ++i) {\n\t\tsrc = arguments[i];\n\t\tkeys(src).forEach(assign);\n\t}\n\tif (error !== undefined) throw error;\n\treturn dest;\n};\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/es5-ext/object/assign/shim.js\n ** module id = 44\n ** module chunks = 0\n **/","'use strict';\n\nmodule.exports = require('./is-implemented')()\n\t? Object.keys\n\t: require('./shim');\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/es5-ext/object/keys/index.js\n ** module id = 45\n ** module chunks = 0\n **/","'use strict';\n\nmodule.exports = function () {\n\ttry {\n\t\tObject.keys('primitive');\n\t\treturn true;\n\t} catch (e) { return false; }\n};\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/es5-ext/object/keys/is-implemented.js\n ** module id = 46\n ** module chunks = 0\n **/","'use strict';\n\nvar keys = Object.keys;\n\nmodule.exports = function (object) {\n\treturn keys(object == null ? object : Object(object));\n};\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/es5-ext/object/keys/shim.js\n ** module id = 47\n ** module chunks = 0\n **/","'use strict';\n\nmodule.exports = function (value) {\n\tif (value == null) throw new TypeError(\"Cannot use null or undefined\");\n\treturn value;\n};\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/es5-ext/object/valid-value.js\n ** module id = 48\n ** module chunks = 0\n **/","'use strict';\n\nvar forEach = Array.prototype.forEach, create = Object.create;\n\nvar process = function (src, obj) {\n\tvar key;\n\tfor (key in src) obj[key] = src[key];\n};\n\nmodule.exports = function (options/*, options*/) {\n\tvar result = create(null);\n\tforEach.call(arguments, function (options) {\n\t\tif (options == null) return;\n\t\tprocess(Object(options), result);\n\t});\n\treturn result;\n};\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/es5-ext/object/normalize-options.js\n ** module id = 49\n ** module chunks = 0\n **/","// Deprecated\n\n'use strict';\n\nmodule.exports = function (obj) { return typeof obj === 'function'; };\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/es5-ext/object/is-callable.js\n ** module id = 50\n ** module chunks = 0\n **/","'use strict';\n\nmodule.exports = require('./is-implemented')()\n\t? String.prototype.contains\n\t: require('./shim');\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/es5-ext/string/#/contains/index.js\n ** module id = 51\n ** module chunks = 0\n **/","'use strict';\n\nvar str = 'razdwatrzy';\n\nmodule.exports = function () {\n\tif (typeof str.contains !== 'function') return false;\n\treturn ((str.contains('dwa') === true) && (str.contains('foo') === false));\n};\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/es5-ext/string/#/contains/is-implemented.js\n ** module id = 52\n ** module chunks = 0\n **/","'use strict';\n\nvar indexOf = String.prototype.indexOf;\n\nmodule.exports = function (searchString/*, position*/) {\n\treturn indexOf.call(this, searchString, arguments[1]) > -1;\n};\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/es5-ext/string/#/contains/shim.js\n ** module id = 53\n ** module chunks = 0\n **/","'use strict';\n\nmodule.exports = function (fn) {\n\tif (typeof fn !== 'function') throw new TypeError(fn + \" is not a function\");\n\treturn fn;\n};\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/es5-ext/object/valid-callable.js\n ** module id = 54\n ** module chunks = 0\n **/","module.exports = (function () {\n\t'use strict';\n\n\tvar materials = require('../materials'),\n\t\tTHREE = require('three');\n\n\treturn function empty(parent, options) {\n\t\tvar obj = new THREE.Object3D();\n\n\t\tobj.name = 'empty';\n\n\t\tparent.add(obj);\n\n\t\treturn obj;\n\t};\n}());\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/objects/empty.js\n ** module id = 55\n ** module chunks = 0\n **/","/*** IMPORTS FROM imports-loader ***/\nvar THREE = require(\"three\");\n\n/**\n * @author richt / http://richt.me\n * @author WestLangley / http://github.com/WestLangley\n *\n * W3C Device Orientation control (http://w3c.github.io/deviceorientation/spec-source-orientation.html)\n */\n\nTHREE.DeviceOrientationControls = function ( object ) {\n\n\tvar scope = this;\n\n\tthis.object = object;\n\tthis.object.rotation.reorder( \"YXZ\" );\n\n\tthis.enabled = true;\n\n\tthis.deviceOrientation = {};\n\tthis.screenOrientation = 0;\n\n\tvar onDeviceOrientationChangeEvent = function ( event ) {\n\n\t\tscope.deviceOrientation = event;\n\n\t};\n\n\tvar onScreenOrientationChangeEvent = function () {\n\n\t\tscope.screenOrientation = window.orientation || 0;\n\n\t};\n\n\t// The angles alpha, beta and gamma form a set of intrinsic Tait-Bryan angles of type Z-X'-Y''\n\n\tvar setObjectQuaternion = function () {\n\n\t\tvar zee = new THREE.Vector3( 0, 0, 1 );\n\n\t\tvar euler = new THREE.Euler();\n\n\t\tvar q0 = new THREE.Quaternion();\n\n\t\tvar q1 = new THREE.Quaternion( - Math.sqrt( 0.5 ), 0, 0, Math.sqrt( 0.5 ) ); // - PI/2 around the x-axis\n\n\t\treturn function ( quaternion, alpha, beta, gamma, orient ) {\n\n\t\t\teuler.set( beta, alpha, - gamma, 'YXZ' );                       // 'ZXY' for the device, but 'YXZ' for us\n\n\t\t\tquaternion.setFromEuler( euler );                               // orient the device\n\n\t\t\tquaternion.multiply( q1 );                                      // camera looks out the back of the device, not the top\n\n\t\t\tquaternion.multiply( q0.setFromAxisAngle( zee, - orient ) );    // adjust for screen orientation\n\n\t\t}\n\n\t}();\n\n\tthis.connect = function() {\n\n\t\tonScreenOrientationChangeEvent(); // run once on load\n\n\t\twindow.addEventListener( 'orientationchange', onScreenOrientationChangeEvent, false );\n\t\twindow.addEventListener( 'deviceorientation', onDeviceOrientationChangeEvent, false );\n\n\t\tscope.enabled = true;\n\n\t};\n\n\tthis.disconnect = function() {\n\n\t\twindow.removeEventListener( 'orientationchange', onScreenOrientationChangeEvent, false );\n\t\twindow.removeEventListener( 'deviceorientation', onDeviceOrientationChangeEvent, false );\n\n\t\tscope.enabled = false;\n\n\t};\n\n\tthis.update = function () {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tvar alpha  = scope.deviceOrientation.alpha ? THREE.Math.degToRad( scope.deviceOrientation.alpha ) : 0; // Z\n\t\tvar beta   = scope.deviceOrientation.beta  ? THREE.Math.degToRad( scope.deviceOrientation.beta  ) : 0; // X'\n\t\tvar gamma  = scope.deviceOrientation.gamma ? THREE.Math.degToRad( scope.deviceOrientation.gamma ) : 0; // Y''\n\t\tvar orient = scope.screenOrientation       ? THREE.Math.degToRad( scope.screenOrientation       ) : 0; // O\n\n\t\tsetObjectQuaternion( scope.object.quaternion, alpha, beta, gamma, orient );\n\n\t};\n\n\tthis.connect();\n\n};\n\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/imports-loader?THREE=three!./bower_components/DeviceOrientationControls/index.js\n ** module id = 56\n ** module chunks = 0\n **/","/*** IMPORTS FROM imports-loader ***/\nvar THREE = require(\"three\");\n\n/**\n * @author qiao / https://github.com/qiao\n * @author mrdoob / http://mrdoob.com\n * @author alteredq / http://alteredqualia.com/\n * @author WestLangley / http://github.com/WestLangley\n * @author erich666 / http://erichaines.com\n */\n/*global THREE, console */\n\n// This set of controls performs orbiting, dollying (zooming), and panning. It maintains\n// the \"up\" direction as +Y, unlike the TrackballControls. Touch on tablet and phones is\n// supported.\n//\n//    Orbit - left mouse / touch: one finger move\n//    Zoom - middle mouse, or mousewheel / touch: two finger spread or squish\n//    Pan - right mouse, or arrow keys / touch: three finter swipe\n//\n// This is a drop-in replacement for (most) TrackballControls used in examples.\n// That is, include this js file and wherever you see:\n//    \tcontrols = new THREE.TrackballControls( camera );\n//      controls.target.z = 150;\n// Simple substitute \"OrbitControls\" and the control should work as-is.\n\nTHREE.OrbitControls = function ( object, domElement ) {\n\n\tthis.object = object;\n\tthis.domElement = ( domElement !== undefined ) ? domElement : document;\n\n\t// API\n\n\t// Set to false to disable this control\n\tthis.enabled = true;\n\n\t// \"target\" sets the location of focus, where the control orbits around\n\t// and where it pans with respect to.\n\tthis.target = new THREE.Vector3();\n\n\t// center is old, deprecated; use \"target\" instead\n\tthis.center = this.target;\n\n\t// This option actually enables dollying in and out; left as \"zoom\" for\n\t// backwards compatibility\n\tthis.noZoom = false;\n\tthis.zoomSpeed = 1.0;\n\n\t// Limits to how far you can dolly in and out\n\tthis.minDistance = 0;\n\tthis.maxDistance = Infinity;\n\n\t// Set to true to disable this control\n\tthis.noRotate = false;\n\tthis.rotateSpeed = 1.0;\n\n\t// Set to true to disable this control\n\tthis.noPan = false;\n\tthis.keyPanSpeed = 7.0;\t// pixels moved per arrow key push\n\n\t// Set to true to automatically rotate around the target\n\tthis.autoRotate = false;\n\tthis.autoRotateSpeed = 2.0; // 30 seconds per round when fps is 60\n\n\t// How far you can orbit vertically, upper and lower limits.\n\t// Range is 0 to Math.PI radians.\n\tthis.minPolarAngle = 0; // radians\n\tthis.maxPolarAngle = Math.PI; // radians\n\n\t// How far you can orbit horizontally, upper and lower limits.\n\t// If set, must be a sub-interval of the interval [ - Math.PI, Math.PI ].\n\tthis.minAzimuthAngle = - Infinity; // radians\n\tthis.maxAzimuthAngle = Infinity; // radians\n\n\t// Set to true to disable use of the keys\n\tthis.noKeys = false;\n\n\t// The four arrow keys\n\tthis.keys = { LEFT: 37, UP: 38, RIGHT: 39, BOTTOM: 40 };\n\n\t// Mouse buttons\n\tthis.mouseButtons = { ORBIT: THREE.MOUSE.LEFT, ZOOM: THREE.MOUSE.MIDDLE, PAN: THREE.MOUSE.RIGHT };\n\n\t////////////\n\t// internals\n\n\tvar scope = this;\n\n\tvar EPS = 0.000001;\n\n\tvar rotateStart = new THREE.Vector2();\n\tvar rotateEnd = new THREE.Vector2();\n\tvar rotateDelta = new THREE.Vector2();\n\n\tvar panStart = new THREE.Vector2();\n\tvar panEnd = new THREE.Vector2();\n\tvar panDelta = new THREE.Vector2();\n\tvar panOffset = new THREE.Vector3();\n\n\tvar offset = new THREE.Vector3();\n\n\tvar dollyStart = new THREE.Vector2();\n\tvar dollyEnd = new THREE.Vector2();\n\tvar dollyDelta = new THREE.Vector2();\n\n\tvar theta;\n\tvar phi;\n\tvar phiDelta = 0;\n\tvar thetaDelta = 0;\n\tvar scale = 1;\n\tvar pan = new THREE.Vector3();\n\n\tvar lastPosition = new THREE.Vector3();\n\tvar lastQuaternion = new THREE.Quaternion();\n\n\tvar STATE = { NONE : -1, ROTATE : 0, DOLLY : 1, PAN : 2, TOUCH_ROTATE : 3, TOUCH_DOLLY : 4, TOUCH_PAN : 5 };\n\n\tvar state = STATE.NONE;\n\n\t// for reset\n\n\tthis.target0 = this.target.clone();\n\tthis.position0 = this.object.position.clone();\n\n\t// so camera.up is the orbit axis\n\n\tvar quat = new THREE.Quaternion().setFromUnitVectors( object.up, new THREE.Vector3( 0, 1, 0 ) );\n\tvar quatInverse = quat.clone().inverse();\n\n\t// events\n\n\tvar changeEvent = { type: 'change' };\n\tvar startEvent = { type: 'start'};\n\tvar endEvent = { type: 'end'};\n\n\tthis.rotateLeft = function ( angle ) {\n\n\t\tif ( angle === undefined ) {\n\n\t\t\tangle = getAutoRotationAngle();\n\n\t\t}\n\n\t\tthetaDelta -= angle;\n\n\t};\n\n\tthis.rotateUp = function ( angle ) {\n\n\t\tif ( angle === undefined ) {\n\n\t\t\tangle = getAutoRotationAngle();\n\n\t\t}\n\n\t\tphiDelta -= angle;\n\n\t};\n\n\t// pass in distance in world space to move left\n\tthis.panLeft = function ( distance ) {\n\n\t\tvar te = this.object.matrix.elements;\n\n\t\t// get X column of matrix\n\t\tpanOffset.set( te[ 0 ], te[ 1 ], te[ 2 ] );\n\t\tpanOffset.multiplyScalar( - distance );\n\n\t\tpan.add( panOffset );\n\n\t};\n\n\t// pass in distance in world space to move up\n\tthis.panUp = function ( distance ) {\n\n\t\tvar te = this.object.matrix.elements;\n\n\t\t// get Y column of matrix\n\t\tpanOffset.set( te[ 4 ], te[ 5 ], te[ 6 ] );\n\t\tpanOffset.multiplyScalar( distance );\n\n\t\tpan.add( panOffset );\n\n\t};\n\n\t// pass in x,y of change desired in pixel space,\n\t// right and down are positive\n\tthis.pan = function ( deltaX, deltaY ) {\n\n\t\tvar element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n\t\tif ( scope.object.fov !== undefined ) {\n\n\t\t\t// perspective\n\t\t\tvar position = scope.object.position;\n\t\t\tvar offset = position.clone().sub( scope.target );\n\t\t\tvar targetDistance = offset.length();\n\n\t\t\t// half of the fov is center to top of screen\n\t\t\ttargetDistance *= Math.tan( ( scope.object.fov / 2 ) * Math.PI / 180.0 );\n\n\t\t\t// we actually don't use screenWidth, since perspective camera is fixed to screen height\n\t\t\tscope.panLeft( 2 * deltaX * targetDistance / element.clientHeight );\n\t\t\tscope.panUp( 2 * deltaY * targetDistance / element.clientHeight );\n\n\t\t} else if ( scope.object.top !== undefined ) {\n\n\t\t\t// orthographic\n\t\t\tscope.panLeft( deltaX * (scope.object.right - scope.object.left) / element.clientWidth );\n\t\t\tscope.panUp( deltaY * (scope.object.top - scope.object.bottom) / element.clientHeight );\n\n\t\t} else {\n\n\t\t\t// camera neither orthographic or perspective\n\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.' );\n\n\t\t}\n\n\t};\n\n\tthis.dollyIn = function ( dollyScale ) {\n\n\t\tif ( dollyScale === undefined ) {\n\n\t\t\tdollyScale = getZoomScale();\n\n\t\t}\n\n\t\tscale /= dollyScale;\n\n\t};\n\n\tthis.dollyOut = function ( dollyScale ) {\n\n\t\tif ( dollyScale === undefined ) {\n\n\t\t\tdollyScale = getZoomScale();\n\n\t\t}\n\n\t\tscale *= dollyScale;\n\n\t};\n\n\tthis.update = function () {\n\n\t\tvar position = this.object.position;\n\n\t\toffset.copy( position ).sub( this.target );\n\n\t\t// rotate offset to \"y-axis-is-up\" space\n\t\toffset.applyQuaternion( quat );\n\n\t\t// angle from z-axis around y-axis\n\n\t\ttheta = Math.atan2( offset.x, offset.z );\n\n\t\t// angle from y-axis\n\n\t\tphi = Math.atan2( Math.sqrt( offset.x * offset.x + offset.z * offset.z ), offset.y );\n\n\t\tif ( this.autoRotate && state === STATE.NONE ) {\n\n\t\t\tthis.rotateLeft( getAutoRotationAngle() );\n\n\t\t}\n\n\t\ttheta += thetaDelta;\n\t\tphi += phiDelta;\n\n\t\t// restrict theta to be between desired limits\n\t\ttheta = Math.max( this.minAzimuthAngle, Math.min( this.maxAzimuthAngle, theta ) );\n\n\t\t// restrict phi to be between desired limits\n\t\tphi = Math.max( this.minPolarAngle, Math.min( this.maxPolarAngle, phi ) );\n\n\t\t// restrict phi to be betwee EPS and PI-EPS\n\t\tphi = Math.max( EPS, Math.min( Math.PI - EPS, phi ) );\n\n\t\tvar radius = offset.length() * scale;\n\n\t\t// restrict radius to be between desired limits\n\t\tradius = Math.max( this.minDistance, Math.min( this.maxDistance, radius ) );\n\n\t\t// move target to panned location\n\t\tthis.target.add( pan );\n\n\t\toffset.x = radius * Math.sin( phi ) * Math.sin( theta );\n\t\toffset.y = radius * Math.cos( phi );\n\t\toffset.z = radius * Math.sin( phi ) * Math.cos( theta );\n\n\t\t// rotate offset back to \"camera-up-vector-is-up\" space\n\t\toffset.applyQuaternion( quatInverse );\n\n\t\tposition.copy( this.target ).add( offset );\n\n\t\tthis.object.lookAt( this.target );\n\n\t\tthetaDelta = 0;\n\t\tphiDelta = 0;\n\t\tscale = 1;\n\t\tpan.set( 0, 0, 0 );\n\n\t\t// update condition is:\n\t\t// min(camera displacement, camera rotation in radians)^2 > EPS\n\t\t// using small-angle approximation cos(x/2) = 1 - x^2 / 8\n\n\t\tif ( lastPosition.distanceToSquared( this.object.position ) > EPS\n\t\t    || 8 * (1 - lastQuaternion.dot(this.object.quaternion)) > EPS ) {\n\n\t\t\tthis.dispatchEvent( changeEvent );\n\n\t\t\tlastPosition.copy( this.object.position );\n\t\t\tlastQuaternion.copy (this.object.quaternion );\n\n\t\t}\n\n\t};\n\n\n\tthis.reset = function () {\n\n\t\tstate = STATE.NONE;\n\n\t\tthis.target.copy( this.target0 );\n\t\tthis.object.position.copy( this.position0 );\n\n\t\tthis.update();\n\n\t};\n\n\tthis.getPolarAngle = function () {\n\n\t\treturn phi;\n\n\t};\n\n\tthis.getAzimuthalAngle = function () {\n\n\t\treturn theta\n\n\t};\n\n\tfunction getAutoRotationAngle() {\n\n\t\treturn 2 * Math.PI / 60 / 60 * scope.autoRotateSpeed;\n\n\t}\n\n\tfunction getZoomScale() {\n\n\t\treturn Math.pow( 0.95, scope.zoomSpeed );\n\n\t}\n\n\tfunction onMouseDown( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\t\tevent.preventDefault();\n\n\t\tif ( event.button === scope.mouseButtons.ORBIT ) {\n\t\t\tif ( scope.noRotate === true ) return;\n\n\t\t\tstate = STATE.ROTATE;\n\n\t\t\trotateStart.set( event.clientX, event.clientY );\n\n\t\t} else if ( event.button === scope.mouseButtons.ZOOM ) {\n\t\t\tif ( scope.noZoom === true ) return;\n\n\t\t\tstate = STATE.DOLLY;\n\n\t\t\tdollyStart.set( event.clientX, event.clientY );\n\n\t\t} else if ( event.button === scope.mouseButtons.PAN ) {\n\t\t\tif ( scope.noPan === true ) return;\n\n\t\t\tstate = STATE.PAN;\n\n\t\t\tpanStart.set( event.clientX, event.clientY );\n\n\t\t}\n\n\t\tif ( state !== STATE.NONE ) {\n\t\t\tdocument.addEventListener( 'mousemove', onMouseMove, false );\n\t\t\tdocument.addEventListener( 'mouseup', onMouseUp, false );\n\t\t\tscope.dispatchEvent( startEvent );\n\t\t}\n\n\t}\n\n\tfunction onMouseMove( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\n\t\tvar element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n\t\tif ( state === STATE.ROTATE ) {\n\n\t\t\tif ( scope.noRotate === true ) return;\n\n\t\t\trotateEnd.set( event.clientX, event.clientY );\n\t\t\trotateDelta.subVectors( rotateEnd, rotateStart );\n\n\t\t\t// rotating across whole screen goes 360 degrees around\n\t\t\tscope.rotateLeft( 2 * Math.PI * rotateDelta.x / element.clientWidth * scope.rotateSpeed );\n\n\t\t\t// rotating up and down along whole screen attempts to go 360, but limited to 180\n\t\t\tscope.rotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight * scope.rotateSpeed );\n\n\t\t\trotateStart.copy( rotateEnd );\n\n\t\t} else if ( state === STATE.DOLLY ) {\n\n\t\t\tif ( scope.noZoom === true ) return;\n\n\t\t\tdollyEnd.set( event.clientX, event.clientY );\n\t\t\tdollyDelta.subVectors( dollyEnd, dollyStart );\n\n\t\t\tif ( dollyDelta.y > 0 ) {\n\n\t\t\t\tscope.dollyIn();\n\n\t\t\t} else {\n\n\t\t\t\tscope.dollyOut();\n\n\t\t\t}\n\n\t\t\tdollyStart.copy( dollyEnd );\n\n\t\t} else if ( state === STATE.PAN ) {\n\n\t\t\tif ( scope.noPan === true ) return;\n\n\t\t\tpanEnd.set( event.clientX, event.clientY );\n\t\t\tpanDelta.subVectors( panEnd, panStart );\n\n\t\t\tscope.pan( panDelta.x, panDelta.y );\n\n\t\t\tpanStart.copy( panEnd );\n\n\t\t}\n\n\t\tif ( state !== STATE.NONE ) scope.update();\n\n\t}\n\n\tfunction onMouseUp( /* event */ ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tdocument.removeEventListener( 'mousemove', onMouseMove, false );\n\t\tdocument.removeEventListener( 'mouseup', onMouseUp, false );\n\t\tscope.dispatchEvent( endEvent );\n\t\tstate = STATE.NONE;\n\n\t}\n\n\tfunction onMouseWheel( event ) {\n\n\t\tif ( scope.enabled === false || scope.noZoom === true || state !== STATE.NONE ) return;\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tvar delta = 0;\n\n\t\tif ( event.wheelDelta !== undefined ) { // WebKit / Opera / Explorer 9\n\n\t\t\tdelta = event.wheelDelta;\n\n\t\t} else if ( event.detail !== undefined ) { // Firefox\n\n\t\t\tdelta = - event.detail;\n\n\t\t}\n\n\t\tif ( delta > 0 ) {\n\n\t\t\tscope.dollyOut();\n\n\t\t} else {\n\n\t\t\tscope.dollyIn();\n\n\t\t}\n\n\t\tscope.update();\n\t\tscope.dispatchEvent( startEvent );\n\t\tscope.dispatchEvent( endEvent );\n\n\t}\n\n\tfunction onKeyDown( event ) {\n\n\t\tif ( scope.enabled === false || scope.noKeys === true || scope.noPan === true ) return;\n\n\t\tswitch ( event.keyCode ) {\n\n\t\t\tcase scope.keys.UP:\n\t\t\t\tscope.pan( 0, scope.keyPanSpeed );\n\t\t\t\tscope.update();\n\t\t\t\tbreak;\n\n\t\t\tcase scope.keys.BOTTOM:\n\t\t\t\tscope.pan( 0, - scope.keyPanSpeed );\n\t\t\t\tscope.update();\n\t\t\t\tbreak;\n\n\t\t\tcase scope.keys.LEFT:\n\t\t\t\tscope.pan( scope.keyPanSpeed, 0 );\n\t\t\t\tscope.update();\n\t\t\t\tbreak;\n\n\t\t\tcase scope.keys.RIGHT:\n\t\t\t\tscope.pan( - scope.keyPanSpeed, 0 );\n\t\t\t\tscope.update();\n\t\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\tfunction touchstart( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tswitch ( event.touches.length ) {\n\n\t\t\tcase 1:\t// one-fingered touch: rotate\n\n\t\t\t\tif ( scope.noRotate === true ) return;\n\n\t\t\t\tstate = STATE.TOUCH_ROTATE;\n\n\t\t\t\trotateStart.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\t\t\t\tbreak;\n\n\t\t\tcase 2:\t// two-fingered touch: dolly\n\n\t\t\t\tif ( scope.noZoom === true ) return;\n\n\t\t\t\tstate = STATE.TOUCH_DOLLY;\n\n\t\t\t\tvar dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\n\t\t\t\tvar dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\n\t\t\t\tvar distance = Math.sqrt( dx * dx + dy * dy );\n\t\t\t\tdollyStart.set( 0, distance );\n\t\t\t\tbreak;\n\n\t\t\tcase 3: // three-fingered touch: pan\n\n\t\t\t\tif ( scope.noPan === true ) return;\n\n\t\t\t\tstate = STATE.TOUCH_PAN;\n\n\t\t\t\tpanStart.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tstate = STATE.NONE;\n\n\t\t}\n\n\t\tif ( state !== STATE.NONE ) scope.dispatchEvent( startEvent );\n\n\t}\n\n\tfunction touchmove( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tvar element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n\t\tswitch ( event.touches.length ) {\n\n\t\t\tcase 1: // one-fingered touch: rotate\n\n\t\t\t\tif ( scope.noRotate === true ) return;\n\t\t\t\tif ( state !== STATE.TOUCH_ROTATE ) return;\n\n\t\t\t\trotateEnd.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\t\t\t\trotateDelta.subVectors( rotateEnd, rotateStart );\n\n\t\t\t\t// rotating across whole screen goes 360 degrees around\n\t\t\t\tscope.rotateLeft( 2 * Math.PI * rotateDelta.x / element.clientWidth * scope.rotateSpeed );\n\t\t\t\t// rotating up and down along whole screen attempts to go 360, but limited to 180\n\t\t\t\tscope.rotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight * scope.rotateSpeed );\n\n\t\t\t\trotateStart.copy( rotateEnd );\n\n\t\t\t\tscope.update();\n\t\t\t\tbreak;\n\n\t\t\tcase 2: // two-fingered touch: dolly\n\n\t\t\t\tif ( scope.noZoom === true ) return;\n\t\t\t\tif ( state !== STATE.TOUCH_DOLLY ) return;\n\n\t\t\t\tvar dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\n\t\t\t\tvar dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\n\t\t\t\tvar distance = Math.sqrt( dx * dx + dy * dy );\n\n\t\t\t\tdollyEnd.set( 0, distance );\n\t\t\t\tdollyDelta.subVectors( dollyEnd, dollyStart );\n\n\t\t\t\tif ( dollyDelta.y > 0 ) {\n\n\t\t\t\t\tscope.dollyOut();\n\n\t\t\t\t} else {\n\n\t\t\t\t\tscope.dollyIn();\n\n\t\t\t\t}\n\n\t\t\t\tdollyStart.copy( dollyEnd );\n\n\t\t\t\tscope.update();\n\t\t\t\tbreak;\n\n\t\t\tcase 3: // three-fingered touch: pan\n\n\t\t\t\tif ( scope.noPan === true ) return;\n\t\t\t\tif ( state !== STATE.TOUCH_PAN ) return;\n\n\t\t\t\tpanEnd.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\t\t\t\tpanDelta.subVectors( panEnd, panStart );\n\n\t\t\t\tscope.pan( panDelta.x, panDelta.y );\n\n\t\t\t\tpanStart.copy( panEnd );\n\n\t\t\t\tscope.update();\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tstate = STATE.NONE;\n\n\t\t}\n\n\t}\n\n\tfunction touchend( /* event */ ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tscope.dispatchEvent( endEvent );\n\t\tstate = STATE.NONE;\n\n\t}\n\n\tthis.domElement.addEventListener( 'contextmenu', function ( event ) { event.preventDefault(); }, false );\n\tthis.domElement.addEventListener( 'mousedown', onMouseDown, false );\n\tthis.domElement.addEventListener( 'mousewheel', onMouseWheel, false );\n\tthis.domElement.addEventListener( 'DOMMouseScroll', onMouseWheel, false ); // firefox\n\n\tthis.domElement.addEventListener( 'touchstart', touchstart, false );\n\tthis.domElement.addEventListener( 'touchend', touchend, false );\n\tthis.domElement.addEventListener( 'touchmove', touchmove, false );\n\n\twindow.addEventListener( 'keydown', onKeyDown, false );\n\n\t// force an update at start\n\tthis.update();\n\n};\n\nTHREE.OrbitControls.prototype = Object.create( THREE.EventDispatcher.prototype );\nTHREE.OrbitControls.prototype.constructor = THREE.OrbitControls;\n\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/imports-loader?THREE=three!./bower_components/OrbitControls/index.js\n ** module id = 57\n ** module chunks = 0\n **/","/*** IMPORTS FROM imports-loader ***/\nvar THREE = require(\"three\");\n\n( function() {\n\n\tvar _oldConsole = console.log;\n\n\tvar supportedTypes = [];\n\n\tfunction addSupportedType( type, format ) {\n\n\t\tsupportedTypes.push( {\n\t\t\ttype: type,\n\t\t\tformat: format\n\t\t} );\n\n\t}\n\n\taddSupportedType( THREE.Matrix4, function( v ) {\n\n\t\tvar e = v.elements;\n\t\t\t\t\n\t\treturn [\n\t\t\t[ e[ 0 ], e[ 1 ], e[ 2 ], e[ 3 ] ],\n\t\t\t[ e[ 4 ], e[ 5 ], e[ 6 ], e[ 7 ] ],\n\t\t\t[ e[ 8 ], e[ 9 ], e[ 10 ], e[ 11 ] ],\n\t\t\t[ e[ 12 ], e[ 13 ], e[ 14 ], e[ 15 ] ]\n\t\t];\n\n\t} );\n\n\taddSupportedType( THREE.Matrix3, function( v ) {\n\n\t\tvar e = v.elements;\n\t\t\t\t\n\t\treturn [\n\t\t\t[ e[ 0 ], e[ 1 ], e[ 2 ] ],\n\t\t\t[ e[ 3 ], e[ 4 ], e[ 5 ] ],\n\t\t\t[ e[ 6 ], e[ 7 ], e[ 8 ] ]\n\t\t];\n\n\t} );\n\n\taddSupportedType( THREE.Vector2, function( v ) {\n\n\t\treturn {\n\t\t\tVector2: { x: v.x, y: v.y }\n\t\t};\n\n\t} );\n\n\taddSupportedType( THREE.Vector3, function( v ) {\n\n\t\treturn {\n\t\t\tVector3: { x: v.x, y: v.y, z: v.z }\n\t\t};\n\n\t} );\n\n\taddSupportedType( THREE.Vector4, function( v ) {\n\n\t\treturn {\n\t\t\tVector4: { x: v.x, y: v.y, z: v.z, w: v.w }\n\t\t};\n\n\t} );\n\n\taddSupportedType( THREE.Euler, function( v ) {\n\n\t\treturn {\n\t\t\tVector4: { x: v.x, y: v.y, z: v.z, order: v.order }\n\t\t};\n\n\t} );\n\n\taddSupportedType( THREE.Ray, function( v ) {\n\n\t\treturn { \n\t\t\t'Ray origin': { x: v.origin.x, y: v.origin.y, z: v.origin.z },\n\t\t\t'Ray direction': { x: v.direction.x, y: v.direction.y, z: v.direction.z }\n\t\t};\n\n\t} );\n\n\tconsole.log = function() {\n\n\t\tvar special = false;\n\n\t\t[].forEach.call( arguments, function( a ) { \n\t\t\tsupportedTypes.forEach( function( t ) {\n\t\t\t\tif( a instanceof t.type ) special = true;;\n\t\t\t} );\n\t\t} );\n\n\t\tif( special ) {\n\n\t\t\t[].forEach.call( arguments, function( a ) { \n\t\t\t\n\t\t\t\t_oldConsole.apply( console, [ a ] );\n\n\t\t\t\tsupportedTypes.forEach( function( t ) {\n\n\t\t\t\t\tif( a instanceof t.type ) {\n\n\t\t\t\t\t\tconsole.table( t.format( a ) );\n\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t} );\n\n\t\t\t} );\n\n\t\t} else {\n\n\t\t\t_oldConsole.apply( console, arguments );\n\n\t\t}\n\n\t}\n\n} )();\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/imports-loader?THREE=three!./bower_components/AugmentedConsole/index.js\n ** module id = 58\n ** module chunks = 0\n **/","/*** IMPORTS FROM imports-loader ***/\nvar THREE = require(\"three\");\n\n/**\n * @author bchirls / http://bchirls.com/\n */\n\nTHREE.VRStereoEffect = function ( renderer, fullScreenElement, options ) {\n\n\t// internals\n\tvar self = this;\n\tvar width = 0, height = 0;\n\tvar hmdWidth, hmdHeight;\n\n\tvar hmdDevice;\n\tvar vrMode;\n\tvar vrPreview = false;\n\tvar eyeOffsetLeft = new THREE.Vector3();\n\tvar eyeOffsetRight = new THREE.Vector3();\n\n\tvar position = new THREE.Vector3();\n\tvar quaternion = new THREE.Quaternion();\n\tvar scale = new THREE.Vector3();\n\n\tvar cameraLeft = new THREE.PerspectiveCamera();\n\tvar cameraRight = new THREE.PerspectiveCamera();\n\tvar leftRenderRect = {\n\t\tx: 0, y: 0, width: 0, height: 0\n\t};\n\tvar rightRenderRect = {\n\t\tx: 0, y: 0, width: 0, height: 0\n\t};\n\n\tvar near = 2;\n\tvar far = 40000;\n\n\tvar requestFullscreen;\n\tvar fullScreenParam = {\n\t\tvrDisplay: null\n\t};\n\tvar fovScale;\n\n\tvar RADIANS = Math.PI / 180;\n\n\tvar poll = options && options.poll || 1000;\n\tvar pollTimeout;\n\n\tfunction perspectiveMatrixFromVRFieldOfView(fov, zNear, zFar) {\n\t\tvar outMat = new THREE.Matrix4(),\n\t\t\tout = outMat.elements,\n\t\t\tupTan = Math.tan(fov.upDegrees * RADIANS),\n\t\t\tdownTan = Math.tan(fov.downDegrees * RADIANS),\n\t\t\tleftTan = Math.tan(fov.leftDegrees * RADIANS),\n\t\t\trightTan = Math.tan(fov.rightDegrees * RADIANS),\n\n\t\t\txScale = 2 / (leftTan + rightTan),\n\t\t\tyScale = 2 / (upTan + downTan);\n\n\t\tout[0] = xScale;\n\t\tout[4] = 0;\n\t\tout[8] = -((leftTan - rightTan) * xScale * 0.5);\n\t\tout[12] = 0;\n\n\t\tout[1] = 0;\n\t\tout[5] = yScale;\n\t\tout[9] = ((upTan - downTan) * yScale * 0.5);\n\t\tout[13] = 0;\n\n\t\tout[2] = 0;\n\t\tout[6] = 0;\n\t\tout[10] = zFar / (zNear - zFar);\n\t\tout[14] = (zFar * zNear) / (zNear - zFar);\n\n\t\tout[3] = 0;\n\t\tout[7] = 0;\n\t\tout[11] = -1;\n\t\tout[15] = 0;\n\n\t\treturn outMat;\n\t}\n\n\tfunction resize() {\n\t\tvar w, h;\n\n\t\tif (hmdDevice && vrMode) {\n\t\t\tw = hmdWidth;// / Math.pow(window.devicePixelRatio || 1, 2);\n\t\t\th = hmdHeight;// / Math.pow(window.devicePixelRatio || 1, 2);\n\t\t} else {\n\t\t\tw = width || renderer.domElement.offsetWidth || window.innerWidth;\n\t\t\th = height || renderer.domElement.offsetHeight || window.innerHeight;\n\t\t}\n\n\t\trenderer.setSize(w, h);\n\t}\n\n\tfunction updateProjection() {\n\t\tvar fovLeft,\n\t\t\tfovRight,\n\n\t\t\tleftEyeParams,\n\t\t\trightEyeParams,\n\t\t\tleftEyeRect,\n\t\t\trightEyeRect,\n\n\t\t\tleftEyeViewport,\n\t\t\trightEyeViewport;\n\n\t\tif (!hmdDevice) {\n\t\t\tcameraLeft.fov = 80;\n\t\t\tcameraRight.fov = 80;\n\t\t\treturn;\n\t\t}\n\n\t\t// if (amount && hmdDevice.setFieldOfView) {\n\t\t// \tfovScale += amount;\n\t\t// \tfovScale = Math.max(0.1, fovScale);\n\n\t\t// \tfovLeft = hmdDevice.getRecommendedEyeFieldOfView('left');\n\n\t\t// \tfovLeft.upDegrees *= fovScale;\n\t\t// \tfovLeft.downDegrees *= fovScale;\n\t\t// \tfovLeft.leftDegrees *= fovScale;\n\t\t// \tfovLeft.rightDegrees *= fovScale;\n\n\t\t// \tfovRight = hmdDevice.getRecommendedEyeFieldOfView('right');\n\t\t// \tfovRight.upDegrees *= fovScale;\n\t\t// \tfovRight.downDegrees *= fovScale;\n\t\t// \tfovRight.leftDegrees *= fovScale;\n\t\t// \tfovRight.rightDegrees *= fovScale;\n\n\t\t// \thmdDevice.setFieldOfView(fovLeft, fovRight);\n\t\t// }\n\n\t\tif (hmdDevice.getEyeParameters) {\n\t\t\tleftEyeParams = hmdDevice.getEyeParameters('left');\n\t\t\trightEyeParams = hmdDevice.getEyeParameters('right');\n\t\t\tleftEyeRect = leftEyeParams.renderRect;\n\t\t\trightEyeRect = rightEyeParams.renderRect;\n\n\t\t\thmdWidth = rightEyeRect.x + rightEyeRect.width;\n\t\t\thmdHeight = Math.max(leftEyeRect.y + leftEyeRect.height, rightEyeRect.y + rightEyeRect.height);\n\n\t\t\tfovLeft = leftEyeParams.currentFieldOfView;\n\t\t\tfovRight = rightEyeParams.currentFieldOfView;\n\n\t\t\thmdDevice.setFieldOfView(fovLeft, fovRight, near, far);\n\n\t\t\teyeOffsetLeft.copy(leftEyeParams.eyeTranslation);\n\t\t\teyeOffsetRight.copy(rightEyeParams.eyeTranslation);\n\n\t\t\tleftRenderRect = leftEyeParams.renderRect;\n\t\t\trightRenderRect = rightEyeParams.renderRect;\n\t\t} else if (hmdDevice.getRecommendedEyeRenderRect) {\n\t\t\tleftEyeViewport = hmdDevice.getRecommendedEyeRenderRect('left');\n\t\t\trightEyeViewport = hmdDevice.getRecommendedEyeRenderRect('right');\n\n\t\t\thmdWidth = leftEyeViewport.width + rightEyeViewport.width;\n\t\t\thmdHeight = Math.max(leftEyeViewport.height, rightEyeViewport.height);\n\n\t\t\tif (hmdDevice.getCurrentEyeFieldOfView) {\n\t\t\t\tfovLeft = hmdDevice.getCurrentEyeFieldOfView('left');\n\t\t\t\tfovRight = hmdDevice.getCurrentEyeFieldOfView('right');\n\t\t\t} else {\n\t\t\t\tfovLeft = hmdDevice.getRecommendedEyeFieldOfView('left');\n\t\t\t\tfovRight = hmdDevice.getRecommendedEyeFieldOfView('right');\n\t\t\t}\n\n\t\t\teyeOffsetLeft.copy(hmdDevice.getEyeTranslation('left'));\n\t\t\teyeOffsetRight.copy(hmdDevice.getEyeTranslation('right'));\n\n\t\t\tleftRenderRect.x = leftEyeViewport.left;\n\t\t\tleftRenderRect.y = leftEyeViewport.top;\n\t\t\tleftRenderRect.width = leftEyeViewport.width;\n\t\t\tleftRenderRect.height = leftEyeViewport.height;\n\n\t\t\trightRenderRect.x = rightEyeViewport.left;\n\t\t\trightRenderRect.y = rightEyeViewport.top;\n\t\t\trightRenderRect.width = rightEyeViewport.width;\n\t\t\trightRenderRect.height = rightEyeViewport.height;\n\t\t}\n\n\t\tresize();\n\n\t\tcameraLeft.projectionMatrix = perspectiveMatrixFromVRFieldOfView(fovLeft, near, far);\n\t\tcameraRight.projectionMatrix = perspectiveMatrixFromVRFieldOfView(fovRight, near, far);\n\t}\n\n\tfunction gotVRDevices(devices) {\n\t\tvar i,\n\t\t\tdevice;\n\n\t\tfor (i = 0; i < devices.length; i++) {\n\t\t\tdevice = devices[i];\n\t\t\tif ( device instanceof HMDVRDevice ) {\n\n\t\t\t\tif ( hmdDevice && device.hardwareUnitId === hmdDevice.hardwareUnitId ) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\thmdDevice = device;\n\t\t\t\tconsole.log('Using HMD Device:', hmdDevice.deviceName);\n\n\t\t\t\tif (hmdDevice.setTimewarp) {\n\t\t\t\t\t//hmdDevice.setTimewarp(false);\n\t\t\t\t}\n\n\t\t\t\tupdateProjection();\n\n\t\t\t\tfullScreenParam.vrDisplay = hmdDevice;\n\n\t\t\t\tself.dispatchEvent( {\n\t\t\t\t\ttype: \"devicechange\"\n\t\t\t\t} );\n\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (poll) {\n\t\t\tclearTimeout(pollTimeout);\n\t\t\tsetTimeout(self.scan, poll);\n\t\t}\n\t}\n\n\tfunction onFullscreenChange() {\n\t\tif (!document.webkitFullscreenElement &&\n\t\t\t\t!document.mozFullScreenElement &&\n\t\t\t\t!document.msFullscreenElement) {\n\t\t\tvrMode = false;\n\t\t}\n\n\t\tupdateProjection();\n\n\t\tself.dispatchEvent( {\n\t\t\ttype: \"fullscreenchange\"\n\t\t} );\n\t}\n\n\t// API\n\n\tthis.separation = 0.01;\n\n\t// initialization\n\n\trenderer.autoClear = false;\n\n\tif (!fullScreenElement) {\n\t\tfullScreenElement = renderer.domElement;\n\t}\n\trequestFullscreen = fullScreenElement.webkitRequestFullscreen ||\n\t\tfullScreenElement.mozRequestFullScreen ||\n\t\tfullScreenElement.msRequestFullscreen;\n\tif (requestFullscreen) {\n\t\trequestFullscreen = requestFullscreen.bind(fullScreenElement, fullScreenParam);\n\t}\n\n\tdocument.addEventListener('fullscreenchange', onFullscreenChange, false);\n\tdocument.addEventListener('webkitfullscreenchange', onFullscreenChange, false);\n\tdocument.addEventListener('mozfullscreenchange', onFullscreenChange, false);\n\tdocument.addEventListener('MSFullscreenChange', onFullscreenChange, false);\n\n\t//todo: method for adjusting HMD FOV\n\n\tthis.scan = function () {\n\t\tif (navigator.getVRDevices) {\n\t\t\tnavigator.getVRDevices().then(gotVRDevices);\n\t\t} else if (navigator.mozGetVRDevices) {\n\t\t\tnavigator.mozGetVRDevices(gotVRDevices);\n\t\t}\n\t};\n\n\tthis.requestFullScreen = function () {\n\t\tvrMode = true;\n\t\trequestFullscreen();\n\t};\n\n\tthis.exit = function () {\n\t\tvrMode = false;\n\t\tvrPreview = false;\n\t};\n\n\tthis.setSize = function ( w, h ) {\n\t\twidth = w;\n\t\theight = h;\n\n\t\tresize();\n\t};\n\n\tthis.vrPreview = function (val) {\n\t\tif (val !== undefined) {\n\t\t\tvrPreview = !!val;\n\t\t}\n\t\treturn vrPreview;\n\t};\n\n\tthis.isFullscreen = function () {\n\t\treturn vrMode;\n\t};\n\n\tthis.hmd = function () {\n\t\treturn hmdDevice;\n\t};\n\n\tthis.render = function ( leftScene, rightScene, camera, renderTarget, forceClear ) {\n\t\tvar w, h;\n\n\t\tif ( rightScene && rightScene instanceof THREE.Scene ) {\n\t\t\t//rightScene.updateMatrixWorld();\n\t\t} else {\n\t\t\tif ( (!camera || camera instanceof THREE.WebGLRenderTarget) && rightScene instanceof THREE.Camera ) {\n\t\t\t\tforceClear = renderTarget;\n\t\t\t\trenderTarget = camera;\n\t\t\t\tcamera = rightScene;\n\t\t\t}\n\t\t\trightScene = leftScene;\n\t\t}\n\n\t\t//leftScene.updateMatrixWorld();\n\n\t\tif ( camera.parent === undefined ) {\n\t\t\tcamera.updateMatrixWorld();\n\t\t}\n\n\t\tw = width || renderer.domElement.width;\n\t\th = height || renderer.domElement.height;\n\t\t// w /= window.devicePixelRatio || 1;\n\t\t// h /= window.devicePixelRatio || 1;\n\n\t\t/*\n\t\ttodo: make this work when CSS VR Rendering is fixed\n\t\thttp://blog.bitops.com/blog/2014/08/20/updated-firefox-vr-builds/\n\t\tif (renderer instanceof THREE.CSS3DRenderer) {\n\t\t\trenderer.render( leftScene, camera );\n\t\t\treturn;\n\t\t}\n\t\t*/\n\n\t\tif (!vrMode && !vrPreview) {\n\t\t\trenderer.enableScissorTest( false );\n\t\t\trenderer.setViewport( 0, 0, w, h );\n\t\t\trenderer.render( leftScene, camera, renderTarget, true );\n\t\t\treturn;\n\t\t}\n\n\t\tcamera.matrixWorld.decompose( position, quaternion, scale );\n\n\t\tif (!hmdDevice) {\n\t\t\t// left\n\t\t\t//cameraLeft.fov = camera.fov;\n\t\t\tcameraLeft.aspect = 0.5 * camera.aspect;\n\t\t\tcameraLeft.near = camera.near;\n\t\t\tcameraLeft.far = camera.far;\n\t\t\tcameraLeft.updateProjectionMatrix();\n\n\t\t\t// right\n\n\t\t\t// cameraRight.fov = camera.fov;\n\t\t\tcameraRight.aspect = 0.5 * camera.aspect;\n\t\t\tcameraRight.near = camera.near;\n\t\t\tcameraRight.far = camera.far;\n\t\t\tcameraRight.updateProjectionMatrix();\n\t\t}\n\n\t\tcameraLeft.position.copy( position );\n\t\tcameraLeft.quaternion.copy( quaternion );\n\n\t\tcameraRight.position.copy( position );\n\t\tcameraRight.quaternion.copy( quaternion );\n\n\t\tif (hmdDevice) {\n\t\t\tcameraLeft.position.add( eyeOffsetLeft ) ;\n\t\t\tcameraRight.position.add( eyeOffsetRight );\n\t\t} else {\n\t\t\tcameraLeft.translateX( - this.separation );\n\t\t\tcameraRight.translateX( this.separation );\n\t\t}\n\n\t\tcameraLeft.updateMatrixWorld();\n\t\tcameraRight.updateMatrixWorld();\n\n\t\t//\n\n\t\trenderer.enableScissorTest(true);\n\n\t\tw = renderer.context.drawingBufferWidth / 2;\n\n\t\tif (renderTarget) {\n\t\t\trenderer.setRenderTarget(renderTarget);\n\t\t}\n\n\t\trightScene.traverseVisible(function (obj) {\n\t\t\tif (obj.material && obj.material.map) {\n\t\t\t\tif (obj.userData.stereo === 'vertical') {\n\t\t\t\t\tobj.material.map.offset.set(0, 0.5);\n\t\t\t\t} else if (obj.userData.stereo) {\n\t\t\t\t\tobj.material.map.offset.set(0.5, 0);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\trenderer.setScissor( w, 0, w, h );\n\t\trenderer.setViewport( w, 0, w, h );\n\t\trenderer.render( rightScene, cameraRight, renderTarget, forceClear );\n\n\t\tleftScene.traverseVisible(function (obj) {\n\t\t\tif (obj.userData.stereo && obj.material && obj.material.map) {\n\t\t\t\tobj.material.map.offset.set(0, 0);\n\t\t\t}\n\t\t});\n\t\trenderer.setScissor( 0, 0, w, h );\n\t\trenderer.setViewport( 0, 0, w, h );\n\t\trenderer.render( leftScene, cameraLeft, renderTarget, forceClear );\n\n\t\t//reset viewport, scissor\n\t\tw *= 2;\n\t\trenderer.setViewport( 0, 0, w, h );\n\t\trenderer.setScissor( 0, 0, w, h );\n\t\trenderer.enableScissorTest( false );\n\t};\n\n\tObject.defineProperty(this, 'near', {\n\t\tget: function () {\n\t\t\treturn near;\n\t\t},\n\t\tset: function (val) {\n\t\t\tval = parseFloat(val);\n\t\t\tif (val && !isNaN(val)) {\n\t\t\t\tnear = Math.max(0, val);\n\t\t\t\tupdateProjection();\n\t\t\t}\n\t\t}\n\t});\n\n\tObject.defineProperty(this, 'far', {\n\t\tget: function () {\n\t\t\treturn far;\n\t\t},\n\t\tset: function (val) {\n\t\t\tval = parseFloat(val);\n\t\t\tif (val && !isNaN(val)) {\n\t\t\t\tfar = Math.max(0, val);\n\t\t\t\tupdateProjection();\n\t\t\t}\n\t\t}\n\t});\n\n\tthis.scan();\n\tresize();\n};\n\nTHREE.VRStereoEffect.prototype = Object.create( THREE.EventDispatcher.prototype );\n\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/imports-loader?THREE=three!./src/lib/VRStereoEffect.js\n ** module id = 59\n ** module chunks = 0\n **/","/*** IMPORTS FROM imports-loader ***/\nvar THREE = require(\"three\");\n\nTHREE.VRControls = function ( object, options ) {\n\n\tvar self = this;\n\n\t//HMD sensor stuff\n\tvar sensorDevice;\n\tvar vrState;\n\n\t//device orientation stuff\n\tvar deviceControls;\n\tvar zeroAngle = 0;\n\n\tvar mode = '';\n\n\tvar vrBrowser = navigator.getVRDevices || navigator.mozGetVRDevices;\n\n\tvar poll = options && options.poll || 1000;\n\tvar pollTimeout;\n\n\tfunction gotVRDevices( devices ) {\n\t\tvar i,\n\t\t\tdevice;\n\n\t\tfor ( i = 0; i < devices.length; ++i ) {\n\t\t\tdevice = devices[i];\n\t\t\tif ( devices[i] instanceof PositionSensorVRDevice ) {\n\n\t\t\t\tif ( sensorDevice && devices[i].hardwareUnitId === sensorDevice.hardwareUnitId ) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tsensorDevice = device;\n\t\t\t\tconsole.log('Using Sensor Device:', sensorDevice.deviceName);\n\n\t\t\t\tif ( sensorDevice.zeroSensor ) {\n\t\t\t\t\tself.zeroSensor = sensorDevice.zeroSensor.bind(sensorDevice);\n\t\t\t\t} else if ( sensorDevice.resetSensor ) {\n\t\t\t\t\tself.zeroSensor = sensorDevice.resetSensor.bind(sensorDevice);\n\t\t\t\t}\n\t\t\t\tself.zeroSensor();\n\n\t\t\t\tmode = 'hmd';\n\n\t\t\t\tself.dispatchEvent( {\n\t\t\t\t\ttype: \"devicechange\"\n\t\t\t\t} );\n\n\t\t\t\tbreak; // We keep the first we encounter\n\t\t\t}\n\t\t}\n\n\t\tif (poll) {\n\t\t\tclearTimeout(pollTimeout);\n\t\t\tsetTimeout(self.scan, poll);\n\t\t}\n\t}\n\n\tfunction deviceOrientationChange( event ) {\n\t\tif ( typeof event.gamma === 'number' ) {\n\t\t\tmode = 'deviceorientation';\n\t\t\twindow.removeEventListener( 'deviceorientation', deviceOrientationChange, false );\n\t\t\tdeviceControls = new THREE.DeviceOrientationControls( object );\n\t\t\tdeviceControls.connect();\n\t\t\tif (!this.freeze) {\n\t\t\t\tdeviceControls.update();\n\t\t\t}\n\n\t\t\tself.dispatchEvent( {\n\t\t\t\ttype: \"devicechange\"\n\t\t\t} );\n\t\t}\n\t}\n\n\tthis.update = function() {\n\t\t// Applies head rotation from sensor data.\n\t\tif (self.freeze) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( sensorDevice ) {\n\t\t\tvrState = sensorDevice.getState();\n\t\t\tif ( vrState ) {\n\t\t\t\tif ( vrState.orientation && vrState.hasOrientation !== false ) {\n\t\t\t\t\tobject.quaternion.copy( vrState.orientation );\n\t\t\t\t}\n\n\t\t\t\tif ( vrState.position && vrState.hasPosition !== false ) {\n\t\t\t\t\t// vrState.position is null if using DK1 or if DK2 camera is not plugged in\n\t\t\t\t\tobject.position.copy( vrState.position );\n\t\t\t\t}\n\n\t\t\t\tobject.updateMatrixWorld();\n\t\t\t}\n\t\t} else if (deviceControls && deviceControls.deviceOrientation.gamma !== undefined) {\n\t\t\tdeviceControls.update();\n\t\t\tobject.rotateY(-zeroAngle);\n\t\t\tobject.updateMatrixWorld();\n\t\t}\n\t};\n\n\t//only useful when frozen\n\tthis.reset = function () {\n\t\tif ( object ) {\n\t\t\tobject.quaternion.set( 0, 0, 0, 1 );\n\t\t\tobject.position.set( 0, 0, 0 );\n\t\t}\n\t};\n\n\t//zeros only rotation on Y axis\n\t//todo: find out if it zeros out position. need a DK2 to test\n\tthis.zeroSensor = function () {\n\t\tif (sensorDevice && sensorDevice.zeroSensor) {\n\t\t\tsensorDevice.zeroSensor();\n\t\t}\n\t\tzeroAngle = object.rotation.y;\n\t\tself.update();\n\t};\n\n\tthis.freeze = false;\n\n\t//method to query which tech we're using\n\tthis.mode = function () {\n\t\treturn mode;\n\t};\n\n\tthis.scan = function () {\n\t\tif ( navigator.getVRDevices ) {\n\t\t\tnavigator.getVRDevices().then( gotVRDevices );\n\t\t} else if ( navigator.mozGetVRDevices ) {\n\t\t\tnavigator.mozGetVRDevices( gotVRDevices );\n\t\t}\n\t};\n\n\t//todo: connect/disconnect methods\n\t//todo: method to query orientation/position without changing object\n\t//todo: work without an object\n\n\tif ( vrBrowser ) {\n\t\tthis.scan();\n\t} else if ( \"DeviceOrientationEvent\" in window && THREE.DeviceOrientationControls) {\n\t\t//device orientation\n\t\twindow.addEventListener( \"deviceorientation\", deviceOrientationChange, false );\n\t}\n};\n\nTHREE.VRControls.prototype = Object.create( THREE.EventDispatcher.prototype );\n\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/imports-loader?THREE=three!./src/lib/VRControls.js\n ** module id = 60\n ** module chunks = 0\n **/","var map = {\n\t\"./box\": 62,\n\t\"./box.js\": 62,\n\t\"./cylinder\": 63,\n\t\"./cylinder.js\": 63,\n\t\"./empty\": 55,\n\t\"./empty.js\": 55,\n\t\"./floor\": 64,\n\t\"./floor.js\": 64,\n\t\"./grid\": 65,\n\t\"./grid.js\": 65,\n\t\"./image\": 66,\n\t\"./image.js\": 66,\n\t\"./panorama\": 67,\n\t\"./panorama.js\": 67,\n\t\"./sky\": 68,\n\t\"./sky.js\": 68,\n\t\"./sound\": 70,\n\t\"./sound.js\": 70,\n\t\"./sphere\": 72,\n\t\"./sphere.js\": 72,\n\t\"./text\": 73,\n\t\"./text.js\": 73,\n\t\"./torus\": 74,\n\t\"./torus.js\": 74,\n\t\"./video\": 75,\n\t\"./video.js\": 75\n};\nfunction webpackContext(req) {\n\treturn __webpack_require__(webpackContextResolve(req));\n};\nfunction webpackContextResolve(req) {\n\treturn map[req] || (function() { throw new Error(\"Cannot find module '\" + req + \"'.\") }());\n};\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 61;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/objects ^\\.\\/.*$\n ** module id = 61\n ** module chunks = 0\n **/","module.exports = (function () {\n\t'use strict';\n\n\tvar materials = require('../materials'),\n\t\tTHREE = require('three'),\n\t\tgeometry = new THREE.BoxGeometry( 1, 1, 1 );\n\n\treturn function box(parent, options) {\n\t\tvar mesh;\n\n\t\tmesh = new THREE.Mesh(geometry, materials.standard());\n\t\tmesh.name = 'box';\n\n\t\tparent.add(mesh);\n\n\t\treturn mesh;\n\t};\n}());\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/objects/box.js\n ** module id = 62\n ** module chunks = 0\n **/","module.exports = (function () {\n\t'use strict';\n\n\tvar materials = require('../materials'),\n\t\tTHREE = require('three');\n\n\tfunction cylinder(parent, options) {\n\t\tvar geometry,\n\t\t\tmesh;\n\n\t\tgeometry = new THREE.CylinderGeometry(\n\t\t\toptions.radiusTop === undefined ? 0.5 : options.radiusTop,\n\t\t\toptions.radiusBottom === undefined ? 0.5 : options.radiusBottom,\n\t\t\toptions.height === undefined ? 1 : options.height,\n\t\t\toptions.radiusSegments === undefined ? 16 : options.radiusSegments,\n\t\t\toptions.heightSegments,\n\t\t\toptions.openEnded\n\t\t);\n\t\tmesh = new THREE.Mesh(geometry, materials.standard());\n\t\tmesh.name = 'cylinder';\n\n\t\tparent.add(mesh);\n\n\t\treturn mesh;\n\t}\n\n\treturn cylinder;\n}());\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/objects/cylinder.js\n ** module id = 63\n ** module chunks = 0\n **/","module.exports = (function () {\n\t'use strict';\n\n\tvar materials = require('../materials'),\n\t\tTHREE = require('three');\n\n\tfunction floor(parent, options) {\n\t\tvar obj,\n\t\t\tgeometry;\n\n\t\tgeometry = new THREE.CircleGeometry( options.radius || 100, options.segments || 16 );\n\t\tgeometry.applyMatrix( new THREE.Matrix4().makeRotationX(-Math.PI / 2));\n\n\t\tobj = new THREE.Mesh(\n\t\t\tgeometry,\n\t\t\tmaterials.checkerboard({\n\t\t\t\trepeat: 100\n\t\t\t})\n\t\t);\n\t\tobj.name = 'floor';\n\n\t\tobj.receiveShadow = true;\n\n\t\tparent.add(obj);\n\n\t\treturn obj;\n\t}\n\n\treturn floor;\n}());\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/objects/floor.js\n ** module id = 64\n ** module chunks = 0\n **/","module.exports = (function () {\n\t'use strict';\n\n\tvar THREE = require('three');\n\n\treturn function box(parent, options) {\n\t\tvar obj,\n\t\t\tsize = options && options.size || 10,\n\t\t\tstep = options && options.step || 1;\n\n\t\tobj = new THREE.GridHelper(size, step);\n\t\tobj.name = 'grid';\n\t\tif (options) {\n\t\t\tobj.setColors(options.colorCenterLine || obj.color1, options.colorGrid || obj.color2);\n\t\t}\n\t\tobj.geometry.computeBoundingBox();\n\n\t\tparent.add(obj);\n\n\t\treturn obj;\n\t};\n}());\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/objects/grid.js\n ** module id = 65\n ** module chunks = 0\n **/","module.exports = (function () {\n\t'use strict';\n\n\tvar materials = require('../materials'),\n\t\tTHREE = require('three');\n\n\treturn function image(parent, options) {\n\t\tvar geometry,\n\t\t\tmaterial,\n\t\t\tmesh,\n\t\t\tsrc,\n\t\t\ttex,\n\t\t\tself = this;\n\n\t\tif (typeof options === 'string') {\n\t\t\tsrc = options;\n\t\t} else if (options) {\n\t\t\tsrc = options.src;\n\t\t}\n\n\t\tif (src) {\n\t\t\ttex = materials.imageTexture(src, THREE.UVMapping, function (t, image) {\n\t\t\t\t//todo: don't do any of this if object has been deleted\n\t\t\t\tgeometry.applyMatrix(new THREE.Matrix4().makeScale(1, image.naturalHeight / image.naturalWidth, 1));\n\t\t\t\tmaterial.map = tex;\n\t\t\t\tmaterial.visible = true;\n\t\t\t\tmesh.visible = true;\n\t\t\t\tparent.add(mesh);\n\n\t\t\t\tself.emit('loaded');\n\t\t\t});\n\t\t}\n\n\t\tgeometry = new THREE.PlaneBufferGeometry(1, 1, 8);\n\n\t\tmaterial = new THREE.MeshBasicMaterial({\n\t\t\tside: THREE.DoubleSide,\n\t\t\ttransparent: true,\n\t\t\tmap: tex\n\t\t});\n\n\t\tmesh = new THREE.Mesh( geometry, material );\n\n\t\tmesh.visible = false;\n\n\t\tparent.add(mesh);\n\n\t\treturn mesh;\n\t};\n}());\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/objects/image.js\n ** module id = 66\n ** module chunks = 0\n **/","module.exports = (function () {\n\t'use strict';\n\n\tvar materials = require('../materials'),\n\t\tTHREE = require('three'),\n\t\tgeometry = new THREE.SphereGeometry(1000, 60, 60);\n\n\tgeometry.applyMatrix(new THREE.Matrix4().makeScale(-1, 1, 1));\n\tgeometry.applyMatrix(new THREE.Matrix4().makeRotationY(- Math.PI / 2));\n\n\treturn function panorama(parent, options) {\n\t\tvar material,\n\t\t\tmesh,\n\t\t\tsrc,\n\t\t\ttex,\n\t\t\tself = this;\n\n\t\tif (typeof options === 'string') {\n\t\t\tsrc = options;\n\t\t} else if (options) {\n\t\t\tsrc = options.src;\n\t\t}\n\n\t\tif (src) {\n\t\t\ttex = materials.imageTexture(src, THREE.UVMapping, function () {\n\t\t\t\tself.emit('loaded');\n\t\t\t});\n\t\t}\n\n\t\tmaterial = new THREE.MeshBasicMaterial({\n\t\t\ttransparent: true,\n\t\t\tmap: tex\n\t\t});\n\n\t\tmesh = new THREE.Mesh(geometry, material);\n\n\t\tif (options && options.stereo) {\n\t\t\tif (options.stereo === 'vertical') {\n\t\t\t\ttex.repeat.y = 0.5;\n\t\t\t} else {\n\t\t\t\ttex.repeat.x = 0.5;\n\t\t\t}\n\t\t\tmesh.userData.stereo = options.stereo;\n\t\t}\n\n\t\tmesh.name = 'panorama';\n\n\t\tparent.add(mesh);\n\n\t\tthis.raycastable = false;\n\n\t\treturn mesh;\n\t};\n}());\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/objects/panorama.js\n ** module id = 67\n ** module chunks = 0\n **/","module.exports = (function () {\n\t'use strict';\n\n\tvar materials = require('../materials'),\n\t\tTHREE = require('three'),\n\t\tTAU = Math.PI * 2,\n\t\tHALF_PI = Math.PI / 2,\n\n\t\tdistance = 400000,\n\t\tscratchVector = new THREE.Vector3(),\n\n\t\tparams = [\n\t\t\t'luminance',\n\t\t\t'turbidity',\n\t\t\t'reileigh',\n\t\t\t'mieCoefficient',\n\t\t\t'mieDirectionalG'\n\t\t];\n\n\trequire('imports?THREE=three!SkyShader');\n\n\treturn function sky(parent, options) {\n\t\tvar obj = new THREE.Sky(),\n\t\t\tself = this,\n\t\t\tscene = parent,\n\t\t\tlight,\n\t\t\tsunPosition,\n\t\t\tazimuth = Math.PI / 6,\n\t\t\taltitude = Math.PI / 6;\n\n\t\tfunction mod(x, y) {\n\t\t\treturn x - y * Math.floor(x / y);\n\t\t}\n\n\t\tfunction update() {\n\t\t\tvar sinTheta,\n\t\t\t\tcosTheta,\n\t\t\t\tphi,\n\t\t\t\tsinPhi,\n\t\t\t\tcosPhi;\n\n\t\t\tsinTheta = Math.sin(altitude);\n\t\t\tcosTheta = Math.cos(altitude);\n\t\t\tphi = -HALF_PI - azimuth;\n\t\t\tsinPhi = Math.sin(phi);\n\t\t\tcosPhi = Math.cos(phi);\n\n\t\t\tsunPosition.set(\n\t\t\t\tdistance * cosPhi * cosTheta,\n\t\t\t\tdistance * sinTheta,\n\t\t\t\tdistance * sinPhi * cosTheta\n\t\t\t);\n\n\t\t\tif (light) {\n\t\t\t\tlight.intensity = 1.5 * Math.max(0.0, 1.0 - Math.exp(-((Math.PI / 1.95 - Math.abs(HALF_PI - altitude)) / 1.5)));\n\t\t\t\tlight.position.copy(sunPosition).normalize().multiplyScalar(100);\n\t\t\t}\n\t\t}\n\n\t\tobj.mesh.name = 'sky';\n\n\t\tparent.add(obj.mesh);\n\n\t\twhile (!(scene instanceof THREE.Scene) && scene.parent) {\n\t\t\tscene = scene.parent;\n\t\t}\n\t\tlight = scene.getObjectByName('directional-light');\n\n\t\tthis.setOptions = function (options) {\n\t\t\tvar needUpdate = false,\n\t\t\t\taltitude,\n\t\t\t\tazimuth;\n\n\t\t\tif (options) {\n\t\t\t\tparams.forEach(function (param) {\n\t\t\t\t\tvar val = options[param];\n\t\t\t\t\tif (val !== undefined) {\n\t\t\t\t\t\tval = parseFloat(val);\n\t\t\t\t\t\tif (!isNaN(val)) {\n\t\t\t\t\t\t\tobj.uniforms[param].value = val;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (options.sunPosition instanceof THREE.Vector3) {\n\t\t\t\t\tobj.uniforms.sunPosition.value.copy(options.sunPosition);\n\t\t\t\t} else if (Array.isArray(options.sunPosition)) {\n\t\t\t\t\tobj.uniforms.sunPosition.value.set(obj.uniforms.sunPosition.value, options.sunPosition);\n\t\t\t\t} else {\n\t\t\t\t\tself.altitude = options.altitude;\n\t\t\t\t\tself.azimuth = options.azimuth;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tObject.defineProperty(this, 'azimuth', {\n\t\t\tset: function (val) {\n\t\t\t\tval = mod(parseFloat(val), TAU);\n\t\t\t\tif (!isNaN(val) && val !== azimuth) {\n\t\t\t\t\tazimuth = val;\n\t\t\t\t\tupdate();\n\t\t\t\t}\n\t\t\t},\n\t\t\tget: function () {\n\t\t\t\treturn azimuth;\n\t\t\t}\n\t\t});\n\n\t\tObject.defineProperty(this, 'altitude', {\n\t\t\tset: function (val) {\n\t\t\t\tval = mod(parseFloat(val), TAU);\n\t\t\t\tif (!isNaN(val) && val !== altitude) {\n\t\t\t\t\taltitude = val;\n\t\t\t\t\tupdate();\n\t\t\t\t}\n\t\t\t},\n\t\t\tget: function() {\n\t\t\t\treturn altitude;\n\t\t\t}\n\t\t});\n\n\t\tthis.setAltitude = function (val) {\n\t\t\tself.altitude = val;\n\t\t\treturn this;\n\t\t};\n\n\t\tthis.setAzimuth = function (val) {\n\t\t\tself.azimuth = val;\n\t\t\treturn this;\n\t\t};\n\n\t\tsunPosition = obj.uniforms.sunPosition.value;\n\t\tupdate();\n\n\t\tthis.setOptions(options);\n\n\t\tthis.raycastable = false;\n\n\t\treturn obj.mesh;\n\t};\n}());\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/objects/sky.js\n ** module id = 68\n ** module chunks = 0\n **/","/*** IMPORTS FROM imports-loader ***/\nvar THREE = require(\"three\");\n\n/**\n * @author zz85 / https://github.com/zz85\n * \n * Based on \"A Practical Analytic Model for Daylight\" \n * aka The Preetham Model, the de facto standard analytic skydome model\n * http://www.cs.utah.edu/~shirley/papers/sunsky/sunsky.pdf\n * \n * First implemented by Simon Wallner\n * http://www.simonwallner.at/projects/atmospheric-scattering\n * \n * Improved by Martin Upitis\n * http://blenderartists.org/forum/showthread.php?245954-preethams-sky-impementation-HDR\n * \n * Three.js integration by zz85 http://twitter.com/blurspline\n*/\n\nTHREE.ShaderLib['sky'] = {\n\n\tuniforms: {\n\n\t\tluminance:\t { type: \"f\", value:1 },\n\t\tturbidity:\t { type: \"f\", value:2 },\n\t\treileigh:\t { type: \"f\", value:1 },\n\t\tmieCoefficient:\t { type: \"f\", value:0.005 },\n\t\tmieDirectionalG: { type: \"f\", value:0.8 },\n\t\tsunPosition: \t { type: \"v3\", value: new THREE.Vector3() }\n\n\t},\n\n\tvertexShader: [\n\n\t\t\"varying vec3 vWorldPosition;\",\n\t\t\"varying vec2 vUv;\",\n\n\t\t\"void main() {\",\n\n\t\t\t\"vec4 worldPosition = modelMatrix * vec4( position, 1.0 );\",\n\t\t\t\"vWorldPosition = worldPosition.xyz;\",\n\t\t\t\"vUv = uv;\",\n\n\t\t\t\"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\n\n\t\t\"}\",\n\n\t].join(\"\\n\"),\n\n\tfragmentShader: [\n\n\n\t\t\"uniform sampler2D skySampler;\",\n\t\t\"uniform vec3 sunPosition;\",\n\t\t\"varying vec3 vWorldPosition;\",\n\t\t\"varying vec2 vUv;\",\n\n\n\t\t\"vec3 cameraPos = vec3(0., 0., 0.);\",\n\t\t\"// uniform sampler2D sDiffuse;\",\n\t\t\"// const float turbidity = 10.0; //\",\n\t\t\"// const float reileigh = 2.; //\",\n\t\t\"// const float luminance = 1.0; //\",\n\t\t\"// const float mieCoefficient = 0.005;\",\n\t\t\"// const float mieDirectionalG = 0.8;\",\n\n\t\t\"uniform float luminance;\",\n\t\t\"uniform float turbidity;\",\n\t\t\"uniform float reileigh;\",\n\t\t\"uniform float mieCoefficient;\",\n\t\t\"uniform float mieDirectionalG;\",\n\n\n\t\t\"vec3 sunDirection = normalize(sunPosition);\",\n\t\t\"float reileighCoefficient = reileigh;\",\n\n\t\t\"// constants for atmospheric scattering\",\n\t\t\"const float e = 2.71828182845904523536028747135266249775724709369995957;\",\n\t\t\"const float pi = 3.141592653589793238462643383279502884197169;\",\n\n\t\t\"const float n = 1.0003; // refractive index of air\",\n\t\t\"const float N = 2.545E25; // number of molecules per unit volume for air at\",\n\t\t\t\t\t\t\t\t\"// 288.15K and 1013mb (sea level -45 celsius)\",\n\t\t\"const float pn = 0.035;\t// depolatization factor for standard air\",\n\n\t\t\"// wavelength of used primaries, according to preetham\",\n\t\t\"const vec3 lambda = vec3(680E-9, 550E-9, 450E-9);\",\n\n\t\t\"// mie stuff\",\n\t\t\"// K coefficient for the primaries\",\n\t\t\"const vec3 K = vec3(0.686, 0.678, 0.666);\",\n\t\t\"const float v = 4.0;\",\n\n\t\t\"// optical length at zenith for molecules\",\n\t\t\"const float rayleighZenithLength = 8.4E3;\",\n\t\t\"const float mieZenithLength = 1.25E3;\",\n\t\t\"const vec3 up = vec3(0.0, 1.0, 0.0);\",\n\n\t\t\"const float EE = 1000.0;\",\n\t\t\"const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;\",\n\t\t\"// 66 arc seconds -> degrees, and the cosine of that\",\n\n\t\t\"// earth shadow hack\",\n\t\t\"const float cutoffAngle = pi/1.95;\",\n\t\t\"const float steepness = 1.5;\",\n\n\n\t\t\"vec3 totalRayleigh(vec3 lambda)\",\n\t\t\"{\",\n\t\t\t\"return (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn));\",\n\t\t\"}\",\n\n\t\t// see http://blenderartists.org/forum/showthread.php?321110-Shaders-and-Skybox-madness\n\t\t\"// A simplied version of the total Reayleigh scattering to works on browsers that use ANGLE\",\n\t\t\"vec3 simplifiedRayleigh()\",\n\t\t\"{\",\n\t\t\t\"return 0.0005 / vec3(94, 40, 18);\",\n\t\t\t// return 0.00054532832366 / (3.0 * 2.545E25 * pow(vec3(680E-9, 550E-9, 450E-9), vec3(4.0)) * 6.245);\n\t\t\"}\",\n\n\t\t\"float rayleighPhase(float cosTheta)\",\n\t\t\"{\t \",\n\t\t\t\"return (3.0 / (16.0*pi)) * (1.0 + pow(cosTheta, 2.0));\",\n\t\t\"//\treturn (1.0 / (3.0*pi)) * (1.0 + pow(cosTheta, 2.0));\",\n\t\t\"//\treturn (3.0 / 4.0) * (1.0 + pow(cosTheta, 2.0));\",\n\t\t\"}\",\n\n\t\t\"vec3 totalMie(vec3 lambda, vec3 K, float T)\",\n\t\t\"{\",\n\t\t\t\"float c = (0.2 * T ) * 10E-18;\",\n\t\t\t\"return 0.434 * c * pi * pow((2.0 * pi) / lambda, vec3(v - 2.0)) * K;\",\n\t\t\"}\",\n\n\t\t\"float hgPhase(float cosTheta, float g)\",\n\t\t\"{\",\n\t\t\t\"return (1.0 / (4.0*pi)) * ((1.0 - pow(g, 2.0)) / pow(1.0 - 2.0*g*cosTheta + pow(g, 2.0), 1.5));\",\n\t\t\"}\",\n\n\t\t\"float sunIntensity(float zenithAngleCos)\",\n\t\t\"{\",\n\t\t\t\"return EE * max(0.0, 1.0 - exp(-((cutoffAngle - acos(zenithAngleCos))/steepness)));\",\n\t\t\"}\",\n\n\t\t\"// float logLuminance(vec3 c)\",\n\t\t\"// {\",\n\t\t\"// \treturn log(c.r * 0.2126 + c.g * 0.7152 + c.b * 0.0722);\",\n\t\t\"// }\",\n\n\t\t\"// Filmic ToneMapping http://filmicgames.com/archives/75\",\n\t\t\"float A = 0.15;\",\n\t\t\"float B = 0.50;\",\n\t\t\"float C = 0.10;\",\n\t\t\"float D = 0.20;\",\n\t\t\"float E = 0.02;\",\n\t\t\"float F = 0.30;\",\n\t\t\"float W = 1000.0;\",\n\n\t\t\"vec3 Uncharted2Tonemap(vec3 x)\",\n\t\t\"{\",\n\t\t   \"return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;\",\n\t\t\"}\",\n\n\n\t\t\"void main() \",\n\t\t\"{\",\n\t\t\t\"float sunfade = 1.0-clamp(1.0-exp((sunPosition.y/450000.0)),0.0,1.0);\",\n\n\t\t\t\"// luminance =  1.0 ;// vWorldPosition.y / 450000. + 0.5; //sunPosition.y / 450000. * 1. + 0.5;\",\n\n\t\t\t \"// gl_FragColor = vec4(sunfade, sunfade, sunfade, 1.0);\",\n\t\t\t\n\t\t\t\"reileighCoefficient = reileighCoefficient - (1.0* (1.0-sunfade));\",\n\t\t\t\n\t\t\t\"float sunE = sunIntensity(dot(sunDirection, up));\",\n\n\t\t\t\"// extinction (absorbtion + out scattering) \",\n\t\t\t\"// rayleigh coefficients\",\n\n\t\t\t// \"vec3 betaR = totalRayleigh(lambda) * reileighCoefficient;\",\n\t\t\t\"vec3 betaR = simplifiedRayleigh() * reileighCoefficient;\",\n\n\t\t\t\"// mie coefficients\",\n\t\t\t\"vec3 betaM = totalMie(lambda, K, turbidity) * mieCoefficient;\",\n\n\t\t\t\"// optical length\",\n\t\t\t\"// cutoff angle at 90 to avoid singularity in next formula.\",\n\t\t\t\"float zenithAngle = acos(max(0.0, dot(up, normalize(vWorldPosition - cameraPos))));\",\n\t\t\t\"float sR = rayleighZenithLength / (cos(zenithAngle) + 0.15 * pow(93.885 - ((zenithAngle * 180.0) / pi), -1.253));\",\n\t\t\t\"float sM = mieZenithLength / (cos(zenithAngle) + 0.15 * pow(93.885 - ((zenithAngle * 180.0) / pi), -1.253));\",\n\n\n\n\t\t\t\"// combined extinction factor\t\",\n\t\t\t\"vec3 Fex = exp(-(betaR * sR + betaM * sM));\",\n\n\t\t\t\"// in scattering\",\n\t\t\t\"float cosTheta = dot(normalize(vWorldPosition - cameraPos), sunDirection);\",\n\n\t\t\t\"float rPhase = rayleighPhase(cosTheta*0.5+0.5);\",\n\t\t\t\"vec3 betaRTheta = betaR * rPhase;\",\n\n\t\t\t\"float mPhase = hgPhase(cosTheta, mieDirectionalG);\",\n\t\t\t\"vec3 betaMTheta = betaM * mPhase;\",\n\n\n\t\t\t\"vec3 Lin = pow(sunE * ((betaRTheta + betaMTheta) / (betaR + betaM)) * (1.0 - Fex),vec3(1.5));\",\n\t\t\t\"Lin *= mix(vec3(1.0),pow(sunE * ((betaRTheta + betaMTheta) / (betaR + betaM)) * Fex,vec3(1.0/2.0)),clamp(pow(1.0-dot(up, sunDirection),5.0),0.0,1.0));\",\n\n\t\t\t\"//nightsky\",\n\t\t\t\"vec3 direction = normalize(vWorldPosition - cameraPos);\",\n\t\t\t\"float theta = acos(direction.y); // elevation --> y-axis, [-pi/2, pi/2]\",\n\t\t\t\"float phi = atan(direction.z, direction.x); // azimuth --> x-axis [-pi/2, pi/2]\",\n\t\t\t\"vec2 uv = vec2(phi, theta) / vec2(2.0*pi, pi) + vec2(0.5, 0.0);\",\n\t\t\t\"// vec3 L0 = texture2D(skySampler, uv).rgb+0.1 * Fex;\",\n\t\t\t\"vec3 L0 = vec3(0.1) * Fex;\",\n\t\t\t\n\t\t\t\"// composition + solar disc\",\n\t\t\t\"//if (cosTheta > sunAngularDiameterCos)\",\n\t\t\t\"float sundisk = smoothstep(sunAngularDiameterCos,sunAngularDiameterCos+0.00002,cosTheta);\",\n\t\t\t\"// if (normalize(vWorldPosition - cameraPos).y>0.0)\",\n\t\t\t\"L0 += (sunE * 19000.0 * Fex)*sundisk;\",\n\n\n\t\t\t\"vec3 whiteScale = 1.0/Uncharted2Tonemap(vec3(W));\",\n\t\t\t\n\t\t\t\"vec3 texColor = (Lin+L0);   \",\n\t\t\t\"texColor *= 0.04 ;\",\n\t\t\t\"texColor += vec3(0.0,0.001,0.0025)*0.3;\",\n\t\t\t\n\t\t\t\"float g_fMaxLuminance = 1.0;\",\n\t\t\t\"float fLumScaled = 0.1 / luminance;     \",\n\t\t\t\"float fLumCompressed = (fLumScaled * (1.0 + (fLumScaled / (g_fMaxLuminance * g_fMaxLuminance)))) / (1.0 + fLumScaled); \",\n\n\t\t\t\"float ExposureBias = fLumCompressed;\",\n\t\t   \n\t\t\t\"vec3 curr = Uncharted2Tonemap((log2(2.0/pow(luminance,4.0)))*texColor);\",\n\t\t\t\"vec3 color = curr*whiteScale;\",\n\n\t\t\t\"vec3 retColor = pow(color,vec3(1.0/(1.2+(1.2*sunfade))));\",\n\n\t\t\t\n\t\t\t\"gl_FragColor.rgb = retColor;\",\n\t\t\t\t\n\t\t\t\"gl_FragColor.a = 1.0;\",\n\t\t\"}\",\n\n\t].join(\"\\n\")\n\n};\n\nTHREE.Sky = function () {\n\n\tvar skyShader = THREE.ShaderLib[ \"sky\" ];\n\tvar skyUniforms = THREE.UniformsUtils.clone( skyShader.uniforms );\n\n\tvar skyMat = new THREE.ShaderMaterial( { \n\t\tfragmentShader: skyShader.fragmentShader, \n\t\tvertexShader: skyShader.vertexShader, \n\t\tuniforms: skyUniforms,\n\t\tside: THREE.BackSide\n\t} );\n\n\tvar skyGeo = new THREE.SphereGeometry( 450000, 32, 15 );\n\tvar skyMesh = new THREE.Mesh( skyGeo, skyMat );\n\n\n\t// Expose variables\n\tthis.mesh = skyMesh;\n\tthis.uniforms = skyUniforms;\n\n\n};\n\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/imports-loader?THREE=three!./bower_components/SkyShader/index.js\n ** module id = 69\n ** module chunks = 0\n **/","module.exports = (function () {\n\t'use strict';\n\n\tvar materials = require('../materials'),\n\t\tTHREE = require('three');\n\n\trequire('imports?THREE=three!../lib/ThreeAudio');\n\n\treturn function sound(parent, options) {\n\t\tvar obj,\n\t\t\tsrc,\n\t\t\tlistener,\n\t\t\tscene = parent;\n\n\t\tif (typeof options === 'string' || Array.isArray(options)) {\n\t\t\tsrc = options;\n\t\t} else if (options) {\n\t\t\tsrc = options.src;\n\t\t}\n\n\t\twhile (!(scene instanceof THREE.Scene) && scene.parent) {\n\t\t\tscene = scene.parent;\n\t\t}\n\n\t\tlistener = scene.getObjectByName('audio-listener');\n\t\tobj = new THREE.Audio(listener);\n\t\t// obj.setLoop(true);\n\t\tobj.load(src);\n\n\t\tthis.start = obj.start.bind(obj);\n\t\tthis.volume = obj.volume.bind(obj);\n\n\t\tparent.add(obj);\n\n\t\treturn obj;\n\t};\n}());\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/objects/sound.js\n ** module id = 70\n ** module chunks = 0\n **/","/*** IMPORTS FROM imports-loader ***/\nvar THREE = require(\"three\");\n\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.Audio = function ( listener ) {\n\n\tTHREE.Object3D.call( this );\n\n\tthis.type = 'Audio';\n\tthis.started = false;\n\n\tif (listener.context) {\n\n\t\tthis.context = listener.context;\n\t\t// this.source = this.context.createBufferSource();\n\n\t\tthis.gain = this.context.createGain();\n\t\tthis.gain.connect( listener.input );\n\n\t\tthis.panner = this.context.createPanner();\n\t\tthis.panner.connect( this.gain );\n\n\t} else {\n\n\t\tthis.source = new Audio();\n\n\t}\n};\n\nTHREE.Audio.prototype = Object.create( THREE.Object3D.prototype );\n\nTHREE.Audio.prototype.load = function ( sources ) {\n\t//todo: support multiple sources for different audio formats\n\n\tvar scope = this;\n\tvar file;\n\tvar i;\n\tvar match;\n\tvar element = this.source instanceof window.HTMLAudioElement ? this.source : new Audio();\n\n\tif (typeof sources === 'string') {\n\t\tsources = [sources];\n\t}\n\n\tfor (i = 0; i < sources.length; i++) {\n\t\tfile = sources[i];\n\t\tmatch = /\\.([a-z0-9]+)$/i.exec(file);\n\t\tif (match && element.canPlayType('audio/' + match[1])) {\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (this.context) {\n\t\tvar request = new XMLHttpRequest();\n\t\trequest.open( 'GET', file, true );\n\t\trequest.responseType = 'arraybuffer';\n\t\trequest.onload = function ( e ) {\n\t\t\tconsole.log('audio buffer loaded. decoding...', e );\n\t\t\tscope.context.decodeAudioData( this.response, function ( buffer ) {\n\n\t\t\t\tscope.buffer = buffer;\n\t\t\t\tif (scope.started) {\n\t\t\t\t\tscope.start();\n\t\t\t\t}\n\n\t\t\t}, function onFailure(e) {\n\t\t\t\tconsole.log('Decoding the audio buffer failed', e);\n\t\t\t} );\n\n\t\t};\n\n\t\trequest.onerror = function ( e ) {\n\t\t\tconsole.log('error', e);\n\t\t};\n\n\t\trequest.send();\n\n\t} else {\n\n\t\tthis.source.src = file;\n\t\tthis.source.play();\n\n\t}\n\n\treturn this;\n};\n\nTHREE.Audio.prototype.stop = function ( value ) {\n\n\tif (this.context) {\n\t\tthis.source.stop();\n\t\tthis.source.disconnect( this.panner );\n\t\tthis.source = null;\n\t} else {\n\t\tthis.source.pause();\n\t\tthis.source.currentTime = 0;\n\t}\n\tthis.started = false;\n};\n\nTHREE.Audio.prototype.start = function ( value ) {\n\n\tthis.started = true;\n\tif (this.context) {\n\t\tif (this.source) {\n\t\t\tthis.source.disconnect( this.panner );\n\t\t}\n\n\t\tif (this.buffer) {\n\t\t\tthis.source = this.context.createBufferSource();\n\t\t\tthis.source.buffer = this.buffer;\n\t\t\tthis.source.connect( this.panner );\n\t\t\tthis.source.start( 0 );\n\t\t}\n\t} else {\n\t\tthis.source.currentTime = 0;\n\t\tthis.source.play();\n\t}\n\n};\n\nTHREE.Audio.prototype.setLoop = function ( value ) {\n\n\tthis.source.loop = value;\n\n};\n\nTHREE.Audio.prototype.setRefDistance = function ( value ) {\n\n\tif ( this.panner ) {\n\n\t\tthis.panner.refDistance = value;\n\n\t}\n\n};\n\nTHREE.Audio.prototype.setRolloffFactor = function ( value ) {\n\n\tif ( this.panner ) {\n\n\t\tthis.panner.rolloffFactor = value;\n\n\t}\n\n};\n\nTHREE.Audio.prototype.volume = function ( volume, time ) {\n\n\tif ( this.gain ) {\n\n\t\tif ( volume !== undefined ) {\n\t\t\tthis.gain.gain.linearRampToValueAtTime( volume, this.context.currentTime + (time || 0));\n\t\t}\n\n\t\treturn this.gain.gain.value;\n\t}\n\n\tif ( volume !== undefined ) {\n\t\tthis.source.volume = volume;\n\t}\n\n\treturn this.source.volume;\n};\n\nTHREE.Audio.prototype.updateMatrixWorld = ( function () {\n\n\tvar position = new THREE.Vector3();\n\n\treturn function ( force ) {\n\n\t\tTHREE.Object3D.prototype.updateMatrixWorld.call( this, force );\n\n\t\tposition.setFromMatrixPosition( this.matrixWorld );\n\n\t\tif (this.panner) {\n\n\t\t\tthis.panner.setPosition( position.x, position.y, position.z );\n\n\t\t}\n\n\t};\n\n} )();\n\n// File:src/extras/audio/AudioListener.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.AudioListener = function () {\n\tvar AudioContext = window.AudioContext || window.webkitAudioContext;\n\n\tTHREE.Object3D.call( this );\n\n\tthis.type = 'AudioListener';\n\n\tif (AudioContext) {\n\t\tthis.context = new AudioContext();\n\t\tthis.input = this.context.createGain();\n\n\t\tthis.input.connect( this.context.destination );\n\t}\n};\n\nTHREE.AudioListener.prototype = Object.create( THREE.Object3D.prototype );\n\nTHREE.AudioListener.prototype.volume = function (val) {\n\tif (this.input) {\n\t\tval = val !== undefined && parseFloat(val);\n\t\tif (!isNaN(val)) {\n\t\t\tthis.input.gain.value = val;\n\t\t}\n\n\t\treturn this.input.gain.value;\n\t}\n};\n\nTHREE.AudioListener.prototype.updateMatrixWorld = ( function () {\n\n\tvar position = new THREE.Vector3();\n\tvar quaternion = new THREE.Quaternion();\n\tvar scale = new THREE.Vector3();\n\n\tvar orientation = new THREE.Vector3();\n\n\treturn function ( force ) {\n\n\t\tTHREE.Object3D.prototype.updateMatrixWorld.call( this, force );\n\n\t\tvar listener;\n\n\t\tif (this.context) {\n\t\t\tlistener = this.context.listener;\n\n\t\t\tthis.matrixWorld.decompose( position, quaternion, scale );\n\n\t\t\torientation.set( 0, 0, -1 ).applyQuaternion( quaternion );\n\n\t\t\tlistener.setPosition( position.x, position.y, position.z );\n\t\t\tlistener.setOrientation( orientation.x, orientation.y, orientation.z, this.up.x, this.up.y, this.up.z );\n\n\t\t}\n\t};\n\n} ());\n\n\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/imports-loader?THREE=three!./src/lib/ThreeAudio.js\n ** module id = 71\n ** module chunks = 0\n **/","module.exports = (function () {\n\t'use strict';\n\n\tvar materials = require('../materials'),\n\t\tTHREE = require('three');\n\n\treturn function box(parent, options) {\n\t\tvar geometry,\n\t\t\tmesh;\n\n\t\tgeometry = new THREE.SphereGeometry(\n\t\t\toptions.radius === undefined ? 0.5 : options.radius,\n\t\t\toptions.widthSegments === undefined ? 16 : options.widthSegments,\n\t\t\toptions.heightSegments === undefined ? 12 : options.heightSegments,\n\t\t\toptions.phiStart,\n\t\t\toptions.phiLength,\n\t\t\toptions.thetaStart,\n\t\t\toptions.thetaLength\n\t\t);\n\t\tmesh = new THREE.Mesh(geometry, materials.standard());\n\t\tmesh.name = 'sphere';\n\n\t\tparent.add(mesh);\n\n\t\treturn mesh;\n\t};\n}());\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/objects/sphere.js\n ** module id = 72\n ** module chunks = 0\n **/","module.exports = (function () {\n\t'use strict';\n\n\tvar THREE = require('three'),\n\t\tfontSizeRegex = /(\\d+)px/i,\n\t\tnewLineRegex = /[\\n\\r]/,\n\t\tspaceRegex = /[\\t ]/,\n\t\tlog2 = Math.log(2),\n\t\tgeometry = new THREE.PlaneBufferGeometry(1, 1);\n\n\treturn function text(parent, options) {\n\t\tvar self = this,\n\t\t\tmaterial,\n\t\t\tcanvas,\n\t\t\tctx,\n\t\t\tmesh,\n\t\t\tcontainer,\n\t\t\tsrc,\n\t\t\ttextWidth = 0,\n\t\t\ttextHeight = 0,\n\t\t\tprops = {\n\t\t\t\ttext: '',\n\t\t\t\tfont: '80px sans-serif',\n\t\t\t\ttextAlign: 'center',\n\t\t\t\ttextBaseline: '',\n\t\t\t\tdirection: '',\n\t\t\t\tfillStyle: 'white',\n\t\t\t\tresolution: 256, //pixels per meter\n\t\t\t\twrap: 5 //in meters\n\t\t\t},\n\t\t\ttex;\n\n\t\tfunction nextPowerOfTwo(n) {\n\t\t\treturn Math.pow(2, Math.ceil(Math.log(n) / log2));\n\t\t}\n\n\t\tfunction Line(word) {\n\t\t\tthis.spaceWidth = ctx.measureText(' ').width;\n\t\t\tthis.totalWidth = 0;\n\t\t\tthis.wordsWidth = 0;\n\t\t\tthis.words = [];\n\t\t\tthis.wrap = false;\n\t\t\tif (word) {\n\t\t\t\tthis.add(word);\n\t\t\t}\n\t\t}\n\n\t\tLine.prototype.text = function () {\n\t\t\treturn this.words.join(' ');\n\t\t};\n\n\t\tLine.prototype.add = function(word) {\n\t\t\tvar wordWidth;\n\t\t\tif (this.words.length) {\n\t\t\t\tthis.totalWidth += this.spaceWidth;\n\t\t\t}\n\t\t\tthis.words.push(word);\n\t\t\twordWidth = Line.measure(word);\n\t\t\tthis.totalWidth += wordWidth;\n\t\t\tthis.wordsWidth += wordWidth;\n\t\t};\n\n\t\tLine.prototype.measure = function(word) {\n\t\t\tvar width = this.totalWidth;\n\t\t\tif (word) {\n\t\t\t\twidth += Line.measure(word);\n\t\t\t\tif (this.words.length) {\n\t\t\t\t\twidth += this.spaceWidth;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn width;\n\t\t};\n\n\t\tLine.measure = function(word) {\n\t\t\treturn ctx.measureText(word).width;\n\t\t};\n\n\t\tfunction update() {\n\t\t\t//text stuffs\n\t\t\tvar text,\n\t\t\t\tword = '',\n\t\t\t\tletter,\n\t\t\t\tisSpace,\n\t\t\t\tline,\n\t\t\t\tlines = [],\n\t\t\t\tparse,\n\n\t\t\t\t//layout\n\t\t\t\tdirection = getComputedStyle(document.body).direction,\n\t\t\t\tinherit,\n\t\t\t\tresolution = parseFloat(props.resolution) || 256,\n\t\t\t\twrap,\n\t\t\t\twrapped = false,\n\t\t\t\tfontSize,\n\t\t\t\tpadding,\n\n\t\t\t\t//measurements\n\t\t\t\tlineHeight,\n\t\t\t\ti, start, y, measure,\n\t\t\t\twidth,\n\t\t\t\theight = 0;\n\n\t\t\twrap = parseFloat(props.wrap);\n\t\t\tif (isNaN(wrap) || wrap < 0) {\n\t\t\t\twrap = 5;\n\t\t\t}\n\t\t\twidth = resolution * wrap;\n\n\t\t\tctx.font = props.font;\n\t\t\tparse = fontSizeRegex.exec(ctx.font);\n\t\t\tfontSize = parseFloat(parse && parse[1]) || 50;\n\n\t\t\tlineHeight = fontSize * 1.5;\n\n\t\t\tline = new Line();\n\n\t\t\ttext = props.text === 0 ? '0' : String(props.text || '');\n\t\t\tif (wrap) {\n\t\t\t\ttext = text.trim() + ' ';\n\t\t\t\tfor (i = 0; i < text.length; i++) {\n\t\t\t\t\tletter = text.charAt(i);\n\t\t\t\t\tif (newLineRegex.test(letter)) {\n\t\t\t\t\t\tline.add(word);\n\t\t\t\t\t\tlines.push(line);\n\t\t\t\t\t\tword = '';\n\t\t\t\t\t\tline = new Line();\n\t\t\t\t\t} else if (spaceRegex.test(letter)) {\n\t\t\t\t\t\tmeasure = line.measure(word);\n\t\t\t\t\t\tif (measure < width) {\n\t\t\t\t\t\t\tif (line) {\n\t\t\t\t\t\t\t\tline.add(word);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tline = new Line(word);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (!line && Line.measure(word) >= width) {\n\t\t\t\t\t\t\t//one very long word\n\t\t\t\t\t\t\tlines.push(new Line(word));\n\t\t\t\t\t\t\tword = '';\n\t\t\t\t\t\t\tline = new Line();\n\t\t\t\t\t\t\twrapped = true;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tline.wrap = true;\n\t\t\t\t\t\t\tlines.push(line);\n\t\t\t\t\t\t\tline = new Line(word);\n\t\t\t\t\t\t\twrapped = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tword = '';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tword += letter;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (line) {\n\t\t\t\t\tlines.push(line);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tlines.push(new Line(text));\n\t\t\t}\n\n\t\t\tif (!width || !wrapped) {\n\t\t\t\twidth = lines.reduce(function (previous, line) {\n\t\t\t\t\treturn Math.max(previous, line.totalWidth);\n\t\t\t\t}, 0);\n\t\t\t}\n\t\t\twidth = Math.min(width, 2048);\n\n\t\t\theight = lines.length * lineHeight;\n\n\t\t\tif (options && options.mipmap === false) {\n\t\t\t\tcanvas.width = width;\n\t\t\t\tcanvas.height = height;\n\t\t\t} else {\n\t\t\t\tcanvas.width = nextPowerOfTwo(width);\n\t\t\t\tcanvas.height = nextPowerOfTwo(height);\n\t\t\t}\n\n\t\t\tmesh.scale.set(canvas.width / resolution, canvas.height / resolution, 1);\n\n\t\t\t//debug\n\t\t\t// ctx.fillStyle = 'rgba(100, 100, 100, 0.5)';\n\t\t\t// ctx.fillRect(0, 0, canvas.width, canvas.height);\n\t\t\t// document.body.appendChild(canvas);\n\t\t\t// canvas.style.cssText = 'position: absolute; width: auto !important; height: auto !important; max-width: 80%';\n\n\t\t\t/*\n\t\t\tset all these properties again because they get reset\n\t\t\twhen you resize the canvas\n\t\t\t*/\n\t\t\tctx.font = props.font;\n\t\t\tctx.textAlign = props.textAlign;\n\t\t\tctx.textBaseline = props.textBaseline;\n\t\t\tctx.direction = props.direction;\n\t\t\tctx.fillStyle = props.fillStyle;\n\t\t\t//todo: add maxWidth?\n\n\t\t\tpadding = (canvas.width - width) / 2;\n\t\t\ty = (canvas.height - height) / 2 + lineHeight / 2;\n\n\t\t\tinherit = (ctx.direction === '' || ctx.direction === 'inherit');\n\t\t\tif (ctx.textAlign === 'center') {\n\t\t\t\tstart = canvas.width / 2;\n\t\t\t} else if (ctx.textAlign === 'right' ||\n\t\t\t\tctx.textAlign === 'end' && (ctx.direction === 'ltr' || inherit && direction === 'ltr') ||\n\t\t\t\tctx.textAlign === 'start' && (ctx.direction === 'rtl' || inherit && direction === 'rtl')) {\n\n\t\t\t\tstart = canvas.width - padding;\n\t\t\t} else {\n\t\t\t\tstart = padding;\n\t\t\t}\n\n\t\t\tlines.forEach(function (line) {\n\t\t\t\tvar x,\n\t\t\t\t\tspace;\n\t\t\t\tif (props.textAlign === 'justify' && line.wrap && line.words.length > 1) {\n\t\t\t\t\tx = start;\n\t\t\t\t\tspace = (width - line.wordsWidth) / (line.words.length - 1);\n\t\t\t\t\tline.words.forEach(function (word) {\n\t\t\t\t\t\tctx.fillText(word, x, y);\n\t\t\t\t\t\tx += space + Line.measure(word);\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tctx.fillText(line.text(), start, y);\n\t\t\t\t}\n\t\t\t\ty += lineHeight;\n\t\t\t});\n\n\t\t\ttextWidth = width / resolution;\n\t\t\ttextHeight = lines.length * lineHeight / resolution;\n\n\t\t\ttex.needsUpdate = true;\n\n\t\t\tmesh.name = text.trim();\n\t\t}\n\n\t\tcanvas = document.createElement('canvas');\n\t\tctx = canvas.getContext('2d');\n\t\ttex = new THREE.Texture(canvas);\n\n\t\tif (canvas.width === nextPowerOfTwo(canvas.width) &&\n\t\t\tcanvas.height === nextPowerOfTwo(canvas.height)) {\n\n\t\t\ttex.minFilter = THREE.LinearMipMapLinearFilter;\n\t\t\ttex.generateMipmaps = true;\n\t\t}\n\n\t\tmaterial = new THREE.MeshBasicMaterial({\n\t\t\tside: THREE.DoubleSide,\n\t\t\ttransparent: true,\n\t\t\tmap: tex\n\t\t});\n\n\t\tmesh = new THREE.Mesh(geometry, material);\n\n\t\tcontainer = new THREE.Object3D();\n\t\tcontainer.name = 'text';\n\t\tcontainer.add(mesh);\n\t\tparent.add(container);\n\n\t\tif (typeof options === 'string') {\n\t\t\tprops.text = options;\n\t\t} else if (options) {\n\t\t\tObject.keys(props).forEach(function (key) {\n\t\t\t\tprops[key] = options[key] || props[key];\n\t\t\t});\n\t\t}\n\t\tupdate();\n\n\t\tObject.keys(props).forEach(function (key) {\n\t\t\tObject.defineProperty(self, key, {\n\t\t\t\tget: function () {\n\t\t\t\t\treturn props[key];\n\t\t\t\t},\n\t\t\t\tset: function (val) {\n\t\t\t\t\tprops[key] = val;\n\t\t\t\t\tupdate();\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\tObject.defineProperty(self, 'width', {\n\t\t\tget: function () {\n\t\t\t\treturn textWidth;\n\t\t\t}\n\t\t});\n\n\t\tObject.defineProperty(self, 'height', {\n\t\t\tget: function () {\n\t\t\t\treturn textHeight;\n\t\t\t}\n\t\t});\n\n\t\tthis.material = material;\n\n\t\treturn container;\n\t};\n}());\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/objects/text.js\n ** module id = 73\n ** module chunks = 0\n **/","module.exports = (function () {\n\t'use strict';\n\n\tvar materials = require('../materials'),\n\t\tTHREE = require('three');\n\n\treturn function torus(parent, options) {\n\t\tvar geometry,\n\t\t\tmesh;\n\n\t\tgeometry = new THREE.TorusGeometry(\n\t\t\toptions.radius === undefined ? 0.5 : options.radius,\n\t\t\toptions.tube === undefined ? 0.125 : options.tube,\n\t\t\toptions.radialSegments === undefined ? 12 : options.radialSegments,\n\t\t\toptions.tubularSegments === undefined ? 16 : options.tubularSegments,\n\t\t\toptions.arc\n\t\t);\n\t\tmesh = new THREE.Mesh(geometry, materials.standard());\n\t\tmesh.name = 'torus';\n\n\t\tparent.add(mesh);\n\n\t\treturn mesh;\n\t};\n}());\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/objects/torus.js\n ** module id = 74\n ** module chunks = 0\n **/","module.exports = (function () {\n\t'use strict';\n\n\tvar THREE = require('three'),\n\t\turlRegex = require('../utils/urlregex'),\n\t\textRegex = /\\.(webm|ogg|ogv|m4v|mp4|mov)/i,\n\t\tvideo;\n\n\tvideo = function (parent, options) {\n\t\tvar geometry,\n\t\t\tmaterial,\n\t\t\tmesh,\n\t\t\tvid,\n\t\t\ttex,\n\t\t\taspectRatio = 1,\n\t\t\tplaying = false,\n\t\t\tself = this;\n\n\t\tfunction isPowerOfTwo(num) {\n\t\t\treturn num > 0 && (num & (num-1)) === 0; // jshint ignore:line\n\t\t}\n\n\t\tfunction loadedMetadata() {\n\t\t\t//todo: don't do any of this if object has been deleted\n\n\t\t\tvar newAspectRatio = vid.videoWidth / vid.videoHeight;\n\t\t\tif (!options || !options.sphere) {\n\t\t\t\tgeometry.applyMatrix(new THREE.Matrix4().makeScale(1, aspectRatio / newAspectRatio, 1));\n\t\t\t}\n\t\t\taspectRatio = newAspectRatio;\n\n\t\t\tif (vid.videoWidth === vid.videoHeight &&\n\t\t\t\t\tisPowerOfTwo(vid.videoWidth) && isPowerOfTwo(vid.videoHeight)) {\n\n\t\t\t\ttex.minFilter = THREE.LinearMipMapLinearFilter;\n\t\t\t\ttex.generateMipmaps = true;\n\t\t\t} else {\n\t\t\t\ttex.minFilter = THREE.LinearFilter;\n\t\t\t\ttex.generateMipmaps = false;\n\t\t\t}\n\n\t\t\tmaterial.map = tex;\n\t\t\tmaterial.visible = true;\n\n\t\t\tif (playing) {\n\t\t\t\tvid.play();\n\t\t\t}\n\t\t}\n\n\t\tfunction setSource(sources) {\n\t\t\tsources.forEach(function (src) {\n\t\t\t\tvar parse,\n\t\t\t\t\text,\n\t\t\t\t\tsource;\n\n\t\t\t\tif (!src) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tparse = urlRegex.exec(src);\n\t\t\t\tif (parse &&\n\t\t\t\t\t\t(parse[1] && parse[1] !== window.location.host ||\n\t\t\t\t\t\t\tparse[2] && parse[2] !== window.location.port)) {\n\n\t\t\t\t\tif (vid.crossOrigin !== undefined) {\n\t\t\t\t\t\tvid.crossOrigin = 'anonymous';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.warn('Browser does not support cross-origin video');\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tsource = document.createElement('source');\n\t\t\t\tsource.src = src;\n\n\t\t\t\text = extRegex.exec(src);\n\t\t\t\tif (!ext || vid.canPlayType('video/' + ext[1])) {\n\t\t\t\t\tvid.appendChild(source);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t/*\n\t\tPause the video when this browser tab is in the background or minimized.\n\t\tResume when it comes back in focus, but only if the user didn't pause manually.\n\t\t*/\n\t\tfunction visibilityChange() {\n\t\t\tif (document.hidden || document.mozHidden || document.msHidden || document.webkitHidden) {\n\t\t\t\tvid.pause();\n\t\t\t} else if (playing) {\n\t\t\t\tvid.play();\n\t\t\t}\n\t\t}\n\n\t\tvid = document.createElement('video');\n\t\tvid.loop = true;\n\t\tvid.addEventListener('loadedmetadata', loadedMetadata, false);\n\n\t\tif (Array.isArray(options)) {\n\t\t\tsetSource(options);\n\t\t} if (typeof options === 'string') {\n\t\t\tsetSource([options]);\n\t\t} else if (typeof options.src === 'string') {\n\t\t\tsetSource([options.src]);\n\t\t} else if (Array.isArray(options.src)) {\n\t\t\tsetSource(options.src);\n\t\t}\n\n\t\tvid.load();\n\n\t\ttex = new THREE.VideoTexture(vid, THREE.UVMapping);\n\t\ttex.format = THREE.RGBFormat;\n\n\t\tif (options && options.sphere) {\n\t\t\tgeometry = new THREE.SphereGeometry(\n\t\t\t\t994, //radius\n\t\t\t\t60, //widthSegments\n\t\t\t\t60, //heightSegments\n\t\t\t\t(parseFloat(options.phiStart) || 0) * Math.PI * 2,\n\t\t\t\t(parseFloat(options.phiLength) || 1) * Math.PI * 2,\n\t\t\t\t(parseFloat(options.thetaStart) || 0) * Math.PI,\n\t\t\t\t(parseFloat(options.thetaLength) || 1) * Math.PI\n\t\t\t);\n\t\t\tgeometry.applyMatrix(new THREE.Matrix4().makeScale(-1, 1, 1));\n\t\t\tgeometry.applyMatrix(new THREE.Matrix4().makeRotationY(- Math.PI / 2));\n\t\t} else {\n\t\t\tgeometry = new THREE.PlaneBufferGeometry(1, 1, 8);\n\t\t}\n\n\t\tmaterial = new THREE.MeshBasicMaterial({\n\t\t\tside: THREE.DoubleSide,\n\t\t\tmap: tex,\n\t\t\tvisible: false\n\t\t});\n\n\t\tmesh = new THREE.Mesh(geometry, material);\n\n\t\tif (options && options.stereo) {\n\t\t\tif (options.stereo === 'vertical') {\n\t\t\t\ttex.repeat.y = 0.5;\n\t\t\t} else {\n\t\t\t\ttex.repeat.x = 0.5;\n\t\t\t}\n\t\t\tmesh.userData.stereo = options.stereo;\n\t\t}\n\n\t\tif (vid.readyState) {\n\t\t\tloadedMetadata();\n\t\t}\n\n\t\tthis.play = function play() {\n\t\t\tplaying = true;\n\t\t\tvid.play();\n\t\t\treturn this;\n\t\t};\n\n\t\tthis.pause = function pause() {\n\t\t\tplaying = false;\n\t\t\tvid.pause();\n\t\t\treturn this;\n\t\t};\n\n\t\tthis.canPlayType = video.canPlayType;\n\n\t\tObject.defineProperty(this, 'width', {\n\t\t\tget: function () {\n\t\t\t\treturn vid.videoWidth;\n\t\t\t}\n\t\t});\n\n\t\tObject.defineProperty(this, 'height', {\n\t\t\tget: function () {\n\t\t\t\treturn vid.videoHeight;\n\t\t\t}\n\t\t});\n\n\t\tObject.defineProperty(this, 'paused', {\n\t\t\tget: function () {\n\t\t\t\treturn !playing;\n\t\t\t}\n\t\t});\n\n\t\tObject.defineProperty(this, 'volume', {\n\t\t\tget: function () {\n\t\t\t\treturn vid.volume;\n\t\t\t},\n\t\t\tset: function (vol) {\n\t\t\t\tvid.volume = vol;\n\t\t\t}\n\t\t});\n\n\t\tObject.defineProperty(this, 'muted', {\n\t\t\tget: function () {\n\t\t\t\treturn vid.muted;\n\t\t\t},\n\t\t\tset: function (muted) {\n\t\t\t\tvid.muted = muted;\n\t\t\t}\n\t\t});\n\n\t\tObject.defineProperty(this, 'duration', {\n\t\t\tget: function () {\n\t\t\t\treturn vid.duration || 0;\n\t\t\t}\n\t\t});\n\n\t\tObject.defineProperty(this, 'currentTime', {\n\t\t\tget: function () {\n\t\t\t\treturn vid.currentTime;\n\t\t\t},\n\t\t\tset: function (currentTime) {\n\t\t\t\tif (vid.readyState && currentTime < vid.duration && currentTime >= 0) {\n\t\t\t\t\tvid.currentTime = currentTime;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t[\n\t\t\t'loadedmetadata',\n\t\t\t'play',\n\t\t\t'pause',\n\t\t\t'playing',\n\t\t\t'progress'\n\t\t].forEach(function registerMediaEvent(event) {\n\t\t\tvid.addEventListener(event, self.emit.bind(self, event));\n\t\t});\n\n\t\t//sometimes video fails to play because it's too big. remove it and try again\n\t\tvid.addEventListener('error', function (evt) {\n\t\t\tif (vid.error.code === window.MediaError.MEDIA_ERR_DECODE && vid.childNodes.length > 1) {\n\t\t\t\tmaterial.visible = false;\n\t\t\t\tvid.removeChild(vid.firstChild);\n\t\t\t\tvid.load();\n\t\t\t}\n\n\t\t\tself.emit(event, evt);\n\t\t}, true);\n\n\t\tthis.element = vid;\n\n\t\twindow.addEventListener('touchstart', function touchStart() {\n\t\t\tif (playing) {\n\t\t\t\tvid.play();\n\t\t\t} else {\n\t\t\t\tvid.load();\n\t\t\t}\n\t\t\twindow.removeEventListener('touchstart', touchStart, true);\n\t\t}, true);\n\n\t\t//pause when window is hidden\n\t\tdocument.addEventListener('visibilitychange', visibilityChange);\n\t\tdocument.addEventListener('mozvisibilitychange', visibilityChange);\n\t\tdocument.addEventListener('msvisibilitychange', visibilityChange);\n\t\tdocument.addEventListener('webkitvisibilitychange', visibilityChange);\n\n\t\tmesh.name = 'video';\n\t\tthis.raycastable = !(options && options.sphere);\n\t\tparent.add(mesh);\n\n\t\treturn mesh;\n\t};\n\n\tvideo.canPlayType = function canPlayType(type) {\n\t\tvar element = document.createElement('video');\n\t\treturn element.canPlayType(type);\n\t};\n\n\treturn video;\n}());\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/objects/video.js\n ** module id = 75\n ** module chunks = 0\n **/","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"8\\\" height=\\\"8\\\" viewBox=\\\"0 0 8 8\\\">\\n  <path d=\\\"M0 0v4l1.5-1.5 1.5 1.5 1-1-1.5-1.5 1.5-1.5h-4zm5 4l-1 1 1.5 1.5-1.5 1.5h4v-4l-1.5 1.5-1.5-1.5z\\\" />\\n</svg>\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/raw-loader!./bower_components/open-iconic/svg/fullscreen-enter.svg\n ** module id = 76\n ** module chunks = 0\n **/","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"8\\\" height=\\\"8\\\" viewBox=\\\"0 0 8 8\\\">\\n  <path d=\\\"M1 0l-1 1 1.5 1.5-1.5 1.5h4v-4l-1.5 1.5-1.5-1.5zm3 4v4l1.5-1.5 1.5 1.5 1-1-1.5-1.5 1.5-1.5h-4z\\\" />\\n</svg>\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/raw-loader!./bower_components/open-iconic/svg/fullscreen-exit.svg\n ** module id = 77\n ** module chunks = 0\n **/","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"8\\\" height=\\\"8\\\" viewBox=\\\"0 0 8 8\\\">\\n  <path d=\\\"M4.03 0c-2.53 0-4.03 3-4.03 3s1.5 3 4.03 3c2.47 0 3.97-3 3.97-3s-1.5-3-3.97-3zm-.03 1c1.11 0 2 .9 2 2 0 1.11-.89 2-2 2-1.1 0-2-.89-2-2 0-1.1.9-2 2-2zm0 1c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1c0-.1-.04-.19-.06-.28-.08.16-.24.28-.44.28-.28 0-.5-.22-.5-.5 0-.2.12-.36.28-.44-.09-.03-.18-.06-.28-.06z\\\"\\n  transform=\\\"translate(0 1)\\\" />\\n</svg>\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/raw-loader!./bower_components/open-iconic/svg/eye.svg\n ** module id = 78\n ** module chunks = 0\n **/","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"8\\\" height=\\\"8\\\" viewBox=\\\"0 0 8 8\\\">\\n  <path d=\\\"M4 0c-2.2 0-4 1.8-4 4s1.8 4 4 4 4-1.8 4-4-1.8-4-4-4zm0 1c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm2 1l-3 1-1 3 3-1 1-3zm-2 1.5c.28 0 .5.22.5.5s-.22.5-.5.5-.5-.22-.5-.5.22-.5.5-.5z\\\" />\\n</svg>\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/raw-loader!./bower_components/open-iconic/svg/compass.svg\n ** module id = 79\n ** module chunks = 0\n **/"],"sourceRoot":""}